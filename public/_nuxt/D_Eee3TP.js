import{m as Jt,n as Ce,_ as yt,p as He,B as _t,t as ot,ae as Zl,a3 as Ql,i as $,C as Zt,D as Ie,F as w,v as b,Q as t,V as D,a7 as Qt,af as Xl,z as Xt,X as n,y as nt,U as p,Y as x,ag as Yl,a2 as xt,ah as es,$ as de,a0 as Ee,R as o,ai as qt,a4 as Yt,I as v,aj as el,E as fe,k as te,w as Se,ak as tl,T as ht,x as g,O as wt,q as at,r as B,c as ts,h as ve,a5 as ls,aa as ss,ad as as,K as os,J as je,L as We,M as Ve,N as Gt,ab as ns}from"./B5Ug7n5G.js";import{u as ll,_ as kt}from"./D4kD5da7.js";import{_ as is}from"./BIU9NJQ-.js";import{a as Vt,_ as rs,N as ds}from"./5uwiVi6y.js";import{_ as us}from"./Hw1Pf6vM.js";import{_ as ms,a as cs}from"./CvsaU5XD.js";const ps={wrapper:"relative flex items-start",container:"flex items-center h-5",base:"h-4 w-4 dark:checked:bg-current dark:checked:border-transparent disabled:opacity-50 disabled:cursor-not-allowed focus:ring-0 focus:ring-transparent focus:ring-offset-transparent",form:"form-radio",color:"text-{color}-500 dark:text-{color}-400",background:"bg-white dark:bg-gray-900",border:"border border-gray-300 dark:border-gray-700",ring:"focus-visible:ring-2 focus-visible:ring-{color}-500 dark:focus-visible:ring-{color}-400 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:focus-visible:ring-offset-gray-900",inner:"ms-3 flex flex-col",label:"text-sm font-medium text-gray-700 dark:text-gray-200",required:"text-sm text-red-500 dark:text-red-400",help:"text-sm text-gray-500 dark:text-gray-400",default:{color:"primary"}},bt=Jt(Ce.ui.strategy,Ce.ui.radio,ps),gs=He({inheritAttrs:!1,props:{id:{type:String,default:null},value:{type:[String,Number,Boolean],default:null},modelValue:{type:[String,Number,Boolean,Object],default:null},name:{type:String,default:null},disabled:{type:Boolean,default:!1},help:{type:String,default:null},label:{type:String,default:null},required:{type:Boolean,default:!1},color:{type:String,default:()=>bt.default.color,validator(m){return Ce.ui.colors.includes(m)}},inputClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue","change"],setup(m,{emit:O}){const{ui:P,attrs:h}=_t("radio",ot(m,"ui"),bt,ot(m,"class")),i=m.id??Zl(),U=Ql("radio-group",null),{emitFormChange:Z,color:E,name:z}=U??ll(m,bt),W=$({get(){return m.modelValue},set(j){O("update:modelValue",j),U||Z()}});function s(j){O("change",j.target.value)}const L=$(()=>Zt(Ie(P.value.base,P.value.form,P.value.background,P.value.border,E.value&&P.value.ring.replaceAll("{color}",E.value),E.value&&P.value.color.replaceAll("{color}",E.value)),m.inputClass));return{inputId:i,ui:P,attrs:h,pick:W,name:z,inputClass:L,onChange:s}}}),vs=["data-n-ids"],fs=["id","name","required","value","disabled"],bs=["for"];function ws(m,O,P,h,i,U){return b(),w("div",{class:n(m.ui.wrapper),"data-n-ids":m.attrs["data-n-ids"]},[t("div",{class:n(m.ui.container)},[Qt(t("input",Xt({id:m.inputId,"onUpdate:modelValue":O[0]||(O[0]=Z=>m.pick=Z),name:m.name,required:m.required,value:m.value,disabled:m.disabled,type:"radio",class:m.inputClass},m.attrs,{onChange:O[1]||(O[1]=(...Z)=>m.onChange&&m.onChange(...Z))}),null,16,fs),[[Xl,m.pick]])],2),m.label||m.$slots.label?(b(),w("div",{key:0,class:n(m.ui.inner)},[t("label",{for:m.inputId,class:n(m.ui.label)},[nt(m.$slots,"label",{label:m.label},()=>[p(x(m.label),1)]),m.required?(b(),w("span",{key:0,class:n(m.ui.required)},"*",2)):D("",!0)],10,bs),m.help||m.$slots.help?(b(),w("p",{key:0,class:n(m.ui.help)},[nt(m.$slots,"help",{help:m.help},()=>[p(x(m.help),1)])],2)):D("",!0)],2)):D("",!0)],10,vs)}const ys=yt(gs,[["render",ws]]),re=Jt(Ce.ui.strategy,Ce.ui.select,Yl),xs=He({components:{UIcon:xt},inheritAttrs:!1,props:{modelValue:{type:[String,Number,Object],default:""},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:null},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},icon:{type:String,default:null},loadingIcon:{type:String,default:()=>re.default.loadingIcon},leadingIcon:{type:String,default:null},trailingIcon:{type:String,default:()=>re.default.trailingIcon},trailing:{type:Boolean,default:!1},leading:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},padded:{type:Boolean,default:!0},options:{type:Array,default:()=>[]},size:{type:String,default:null,validator(m){return Object.keys(re.size).includes(m)}},color:{type:String,default:()=>re.default.color,validator(m){return[...Ce.ui.colors,...Object.keys(re.color)].includes(m)}},variant:{type:String,default:()=>re.default.variant,validator(m){return[...Object.keys(re.variant),...Object.values(re.color).flatMap(O=>Object.keys(O))].includes(m)}},optionAttribute:{type:String,default:"label"},valueAttribute:{type:String,default:"value"},selectClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue","change"],setup(m,{emit:O,slots:P}){const{ui:h,attrs:i}=_t("select",ot(m,"ui"),re,ot(m,"class")),{size:U,rounded:Z}=es({ui:h,props:m}),{emitFormChange:E,inputId:z,color:W,size:s,name:L}=ll(m,re),j=$(()=>U.value??s.value),J=H=>{O("update:modelValue",H.target.value)},S=H=>{O("change",H.target.value),E()},A=H=>qt(H,m.valueAttribute,""),u=H=>qt(H,m.optionAttribute,""),I=H=>["string","number","boolean"].includes(typeof H)?{[m.valueAttribute]:H,[m.optionAttribute]:H}:{...H,[m.valueAttribute]:A(H),[m.optionAttribute]:u(H)},C=$(()=>m.options.map(H=>I(H))),R=$(()=>m.placeholder?[{[m.valueAttribute]:"",[m.optionAttribute]:m.placeholder,disabled:!0},...C.value]:C.value),q=$(()=>{const H=I(m.modelValue),oe=R.value.find(pe=>pe[m.valueAttribute]===H[m.valueAttribute]);return oe?oe[m.valueAttribute]:""}),y=$(()=>{var oe,pe;const H=((pe=(oe=h.value.color)==null?void 0:oe[W.value])==null?void 0:pe[m.variant])||h.value.variant[m.variant];return Zt(Ie(h.value.base,h.value.form,Z.value,h.value.size[j.value],m.padded?h.value.padding[j.value]:"p-0",H==null?void 0:H.replaceAll("{color}",W.value),(f.value||P.leading)&&h.value.leading.padding[j.value],(le.value||P.trailing)&&h.value.trailing.padding[j.value]),m.placeholder&&!m.modelValue&&h.value.placeholder,m.selectClass)}),f=$(()=>m.icon&&m.leading||m.icon&&!m.trailing||m.loading&&!m.trailing||m.leadingIcon),le=$(()=>m.icon&&m.trailing||m.loading&&m.trailing||m.trailingIcon),se=$(()=>m.loading?m.loadingIcon:m.leadingIcon||m.icon),ue=$(()=>m.loading&&!f.value?m.loadingIcon:m.trailingIcon||m.icon),me=$(()=>Ie(h.value.icon.leading.wrapper,h.value.icon.leading.pointer,h.value.icon.leading.padding[j.value])),be=$(()=>Ie(h.value.icon.base,W.value&&Ce.ui.colors.includes(W.value)&&h.value.icon.color.replaceAll("{color}",W.value),h.value.icon.size[j.value],m.loading&&h.value.icon.loading)),ce=$(()=>Ie(h.value.icon.trailing.wrapper,h.value.icon.trailing.pointer,h.value.icon.trailing.padding[j.value])),Q=$(()=>Ie(h.value.icon.base,W.value&&Ce.ui.colors.includes(W.value)&&h.value.icon.color.replaceAll("{color}",W.value),h.value.icon.size[j.value],m.loading&&!f.value&&h.value.icon.loading));return{ui:h,attrs:i,name:L,inputId:z,normalizedOptionsWithPlaceholder:R,normalizedValue:q,isLeading:f,isTrailing:le,selectClass:y,leadingIconName:se,leadingIconClass:be,leadingWrapperIconClass:me,trailingIconName:ue,trailingIconClass:Q,trailingWrapperIconClass:ce,onInput:J,onChange:S}}}),hs=["id","name","value","required","disabled"],ks=["value","label"],Vs=["value","selected","disabled","textContent"],Es=["value","selected","disabled","textContent"];function Cs(m,O,P,h,i,U){const Z=xt;return b(),w("div",{class:n(m.ui.wrapper)},[t("select",Xt({id:m.inputId,name:m.name,value:m.modelValue,required:m.required,disabled:m.disabled,class:m.selectClass},m.attrs,{onInput:O[0]||(O[0]=(...E)=>m.onInput&&m.onInput(...E)),onChange:O[1]||(O[1]=(...E)=>m.onChange&&m.onChange(...E))}),[(b(!0),w(de,null,Ee(m.normalizedOptionsWithPlaceholder,(E,z)=>(b(),w(de,null,[E.children?(b(),w("optgroup",{key:`${E[m.valueAttribute]}-optgroup-${z}`,value:E[m.valueAttribute],label:E[m.optionAttribute]},[(b(!0),w(de,null,Ee(E.children,(W,s)=>(b(),w("option",{key:`${W[m.valueAttribute]}-${z}-${s}`,value:W[m.valueAttribute],selected:W[m.valueAttribute]===m.normalizedValue,disabled:W.disabled,textContent:x(W[m.optionAttribute])},null,8,Vs))),128))],8,ks)):(b(),w("option",{key:`${E[m.valueAttribute]}-${z}`,value:E[m.valueAttribute],selected:E[m.valueAttribute]===m.normalizedValue,disabled:E.disabled,textContent:x(E[m.optionAttribute])},null,8,Es))],64))),256))],16,hs),m.isLeading&&m.leadingIconName||m.$slots.leading?(b(),w("span",{key:0,class:n(m.leadingWrapperIconClass)},[nt(m.$slots,"leading",{disabled:m.disabled,loading:m.loading},()=>[o(Z,{name:m.leadingIconName,class:n(m.leadingIconClass)},null,8,["name","class"])],!0)],2)):D("",!0),m.isTrailing&&m.trailingIconName||m.$slots.trailing?(b(),w("span",{key:1,class:n(m.trailingWrapperIconClass)},[nt(m.$slots,"trailing",{disabled:m.disabled,loading:m.loading},()=>[o(Z,{name:m.trailingIconName,class:n(m.trailingIconClass),"aria-hidden":"true"},null,8,["name","class"])],!0)],2)):D("",!0)],2)}const Et=yt(xs,[["render",Cs],["__scopeId","data-v-db8f1118"]]),Ts=()=>{const m=Yt(),O=v(),P=el(),h=async()=>{const z=await m.getStatus();return z&&m.setUserStatus(z),z},i=async z=>{await m.register(z)&&O.add({title:"注册成功",description:"欢迎使用！请登录",icon:"i-fluent-checkmark-starburst-16-filled",color:"green",timeout:1e3})},U=async z=>{await m.login(z)&&(await h(),O.add({title:"登录成功",description:"欢迎回来！",icon:"i-fluent-checkmark-starburst-16-filled",color:"green",timeout:1e3}))},Z=async()=>{await m.logout(),m.clearUserStatus(),O.add({title:"注销成功",description:"欢迎再次使用！",icon:"i-fluent-checkmark-starburst-16-filled",color:"green",timeout:1e3}),P.push("/")},E=async()=>await h();return fe(async()=>{await h()}),{register:i,login:U,logout:Z,getStatus:E}},Us={class:"rounded-lg p-4 mb-6"},Ss={class:"flex justify-between items-center mb-4"},Bs={class:"flex justify-between items-center mb-2"},As={class:"flex items-center gap-2"},$s={key:0,class:"space-y-2"},Ls={class:"flex justify-end gap-2"},Rs={class:"flex justify-between items-center mb-2"},Ps={class:"flex items-center gap-2"},js={key:0,class:"space-y-2"},Is={class:"flex justify-end gap-2"},Hs={class:"flex justify-between items-center mb-2"},Ms={class:"flex items-center gap-2"},Ds={key:0,class:"space-y-2"},Os={class:"flex justify-end gap-2"},zs={class:"flex justify-between items-center mb-2"},Ns={class:"flex items-center gap-2"},Ws={key:0,class:"space-y-2"},Ks={class:"flex justify-end gap-2"},Fs={class:"flex justify-between items-center mb-2"},qs={class:"flex items-center gap-2"},Gs={key:0,class:"space-y-2"},Js={class:"flex justify-end gap-2"},_s={class:"flex justify-between items-center mb-2"},Zs={class:"flex items-center gap-2"},Qs={key:0,class:"space-y-2"},Xs={class:"flex justify-end gap-2"},Ys=He({__name:"NotifyPanel",props:{config:{},immediate:{type:Boolean},subtleBg:{},text:{},mutedText:{},disabled:{type:Boolean}},emits:["save"],setup(m,{emit:O}){const P=O,h=m,i=te({webhookEnabled:!1,webhookURL:"",telegramEnabled:!1,telegramToken:"",telegramChatID:"",weworkEnabled:!1,weworkKey:"",feishuEnabled:!1,feishuWebhook:"",feishuSecret:"",twitterEnabled:!1,twitterApiKey:"",twitterApiSecret:"",twitterAccessToken:"",twitterAccessTokenSecret:"",customHttpEnabled:!1,customHttpUrl:"",customHttpMethod:"POST",customHttpHeaders:"",customHttpBody:'{"content":"{{content}}"}'}),U=te({webhook:!1,telegram:!1,wework:!1,feishu:!1,twitter:!1,customHttp:!1}),Z=["webhook","telegram","wework","feishu","twitter","customHttp"],E=A=>({webhook:"Webhook",telegram:"Telegram",wework:"企业微信",feishu:"飞书",twitter:"Twitter",customHttp:"自定义HTTP"})[A]||A,z=A=>{const u=A.toLowerCase();Object.keys(i).forEach(I=>{I.toLowerCase().startsWith(u)&&(i[I]=h.config[I])}),U[A]=!1},W=A=>{var I,C,R,q,y,f,le,se,ue,me;const u=i;switch(A){case"webhook":return u.webhookEnabled&&!!((I=u.webhookURL)!=null&&I.trim());case"telegram":return u.telegramEnabled&&!!((C=u.telegramToken)!=null&&C.trim())&&!!((R=u.telegramChatID)!=null&&R.trim());case"wework":return u.weworkEnabled&&!!((q=u.weworkKey)!=null&&q.trim());case"feishu":return u.feishuEnabled&&!!((y=u.feishuWebhook)!=null&&y.trim());case"twitter":return u.twitterEnabled&&!!((f=u.twitterApiKey)!=null&&f.trim())&&!!((le=u.twitterApiSecret)!=null&&le.trim())&&!!((se=u.twitterAccessToken)!=null&&se.trim())&&!!((ue=u.twitterAccessTokenSecret)!=null&&ue.trim());case"customHttp":return u.customHttpEnabled&&!!((me=u.customHttpUrl)!=null&&me.trim());default:return!1}},s=async A=>{try{switch(A){case"webhook":if(i.webhookEnabled&&!i.webhookURL)throw new Error("Webhook URL不能为空");break;case"telegram":if(i.telegramEnabled&&(!i.telegramToken||!i.telegramChatID))throw new Error("Telegram配置不完整");break;case"wework":if(i.weworkEnabled&&!i.weworkKey)throw new Error("企业微信Key不能为空");break;case"feishu":if(i.feishuEnabled&&!i.feishuWebhook)throw new Error("飞书Webhook不能为空");break;case"twitter":if(i.twitterEnabled&&(!i.twitterApiKey||!i.twitterApiSecret||!i.twitterAccessToken||!i.twitterAccessTokenSecret))throw new Error("Twitter配置不完整");break;case"customHttp":if(i.customHttpEnabled&&!i.customHttpUrl)throw new Error("自定义HTTP URL不能为空");break}const u={webhookEnabled:i.webhookEnabled,webhookURL:i.webhookURL,telegramEnabled:i.telegramEnabled,telegramToken:i.telegramToken,telegramChatID:i.telegramChatID,weworkEnabled:i.weworkEnabled,weworkKey:i.weworkKey,feishuEnabled:i.feishuEnabled,feishuWebhook:i.feishuWebhook,feishuSecret:i.feishuSecret,twitterEnabled:i.twitterEnabled,twitterApiKey:i.twitterApiKey,twitterApiSecret:i.twitterApiSecret,twitterAccessToken:i.twitterAccessToken,twitterAccessTokenSecret:i.twitterAccessTokenSecret,customHttpEnabled:i.customHttpEnabled,customHttpUrl:i.customHttpUrl,customHttpMethod:i.customHttpMethod,customHttpHeaders:i.customHttpHeaders,customHttpBody:i.customHttpBody},I=wt().public.baseApi||"/api",R=await(await fetch(`${I}/notify/config`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(u)})).json();if(R.code===1)U[A]=!1,R.data&&Object.keys(R.data).forEach(q=>{q.endsWith("Enabled")?i[q]=!!R.data[q]&&R.data[q]!=="false":i[q]=R.data[q]||""}),P("save",{...i}),v().add({title:"成功",description:`${E(A)}配置已保存`,color:"green"});else throw new Error(R.msg||"保存失败")}catch(u){console.error("保存配置失败:",u),v().add({title:"错误",description:u.message||"保存失败",color:"red"})}},L=async A=>{try{if(!W(A))throw new Error(`请先完成并启用${E(A)}配置`);const I=await(await fetch("/api/notify/test",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({type:A})})).json();if(I.code===1)v().add({title:"成功",description:`${E(A)}测试消息已发送`,color:"green"});else throw new Error(I.msg||"测试失败")}catch(u){console.error("测试失败:",u),v().add({title:"错误",description:u.message||"测试失败",color:"red"})}};Se(()=>h.config,A=>{A&&Object.keys(i).forEach(u=>{A[u]!==void 0&&(u.endsWith("Enabled")?i[u]=!!A[u]&&A[u]!=="false":i[u]=A[u])})},{deep:!0,immediate:!0}),fe(async()=>{try{const u=await(await fetch("/api/notify/config",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}})).json();if(u.code===1&&u.data){const I=u.data;Object.keys(I).forEach(C=>{C.endsWith("Enabled")?i[C]=!!I[C]&&I[C]!=="false":i[C]=I[C]||""}),console.log("加载的配置:",i)}}catch(A){console.error("获取配置失败:",A),v().add({title:"错误",description:"获取推送配置失败",color:"red"})}});const j=$(()=>h.subtleBg||"bg-gray-800"),J=$(()=>h.text||"text-white"),S=$(()=>h.mutedText||"text-gray-300");return(A,u)=>{const I=tl("USwitch"),C=ht,R=kt,q=Et,y=Vt;return b(),w("div",Us,[t("div",Ss,[t("h2",{class:n(["text-xl font-semibold",J.value])},"推送渠道配置",2)]),t("div",{class:n(["space-y-4",h.disabled?"opacity-60 pointer-events-none":""])},[t("div",{class:n(["rounded p-3",j.value])},[t("div",Bs,[t("span",{class:n(S.value)},"Webhook推送",2),t("div",As,[o(I,{modelValue:i.webhookEnabled,"onUpdate:modelValue":u[0]||(u[0]=f=>i.webhookEnabled=f)},null,8,["modelValue"]),o(C,{size:"sm",onClick:u[1]||(u[1]=f=>U.webhook=!U.webhook),color:U.webhook?"gray":"primary",variant:"soft"},{default:g(()=>[p(x(U.webhook?"取消":"编辑"),1)]),_:1},8,["color"])])]),U.webhook?(b(),w("div",$s,[o(R,{modelValue:i.webhookURL,"onUpdate:modelValue":u[2]||(u[2]=f=>i.webhookURL=f),placeholder:"Webhook URL"},null,8,["modelValue"]),t("div",Ls,[o(C,{onClick:u[3]||(u[3]=f=>z("webhook")),variant:"ghost",color:"gray"},{default:g(()=>u[38]||(u[38]=[p(" 重置 ")])),_:1}),o(C,{onClick:u[4]||(u[4]=f=>s("webhook")),color:"primary"},{default:g(()=>u[39]||(u[39]=[p(" 保存 ")])),_:1})])])):D("",!0)],2),t("div",{class:n(["rounded p-3",j.value])},[t("div",Rs,[t("span",{class:n(S.value)},"Telegram推送",2),t("div",Ps,[o(I,{modelValue:i.telegramEnabled,"onUpdate:modelValue":u[5]||(u[5]=f=>i.telegramEnabled=f)},null,8,["modelValue"]),o(C,{size:"sm",onClick:u[6]||(u[6]=f=>U.telegram=!U.telegram),color:U.telegram?"gray":"primary",variant:"soft"},{default:g(()=>[p(x(U.telegram?"取消":"编辑"),1)]),_:1},8,["color"])])]),U.telegram?(b(),w("div",js,[o(R,{modelValue:i.telegramToken,"onUpdate:modelValue":u[7]||(u[7]=f=>i.telegramToken=f),placeholder:"Bot Token"},null,8,["modelValue"]),o(R,{modelValue:i.telegramChatID,"onUpdate:modelValue":u[8]||(u[8]=f=>i.telegramChatID=f),placeholder:"Chat ID"},null,8,["modelValue"]),t("div",Is,[o(C,{onClick:u[9]||(u[9]=f=>z("telegram")),variant:"ghost",color:"gray"},{default:g(()=>u[40]||(u[40]=[p(" 重置 ")])),_:1}),o(C,{onClick:u[10]||(u[10]=f=>s("telegram")),color:"primary"},{default:g(()=>u[41]||(u[41]=[p(" 保存 ")])),_:1})])])):D("",!0)],2),t("div",{class:n(["rounded p-3",j.value])},[t("div",Hs,[t("span",{class:n(S.value)},"企业微信推送",2),t("div",Ms,[o(I,{modelValue:i.weworkEnabled,"onUpdate:modelValue":u[11]||(u[11]=f=>i.weworkEnabled=f)},null,8,["modelValue"]),o(C,{size:"sm",onClick:u[12]||(u[12]=f=>U.wework=!U.wework),color:U.wework?"gray":"primary",variant:"soft"},{default:g(()=>[p(x(U.wework?"取消":"编辑"),1)]),_:1},8,["color"])])]),U.wework?(b(),w("div",Ds,[o(R,{modelValue:i.weworkKey,"onUpdate:modelValue":u[13]||(u[13]=f=>i.weworkKey=f),placeholder:"WebHook Key"},null,8,["modelValue"]),t("div",Os,[o(C,{onClick:u[14]||(u[14]=f=>z("wework")),variant:"ghost",color:"gray"},{default:g(()=>u[42]||(u[42]=[p(" 重置 ")])),_:1}),o(C,{onClick:u[15]||(u[15]=f=>s("wework")),color:"primary"},{default:g(()=>u[43]||(u[43]=[p(" 保存 ")])),_:1})])])):D("",!0)],2),t("div",{class:n(["rounded p-3",j.value])},[t("div",zs,[t("span",{class:n(S.value)},"飞书推送",2),t("div",Ns,[o(I,{modelValue:i.feishuEnabled,"onUpdate:modelValue":u[16]||(u[16]=f=>i.feishuEnabled=f)},null,8,["modelValue"]),o(C,{size:"sm",onClick:u[17]||(u[17]=f=>U.feishu=!U.feishu),color:U.feishu?"gray":"primary",variant:"soft"},{default:g(()=>[p(x(U.feishu?"取消":"编辑"),1)]),_:1},8,["color"])])]),U.feishu?(b(),w("div",Ws,[o(R,{modelValue:i.feishuWebhook,"onUpdate:modelValue":u[18]||(u[18]=f=>i.feishuWebhook=f),placeholder:"WebHook URL"},null,8,["modelValue"]),o(R,{modelValue:i.feishuSecret,"onUpdate:modelValue":u[19]||(u[19]=f=>i.feishuSecret=f),placeholder:"签名密钥",type:"password"},null,8,["modelValue"]),t("div",Ks,[o(C,{onClick:u[20]||(u[20]=f=>z("feishu")),variant:"ghost",color:"gray"},{default:g(()=>u[44]||(u[44]=[p(" 重置 ")])),_:1}),o(C,{onClick:u[21]||(u[21]=f=>s("feishu")),color:"primary"},{default:g(()=>u[45]||(u[45]=[p(" 保存 ")])),_:1})])])):D("",!0)],2),t("div",{class:n(["rounded p-3",j.value])},[t("div",Fs,[t("span",{class:n(S.value)},"Twitter推送",2),t("div",qs,[o(I,{modelValue:i.twitterEnabled,"onUpdate:modelValue":u[22]||(u[22]=f=>i.twitterEnabled=f)},null,8,["modelValue"]),o(C,{size:"sm",onClick:u[23]||(u[23]=f=>U.twitter=!U.twitter),color:U.twitter?"gray":"primary",variant:"soft"},{default:g(()=>[p(x(U.twitter?"取消":"编辑"),1)]),_:1},8,["color"])])]),U.twitter?(b(),w("div",Gs,[o(R,{modelValue:i.twitterApiKey,"onUpdate:modelValue":u[24]||(u[24]=f=>i.twitterApiKey=f),placeholder:"API Key"},null,8,["modelValue"]),o(R,{modelValue:i.twitterApiSecret,"onUpdate:modelValue":u[25]||(u[25]=f=>i.twitterApiSecret=f),placeholder:"API Secret"},null,8,["modelValue"]),o(R,{modelValue:i.twitterAccessToken,"onUpdate:modelValue":u[26]||(u[26]=f=>i.twitterAccessToken=f),placeholder:"Access Token"},null,8,["modelValue"]),o(R,{modelValue:i.twitterAccessTokenSecret,"onUpdate:modelValue":u[27]||(u[27]=f=>i.twitterAccessTokenSecret=f),placeholder:"Access Token Secret"},null,8,["modelValue"]),t("div",Js,[o(C,{onClick:u[28]||(u[28]=f=>z("twitter")),variant:"ghost",color:"gray"},{default:g(()=>u[46]||(u[46]=[p("重置")])),_:1}),o(C,{onClick:u[29]||(u[29]=f=>s("twitter")),color:"primary"},{default:g(()=>u[47]||(u[47]=[p("保存")])),_:1})])])):D("",!0)],2),t("div",{class:n(["rounded p-3",j.value])},[t("div",_s,[t("span",{class:n(S.value)},"自定义HTTP推送",2),t("div",Zs,[o(I,{modelValue:i.customHttpEnabled,"onUpdate:modelValue":u[30]||(u[30]=f=>i.customHttpEnabled=f)},null,8,["modelValue"]),o(C,{size:"sm",onClick:u[31]||(u[31]=f=>U.customHttp=!U.customHttp),color:U.customHttp?"gray":"primary",variant:"soft"},{default:g(()=>[p(x(U.customHttp?"取消":"编辑"),1)]),_:1},8,["color"])])]),U.customHttp?(b(),w("div",Qs,[o(R,{modelValue:i.customHttpUrl,"onUpdate:modelValue":u[32]||(u[32]=f=>i.customHttpUrl=f),placeholder:"请求URL"},null,8,["modelValue"]),o(q,{modelValue:i.customHttpMethod,"onUpdate:modelValue":u[33]||(u[33]=f=>i.customHttpMethod=f),options:["POST","PUT","PATCH"]},null,8,["modelValue"]),o(y,{modelValue:i.customHttpHeaders,"onUpdate:modelValue":u[34]||(u[34]=f=>i.customHttpHeaders=f),placeholder:"请求Headers（JSON格式）"},null,8,["modelValue"]),o(y,{modelValue:i.customHttpBody,"onUpdate:modelValue":u[35]||(u[35]=f=>i.customHttpBody=f),placeholder:'请求Body模板（如：{"content":"{{content}}"})'},null,8,["modelValue"]),t("div",Xs,[o(C,{onClick:u[36]||(u[36]=f=>z("customHttp")),variant:"ghost",color:"gray"},{default:g(()=>u[48]||(u[48]=[p("重置")])),_:1}),o(C,{onClick:u[37]||(u[37]=f=>s("customHttp")),color:"primary"},{default:g(()=>u[49]||(u[49]=[p("保存")])),_:1})])])):D("",!0)],2)],2),t("div",{class:n(["mt-4 flex flex-wrap gap-2",h.disabled?"opacity-60 pointer-events-none":""])},[(b(),w(de,null,Ee(Z,f=>o(C,{key:f,onClick:le=>L(f),class:"flex-grow sm:flex-grow-0",variant:"solid",disabled:h.disabled},{default:g(()=>[p(" 测试"+x(E(f)),1)]),_:2},1032,["onClick","disabled"])),64))],2)])}}}),ea={class:"flex flex-col gap-3 w-full"},ta={class:"flex flex-wrap items-center gap-3 justify-between"},la={key:1,class:"grid grid-cols-1 md:grid-cols-3 gap-3"},sa=["innerHTML"],aa=["innerHTML"],oa=He({__name:"CommentsSettings",props:{config:{},theme:{}},emits:["update:config","comment-system-changed"],setup(m,{emit:O}){const P=m,h=O,i=te({commentEnabled:!1,commentSystem:"waline",commentEmailEnabled:!1,walineServerURL:"",commentEmailReplyName:"",commentEmailAdminPrefix:"",commentEmailReplyPrefix:"",commentEmailReplyTemplate:"",commentEmailAdminTemplate:"",commentEmailReplyTemplateHTML:"",commentEmailAdminTemplateHTML:""});Se(()=>P.config,s=>{s&&(i.commentEnabled=!!s.commentEnabled,i.commentSystem=String(s.commentSystem||"waline"),i.commentEmailEnabled=!!s.commentEmailEnabled,i.walineServerURL=String(s.walineServerURL||""),i.commentEmailReplyName=String(s.commentEmailReplyName||""),i.commentEmailAdminPrefix=String(s.commentEmailAdminPrefix||""),i.commentEmailReplyPrefix=String(s.commentEmailReplyPrefix||""),i.commentEmailReplyTemplate=String(s.commentEmailReplyTemplate||""),i.commentEmailAdminTemplate=String(s.commentEmailAdminTemplate||""),i.commentEmailSiteURL=String(s.commentEmailSiteURL||""),i.commentEmailReplyTemplateHTML=String(s.commentEmailReplyTemplateHTML||""),i.commentEmailAdminTemplateHTML=String(s.commentEmailAdminTemplateHTML||""))},{immediate:!0,deep:!0}),Se(()=>i.commentSystem,s=>{h("comment-system-changed",String(s||""))});const U=$(()=>"bg-gray-800");$(()=>"text-slate-400");const Z=$(()=>"text-white"),E=async()=>{var s,L;try{const j={frontendSettings:{commentEnabled:!!((s=P.config)!=null&&s.commentEnabled),commentSystem:String(i.commentSystem||"waline"),commentEmailEnabled:!!((L=P.config)!=null&&L.commentEmailEnabled),walineServerURL:String(i.walineServerURL||""),commentEmailReplyName:String(i.commentEmailReplyName||""),commentEmailAdminPrefix:String(i.commentEmailAdminPrefix||""),commentEmailReplyPrefix:String(i.commentEmailReplyPrefix||""),commentEmailReplyTemplate:String(i.commentEmailReplyTemplate||""),commentEmailAdminTemplate:String(i.commentEmailAdminTemplate||""),commentEmailSiteURL:String(i.commentEmailSiteURL||""),commentEmailReplyTemplateHTML:String(i.commentEmailReplyTemplateHTML||""),commentEmailAdminTemplateHTML:String(i.commentEmailAdminTemplateHTML||"")}},J=await fetch("/api/settings",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(j)}),S=await J.json();if(J.ok&&S.code===1){const A={...P.config,...j.frontendSettings};h("update:config",A),window.dispatchEvent(new Event("frontend-config-updated")),v().add({title:"成功",description:"评论设置已更新",color:"green"})}else throw new Error(S.msg||"保存失败")}catch(j){v().add({title:"错误",description:(j==null?void 0:j.message)||"保存失败",color:"red"})}},z=$(()=>{var u;const s=String(((u=P.config)==null?void 0:u.siteTitle)||"站点"),L="Mike",j="这里是示例内容",J=String(i.commentEmailSiteURL||""),S=(J?J.replace(/\/$/,""):"")+"/m/123";return(i.commentEmailReplyTemplateHTML||`
<div>
  <p>您在<strong>{site}</strong>主页上的内容有了新的评论</p>
  <p><strong>{nick}</strong> 回复说：</p>
  <p>{content}</p>
  <p>您可以点击查看回复的完整内容：<a href="{url}" target="_blank">{url}</a></p>
</div>`).replaceAll("{site}",s).replaceAll("{nick}",L).replaceAll("{content}",j).replaceAll("{url}",S)}),W=$(()=>{var C;const s=String(((C=P.config)==null?void 0:C.siteTitle)||"站点"),L="Mike",j="mike@example.com",J="https://example.com",S="这里是示例内容",A=String(i.commentEmailSiteURL||""),u=(A?A.replace(/\/$/,""):"")+"/m/123";return(i.commentEmailAdminTemplateHTML||`
<div>
  <p>站点：<strong>{site}</strong></p>
  <p>用户：{nick}（{mail}）</p>
  <p>网址：<a href="{link}" target="_blank">{link}</a></p>
  <p>内容：</p>
  <div>{content}</div>
  <p>查看：<a href="{url}" target="_blank">{url}</a></p>
</div>`).replaceAll("{site}",s).replaceAll("{nick}",L).replaceAll("{mail}",j).replaceAll("{link}",J).replaceAll("{content}",S).replaceAll("{url}",u)});return(s,L)=>{var u,I,C,R,q,y,f,le,se,ue,me,be,ce,Q,H,oe,pe,Me;const j=Et,J=kt,S=ht,A=Vt;return b(),w("div",{id:"site-comments-section",class:n(["flex flex-wrap items-center rounded-lg p-3 justify-between gap-3",((u=s.theme)==null?void 0:u.subtleBg)||U.value])},[t("div",ea,[t("div",ta,[o(j,{modelValue:i.commentSystem,"onUpdate:modelValue":L[0]||(L[0]=F=>i.commentSystem=F),options:[{label:"内置",value:"builtin"},{label:"Waline",value:"waline"}]},null,8,["modelValue"]),i.commentSystem==="waline"?(b(),at(J,{key:0,modelValue:i.walineServerURL,"onUpdate:modelValue":L[1]||(L[1]=F=>i.walineServerURL=F),ui:{base:(I=s.theme)==null?void 0:I.text},placeholder:"Waline 地址",class:"w-full md:w-[280px]"},null,8,["modelValue","ui"])):D("",!0),L[11]||(L[11]=t("div",{class:"flex-1"},null,-1)),o(S,{color:"green",onClick:E,class:"shadow"},{default:g(()=>L[10]||(L[10]=[p("保存")])),_:1})]),i.commentSystem==="builtin"&&!((C=P.config)!=null&&C.commentEmailEnabled)?(b(),w("div",{key:0,class:n(["rounded border p-3",(R=s.theme)==null?void 0:R.border])},[t("div",{class:n(((q=s.theme)==null?void 0:q.text)||Z.value)},"开启“邮件通知”后，可配置站点链接地址、主题前缀、发件显示名、文本/HTML 模板，并实时预览。",2)],2)):D("",!0),i.commentSystem==="builtin"&&((y=P.config)!=null&&y.commentEmailEnabled)?(b(),w("div",la,[o(J,{modelValue:i.commentEmailSiteURL,"onUpdate:modelValue":L[2]||(L[2]=F=>i.commentEmailSiteURL=F),ui:{base:(f=s.theme)==null?void 0:f.text},placeholder:"站点链接地址（用于邮件中的 {url} 基础） 如 https://note.noisework.cn"},null,8,["modelValue","ui"]),o(J,{modelValue:i.commentEmailReplyName,"onUpdate:modelValue":L[3]||(L[3]=F=>i.commentEmailReplyName=F),ui:{base:(le=s.theme)==null?void 0:le.text},placeholder:"邮件发件显示名（回复通知）"},null,8,["modelValue","ui"]),o(J,{modelValue:i.commentEmailAdminPrefix,"onUpdate:modelValue":L[4]||(L[4]=F=>i.commentEmailAdminPrefix=F),ui:{base:(se=s.theme)==null?void 0:se.text},placeholder:"管理员通知主题前缀（可选）"},null,8,["modelValue","ui"]),o(J,{modelValue:i.commentEmailReplyPrefix,"onUpdate:modelValue":L[5]||(L[5]=F=>i.commentEmailReplyPrefix=F),ui:{base:(ue=s.theme)==null?void 0:ue.text},placeholder:"回复通知主题前缀（可选）"},null,8,["modelValue","ui"]),o(A,{modelValue:i.commentEmailReplyTemplate,"onUpdate:modelValue":L[6]||(L[6]=F=>i.commentEmailReplyTemplate=F),ui:{base:(me=s.theme)==null?void 0:me.text},placeholder:"回复通知正文模板（默认示例）支持 {site} {nick} {content} {url}"},null,8,["modelValue","ui"]),o(A,{modelValue:i.commentEmailAdminTemplate,"onUpdate:modelValue":L[7]||(L[7]=F=>i.commentEmailAdminTemplate=F),ui:{base:(be=s.theme)==null?void 0:be.text},placeholder:"管理员通知正文模板（可选）支持 {site} {nick} {mail} {link} {content} {url}"},null,8,["modelValue","ui"]),o(A,{modelValue:i.commentEmailReplyTemplateHTML,"onUpdate:modelValue":L[8]||(L[8]=F=>i.commentEmailReplyTemplateHTML=F),ui:{base:(ce=s.theme)==null?void 0:ce.text},placeholder:"回复通知 HTML 模板（可选）支持 {site} {nick} {content} {url}"},null,8,["modelValue","ui"]),o(A,{modelValue:i.commentEmailAdminTemplateHTML,"onUpdate:modelValue":L[9]||(L[9]=F=>i.commentEmailAdminTemplateHTML=F),ui:{base:(Q=s.theme)==null?void 0:Q.text},placeholder:"管理员通知 HTML 模板（可选）支持 {site} {nick} {mail} {link} {content} {url}"},null,8,["modelValue","ui"]),t("div",{class:n(["md:col-span-3 rounded border p-3",(H=s.theme)==null?void 0:H.border])},[t("div",{class:n((oe=s.theme)==null?void 0:oe.text)},"回复通知富文本预览",2),t("div",{class:"mt-2 rounded p-2 bg-white text-black",innerHTML:z.value},null,8,sa)],2),t("div",{class:n(["md:col-span-3 rounded border p-3",(pe=s.theme)==null?void 0:pe.border])},[t("div",{class:n((Me=s.theme)==null?void 0:Me.text)},"管理员通知富文本预览",2),t("div",{class:"mt-2 rounded p-2 bg-white text-black",innerHTML:W.value},null,8,aa)],2)])):D("",!0)])],2)}}}),na={class:"min-h-screen w-full"},ia={class:"px-4 py-4 border-b border-slate-700/40 flex flex-col items-center gap-2"},ra=["src"],da={class:"w-full text-center"},ua={class:"font-semibold truncate"},ma={class:"flex-1 overflow-y-auto px-2 py-3 space-y-2"},ca={key:0,class:"space-y-2"},pa={class:"px-4 py-3 border-t border-slate-700/40"},ga={class:"mt-2 flex items-center gap-2"},va={key:0,class:"mt-2 text-orange-400 flex items-center gap-2"},fa={class:"flex items-center gap-2"},ba={class:"flex items-center gap-2"},wa={class:"flex-1 px-4 pb-24 flex flex-col w-full space-y-4"},ya={class:"col-span-12"},xa={class:"col-span-12"},ha={class:"px-4 py-3 flex items-center justify-between"},ka={class:"flex items-center gap-4"},Va={class:"flex items-center gap-3"},Ea={class:"flex items-center"},Ca={class:"flex items-center"},Ta={class:"flex items-center"},Ua={class:"flex items-center"},Sa={class:"flex items-center gap-2"},Ba={id:"system-section",class:"col-span-12"},Aa={class:"px-4 py-3 flex flex-wrap items-center gap-6"},$a={class:"inline-flex items-center font-medium rounded-md px-2 py-1 gap-1 ml-2 text-sm bg-primary-50 dark:bg-primary-400 dark:bg-opacity-10 text-slate-800 dark:text-slate-200"},La={class:"inline-flex items-center font-medium rounded-md px-2 py-1 gap-1 ml-2 text-sm bg-primary-50 dark:bg-primary-400 dark:bg-opacity-10 text-slate-800 dark:text-slate-200"},Ra={class:"inline-flex items-center font-medium rounded-md px-2 py-1 gap-1 ml-2 text-sm bg-primary-50 dark:bg-primary-400 dark:bg-opacity-10 text-slate-800 dark:text-slate-200"},Pa={key:0,id:"user-section",class:"col-span-12"},ja={class:"px-4 pb-4 grid grid-cols-1 md:grid-cols-3 gap-y-2 md:gap-x-4"},Ia={class:"flex justify-between items-center mb-2"},Ha={key:0},Ma={class:"flex justify-end gap-2"},Da={key:1},Oa={class:"flex justify-between items-center mb-2"},za={class:"flex items-center gap-2"},Na={key:0,class:"mb-2"},Wa={class:"flex items-center gap-2 w-full flex-nowrap"},Ka={key:1},Fa={class:"flex justify-between items-center mb-2"},qa={key:0},Ga={class:"w-full mb-2 flex items-center gap-2"},Ja={class:"w-full mb-2 flex items-center gap-2"},_a={class:"w-full mb-2 flex items-center gap-2"},Za={class:"flex justify-end gap-2"},Qa={id:"site-section",class:"col-span-12"},Xa={class:"flex items-center justify-between px-4 py-3"},Ya={class:"px-4 pb-4 space-y-4"},eo={class:"flex items-center gap-4"},to={class:"flex items-center"},lo={class:"flex items-center"},so={class:"flex justify-between items-center mb-3"},ao={class:"flex items-center gap-4"},oo={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},no={class:"md:col-span-2"},io={class:"flex items-center gap-4"},ro={class:"flex items-center"},uo={class:"flex items-center"},mo={class:"flex items-center gap-4"},co={class:"flex justify-end"},po={id:"site-music-section",class:"col-span-12 mt-4"},go={class:"flex items-center justify-between px-4 py-3"},vo={class:"flex items-center gap-3"},fo={class:"px-4 pb-4"},bo={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},wo={class:"flex items-center gap-2"},yo={class:"flex items-center gap-2"},xo={class:"flex items-center gap-2"},ho={class:"flex items-center gap-2 md:col-span-2"},ko={class:"flex justify-end gap-2"},Vo={class:"flex items-center gap-4"},Eo={class:"flex items-center"},Co={class:"flex items-center"},To={id:"site-configs-section",class:"space-y-4"},Uo={class:"flex justify-between items-center mb-2"},So={key:0},Bo={key:0,class:"space-y-2"},Ao={class:"flex gap-2"},$o={class:"flex justify-end gap-2"},Lo={key:1},Ro={key:0,class:"grid grid-cols-3 gap-2"},Po=["src","onClick"],jo={key:0,class:"flex justify-end gap-2"},Io={id:"comments-section",class:"col-span-12"},Ho={class:"flex items-center justify-between px-4 py-3"},Mo={class:"flex items-center gap-3"},Do={class:"flex items-center gap-2"},Oo={class:"px-4 pb-4"},zo={class:"flex items-center gap-2 mb-2"},No={key:0,class:"space-y-2"},Wo={class:"flex items-center justify-between gap-2"},Ko={key:0,class:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-2 text-sm"},Fo={class:"md:col-span-3"},qo=["href"],Go={class:"md:col-span-3 flex gap-2"},Jo={key:0,class:"flex justify-center"},_o={id:"email-section",class:"col-span-12"},Zo={class:"flex items-center justify-between px-4 py-3"},Qo={class:"flex items-center gap-3"},Xo={class:"px-4 pb-4"},Yo={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},en={class:"text-xs"},tn={class:"flex justify-end gap-2 mt-3"},ln={id:"admin-users-section",class:"col-span-12"},sn={class:"flex items-center justify-between px-4 py-3"},an={class:"px-4 pb-4"},on={class:"flex items-center gap-2"},nn={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2"},rn={class:"flex items-center justify-between gap-2 min-w-0"},dn={class:"mt-2 flex items-center gap-2"},un={class:"grid grid-cols-1 md:grid-cols-3 gap-2"},mn={class:"mt-3"},cn={class:"flex items-center gap-2"},pn={class:"space-y-3"},gn={class:"flex items-center gap-2"},vn={class:"flex items-center gap-2"},fn={class:"flex justify-end gap-2"},bn={id:"notify-section",class:"col-span-12"},wn={class:"flex items-center justify-between px-4 py-3"},yn={class:"flex items-center gap-3"},xn={class:"flex items-center gap-2"},hn={class:"px-4 pb-4"},kn={id:"site-github-login-section",class:"col-span-12"},Vn={class:"flex items-center justify-between px-4 py-3"},En={class:"flex items-center gap-3"},Cn={class:"flex items-center gap-2"},Tn={class:"px-4 pb-4 space-y-3"},Un={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Sn={class:"md:col-span-2"},Bn={class:"flex justify-end gap-2"},An={id:"db-section",class:"col-span-12"},$n={class:"flex items-center justify-between px-4 py-3"},Ln={class:"flex gap-2 flex-wrap justify-end items-center"},Rn={class:"px-4 pb-4 space-y-4"},Pn={class:"flex items-center gap-3"},jn={class:"flex items-center gap-2"},In={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Hn={key:0,class:"flex items-center gap-2"},Mn={class:"md:col-span-2"},Dn={class:"flex justify-end gap-2 mt-2"},On={class:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-3"},zn={class:"md:col-span-2 flex flex-wrap items-center gap-4"},Nn={class:"flex items-center gap-2"},Wn={class:"flex items-center gap-2"},Kn={key:0,class:"flex items-center gap-2"},Fn={class:"flex items-center gap-3 ml-auto"},qn={class:"flex gap-2"},Gn={class:"flex gap-2"},Jn={class:"flex justify-end gap-2 mt-2"},_n={key:0},Zn={key:1,class:"flex gap-2"},Qn={class:"bg-gray-800 p-6 rounded-lg"},Xn={class:"flex justify-between items-center"},Ke="rounded-2xl border shadow-2xl",Yn=He({__name:"StatusPanel",emits:["restore-success"],setup(m,{emit:O}){const P=B(!0),h=B(!1),i=B(typeof window<"u"&&localStorage.getItem("adminTheme")||"dark"),U=wt().public.baseApi||"/api",Z=$(()=>{var d,r;const l=(c.avatarURL||"").trim(),e=((d=S.user)==null?void 0:d.username)||((r=S.user)==null?void 0:r.Username)||c.username;return l?l.startsWith("http")?l:l.startsWith("/api")?`${U}${l}`:`${U}${l}`:e?`https://i.pravatar.cc/100?u=${encodeURIComponent(e)}`:"/favicon.ico"}),E=async(l,e)=>{await os();const d=document.getElementById(`${l}-section`);d&&(d.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),window.innerWidth<768&&(h.value=!1))};fe(()=>{vt(),h.value=window.innerWidth>=768});const z=B(typeof window<"u"?window.innerWidth>=768:!0),W=()=>{typeof window>"u"||(z.value=window.innerWidth>=768)};fe(()=>{W(),typeof window<"u"&&window.addEventListener("resize",W)}),ts(()=>{typeof window<"u"&&window.removeEventListener("resize",W)});const s=$(()=>i.value==="light"?{sidebarBg:"bg-white/90",headerBg:"bg-white",bottomBg:"bg-white",cardBg:"bg-white",subtleBg:"bg-white",border:"border-gray-300",text:"text-slate-900",sidebarText:"text-slate-900",mutedText:"text-slate-700",pageBg:"bg-gray-50",navBtnBg:"bg-gray-100",navBtnHoverBg:"hover:bg-gray-200"}:i.value==="dark"?{sidebarBg:"bg-gray-950/80",headerBg:"bg-gray-950/70",bottomBg:"bg-gray-950/70",cardBg:"bg-gray-900/70",subtleBg:"bg-gray-900/50",border:"border-gray-800/60",text:"text-white",sidebarText:"text-white",mutedText:"text-gray-300",pageBg:"bg-gradient-to-br from-slate-900 via-indigo-950 to-slate-800",navBtnBg:"bg-slate-800/70",navBtnHoverBg:"hover:bg-slate-700/70"}:i.value==="midnight"?{sidebarBg:"bg-indigo-950/60",headerBg:"bg-indigo-950/50",bottomBg:"bg-indigo-950/50",cardBg:"bg-indigo-900/40",subtleBg:"bg-indigo-950/30",border:"border-indigo-800/40",text:"text-white",sidebarText:"text-white",mutedText:"text-indigo-200",pageBg:"bg-gradient-to-br from-indigo-950 via-indigo-900 to-slate-900",navBtnBg:"bg-indigo-950/40",navBtnHoverBg:"hover:bg-indigo-900/40"}:i.value==="slate"?{sidebarBg:"bg-slate-900/70",headerBg:"bg-slate-900/60",bottomBg:"bg-slate-900/60",cardBg:"bg-slate-800/70",subtleBg:"bg-slate-900/40",border:"border-slate-700/40",text:"text-white",sidebarText:"text-white",mutedText:"text-slate-200",pageBg:"bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",navBtnBg:"bg-slate-800/70",navBtnHoverBg:"hover:bg-slate-700/70"}:{sidebarBg:"bg-slate-900/70",headerBg:"bg-slate-900/60",bottomBg:"bg-slate-900/60",cardBg:"bg-slate-800/70",subtleBg:"bg-slate-900/40",border:"border-slate-700/40",text:"text-white",sidebarText:"text-white",mutedText:"text-slate-200",pageBg:"bg-gradient-to-br from-slate-900 via-indigo-950 to-slate-800",navBtnBg:"bg-slate-800/70",navBtnHoverBg:"hover:bg-slate-700/70"}),L=async()=>{localStorage.setItem("adminTheme",i.value);try{const e=await(await fetch("/api/frontend/config",{credentials:"include"})).json();let d={};e.code===1?d={...e.data,adminTheme:i.value}:d={adminTheme:i.value};const r=await fetch("/api/settings",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(d)});(await r.json()).code===1&&v().add({title:(r==null?void 0:r.msg)||"已保存",color:"green"})}catch{}},j=async()=>{try{const e=await(await fetch("/api/frontend/config",{credentials:"include"})).json();e.code===1&&typeof e.data.allowRegistration=="boolean"&&(P.value=e.data.allowRegistration)}catch{v().add({title:"获取注册配置失败",color:"red"})}};fe(j);const J=async()=>{try{const e=await(await fetch("/api/frontend/config",{credentials:"include"})).json();let d={};e.code===1?d={...e.data,allowRegistration:P.value}:d={allowRegistration:P.value};const T=await(await fetch("/api/settings",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(d)})).json();if(T.code===1)v().add({title:"保存成功",color:"green"});else throw new Error(T.msg||"保存失败")}catch{v().add({title:"保存失败",color:"red"})}},S=Yt(),{login:A,register:u}=Ts(),I=el(),C=B(""),R=te({checking:!1,hasUpdate:!1,latestVersion:""});let q=te({webhookEnabled:!1,webhookURL:"",telegramEnabled:!1,telegramToken:"",telegramChatID:"",weworkEnabled:!1,weworkKey:"",feishuEnabled:!1,feishuWebhook:"",feishuSecret:""});const y=te({enabled:!1,driver:"smtp",host:"",port:"",user:"",pass:"",from:"",tls:!1,encryption:"tls"}),f=B(!1),le=async()=>{try{const l=await je("frontend/config",void 0,{credentials:"include"});if(l&&l.code===1){const e=l.data||{};y.enabled=!!e.smtpEnabled,y.driver=e.smtpDriver||"smtp",y.host=e.smtpHost||"",y.port=(e.smtpPort??"").toString(),y.user=e.smtpUser||"",y.pass=e.smtpPass||"",y.from=e.smtpFrom||"",y.tls=!!e.smtpTLS,y.encryption=e.smtpEncryption||(y.tls?"tls":"ssl")}}catch{}};fe(le);const se=async()=>{try{const l=await je("frontend/config",void 0,{credentials:"include"}),e=(l==null?void 0:l.code)===1?{...l.data}:{};e.smtpEnabled=y.enabled,e.smtpDriver=y.driver,e.smtpHost=y.host,e.smtpPort=parseInt(y.port||"0")||0,e.smtpUser=y.user,e.smtpPass=y.pass,e.smtpFrom=y.from,e.smtpEncryption=y.encryption,e.smtpTLS=y.encryption==="tls";const d=await We("settings",e,{credentials:"include"});if(d&&d.code===1)v().add({title:(d==null?void 0:d.msg)||"已保存",color:"green"});else throw new Error((d==null?void 0:d.msg)||"保存失败")}catch(l){v().add({title:"保存失败",description:l.message,color:"red"})}},ue=B([]);B("");const me=B(""),be=B(!1),ce=B(!1),Q=te({newPass:"",confirmPass:""}),H=$(()=>{const l=Q.newPass||"";let e=0;return l.length>=8&&e++,/[A-Z]/.test(l)&&/[a-z]/.test(l)&&e++,/\d/.test(l)&&/[^A-Za-z0-9]/.test(l)&&e++,Math.min(e,3)}),oe=$(()=>H.value<=1?"弱":H.value===2?"中":"强"),pe=$(()=>H.value<=1?"red":H.value===2?"orange":"green"),Me=$(()=>!Q.newPass||!Q.confirmPass||Q.newPass!==Q.confirmPass?!1:H.value>=2),F=async()=>{try{const l=await je("frontend/config",void 0,{credentials:"include"});if(l&&l.code===1){const e=l.data||{};ue.value=Array.isArray(e.adminUsers)?e.adminUsers:[],me.value=e.adminPasswordMasked||""}}catch{}};fe(F);const sl=async()=>{try{if(!Me.value)throw new Error("请填写符合强度的新密码并确认一致");const l=await je("frontend/config",void 0,{credentials:"include"}),e=(l==null?void 0:l.code)===1?{...l.data}:{};e.adminPasswordReset=Q.newPass;const d=await We("settings",e,{credentials:"include"});if(d&&d.code===1)v().add({title:(d==null?void 0:d.msg)||"管理员密码已重置",color:"green"}),await F(),be.value=!1,ce.value=!1,Q.newPass="",Q.confirmPass="";else throw new Error((d==null?void 0:d.msg)||"重置失败")}catch(l){v().add({title:"重置失败",description:l.message,color:"red"})}},it=B(""),Ct=$(()=>{const l=S.status||{},e=l.users||l.Users||[];return Array.isArray(e)?e:[]}),al=$(()=>{const l=(it.value||"").trim().toLowerCase();return l?Ct.value.filter(e=>{const d=String(e.id??e.ID??e.user_id??""),r=String(e.username??e.Username??"").toLowerCase();return d.includes(l)||r.includes(l)}):Ct.value}),Tt=async()=>{await S.getStatus()},De=B(!1),rt=B({}),dt=l=>!!rt.value[String(l.id??l.ID)],ol=l=>{const e=String(l.id??l.ID);rt.value[e]=!rt.value[e]},Oe=te({password:{}}),Fe=B(!1),nl=l=>(Oe.password[String(l.id??l.ID)]||"").trim().length>=6,il=async l=>{try{const e=l.id??l.ID??l.user_id,d=(Oe.password[String(e)]||"").trim();if(d.length<6)throw new Error("密码至少6位");const r=await Ve("user/reset_password",{id:e,password:d},{credentials:"include"});if(r&&r.code===1)v().add({title:(r==null?void 0:r.msg)||"已重置密码",color:"green"}),Oe.password[String(e)]="";else throw new Error((r==null?void 0:r.msg)||"重置失败")}catch(e){v().add({title:"重置失败",description:e.message,color:"red"})}},rl=async l=>{try{const e=l.username??l.Username;if(!window.confirm(`确定要切换用户“${e}”的管理员权限吗？`)||!window.confirm("该操作存在风险，是否继续？"))return;const d=l.id??l.ID??l.user_id,r=await We(`user/admin?id=${d}`,{},{credentials:"include"});if(r&&r.code===1)v().add({title:(r==null?void 0:r.msg)||"已更新管理员状态",color:"green"}),await S.getStatus();else throw new Error((r==null?void 0:r.msg)||"更新失败")}catch(e){v().add({title:"更新失败",description:e.message,color:"red"})}},dl=async l=>{try{const e=l.username??l.Username;if(!window.confirm(`确定要删除用户“${e}”吗？删除后不可恢复。`)||!window.confirm("该操作存在风险，是否继续？"))return;const d=l.id??l.ID??l.user_id,r=await Gt("user",{id:d},{credentials:"include"});if(r&&r.code===1)v().add({title:(r==null?void 0:r.msg)||"已删除用户",color:"green"}),await S.getStatus();else throw new Error((r==null?void 0:r.msg)||"删除失败")}catch(e){v().add({title:"删除失败",description:e.message,color:"red"})}},ut=B(!1),ul=async()=>{try{const l=(y.from||y.user||"").trim();if(!l||!y.host||!y.port||!y.user||!y.pass||!y.encryption)throw new Error("请完整填写地址、主机、端口、加密协议、用户名和密码");ut.value=!0,y.enabled||(y.enabled=!0,await se());let e=await Ve("notify/test",{type:"email",to:l},{credentials:"include"});if((!e||e.code!==1)&&(e=await Ve("email/test",{to:l},{credentials:"include"})),e&&e.code===1)v().add({title:(e==null?void 0:e.msg)||"测试邮件已发送",color:"green"});else throw new Error((e==null?void 0:e.msg)||"发送失败或接口不存在")}catch(l){v().add({title:"失败",description:l.message,color:"red"})}finally{ut.value=!1}},ml=()=>{try{if(!c.githubOAuthEnabled)throw new Error("请先开启 GitHub 登录");if(!c.githubClientId||!c.githubCallbackURL)throw new Error("请先填写 Client ID 与回调地址");const l=wt().public.baseApi||"/api";window.open(`${l}/oauth/github/login`,"_blank")}catch(l){v().add({title:"无法测试",description:l.message,color:"red"})}},cl=async()=>{R.checking=!0;try{const e=await(await fetch("/api/version/check",{credentials:"include",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}})).json();if(e.code===1){const{hasUpdate:d,lastUpdateTime:r}=e.data;R.hasUpdate=d,R.latestVersion=new Date(r).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),d?v().add({title:"发现版本",description:`最新版本发布于 ${R.latestVersion}`,color:"orange"}):v().add({title:"已是最新版本",description:"当前使用的是最新版本",color:"green"})}else throw new Error(e.msg||"检查更新失败")}catch(l){console.error("检查版本更新失败:",l),v().add({title:"检查更新失败",description:"请科学上网后重试",color:"red"})}finally{R.checking=!1}},pl=async()=>{var l;if(!S.isLogin){v().add({title:"错误",description:"请先登录",color:"red"});return}try{if(typeof window<"u"&&!window.confirm("重新生成将使旧 Token 失效，确认继续？"))return;mt.value=!0;const e=await fetch("/api/user/token/regenerate",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}}),d=await e.json();if(!e.ok)throw new Error(d.msg||"Token生成请求失败");if(d.code===1&&((l=d.data)!=null&&l.token))C.value=d.data.token,Be.value=!1,v().add({title:"成功",description:(d==null?void 0:d.msg)||"Token 已更新",color:"green"});else throw new Error(d.msg||"Token 生成失败")}catch(e){console.error("Token生成错误:",e),v().add({title:"错误",description:e.message||"Token 生成失败",color:"red"})}finally{mt.value=!1}},gl=async()=>{try{await navigator.clipboard.writeText(C.value),v().add({title:"成功",description:"Token 已复制到剪贴板",color:"green"})}catch{v().add({title:"错误",description:"复制失败",color:"red"})}},Ut=async()=>{try{const l=await fetch("/api/user/logout",{method:"POST",credentials:"include"}),e=await l.json().catch(()=>({}));if(!l.ok||e.code!==1)throw new Error((e==null?void 0:e.msg)||"退出失败");S.clearUserStatus(),v().add({title:"成功",description:"已退出登录",color:"green"}),I.push("/")}catch{S.clearUserStatus(),v().add({title:"成功",description:"已退出登录",color:"green"}),I.push("/")}},qe=$(()=>(S==null?void 0:S.isLogin)??!1),St=$(()=>{var l;return((l=S.user)==null?void 0:l.is_admin)??!1}),we=B(!0),Ge=B(!1),Bt=B(!1),Je=B(null),M=te({username:"",oldPassword:"",newPassword:"",confirmPassword:""}),Y=te({username:!1,password:!1}),Be=B(!1),mt=B(!1),_e=B(!1),Ze=B(!1),Qe=B(!1),Ae=$(()=>{const l=M.newPassword||"";let e=0;return l.length>=8&&e++,/[A-Z]/.test(l)&&/[a-z]/.test(l)&&e++,/\d/.test(l)&&/[^A-Za-z0-9]/.test(l)&&e++,Math.min(e,3)}),vl=$(()=>Ae.value<=1?"弱":Ae.value===2?"中":"强"),fl=$(()=>Ae.value<=1?"red":Ae.value===2?"orange":"green"),bl=$(()=>!M.oldPassword||!M.newPassword||!M.confirmPassword||M.newPassword===M.oldPassword||M.newPassword!==M.confirmPassword?!1:Ae.value>=2),wl=async()=>{try{if(!M.username.trim())throw new Error("用户名不能为空");const l=await We("user/update",{username:M.username,type:"username"},{credentials:"include"});if(l&&l.code===1)await S.getUser(),Y.username=!1,M.username="",v().add({title:"成功",description:(l==null?void 0:l.msg)||"用户名已更新",color:"green"});else throw new Error(l==null?void 0:l.msg)}catch(l){v().add({title:"错误",description:l.message||"更新失败",color:"red"})}},yl=async()=>{try{if(!M.newPassword||!M.oldPassword||!M.confirmPassword)throw new Error("密码不能为空");if(M.newPassword===M.oldPassword)throw new Error("新密码不能与当前密码相同");if(M.newPassword!==M.confirmPassword)throw new Error("两次输入不一致");if(Ae.value<2)throw new Error("密码强度不足");const l=await We("user/change_password",{password:M.newPassword,oldPassword:M.oldPassword},{credentials:"include"});if(l&&l.code===1)Y.password=!1,M.oldPassword="",M.newPassword="",M.confirmPassword="",v().add({title:"成功",description:(l==null?void 0:l.msg)||"密码已更新",color:"green"});else throw new Error(l==null?void 0:l.msg)}catch(l){v().add({title:"错误",description:l.message||"更新失败",color:"red"})}},ct={siteTitle:"站点标题",subtitleText:"欢迎语",avatarURL:"头像链接",username:"用户名",description:"个人描述",backgrounds:"背景图片",cardFooterTitle:"卡片页脚标题",cardFooterLink:"卡片页脚链接",pageFooterHTML:"页面底部HTML",rssTitle:"RSS 标题",rssDescription:"RSS 描述",rssAuthorName:"RSS 作者",rssFaviconURL:"RSS 图标链接"},c=te({siteTitle:"",subtitleText:"",avatarURL:"",username:"",description:"",backgrounds:[],cardFooterTitle:"",cardFooterLink:"",pageFooterHTML:"",rssTitle:"",rssDescription:"",rssAuthorName:"",rssFaviconURL:"",walineServerURL:"",commentEnabled:!1,commentSystem:"waline",commentEmailEnabled:!1,githubOAuthEnabled:!1,githubClientId:"",githubClientSecret:"",githubCallbackURL:"",notifyEnabled:!1,enableGithubCard:!1,pwaEnabled:!0,pwaTitle:"",pwaDescription:"",pwaIconURL:"",defaultContentTheme:"light",announcementText:"",announcementEnabled:!0,musicEnabled:!1,musicPlaylistId:"",musicSongId:"",musicPosition:"bottom-left",musicTheme:"auto",musicLyric:!0,musicAutoplay:!1,musicDefaultMinimized:!0,musicEmbed:!1,musicCssCdnURL:"",musicJsCdnURL:""}),ye=$({get:()=>c.enableGithubCard===!0,set:l=>{const e=l===!0||l==="true"||l===1||l==="1";c.enableGithubCard=e}}),Te=te({username:"",password:""}),xe=te({siteTitle:!1,subtitleText:!1,avatarURL:!1,username:!1,description:!1,backgrounds:!1,cardFooterTitle:!1,cardFooterLink:!1,pageFooterHTML:!1,rssTitle:!1,rssDescription:!1,rssAuthorName:!1,rssFaviconURL:!1,walineServerURL:!1}),ee={siteTitle:"Noise的说说笔记",subtitleText:"欢迎访问，点击头像可更换封面背景！",avatarURL:"https://s2.loli.net/2025/03/24/HnSXKvibAQlosIW.png",username:"Noise",description:"执迷不悟",backgrounds:["https://s2.loli.net/2025/03/27/KJ1trnU2ksbFEYM.jpg","https://s2.loli.net/2025/03/27/MZqaLczCvwjSmW7.jpg","https://s2.loli.net/2025/03/27/UMijKXwJ9yTqSeE.jpg","https://s2.loli.net/2025/03/27/WJQIlkXvBg2afcR.jpg","https://s2.loli.net/2025/03/27/oHNQtf4spkq2iln.jpg","https://s2.loli.net/2025/03/27/PMRuX5loc6Uaimw.jpg","https://s2.loli.net/2025/03/27/U2WIslbNyTLt4rD.jpg","https://s2.loli.net/2025/03/27/xu1jZL5Og4pqT9d.jpg","https://s2.loli.net/2025/03/27/OXqwzZ6v3PVIns9.jpg","https://s2.loli.net/2025/03/27/HGuqlE6apgNywbh.jpg","https://s2.loli.net/2025/03/26/d7iyuPYA8cRqD1K.jpg","https://s2.loli.net/2025/03/27/wYy12qDMH6bGJOI.jpg","https://s2.loli.net/2025/03/27/y67m2k5xcSdTsHN.jpg"],cardFooterTitle:"Noise·说说·笔记~",cardFooterLink:"note.noisework.cn",pageFooterHTML:'<div class="text-center text-xs text-gray-400 py-4">来自<a href="https://www.noisework.cn" target="_blank" rel="noopener noreferrer" class="text-orange-400 hover:text-orange-500">Noise</a> 使用<a href="https://github.com/rcy1314/echo-noise" target="_blank" rel="noopener noreferrer" class="text-orange-400 hover:text-orange-500">Ech0-Noise</a>发布</div>',rssTitle:"Noise的说说笔记",rssDescription:"一个说说笔记~",rssAuthorName:"Noise",rssFaviconURL:"/favicon.ico",walineServerURL:"请前往waline官网https://waline.js.org查看部署配置",githubOAuthEnabled:!1,githubClientId:"",githubClientSecret:"",githubCallbackURL:"",pwaEnabled:!0,pwaTitle:"",pwaDescription:"",pwaIconURL:"",defaultContentTheme:"light",announcementText:"欢迎访问我的说说笔记！",announcementEnabled:!0,musicEnabled:!1,musicPlaylistId:"2141128031",musicSongId:"",musicPosition:"bottom-left",musicTheme:"auto",musicLyric:!0,musicAutoplay:!1,musicDefaultMinimized:!0,musicEmbed:!1,musicCssCdnURL:"",musicJsCdnURL:""},xl=l=>{c[l]=ee[l],xe[l]=!1},he=async()=>{var l;try{const d=await(await fetch("/api/frontend/config",{credentials:"include",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}})).json();if((l=d==null?void 0:d.data)!=null&&l.frontendSettings){const r=d.data.frontendSettings,T=["enableGithubCard","pwaEnabled","announcementEnabled","musicEnabled","musicLyric","musicAutoplay","musicDefaultMinimized","musicEmbed","commentEnabled","commentEmailEnabled","githubOAuthEnabled","notifyEnabled"];if(Object.keys(c).forEach(_=>{if(_==="backgrounds"){const X=r[_];Array.isArray(X)&&(c[_]=[...X])}else if(T.includes(_)){const X=r[_]??ee[_];c[_]=X===!0||X==="true"}else{const X=r[_]??ee[_];c[_]=typeof X=="string"?X.trim():X}}),r.enableGithubCard!==void 0){const _=r.enableGithubCard;c.enableGithubCard=_===!0||_==="true"}const V=(c.pwaTitle||c.siteTitle||"说说笔记").trim(),G=(c.rssFaviconURL||"/favicon.ico").trim(),ae=(c.pwaDescription||c.description||"").trim();ns({title:V,meta:[{name:"description",content:ae},{name:"theme-color",content:"#000000"}],link:[{rel:"manifest",href:"/manifest.webmanifest"},{rel:"icon",href:G}]})}}catch(e){console.error("获取配置失败:",e)}},ne=async l=>{try{if(l==="backgrounds"){const T=c.backgrounds.filter(V=>V&&V.trim()!=="");c.backgrounds=T}const d=await fetch("/api/settings",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({frontendSettings:c})});if(!d.ok){const T=await d.json();throw new Error(T.msg||"请求失败")}const r=await d.json();if(r.code===1){if(xe[l]=!1,await he(),l==="announcementEnabled"){const T=!!c.announcementEnabled;v().add({title:"成功",description:T?"已开启公告":"已关闭公告",color:T?"green":"gray"})}else{const T=l==="defaultContentTheme"?"默认主题色":ct[l]||(l==="pwa"?"PWA 设置":l);v().add({title:"成功",description:`${T}已更新`,color:"green"})}if(l==="defaultContentTheme"){const T=(c.defaultContentTheme||"dark").trim()}}else throw new Error(r.msg||"保存失败")}catch(e){console.error("保存配置失败:",e);const d=l==="defaultContentTheme"?"默认主题色":ct[l]||l;v().add({title:"失败",description:`${d}保存失败`,color:"red"})}},hl=async()=>{try{const e=await fetch("/api/settings",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({frontendSettings:c})}),d=await e.json();if(e.ok&&d.code===1){if(await he(),v().add({title:"成功",description:"PWA 设置已更新",color:"green"}),"serviceWorker"in navigator){const r=await navigator.serviceWorker.getRegistrations();if(c.pwaEnabled)await navigator.serviceWorker.register("/sw.js");else{for(const V of r)await V.unregister();const T=await caches.keys();await Promise.all(T.map(V=>caches.delete(V)))}}window.dispatchEvent(new Event("frontend-config-updated"))}else throw new Error(d.msg||"保存失败")}catch(l){v().add({title:"错误",description:l.message||"保存失败",color:"red"})}},kl=async()=>{try{const l={frontendSettings:{commentEnabled:!!c.commentEnabled,commentSystem:String(c.commentSystem||"waline"),commentEmailEnabled:!!c.commentEmailEnabled,walineServerURL:String(c.walineServerURL||"")}},e=await fetch("/api/settings",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(l)}),d=await e.json();if(e.ok&&d.code===1)await he(),window.dispatchEvent(new Event("frontend-config-updated")),v().add({title:"成功",description:"评论设置已更新",color:"green"});else throw new Error(d.msg||"保存失败")}catch(l){v().add({title:"错误",description:l.message||"保存失败",color:"red"})}},Xe=B(""),ge=B(!1),$e=B([]),Le=B(1),Ye=B(!1),et=B({}),pt=B(String(c.commentSystem||"waline")),Vl=l=>{try{const e=new Date(l);if(isNaN(e.getTime()))return String(l);const d=r=>r.toString().padStart(2,"0");return`${e.getFullYear()}-${d(e.getMonth()+1)}-${d(e.getDate())} ${d(e.getHours())}:${d(e.getMinutes())}`}catch{return String(l)}},El=()=>{ge.value=!ge.value,ge.value&&At()},gt=l=>!!et.value[l.id],Cl=l=>{et.value[l.id]=!et.value[l.id]},At=async()=>{var l,e;try{ge.value=!0,$e.value.splice(0),Le.value=1;const d=(Xe.value||"").trim(),r=await je("comments",{q:d,page:Le.value,pageSize:30},{credentials:"include"});if(r&&r.code===1){const T=Array.isArray((l=r.data)==null?void 0:l.items)?r.data.items:[];T.forEach(G=>$e.value.push(G));const V=Number(((e=r.data)==null?void 0:e.total)||0);Ye.value=Le.value*30<V,T.length===0?v().add({title:"无结果",description:"未找到匹配评论",color:"gray"}):v().add({title:"已加载",description:`本页 ${T.length} 条${Ye.value?"，还有更多":""}`,color:"green"})}else throw new Error((r==null?void 0:r.msg)||"加载失败")}catch(d){v().add({title:"加载失败",description:d.message,color:"red"})}},Tl=async()=>{var l,e;try{Le.value+=1;const d=(Xe.value||"").trim(),r=await je("comments",{q:d,page:Le.value,pageSize:30},{credentials:"include"});if(r&&r.code===1){(Array.isArray((l=r.data)==null?void 0:l.items)?r.data.items:[]).forEach(G=>$e.value.push(G));const V=Number(((e=r.data)==null?void 0:e.total)||0);Ye.value=Le.value*30<V}else throw new Error((r==null?void 0:r.msg)||"加载失败")}catch(d){v().add({title:"加载失败",description:d.message,color:"red"})}},Ul=async l=>{try{const e=await Gt(`messages/${l.message_id}/comments/${l.id}`,void 0,{credentials:"include"});if(e&&e.code===1){const d=$e.value.findIndex(r=>r.id===l.id);d>=0&&$e.value.splice(d,1),delete et.value[l.id],v().add({title:"成功",description:"已删除该评论",color:"green"})}else throw new Error((e==null?void 0:e.msg)||"删除失败")}catch(e){v().add({title:"删除失败",description:e.message,color:"red"})}};Se(()=>String(c.commentSystem||"").toLowerCase(),l=>{pt.value=l,l!=="builtin"&&(ge.value=!1)}),Se(()=>!!c.commentEnabled,l=>{l||(ge.value=!1)});const Sl=async()=>{try{const l={frontendSettings:{enableGithubCard:!!ye.value}},e=await fetch("/api/settings",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(l)}),d=await e.json();if(e.ok&&d.code===1)c.enableGithubCard=!!ye.value,await he(),window.dispatchEvent(new Event("frontend-config-updated")),v().add({title:"成功",description:"GitHub 解析设置已保存",color:"green"});else throw new Error(d.msg||"保存失败")}catch(l){v().add({title:"错误",description:l.message||"保存失败",color:"red"})}},$t=async()=>{try{const l={frontendSettings:{musicEnabled:!!c.musicEnabled,musicPlaylistId:String(c.musicPlaylistId||""),musicSongId:String(c.musicSongId||""),musicPosition:String(c.musicPosition||"bottom-left"),musicTheme:String(c.musicTheme||"auto"),musicLyric:!!c.musicLyric,musicAutoplay:!!c.musicAutoplay,musicDefaultMinimized:!!c.musicDefaultMinimized,musicEmbed:!!c.musicEmbed,musicCssCdnURL:String(c.musicCssCdnURL||""),musicJsCdnURL:String(c.musicJsCdnURL||"")}},e=await fetch("/api/settings",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(l)}),d=await e.json();if(e.ok&&d.code===1)await he(),window.dispatchEvent(new Event("frontend-config-updated")),v().add({title:"成功",description:"音乐配置已更新",color:"green"});else throw new Error(d.msg||"保存失败")}catch(l){v().add({title:"错误",description:l.message||"保存失败",color:"red"})}},Bl=()=>{c.musicEnabled=ee.musicEnabled,c.musicPlaylistId=ee.musicPlaylistId,c.musicSongId=ee.musicSongId,c.musicPosition=ee.musicPosition,c.musicTheme=ee.musicTheme,c.musicLyric=ee.musicLyric,c.musicAutoplay=ee.musicAutoplay,c.musicDefaultMinimized=ee.musicDefaultMinimized,c.musicEmbed=ee.musicEmbed,c.musicCssCdnURL=ee.musicCssCdnURL,c.musicJsCdnURL=ee.musicJsCdnURL},Lt=$({get:()=>c.musicEmbed?"embed":"float",set:l=>{c.musicEmbed=l==="embed"}}),Al=async()=>{try{await ne("githubOAuthEnabled"),await ne("githubClientId"),await ne("githubClientSecret"),await ne("githubCallbackURL"),v().add({title:"成功",description:"GitHub 登录配置已保存",color:"green"})}catch(l){v().add({title:"错误",description:(l==null?void 0:l.message)||"保存失败",color:"red"})}},$l=async l=>{const e=l.target.files;if(!e)return;const d=["image/jpeg","image/png","image/webp"];for(const r of Array.from(e))try{if(!d.includes(r.type))throw new Error("仅支持 JPG/PNG/WEBP 格式");const T=new FormData;T.append("image",r);const V=await fetch("/api/images/upload",{method:"POST",credentials:"include",body:T}),G=await V.json();if(!V.ok||G.code!==1)throw new Error(G.msg||"上传失败");if(G.code===1&&G.data){const ae=G.data.startsWith("http")?G.data:`/api${G.data}`,_=[...c.backgrounds,ae];c.backgrounds=_,await ne("backgrounds"),v().add({title:"上传成功",description:`${r.name} 已添加到背景图片列表`,color:"green"})}}catch(T){v().add({title:"上传失败",description:T.message||"文件上传失败",color:"red"})}Je.value&&(Je.value.value="")};fe(()=>{window.addEventListener("frontend-config-updated",l=>{const{key:e,value:d}=l.detail;e&&d!==void 0&&(c[e]=d)})});const Ll=()=>{he(),Bt.value=!1},Rl=async()=>{c.backgrounds.push("")},Pl=async l=>{c.backgrounds.splice(l,1),await ne("backgrounds")},jl=()=>{var l;(l=Je.value)==null||l.click()},Il=l=>{window.open(l,"_blank")};Se(()=>S.isLogin,l=>{l||(S.getStatus(),S.getUser(),S.$reset())});const Rt=B(!1);fe(async()=>{var l;try{if(Rt.value=!0,await Promise.all([S.getStatus(),S.getUser(),he(),j()]),S.isLogin){const d=await(await fetch("/api/user/token",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}})).json();d.code===1&&((l=d.data)!=null&&l.token)&&(C.value=d.data.token)}}catch(e){console.error("初始化失败:",e),v().add({title:"系统提示",description:"当前未登录",color:"red",timeout:3e3})}finally{Rt.value=!1}});const ze=B(null),Re=B("sqlite"),Hl=$(()=>({sqlite:"SQLite",postgres:"Postgres",mysql:"MySQL",other:"其它"})[Re.value]||Re.value),Ml=async()=>{try{const l=await fetch("/api/backup/download",{credentials:"include"});if(!l.ok)throw new Error("下载失败");const e=await l.blob(),d=window.URL.createObjectURL(e),r=document.createElement("a");r.href=d,r.download=`noise_backup_${new Date().toISOString().slice(0,10)}.zip`,document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(d),document.body.removeChild(r)}catch(l){v().add({title:"错误",description:l.message||"备份下载失败",color:"red"})}},Dl=()=>{var l;(l=ze.value)==null||l.click()},Ol=O,Pt=async l=>{const e=l.target.files;if(!(!e||!e[0])){try{const d=new FormData;d.append("database",e[0]);const T=await(await fetch("/api/backup/restore",{method:"POST",credentials:"include",body:d})).json();if(T.code===1)v().add({title:"成功",description:"数据库恢复成功",color:"green"}),Ol("restore-success"),setTimeout(()=>{window.location.reload()},1500);else throw new Error(T.msg)}catch(d){v().add({title:"错误",description:d.message||"数据库恢复失败",color:"red"})}ze.value&&(ze.value.value="")}},N=B(!1),k=te({provider:"",endpoint:"",region:"",bucket:"",accessKey:"",secretKey:"",usePathStyle:!0,publicBaseURL:""}),Ue=B(!1),Ne=B("instant"),tt=B(15),jt=B(""),lt=B(""),st=B(""),vt=async()=>{try{const e=await(await fetch("/api/frontend/config",{credentials:"include"})).json();if((e==null?void 0:e.code)===1){const d=(e.data.dbType||"sqlite").toLowerCase();Re.value=d==="sqlite"||d==="postgres"||d==="mysql"?d:"other",N.value=!!e.data.storageEnabled;const r=e.data.storageConfig||{};k.provider=r.provider||"",k.endpoint=r.endpoint||"",k.region=r.region||"",k.bucket=r.bucket||"",k.accessKey=r.accessKey||"",k.secretKey=r.secretKey||"",k.usePathStyle=!!r.usePathStyle,k.publicBaseURL=r.publicBaseURL||"",Ue.value=!!r.autoSyncEnabled,Ne.value=r.syncMode||"instant",tt.value=Number(r.syncIntervalMinute||15),jt.value=(r.lastSyncTime||"").replace("T"," ").replace("Z","")}}catch{}},zl=async()=>{try{const l={storageEnabled:N.value,storageConfig:{...k,autoSyncEnabled:Ue.value,syncMode:Ne.value,syncIntervalMinute:tt.value}},d=await(await fetch("/api/settings",{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})).json();if((d==null?void 0:d.code)===1)v().add({title:"已保存云存储配置",color:"green"});else throw new Error((d==null?void 0:d.msg)||"保存失败")}catch(l){v().add({title:"保存失败",description:l.message,color:"red"})}},Nl=async()=>{try{const e=await(await fetch("/api/backup/storage/sync-now",{method:"POST",credentials:"include"})).json();if((e==null?void 0:e.code)===1)v().add({title:"已同步到云端",color:"green"}),await vt();else throw new Error((e==null?void 0:e.msg)||"同步失败")}catch(l){v().add({title:"同步失败",description:l.message,color:"red"})}};Se(()=>k.provider,l=>{l==="r2"?(k.usePathStyle=!0,k.region||(k.region="auto")):l==="s3"&&k.usePathStyle===void 0&&(k.usePathStyle=!1)});const Wl=async()=>{try{const l=lt.value.trim();if(!l)throw new Error("请填写预签名上传URL");const e=await Ve("backup/storage/upload",{uploadURL:l},{credentials:"include"});if((e==null?void 0:e.code)===1)v().add({title:"云备份上传成功",color:"green"});else throw new Error((e==null?void 0:e.msg)||"上传失败")}catch(l){v().add({title:"上传失败",description:l.message,color:"red"})}},Kl=async()=>{try{const l=st.value.trim();if(!l)throw new Error("请填写预签名下载URL");const e=await Ve("backup/storage/restore",{downloadURL:l},{credentials:"include"});if((e==null?void 0:e.code)===1)v().add({title:"云备份恢复成功",color:"green"});else throw new Error((e==null?void 0:e.msg)||"恢复失败")}catch(l){v().add({title:"恢复失败",description:l.message,color:"red"})}},Fl=async()=>{var l;try{const e=await Ve("backup/storage/presign/upload",{objectKey:"backup.zip",contentType:"application/zip",expiresSeconds:3600},{credentials:"include"});if((e==null?void 0:e.code)===1&&((l=e==null?void 0:e.data)!=null&&l.url))lt.value=e.data.url,v().add({title:"生成上传预签名成功",color:"green"});else throw new Error((e==null?void 0:e.msg)||"生成失败")}catch(e){v().add({title:"生成失败",description:e.message,color:"red"})}},ql=async()=>{var l;try{const e=await Ve("backup/storage/presign/download",{objectKey:"backup.zip",expiresSeconds:3600},{credentials:"include"});if((e==null?void 0:e.code)===1&&((l=e==null?void 0:e.data)!=null&&l.url))st.value=e.data.url,v().add({title:"生成下载预签名成功",color:"green"});else throw new Error((e==null?void 0:e.msg)||"生成失败")}catch(e){v().add({title:"生成失败",description:e.message,color:"red"})}},Gl=async()=>{try{const l=(k.publicBaseURL||"").trim();if(!l)throw new Error("请先在配置中填写公共访问前缀");const e=(l.endsWith("/")?l:l+"/")+"backup.zip",d=await Ve("backup/storage/restore",{downloadURL:e},{credentials:"include"});if((d==null?void 0:d.code)===1)v().add({title:"云备份恢复成功",color:"green"});else throw new Error((d==null?void 0:d.msg)||"恢复失败")}catch(l){v().add({title:"恢复失败",description:l.message,color:"red"})}};return(l,e)=>{var Mt,Dt,Ot,zt,Nt,Wt,Kt,Ft;const d=xt,r=ht,T=ys,V=kt,G=is,ae=rs,_=Vt,X=Et,ke=tl("USwitch"),Jl=ls,It=us,Ht=cs,_l=ms;return b(),w("div",{class:n(["fixed inset-0 w-full h-full overflow-x-hidden overflow-y-auto",s.value.pageBg])},[t("div",na,[t("aside",{class:n(["w-72 h-screen overflow-y-auto backdrop-blur-md flex flex-col fixed left-0 top-0 z-40 transition-transform duration-300 md:transition-none border-r",[{"translate-x-0":h.value,"-translate-x-full md:translate-x-0":!h.value},s.value.sidebarBg,s.value.border,s.value.sidebarText]])},[t("div",ia,[t("img",{src:Z.value,class:"w-14 h-14 rounded-full ring-2 ring-indigo-400/60 shadow-lg object-cover",alt:"avatar"},null,8,ra),t("div",da,[t("div",ua,x(((Mt=ve(S).user)==null?void 0:Mt.username)||c.username||"未登录"),1),t("div",{class:n(["text-xs",s.value.mutedText])},"总笔记 "+x(((Ot=(Dt=ve(S))==null?void 0:Dt.status)==null?void 0:Ot.total_messages)||0),3)])]),t("nav",ma,[t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[s.value.navBtnBg,s.value.navBtnHoverBg]]),onClick:e[0]||(e[0]=a=>E("system"))},[o(d,{name:"i-heroicons-cpu-chip",class:"w-5 h-5 text-indigo-300"}),e[145]||(e[145]=t("span",{class:"text-sm text-center"},"系统信息",-1))],2),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[s.value.navBtnBg,s.value.navBtnHoverBg]]),onClick:e[1]||(e[1]=a=>E("user"))},[o(d,{name:"i-heroicons-user-circle",class:"w-5 h-5 text-indigo-300"}),e[146]||(e[146]=t("span",{class:"text-sm text-center"},"用户信息",-1))],2),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[s.value.navBtnBg,s.value.navBtnHoverBg]]),onClick:e[2]||(e[2]=a=>E("site"))},[o(d,{name:"i-heroicons-wrench-screwdriver",class:"w-5 h-5 text-indigo-300"}),e[147]||(e[147]=t("span",{class:"text-sm text-center"},"网站配置",-1))],2),St.value?(b(),w("div",ca,[t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[s.value.navBtnBg,s.value.navBtnHoverBg]]),onClick:e[3]||(e[3]=a=>E("site-register"))},[o(d,{name:"i-heroicons-user-plus",class:"w-5 h-5 text-indigo-300"}),e[148]||(e[148]=t("span",{class:"text-sm text-center"},"注册开关",-1))],2),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[s.value.navBtnBg,s.value.navBtnHoverBg]]),onClick:e[4]||(e[4]=a=>E("site-pwa"))},[o(d,{name:"i-heroicons-rocket-launch",class:"w-5 h-5 text-indigo-300"}),e[149]||(e[149]=t("span",{class:"text-sm text-center"},"PWA 模式",-1))],2),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[s.value.navBtnBg,s.value.navBtnHoverBg]]),onClick:e[5]||(e[5]=a=>E("site-github-card"))},[o(d,{name:"i-mdi-github",class:"w-5 h-5 text-indigo-300"}),e[150]||(e[150]=t("span",{class:"text-sm text-center"},"GitHub 卡片",-1))],2),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[s.value.navBtnBg,s.value.navBtnHoverBg]]),onClick:e[6]||(e[6]=a=>E("site-github-login"))},[o(d,{name:"i-mdi-github",class:"w-5 h-5 text-indigo-300"}),e[151]||(e[151]=t("span",{class:"text-sm text-center"},"GitHub 登录",-1))],2),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[s.value.navBtnBg,s.value.navBtnHoverBg]]),onClick:e[7]||(e[7]=a=>E("site-announcement"))},[o(d,{name:"i-heroicons-megaphone",class:"w-5 h-5 text-indigo-300"}),e[152]||(e[152]=t("span",{class:"text-sm text-center"},"公告栏",-1))],2),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[s.value.navBtnBg,s.value.navBtnHoverBg]]),onClick:e[8]||(e[8]=a=>E("site-music"))},[o(d,{name:"i-heroicons-musical-note",class:"w-5 h-5 text-indigo-300"}),e[153]||(e[153]=t("span",{class:"text-sm text-center"},"音乐配置",-1))],2),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[s.value.navBtnBg,s.value.navBtnHoverBg]]),onClick:e[9]||(e[9]=a=>E("site-default-theme"))},[o(d,{name:"i-heroicons-swatch",class:"w-5 h-5 text-indigo-300"}),e[154]||(e[154]=t("span",{class:"text-sm text-center"},"默认主题",-1))],2),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[s.value.navBtnBg,s.value.navBtnHoverBg]]),onClick:e[10]||(e[10]=a=>E("site-configs"))},[o(d,{name:"i-heroicons-cog-6-tooth",class:"w-5 h-5 text-indigo-300"}),e[155]||(e[155]=t("span",{class:"text-sm text-center"},"站点文案",-1))],2),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[s.value.navBtnBg,s.value.navBtnHoverBg]]),onClick:e[11]||(e[11]=a=>E("comments"))},[o(d,{name:"i-heroicons-chat-bubble-left-right",class:"w-5 h-5 text-indigo-300"}),e[156]||(e[156]=t("span",{class:"text-sm text-center"},"评论系统",-1))],2),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[s.value.navBtnBg,s.value.navBtnHoverBg]]),onClick:e[12]||(e[12]=a=>E("email"))},[o(d,{name:"i-heroicons-envelope",class:"w-5 h-5 text-indigo-300"}),e[157]||(e[157]=t("span",{class:"text-sm text-center"},"邮件设置",-1))],2),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[s.value.navBtnBg,s.value.navBtnHoverBg]]),onClick:e[13]||(e[13]=a=>E("admin-users"))},[o(d,{name:"i-heroicons-shield-check",class:"w-5 h-5 text-indigo-300"}),e[158]||(e[158]=t("span",{class:"text-sm text-center"},"管理员用户",-1))],2)])):D("",!0),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[s.value.navBtnBg,s.value.navBtnHoverBg]]),onClick:e[14]||(e[14]=a=>E("notify"))},[o(d,{name:"i-heroicons-bell-alert",class:"w-5 h-5 text-indigo-300"}),e[159]||(e[159]=t("span",{class:"text-sm text-center"},"推送配置",-1))],2),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[s.value.navBtnBg,s.value.navBtnHoverBg]]),onClick:e[15]||(e[15]=a=>E("db"))},[o(d,{name:"i-heroicons-circle-stack",class:"w-5 h-5 text-indigo-300"}),e[160]||(e[160]=t("span",{class:"text-sm text-center"},"数据库管理",-1))],2)]),t("div",pa,[e[161]||(e[161]=t("div",{class:"text-xs text-slate-400"},"当前版本: latest",-1)),t("div",ga,[o(r,{size:"xs",color:"gray",variant:"soft",loading:R.checking,class:"shadow-md",onClick:cl},{default:g(()=>[p(x(R.checking?"检测中...":"检查版本发布时间"),1)]),_:1},8,["loading"])]),R.hasUpdate?(b(),w("div",va,[o(d,{name:"i-heroicons-arrow-up-circle",class:"w-4 h-4"}),t("span",null,"最近更新于 "+x(R.latestVersion),1)])):D("",!0)])],2),t("main",{class:n(["w-full min-h-screen md:pl-72 overflow-y-auto",s.value.text])},[t("div",{class:n(["md:hidden flex items-center justify-between px-4 py-3 border-b rounded-b-2xl",[s.value.headerBg,s.value.border,s.value.text]])},[t("div",fa,[t("button",{class:"p-2 rounded-lg bg-slate-800/70 shadow",onClick:e[16]||(e[16]=a=>h.value=!h.value)},[o(d,{name:"i-heroicons-bars-3",class:"w-5 h-5"})]),e[162]||(e[162]=t("span",{class:"font-semibold"},"系统管理面板",-1))]),t("div",ba,[o(r,{variant:"soft",color:i.value==="light"?"gray":"white",class:"shadow",onClick:e[17]||(e[17]=a=>l.$router.push("/"))},{default:g(()=>e[163]||(e[163]=[p("返回首页")])),_:1},8,["color"]),qe.value?(b(),at(r,{key:0,icon:"i-heroicons-power",color:"red",variant:"solid",onClick:Ut},{default:g(()=>e[164]||(e[164]=[p("退出登录")])),_:1})):D("",!0)])],2),h.value?(b(),w("div",{key:0,class:"fixed inset-0 bg-black/40 md:hidden",onClick:e[18]||(e[18]=a=>h.value=!1)})):D("",!0),t("div",wa,[t("div",ya,[t("h1",{class:n(["text-2xl md:text-3xl font-bold text-center",s.value.text])},"系统管理面板",2)]),t("div",xa,[t("div",{class:n([s.value.cardBg,s.value.border,Ke])},[t("div",ha,[t("div",ka,[t("span",{class:n(s.value.text)},"配色",2),t("div",Va,[t("div",Ea,[o(T,{modelValue:i.value,"onUpdate:modelValue":e[19]||(e[19]=a=>i.value=a),value:"dark",class:"mr-2"},null,8,["modelValue"]),t("span",{class:n(i.value==="dark"?s.value.text:"text-slate-400")},"暗黑",2)]),t("div",Ca,[o(T,{modelValue:i.value,"onUpdate:modelValue":e[20]||(e[20]=a=>i.value=a),value:"midnight",class:"mr-2"},null,8,["modelValue"]),t("span",{class:n(i.value==="midnight"?s.value.text:"text-slate-400")},"深蓝",2)]),t("div",Ta,[o(T,{modelValue:i.value,"onUpdate:modelValue":e[21]||(e[21]=a=>i.value=a),value:"slate",class:"mr-2"},null,8,["modelValue"]),t("span",{class:n(i.value==="slate"?s.value.text:"text-slate-400")},"石板",2)]),t("div",Ua,[o(T,{modelValue:i.value,"onUpdate:modelValue":e[22]||(e[22]=a=>i.value=a),value:"light",class:"mr-2"},null,8,["modelValue"]),t("span",{class:n(i.value==="light"?s.value.text:"text-slate-400")},"明亮",2)])])]),t("div",Sa,[o(r,{size:"sm",color:"green",class:"shadow",onClick:L},{default:g(()=>e[165]||(e[165]=[p("保存")])),_:1})])])],2)]),t("div",Ba,[t("div",{class:n(["rounded-xl border shadow-xl",[s.value.cardBg,s.value.border]])},[t("div",Aa,[t("div",null,[t("span",{class:n(s.value.text)},"系统管理员",2),t("span",$a,x((Nt=(zt=ve(S))==null?void 0:zt.status)==null?void 0:Nt.username),1)]),t("div",null,[t("span",{class:n(s.value.text)},"当前用户",2),t("span",La,x(qe.value&&((Wt=ve(S).user)==null?void 0:Wt.username)||"未登录"),1)]),t("div",null,[t("span",{class:n(s.value.text)},"笔记总数",2),t("span",Ra,x((Ft=(Kt=ve(S))==null?void 0:Kt.status)==null?void 0:Ft.total_messages)+" 条",1)])])],2)]),qe.value?(b(),w("div",Pa,[t("div",{class:n(["rounded-xl border shadow-xl",[s.value.cardBg,s.value.border]])},[t("div",{class:n(["flex items-center justify-between px-4 py-3",s.value.text])},e[166]||(e[166]=[t("div",{class:"font-semibold"},"用户信息配置",-1)]),2),t("div",ja,[t("div",{class:n(["rounded-lg p-3 h-full",s.value.subtleBg])},[t("div",Ia,[t("span",{class:n(s.value.mutedText)},"用户名",2),o(r,{size:"sm",onClick:e[23]||(e[23]=a=>Y.username=!Y.username),color:Y.username?"gray":"green",variant:Y.username?"soft":"solid",class:"shadow"},{default:g(()=>[p(x(Y.username?"取消":"编辑"),1)]),_:1},8,["color","variant"])]),Y.username?(b(),w("div",Ha,[o(V,{modelValue:M.username,"onUpdate:modelValue":e[24]||(e[24]=a=>M.username=a),placeholder:"新用户名",class:"w-full mb-2"},null,8,["modelValue"]),t("div",Ma,[o(r,{onClick:wl,color:"primary",class:"shadow"},{default:g(()=>e[167]||(e[167]=[p("保存")])),_:1})])])):(b(),w("div",Da,[o(G,{color:"primary",variant:"soft",class:"ml-0 text-xs px-2 py-1 rounded-md !text-slate-800 dark:!text-slate-200"},{default:g(()=>{var a;return[p(x((a=ve(S).user)==null?void 0:a.username),1)]}),_:1})]))],2),t("div",{class:n(["rounded-lg p-3 h-full md:col-span-2",s.value.subtleBg])},[t("div",Oa,[t("div",za,[t("span",{class:n(s.value.mutedText)},"API Token",2),o(G,{color:"primary",variant:"subtle",class:"text-xs px-2 py-1 rounded-md !text-primary-600 dark:!text-primary-300"},{default:g(()=>[p(x(C.value?"已生成":"未生成"),1)]),_:1}),o(r,{size:"xs",loading:mt.value,onClick:pl,color:"gray",variant:"soft",class:"shadow text-xs px-2 py-1 rounded-md text-slate-600 dark:text-slate-200",title:"重新生成将使旧 Token 失效"},{default:g(()=>e[168]||(e[168]=[p("重新生成")])),_:1},8,["loading"])])]),C.value?(b(),w("div",Na,[t("div",Wa,[o(V,{modelValue:C.value,"onUpdate:modelValue":e[25]||(e[25]=a=>C.value=a),type:Be.value?"text":"password",readonly:"",class:"font-mono text-sm flex-1 min-w-0"},null,8,["modelValue","type"]),o(r,{icon:Be.value?"i-heroicons-eye-slash":"i-heroicons-eye",color:"gray",variant:"ghost",onClick:e[26]||(e[26]=a=>Be.value=!Be.value),title:Be.value?"隐藏":"显示"},null,8,["icon","title"]),o(r,{icon:"i-heroicons-clipboard",color:"gray",variant:"ghost",onClick:gl,title:"复制 Token"})]),t("p",{class:n(["text-xs mt-1",s.value.mutedText])},"请妥善保管此 Token",2)])):(b(),w("div",Ka,[t("p",{class:n(s.value.mutedText)},"暂无 Token",2)]))],2),t("div",{class:n(["rounded-lg p-3 md:col-span-3",s.value.subtleBg])},[t("div",Fa,[t("span",{class:n(s.value.mutedText)},"修改密码",2),o(r,{size:"sm",onClick:e[27]||(e[27]=a=>Y.password=!Y.password),color:Y.password?"gray":"green",variant:Y.password?"soft":"solid",class:"shadow"},{default:g(()=>[p(x(Y.password?"取消":"编辑"),1)]),_:1},8,["color","variant"])]),Y.password?(b(),w("div",qa,[t("div",Ga,[o(V,{modelValue:M.oldPassword,"onUpdate:modelValue":e[28]||(e[28]=a=>M.oldPassword=a),type:_e.value?"text":"password",placeholder:"当前密码",class:"flex-1"},null,8,["modelValue","type"]),o(r,{icon:_e.value?"i-heroicons-eye-slash":"i-heroicons-eye",color:"gray",variant:"ghost",onClick:e[29]||(e[29]=a=>_e.value=!_e.value)},null,8,["icon"])]),t("div",Ja,[o(V,{modelValue:M.newPassword,"onUpdate:modelValue":e[30]||(e[30]=a=>M.newPassword=a),type:Ze.value?"text":"password",placeholder:"新密码",class:"flex-1"},null,8,["modelValue","type"]),o(G,{color:fl.value,variant:"soft"},{default:g(()=>[p(x(vl.value),1)]),_:1},8,["color"]),o(r,{icon:Ze.value?"i-heroicons-eye-slash":"i-heroicons-eye",color:"gray",variant:"ghost",onClick:e[31]||(e[31]=a=>Ze.value=!Ze.value)},null,8,["icon"])]),t("div",_a,[o(V,{modelValue:M.confirmPassword,"onUpdate:modelValue":e[32]||(e[32]=a=>M.confirmPassword=a),type:Qe.value?"text":"password",placeholder:"确认新密码",class:"flex-1"},null,8,["modelValue","type"]),o(r,{icon:Qe.value?"i-heroicons-eye-slash":"i-heroicons-eye",color:"gray",variant:"ghost",onClick:e[33]||(e[33]=a=>Qe.value=!Qe.value)},null,8,["icon"])]),t("div",Za,[o(r,{onClick:yl,disabled:!bl.value,color:"primary",class:"shadow"},{default:g(()=>e[169]||(e[169]=[p("保存")])),_:1},8,["disabled"])])])):D("",!0)],2)])],2)])):D("",!0),t("div",Qa,[t("div",{class:n(["rounded-xl border shadow-xl",[s.value.cardBg,s.value.border]])},[t("div",Xa,[t("div",{class:n(["font-semibold flex items-center gap-2",s.value.text])},[o(d,{name:"i-heroicons-cog-6-tooth",class:"w-5 h-5"}),e[170]||(e[170]=t("span",null,"网站配置",-1))],2)]),t("div",Ya,[t("div",{id:"site-register-section",class:n(["flex items-center rounded-lg p-3 justify-between",s.value.subtleBg])},[t("div",{class:n(["flex items-center gap-2",s.value.text])},[o(d,{name:"i-heroicons-user-plus",class:"w-4 h-4"}),e[171]||(e[171]=p()),e[172]||(e[172]=t("span",null,"新用户注册",-1))],2),t("div",eo,[t("div",to,[o(T,{modelValue:P.value,"onUpdate:modelValue":e[34]||(e[34]=a=>P.value=a),value:!0,class:"mr-2"},null,8,["modelValue"]),t("span",{class:n(P.value?s.value.text:"text-slate-400")},"允许",2)]),t("div",lo,[o(T,{modelValue:P.value,"onUpdate:modelValue":e[35]||(e[35]=a=>P.value=a),value:!1,class:"mr-2"},null,8,["modelValue"]),t("span",{class:n(P.value?"text-slate-400":s.value.text)},"不允许",2)]),o(r,{color:"green",onClick:J,class:"shadow"},{default:g(()=>e[173]||(e[173]=[p("保存")])),_:1})])],2),t("div",{id:"site-pwa-section",class:n(["rounded-lg p-4",s.value.subtleBg])},[t("div",so,[t("div",{class:n(["flex items-center gap-2",s.value.text])},[o(d,{name:"i-heroicons-rocket-launch",class:"w-4 h-4"}),e[174]||(e[174]=p()),e[175]||(e[175]=t("span",null,"PWA 模式",-1))],2),t("div",ao,[o(ae,{modelValue:c.pwaEnabled,"onUpdate:modelValue":e[36]||(e[36]=a=>c.pwaEnabled=a)},null,8,["modelValue"]),o(r,{color:"green",onClick:hl,class:"shadow"},{default:g(()=>e[176]||(e[176]=[p("保存")])),_:1})])]),t("div",oo,[t("div",null,[t("label",{class:n([s.value.mutedText,"text-sm mb-1 block"])},"PWA 标题",2),o(V,{modelValue:c.pwaTitle,"onUpdate:modelValue":e[37]||(e[37]=a=>c.pwaTitle=a),placeholder:c.siteTitle||"说说笔记"},null,8,["modelValue","placeholder"])]),t("div",null,[t("label",{class:n([s.value.mutedText,"text-sm mb-1 block"])},"PWA 图标",2),o(V,{modelValue:c.pwaIconURL,"onUpdate:modelValue":e[38]||(e[38]=a=>c.pwaIconURL=a),placeholder:"/favicon.ico"},null,8,["modelValue"])]),t("div",no,[t("label",{class:n([s.value.mutedText,"text-sm mb-1 block"])},"PWA 描述",2),o(_,{modelValue:c.pwaDescription,"onUpdate:modelValue":e[39]||(e[39]=a=>c.pwaDescription=a),placeholder:c.description||""},null,8,["modelValue","placeholder"])])])],2),t("div",{id:"site-github-card-section",class:n(["flex items-center rounded-lg p-3 justify-between",s.value.subtleBg])},[t("div",{class:n(["flex items-center gap-2",s.value.text])},[o(d,{name:"i-mdi-github",class:"w-4 h-4"}),e[177]||(e[177]=p()),e[178]||(e[178]=t("span",null,"GitHub 链接卡片解析",-1))],2),t("div",io,[t("div",ro,[o(T,{modelValue:ye.value,"onUpdate:modelValue":e[40]||(e[40]=a=>ye.value=a),value:!0,class:"mr-2"},null,8,["modelValue"]),t("span",{class:n(ye.value?s.value.text:"text-slate-400")},"开启",2)]),t("div",uo,[o(T,{modelValue:ye.value,"onUpdate:modelValue":e[41]||(e[41]=a=>ye.value=a),value:!1,class:"mr-2"},null,8,["modelValue"]),t("span",{class:n(ye.value?"text-slate-400":s.value.text)},"关闭",2)]),o(r,{color:"green",onClick:Sl,class:"shadow"},{default:g(()=>e[179]||(e[179]=[p("保存")])),_:1})])],2),t("div",{id:"site-announcement-section",class:n(["flex items-center rounded-lg p-3 justify-between",s.value.subtleBg])},[t("div",{class:n(["flex items-center gap-2",s.value.text])},[o(d,{name:"i-heroicons-megaphone",class:"w-4 h-4"}),e[180]||(e[180]=p()),e[181]||(e[181]=t("span",null,"公告栏开关",-1))],2),t("div",mo,[o(ae,{modelValue:c.announcementEnabled,"onUpdate:modelValue":e[42]||(e[42]=a=>c.announcementEnabled=a)},null,8,["modelValue"]),o(r,{color:"green",onClick:e[43]||(e[43]=a=>ne("announcementEnabled")),class:"shadow"},{default:g(()=>e[182]||(e[182]=[p("保存")])),_:1})])],2),t("div",{class:n(["rounded-lg p-3 mt-3",s.value.subtleBg])},[t("div",{class:n(["text-sm mb-2",s.value.mutedText])},"公告栏文本",2),o(_,{modelValue:c.announcementText,"onUpdate:modelValue":e[44]||(e[44]=a=>c.announcementText=a),placeholder:"请输入公告内容",class:"w-full mb-2"},null,8,["modelValue"]),t("div",co,[o(r,{color:"primary",class:"shadow",onClick:e[45]||(e[45]=a=>ne("announcementText"))},{default:g(()=>e[183]||(e[183]=[p("保存公告文本")])),_:1})])],2),t("div",po,[t("div",{class:n([s.value.cardBg,s.value.border,Ke])},[t("div",go,[t("div",{class:n(["font-semibold flex items-center gap-2",s.value.text])},[o(d,{name:"i-heroicons-musical-note",class:"w-5 h-5"}),e[184]||(e[184]=t("span",null,"音乐配置",-1))],2),t("div",vo,[o(ae,{modelValue:c.musicEnabled,"onUpdate:modelValue":e[46]||(e[46]=a=>c.musicEnabled=a)},null,8,["modelValue"]),o(r,{color:"green",onClick:$t,class:"shadow"},{default:g(()=>e[185]||(e[185]=[p("保存")])),_:1})])]),t("div",fo,[t("div",{class:n(["rounded-lg p-4 space-y-4",s.value.subtleBg])},[t("div",bo,[t("div",null,[t("label",{class:n(["text-sm mb-1 block",s.value.mutedText])},"歌单 ID",2),o(V,{modelValue:c.musicPlaylistId,"onUpdate:modelValue":e[47]||(e[47]=a=>c.musicPlaylistId=a),placeholder:"网易云歌单ID（可选）"},null,8,["modelValue"])]),t("div",null,[t("label",{class:n(["text-sm mb-1 block",s.value.mutedText])},"歌曲 ID",2),o(V,{modelValue:c.musicSongId,"onUpdate:modelValue":e[48]||(e[48]=a=>c.musicSongId=a),placeholder:"网易云歌曲ID（可选）"},null,8,["modelValue"])]),t("div",null,[t("label",{class:n(["text-sm mb-1 block",s.value.mutedText])},"位置",2),o(X,{modelValue:c.musicPosition,"onUpdate:modelValue":e[49]||(e[49]=a=>c.musicPosition=a),options:[{label:"左下",value:"bottom-left"},{label:"右下",value:"bottom-right"}]},null,8,["modelValue"])]),t("div",null,[t("label",{class:n(["text-sm mb-1 block",s.value.mutedText])},"主题",2),o(X,{modelValue:c.musicTheme,"onUpdate:modelValue":e[50]||(e[50]=a=>c.musicTheme=a),options:[{label:"自动",value:"auto"},{label:"深色",value:"dark"},{label:"浅色",value:"light"}]},null,8,["modelValue"])]),t("div",wo,[t("span",{class:n(["text-sm",s.value.mutedText])},"显示歌词",2),o(ke,{modelValue:c.musicLyric,"onUpdate:modelValue":e[51]||(e[51]=a=>c.musicLyric=a)},null,8,["modelValue"])]),t("div",yo,[t("span",{class:n(["text-sm",s.value.mutedText])},"自动播放",2),o(ke,{modelValue:c.musicAutoplay,"onUpdate:modelValue":e[52]||(e[52]=a=>c.musicAutoplay=a)},null,8,["modelValue"])]),t("div",xo,[t("span",{class:n(["text-sm",s.value.mutedText])},"默认最小化",2),o(ke,{modelValue:c.musicDefaultMinimized,"onUpdate:modelValue":e[53]||(e[53]=a=>c.musicDefaultMinimized=a)},null,8,["modelValue"])]),t("div",ho,[t("span",{class:n(["text-sm",s.value.mutedText])},"展示模式",2),o(X,{modelValue:Lt.value,"onUpdate:modelValue":e[54]||(e[54]=a=>Lt.value=a),options:[{label:"嵌入",value:"embed"},{label:"浮动",value:"float"}]},null,8,["modelValue"])])]),t("div",ko,[o(r,{variant:"soft",color:"gray",onClick:Bl},{default:g(()=>e[186]||(e[186]=[p("重置")])),_:1}),o(r,{color:"green",onClick:$t},{default:g(()=>e[187]||(e[187]=[p("保存")])),_:1})])],2)])],2)]),t("div",{id:"site-default-theme-section",class:n(["flex items-center rounded-lg p-3 justify-between",s.value.subtleBg])},[t("div",{class:n(["flex items-center gap-2",s.value.text])},[o(d,{name:"i-heroicons-swatch",class:"w-4 h-4"}),e[188]||(e[188]=p()),e[189]||(e[189]=t("span",null,"默认主题色",-1))],2),t("div",Vo,[t("div",Eo,[o(T,{modelValue:c.defaultContentTheme,"onUpdate:modelValue":e[55]||(e[55]=a=>c.defaultContentTheme=a),value:"dark",class:"mr-2"},null,8,["modelValue"]),t("span",{class:n(c.defaultContentTheme==="dark"?s.value.text:"text-slate-400")},"暗黑",2)]),t("div",Co,[o(T,{modelValue:c.defaultContentTheme,"onUpdate:modelValue":e[56]||(e[56]=a=>c.defaultContentTheme=a),value:"light",class:"mr-2"},null,8,["modelValue"]),t("span",{class:n(c.defaultContentTheme==="light"?s.value.text:"text-slate-400")},"白天",2)]),o(r,{color:"green",onClick:e[57]||(e[57]=a=>ne("defaultContentTheme")),class:"shadow"},{default:g(()=>e[190]||(e[190]=[p("保存")])),_:1})])],2),t("div",To,[(b(),w(de,null,Ee(ct,(a,K)=>t("div",{key:K,class:n(["rounded-lg p-3",s.value.subtleBg])},[t("div",Uo,[t("span",{class:n(s.value.mutedText)},x(a),3),o(r,{size:"sm",onClick:ie=>xe[K]=!xe[K],color:xe[K]?"gray":"green",variant:xe[K]?"soft":"solid",class:"shadow"},{default:g(()=>[p(x(xe[K]?"取消":"编辑"),1)]),_:2},1032,["onClick","color","variant"])]),xe[K]?(b(),w("div",So,[K==="backgrounds"?(b(),w("div",Bo,[(b(!0),w(de,null,Ee(c.backgrounds,(ie,Pe)=>(b(),w("div",{key:Pe,class:"flex gap-2"},[o(V,{modelValue:c.backgrounds[Pe],"onUpdate:modelValue":ft=>c.backgrounds[Pe]=ft,placeholder:"输入图片URL",class:"flex-1"},null,8,["modelValue","onUpdate:modelValue"]),o(r,{onClick:ft=>Pl(Pe),icon:"i-heroicons-trash",color:"red",variant:"ghost"},null,8,["onClick"])]))),128)),t("div",Ao,[o(r,{onClick:Rl,icon:"i-heroicons-plus",variant:"ghost",class:"mr-2"},{default:g(()=>e[191]||(e[191]=[p("添加链接")])),_:1}),o(r,{onClick:jl,icon:"i-heroicons-cloud-arrow-up",variant:"ghost"},{default:g(()=>e[192]||(e[192]=[p("上传图片")])),_:1})])])):K==="subtitleText"?(b(),at(_,{key:1,modelValue:c[K],"onUpdate:modelValue":ie=>c[K]=ie,placeholder:`输入${a}`,class:"w-full mb-2"},null,8,["modelValue","onUpdate:modelValue","placeholder"])):(b(),at(V,{key:2,modelValue:c[K],"onUpdate:modelValue":ie=>c[K]=ie,placeholder:`输入${a}`,class:"w-full mb-2"},null,8,["modelValue","onUpdate:modelValue","placeholder"])),t("div",$o,[o(r,{onClick:ie=>xl(K),variant:"ghost",color:"gray"},{default:g(()=>e[193]||(e[193]=[p("重置")])),_:2},1032,["onClick"]),o(r,{onClick:ie=>ne(K),color:"primary",class:"shadow"},{default:g(()=>e[194]||(e[194]=[p("保存")])),_:2},1032,["onClick"])])])):(b(),w("div",Lo,[K==="backgrounds"?(b(),w("div",Ro,[(b(!0),w(de,null,Ee(c.backgrounds,(ie,Pe)=>(b(),w("img",{key:Pe,src:ie,class:"w-full h-20 object-cover rounded cursor-pointer",onClick:ft=>Il(ie)},null,8,Po))),128))])):(b(),w("div",{key:1,class:n([s.value.subtleBg,s.value.border,"rounded-md p-3 border"])},[t("p",{class:n([s.value.text,"break-words"])},x(c[K]),3)],2))]))],2)),64))]),Bt.value?(b(),w("div",jo,[o(r,{onClick:Ll,variant:"ghost",color:"gray"},{default:g(()=>e[195]||(e[195]=[p("重置")])),_:1}),o(r,{onClick:l.saveConfig,color:"primary",class:"shadow"},{default:g(()=>e[196]||(e[196]=[p("保存所有更改")])),_:1},8,["onClick"])])):D("",!0)])],2)]),t("div",Io,[t("div",{class:n([s.value.cardBg,s.value.border,Ke])},[t("div",Ho,[t("div",{class:n(["font-semibold flex items-center gap-2",s.value.text])},[o(d,{name:"i-heroicons-chat-bubble-left-right",class:"w-5 h-5"}),e[197]||(e[197]=t("span",{class:"whitespace-nowrap"},"评论系统",-1))],2),t("div",Mo,[t("span",{class:n(["text-sm",s.value.mutedText])},"状态",2),t("span",{class:n([c.commentEnabled?"text-green-400":"text-red-400","text-sm"])},x(c.commentEnabled?"已启用":"未启用"),3),o(ae,{modelValue:c.commentEnabled,"onUpdate:modelValue":e[58]||(e[58]=a=>c.commentEnabled=a)},null,8,["modelValue"]),t("div",Do,[t("span",{class:n(["text-sm",s.value.mutedText])},"邮件通知",2),o(ae,{modelValue:c.commentEmailEnabled,"onUpdate:modelValue":e[59]||(e[59]=a=>c.commentEmailEnabled=a),disabled:!c.commentEnabled},null,8,["modelValue","disabled"])]),o(r,{color:"green",onClick:kl,class:"shadow"},{default:g(()=>e[198]||(e[198]=[p("保存")])),_:1})])]),t("div",Oo,[o(oa,{config:c,"onUpdate:config":e[60]||(e[60]=a=>c=a),theme:s.value,onCommentSystemChanged:e[61]||(e[61]=a=>pt.value=a)},null,8,["config","theme"]),St.value&&c.commentEnabled&&String(pt.value||c.commentSystem).toLowerCase()==="builtin"?(b(),w("div",{key:0,class:n(["mt-4 rounded-lg p-3",s.value.subtleBg])},[t("div",zo,[o(V,{modelValue:Xe.value,"onUpdate:modelValue":e[62]||(e[62]=a=>Xe.value=a),placeholder:"搜索评论内容/昵称/邮箱/网址",class:"flex-1"},null,8,["modelValue"]),o(r,{color:"primary",variant:"soft",onClick:At},{default:g(()=>e[199]||(e[199]=[p("搜索")])),_:1}),o(r,{variant:"soft",color:ge.value?"gray":"indigo",onClick:El},{default:g(()=>[p(x(ge.value?"折叠":"展开"),1)]),_:1},8,["color"])]),ge.value?(b(),w("div",No,[(b(!0),w(de,null,Ee($e.value,a=>(b(),w("div",{key:a.id,class:n(["rounded border px-3 py-2",s.value.border])},[t("div",Wo,[t("div",{class:n(["text-sm truncate",s.value.text])},"#"+x(a.id)+" · "+x(a.nick||"匿名")+" · "+x(Vl(a.created_at)),3),o(r,{size:"xs",variant:"ghost",color:gt(a)?"gray":"primary",onClick:K=>Cl(a)},{default:g(()=>[p(x(gt(a)?"收起":"展开"),1)]),_:2},1032,["color","onClick"])]),t("div",{class:n(["mt-1 text-sm truncate",s.value.text])},x(a.content),3),gt(a)?(b(),w("div",Ko,[t("div",null,[t("span",{class:n(s.value.mutedText)},"消息ID",2),e[200]||(e[200]=p("：")),t("span",{class:n(s.value.text)},x(a.message_id),3)]),t("div",null,[t("span",{class:n(s.value.mutedText)},"父评论ID",2),e[201]||(e[201]=p("：")),t("span",{class:n(s.value.text)},x(a.parent_id||0),3)]),t("div",null,[t("span",{class:n(s.value.mutedText)},"邮箱",2),e[202]||(e[202]=p("：")),t("span",{class:n(s.value.text)},x(a.mail||"-"),3)]),t("div",Fo,[t("span",{class:n(s.value.mutedText)},"网址",2),e[203]||(e[203]=p("：")),a.link?(b(),w("a",{key:0,href:a.link,target:"_blank",rel:"noopener",class:"underline"},x(a.link),9,qo)):(b(),w("span",{key:1,class:n(s.value.text)},"-",2))]),t("div",Go,[o(r,{color:"red",variant:"soft",onClick:K=>Ul(a)},{default:g(()=>e[204]||(e[204]=[p("删除该评论")])),_:2},1032,["onClick"])])])):D("",!0)],2))),128)),Ye.value?(b(),w("div",Jo,[o(r,{variant:"soft",onClick:Tl},{default:g(()=>e[205]||(e[205]=[p("加载更多")])),_:1})])):D("",!0)])):D("",!0)],2)):D("",!0)])],2)]),t("div",{class:n(["mx-4 my-2 border-t",s.value.border])},null,2),t("div",_o,[t("div",{class:n([s.value.cardBg,s.value.border,Ke])},[t("div",Zo,[t("div",{class:n(["font-semibold flex items-center gap-2",s.value.text])},[o(d,{name:"i-heroicons-envelope",class:"w-5 h-5"}),e[206]||(e[206]=t("span",null,"邮件设置（SMTP）",-1))],2),t("div",Qo,[o(ae,{modelValue:y.enabled,"onUpdate:modelValue":e[63]||(e[63]=a=>y.enabled=a)},null,8,["modelValue"]),o(r,{color:"green",onClick:se,class:"shadow"},{default:g(()=>e[207]||(e[207]=[p("保存")])),_:1})])]),t("div",Xo,[t("div",{class:n(["rounded-lg p-4 space-y-4",s.value.subtleBg])},[t("div",null,[t("div",{class:n(["text-sm font-medium mb-2",s.value.text])},"地址",2),o(V,{modelValue:y.from,"onUpdate:modelValue":e[64]||(e[64]=a=>y.from=a),placeholder:"发件地址，如 name@example.com"},null,8,["modelValue"])]),t("div",null,[t("div",{class:n(["text-sm font-medium mb-2",s.value.text])},"驱动",2),o(X,{modelValue:y.driver,"onUpdate:modelValue":e[65]||(e[65]=a=>y.driver=a),options:["smtp"]},null,8,["modelValue"])]),t("div",{class:n(["text-sm font-semibold mt-1 mb-2",s.value.text])},"SMTP 设置",2),t("div",Yo,[t("div",null,[t("div",{class:n(["text-sm mb-2",s.value.text])},"主机",2),o(V,{modelValue:y.host,"onUpdate:modelValue":e[66]||(e[66]=a=>y.host=a),placeholder:"smtp.example.com"},null,8,["modelValue"])]),t("div",null,[t("div",{class:n(["text-sm mb-2",s.value.text])},"端口",2),o(V,{modelValue:y.port,"onUpdate:modelValue":e[67]||(e[67]=a=>y.port=a),placeholder:"465 或 587"},null,8,["modelValue"])]),t("div",null,[t("div",{class:n(["text-sm mb-2",s.value.text])},"加密协议（小写 ssl 或 tls）",2),o(X,{modelValue:y.encryption,"onUpdate:modelValue":e[68]||(e[68]=a=>y.encryption=a),options:["ssl","tls"]},null,8,["modelValue"])]),e[208]||(e[208]=t("div",{class:"md:col-span-1"},null,-1)),t("div",null,[t("div",{class:n(["text-sm mb-2",s.value.text])},"用户名",2),o(V,{modelValue:y.user,"onUpdate:modelValue":e[69]||(e[69]=a=>y.user=a),placeholder:"通常与发件地址一致"},null,8,["modelValue"])]),t("div",null,[t("div",{class:n(["text-sm mb-2",s.value.text])},"密码",2),o(V,{modelValue:y.pass,"onUpdate:modelValue":e[70]||(e[70]=a=>y.pass=a),type:f.value?"text":"password",placeholder:"邮箱或应用专用密码"},null,8,["modelValue","type"])])]),t("div",{class:n(["flex items-center justify-between mt-2",s.value.mutedText])},[t("span",en,"使用上述设置发送测试邮件到："+x(y.from||y.user||"请先填写地址"),1),o(r,{disabled:!(y.from||y.user),loading:ut.value,color:"primary",onClick:ul},{default:g(()=>e[209]||(e[209]=[p("发送测试邮件")])),_:1},8,["disabled","loading"])],2),t("div",tn,[o(r,{variant:"soft",color:"gray",onClick:le},{default:g(()=>e[210]||(e[210]=[p("刷新")])),_:1}),o(r,{color:"green",onClick:se},{default:g(()=>e[211]||(e[211]=[p("保存")])),_:1})])],2)])],2)]),t("div",ln,[t("div",{class:n([s.value.cardBg,s.value.border,Ke])},[t("div",sn,[t("div",{class:n(["font-semibold flex items-center gap-2",s.value.text])},[o(d,{name:"i-heroicons-shield-check",class:"w-5 h-5"}),e[212]||(e[212]=t("span",null,"用户管理",-1))],2)]),t("div",an,[t("div",{class:n(["rounded-lg p-3 mb-3",s.value.subtleBg])},[t("div",on,[o(V,{modelValue:it.value,"onUpdate:modelValue":e[71]||(e[71]=a=>it.value=a),placeholder:"搜索用户名或ID",class:"flex-1"},null,8,["modelValue"]),o(r,{color:"primary",variant:"soft",onClick:Tt},{default:g(()=>e[213]||(e[213]=[p("搜索")])),_:1}),o(r,{variant:"soft",color:"gray",onClick:Tt},{default:g(()=>e[214]||(e[214]=[p("刷新")])),_:1}),o(r,{variant:"soft",color:De.value?"gray":"indigo",onClick:e[72]||(e[72]=a=>De.value=!De.value)},{default:g(()=>[p(x(De.value?"折叠":"展开"),1)]),_:1},8,["color"])])],2),De.value?(b(),w("div",{key:0,class:n(["rounded-lg p-3",s.value.subtleBg])},[t("div",nn,[(b(!0),w(de,null,Ee(al.value,a=>(b(),w("div",{key:a.id??a.ID,class:n(["rounded border px-3 py-2",s.value.border])},[t("div",rn,[o(G,{color:"gray",variant:"soft"},{default:g(()=>[p("#"+x(a.id??a.ID),1)]),_:2},1024),t("span",{class:n(["truncate",s.value.text])},x(a.username??a.Username),3),o(G,{color:a.is_admin??a.IsAdmin?"primary":"gray",variant:"subtle"},{default:g(()=>[p(x(a.is_admin??a.IsAdmin?"管理员":"普通"),1)]),_:2},1032,["color"]),e[215]||(e[215]=t("div",{class:"flex-1"},null,-1)),o(r,{size:"xs",variant:"ghost",color:dt(a)?"gray":"primary",onClick:K=>ol(a)},{default:g(()=>[p(x(dt(a)?"收起":"展开"),1)]),_:2},1032,["color","onClick"])]),t("div",dn,[o(r,{color:a.is_admin??a.IsAdmin?"orange":"green",variant:a.is_admin??a.IsAdmin?"soft":"solid",class:"shadow",onClick:K=>rl(a)},{default:g(()=>[p(x(a.is_admin??a.IsAdmin?"取消管理员":"设为管理员"),1)]),_:2},1032,["color","variant","onClick"]),o(r,{color:"red",variant:"soft",class:"shadow",onClick:K=>dl(a)},{default:g(()=>e[216]||(e[216]=[p("删除")])),_:2},1032,["onClick"])]),dt(a)?(b(),w("div",{key:0,class:n(["mt-3 rounded p-3",s.value.subtleBg])},[t("div",un,[t("div",null,[t("div",{class:n(["text-xs",s.value.mutedText])},"用户ID",2),t("div",{class:n(s.value.text)},x(a.id??a.ID),3)]),t("div",null,[t("div",{class:n(["text-xs",s.value.mutedText])},"用户名",2),t("div",{class:n(s.value.text)},x(a.username??a.Username),3)]),t("div",null,[t("div",{class:n(["text-xs",s.value.mutedText])},"角色",2),t("div",{class:n(s.value.text)},x(a.is_admin??a.IsAdmin?"管理员":"普通用户"),3)])]),t("div",mn,[t("div",{class:n(["text-sm mb-1",s.value.text])},"重置密码",2),t("div",cn,[o(V,{modelValue:Oe.password[a.id??a.ID],"onUpdate:modelValue":K=>Oe.password[a.id??a.ID]=K,type:Fe.value?"text":"password",placeholder:"新密码",class:"flex-1"},null,8,["modelValue","onUpdate:modelValue","type"]),o(r,{icon:Fe.value?"i-heroicons-eye-slash":"i-heroicons-eye",color:"gray",variant:"ghost",onClick:e[73]||(e[73]=K=>Fe.value=!Fe.value)},null,8,["icon"]),o(r,{disabled:!nl(a),color:"primary",onClick:K=>il(a)},{default:g(()=>e[217]||(e[217]=[p("保存")])),_:2},1032,["disabled","onClick"])])])],2)):D("",!0)],2))),128))])],2)):D("",!0)])],2)]),o(It,{modelValue:ce.value,"onUpdate:modelValue":e[77]||(e[77]=a=>ce.value=a)},{default:g(()=>[o(Jl,null,{default:g(()=>[e[220]||(e[220]=t("div",{class:"font-semibold mb-2"},"重置管理员密码",-1)),t("div",pn,[t("div",gn,[o(V,{modelValue:Q.newPass,"onUpdate:modelValue":e[74]||(e[74]=a=>Q.newPass=a),type:be.value?"text":"password",placeholder:"新密码",class:"flex-1"},null,8,["modelValue","type"]),o(G,{color:pe.value,variant:"soft"},{default:g(()=>[p(x(oe.value),1)]),_:1},8,["color"])]),t("div",vn,[o(V,{modelValue:Q.confirmPass,"onUpdate:modelValue":e[75]||(e[75]=a=>Q.confirmPass=a),type:be.value?"text":"password",placeholder:"确认新密码",class:"flex-1"},null,8,["modelValue","type"])]),t("div",fn,[o(r,{variant:"ghost",color:"gray",onClick:e[76]||(e[76]=a=>ce.value=!1)},{default:g(()=>e[218]||(e[218]=[p("取消")])),_:1}),o(r,{disabled:!Me.value,color:"primary",onClick:sl},{default:g(()=>e[219]||(e[219]=[p("保存")])),_:1},8,["disabled"])])])]),_:1})]),_:1},8,["modelValue"]),t("div",bn,[t("div",{class:n(["rounded-xl border shadow-xl",[s.value.cardBg,s.value.border]])},[t("div",wn,[t("div",{class:n(["font-semibold flex items-center gap-2",s.value.text])},[o(d,{name:"i-heroicons-bell-alert",class:"w-5 h-5"}),e[221]||(e[221]=t("span",null,"推送配置",-1))],2),t("div",yn,[t("span",{class:n(["text-sm",s.value.mutedText])},"状态",2),t("span",{class:n([c.notifyEnabled?"text-green-400":"text-red-400","text-sm"])},x(c.notifyEnabled?"已启用":"未启用"),3),o(ke,{modelValue:c.notifyEnabled,"onUpdate:modelValue":e[78]||(e[78]=a=>c.notifyEnabled=a),color:"primary",size:"lg"},null,8,["modelValue"]),t("div",xn,[o(T,{modelValue:c.notifyEnabled,"onUpdate:modelValue":e[79]||(e[79]=a=>c.notifyEnabled=a),value:!0},null,8,["modelValue"]),t("span",{class:n(c.notifyEnabled?s.value.text:"text-gray-400")},"开启",2),o(T,{modelValue:c.notifyEnabled,"onUpdate:modelValue":e[80]||(e[80]=a=>c.notifyEnabled=a),value:!1},null,8,["modelValue"]),t("span",{class:n(c.notifyEnabled?"text-gray-400":s.value.text)},"关闭",2)])])]),t("div",hn,[o(Ys,{config:ve(q),"onUpdate:config":e[81]||(e[81]=a=>ss(q)?q.value=a:q=a),immediate:!0,subtleBg:s.value.subtleBg,text:s.value.text,mutedText:s.value.mutedText,disabled:!c.notifyEnabled},null,8,["config","subtleBg","text","mutedText","disabled"])])],2)]),t("div",kn,[t("div",{class:n(["rounded-xl border shadow-xl",[s.value.cardBg,s.value.border]])},[t("div",Vn,[t("div",{class:n(["font-semibold flex items-center gap-2",s.value.text])},[o(d,{name:"i-mdi-github",class:"w-5 h-5"}),e[222]||(e[222]=t("span",null,"GitHub 登录",-1))],2),t("div",En,[t("span",{class:n(["text-sm",s.value.mutedText])},"状态",2),t("span",{class:n([c.githubOAuthEnabled?"text-green-400":"text-red-400","text-sm"])},x(c.githubOAuthEnabled?"已启用":"未启用"),3),o(ke,{modelValue:c.githubOAuthEnabled,"onUpdate:modelValue":e[82]||(e[82]=a=>c.githubOAuthEnabled=a),color:"primary",size:"lg"},null,8,["modelValue"]),o(ae,{modelValue:c.githubOAuthEnabled,"onUpdate:modelValue":e[83]||(e[83]=a=>c.githubOAuthEnabled=a)},null,8,["modelValue"]),t("div",Cn,[o(T,{modelValue:c.githubOAuthEnabled,"onUpdate:modelValue":e[84]||(e[84]=a=>c.githubOAuthEnabled=a),value:!0},null,8,["modelValue"]),t("span",{class:n(c.githubOAuthEnabled?s.value.text:"text-gray-400")},"开启",2),o(T,{modelValue:c.githubOAuthEnabled,"onUpdate:modelValue":e[85]||(e[85]=a=>c.githubOAuthEnabled=a),value:!1},null,8,["modelValue"]),t("span",{class:n(c.githubOAuthEnabled?"text-gray-400":s.value.text)},"关闭",2)])])]),t("div",Tn,[t("div",Un,[t("div",null,[t("div",{class:n(["text-sm mb-2",s.value.text])},"Client ID",2),o(V,{modelValue:c.githubClientId,"onUpdate:modelValue":e[86]||(e[86]=a=>c.githubClientId=a),placeholder:"GitHub OAuth App Client ID",disabled:!c.githubOAuthEnabled},null,8,["modelValue","disabled"])]),t("div",null,[t("div",{class:n(["text-sm mb-2",s.value.text])},"Client Secret",2),o(V,{modelValue:c.githubClientSecret,"onUpdate:modelValue":e[87]||(e[87]=a=>c.githubClientSecret=a),type:"password",placeholder:"GitHub OAuth App Client Secret",disabled:!c.githubOAuthEnabled},null,8,["modelValue","disabled"])]),t("div",Sn,[t("div",{class:n(["text-sm mb-2",s.value.text])},"回调地址",2),o(V,{modelValue:c.githubCallbackURL,"onUpdate:modelValue":e[88]||(e[88]=a=>c.githubCallbackURL=a),placeholder:"例如 https://your.domain.com/oauth/github/callback",disabled:!c.githubOAuthEnabled},null,8,["modelValue","disabled"])])]),t("div",Bn,[o(r,{variant:"soft",color:"gray",onClick:he},{default:g(()=>e[223]||(e[223]=[p("刷新")])),_:1}),o(r,{color:"green",onClick:Al},{default:g(()=>e[224]||(e[224]=[p("保存")])),_:1}),o(r,{color:"primary",onClick:ml},{default:g(()=>e[225]||(e[225]=[p("测试")])),_:1})]),t("div",{class:n(["text-xs",s.value.mutedText])},"默认不开启，开启后登录页显示“GitHub 一键登录”按钮",2)])],2)]),t("div",An,[t("div",{class:n(["rounded-xl border shadow-xl",[s.value.cardBg,s.value.border]])},[t("div",$n,[t("div",{class:n(["font-semibold flex items-center gap-2",s.value.text])},[o(d,{name:"i-heroicons-circle-stack",class:"w-5 h-5 text-indigo-300"}),e[226]||(e[226]=t("span",null,"本地数据库管理配置",-1)),t("span",{class:n(["ml-2 text-xs px-2 py-1 rounded",s.value.subtleBg])},"当前 DB："+x(Hl.value),3)],2),t("div",Ln,[o(r,{color:"primary",icon:"i-heroicons-arrow-down-tray",disabled:Re.value!=="sqlite",onClick:Ml},{default:g(()=>e[227]||(e[227]=[p("下载本地备份")])),_:1},8,["disabled"]),o(r,{color:"warning",variant:"soft",icon:"i-heroicons-arrow-up-tray",disabled:Re.value!=="sqlite",onClick:Dl},{default:g(()=>e[228]||(e[228]=[p("恢复本地数据库")])),_:1},8,["disabled"]),t("input",{type:"file",ref_key:"databaseFileInput",ref:ze,accept:".zip",class:"hidden",onChange:Pt},null,544)])]),t("div",Rn,[t("div",{class:n(["text-yellow-400 text-sm rounded p-2",s.value.subtleBg])},"🔔：仅针对 SQLite 本地数据库；"+x(Re.value!=="sqlite"?"当前为云/外部数据库，请在服务端操作":"可在此下载与恢复本地备份"),3),t("input",{type:"file",ref_key:"databaseFileInput",ref:ze,accept:".zip",class:"hidden",onChange:Pt},null,544),t("div",{class:n(["rounded-lg p-3",s.value.subtleBg])},[t("div",{class:n(["font-semibold mb-2 flex items-center justify-between",s.value.text])},[e[229]||(e[229]=t("span",null,"云存储接入（R2/S3）",-1)),t("div",Pn,[t("span",{class:n(["text-sm",s.value.mutedText])},"状态",2),t("span",{class:n([N.value?"text-green-400":"text-red-400","text-sm"])},x(N.value?"已启用":"未启用"),3),o(ke,{modelValue:N.value,"onUpdate:modelValue":e[89]||(e[89]=a=>N.value=a)},null,8,["modelValue"]),t("div",jn,[o(T,{modelValue:N.value,"onUpdate:modelValue":e[90]||(e[90]=a=>N.value=a),value:!0},null,8,["modelValue"]),t("span",{class:n(N.value?s.value.text:"text-gray-400")},"开启",2),o(T,{modelValue:N.value,"onUpdate:modelValue":e[91]||(e[91]=a=>N.value=a),value:!1},null,8,["modelValue"]),t("span",{class:n(N.value?"text-gray-400":s.value.text)},"关闭",2)])])],2),t("div",In,[t("div",null,[t("label",{class:n(["text-sm mb-1 block",s.value.mutedText])},"提供方",2),o(X,{modelValue:k.provider,"onUpdate:modelValue":e[92]||(e[92]=a=>k.provider=a),options:[{label:"S3",value:"s3"},{label:"R2",value:"r2"}],disabled:!N.value},null,8,["modelValue","disabled"])]),t("div",null,[t("label",{class:n(["text-sm mb-1 block",s.value.mutedText])},"Endpoint",2),o(V,{modelValue:k.endpoint,"onUpdate:modelValue":e[93]||(e[93]=a=>k.endpoint=a),placeholder:"https://...",disabled:!N.value},null,8,["modelValue","disabled"])]),t("div",null,[t("label",{class:n(["text-sm mb-1 block",s.value.mutedText])},"Region",2),o(V,{modelValue:k.region,"onUpdate:modelValue":e[94]||(e[94]=a=>k.region=a),placeholder:"auto 或区域名",disabled:!N.value},null,8,["modelValue","disabled"])]),t("div",null,[t("label",{class:n(["text-sm mb-1 block",s.value.mutedText])},"Bucket",2),o(V,{modelValue:k.bucket,"onUpdate:modelValue":e[95]||(e[95]=a=>k.bucket=a),placeholder:"bucket 名称",disabled:!N.value},null,8,["modelValue","disabled"])]),t("div",null,[t("label",{class:n(["text-sm mb-1 block",s.value.mutedText])},"Access Key",2),o(V,{modelValue:k.accessKey,"onUpdate:modelValue":e[96]||(e[96]=a=>k.accessKey=a),disabled:!N.value},null,8,["modelValue","disabled"])]),t("div",null,[t("label",{class:n(["text-sm mb-1 block",s.value.mutedText])},"Secret Key",2),o(V,{modelValue:k.secretKey,"onUpdate:modelValue":e[97]||(e[97]=a=>k.secretKey=a),type:"password",disabled:!N.value},null,8,["modelValue","disabled"])]),k.provider==="s3"?(b(),w("div",Hn,[t("span",{class:n(["text-sm",s.value.mutedText])},"使用路径风格地址",2),o(ke,{modelValue:k.usePathStyle,"onUpdate:modelValue":e[98]||(e[98]=a=>k.usePathStyle=a),disabled:!N.value},null,8,["modelValue","disabled"])])):D("",!0),t("div",Mn,[t("label",{class:n(["text-sm mb-1 block",s.value.mutedText])},"公共访问前缀",2),o(V,{modelValue:k.publicBaseURL,"onUpdate:modelValue":e[99]||(e[99]=a=>k.publicBaseURL=a),placeholder:"https://bucket.example.com/",disabled:!N.value},null,8,["modelValue","disabled"])])]),t("div",Dn,[o(r,{variant:"soft",color:"gray",onClick:vt},{default:g(()=>e[230]||(e[230]=[p("刷新")])),_:1}),o(r,{color:"green",onClick:zl},{default:g(()=>e[231]||(e[231]=[p("保存")])),_:1})]),t("div",On,[t("div",zn,[t("div",Nn,[t("span",{class:n(["text-sm",s.value.mutedText])},"自动同步至云端",2),o(ke,{modelValue:Ue.value,"onUpdate:modelValue":e[100]||(e[100]=a=>Ue.value=a),disabled:!(N.value&&k.provider&&k.endpoint&&k.bucket&&k.accessKey&&k.secretKey)},null,8,["modelValue","disabled"])]),t("div",Wn,[t("span",{class:n(["text-sm",s.value.mutedText])},"模式",2),o(X,{modelValue:Ne.value,"onUpdate:modelValue":e[101]||(e[101]=a=>Ne.value=a),options:[{label:"即时",value:"instant"},{label:"定时",value:"scheduled"}],disabled:!Ue.value||!(N.value&&k.provider&&k.endpoint&&k.bucket&&k.accessKey&&k.secretKey)},null,8,["modelValue","disabled"])]),Ne.value==="scheduled"?(b(),w("div",Kn,[t("span",{class:n(["text-sm",s.value.mutedText])},"间隔(分钟)",2),o(V,{modelValue:tt.value,"onUpdate:modelValue":e[102]||(e[102]=a=>tt.value=a),modelModifiers:{number:!0},type:"number",min:"1",class:"w-24",disabled:!Ue.value||!(N.value&&k.provider&&k.endpoint&&k.bucket&&k.accessKey&&k.secretKey)},null,8,["modelValue","disabled"])])):D("",!0),t("div",Fn,[t("span",{class:n(["text-sm",s.value.mutedText])},"上次同步",2),t("span",{class:n(["text-sm",s.value.text])},x(jt.value||"—"),3),o(r,{color:"primary",disabled:!Ue.value||!(N.value&&k.provider&&k.endpoint&&k.bucket&&k.accessKey&&k.secretKey),onClick:Nl},{default:g(()=>e[232]||(e[232]=[p("立即同步")])),_:1},8,["disabled"])])]),t("div",null,[t("label",{class:n(["text-sm mb-1 block",s.value.mutedText])},"上传URL（预签名）",2),t("div",qn,[o(V,{modelValue:lt.value,"onUpdate:modelValue":e[103]||(e[103]=a=>lt.value=a),placeholder:"粘贴R2/S3预签名上传URL",class:"flex-1"},null,8,["modelValue"]),o(r,{disabled:!N.value,onClick:Fl},{default:g(()=>e[233]||(e[233]=[p("生成")])),_:1},8,["disabled"])])]),t("div",null,[t("label",{class:n(["text-sm mb-1 block",s.value.mutedText])},"下载URL（预签名）",2),t("div",Gn,[o(V,{modelValue:st.value,"onUpdate:modelValue":e[104]||(e[104]=a=>st.value=a),placeholder:"粘贴R2/S3预签名下载URL",class:"flex-1"},null,8,["modelValue"]),o(r,{disabled:!N.value,onClick:ql},{default:g(()=>e[234]||(e[234]=[p("生成")])),_:1},8,["disabled"])])])]),t("div",Jn,[o(r,{color:"primary",onClick:Wl},{default:g(()=>e[235]||(e[235]=[p("上传备份到云")])),_:1}),o(r,{color:"warning",onClick:Kl},{default:g(()=>e[236]||(e[236]=[p("从云恢复备份")])),_:1}),o(r,{color:"blue",variant:"solid",disabled:!N.value||!k.publicBaseURL,onClick:Gl},{default:g(()=>e[237]||(e[237]=[p("按配置恢复")])),_:1},8,["disabled"])])],2)])],2)])])],2),Qt(t("div",{class:n(["flex fixed bottom-0 left-0 right-0 md:left-72 z-50 border-t px-3 py-3 justify-between items-center backdrop-blur-md shadow-xl",[s.value.bottomBg,s.value.border]])},[o(r,{icon:"i-heroicons-arrow-left",color:i.value==="light"?"gray":i.value==="midnight"?"blue":i.value==="slate"?"slate":"gray",variant:i.value==="light"?"soft":"solid",onClick:e[105]||(e[105]=a=>l.$router.push("/")),class:"shadow ring-1 ring-inset ring-slate-400/30 transition hover:opacity-90"},{default:g(()=>e[238]||(e[238]=[p(" 返回首页 ")])),_:1},8,["color","variant"]),qe.value?(b(),w("div",_n,[o(r,{icon:"i-heroicons-power",color:"red",variant:"solid",onClick:Ut,class:"shadow transition hover:opacity-90"},{default:g(()=>e[239]||(e[239]=[p(" 退出登录 ")])),_:1})])):(b(),w("div",Zn,[o(r,{color:"primary",onClick:e[106]||(e[106]=a=>{Ge.value=!0,we.value=!0})},{default:g(()=>e[240]||(e[240]=[p("登录")])),_:1}),o(r,{color:"secondary",onClick:e[107]||(e[107]=a=>{Ge.value=!0,we.value=!1})},{default:g(()=>e[241]||(e[241]=[p("注册")])),_:1})]))],2),[[as,z.value]]),D("",!0)]),o(It,{modelValue:Ge.value,"onUpdate:modelValue":e[144]||(e[144]=a=>Ge.value=a)},{default:g(()=>[t("div",Qn,[t("h3",{class:n(["text-xl font-semibold mb-4",s.value.text])},x(we.value?"用户登录":"用户注册"),3),o(_l,{state:Te,class:"space-y-4"},{default:g(()=>[o(Ht,null,{default:g(()=>[o(V,{modelValue:Te.username,"onUpdate:modelValue":e[140]||(e[140]=a=>Te.username=a),placeholder:"用户名",class:"w-full"},null,8,["modelValue"])]),_:1}),o(Ht,null,{default:g(()=>[o(V,{modelValue:Te.password,"onUpdate:modelValue":e[141]||(e[141]=a=>Te.password=a),type:"password",placeholder:"密码",class:"w-full"},null,8,["modelValue"])]),_:1}),t("div",Xn,[o(r,{variant:"ghost",onClick:e[142]||(e[142]=a=>we.value=!we.value)},{default:g(()=>[p(x(we.value?"去注册":"去登录"),1)]),_:1}),o(r,{color:"primary",onClick:e[143]||(e[143]=a=>we.value?ve(A)(Te):ve(u)(Te))},{default:g(()=>[p(x(we.value?"登录":"注册"),1)]),_:1})])]),_:1},8,["state"])])]),_:1},8,["modelValue"]),t("input",{type:"file",ref_key:"fileInput",ref:Je,accept:"image/*",multiple:"",class:"hidden",onChange:$l},null,544)],2)}}}),ei=yt(Yn,[["__scopeId","data-v-b88ed9a7"]]),ii=He({__name:"status",setup(m){return(O,P)=>(b(),w(de,null,[o(ei),o(ds)],64))}});export{ii as default};
