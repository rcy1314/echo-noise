var Zs=Object.defineProperty;var Xs=(k,n,r)=>n in k?Zs(k,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):k[n]=r;var gn=(k,n,r)=>Xs(k,typeof n!="symbol"?n+"":n,r);import{s as Js,u as Qs,a as Bn,r as ee,b as el,t as Ii,g as tl,o as nl,c as Xn,w as gt,d as ua,e as il,f as rl,h as De,i as Me,j as En,k as al,l as ol,m as Ua,n as ii,_ as cn,p as Dt,q as qt,v as ie,x as dt,y as br,z as Oi,A as sl,B as Va,C as ll,D as pn,E as Wt,F as de,G as ei,H as qa,I as Ye,J as sn,K as at,L as mi,M as Cn,N as Wa,O as $n,P as ai,Q as q,R as ve,S as Ya,T as Gt,U as Tt,V as He,W as xn,X as Fe,Y as Qe,Z as cl,$ as Ht,a0 as Vt,a1 as Pi,a2 as Fn,a3 as zn,a4 as Cr,a5 as kr,a6 as ul,a7 as Jn,a8 as gi,a9 as Ka,aa as nr,ab as da,ac as fa,ad as dl}from"./B5Ug7n5G.js";import{_ as Tr}from"./D4kD5da7.js";import{_ as Ga}from"./Hw1Pf6vM.js";import{_ as fl,a as hl,N as pl}from"./5uwiVi6y.js";import{s as ml}from"./x_rD_Ya3.js";const gl=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],vl=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],yl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",vn=[];let bl=class{constructor(){gn(this,"_data",new vi);gn(this,"_hash",new vi([...gl]));gn(this,"_nDataBytes",0);gn(this,"_minBufferSize",0)}finalize(n){n&&this._append(n);const r=this._nDataBytes*8,s=this._data.sigBytes*8;return this._data.words[s>>>5]|=128<<24-s%32,this._data.words[(s+64>>>9<<4)+14]=Math.floor(r/4294967296),this._data.words[(s+64>>>9<<4)+15]=r,this._data.sigBytes=this._data.words.length*4,this._process(),this._hash}_doProcessBlock(n,r){const s=this._hash.words;let c=s[0],h=s[1],p=s[2],f=s[3],y=s[4],T=s[5],C=s[6],d=s[7];for(let u=0;u<64;u++){if(u<16)vn[u]=n[r+u]|0;else{const M=vn[u-15],x=(M<<25|M>>>7)^(M<<14|M>>>18)^M>>>3,v=vn[u-2],O=(v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10;vn[u]=x+vn[u-7]+O+vn[u-16]}const m=y&T^~y&C,g=c&h^c&p^h&p,w=(c<<30|c>>>2)^(c<<19|c>>>13)^(c<<10|c>>>22),b=(y<<26|y>>>6)^(y<<21|y>>>11)^(y<<7|y>>>25),S=d+b+m+vl[u]+vn[u],_=w+g;d=C,C=T,T=y,y=f+S|0,f=p,p=h,h=c,c=S+_|0}s[0]=s[0]+c|0,s[1]=s[1]+h|0,s[2]=s[2]+p|0,s[3]=s[3]+f|0,s[4]=s[4]+y|0,s[5]=s[5]+T|0,s[6]=s[6]+C|0,s[7]=s[7]+d|0}_append(n){typeof n=="string"&&(n=vi.fromUtf8(n)),this._data.concat(n),this._nDataBytes+=n.sigBytes}_process(n){let r,s=this._data.sigBytes/64;n?s=Math.ceil(s):s=Math.max((s|0)-this._minBufferSize,0);const c=s*16,h=Math.min(c*4,this._data.sigBytes);if(c){for(let p=0;p<c;p+=16)this._doProcessBlock(this._data.words,p);r=this._data.words.splice(0,c),this._data.sigBytes-=h}return new vi(r,h)}},vi=class Za{constructor(n,r){gn(this,"words");gn(this,"sigBytes");n=this.words=n||[],this.sigBytes=r===void 0?n.length*4:r}static fromUtf8(n){const r=unescape(encodeURIComponent(n)),s=r.length,c=[];for(let h=0;h<s;h++)c[h>>>2]|=(r.charCodeAt(h)&255)<<24-h%4*8;return new Za(c,s)}toBase64(){const n=[];for(let r=0;r<this.sigBytes;r+=3){const s=this.words[r>>>2]>>>24-r%4*8&255,c=this.words[r+1>>>2]>>>24-(r+1)%4*8&255,h=this.words[r+2>>>2]>>>24-(r+2)%4*8&255,p=s<<16|c<<8|h;for(let f=0;f<4&&r*8+f*6<this.sigBytes*8;f++)n.push(yl.charAt(p>>>6*(3-f)&63))}return n.join("")}concat(n){if(this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4),this.sigBytes%4)for(let r=0;r<n.sigBytes;r++){const s=n.words[r>>>2]>>>24-r%4*8&255;this.words[this.sigBytes+r>>>2]|=s<<24-(this.sigBytes+r)%4*8}else for(let r=0;r<n.sigBytes;r+=4)this.words[this.sigBytes+r>>>2]=n.words[r>>>2];this.sigBytes+=n.sigBytes}};function wl(k){return new bl().finalize(k).toBase64()}function El(k){return wl(Js(k))}const Sl=k=>k==="defer"||k===!1;function Cl(...k){var w;const n=typeof k[k.length-1]=="string"?k.pop():void 0;typeof k[0]!="string"&&k.unshift(n);let[r,s,c={}]=k;if(typeof r!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof s!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");const h=Qs(),p=s,f=()=>Bn.value,y=()=>h.isHydrating?h.payload.data[r]:h.static.data[r];c.server??(c.server=!0),c.default??(c.default=f),c.getCachedData??(c.getCachedData=y),c.lazy??(c.lazy=!1),c.immediate??(c.immediate=!0),c.deep??(c.deep=Bn.deep),c.dedupe??(c.dedupe="cancel");const T=c.getCachedData(r,h),C=T!=null;if(!h._asyncData[r]||!c.immediate){(w=h.payload._errors)[r]??(w[r]=Bn.errorValue);const b=c.deep?ee:el;h._asyncData[r]={data:b(C?T:c.default()),pending:ee(!C),error:Ii(h.payload._errors,r),status:ee("idle"),_default:c.default}}const d={...h._asyncData[r]};delete d._default,d.refresh=d.execute=(b={})=>{if(h._asyncDataPromises[r]){if(Sl(b.dedupe??c.dedupe))return h._asyncDataPromises[r];h._asyncDataPromises[r].cancelled=!0}if(b._initial||h.isHydrating&&b._initial!==!1){const _=b._initial?T:c.getCachedData(r,h);if(_!=null)return Promise.resolve(_)}d.pending.value=!0,d.status.value="pending";const S=new Promise((_,M)=>{try{_(p(h))}catch(x){M(x)}}).then(async _=>{if(S.cancelled)return h._asyncDataPromises[r];let M=_;c.transform&&(M=await c.transform(_)),c.pick&&(M=Tl(M,c.pick)),h.payload.data[r]=M,d.data.value=M,d.error.value=Bn.errorValue,d.status.value="success"}).catch(_=>{if(S.cancelled)return h._asyncDataPromises[r];d.error.value=rl(_),d.data.value=De(c.default()),d.status.value="error"}).finally(()=>{S.cancelled||(d.pending.value=!1,delete h._asyncDataPromises[r])});return h._asyncDataPromises[r]=S,h._asyncDataPromises[r]},d.clear=()=>kl(h,r);const u=()=>d.refresh({_initial:!0}),m=c.server!==!1&&h.payload.serverRendered;{const b=tl();if(b&&m&&c.immediate&&!b.sp&&(b.sp=[]),b&&!b._nuxtOnBeforeMountCbs){b._nuxtOnBeforeMountCbs=[];const M=b._nuxtOnBeforeMountCbs;nl(()=>{M.forEach(x=>{x()}),M.splice(0,M.length)}),Xn(()=>M.splice(0,M.length))}m&&h.isHydrating&&(d.error.value||T!=null)?(d.pending.value=!1,d.status.value=d.error.value?"error":"success"):b&&(h.payload.serverRendered&&h.isHydrating||c.lazy)&&c.immediate?b._nuxtOnBeforeMountCbs.push(u):c.immediate&&u();const S=il();if(c.watch){const M=gt(c.watch,()=>d.refresh());S&&ua(M)}const _=h.hook("app:data:refresh",async M=>{(!M||M.includes(r))&&await d.refresh()});S&&ua(_)}const g=Promise.resolve(h._asyncDataPromises[r]).then(()=>d);return Object.assign(g,d),g}function kl(k,n){n in k.payload.data&&(k.payload.data[n]=void 0),n in k.payload._errors&&(k.payload._errors[n]=Bn.errorValue),k._asyncData[n]&&(k._asyncData[n].data.value=void 0,k._asyncData[n].error.value=Bn.errorValue,k._asyncData[n].pending.value=!1,k._asyncData[n].status.value="idle"),n in k._asyncDataPromises&&(k._asyncDataPromises[n]&&(k._asyncDataPromises[n].cancelled=!0),k._asyncDataPromises[n]=void 0)}function Tl(k,n){const r={};for(const s of n)r[s]=k[s];return r}function xl(k,n,r){const[s={},c]=typeof n=="string"?[{},n]:[n,r],h=Me(()=>En(k)),p=s.key||El([c,typeof h.value=="string"?h.value:"",..._l(s)]);if(!p||typeof p!="string")throw new TypeError("[nuxt] [useFetch] key must be a string: "+p);const f=p===c?"$f"+p:p;if(!s.baseURL&&typeof h.value=="string"&&h.value[0]==="/"&&h.value[1]==="/")throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:y,lazy:T,default:C,transform:d,pick:u,watch:m,immediate:g,getCachedData:w,deep:b,dedupe:S,..._}=s,M=al({...ol,..._,cache:typeof s.cache=="boolean"?void 0:s.cache}),x={server:y,lazy:T,default:C,transform:d,pick:u,immediate:g,getCachedData:w,deep:b,dedupe:S,watch:m===!1?[]:[M,h,...m||[]]};let v;return Cl(f,()=>{var R;(R=v==null?void 0:v.abort)==null||R.call(v,new DOMException("Request aborted as another request to the same endpoint was initiated.","AbortError")),v=typeof AbortController<"u"?new AbortController:{};const H=En(s.timeout);let z;return H&&(z=setTimeout(()=>v.abort(new DOMException("Request aborted due to timeout.","AbortError")),H),v.signal.onabort=()=>clearTimeout(z)),(s.$fetch||globalThis.$fetch)(h.value,{signal:v.signal,...M}).finally(()=>{clearTimeout(z)})},x)}function _l(k){var r;const n=[((r=En(k.method))==null?void 0:r.toUpperCase())||"GET",En(k.baseURL)];for(const s of[k.params||k.query]){const c=En(s);if(!c)continue;const h={};for(const[p,f]of Object.entries(c))h[En(p)]=En(f);n.push(h)}return n}const Ml={wrapper:"w-full flex flex-col gap-2",indicator:{container:{base:"flex flex-row justify-end",width:"min-w-fit",transition:"transition-all"},align:"text-end",width:"w-fit",color:"text-gray-400 dark:text-gray-500",size:{"2xs":"text-xs",xs:"text-xs",sm:"text-sm",md:"text-sm",lg:"text-sm",xl:"text-base","2xl":"text-base"}},progress:{base:"block appearance-none border-none overflow-hidden",width:"w-full [&::-webkit-progress-bar]:w-full",size:{"2xs":"h-px",xs:"h-0.5",sm:"h-1",md:"h-2",lg:"h-3",xl:"h-4","2xl":"h-5"},rounded:"rounded-full [&::-webkit-progress-bar]:rounded-full",track:"[&::-webkit-progress-bar]:bg-gray-200 [&::-webkit-progress-bar]:dark:bg-gray-700 [@supports(selector(&::-moz-progress-bar))]:bg-gray-200 [@supports(selector(&::-moz-progress-bar))]:dark:bg-gray-700",bar:"[&::-webkit-progress-value]:rounded-full [&::-webkit-progress-value]:transition-all [&::-webkit-progress-value]:ease-in-out [&::-moz-progress-bar]:rounded-full",color:"text-{color}-500 dark:text-{color}-400",background:"[&::-webkit-progress-value]:bg-current [&::-moz-progress-bar]:bg-current",indeterminate:{base:"indeterminate:relative",rounded:"indeterminate:after:rounded-full [&:indeterminate::-webkit-progress-value]:rounded-full [&:indeterminate::-moz-progress-bar]:rounded-full"}},steps:{base:"grid grid-cols-1",color:"text-{color}-500 dark:text-{color}-400",size:{"2xs":"text-xs",xs:"text-xs",sm:"text-sm",md:"text-sm",lg:"text-sm",xl:"text-base","2xl":"text-base"}},step:{base:"transition-all opacity-0 truncate row-start-1 col-start-1",align:"text-end",active:"opacity-100",first:"text-gray-500 dark:text-gray-400"},animation:{carousel:"bar-animation-carousel","carousel-inverse":"bar-animation-carousel-inverse",swing:"bar-animation-swing",elastic:"bar-animation-elastic"},default:{color:"primary",size:"md",animation:"carousel"}},Ll={base:"mx-auto",padding:"px-4 sm:px-6 lg:px-8",constrained:"max-w-7xl"},Al=Ua(ii.ui.strategy,ii.ui.container,Ll),Dl=Dt({inheritAttrs:!1,props:{as:{type:String,default:"div"},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(k){const{ui:n,attrs:r}=Va("container",Ii(k,"ui"),Al),s=Me(()=>ll(pn(n.value.base,n.value.padding,n.value.constrained),k.class));return{ui:n,attrs:r,containerClass:s}}});function Ol(k,n,r,s,c,h){return ie(),qt(sl(k.as),Oi({class:k.containerClass},k.attrs),{default:dt(()=>[br(k.$slots,"default")]),_:3},16,["class"])}const Pl=cn(Dl,[["render",Ol]]),Rl=Symbol.for("nuxt:client-only"),Il=Dt({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(k,{slots:n,attrs:r}){const s=ee(!1);return Wt(()=>{s.value=!0}),ei(Rl,!0),c=>{var y;if(s.value)return(y=n.default)==null?void 0:y.call(n);const h=n.fallback||n.placeholder;if(h)return h();const p=c.fallback||c.placeholder||"",f=c.fallbackTag||c.placeholderTag||"span";return de(f,r,p)}}}),Xa=qa("messageStore",()=>{const k=ee([]),n=ee(0),r=ee(!0),s=ee(1),c=ee(15),h=Ye(),p=ee(!1),f=ee(null),y=ee([]),T=ee([]),C=ee(null);return{messages:k,total:n,hasMore:r,page:s,pageSize:c,loading:p,siteConfig:f,reset:()=>{k.value=[],n.value=0,r.value=!0,s.value=1,p.value=!1},getMessages:async R=>{if(!p.value){p.value=!0;try{const N=await Cn("messages/page",R,{credentials:"include"});if(!N)return h.add({title:"获取笔记列表失败",description:"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const V=N.data.items.filter(se=>!k.value.some(ue=>ue.id===se.id));return R.page===1?k.value=N.data.items:k.value=[...k.value,...V],n.value=N.data.total,s.value=R.page,c.value=R.pageSize,r.value=k.value.length<n.value,N.data}catch(N){console.error("获取笔记列表失败:",N),h.add({title:"获取笔记列表失败",description:"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3})}finally{p.value=!1}}},deleteMessage:async R=>{try{const N=await Wa(`messages/${R}`,void 0,{credentials:"include"});return!N||N.code!==1?(h.add({title:"删除笔记失败",description:N==null?void 0:N.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):(k.value=k.value.filter(V=>V.id!==R),n.value-=1,N)}catch(N){throw console.error("删除笔记失败:",N),N}},updateMessage:async(R,N)=>{try{const V=await mi(`messages/${R}`,{content:N},{credentials:"include"});if(!V||V.code!==1)return h.add({title:"更新笔记失败",description:V==null?void 0:V.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const se=k.value.findIndex(ue=>ue.id===R);return se!==-1&&(k.value[se]=V.data),V}catch(V){throw console.error("更新笔记失败:",V),V}},setPinned:async(R,N)=>{try{const V=await mi(`messages/${R}/pin`,{pinned:N},{credentials:"include"});if(!V||V.code!==1)return h.add({title:"更新置顶状态失败",description:V==null?void 0:V.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const se=k.value.findIndex(ue=>ue.id===R);return se!==-1&&(k.value[se]={...k.value[se],pinned:N},k.value=[...k.value].sort((ue,ke)=>{const Re=ue.pinned?1:0,_e=ke.pinned?1:0;return Re!==_e?_e-Re:new Date(ke.created_at).getTime()-new Date(ue.created_at).getTime()})),V}catch(V){throw console.error("更新置顶状态失败:",V),V}},getMessageById:async R=>{try{const N=await sn(`messages/${R}`,void 0,{credentials:"include"});return!N||N.code!==1?(h.add({title:"获取消息失败",description:(N==null?void 0:N.msg)||"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):N.data}catch(N){throw console.error("获取消息失败:",N),N}},getSiteConfig:async()=>{try{const R=await sn("site/config",void 0,{credentials:"include"});return!R||R.code!==1?(h.add({title:"获取网站配置失败",description:(R==null?void 0:R.msg)||"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):(f.value=R.data,at(),R.data)}catch(R){throw console.error("获取网站配置失败:",R),R}},updateSiteConfig:async(R,N)=>{try{const V=await mi("site/config",{[R]:N},{credentials:"include"});return!V||V.code!==1?(h.add({title:"更新配置失败",description:V==null?void 0:V.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):(f.value={...f.value,[R]:N},V.data)}catch(V){throw console.error("更新配置失败:",V),V}},tags:y,images:T,getAllTags:async()=>{try{const R=await sn("messages/tags",void 0,{credentials:"include"});return!R||R.code!==1?(h.add({title:"获取标签列表失败",description:(R==null?void 0:R.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(y.value=R.data,R.data)}catch(R){throw console.error("获取标签列表失败:",R),R}},getMessagesByTag:async R=>{try{const N=await sn(`messages/tags/${encodeURIComponent(R)}`,void 0,{credentials:"include"});return!N||N.code!==1?(h.add({title:"获取标签消息失败",description:(N==null?void 0:N.msg)||"请稍后重试",color:"red",timeout:2e3}),null):N.data}catch(N){throw console.error("获取标签消息失败:",N),N}},getAllImages:async()=>{try{const R=await sn("messages/images",void 0,{credentials:"include"});return!R||R.code!==1?(h.add({title:"获取图片列表失败",description:(R==null?void 0:R.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(T.value=R.data,R.data)}catch(R){throw console.error("获取图片列表失败:",R),R}},notifyConfig:C,getNotifyConfig:async()=>{try{const R=await sn("notify/config",void 0,{credentials:"include"});return!R||R.code!==1?(h.add({title:"获取推送配置失败",description:(R==null?void 0:R.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(C.value=R.data,R.data)}catch(R){throw console.error("获取推送配置失败:",R),R}},updateNotifyConfig:async R=>{try{const N=await mi("notify/config",R,{credentials:"include"});return!N||N.code!==1?(h.add({title:"更新推送配置失败",description:(N==null?void 0:N.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(C.value=N.data,N.data)}catch(N){throw console.error("更新推送配置失败:",N),N}},testNotify:async R=>{try{const N=await Cn(`notify/test?type=${R}`,{},{credentials:"include"});if(!N||N.code!==1)throw new Error((N==null?void 0:N.msg)||"测试失败");return N.data}catch(N){throw console.error("推送测试失败:",N),N}},createMessage:async R=>{try{const N=await Cn("messages",R,{credentials:"include"});if(!N||N.code!==1)throw new Error((N==null?void 0:N.msg)||"创建消息失败");if(R.notify)try{const V=$n().public.baseApi,se={content:R.content,images:R.image_url?[`${V}${R.image_url}`].filter(Boolean):[],format:"markdown"},ue=await Cn("notify/send",se,{credentials:"include"});(!ue||ue.code!==1)&&console.warn("推送失败:",ue==null?void 0:ue.msg)}catch(V){console.error("消息推送失败:",V)}return h.add({title:"成功",description:"发布成功",color:"green",timeout:2e3}),N.data}catch(N){throw console.error("创建消息失败:",N),N}}}}),Ja=()=>{const k=Xa(),n=Ye();return{save:async h=>{try{const p=await Cn("messages",h);if(!p||p.code!==1)return console.log(p==null?void 0:p.code),n.add({title:"添加失败",description:String(p==null?void 0:p.msg),icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const f=p.data;return k.messages.unshift(f),n.add({title:"保存成功",description:"消息已保存",icon:"i-fluent-checkmark-starburst-16-filled",color:"green",timeout:1e3}),p.data}catch(p){console.error(p)}},uploadImage:async h=>{try{const p=new FormData;p.append("image",h);const f=await Cn("images/upload",p);return!f||f.code!==1?(console.log(f==null?void 0:f.code),n.add({title:"上传失败",description:String(f==null?void 0:f.msg),icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):f.data}catch(p){return console.error("上传图片错误:",p),null}},deleteMessage:async h=>{try{const p=await k.deleteMessage(h);if(p&&p.code===1)return n.add({title:"删除成功",description:"笔记已删除",icon:"i-fluent-checkmark-starburst-16-filled",color:"green",timeout:1e3}),!0}catch(p){console.error(p)}}}},me=(k,n=1e4)=>(k=parseFloat(k+"")||0,Math.round((k+Number.EPSILON)*n)/n),wr=function(k){if(!(k&&k instanceof Element&&k.offsetParent))return!1;const n=k.scrollHeight>k.clientHeight,r=window.getComputedStyle(k).overflowY,s=r.indexOf("hidden")!==-1,c=r.indexOf("visible")!==-1;return n&&!s&&!c},Hi=function(k,n=void 0){return!(!k||k===document.body||n&&k===n)&&(wr(k)?k:Hi(k.parentElement,n))},en=function(k){var n=new DOMParser().parseFromString(k,"text/html").body;if(n.childElementCount>1){for(var r=document.createElement("div");n.firstChild;)r.appendChild(n.firstChild);return r}return n.firstChild},xr=k=>`${k||""}`.split(" ").filter(n=>!!n),tn=(k,n,r)=>{k&&xr(n).forEach(s=>{k.classList.toggle(s,r||!1)})};class On{constructor(n){Object.defineProperty(this,"pageX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pageY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"nativePointer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.nativePointer=n,this.pageX=n.pageX,this.pageY=n.pageY,this.clientX=n.clientX,this.clientY=n.clientY,this.id=self.Touch&&n instanceof Touch?n.identifier:-1,this.time=Date.now()}}const Pn={passive:!1};class Hl{constructor(n,{start:r=()=>!0,move:s=()=>{},end:c=()=>{}}){Object.defineProperty(this,"element",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"startCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"moveCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"endCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"currentPointers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"startPointers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.element=n,this.startCallback=r,this.moveCallback=s,this.endCallback=c;for(const h of["onPointerStart","onTouchStart","onMove","onTouchEnd","onPointerEnd","onWindowBlur"])this[h]=this[h].bind(this);this.element.addEventListener("mousedown",this.onPointerStart,Pn),this.element.addEventListener("touchstart",this.onTouchStart,Pn),this.element.addEventListener("touchmove",this.onMove,Pn),this.element.addEventListener("touchend",this.onTouchEnd),this.element.addEventListener("touchcancel",this.onTouchEnd)}onPointerStart(n){if(!n.buttons||n.button!==0)return;const r=new On(n);this.currentPointers.some(s=>s.id===r.id)||this.triggerPointerStart(r,n)&&(window.addEventListener("mousemove",this.onMove),window.addEventListener("mouseup",this.onPointerEnd),window.addEventListener("blur",this.onWindowBlur))}onTouchStart(n){for(const r of Array.from(n.changedTouches||[]))this.triggerPointerStart(new On(r),n);window.addEventListener("blur",this.onWindowBlur)}onMove(n){const r=this.currentPointers.slice(),s="changedTouches"in n?Array.from(n.changedTouches||[]).map(h=>new On(h)):[new On(n)],c=[];for(const h of s){const p=this.currentPointers.findIndex(f=>f.id===h.id);p<0||(c.push(h),this.currentPointers[p]=h)}c.length&&this.moveCallback(n,this.currentPointers.slice(),r)}onPointerEnd(n){n.buttons>0&&n.button!==0||(this.triggerPointerEnd(n,new On(n)),window.removeEventListener("mousemove",this.onMove),window.removeEventListener("mouseup",this.onPointerEnd),window.removeEventListener("blur",this.onWindowBlur))}onTouchEnd(n){for(const r of Array.from(n.changedTouches||[]))this.triggerPointerEnd(n,new On(r))}triggerPointerStart(n,r){return!!this.startCallback(r,n,this.currentPointers.slice())&&(this.currentPointers.push(n),this.startPointers.push(n),!0)}triggerPointerEnd(n,r){const s=this.currentPointers.findIndex(c=>c.id===r.id);s<0||(this.currentPointers.splice(s,1),this.startPointers.splice(s,1),this.endCallback(n,r,this.currentPointers.slice()))}onWindowBlur(){this.clear()}clear(){for(;this.currentPointers.length;){const n=this.currentPointers[this.currentPointers.length-1];this.currentPointers.splice(this.currentPointers.length-1,1),this.startPointers.splice(this.currentPointers.length-1,1),this.endCallback(new Event("touchend",{bubbles:!0,cancelable:!0,clientX:n.clientX,clientY:n.clientY}),n,this.currentPointers.slice())}}stop(){this.element.removeEventListener("mousedown",this.onPointerStart,Pn),this.element.removeEventListener("touchstart",this.onTouchStart,Pn),this.element.removeEventListener("touchmove",this.onMove,Pn),this.element.removeEventListener("touchend",this.onTouchEnd),this.element.removeEventListener("touchcancel",this.onTouchEnd),window.removeEventListener("mousemove",this.onMove),window.removeEventListener("mouseup",this.onPointerEnd),window.removeEventListener("blur",this.onWindowBlur)}}function ha(k,n){return n?Math.sqrt(Math.pow(n.clientX-k.clientX,2)+Math.pow(n.clientY-k.clientY,2)):0}function pa(k,n){return n?{clientX:(k.clientX+n.clientX)/2,clientY:(k.clientY+n.clientY)/2}:k}const Er=k=>typeof k=="object"&&k!==null&&k.constructor===Object&&Object.prototype.toString.call(k)==="[object Object]",Nt=(k,...n)=>{const r=n.length;for(let s=0;s<r;s++){const c=n[s]||{};Object.entries(c).forEach(([h,p])=>{const f=Array.isArray(p)?[]:{};k[h]||Object.assign(k,{[h]:f}),Er(p)?Object.assign(k[h],Nt(f,p)):Array.isArray(p)?Object.assign(k,{[h]:[...p]}):Object.assign(k,{[h]:p})})}return k},ir=function(k,n){return k.split(".").reduce((r,s)=>typeof r=="object"?r[s]:void 0,n)};class Ni{constructor(n={}){Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),this.setOptions(n);for(const r of Object.getOwnPropertyNames(Object.getPrototypeOf(this)))r.startsWith("on")&&typeof this[r]=="function"&&(this[r]=this[r].bind(this))}setOptions(n){this.options=n?Nt({},this.constructor.defaults,n):{};for(const[r,s]of Object.entries(this.option("on")||{}))this.on(r,s)}option(n,...r){let s=ir(n,this.options);return s&&typeof s=="function"&&(s=s.call(this,this,...r)),s}optionFor(n,r,s,...c){let h=ir(r,n);var p;typeof(p=h)!="string"||isNaN(p)||isNaN(parseFloat(p))||(h=parseFloat(h)),h==="true"&&(h=!0),h==="false"&&(h=!1),h&&typeof h=="function"&&(h=h.call(this,this,n,...c));let f=ir(r,this.options);return f&&typeof f=="function"?h=f.call(this,this,n,...c,h):h===void 0&&(h=f),h===void 0?s:h}cn(n){const r=this.options.classes;return r&&r[n]||""}localize(n,r=[]){n=String(n).replace(/\{\{(\w+).?(\w+)?\}\}/g,(s,c,h)=>{let p="";return h?p=this.option(`${c[0]+c.toLowerCase().substring(1)}.l10n.${h}`):c&&(p=this.option(`l10n.${c}`)),p||(p=s),p});for(let s=0;s<r.length;s++)n=n.split(r[s][0]).join(r[s][1]);return n=n.replace(/\{\{(.*?)\}\}/g,(s,c)=>c)}on(n,r){let s=[];typeof n=="string"?s=n.split(" "):Array.isArray(n)&&(s=n),this.events||(this.events=new Map),s.forEach(c=>{let h=this.events.get(c);h||(this.events.set(c,[]),h=[]),h.includes(r)||h.push(r),this.events.set(c,h)})}off(n,r){let s=[];typeof n=="string"?s=n.split(" "):Array.isArray(n)&&(s=n),s.forEach(c=>{const h=this.events.get(c);if(Array.isArray(h)){const p=h.indexOf(r);p>-1&&h.splice(p,1)}})}emit(n,...r){[...this.events.get(n)||[]].forEach(s=>s(this,...r)),n!=="*"&&this.emit("*",n,...r)}}Object.defineProperty(Ni,"version",{enumerable:!0,configurable:!0,writable:!0,value:"5.0.36"}),Object.defineProperty(Ni,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{}});class _r extends Ni{constructor(n={}){super(n),Object.defineProperty(this,"plugins",{enumerable:!0,configurable:!0,writable:!0,value:{}})}attachPlugins(n={}){const r=new Map;for(const[s,c]of Object.entries(n)){const h=this.option(s),p=this.plugins[s];p||h===!1?p&&h===!1&&(p.detach(),delete this.plugins[s]):r.set(s,new c(this,h||{}))}for(const[s,c]of r)this.plugins[s]=c,c.attach()}detachPlugins(n){n=n||Object.keys(this.plugins);for(const r of n){const s=this.plugins[r];s&&s.detach(),delete this.plugins[r]}return this.emit("detachPlugins"),this}}var tt;(function(k){k[k.Init=0]="Init",k[k.Error=1]="Error",k[k.Ready=2]="Ready",k[k.Panning=3]="Panning",k[k.Mousemove=4]="Mousemove",k[k.Destroy=5]="Destroy"})(tt||(tt={}));const an=["a","b","c","d","e","f"],Qa={PANUP:"Move up",PANDOWN:"Move down",PANLEFT:"Move left",PANRIGHT:"Move right",ZOOMIN:"Zoom in",ZOOMOUT:"Zoom out",TOGGLEZOOM:"Toggle zoom level",TOGGLE1TO1:"Toggle zoom level",ITERATEZOOM:"Toggle zoom level",ROTATECCW:"Rotate counterclockwise",ROTATECW:"Rotate clockwise",FLIPX:"Flip horizontally",FLIPY:"Flip vertically",FITX:"Fit horizontally",FITY:"Fit vertically",RESET:"Reset",TOGGLEFS:"Toggle fullscreen"},Nl={content:null,width:"auto",height:"auto",panMode:"drag",touch:!0,dragMinThreshold:3,lockAxis:!1,mouseMoveFactor:1,mouseMoveFriction:.12,zoom:!0,pinchToZoom:!0,panOnlyZoomed:"auto",minScale:1,maxScale:2,friction:.25,dragFriction:.35,decelFriction:.05,click:"toggleZoom",dblClick:!1,wheel:"zoom",wheelLimit:7,spinner:!0,bounds:"auto",infinite:!1,rubberband:!0,bounce:!0,maxVelocity:75,transformParent:!1,classes:{content:"f-panzoom__content",isLoading:"is-loading",canZoomIn:"can-zoom_in",canZoomOut:"can-zoom_out",isDraggable:"is-draggable",isDragging:"is-dragging",inFullscreen:"in-fullscreen",htmlHasFullscreen:"with-panzoom-in-fullscreen"},l10n:Qa},ma='<circle cx="25" cy="25" r="20"></circle>',Mr='<div class="f-spinner"><svg viewBox="0 0 50 50">'+ma+ma+"</svg></div>",It=k=>k&&k!==null&&k instanceof Element&&"nodeType"in k,Je=(k,n)=>{k&&xr(n).forEach(r=>{k.classList.remove(r)})},Ae=(k,n)=>{k&&xr(n).forEach(r=>{k.classList.add(r)})},yi={a:1,b:0,c:0,d:1,e:0,f:0},jl=1e5,bi=1e4,zt="mousemove",ga="drag",va="content",$t="auto";let rr=null,ar=null;class _n extends _r{get fits(){return this.contentRect.width-this.contentRect.fitWidth<1&&this.contentRect.height-this.contentRect.fitHeight<1}get isTouchDevice(){return ar===null&&(ar=window.matchMedia("(hover: none)").matches),ar}get isMobile(){return rr===null&&(rr=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)),rr}get panMode(){return this.options.panMode!==zt||this.isTouchDevice?ga:zt}get panOnlyZoomed(){const n=this.options.panOnlyZoomed;return n===$t?this.isTouchDevice:n}get isInfinite(){return this.option("infinite")}get angle(){return 180*Math.atan2(this.current.b,this.current.a)/Math.PI||0}get targetAngle(){return 180*Math.atan2(this.target.b,this.target.a)/Math.PI||0}get scale(){const{a:n,b:r}=this.current;return Math.sqrt(n*n+r*r)||1}get targetScale(){const{a:n,b:r}=this.target;return Math.sqrt(n*n+r*r)||1}get minScale(){return this.option("minScale")||1}get fullScale(){const{contentRect:n}=this;return n.fullWidth/n.fitWidth||1}get maxScale(){return this.fullScale*(this.option("maxScale")||1)||1}get coverScale(){const{containerRect:n,contentRect:r}=this,s=Math.max(n.height/r.fitHeight,n.width/r.fitWidth)||1;return Math.min(this.fullScale,s)}get isScaling(){return Math.abs(this.targetScale-this.scale)>1e-5&&!this.isResting}get isContentLoading(){const n=this.content;return!!(n&&n instanceof HTMLImageElement)&&!n.complete}get isResting(){if(this.isBouncingX||this.isBouncingY)return!1;for(const n of an){const r=n=="e"||n==="f"?1e-4:1e-5;if(Math.abs(this.target[n]-this.current[n])>r)return!1}return!(!this.ignoreBounds&&!this.checkBounds().inBounds)}constructor(n,r={},s={}){var c;if(super(r),Object.defineProperty(this,"pointerTracker",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"resizeObserver",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"updateTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"clickTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"rAF",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"isTicking",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreBounds",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isBouncingX",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isBouncingY",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"clicks",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"trackingPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"pwt",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"cwd",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"pmme",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"friction",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:tt.Init}),Object.defineProperty(this,"isDragging",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"spinner",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"containerRect",{enumerable:!0,configurable:!0,writable:!0,value:{width:0,height:0,innerWidth:0,innerHeight:0}}),Object.defineProperty(this,"contentRect",{enumerable:!0,configurable:!0,writable:!0,value:{top:0,right:0,bottom:0,left:0,fullWidth:0,fullHeight:0,fitWidth:0,fitHeight:0,width:0,height:0}}),Object.defineProperty(this,"dragStart",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0,top:0,left:0,time:0}}),Object.defineProperty(this,"dragOffset",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0,time:0}}),Object.defineProperty(this,"current",{enumerable:!0,configurable:!0,writable:!0,value:Object.assign({},yi)}),Object.defineProperty(this,"target",{enumerable:!0,configurable:!0,writable:!0,value:Object.assign({},yi)}),Object.defineProperty(this,"velocity",{enumerable:!0,configurable:!0,writable:!0,value:{a:0,b:0,c:0,d:0,e:0,f:0}}),Object.defineProperty(this,"lockedAxis",{enumerable:!0,configurable:!0,writable:!0,value:!1}),!n)throw new Error("Container Element Not Found");this.container=n,this.initContent(),this.attachPlugins(Object.assign(Object.assign({},_n.Plugins),s)),this.emit("attachPlugins"),this.emit("init");const h=this.content;if(h.addEventListener("load",this.onLoad),h.addEventListener("error",this.onError),this.isContentLoading){if(this.option("spinner")){n.classList.add(this.cn("isLoading"));const p=en(Mr);!n.contains(h)||h.parentElement instanceof HTMLPictureElement?this.spinner=n.appendChild(p):this.spinner=((c=h.parentElement)===null||c===void 0?void 0:c.insertBefore(p,h))||null}this.emit("beforeLoad")}else queueMicrotask(()=>{this.enable()})}initContent(){const{container:n}=this,r=this.cn(va);let s=this.option(va)||n.querySelector(`.${r}`);if(s||(s=n.querySelector("img,picture")||n.firstElementChild,s&&Ae(s,r)),s instanceof HTMLPictureElement&&(s=s.querySelector("img")),!s)throw new Error("No content found");this.content=s}onLoad(){const{spinner:n,container:r,state:s}=this;n&&(n.remove(),this.spinner=null),this.option("spinner")&&r.classList.remove(this.cn("isLoading")),this.emit("afterLoad"),s===tt.Init?this.enable():this.updateMetrics()}onError(){this.state!==tt.Destroy&&(this.spinner&&(this.spinner.remove(),this.spinner=null),this.stop(),this.detachEvents(),this.state=tt.Error,this.emit("error"))}getNextScale(n){const{fullScale:r,targetScale:s,coverScale:c,maxScale:h,minScale:p}=this;let f=p;switch(n){case"toggleMax":f=s-p<.5*(h-p)?h:p;break;case"toggleCover":f=s-p<.5*(c-p)?c:p;break;case"toggleZoom":f=s-p<.5*(r-p)?r:p;break;case"iterateZoom":let y=[1,r,h].sort((C,d)=>C-d),T=y.findIndex(C=>C>s+1e-5);f=y[T]||1}return f}attachObserver(){var n;const r=()=>{const{container:s,containerRect:c}=this;return Math.abs(c.width-s.getBoundingClientRect().width)>.1||Math.abs(c.height-s.getBoundingClientRect().height)>.1};this.resizeObserver||window.ResizeObserver===void 0||(this.resizeObserver=new ResizeObserver(()=>{this.updateTimer||(r()?(this.onResize(),this.isMobile&&(this.updateTimer=setTimeout(()=>{r()&&this.onResize(),this.updateTimer=null},500))):this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null))})),(n=this.resizeObserver)===null||n===void 0||n.observe(this.container)}detachObserver(){var n;(n=this.resizeObserver)===null||n===void 0||n.disconnect()}attachEvents(){const{container:n}=this;n.addEventListener("click",this.onClick,{passive:!1,capture:!1}),n.addEventListener("wheel",this.onWheel,{passive:!1}),this.pointerTracker=new Hl(n,{start:this.onPointerDown,move:this.onPointerMove,end:this.onPointerUp}),document.addEventListener(zt,this.onMouseMove)}detachEvents(){var n;const{container:r}=this;r.removeEventListener("click",this.onClick,{passive:!1,capture:!1}),r.removeEventListener("wheel",this.onWheel,{passive:!1}),(n=this.pointerTracker)===null||n===void 0||n.stop(),this.pointerTracker=null,document.removeEventListener(zt,this.onMouseMove),document.removeEventListener("keydown",this.onKeydown,!0),this.clickTimer&&(clearTimeout(this.clickTimer),this.clickTimer=null),this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null)}animate(){this.setTargetForce();const n=this.friction,r=this.option("maxVelocity");for(const s of an)n?(this.velocity[s]*=1-n,r&&!this.isScaling&&(this.velocity[s]=Math.max(Math.min(this.velocity[s],r),-1*r)),this.current[s]+=this.velocity[s]):this.current[s]=this.target[s];this.setTransform(),this.setEdgeForce(),!this.isResting||this.isDragging?this.rAF=requestAnimationFrame(()=>this.animate()):this.stop("current")}setTargetForce(){for(const n of an)n==="e"&&this.isBouncingX||n==="f"&&this.isBouncingY||(this.velocity[n]=(1/(1-this.friction)-1)*(this.target[n]-this.current[n]))}checkBounds(n=0,r=0){const{current:s}=this,c=s.e+n,h=s.f+r,p=this.getBounds(),{x:f,y}=p,T=f.min,C=f.max,d=y.min,u=y.max;let m=0,g=0;return T!==1/0&&c<T?m=T-c:C!==1/0&&c>C&&(m=C-c),d!==1/0&&h<d?g=d-h:u!==1/0&&h>u&&(g=u-h),Math.abs(m)<1e-4&&(m=0),Math.abs(g)<1e-4&&(g=0),Object.assign(Object.assign({},p),{xDiff:m,yDiff:g,inBounds:!m&&!g})}clampTargetBounds(){const{target:n}=this,{x:r,y:s}=this.getBounds();r.min!==1/0&&(n.e=Math.max(n.e,r.min)),r.max!==1/0&&(n.e=Math.min(n.e,r.max)),s.min!==1/0&&(n.f=Math.max(n.f,s.min)),s.max!==1/0&&(n.f=Math.min(n.f,s.max))}calculateContentDim(n=this.current){const{content:r,contentRect:s}=this,{fitWidth:c,fitHeight:h,fullWidth:p,fullHeight:f}=s;let y=p,T=f;if(this.option("zoom")||this.angle!==0){const C=!(r instanceof HTMLImageElement)&&(window.getComputedStyle(r).maxWidth==="none"||window.getComputedStyle(r).maxHeight==="none"),d=C?p:c,u=C?f:h,m=this.getMatrix(n),g=new DOMPoint(0,0).matrixTransform(m),w=new DOMPoint(0+d,0).matrixTransform(m),b=new DOMPoint(0+d,0+u).matrixTransform(m),S=new DOMPoint(0,0+u).matrixTransform(m),_=Math.abs(b.x-g.x),M=Math.abs(b.y-g.y),x=Math.abs(S.x-w.x),v=Math.abs(S.y-w.y);y=Math.max(_,x),T=Math.max(M,v)}return{contentWidth:y,contentHeight:T}}setEdgeForce(){if(this.ignoreBounds||this.isDragging||this.panMode===zt||this.targetScale<this.scale)return this.isBouncingX=!1,void(this.isBouncingY=!1);const{target:n}=this,{x:r,y:s,xDiff:c,yDiff:h}=this.checkBounds(),p=this.option("maxVelocity");let f=this.velocity.e,y=this.velocity.f;c!==0?(this.isBouncingX=!0,c*f<=0?f+=.14*c:(f=.14*c,r.min!==1/0&&(this.target.e=Math.max(n.e,r.min)),r.max!==1/0&&(this.target.e=Math.min(n.e,r.max))),p&&(f=Math.max(Math.min(f,p),-1*p))):this.isBouncingX=!1,h!==0?(this.isBouncingY=!0,h*y<=0?y+=.14*h:(y=.14*h,s.min!==1/0&&(this.target.f=Math.max(n.f,s.min)),s.max!==1/0&&(this.target.f=Math.min(n.f,s.max))),p&&(y=Math.max(Math.min(y,p),-1*p))):this.isBouncingY=!1,this.isBouncingX&&(this.velocity.e=f),this.isBouncingY&&(this.velocity.f=y)}enable(){const{content:n}=this,r=new DOMMatrixReadOnly(window.getComputedStyle(n).transform);for(const s of an)this.current[s]=this.target[s]=r[s];this.updateMetrics(),this.attachObserver(),this.attachEvents(),this.state=tt.Ready,this.emit("ready")}onClick(n){var r;n.type==="click"&&n.detail===0&&(this.dragOffset.x=0,this.dragOffset.y=0),this.isDragging&&((r=this.pointerTracker)===null||r===void 0||r.clear(),this.trackingPoints=[],this.startDecelAnim());const s=n.target;if(!s||n.defaultPrevented)return;if(s.hasAttribute("disabled"))return n.preventDefault(),void n.stopPropagation();if((()=>{const m=window.getSelection();return m&&m.type==="Range"})()&&!s.closest("button"))return;const c=s.closest("[data-panzoom-action]"),h=s.closest("[data-panzoom-change]"),p=c||h,f=p&&It(p)?p.dataset:null;if(f){const m=f.panzoomChange,g=f.panzoomAction;if((m||g)&&n.preventDefault(),m){let w={};try{w=JSON.parse(m)}catch{console&&console.warn("The given data was not valid JSON")}return void this.applyChange(w)}if(g)return void(this[g]&&this[g]())}if(Math.abs(this.dragOffset.x)>3||Math.abs(this.dragOffset.y)>3)return n.preventDefault(),void n.stopPropagation();if(s.closest("[data-fancybox]"))return;const y=this.content.getBoundingClientRect(),T=this.dragStart;if(T.time&&!this.canZoomOut()&&(Math.abs(y.x-T.x)>2||Math.abs(y.y-T.y)>2))return;this.dragStart.time=0;const C=m=>{this.option("zoom",n)&&m&&typeof m=="string"&&/(iterateZoom)|(toggle(Zoom|Full|Cover|Max)|(zoomTo(Fit|Cover|Max)))/.test(m)&&typeof this[m]=="function"&&(n.preventDefault(),this[m]({event:n}))},d=this.option("click",n),u=this.option("dblClick",n);u?(this.clicks++,this.clicks==1&&(this.clickTimer=setTimeout(()=>{this.clicks===1?(this.emit("click",n),!n.defaultPrevented&&d&&C(d)):(this.emit("dblClick",n),n.defaultPrevented||C(u)),this.clicks=0,this.clickTimer=null},350))):(this.emit("click",n),!n.defaultPrevented&&d&&C(d))}addTrackingPoint(n){const r=this.trackingPoints.filter(s=>s.time>Date.now()-100);r.push(n),this.trackingPoints=r}onPointerDown(n,r,s){var c;if(this.option("touch",n)===!1)return!1;this.pwt=0,this.dragOffset={x:0,y:0,time:0},this.trackingPoints=[];const h=this.content.getBoundingClientRect();if(this.dragStart={x:h.x,y:h.y,top:h.top,left:h.left,time:Date.now()},this.clickTimer)return!1;if(this.panMode===zt&&this.targetScale>1)return n.preventDefault(),n.stopPropagation(),!1;const p=n.composedPath()[0];if(!s.length){if(["TEXTAREA","OPTION","INPUT","SELECT","VIDEO","IFRAME"].includes(p.nodeName)||p.closest("[contenteditable],[data-selectable],[data-draggable],[data-clickable],[data-panzoom-change],[data-panzoom-action]"))return!1;(c=window.getSelection())===null||c===void 0||c.removeAllRanges()}if(n.type==="mousedown")["A","BUTTON"].includes(p.nodeName)||n.preventDefault();else if(Math.abs(this.velocity.a)>.3)return!1;return this.target.e=this.current.e,this.target.f=this.current.f,this.stop(),this.isDragging||(this.isDragging=!0,this.addTrackingPoint(r),this.emit("touchStart",n)),!0}onPointerMove(n,r,s){if(this.option("touch",n)===!1||!this.isDragging||r.length<2&&this.panOnlyZoomed&&me(this.targetScale)<=me(this.minScale)||(this.emit("touchMove",n),n.defaultPrevented))return;this.addTrackingPoint(r[0]);const{content:c}=this,h=pa(s[0],s[1]),p=pa(r[0],r[1]);let f=0,y=0;if(r.length>1){const M=c.getBoundingClientRect();f=h.clientX-M.left-.5*M.width,y=h.clientY-M.top-.5*M.height}const T=ha(s[0],s[1]),C=ha(r[0],r[1]);let d=T?C/T:1,u=p.clientX-h.clientX,m=p.clientY-h.clientY;this.dragOffset.x+=u,this.dragOffset.y+=m,this.dragOffset.time=Date.now()-this.dragStart.time;let g=me(this.targetScale)===me(this.minScale)&&this.option("lockAxis");if(g&&!this.lockedAxis)if(g==="xy"||g==="y"||n.type==="touchmove"){if(Math.abs(this.dragOffset.x)<6&&Math.abs(this.dragOffset.y)<6)return void n.preventDefault();const M=Math.abs(180*Math.atan2(this.dragOffset.y,this.dragOffset.x)/Math.PI);this.lockedAxis=M>45&&M<135?"y":"x",this.dragOffset.x=0,this.dragOffset.y=0,u=0,m=0}else this.lockedAxis=g;if(Hi(n.target,this.content)&&(g="x",this.dragOffset.y=0),g&&g!=="xy"&&this.lockedAxis!==g&&me(this.targetScale)===me(this.minScale))return;n.cancelable&&n.preventDefault(),this.container.classList.add(this.cn("isDragging"));const w=this.checkBounds(u,m);this.option("rubberband")?(this.isInfinite!=="x"&&(w.xDiff>0&&u<0||w.xDiff<0&&u>0)&&(u*=Math.max(0,.5-Math.abs(.75/this.contentRect.fitWidth*w.xDiff))),this.isInfinite!=="y"&&(w.yDiff>0&&m<0||w.yDiff<0&&m>0)&&(m*=Math.max(0,.5-Math.abs(.75/this.contentRect.fitHeight*w.yDiff)))):(w.xDiff&&(u=0),w.yDiff&&(m=0));const b=this.targetScale,S=this.minScale,_=this.maxScale;b<.5*S&&(d=Math.max(d,S)),b>1.5*_&&(d=Math.min(d,_)),this.lockedAxis==="y"&&me(b)===me(S)&&(u=0),this.lockedAxis==="x"&&me(b)===me(S)&&(m=0),this.applyChange({originX:f,originY:y,panX:u,panY:m,scale:d,friction:this.option("dragFriction"),ignoreBounds:!0})}onPointerUp(n,r,s){if(s.length)return this.dragOffset.x=0,this.dragOffset.y=0,void(this.trackingPoints=[]);this.container.classList.remove(this.cn("isDragging")),this.isDragging&&(this.addTrackingPoint(r),this.panOnlyZoomed&&this.contentRect.width-this.contentRect.fitWidth<1&&this.contentRect.height-this.contentRect.fitHeight<1&&(this.trackingPoints=[]),Hi(n.target,this.content)&&this.lockedAxis==="y"&&(this.trackingPoints=[]),this.emit("touchEnd",n),this.isDragging=!1,this.lockedAxis=!1,this.state!==tt.Destroy&&(n.defaultPrevented||this.startDecelAnim()))}startDecelAnim(){var n;const r=this.isScaling;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.isBouncingX=!1,this.isBouncingY=!1;for(const M of an)this.velocity[M]=0;this.target.e=this.current.e,this.target.f=this.current.f,Je(this.container,"is-scaling"),Je(this.container,"is-animating"),this.isTicking=!1;const{trackingPoints:s}=this,c=s[0],h=s[s.length-1];let p=0,f=0,y=0;h&&c&&(p=h.clientX-c.clientX,f=h.clientY-c.clientY,y=h.time-c.time);const T=((n=window.visualViewport)===null||n===void 0?void 0:n.scale)||1;T!==1&&(p*=T,f*=T);let C=0,d=0,u=0,m=0,g=this.option("decelFriction");const w=this.targetScale;if(y>0){u=Math.abs(p)>3?p/(y/30):0,m=Math.abs(f)>3?f/(y/30):0;const M=this.option("maxVelocity");M&&(u=Math.max(Math.min(u,M),-1*M),m=Math.max(Math.min(m,M),-1*M))}u&&(C=u/(1/(1-g)-1)),m&&(d=m/(1/(1-g)-1)),(this.option("lockAxis")==="y"||this.option("lockAxis")==="xy"&&this.lockedAxis==="y"&&me(w)===this.minScale)&&(C=u=0),(this.option("lockAxis")==="x"||this.option("lockAxis")==="xy"&&this.lockedAxis==="x"&&me(w)===this.minScale)&&(d=m=0);const b=this.dragOffset.x,S=this.dragOffset.y,_=this.option("dragMinThreshold")||0;Math.abs(b)<_&&Math.abs(S)<_&&(C=d=0,u=m=0),(this.option("zoom")&&(w<this.minScale-1e-5||w>this.maxScale+1e-5)||r&&!C&&!d)&&(g=.35),this.applyChange({panX:C,panY:d,friction:g}),this.emit("decel",u,m,b,S)}onWheel(n){var r=[-n.deltaX||0,-n.deltaY||0,-n.detail||0].reduce(function(h,p){return Math.abs(p)>Math.abs(h)?p:h});const s=Math.max(-1,Math.min(1,r));if(this.emit("wheel",n,s),this.panMode===zt||n.defaultPrevented)return;const c=this.option("wheel");c==="pan"?(n.preventDefault(),this.panOnlyZoomed&&!this.canZoomOut()||this.applyChange({panX:2*-n.deltaX,panY:2*-n.deltaY,bounce:!1})):c==="zoom"&&this.option("zoom")!==!1&&this.zoomWithWheel(n)}onMouseMove(n){this.panWithMouse(n)}onKeydown(n){n.key==="Escape"&&this.toggleFS()}onResize(){this.updateMetrics(),this.checkBounds().inBounds||this.requestTick()}setTransform(){this.emit("beforeTransform");const{current:n,target:r,content:s,contentRect:c}=this,h=Object.assign({},yi);for(const b of an){const S=b=="e"||b==="f"?bi:jl;h[b]=me(n[b],S),Math.abs(r[b]-n[b])<(b=="e"||b==="f"?.51:.001)&&(n[b]=r[b])}let{a:p,b:f,c:y,d:T,e:C,f:d}=h,u=`matrix(${p}, ${f}, ${y}, ${T}, ${C}, ${d})`,m=s.parentElement instanceof HTMLPictureElement?s.parentElement:s;if(this.option("transformParent")&&(m=m.parentElement||m),m.style.transform===u)return;m.style.transform=u;const{contentWidth:g,contentHeight:w}=this.calculateContentDim();c.width=g,c.height=w,this.emit("afterTransform")}updateMetrics(n=!1){var r;if(!this||this.state===tt.Destroy||this.isContentLoading)return;const s=Math.max(1,((r=window.visualViewport)===null||r===void 0?void 0:r.scale)||1),{container:c,content:h}=this,p=h instanceof HTMLImageElement,f=c.getBoundingClientRect(),y=getComputedStyle(this.container);let T=f.width*s,C=f.height*s;const d=parseFloat(y.paddingTop)+parseFloat(y.paddingBottom),u=T-(parseFloat(y.paddingLeft)+parseFloat(y.paddingRight)),m=C-d;this.containerRect={width:T,height:C,innerWidth:u,innerHeight:m};const g=parseFloat(h.dataset.width||"")||(se=>{let ue=0;return ue=se instanceof HTMLImageElement?se.naturalWidth:se instanceof SVGElement?se.width.baseVal.value:Math.max(se.offsetWidth,se.scrollWidth),ue||0})(h),w=parseFloat(h.dataset.height||"")||(se=>{let ue=0;return ue=se instanceof HTMLImageElement?se.naturalHeight:se instanceof SVGElement?se.height.baseVal.value:Math.max(se.offsetHeight,se.scrollHeight),ue||0})(h);let b=this.option("width",g)||$t,S=this.option("height",w)||$t;const _=b===$t,M=S===$t;typeof b!="number"&&(b=g),typeof S!="number"&&(S=w),_&&(b=g*(S/w)),M&&(S=w/(g/b));let x=h.parentElement instanceof HTMLPictureElement?h.parentElement:h;this.option("transformParent")&&(x=x.parentElement||x);const v=x.getAttribute("style")||"";x.style.setProperty("transform","none","important"),p&&(x.style.width="",x.style.height=""),x.offsetHeight;const O=h.getBoundingClientRect();let H=O.width*s,z=O.height*s,I=H,R=z;H=Math.min(H,b),z=Math.min(z,S),p?{width:H,height:z}=((se,ue,ke,Re)=>{const _e=ke/se,Te=Re/ue,Ne=Math.min(_e,Te);return{width:se*=Ne,height:ue*=Ne}})(b,S,H,z):(H=Math.min(H,b),z=Math.min(z,S));let N=.5*(R-z),V=.5*(I-H);this.contentRect=Object.assign(Object.assign({},this.contentRect),{top:O.top-f.top+N,bottom:f.bottom-O.bottom+N,left:O.left-f.left+V,right:f.right-O.right+V,fitWidth:H,fitHeight:z,width:H,height:z,fullWidth:b,fullHeight:S}),x.style.cssText=v,p&&(x.style.width=`${H}px`,x.style.height=`${z}px`),this.setTransform(),n!==!0&&this.emit("refresh"),this.ignoreBounds||(me(this.targetScale)<me(this.minScale)?this.zoomTo(this.minScale,{friction:0}):this.targetScale>this.maxScale?this.zoomTo(this.maxScale,{friction:0}):this.state===tt.Init||this.checkBounds().inBounds||this.requestTick()),this.updateControls()}calculateBounds(){const{contentWidth:n,contentHeight:r}=this.calculateContentDim(this.target),{targetScale:s,lockedAxis:c}=this,{fitWidth:h,fitHeight:p}=this.contentRect;let f=0,y=0,T=0,C=0;const d=this.option("infinite");if(d===!0||c&&d===c)f=-1/0,T=1/0,y=-1/0,C=1/0;else{let{containerRect:u,contentRect:m}=this,g=me(h*s,bi),w=me(p*s,bi),{innerWidth:b,innerHeight:S}=u;if(u.width===g&&(b=u.width),u.width===w&&(S=u.height),n>b){T=.5*(n-b),f=-1*T;let _=.5*(m.right-m.left);f+=_,T+=_}if(h>b&&n<b&&(f-=.5*(h-b),T-=.5*(h-b)),r>S){C=.5*(r-S),y=-1*C;let _=.5*(m.bottom-m.top);y+=_,C+=_}p>S&&r<S&&(f-=.5*(p-S),T-=.5*(p-S))}return{x:{min:f,max:T},y:{min:y,max:C}}}getBounds(){const n=this.option("bounds");return n!==$t?n:this.calculateBounds()}updateControls(){const n=this,r=n.container,{panMode:s,contentRect:c,targetScale:h,minScale:p}=n;let f=p,y=n.option("click")||!1;y&&(f=n.getNextScale(y));let T=n.canZoomIn(),C=n.canZoomOut(),d=s===ga&&!!this.option("touch"),u=C&&d;if(d&&(me(h)<me(p)&&!this.panOnlyZoomed&&(u=!0),(me(c.width,1)>me(c.fitWidth,1)||me(c.height,1)>me(c.fitHeight,1))&&(u=!0)),me(c.width*h,1)<me(c.fitWidth,1)&&(u=!1),s===zt&&(u=!1),tn(r,this.cn("isDraggable"),u),!this.option("zoom"))return;let m=T&&me(f)>me(h),g=!m&&!u&&C&&me(f)<me(h);tn(r,this.cn("canZoomIn"),m),tn(r,this.cn("canZoomOut"),g);for(const w of r.querySelectorAll("[data-panzoom-action]")){let b=!1,S=!1;switch(w.dataset.panzoomAction){case"zoomIn":T?b=!0:S=!0;break;case"zoomOut":C?b=!0:S=!0;break;case"toggleZoom":case"iterateZoom":T||C?b=!0:S=!0;const _=w.querySelector("g");_&&(_.style.display=T?"":"none")}b?(w.removeAttribute("disabled"),w.removeAttribute("tabindex")):S&&(w.setAttribute("disabled",""),w.setAttribute("tabindex","-1"))}}panTo({x:n=this.target.e,y:r=this.target.f,scale:s=this.targetScale,friction:c=this.option("friction"),angle:h=0,originX:p=0,originY:f=0,flipX:y=!1,flipY:T=!1,ignoreBounds:C=!1}){this.state!==tt.Destroy&&this.applyChange({panX:n-this.target.e,panY:r-this.target.f,scale:s/this.targetScale,angle:h,originX:p,originY:f,friction:c,flipX:y,flipY:T,ignoreBounds:C})}applyChange({panX:n=0,panY:r=0,scale:s=1,angle:c=0,originX:h=-this.current.e,originY:p=-this.current.f,friction:f=this.option("friction"),flipX:y=!1,flipY:T=!1,ignoreBounds:C=!1,bounce:d=this.option("bounce")}){const u=this.state;if(u===tt.Destroy)return;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.friction=f||0,this.ignoreBounds=C;const{current:m}=this,g=m.e,w=m.f,b=this.getMatrix(this.target);let S=new DOMMatrix().translate(g,w).translate(h,p).translate(n,r);if(this.option("zoom")){if(!C){const _=this.targetScale,M=this.minScale,x=this.maxScale;_*s<M&&(s=M/_),_*s>x&&(s=x/_)}S=S.scale(s)}S=S.translate(-h,-p).translate(-g,-w).multiply(b),c&&(S=S.rotate(c)),y&&(S=S.scale(-1,1)),T&&(S=S.scale(1,-1));for(const _ of an)_!=="e"&&_!=="f"&&(S[_]>this.minScale+1e-5||S[_]<this.minScale-1e-5)?this.target[_]=S[_]:this.target[_]=me(S[_],bi);(this.targetScale<this.scale||Math.abs(s-1)>.1||this.panMode===zt||d===!1)&&!C&&this.clampTargetBounds(),u===tt.Init?this.animate():this.isResting||(this.state=tt.Panning,this.requestTick())}stop(n=!1){if(this.state===tt.Init||this.state===tt.Destroy)return;const r=this.isTicking;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.isBouncingX=!1,this.isBouncingY=!1;for(const s of an)this.velocity[s]=0,n==="current"?this.current[s]=this.target[s]:n==="target"&&(this.target[s]=this.current[s]);this.setTransform(),Je(this.container,"is-scaling"),Je(this.container,"is-animating"),this.isTicking=!1,this.state=tt.Ready,r&&(this.emit("endAnimation"),this.updateControls())}requestTick(){this.isTicking||(this.emit("startAnimation"),this.updateControls(),Ae(this.container,"is-animating"),this.isScaling&&Ae(this.container,"is-scaling")),this.isTicking=!0,this.rAF||(this.rAF=requestAnimationFrame(()=>this.animate()))}panWithMouse(n,r=this.option("mouseMoveFriction")){if(this.pmme=n,this.panMode!==zt||!n||me(this.targetScale)<=me(this.minScale))return;this.emit("mouseMove",n);const{container:s,containerRect:c,contentRect:h}=this,p=c.width,f=c.height,y=s.getBoundingClientRect(),T=(n.clientX||0)-y.left,C=(n.clientY||0)-y.top;let{contentWidth:d,contentHeight:u}=this.calculateContentDim(this.target);const m=this.option("mouseMoveFactor");m>1&&(d!==p&&(d*=m),u!==f&&(u*=m));let g=.5*(d-p)-T/p*100/100*(d-p);g+=.5*(h.right-h.left);let w=.5*(u-f)-C/f*100/100*(u-f);w+=.5*(h.bottom-h.top),this.applyChange({panX:g-this.target.e,panY:w-this.target.f,friction:r})}zoomWithWheel(n){if(this.state===tt.Destroy||this.state===tt.Init)return;const r=Date.now();if(r-this.pwt<45)return void n.preventDefault();this.pwt=r;var s=[-n.deltaX||0,-n.deltaY||0,-n.detail||0].reduce(function(T,C){return Math.abs(C)>Math.abs(T)?C:T});const c=Math.max(-1,Math.min(1,s)),{targetScale:h,maxScale:p,minScale:f}=this;let y=h*(100+45*c)/100;me(y)<me(f)&&me(h)<=me(f)?(this.cwd+=Math.abs(c),y=f):me(y)>me(p)&&me(h)>=me(p)?(this.cwd+=Math.abs(c),y=p):(this.cwd=0,y=Math.max(Math.min(y,p),f)),this.cwd>this.option("wheelLimit")||(n.preventDefault(),me(y)!==me(h)&&this.zoomTo(y,{event:n}))}canZoomIn(){return this.option("zoom")&&(me(this.contentRect.width,1)<me(this.contentRect.fitWidth,1)||me(this.targetScale)<me(this.maxScale))}canZoomOut(){return this.option("zoom")&&me(this.targetScale)>me(this.minScale)}zoomIn(n=1.25,r){this.zoomTo(this.targetScale*n,r)}zoomOut(n=.8,r){this.zoomTo(this.targetScale*n,r)}zoomToFit(n){this.zoomTo("fit",n)}zoomToCover(n){this.zoomTo("cover",n)}zoomToFull(n){this.zoomTo("full",n)}zoomToMax(n){this.zoomTo("max",n)}toggleZoom(n){this.zoomTo(this.getNextScale("toggleZoom"),n)}toggleMax(n){this.zoomTo(this.getNextScale("toggleMax"),n)}toggleCover(n){this.zoomTo(this.getNextScale("toggleCover"),n)}iterateZoom(n){this.zoomTo("next",n)}zoomTo(n=1,{friction:r=$t,originX:s=$t,originY:c=$t,event:h}={}){if(this.isContentLoading||this.state===tt.Destroy)return;const{targetScale:p,fullScale:f,maxScale:y,coverScale:T}=this;if(this.stop(),this.panMode===zt&&(h=this.pmme||h),h||s===$t||c===$t){const d=this.content.getBoundingClientRect(),u=this.container.getBoundingClientRect(),m=h?h.clientX:u.left+.5*u.width,g=h?h.clientY:u.top+.5*u.height;s=m-d.left-.5*d.width,c=g-d.top-.5*d.height}let C=1;typeof n=="number"?C=n:n==="full"?C=f:n==="cover"?C=T:n==="max"?C=y:n==="fit"?C=1:n==="next"&&(C=this.getNextScale("iterateZoom")),C=C/p||1,r=r===$t?C>1?.15:.25:r,this.applyChange({scale:C,originX:s,originY:c,friction:r}),h&&this.panMode===zt&&this.panWithMouse(h,r)}rotateCCW(){this.applyChange({angle:-90})}rotateCW(){this.applyChange({angle:90})}flipX(){this.applyChange({flipX:!0})}flipY(){this.applyChange({flipY:!0})}fitX(){this.stop("target");const{containerRect:n,contentRect:r,target:s}=this;this.applyChange({panX:.5*n.width-(r.left+.5*r.fitWidth)-s.e,panY:.5*n.height-(r.top+.5*r.fitHeight)-s.f,scale:n.width/r.fitWidth/this.targetScale,originX:0,originY:0,ignoreBounds:!0})}fitY(){this.stop("target");const{containerRect:n,contentRect:r,target:s}=this;this.applyChange({panX:.5*n.width-(r.left+.5*r.fitWidth)-s.e,panY:.5*n.innerHeight-(r.top+.5*r.fitHeight)-s.f,scale:n.height/r.fitHeight/this.targetScale,originX:0,originY:0,ignoreBounds:!0})}toggleFS(){const{container:n}=this,r=this.cn("inFullscreen"),s=this.cn("htmlHasFullscreen");n.classList.toggle(r);const c=n.classList.contains(r);c?(document.documentElement.classList.add(s),document.addEventListener("keydown",this.onKeydown,!0)):(document.documentElement.classList.remove(s),document.removeEventListener("keydown",this.onKeydown,!0)),this.updateMetrics(),this.emit(c?"enterFS":"exitFS")}getMatrix(n=this.current){const{a:r,b:s,c,d:h,e:p,f}=n;return new DOMMatrix([r,s,c,h,p,f])}reset(n){if(this.state!==tt.Init&&this.state!==tt.Destroy){this.stop("current");for(const r of an)this.target[r]=yi[r];this.target.a=this.minScale,this.target.d=this.minScale,this.clampTargetBounds(),this.isResting||(this.friction=n===void 0?this.option("friction"):n,this.state=tt.Panning,this.requestTick())}}destroy(){this.stop(),this.state=tt.Destroy,this.detachEvents(),this.detachObserver();const{container:n,content:r}=this,s=this.option("classes")||{};for(const c of Object.values(s))n.classList.remove(c+"");r&&(r.removeEventListener("load",this.onLoad),r.removeEventListener("error",this.onError)),this.detachPlugins()}}Object.defineProperty(_n,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:Nl}),Object.defineProperty(_n,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:{}});const ya=function(k,n){let r=!0;return(...s)=>{r&&(r=!1,k(...s),setTimeout(()=>{r=!0},n))}},ba=(k,n)=>{let r=[];return k.childNodes.forEach(s=>{s.nodeType!==Node.ELEMENT_NODE||n&&!s.matches(n)||r.push(s)}),r},Bl={viewport:null,track:null,enabled:!0,slides:[],axis:"x",transition:"fade",preload:1,slidesPerPage:"auto",initialPage:0,friction:.12,Panzoom:{decelFriction:.12},center:!0,infinite:!0,fill:!0,dragFree:!1,adaptiveHeight:!1,direction:"ltr",classes:{container:"f-carousel",viewport:"f-carousel__viewport",track:"f-carousel__track",slide:"f-carousel__slide",isLTR:"is-ltr",isRTL:"is-rtl",isHorizontal:"is-horizontal",isVertical:"is-vertical",inTransition:"in-transition",isSelected:"is-selected"},l10n:{NEXT:"Next slide",PREV:"Previous slide",GOTO:"Go to slide #%d"}};var bt;(function(k){k[k.Init=0]="Init",k[k.Ready=1]="Ready",k[k.Destroy=2]="Destroy"})(bt||(bt={}));const or=k=>{if(typeof k=="string"||k instanceof HTMLElement)k={html:k};else{const n=k.thumb;n!==void 0&&(typeof n=="string"&&(k.thumbSrc=n),n instanceof HTMLImageElement&&(k.thumbEl=n,k.thumbElSrc=n.src,k.thumbSrc=n.src),delete k.thumb)}return Object.assign({html:"",el:null,isDom:!1,class:"",customClass:"",index:-1,dim:0,gap:0,pos:0,transition:!1},k)},zl=(k={})=>Object.assign({index:-1,slides:[],dim:0,pos:-1},k);class Zt extends Ni{constructor(n,r){super(r),Object.defineProperty(this,"instance",{enumerable:!0,configurable:!0,writable:!0,value:n})}attach(){}detach(){}}const $l={classes:{list:"f-carousel__dots",isDynamic:"is-dynamic",hasDots:"has-dots",dot:"f-carousel__dot",isBeforePrev:"is-before-prev",isPrev:"is-prev",isCurrent:"is-current",isNext:"is-next",isAfterNext:"is-after-next"},dotTpl:'<button type="button" data-carousel-page="%i" aria-label="{{GOTO}}"><span class="f-carousel__dot" aria-hidden="true"></span></button>',dynamicFrom:11,maxCount:1/0,minCount:2};class eo extends Zt{constructor(){super(...arguments),Object.defineProperty(this,"isDynamic",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"list",{enumerable:!0,configurable:!0,writable:!0,value:null})}onRefresh(){this.refresh()}build(){let n=this.list;if(!n){n=document.createElement("ul"),Ae(n,this.cn("list")),n.setAttribute("role","tablist");const r=this.instance.container;r.appendChild(n),Ae(r,this.cn("hasDots")),this.list=n}return n}refresh(){var n;const r=this.instance.pages.length,s=Math.min(2,this.option("minCount")),c=Math.max(2e3,this.option("maxCount")),h=this.option("dynamicFrom");if(r<s||r>c)return void this.cleanup();const p=typeof h=="number"&&r>5&&r>=h,f=!this.list||this.isDynamic!==p||this.list.children.length!==r;f&&this.cleanup();const y=this.build();if(tn(y,this.cn("isDynamic"),!!p),f)for(let d=0;d<r;d++)y.append(this.createItem(d));let T,C=0;for(const d of[...y.children]){const u=C===this.instance.page;u&&(T=d),tn(d,this.cn("isCurrent"),u),(n=d.children[0])===null||n===void 0||n.setAttribute("aria-selected",u?"true":"false");for(const m of["isBeforePrev","isPrev","isNext","isAfterNext"])Je(d,this.cn(m));C++}if(T=T||y.firstChild,p&&T){const d=T.previousElementSibling,u=d&&d.previousElementSibling;Ae(d,this.cn("isPrev")),Ae(u,this.cn("isBeforePrev"));const m=T.nextElementSibling,g=m&&m.nextElementSibling;Ae(m,this.cn("isNext")),Ae(g,this.cn("isAfterNext"))}this.isDynamic=p}createItem(n=0){var r;const s=document.createElement("li");s.setAttribute("role","presentation");const c=en(this.instance.localize(this.option("dotTpl"),[["%d",n+1]]).replace(/\%i/g,n+""));return s.appendChild(c),(r=s.children[0])===null||r===void 0||r.setAttribute("role","tab"),s}cleanup(){this.list&&(this.list.remove(),this.list=null),this.isDynamic=!1,Je(this.instance.container,this.cn("hasDots"))}attach(){this.instance.on(["refresh","change"],this.onRefresh)}detach(){this.instance.off(["refresh","change"],this.onRefresh),this.cleanup()}}Object.defineProperty(eo,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:$l});const wi="disabled",Ei="next",wa="prev";class to extends Zt{constructor(){super(...arguments),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"prev",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"next",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"isDom",{enumerable:!0,configurable:!0,writable:!0,value:!1})}onRefresh(){const n=this.instance,r=n.pages.length,s=n.page;if(r<2)return void this.cleanup();this.build();let c=this.prev,h=this.next;c&&h&&(c.removeAttribute(wi),h.removeAttribute(wi),n.isInfinite||(s<=0&&c.setAttribute(wi,""),s>=r-1&&h.setAttribute(wi,"")))}addBtn(n){var r;const s=this.instance,c=document.createElement("button");c.setAttribute("tabindex","0"),c.setAttribute("title",s.localize(`{{${n.toUpperCase()}}}`)),Ae(c,this.cn("button")+" "+this.cn(n===Ei?"isNext":"isPrev"));const h=s.isRTL?n===Ei?wa:Ei:n;var p;return c.innerHTML=s.localize(this.option(`${h}Tpl`)),c.dataset[`carousel${p=n,p?p.match("^[a-z]")?p.charAt(0).toUpperCase()+p.substring(1):p:""}`]="true",(r=this.container)===null||r===void 0||r.appendChild(c),c}build(){const n=this.instance.container,r=this.cn("container");let{container:s,prev:c,next:h}=this;s||(s=n.querySelector("."+r),this.isDom=!!s),s||(s=document.createElement("div"),Ae(s,r),n.appendChild(s)),this.container=s,h||(h=s.querySelector("[data-carousel-next]")),h||(h=this.addBtn(Ei)),this.next=h,c||(c=s.querySelector("[data-carousel-prev]")),c||(c=this.addBtn(wa)),this.prev=c}cleanup(){this.isDom||(this.prev&&this.prev.remove(),this.next&&this.next.remove(),this.container&&this.container.remove()),this.prev=null,this.next=null,this.container=null,this.isDom=!1}attach(){this.instance.on(["refresh","change"],this.onRefresh)}detach(){this.instance.off(["refresh","change"],this.onRefresh),this.cleanup()}}Object.defineProperty(to,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{classes:{container:"f-carousel__nav",button:"f-button",isNext:"is-next",isPrev:"is-prev"},nextTpl:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M9 3l9 9-9 9"/></svg>',prevTpl:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M15 3l-9 9 9 9"/></svg>'}});class no extends Zt{constructor(){super(...arguments),Object.defineProperty(this,"selectedIndex",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"target",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"nav",{enumerable:!0,configurable:!0,writable:!0,value:null})}addAsTargetFor(n){this.target=this.instance,this.nav=n,this.attachEvents()}addAsNavFor(n){this.nav=this.instance,this.target=n,this.attachEvents()}attachEvents(){const{nav:n,target:r}=this;n&&r&&(n.options.initialSlide=r.options.initialPage,n.state===bt.Ready?this.onNavReady(n):n.on("ready",this.onNavReady),r.state===bt.Ready?this.onTargetReady(r):r.on("ready",this.onTargetReady))}onNavReady(n){n.on("createSlide",this.onNavCreateSlide),n.on("Panzoom.click",this.onNavClick),n.on("Panzoom.touchEnd",this.onNavTouch),this.onTargetChange()}onTargetReady(n){n.on("change",this.onTargetChange),n.on("Panzoom.refresh",this.onTargetChange),this.onTargetChange()}onNavClick(n,r,s){this.onNavTouch(n,n.panzoom,s)}onNavTouch(n,r,s){var c,h;if(Math.abs(r.dragOffset.x)>3||Math.abs(r.dragOffset.y)>3)return;const p=s.target,{nav:f,target:y}=this;if(!f||!y||!p)return;const T=p.closest("[data-index]");if(s.stopPropagation(),s.preventDefault(),!T)return;const C=parseInt(T.dataset.index||"",10)||0,d=y.getPageForSlide(C),u=f.getPageForSlide(C);f.slideTo(u),y.slideTo(d,{friction:((h=(c=this.nav)===null||c===void 0?void 0:c.plugins)===null||h===void 0?void 0:h.Sync.option("friction"))||0}),this.markSelectedSlide(C)}onNavCreateSlide(n,r){r.index===this.selectedIndex&&this.markSelectedSlide(r.index)}onTargetChange(){var n,r;const{target:s,nav:c}=this;if(!s||!c||c.state!==bt.Ready||s.state!==bt.Ready)return;const h=(r=(n=s.pages[s.page])===null||n===void 0?void 0:n.slides[0])===null||r===void 0?void 0:r.index,p=c.getPageForSlide(h);this.markSelectedSlide(h),c.slideTo(p,c.prevPage===null&&s.prevPage===null?{friction:0}:void 0)}markSelectedSlide(n){const r=this.nav;r&&r.state===bt.Ready&&(this.selectedIndex=n,[...r.slides].map(s=>{s.el&&s.el.classList[s.index===n?"add":"remove"]("is-nav-selected")}))}attach(){const n=this;let r=n.options.target,s=n.options.nav;r?n.addAsNavFor(r):s&&n.addAsTargetFor(s)}detach(){const n=this,r=n.nav,s=n.target;r&&(r.off("ready",n.onNavReady),r.off("createSlide",n.onNavCreateSlide),r.off("Panzoom.click",n.onNavClick),r.off("Panzoom.touchEnd",n.onNavTouch)),n.nav=null,s&&(s.off("ready",n.onTargetReady),s.off("refresh",n.onTargetChange),s.off("change",n.onTargetChange)),n.target=null}}Object.defineProperty(no,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{friction:.35}});const Fl={Navigation:to,Dots:eo,Sync:no},Si="animationend",Ea="isSelected",Ci="slide";class Tn extends _r{get axis(){return this.isHorizontal?"e":"f"}get isEnabled(){return this.state===bt.Ready}get isInfinite(){let n=!1;const{contentDim:r,viewportDim:s,pages:c,slides:h}=this,p=h[0];return c.length>=2&&p&&r+p.dim>=s&&(n=this.option("infinite")),n}get isRTL(){return this.option("direction")==="rtl"}get isHorizontal(){return this.option("axis")==="x"}constructor(n,r={},s={}){if(super(),Object.defineProperty(this,"bp",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"lp",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"userOptions",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"userPlugins",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:bt.Init}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"prevPage",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"viewport",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"track",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"slides",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"pages",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"panzoom",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"inTransition",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"contentDim",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"viewportDim",{enumerable:!0,configurable:!0,writable:!0,value:0}),typeof n=="string"&&(n=document.querySelector(n)),!n||!It(n))throw new Error("No Element found");this.container=n,this.slideNext=ya(this.slideNext.bind(this),150),this.slidePrev=ya(this.slidePrev.bind(this),150),this.userOptions=r,this.userPlugins=s,queueMicrotask(()=>{this.processOptions()})}processOptions(){var n,r;const s=Nt({},Tn.defaults,this.userOptions);let c="";const h=s.breakpoints;if(h&&Er(h))for(const[p,f]of Object.entries(h))window.matchMedia(p).matches&&Er(f)&&(c+=p,Nt(s,f));c===this.bp&&this.state!==bt.Init||(this.bp=c,this.state===bt.Ready&&(s.initialSlide=((r=(n=this.pages[this.page])===null||n===void 0?void 0:n.slides[0])===null||r===void 0?void 0:r.index)||0),this.state!==bt.Init&&this.destroy(),super.setOptions(s),this.option("enabled")===!1?this.attachEvents():setTimeout(()=>{this.init()},0))}init(){this.state=bt.Init,this.emit("init"),this.attachPlugins(Object.assign(Object.assign({},Tn.Plugins),this.userPlugins)),this.emit("attachPlugins"),this.initLayout(),this.initSlides(),this.updateMetrics(),this.setInitialPosition(),this.initPanzoom(),this.attachEvents(),this.state=bt.Ready,this.emit("ready")}initLayout(){const{container:n}=this,r=this.option("classes");Ae(n,this.cn("container")),tn(n,r.isLTR,!this.isRTL),tn(n,r.isRTL,this.isRTL),tn(n,r.isVertical,!this.isHorizontal),tn(n,r.isHorizontal,this.isHorizontal);let s=this.option("viewport")||n.querySelector(`.${r.viewport}`);s||(s=document.createElement("div"),Ae(s,r.viewport),s.append(...ba(n,`.${r.slide}`)),n.prepend(s)),s.addEventListener("scroll",this.onScroll);let c=this.option("track")||n.querySelector(`.${r.track}`);c||(c=document.createElement("div"),Ae(c,r.track),c.append(...Array.from(s.childNodes))),c.setAttribute("aria-live","polite"),s.contains(c)||s.prepend(c),this.viewport=s,this.track=c,this.emit("initLayout")}initSlides(){const{track:n}=this;if(!n)return;const r=[...this.slides],s=[];[...ba(n,`.${this.cn(Ci)}`)].forEach(c=>{if(It(c)){const h=or({el:c,isDom:!0,index:this.slides.length});s.push(h)}});for(let c of[...this.option("slides",[])||[],...r])s.push(or(c));this.slides=s;for(let c=0;c<this.slides.length;c++)this.slides[c].index=c;for(const c of s)this.emit("beforeInitSlide",c,c.index),this.emit("initSlide",c,c.index);this.emit("initSlides")}setInitialPage(){const n=this.option("initialSlide");this.page=typeof n=="number"?this.getPageForSlide(n):parseInt(this.option("initialPage",0)+"",10)||0}setInitialPosition(){const{track:n,pages:r,isHorizontal:s}=this;if(!n||!r.length)return;let c=this.page;r[c]||(this.page=c=0);const h=(r[c].pos||0)*(this.isRTL&&s?1:-1),p=s?`${h}px`:"0",f=s?"0":`${h}px`;n.style.transform=`translate3d(${p}, ${f}, 0) scale(1)`,this.option("adaptiveHeight")&&this.setViewportHeight()}initPanzoom(){this.panzoom&&(this.panzoom.destroy(),this.panzoom=null);const n=this.option("Panzoom")||{};this.panzoom=new _n(this.viewport,Nt({},{content:this.track,zoom:!1,panOnlyZoomed:!1,lockAxis:this.isHorizontal?"x":"y",infinite:this.isInfinite,click:!1,dblClick:!1,touch:r=>!(this.pages.length<2&&!r.options.infinite),bounds:()=>this.getBounds(),maxVelocity:r=>Math.abs(r.target[this.axis]-r.current[this.axis])<2*this.viewportDim?100:0},n)),this.panzoom.on("*",(r,s,...c)=>{this.emit(`Panzoom.${s}`,r,...c)}),this.panzoom.on("decel",this.onDecel),this.panzoom.on("refresh",this.onRefresh),this.panzoom.on("beforeTransform",this.onBeforeTransform),this.panzoom.on("endAnimation",this.onEndAnimation)}attachEvents(){const n=this.container;n&&(n.addEventListener("click",this.onClick,{passive:!1,capture:!1}),n.addEventListener("slideTo",this.onSlideTo)),window.addEventListener("resize",this.onResize)}createPages(){let n=[];const{contentDim:r,viewportDim:s}=this;let c=this.option("slidesPerPage");c=(c==="auto"||r<=s)&&this.option("fill")!==!1?1/0:parseFloat(c+"");let h=0,p=0,f=0;for(const y of this.slides)(!n.length||p+y.dim-s>.05||f>=c)&&(n.push(zl()),h=n.length-1,p=0,f=0),n[h].slides.push(y),p+=y.dim+y.gap,f++;return n}processPages(){const n=this.pages,{contentDim:r,viewportDim:s,isInfinite:c}=this,h=this.option("center"),p=this.option("fill"),f=p&&h&&r>s&&!c;if(n.forEach((C,d)=>{var u;C.index=d,C.pos=((u=C.slides[0])===null||u===void 0?void 0:u.pos)||0,C.dim=0;for(const[m,g]of C.slides.entries())C.dim+=g.dim,m<C.slides.length-1&&(C.dim+=g.gap);f&&C.pos+.5*C.dim<.5*s?C.pos=0:f&&C.pos+.5*C.dim>=r-.5*s?C.pos=r-s:h&&(C.pos+=-.5*(s-C.dim))}),n.forEach(C=>{p&&!c&&r>s&&(C.pos=Math.max(C.pos,0),C.pos=Math.min(C.pos,r-s)),C.pos=me(C.pos,1e3),C.dim=me(C.dim,1e3),Math.abs(C.pos)<=.1&&(C.pos=0)}),c)return n;const y=[];let T;return n.forEach(C=>{const d=Object.assign({},C);T&&d.pos===T.pos?(T.dim+=d.dim,T.slides=[...T.slides,...d.slides]):(d.index=y.length,T=d,y.push(d))}),y}getPageFromIndex(n=0){const r=this.pages.length;let s;return n=parseInt((n||0).toString())||0,s=this.isInfinite?(n%r+r)%r:Math.max(Math.min(n,r-1),0),s}getSlideMetrics(n){var r,s;const c=this.isHorizontal?"width":"height";let h=0,p=0,f=n.el;const y=!(!f||f.parentNode);if(f?h=parseFloat(f.dataset[c]||"")||0:(f=document.createElement("div"),f.style.visibility="hidden",(this.track||document.body).prepend(f)),Ae(f,this.cn(Ci)+" "+n.class+" "+n.customClass),h)f.style[c]=`${h}px`,f.style[c==="width"?"height":"width"]="";else{y&&(this.track||document.body).prepend(f),h=f.getBoundingClientRect()[c]*Math.max(1,((r=window.visualViewport)===null||r===void 0?void 0:r.scale)||1);let C=f[this.isHorizontal?"offsetWidth":"offsetHeight"];C-1>h&&(h=C)}const T=getComputedStyle(f);return T.boxSizing==="content-box"&&(this.isHorizontal?(h+=parseFloat(T.paddingLeft)||0,h+=parseFloat(T.paddingRight)||0):(h+=parseFloat(T.paddingTop)||0,h+=parseFloat(T.paddingBottom)||0)),p=parseFloat(T[this.isHorizontal?"marginRight":"marginBottom"])||0,y?(s=f.parentElement)===null||s===void 0||s.removeChild(f):n.el||f.remove(),{dim:me(h,1e3),gap:me(p,1e3)}}getBounds(){const{isInfinite:n,isRTL:r,isHorizontal:s,pages:c}=this;let h={min:0,max:0};if(n)h={min:-1/0,max:1/0};else if(c.length){const p=c[0].pos,f=c[c.length-1].pos;h=r&&s?{min:p,max:f}:{min:-1*f,max:-1*p}}return{x:s?h:{min:0,max:0},y:s?{min:0,max:0}:h}}repositionSlides(){let n,{isHorizontal:r,isRTL:s,isInfinite:c,viewport:h,viewportDim:p,contentDim:f,page:y,pages:T,slides:C,panzoom:d}=this,u=0,m=0,g=0,w=0;d?w=-1*d.current[this.axis]:T[y]&&(w=T[y].pos||0),n=r?s?"right":"left":"top",s&&r&&(w*=-1);for(const M of C){const x=M.el;x?(n==="top"?(x.style.right="",x.style.left=""):x.style.top="",M.index!==u?x.style[n]=m===0?"":`${me(m,1e3)}px`:x.style[n]="",g+=M.dim+M.gap,u++):m+=M.dim+M.gap}if(c&&g&&h){let M=getComputedStyle(h),x="padding",v=r?"Right":"Bottom",O=parseFloat(M[x+(r?"Left":"Top")]);w-=O,p+=O,p+=parseFloat(M[x+v]);for(const H of C)H.el&&(me(H.pos)<me(p)&&me(H.pos+H.dim+H.gap)<me(w)&&me(w)>me(f-p)&&(H.el.style[n]=`${me(m+g,1e3)}px`),me(H.pos+H.gap)>=me(f-p)&&me(H.pos)>me(w+p)&&me(w)<me(p)&&(H.el.style[n]=`-${me(g,1e3)}px`))}let b,S,_=[...this.inTransition];if(_.length>1&&(b=T[_[0]],S=T[_[1]]),b&&S){let M=0;for(const x of C)x.el?this.inTransition.has(x.index)&&b.slides.indexOf(x)<0&&(x.el.style[n]=`${me(M+(b.pos-S.pos),1e3)}px`):M+=x.dim+x.gap}}createSlideEl(n){const{track:r,slides:s}=this;if(!r||!n||n.el&&n.el.parentNode)return;const c=n.el||document.createElement("div");Ae(c,this.cn(Ci)),Ae(c,n.class),Ae(c,n.customClass);const h=n.html;h&&(h instanceof HTMLElement?c.appendChild(h):c.innerHTML=n.html+"");const p=[];s.forEach((C,d)=>{C.el&&p.push(d)});const f=n.index;let y=null;p.length&&(y=s[p.reduce((C,d)=>Math.abs(d-f)<Math.abs(C-f)?d:C)]);const T=y&&y.el&&y.el.parentNode?y.index<n.index?y.el.nextSibling:y.el:null;r.insertBefore(c,r.contains(T)?T:null),n.el=c,this.emit("createSlide",n)}removeSlideEl(n,r=!1){const s=n==null?void 0:n.el;if(!s||!s.parentNode)return;const c=this.cn(Ea);if(s.classList.contains(c)&&(Je(s,c),this.emit("unselectSlide",n)),n.isDom&&!r)return s.removeAttribute("aria-hidden"),s.removeAttribute("data-index"),void(s.style.left="");this.emit("removeSlide",n);const h=new CustomEvent(Si);s.dispatchEvent(h),n.el&&(n.el.remove(),n.el=null)}transitionTo(n=0,r=this.option("transition")){var s,c,h,p;if(!r)return!1;const f=this.page,{pages:y,panzoom:T}=this;n=parseInt((n||0).toString())||0;const C=this.getPageFromIndex(n);if(!T||!y[C]||y.length<2||Math.abs((((c=(s=y[f])===null||s===void 0?void 0:s.slides[0])===null||c===void 0?void 0:c.dim)||0)-this.viewportDim)>1)return!1;let d=n>f?1:-1;this.isInfinite&&(f===0&&n===y.length-1&&(d=-1),f===y.length-1&&n===0&&(d=1));const u=y[C].pos*(this.isRTL?1:-1);if(f===C&&Math.abs(u-T.target[this.axis])<1)return!1;this.clearTransitions();const m=T.isResting;Ae(this.container,this.cn("inTransition"));const g=((h=y[f])===null||h===void 0?void 0:h.slides[0])||null,w=((p=y[C])===null||p===void 0?void 0:p.slides[0])||null;this.inTransition.add(w.index),this.createSlideEl(w);let b=g.el,S=w.el;m||r===Ci||(r="fadeFast",b=null);const _=this.isRTL?"next":"prev",M=this.isRTL?"prev":"next";return b&&(this.inTransition.add(g.index),g.transition=r,b.addEventListener(Si,this.onAnimationEnd),b.classList.add(`f-${r}Out`,`to-${d>0?M:_}`)),S&&(w.transition=r,S.addEventListener(Si,this.onAnimationEnd),S.classList.add(`f-${r}In`,`from-${d>0?_:M}`)),T.current[this.axis]=u,T.target[this.axis]=u,T.requestTick(),this.onChange(C),!0}manageSlideVisiblity(){const n=new Set,r=new Set,s=this.getVisibleSlides(parseFloat(this.option("preload",0)+"")||0);for(const c of this.slides)s.has(c)?n.add(c):r.add(c);for(const c of this.inTransition)n.add(this.slides[c]);for(const c of n)this.createSlideEl(c),this.lazyLoadSlide(c);for(const c of r)n.has(c)||this.removeSlideEl(c);this.markSelectedSlides(),this.repositionSlides()}markSelectedSlides(){if(!this.pages[this.page]||!this.pages[this.page].slides)return;const n="aria-hidden";let r=this.cn(Ea);if(r)for(const s of this.slides){const c=s.el;c&&(c.dataset.index=`${s.index}`,c.classList.contains("f-thumbs__slide")?this.getVisibleSlides(0).has(s)?c.removeAttribute(n):c.setAttribute(n,"true"):this.pages[this.page].slides.includes(s)?(c.classList.contains(r)||(Ae(c,r),this.emit("selectSlide",s)),c.removeAttribute(n)):(c.classList.contains(r)&&(Je(c,r),this.emit("unselectSlide",s)),c.setAttribute(n,"true")))}}flipInfiniteTrack(){const{axis:n,isHorizontal:r,isInfinite:s,isRTL:c,viewportDim:h,contentDim:p}=this,f=this.panzoom;if(!f||!s)return;let y=f.current[n],T=f.target[n]-y,C=0,d=.5*h;c&&r?(y<-d&&(C=-1,y+=p),y>p-d&&(C=1,y-=p)):(y>d&&(C=1,y-=p),y<-p+d&&(C=-1,y+=p)),C&&(f.current[n]=y,f.target[n]=y+T)}lazyLoadImg(n,r){const s=this,c="f-fadeIn",h="is-preloading";let p=!1,f=null;const y=()=>{p||(p=!0,f&&(f.remove(),f=null),Je(r,h),r.complete&&(Ae(r,c),setTimeout(()=>{Je(r,c)},350)),this.option("adaptiveHeight")&&n.el&&this.pages[this.page].slides.indexOf(n)>-1&&(s.updateMetrics(),s.setViewportHeight()),this.emit("load",n))};Ae(r,h),r.src=r.dataset.lazySrcset||r.dataset.lazySrc||"",delete r.dataset.lazySrc,delete r.dataset.lazySrcset,r.addEventListener("error",()=>{y()}),r.addEventListener("load",()=>{y()}),setTimeout(()=>{const T=r.parentNode;T&&n.el&&(r.complete?y():p||(f=en(Mr),T.insertBefore(f,r)))},300)}lazyLoadSlide(n){const r=n&&n.el;if(!r)return;const s=new Set;let c=Array.from(r.querySelectorAll("[data-lazy-src],[data-lazy-srcset]"));r.dataset.lazySrc&&c.push(r),c.map(h=>{h instanceof HTMLImageElement?s.add(h):h instanceof HTMLElement&&h.dataset.lazySrc&&(h.style.backgroundImage=`url('${h.dataset.lazySrc}')`,delete h.dataset.lazySrc)});for(const h of s)this.lazyLoadImg(n,h)}onAnimationEnd(n){var r;const s=n.target,c=s?parseInt(s.dataset.index||"",10)||0:-1,h=this.slides[c],p=n.animationName;if(!s||!h||!p)return;const f=!!this.inTransition.has(c)&&h.transition;f&&p.substring(0,f.length+2)===`f-${f}`&&this.inTransition.delete(c),this.inTransition.size||this.clearTransitions(),c===this.page&&(!((r=this.panzoom)===null||r===void 0)&&r.isResting)&&this.emit("settle")}onDecel(n,r=0,s=0,c=0,h=0){if(this.option("dragFree"))return void this.setPageFromPosition();const{isRTL:p,isHorizontal:f,axis:y,pages:T}=this,C=T.length,d=Math.abs(Math.atan2(s,r)/(Math.PI/180));let u=0;if(u=d>45&&d<135?f?0:s:f?r:0,!C)return;let m=this.page,g=p&&f?1:-1;const w=n.current[y]*g;let{pageIndex:b}=this.getPageFromPosition(w);Math.abs(u)>5?(T[m].dim<document.documentElement["client"+(this.isHorizontal?"Width":"Height")]-1&&(m=b),m=p&&f?u<0?m-1:m+1:u<0?m+1:m-1):m=c===0&&h===0?m:b,this.slideTo(m,{transition:!1,friction:n.option("decelFriction")})}onClick(n){const r=n.target,s=r&&It(r)?r.dataset:null;let c,h;s&&(s.carouselPage!==void 0?(h="slideTo",c=s.carouselPage):s.carouselNext!==void 0?h="slideNext":s.carouselPrev!==void 0&&(h="slidePrev")),h?(n.preventDefault(),n.stopPropagation(),r&&!r.hasAttribute("disabled")&&this[h](c)):this.emit("click",n)}onSlideTo(n){const r=n.detail||0;this.slideTo(this.getPageForSlide(r),{friction:0})}onChange(n,r=0){const s=this.page;this.prevPage=s,this.page=n,this.option("adaptiveHeight")&&this.setViewportHeight(),n!==s&&(this.markSelectedSlides(),this.emit("change",n,s,r))}onRefresh(){let n=this.contentDim,r=this.viewportDim;this.updateMetrics(),this.contentDim===n&&this.viewportDim===r||this.slideTo(this.page,{friction:0,transition:!1})}onScroll(){var n;(n=this.viewport)===null||n===void 0||n.scroll(0,0)}onResize(){this.option("breakpoints")&&this.processOptions()}onBeforeTransform(n){this.lp!==n.current[this.axis]&&(this.flipInfiniteTrack(),this.manageSlideVisiblity()),this.lp=n.current.e}onEndAnimation(){this.inTransition.size||this.emit("settle")}reInit(n=null,r=null){this.destroy(),this.state=bt.Init,this.prevPage=null,this.userOptions=n||this.userOptions,this.userPlugins=r||this.userPlugins,this.processOptions()}slideTo(n=0,{friction:r=this.option("friction"),transition:s=this.option("transition")}={}){if(this.state===bt.Destroy)return;n=parseInt((n||0).toString())||0;const c=this.getPageFromIndex(n),{axis:h,isHorizontal:p,isRTL:f,pages:y,panzoom:T}=this,C=y.length,d=f&&p?1:-1;if(!T||!C)return;if(this.page!==c){const m=new Event("beforeChange",{bubbles:!0,cancelable:!0});if(this.emit("beforeChange",m,n),m.defaultPrevented)return}if(this.transitionTo(n,s))return;let u=y[c].pos;if(this.isInfinite){const m=this.contentDim,g=T.target[h]*d;C===2?u+=m*Math.floor(parseFloat(n+"")/2):u=[u,u-m,u+m].reduce(function(w,b){return Math.abs(b-g)<Math.abs(w-g)?b:w})}u*=d,Math.abs(T.target[h]-u)<1||(T.panTo({x:p?u:0,y:p?0:u,friction:r}),this.onChange(c))}slideToClosest(n){if(this.panzoom){const{pageIndex:r}=this.getPageFromPosition();this.slideTo(r,n)}}slideNext(){this.slideTo(this.page+1)}slidePrev(){this.slideTo(this.page-1)}clearTransitions(){this.inTransition.clear(),Je(this.container,this.cn("inTransition"));const n=["to-prev","to-next","from-prev","from-next"];for(const r of this.slides){const s=r.el;if(s){s.removeEventListener(Si,this.onAnimationEnd),s.classList.remove(...n);const c=r.transition;c&&s.classList.remove(`f-${c}Out`,`f-${c}In`)}}this.manageSlideVisiblity()}addSlide(n,r){var s,c,h,p;const f=this.panzoom,y=((s=this.pages[this.page])===null||s===void 0?void 0:s.pos)||0,T=((c=this.pages[this.page])===null||c===void 0?void 0:c.dim)||0,C=this.contentDim<this.viewportDim;let d=Array.isArray(r)?r:[r];const u=[];for(const m of d)u.push(or(m));this.slides.splice(n,0,...u);for(let m=0;m<this.slides.length;m++)this.slides[m].index=m;for(const m of u)this.emit("beforeInitSlide",m,m.index);if(this.page>=n&&(this.page+=u.length),this.updateMetrics(),f){const m=((h=this.pages[this.page])===null||h===void 0?void 0:h.pos)||0,g=((p=this.pages[this.page])===null||p===void 0?void 0:p.dim)||0,w=this.pages.length||1,b=this.isRTL?T-g:g-T,S=this.isRTL?y-m:m-y;C&&w===1?(n<=this.page&&(f.current[this.axis]-=b,f.target[this.axis]-=b),f.panTo({[this.isHorizontal?"x":"y"]:-1*m})):S&&n<=this.page&&(f.target[this.axis]-=S,f.current[this.axis]-=S,f.requestTick())}for(const m of u)this.emit("initSlide",m,m.index)}prependSlide(n){this.addSlide(0,n)}appendSlide(n){this.addSlide(this.slides.length,n)}removeSlide(n){const r=this.slides.length;n=(n%r+r)%r;const s=this.slides[n];if(s){this.removeSlideEl(s,!0),this.slides.splice(n,1);for(let c=0;c<this.slides.length;c++)this.slides[c].index=c;this.updateMetrics(),this.slideTo(this.page,{friction:0,transition:!1}),this.emit("destroySlide",s)}}updateMetrics(){const{panzoom:n,viewport:r,track:s,slides:c,isHorizontal:h,isInfinite:p}=this;if(!s)return;const f=h?"width":"height",y=h?"offsetWidth":"offsetHeight";if(r){let d=Math.max(r[y],me(r.getBoundingClientRect()[f],1e3)),u=getComputedStyle(r),m="padding",g=h?"Right":"Bottom";d-=parseFloat(u[m+(h?"Left":"Top")])+parseFloat(u[m+g]),this.viewportDim=d}let T,C=0;for(const[d,u]of c.entries()){let m=0,g=0;!u.el&&T?(m=T.dim,g=T.gap):({dim:m,gap:g}=this.getSlideMetrics(u),T=u),m=me(m,1e3),g=me(g,1e3),u.dim=m,u.gap=g,u.pos=C,C+=m,(p||d<c.length-1)&&(C+=g)}C=me(C,1e3),this.contentDim=C,n&&(n.contentRect[f]=C,n.contentRect[h?"fullWidth":"fullHeight"]=C),this.pages=this.createPages(),this.pages=this.processPages(),this.state===bt.Init&&this.setInitialPage(),this.page=Math.max(0,Math.min(this.page,this.pages.length-1)),this.manageSlideVisiblity(),this.emit("refresh")}getProgress(n,r=!1,s=!1){n===void 0&&(n=this.page);const c=this,h=c.panzoom,p=c.contentDim,f=c.pages[n]||0;if(!f||!h)return n>this.page?-1:1;let y=-1*h.current.e,T=me((y-f.pos)/(1*f.dim),1e3),C=T,d=T;this.isInfinite&&s!==!0&&(C=me((y-f.pos+p)/(1*f.dim),1e3),d=me((y-f.pos-p)/(1*f.dim),1e3));let u=[T,C,d].reduce(function(m,g){return Math.abs(g)<Math.abs(m)?g:m});return r?u:u>1?1:u<-1?-1:u}setViewportHeight(){const{page:n,pages:r,viewport:s,isHorizontal:c}=this;if(!s||!r[n])return;let h=0;c&&this.track&&(this.track.style.height="auto",r[n].slides.forEach(p=>{p.el&&(h=Math.max(h,p.el.offsetHeight))})),s.style.height=h?`${h}px`:""}getPageForSlide(n){for(const r of this.pages)for(const s of r.slides)if(s.index===n)return r.index;return-1}getVisibleSlides(n=0){var r;const s=new Set;let{panzoom:c,contentDim:h,viewportDim:p,pages:f,page:y}=this;if(p){h=h+((r=this.slides[this.slides.length-1])===null||r===void 0?void 0:r.gap)||0;let T=0;T=c&&c.state!==tt.Init&&c.state!==tt.Destroy?-1*c.current[this.axis]:f[y]&&f[y].pos||0,this.isInfinite&&(T-=Math.floor(T/h)*h),this.isRTL&&this.isHorizontal&&(T*=-1);const C=T-p*n,d=T+p*(n+1),u=this.isInfinite?[-1,0,1]:[0];for(const m of this.slides)for(const g of u){const w=m.pos+g*h,b=w+m.dim+m.gap;w<d&&b>C&&s.add(m)}}return s}getPageFromPosition(n){const{viewportDim:r,contentDim:s,slides:c,pages:h,panzoom:p}=this,f=h.length,y=c.length,T=c[0],C=c[y-1],d=this.option("center");let u=0,m=0,g=0,w=n===void 0?-1*((p==null?void 0:p.target[this.axis])||0):n;d&&(w+=.5*r),this.isInfinite?(w<T.pos-.5*C.gap&&(w-=s,g=-1),w>C.pos+C.dim+.5*C.gap&&(w-=s,g=1)):w=Math.max(T.pos||0,Math.min(w,C.pos));let b=C,S=c.find(_=>{const M=_.pos-.5*b.gap,x=_.pos+_.dim+.5*_.gap;return b=_,w>=M&&w<x});return S||(S=C),m=this.getPageForSlide(S.index),u=m+g*f,{page:u,pageIndex:m}}setPageFromPosition(){const{pageIndex:n}=this.getPageFromPosition();this.onChange(n)}destroy(){if([bt.Destroy].includes(this.state))return;this.state=bt.Destroy;const{container:n,viewport:r,track:s,slides:c,panzoom:h}=this,p=this.option("classes");n.removeEventListener("click",this.onClick,{passive:!1,capture:!1}),n.removeEventListener("slideTo",this.onSlideTo),window.removeEventListener("resize",this.onResize),h&&(h.destroy(),this.panzoom=null),c&&c.forEach(y=>{this.removeSlideEl(y)}),this.detachPlugins(),r&&(r.removeEventListener("scroll",this.onScroll),r.offsetParent&&s&&s.offsetParent&&r.replaceWith(...s.childNodes));for(const[y,T]of Object.entries(p))y!=="container"&&T&&n.classList.remove(T);this.track=null,this.viewport=null,this.page=0,this.slides=[];const f=this.events.get("ready");this.events=new Map,f&&this.events.set("ready",f)}}Object.defineProperty(Tn,"Panzoom",{enumerable:!0,configurable:!0,writable:!0,value:_n}),Object.defineProperty(Tn,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:Bl}),Object.defineProperty(Tn,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:Fl});const io=function(k){if(!It(k))return 0;const n=window.scrollY,r=window.innerHeight,s=n+r,c=k.getBoundingClientRect(),h=c.y+n,p=c.height,f=h+p;if(n>f||s<h)return 0;if(n<h&&s>f||h<n&&f>s)return 100;let y=p;h<n&&(y-=n-h),f>s&&(y-=f-s);const T=y/r*100;return Math.round(T)},ti=!(typeof window>"u"||!window.document||!window.document.createElement);let sr;const lr=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden]):not(.fancybox-focus-guard)","iframe","object","embed","video","audio","[contenteditable]",'[tabindex]:not([tabindex^="-"]):not([disabled]):not([aria-hidden])'].join(","),Sa=k=>{if(k&&ti){sr===void 0&&document.createElement("div").focus({get preventScroll(){return sr=!0,!1}});try{if(sr)k.focus({preventScroll:!0});else{const n=window.scrollY||document.body.scrollTop,r=window.scrollX||document.body.scrollLeft;k.focus(),document.body.scrollTo({top:n,left:r,behavior:"auto"})}}catch{}}},ro=()=>{const k=document;let n,r="",s="",c="";return k.fullscreenEnabled?(r="requestFullscreen",s="exitFullscreen",c="fullscreenElement"):k.webkitFullscreenEnabled&&(r="webkitRequestFullscreen",s="webkitExitFullscreen",c="webkitFullscreenElement"),r&&(n={request:function(h=k.documentElement){return r==="webkitRequestFullscreen"?h[r](Element.ALLOW_KEYBOARD_INPUT):h[r]()},exit:function(){return k[c]&&k[s]()},isFullscreen:function(){return k[c]}}),n},Sr={animated:!0,autoFocus:!0,backdropClick:"close",Carousel:{classes:{container:"fancybox__carousel",viewport:"fancybox__viewport",track:"fancybox__track",slide:"fancybox__slide"}},closeButton:"auto",closeExisting:!1,commonCaption:!1,compact:()=>window.matchMedia("(max-width: 578px), (max-height: 578px)").matches,contentClick:"toggleZoom",contentDblClick:!1,defaultType:"image",defaultDisplay:"flex",dragToClose:!0,Fullscreen:{autoStart:!1},groupAll:!1,groupAttr:"data-fancybox",hideClass:"f-fadeOut",hideScrollbar:!0,idle:3500,keyboard:{Escape:"close",Delete:"close",Backspace:"close",PageUp:"next",PageDown:"prev",ArrowUp:"prev",ArrowDown:"next",ArrowRight:"next",ArrowLeft:"prev"},l10n:Object.assign(Object.assign({},Qa),{CLOSE:"Close",NEXT:"Next",PREV:"Previous",MODAL:"You can close this modal content with the ESC key",ERROR:"Something Went Wrong, Please Try Again Later",IMAGE_ERROR:"Image Not Found",ELEMENT_NOT_FOUND:"HTML Element Not Found",AJAX_NOT_FOUND:"Error Loading AJAX : Not Found",AJAX_FORBIDDEN:"Error Loading AJAX : Forbidden",IFRAME_ERROR:"Error Loading Page",TOGGLE_ZOOM:"Toggle zoom level",TOGGLE_THUMBS:"Toggle thumbnails",TOGGLE_SLIDESHOW:"Toggle slideshow",TOGGLE_FULLSCREEN:"Toggle full-screen mode",DOWNLOAD:"Download"}),parentEl:null,placeFocusBack:!0,showClass:"f-zoomInUp",startIndex:0,tpl:{closeButton:'<button data-fancybox-close class="f-button is-close-btn" title="{{CLOSE}}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M20 20L4 4m16 0L4 20"/></svg></button>',main:`<div class="fancybox__container" role="dialog" aria-modal="true" aria-label="{{MODAL}}" tabindex="-1">
    <div class="fancybox__backdrop"></div>
    <div class="fancybox__carousel"></div>
    <div class="fancybox__footer"></div>
  </div>`},trapFocus:!0,wheel:"zoom"};var kt,At;(function(k){k[k.Init=0]="Init",k[k.Ready=1]="Ready",k[k.Closing=2]="Closing",k[k.CustomClosing=3]="CustomClosing",k[k.Destroy=4]="Destroy"})(kt||(kt={})),function(k){k[k.Loading=0]="Loading",k[k.Opening=1]="Opening",k[k.Ready=2]="Ready",k[k.Closing=3]="Closing"}(At||(At={}));let Ca="",Qn=!1,ki=!1,Sn=null;const ao=()=>{let k="",n="";const r=Xe.getInstance();if(r){const s=r.carousel,c=r.getSlide();if(s&&c){let h=c.slug||void 0,p=c.triggerEl||void 0;n=h||r.option("slug")||"",!n&&p&&p.dataset&&(n=p.dataset.fancybox||""),n&&n!=="true"&&(k="#"+n+(!h&&s.slides.length>1?"-"+(c.index+1):""))}}return{hash:k,slug:n,index:1}},ji=()=>{const k=new URL(document.URL).hash,n=k.slice(1).split("-"),r=n[n.length-1],s=r&&/^\+?\d+$/.test(r)&&parseInt(n.pop()||"1",10)||1;return{hash:k,slug:n.join("-"),index:s}},oo=()=>{const{slug:k,index:n}=ji();if(!k)return;let r=document.querySelector(`[data-slug="${k}"]`);if(r&&r.dispatchEvent(new CustomEvent("click",{bubbles:!0,cancelable:!0})),Xe.getInstance())return;const s=document.querySelectorAll(`[data-fancybox="${k}"]`);s.length&&(r=s[n-1],r&&r.dispatchEvent(new CustomEvent("click",{bubbles:!0,cancelable:!0})))},so=()=>{if(Xe.defaults.Hash===!1)return;const k=Xe.getInstance();if((k==null?void 0:k.options.Hash)===!1)return;const{slug:n,index:r}=ji(),{slug:s}=ao();k&&(n===s?k.jumpTo(r-1):(Qn=!0,k.close())),oo()},lo=()=>{Sn&&clearTimeout(Sn),queueMicrotask(()=>{so()})},ka=()=>{window.addEventListener("hashchange",lo,!1),setTimeout(()=>{so()},500)};ti&&(/complete|interactive|loaded/.test(document.readyState)?ka():document.addEventListener("DOMContentLoaded",ka));const Ti="is-zooming-in";class co extends Zt{onCreateSlide(n,r,s){const c=this.instance.optionFor(s,"src")||"";s.el&&s.type==="image"&&typeof c=="string"&&this.setImage(s,c)}onRemoveSlide(n,r,s){s.panzoom&&s.panzoom.destroy(),s.panzoom=void 0,s.imageEl=void 0}onChange(n,r,s,c){Je(this.instance.container,Ti);for(const h of r.slides){const p=h.panzoom;p&&h.index!==s&&p.reset(.35)}}onClose(){var n;const r=this.instance,s=r.container,c=r.getSlide();if(!s||!s.parentElement||!c)return;const{el:h,contentEl:p,panzoom:f,thumbElSrc:y}=c;if(!h||!y||!p||!f||f.isContentLoading||f.state===tt.Init||f.state===tt.Destroy)return;f.updateMetrics();let T=this.getZoomInfo(c);if(!T)return;this.instance.state=kt.CustomClosing,s.classList.remove(Ti),s.classList.add("is-zooming-out"),p.style.backgroundImage=`url('${y}')`;const C=s.getBoundingClientRect();(((n=window.visualViewport)===null||n===void 0?void 0:n.scale)||1)===1&&Object.assign(s.style,{position:"absolute",top:`${s.offsetTop+window.scrollY}px`,left:`${s.offsetLeft+window.scrollX}px`,bottom:"auto",right:"auto",width:`${C.width}px`,height:`${C.height}px`,overflow:"hidden"});const{x:d,y:u,scale:m,opacity:g}=T;if(g){const w=((b,S,_,M)=>{const x=S-b,v=M-_;return O=>_+((O-b)/x*v||0)})(f.scale,m,1,0);f.on("afterTransform",()=>{p.style.opacity=w(f.scale)+""})}f.on("endAnimation",()=>{r.destroy()}),f.target.a=m,f.target.b=0,f.target.c=0,f.target.d=m,f.panTo({x:d,y:u,scale:m,friction:g?.2:.33,ignoreBounds:!0}),f.isResting&&r.destroy()}setImage(n,r){const s=this.instance;n.src=r,this.process(n,r).then(c=>{const{contentEl:h,imageEl:p,thumbElSrc:f,el:y}=n;if(s.isClosing()||!h||!p)return;h.offsetHeight;const T=!!s.isOpeningSlide(n)&&this.getZoomInfo(n);if(this.option("protected")&&y){y.addEventListener("contextmenu",u=>{u.preventDefault()});const d=document.createElement("div");Ae(d,"fancybox-protected"),h.appendChild(d)}if(f&&T){const d=c.contentRect,u=Math.max(d.fullWidth,d.fullHeight);let m=null;!T.opacity&&u>1200&&(m=document.createElement("img"),Ae(m,"fancybox-ghost"),m.src=f,h.appendChild(m));const g=()=>{m&&(Ae(m,"f-fadeFastOut"),setTimeout(()=>{m&&(m.remove(),m=null)},200))};(C=f,new Promise((w,b)=>{const S=new Image;S.onload=w,S.onerror=b,S.src=C})).then(()=>{s.hideLoading(n),n.state=At.Opening,this.instance.emit("reveal",n),this.zoomIn(n).then(()=>{g(),this.instance.done(n)},()=>{}),m&&setTimeout(()=>{g()},u>2500?800:200)},()=>{s.hideLoading(n),s.revealContent(n)})}else{const d=this.optionFor(n,"initialSize"),u=this.optionFor(n,"zoom"),m={event:s.prevMouseMoveEvent||s.options.event,friction:u?.12:0};let g=s.optionFor(n,"showClass")||void 0,w=!0;s.isOpeningSlide(n)&&(d==="full"?c.zoomToFull(m):d==="cover"?c.zoomToCover(m):d==="max"?c.zoomToMax(m):w=!1,c.stop("current")),w&&g&&(g=c.isDragging?"f-fadeIn":""),s.hideLoading(n),s.revealContent(n,g)}var C},()=>{s.setError(n,"{{IMAGE_ERROR}}")})}process(n,r){return new Promise((s,c)=>{var h;const p=this.instance,f=n.el;p.clearContent(n),p.showLoading(n);let y=this.optionFor(n,"content");if(typeof y=="string"&&(y=en(y)),!y||!It(y)){if(y=document.createElement("img"),y instanceof HTMLImageElement){let T="",C=n.caption;T=typeof C=="string"&&C?C.replace(/<[^>]+>/gi,"").substring(0,1e3):`Image ${n.index+1} of ${((h=p.carousel)===null||h===void 0?void 0:h.pages.length)||1}`,y.src=r||"",y.alt=T,y.draggable=!1,n.srcset&&y.setAttribute("srcset",n.srcset),this.instance.isOpeningSlide(n)&&(y.fetchPriority="high")}n.sizes&&y.setAttribute("sizes",n.sizes)}Ae(y,"fancybox-image"),n.imageEl=y,p.setContent(n,y,!1),n.panzoom=new _n(f,Nt({transformParent:!0},this.option("Panzoom")||{},{content:y,width:(T,C)=>p.optionFor(n,"width","auto",C)||"auto",height:(T,C)=>p.optionFor(n,"height","auto",C)||"auto",wheel:()=>{const T=p.option("wheel");return(T==="zoom"||T=="pan")&&T},click:(T,C)=>{var d,u;if(p.isCompact||p.isClosing()||n.index!==((d=p.getSlide())===null||d===void 0?void 0:d.index))return!1;if(C){const g=C.composedPath()[0];if(["A","BUTTON","TEXTAREA","OPTION","INPUT","SELECT","VIDEO"].includes(g.nodeName))return!1}let m=!C||C.target&&((u=n.contentEl)===null||u===void 0?void 0:u.contains(C.target));return p.option(m?"contentClick":"backdropClick")||!1},dblClick:()=>p.isCompact?"toggleZoom":p.option("contentDblClick")||!1,spinner:!1,panOnlyZoomed:!0,wheelLimit:1/0,on:{ready:T=>{s(T)},error:()=>{c()},destroy:()=>{c()}}}))})}zoomIn(n){return new Promise((r,s)=>{const c=this.instance,h=c.container,{panzoom:p,contentEl:f,el:y}=n;p&&p.updateMetrics();const T=this.getZoomInfo(n);if(!(T&&y&&f&&p&&h))return void s();const{x:C,y:d,scale:u,opacity:m}=T,g=()=>{n.state!==At.Closing&&(m&&(f.style.opacity=Math.max(Math.min(1,1-(1-p.scale)/(1-u)),0)+""),p.scale>=1&&p.scale>p.targetScale-.1&&r(p))},w=_=>{(_.scale<.99||_.scale>1.01)&&!_.isDragging||(Je(h,Ti),f.style.opacity="",_.off("endAnimation",w),_.off("touchStart",w),_.off("afterTransform",g),r(_))};p.on("endAnimation",w),p.on("touchStart",w),p.on("afterTransform",g),p.on(["error","destroy"],()=>{s()}),p.panTo({x:C,y:d,scale:u,friction:0,ignoreBounds:!0}),p.stop("current");const b={event:p.panMode==="mousemove"?c.prevMouseMoveEvent||c.options.event:void 0},S=this.optionFor(n,"initialSize");Ae(h,Ti),c.hideLoading(n),S==="full"?p.zoomToFull(b):S==="cover"?p.zoomToCover(b):S==="max"?p.zoomToMax(b):p.reset(.172)})}getZoomInfo(n){const{el:r,imageEl:s,thumbEl:c,panzoom:h}=n,p=this.instance,f=p.container;if(!r||!s||!c||!h||io(c)<3||!this.optionFor(n,"zoom")||!f||p.state===kt.Destroy||getComputedStyle(f).getPropertyValue("--f-images-zoom")==="0")return!1;const y=window.visualViewport||null;if((y?y.scale:1)!==1)return!1;let{top:T,left:C,width:d,height:u}=c.getBoundingClientRect(),{top:m,left:g,fitWidth:w,fitHeight:b}=h.contentRect;if(!(d&&u&&w&&b))return!1;const S=h.container.getBoundingClientRect();g+=S.left,m+=S.top;const _=-1*(g+.5*w-(C+.5*d)),M=-1*(m+.5*b-(T+.5*u)),x=d/w;let v=this.option("zoomOpacity")||!1;return v==="auto"&&(v=Math.abs(d/u-w/b)>.1),{x:_,y:M,scale:x,opacity:v}}attach(){const n=this,r=n.instance;r.on("Carousel.change",n.onChange),r.on("Carousel.createSlide",n.onCreateSlide),r.on("Carousel.removeSlide",n.onRemoveSlide),r.on("close",n.onClose)}detach(){const n=this,r=n.instance;r.off("Carousel.change",n.onChange),r.off("Carousel.createSlide",n.onCreateSlide),r.off("Carousel.removeSlide",n.onRemoveSlide),r.off("close",n.onClose)}}Object.defineProperty(co,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{initialSize:"fit",Panzoom:{maxScale:1},protected:!1,zoom:!0,zoomOpacity:"auto"}}),typeof SuppressedError=="function"&&SuppressedError;const cr="html",Ta="image",ur="map",on="youtube",yn="vimeo",Gn="html5video",xa=(k,n={})=>{const r=new URL(k),s=new URLSearchParams(r.search),c=new URLSearchParams;for(const[f,y]of[...s,...Object.entries(n)]){let T=y+"";if(f==="t"){let C=T.match(/((\d*)m)?(\d*)s?/);C&&c.set("start",60*parseInt(C[2]||"0")+parseInt(C[3]||"0")+"")}else c.set(f,T)}let h=c+"",p=k.match(/#t=((.*)?\d+s)/);return p&&(h+=`#t=${p[1]}`),h},Ul={ajax:null,autoSize:!0,iframeAttr:{allow:"autoplay; fullscreen",scrolling:"auto"},preload:!0,videoAutoplay:!0,videoRatio:16/9,videoTpl:`<video class="fancybox__html5video" playsinline controls controlsList="nodownload" poster="{{poster}}">
  <source src="{{src}}" type="{{format}}" />Sorry, your browser doesn't support embedded videos.</video>`,videoFormat:"",vimeo:{byline:1,color:"00adef",controls:1,dnt:1,muted:0},youtube:{controls:1,enablejsapi:1,nocookie:1,rel:0,fs:1}},Vl=["image","html","ajax","inline","clone","iframe","map","pdf","html5video","youtube","vimeo"];class uo extends Zt{onBeforeInitSlide(n,r,s){this.processType(s)}onCreateSlide(n,r,s){this.setContent(s)}onClearContent(n,r){r.xhr&&(r.xhr.abort(),r.xhr=null);const s=r.iframeEl;s&&(s.onload=s.onerror=null,s.src="//about:blank",r.iframeEl=null);const c=r.contentEl,h=r.placeholderEl;if(r.type==="inline"&&c&&h)c.classList.remove("fancybox__content"),getComputedStyle(c).getPropertyValue("display")!=="none"&&(c.style.display="none"),setTimeout(()=>{h&&(c&&h.parentNode&&h.parentNode.insertBefore(c,h),h.remove())},0),r.contentEl=void 0,r.placeholderEl=void 0;else for(;r.el&&r.el.firstChild;)r.el.removeChild(r.el.firstChild)}onSelectSlide(n,r,s){s.state===At.Ready&&this.playVideo()}onUnselectSlide(n,r,s){var c,h;if(s.type===Gn){try{(h=(c=s.el)===null||c===void 0?void 0:c.querySelector("video"))===null||h===void 0||h.pause()}catch{}return}let p;s.type===yn?p={method:"pause",value:"true"}:s.type===on&&(p={event:"command",func:"pauseVideo"}),p&&s.iframeEl&&s.iframeEl.contentWindow&&s.iframeEl.contentWindow.postMessage(JSON.stringify(p),"*"),s.poller&&clearTimeout(s.poller)}onDone(n,r){n.isCurrentSlide(r)&&!n.isClosing()&&this.playVideo()}onRefresh(n,r){r.slides.forEach(s=>{s.el&&(this.resizeIframe(s),this.setAspectRatio(s))})}onMessage(n){try{let r=JSON.parse(n.data);if(n.origin==="https://player.vimeo.com"){if(r.event==="ready")for(let s of Array.from(document.getElementsByClassName("fancybox__iframe")))s instanceof HTMLIFrameElement&&s.contentWindow===n.source&&(s.dataset.ready="true")}else if(n.origin.match(/^https:\/\/(www.)?youtube(-nocookie)?.com$/)&&r.event==="onReady"){const s=document.getElementById(r.id);s&&(s.dataset.ready="true")}}catch{}}loadAjaxContent(n){const r=this.instance.optionFor(n,"src")||"";this.instance.showLoading(n);const s=this.instance,c=new XMLHttpRequest;s.showLoading(n),c.onreadystatechange=function(){c.readyState===XMLHttpRequest.DONE&&s.state===kt.Ready&&(s.hideLoading(n),c.status===200?s.setContent(n,c.responseText):s.setError(n,c.status===404?"{{AJAX_NOT_FOUND}}":"{{AJAX_FORBIDDEN}}"))};const h=n.ajax||null;c.open(h?"POST":"GET",r+""),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.send(h),n.xhr=c}setInlineContent(n){let r=null;if(It(n.src))r=n.src;else if(typeof n.src=="string"){const s=n.src.split("#",2).pop();r=s?document.getElementById(s):null}if(r){if(n.type==="clone"||r.closest(".fancybox__slide")){r=r.cloneNode(!0);const s=r.dataset.animationName;s&&(r.classList.remove(s),delete r.dataset.animationName);let c=r.getAttribute("id");c=c?`${c}--clone`:`clone-${this.instance.id}-${n.index}`,r.setAttribute("id",c)}else if(r.parentNode){const s=document.createElement("div");s.classList.add("fancybox-placeholder"),r.parentNode.insertBefore(s,r),n.placeholderEl=s}this.instance.setContent(n,r)}else this.instance.setError(n,"{{ELEMENT_NOT_FOUND}}")}setIframeContent(n){const{src:r,el:s}=n;if(!r||typeof r!="string"||!s)return;s.classList.add("is-loading");const c=this.instance,h=document.createElement("iframe");h.className="fancybox__iframe",h.setAttribute("id",`fancybox__iframe_${c.id}_${n.index}`);for(const[f,y]of Object.entries(this.optionFor(n,"iframeAttr")||{}))h.setAttribute(f,y);h.onerror=()=>{c.setError(n,"{{IFRAME_ERROR}}")},n.iframeEl=h;const p=this.optionFor(n,"preload");if(n.type!=="iframe"||p===!1)return h.setAttribute("src",n.src+""),c.setContent(n,h,!1),this.resizeIframe(n),void c.revealContent(n);c.showLoading(n),h.onload=()=>{if(!h.src.length)return;const f=h.dataset.ready!=="true";h.dataset.ready="true",this.resizeIframe(n),f?c.revealContent(n):c.hideLoading(n)},h.setAttribute("src",r),c.setContent(n,h,!1)}resizeIframe(n){const{type:r,iframeEl:s}=n;if(r===on||r===yn)return;const c=s==null?void 0:s.parentElement;if(!s||!c)return;let h=n.autoSize;h===void 0&&(h=this.optionFor(n,"autoSize"));let p=n.width||0,f=n.height||0;p&&f&&(h=!1);const y=c&&c.style;if(n.preload!==!1&&h!==!1&&y)try{const T=window.getComputedStyle(c),C=parseFloat(T.paddingLeft)+parseFloat(T.paddingRight),d=parseFloat(T.paddingTop)+parseFloat(T.paddingBottom),u=s.contentWindow;if(u){const m=u.document,g=m.getElementsByTagName(cr)[0],w=m.body;y.width="",w.style.overflow="hidden",p=p||g.scrollWidth+C,y.width=`${p}px`,w.style.overflow="",y.flex="0 0 auto",y.height=`${w.scrollHeight}px`,f=g.scrollHeight+d}}catch{}if(p||f){const T={flex:"0 1 auto",width:"",height:""};p&&p!=="auto"&&(T.width=`${p}px`),f&&f!=="auto"&&(T.height=`${f}px`),Object.assign(y,T)}}playVideo(){const n=this.instance.getSlide();if(!n)return;const{el:r}=n;if(!r||!r.offsetParent||!this.optionFor(n,"videoAutoplay"))return;if(n.type===Gn)try{const c=r.querySelector("video");if(c){const h=c.play();h!==void 0&&h.then(()=>{}).catch(p=>{c.muted=!0,c.play()})}}catch{}if(n.type!==on&&n.type!==yn)return;const s=()=>{if(n.iframeEl&&n.iframeEl.contentWindow){let c;if(n.iframeEl.dataset.ready==="true")return c=n.type===on?{event:"command",func:"playVideo"}:{method:"play",value:"true"},c&&n.iframeEl.contentWindow.postMessage(JSON.stringify(c),"*"),void(n.poller=void 0);n.type===on&&(c={event:"listening",id:n.iframeEl.getAttribute("id")},n.iframeEl.contentWindow.postMessage(JSON.stringify(c),"*"))}n.poller=setTimeout(s,250)};s()}processType(n){if(n.html)return n.type=cr,n.src=n.html,void(n.html="");const r=this.instance.optionFor(n,"src","");if(!r||typeof r!="string")return;let s=n.type,c=null;if(c=r.match(/(youtube\.com|youtu\.be|youtube\-nocookie\.com)\/(?:watch\?(?:.*&)?v=|v\/|u\/|shorts\/|embed\/?)?(videoseries\?list=(?:.*)|[\w-]{11}|\?listType=(?:.*)&list=(?:.*))(?:.*)/i)){const h=this.optionFor(n,on),{nocookie:p}=h,f=function(d,u){var m={};for(var g in d)Object.prototype.hasOwnProperty.call(d,g)&&u.indexOf(g)<0&&(m[g]=d[g]);if(d!=null&&typeof Object.getOwnPropertySymbols=="function"){var w=0;for(g=Object.getOwnPropertySymbols(d);w<g.length;w++)u.indexOf(g[w])<0&&Object.prototype.propertyIsEnumerable.call(d,g[w])&&(m[g[w]]=d[g[w]])}return m}(h,["nocookie"]),y=`www.youtube${p?"-nocookie":""}.com`,T=xa(r,f),C=encodeURIComponent(c[2]);n.videoId=C,n.src=`https://${y}/embed/${C}?${T}`,n.thumbSrc=n.thumbSrc||`https://i.ytimg.com/vi/${C}/mqdefault.jpg`,s=on}else if(c=r.match(/^.+vimeo.com\/(?:\/)?([\d]+)((\/|\?h=)([a-z0-9]+))?(.*)?/)){const h=xa(r,this.optionFor(n,yn)),p=encodeURIComponent(c[1]),f=c[4]||"";n.videoId=p,n.src=`https://player.vimeo.com/video/${p}?${f?`h=${f}${h?"&":""}`:""}${h}`,s=yn}if(!s&&n.triggerEl){const h=n.triggerEl.dataset.type;Vl.includes(h)&&(s=h)}s||typeof r=="string"&&(r.charAt(0)==="#"?s="inline":(c=r.match(/\.(mp4|mov|ogv|webm)((\?|#).*)?$/i))?(s=Gn,n.videoFormat=n.videoFormat||"video/"+(c[1]==="ogv"?"ogg":c[1])):r.match(/(^data:image\/[a-z0-9+\/=]*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg|ico)((\?|#).*)?$)/i)?s=Ta:r.match(/\.(pdf)((\?|#).*)?$/i)&&(s="pdf")),(c=r.match(/(?:maps\.)?google\.([a-z]{2,3}(?:\.[a-z]{2})?)\/(?:(?:(?:maps\/(?:place\/(?:.*)\/)?\@(.*),(\d+.?\d+?)z))|(?:\?ll=))(.*)?/i))?(n.src=`https://maps.google.${c[1]}/?ll=${(c[2]?c[2]+"&z="+Math.floor(parseFloat(c[3]))+(c[4]?c[4].replace(/^\//,"&"):""):c[4]+"").replace(/\?/,"&")}&output=${c[4]&&c[4].indexOf("layer=c")>0?"svembed":"embed"}`,s=ur):(c=r.match(/(?:maps\.)?google\.([a-z]{2,3}(?:\.[a-z]{2})?)\/(?:maps\/search\/)(.*)/i))&&(n.src=`https://maps.google.${c[1]}/maps?q=${c[2].replace("query=","q=").replace("api=1","")}&output=embed`,s=ur),s=s||this.instance.option("defaultType"),n.type=s,s===Ta&&(n.thumbSrc=n.thumbSrc||n.src)}setContent(n){const r=this.instance.optionFor(n,"src")||"";if(n&&n.type&&r){switch(n.type){case cr:this.instance.setContent(n,r);break;case Gn:const s=this.option("videoTpl");s&&this.instance.setContent(n,s.replace(/\{\{src\}\}/gi,r+"").replace(/\{\{format\}\}/gi,this.optionFor(n,"videoFormat")||"").replace(/\{\{poster\}\}/gi,n.poster||n.thumbSrc||""));break;case"inline":case"clone":this.setInlineContent(n);break;case"ajax":this.loadAjaxContent(n);break;case"pdf":case ur:case on:case yn:n.preload=!1;case"iframe":this.setIframeContent(n)}this.setAspectRatio(n)}}setAspectRatio(n){const r=n.contentEl;if(!(n.el&&r&&n.type&&[on,yn,Gn].includes(n.type)))return;let s,c=n.width||"auto",h=n.height||"auto";if(c==="auto"||h==="auto"){s=this.optionFor(n,"videoRatio");const T=(s+"").match(/(\d+)\s*\/\s?(\d+)/);s=T&&T.length>2?parseFloat(T[1])/parseFloat(T[2]):parseFloat(s+"")}else c&&h&&(s=c/h);if(!s)return;r.style.aspectRatio="",r.style.width="",r.style.height="",r.offsetHeight;const p=r.getBoundingClientRect(),f=p.width||1,y=p.height||1;r.style.aspectRatio=s+"",s<f/y?(h=h==="auto"?y:Math.min(y,h),r.style.width="auto",r.style.height=`${h}px`):(c=c==="auto"?f:Math.min(f,c),r.style.width=`${c}px`,r.style.height="auto")}attach(){const n=this,r=n.instance;r.on("Carousel.beforeInitSlide",n.onBeforeInitSlide),r.on("Carousel.createSlide",n.onCreateSlide),r.on("Carousel.selectSlide",n.onSelectSlide),r.on("Carousel.unselectSlide",n.onUnselectSlide),r.on("Carousel.Panzoom.refresh",n.onRefresh),r.on("done",n.onDone),r.on("clearContent",n.onClearContent),window.addEventListener("message",n.onMessage)}detach(){const n=this,r=n.instance;r.off("Carousel.beforeInitSlide",n.onBeforeInitSlide),r.off("Carousel.createSlide",n.onCreateSlide),r.off("Carousel.selectSlide",n.onSelectSlide),r.off("Carousel.unselectSlide",n.onUnselectSlide),r.off("Carousel.Panzoom.refresh",n.onRefresh),r.off("done",n.onDone),r.off("clearContent",n.onClearContent),window.removeEventListener("message",n.onMessage)}}Object.defineProperty(uo,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:Ul});const xi="play",_i="pause",Zn="ready";class fo extends Zt{constructor(){super(...arguments),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:Zn}),Object.defineProperty(this,"inHover",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"timer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"progressBar",{enumerable:!0,configurable:!0,writable:!0,value:null})}get isActive(){return this.state!==Zn}onReady(n){this.option("autoStart")&&(n.isInfinite||n.page<n.pages.length-1)&&this.start()}onChange(){this.removeProgressBar(),this.pause()}onSettle(){this.resume()}onVisibilityChange(){document.visibilityState==="visible"?this.resume():this.pause()}onMouseEnter(){this.inHover=!0,this.pause()}onMouseLeave(){var n;this.inHover=!1,!((n=this.instance.panzoom)===null||n===void 0)&&n.isResting&&this.resume()}onTimerEnd(){const n=this.instance;this.state==="play"&&(n.isInfinite||n.page!==n.pages.length-1?n.slideNext():n.slideTo(0))}removeProgressBar(){this.progressBar&&(this.progressBar.remove(),this.progressBar=null)}createProgressBar(){var n;if(!this.option("showProgress"))return null;this.removeProgressBar();const r=this.instance,s=((n=r.pages[r.page])===null||n===void 0?void 0:n.slides)||[];let c=this.option("progressParentEl");if(c||(c=(s.length===1?s[0].el:null)||r.viewport),!c)return null;const h=document.createElement("div");return Ae(h,"f-progress"),c.prepend(h),this.progressBar=h,h.offsetHeight,h}set(){const n=this,r=n.instance;if(r.pages.length<2||n.timer)return;const s=n.option("timeout");n.state=xi,Ae(r.container,"has-autoplay");let c=n.createProgressBar();c&&(c.style.transitionDuration=`${s}ms`,c.style.transform="scaleX(1)"),n.timer=setTimeout(()=>{n.timer=null,n.inHover||n.onTimerEnd()},s),n.emit("set")}clear(){const n=this;n.timer&&(clearTimeout(n.timer),n.timer=null),n.removeProgressBar()}start(){const n=this;if(n.set(),n.state!==Zn){if(n.option("pauseOnHover")){const r=n.instance.container;r.addEventListener("mouseenter",n.onMouseEnter,!1),r.addEventListener("mouseleave",n.onMouseLeave,!1)}document.addEventListener("visibilitychange",n.onVisibilityChange,!1),n.emit("start")}}stop(){const n=this,r=n.state,s=n.instance.container;n.clear(),n.state=Zn,s.removeEventListener("mouseenter",n.onMouseEnter,!1),s.removeEventListener("mouseleave",n.onMouseLeave,!1),document.removeEventListener("visibilitychange",n.onVisibilityChange,!1),Je(s,"has-autoplay"),r!==Zn&&n.emit("stop")}pause(){const n=this;n.state===xi&&(n.state=_i,n.clear(),n.emit(_i))}resume(){const n=this,r=n.instance;if(r.isInfinite||r.page!==r.pages.length-1)if(n.state!==xi){if(n.state===_i&&!n.inHover){const s=new Event("resume",{bubbles:!0,cancelable:!0});n.emit("resume",s),s.defaultPrevented||n.set()}}else n.set();else n.stop()}toggle(){this.state===xi||this.state===_i?this.stop():this.start()}attach(){const n=this,r=n.instance;r.on("ready",n.onReady),r.on("Panzoom.startAnimation",n.onChange),r.on("Panzoom.endAnimation",n.onSettle),r.on("Panzoom.touchMove",n.onChange)}detach(){const n=this,r=n.instance;r.off("ready",n.onReady),r.off("Panzoom.startAnimation",n.onChange),r.off("Panzoom.endAnimation",n.onSettle),r.off("Panzoom.touchMove",n.onChange),n.stop()}}Object.defineProperty(fo,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{autoStart:!0,pauseOnHover:!0,progressParentEl:null,showProgress:!0,timeout:3e3}});class ho extends Zt{constructor(){super(...arguments),Object.defineProperty(this,"ref",{enumerable:!0,configurable:!0,writable:!0,value:null})}onPrepare(n){const r=n.carousel;if(!r)return;const s=n.container;s&&(r.options.Autoplay=Nt({autoStart:!1},this.option("Autoplay")||{},{pauseOnHover:!1,timeout:this.option("timeout"),progressParentEl:()=>this.option("progressParentEl")||null,on:{start:()=>{n.emit("startSlideshow")},set:c=>{var h;s.classList.add("has-slideshow"),((h=n.getSlide())===null||h===void 0?void 0:h.state)!==At.Ready&&c.pause()},stop:()=>{s.classList.remove("has-slideshow"),n.isCompact||n.endIdle(),n.emit("endSlideshow")},resume:(c,h)=>{var p,f,y;!h||!h.cancelable||((p=n.getSlide())===null||p===void 0?void 0:p.state)===At.Ready&&(!((y=(f=n.carousel)===null||f===void 0?void 0:f.panzoom)===null||y===void 0)&&y.isResting)||h.preventDefault()}}}),r.attachPlugins({Autoplay:fo}),this.ref=r.plugins.Autoplay)}onReady(n){const r=n.carousel,s=this.ref;s&&r&&this.option("playOnStart")&&(r.isInfinite||r.page<r.pages.length-1)&&s.start()}onDone(n,r){const s=this.ref,c=n.carousel;if(!s||!c)return;const h=r.panzoom;h&&h.on("startAnimation",()=>{n.isCurrentSlide(r)&&s.stop()}),n.isCurrentSlide(r)&&s.resume()}onKeydown(n,r){var s;const c=this.ref;c&&r===this.option("key")&&((s=document.activeElement)===null||s===void 0?void 0:s.nodeName)!=="BUTTON"&&c.toggle()}attach(){const n=this,r=n.instance;r.on("Carousel.init",n.onPrepare),r.on("Carousel.ready",n.onReady),r.on("done",n.onDone),r.on("keydown",n.onKeydown)}detach(){const n=this,r=n.instance;r.off("Carousel.init",n.onPrepare),r.off("Carousel.ready",n.onReady),r.off("done",n.onDone),r.off("keydown",n.onKeydown)}}Object.defineProperty(ho,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{key:" ",playOnStart:!1,progressParentEl:k=>{var n;return((n=k.instance.container)===null||n===void 0?void 0:n.querySelector(".fancybox__toolbar [data-fancybox-toggle-slideshow]"))||k.instance.container},timeout:3e3}});const po={classes:{container:"f-thumbs f-carousel__thumbs",viewport:"f-thumbs__viewport",track:"f-thumbs__track",slide:"f-thumbs__slide",isResting:"is-resting",isSelected:"is-selected",isLoading:"is-loading",hasThumbs:"has-thumbs"},minCount:2,parentEl:null,thumbTpl:'<button class="f-thumbs__slide__button" tabindex="0" type="button" aria-label="{{GOTO}}" data-carousel-index="%i"><img class="f-thumbs__slide__img" data-lazy-src="{{%s}}" alt="" /></button>',type:"modern"};var ln;(function(k){k[k.Init=0]="Init",k[k.Ready=1]="Ready",k[k.Hidden=2]="Hidden"})(ln||(ln={}));const _a="isResting",Mi="thumbWidth",Rn="thumbHeight",Qt="thumbClipWidth";let mo=class extends Zt{constructor(){super(...arguments),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:"modern"}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"track",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"carousel",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"thumbWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbClipWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbGap",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbExtraGap",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:ln.Init})}get isModern(){return this.type==="modern"}onInitSlide(k,n){const r=n.el?n.el.dataset:void 0;r&&(n.thumbSrc=r.thumbSrc||n.thumbSrc||"",n[Qt]=parseFloat(r[Qt]||"")||n[Qt]||0,n[Rn]=parseFloat(r.thumbHeight||"")||n[Rn]||0),this.addSlide(n)}onInitSlides(){this.build()}onChange(){var k;if(!this.isModern)return;const n=this.container,r=this.instance,s=r.panzoom,c=this.carousel,h=c?c.panzoom:null,p=r.page;if(s&&c&&h){if(s.isDragging){Je(n,this.cn(_a));let f=((k=c.pages[p])===null||k===void 0?void 0:k.pos)||0;f+=r.getProgress(p)*(this[Qt]+this.thumbGap);let y=h.getBounds();-1*f>y.x.min&&-1*f<y.x.max&&h.panTo({x:-1*f,friction:.12})}else tn(n,this.cn(_a),s.isResting);this.shiftModern()}}onRefresh(){this.updateProps();for(const k of this.instance.slides||[])this.resizeModernSlide(k);this.shiftModern()}isDisabled(){const k=this.option("minCount")||0;if(k){const r=this.instance;let s=0;for(const c of r.slides||[])c.thumbSrc&&s++;if(s<k)return!0}const n=this.option("type");return["modern","classic"].indexOf(n)<0}getThumb(k){const n=this.option("thumbTpl")||"";return{html:this.instance.localize(n,[["%i",k.index],["%d",k.index+1],["%s",k.thumbSrc||"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"]])}}addSlide(k){const n=this.carousel;n&&n.addSlide(k.index,this.getThumb(k))}getSlides(){const k=[];for(const n of this.instance.slides||[])k.push(this.getThumb(n));return k}resizeModernSlide(k){this.isModern&&(k[Mi]=k[Qt]&&k[Rn]?Math.round(this[Rn]*(k[Qt]/k[Rn])):this[Mi])}updateProps(){const k=this.container;if(!k)return;const n=r=>parseFloat(getComputedStyle(k).getPropertyValue("--f-thumb-"+r))||0;this.thumbGap=n("gap"),this.thumbExtraGap=n("extra-gap"),this[Mi]=n("width")||40,this[Qt]=n("clip-width")||40,this[Rn]=n("height")||40}build(){const k=this;if(k.state!==ln.Init)return;if(k.isDisabled())return void k.emit("disabled");const n=k.instance,r=n.container,s=k.getSlides(),c=k.option("type");k.type=c;const h=k.option("parentEl"),p=k.cn("container"),f=k.cn("track");let y=h==null?void 0:h.querySelector("."+p);y||(y=document.createElement("div"),Ae(y,p),h?h.appendChild(y):r.after(y)),Ae(y,`is-${c}`),Ae(r,k.cn("hasThumbs")),k.container=y,k.updateProps();let T=y.querySelector("."+f);T||(T=document.createElement("div"),Ae(T,k.cn("track")),y.appendChild(T)),k.track=T;const C=Nt({},{track:T,infinite:!1,center:!0,fill:c==="classic",dragFree:!0,slidesPerPage:1,transition:!1,preload:.25,friction:.12,Panzoom:{maxVelocity:0},Dots:!1,Navigation:!1,classes:{container:"f-thumbs",viewport:"f-thumbs__viewport",track:"f-thumbs__track",slide:"f-thumbs__slide"}},k.option("Carousel")||{},{Sync:{target:n},slides:s}),d=new n.constructor(y,C);d.on("createSlide",(u,m)=>{k.setProps(m.index),k.emit("createSlide",m,m.el)}),d.on("ready",()=>{k.shiftModern(),k.emit("ready")}),d.on("refresh",()=>{k.shiftModern()}),d.on("Panzoom.click",(u,m,g)=>{k.onClick(g)}),k.carousel=d,k.state=ln.Ready}onClick(k){k.preventDefault(),k.stopPropagation();const n=this.instance,{pages:r,page:s}=n,c=w=>{if(w){const b=w.closest("[data-carousel-index]");if(b)return[parseInt(b.dataset.carouselIndex||"",10)||0,b]}return[-1,void 0]},h=(w,b)=>{const S=document.elementFromPoint(w,b);return S?c(S):[-1,void 0]};let[p,f]=c(k.target);if(p>-1)return;const y=this[Qt],T=k.clientX,C=k.clientY;let[d,u]=h(T-y,C),[m,g]=h(T+y,C);u&&g?(p=Math.abs(T-u.getBoundingClientRect().right)<Math.abs(T-g.getBoundingClientRect().left)?d:m,p===s&&(p=p===d?m:d)):u?p=d:g&&(p=m),p>-1&&r[p]&&n.slideTo(p)}getShift(k){var n;const r=this,{instance:s}=r,c=r.carousel;if(!s||!c)return 0;const h=r[Mi],p=r[Qt],f=r.thumbGap,y=r.thumbExtraGap;if(!(!((n=c.slides[k])===null||n===void 0)&&n.el))return 0;const T=.5*(h-p),C=s.pages.length-1;let d=s.getProgress(0),u=s.getProgress(C),m=s.getProgress(k,!1,!0),g=0,w=T+y+f;const b=d<0&&d>-1,S=u>0&&u<1;return k===0?(g=w*Math.abs(d),S&&d===1&&(g-=w*Math.abs(u))):k===C?(g=w*Math.abs(u)*-1,b&&u===-1&&(g+=w*Math.abs(d))):b||S?(g=-1*w,g+=w*Math.abs(d),g+=w*(1-Math.abs(u))):g=w*m,g}setProps(k){var n;const r=this;if(!r.isModern)return;const{instance:s}=r,c=r.carousel;if(s&&c){const h=(n=c.slides[k])===null||n===void 0?void 0:n.el;if(h&&h.childNodes.length){let p=me(1-Math.abs(s.getProgress(k))),f=me(r.getShift(k));h.style.setProperty("--progress",p?p+"":""),h.style.setProperty("--shift",f+"")}}}shiftModern(){const k=this;if(!k.isModern)return;const{instance:n,track:r}=k,s=n.panzoom,c=k.carousel;if(!(n&&r&&s&&c)||s.state===tt.Init||s.state===tt.Destroy)return;for(const p of n.slides)k.setProps(p.index);let h=(k[Qt]+k.thumbGap)*(c.slides.length||0);r.style.setProperty("--width",h+"")}cleanup(){const k=this;k.carousel&&k.carousel.destroy(),k.carousel=null,k.container&&k.container.remove(),k.container=null,k.track&&k.track.remove(),k.track=null,k.state=ln.Init,Je(k.instance.container,k.cn("hasThumbs"))}attach(){const k=this,n=k.instance;n.on("initSlide",k.onInitSlide),n.state===bt.Init?n.on("initSlides",k.onInitSlides):k.onInitSlides(),n.on(["change","Panzoom.afterTransform"],k.onChange),n.on("Panzoom.refresh",k.onRefresh)}detach(){const k=this,n=k.instance;n.off("initSlide",k.onInitSlide),n.off("initSlides",k.onInitSlides),n.off(["change","Panzoom.afterTransform"],k.onChange),n.off("Panzoom.refresh",k.onRefresh),k.cleanup()}};Object.defineProperty(mo,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:po});const ql=Object.assign(Object.assign({},po),{key:"t",showOnStart:!0,parentEl:null}),Ma="is-masked",La="aria-hidden";class go extends Zt{constructor(){super(...arguments),Object.defineProperty(this,"ref",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hidden",{enumerable:!0,configurable:!0,writable:!0,value:!1})}get isEnabled(){const n=this.ref;return n&&!n.isDisabled()}get isHidden(){return this.hidden}onClick(n,r){r.stopPropagation()}onCreateSlide(n,r){var s,c,h;const p=((h=(c=(s=this.instance)===null||s===void 0?void 0:s.carousel)===null||c===void 0?void 0:c.slides[r.index])===null||h===void 0?void 0:h.type)||"",f=r.el;if(f&&p){let y=`for-${p}`;["video","youtube","vimeo","html5video"].includes(p)&&(y+=" for-video"),Ae(f,y)}}onInit(){var n;const r=this,s=r.instance,c=s.carousel;if(r.ref||!c)return;const h=r.option("parentEl")||s.footer||s.container;if(!h)return;const p=Nt({},r.options,{parentEl:h,classes:{container:"f-thumbs fancybox__thumbs"},Carousel:{Sync:{friction:s.option("Carousel.friction")||0}},on:{ready:f=>{const y=f.container;y&&this.hidden&&(r.refresh(),y.style.transition="none",r.hide(),y.offsetHeight,queueMicrotask(()=>{y.style.transition="",r.show()}))}}});p.Carousel=p.Carousel||{},p.Carousel.on=Nt(((n=r.options.Carousel)===null||n===void 0?void 0:n.on)||{},{click:this.onClick,createSlide:this.onCreateSlide}),c.options.Thumbs=p,c.attachPlugins({Thumbs:mo}),r.ref=c.plugins.Thumbs,r.option("showOnStart")||(r.ref.state=ln.Hidden,r.hidden=!0)}onResize(){var n;const r=(n=this.ref)===null||n===void 0?void 0:n.container;r&&(r.style.maxHeight="")}onKeydown(n,r){const s=this.option("key");s&&s===r&&this.toggle()}toggle(){const n=this.ref;if(n&&!n.isDisabled())return n.state===ln.Hidden?(n.state=ln.Init,void n.build()):void(this.hidden?this.show():this.hide())}show(){const n=this.ref;if(!n||n.isDisabled())return;const r=n.container;r&&(this.refresh(),r.offsetHeight,r.removeAttribute(La),r.classList.remove(Ma),this.hidden=!1)}hide(){const n=this.ref,r=n&&n.container;r&&(this.refresh(),r.offsetHeight,r.classList.add(Ma),r.setAttribute(La,"true")),this.hidden=!0}refresh(){const n=this.ref;if(!n||!n.state)return;const r=n.container,s=(r==null?void 0:r.firstChild)||null;r&&s&&s.childNodes.length&&(r.style.maxHeight=`${s.getBoundingClientRect().height}px`)}attach(){const n=this,r=n.instance;r.state===kt.Init?r.on("Carousel.init",n.onInit):n.onInit(),r.on("resize",n.onResize),r.on("keydown",n.onKeydown)}detach(){var n;const r=this,s=r.instance;s.off("Carousel.init",r.onInit),s.off("resize",r.onResize),s.off("keydown",r.onKeydown),(n=s.carousel)===null||n===void 0||n.detachPlugins(["Thumbs"]),r.ref=null}}Object.defineProperty(go,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:ql});const dr={panLeft:{icon:'<svg><path d="M5 12h14M5 12l6 6M5 12l6-6"/></svg>',change:{panX:-100}},panRight:{icon:'<svg><path d="M5 12h14M13 18l6-6M13 6l6 6"/></svg>',change:{panX:100}},panUp:{icon:'<svg><path d="M12 5v14M18 11l-6-6M6 11l6-6"/></svg>',change:{panY:-100}},panDown:{icon:'<svg><path d="M12 5v14M18 13l-6 6M6 13l6 6"/></svg>',change:{panY:100}},zoomIn:{icon:'<svg><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M11 8v6M8 11h6"/></svg>',action:"zoomIn"},zoomOut:{icon:'<svg><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M8 11h6"/></svg>',action:"zoomOut"},toggle1to1:{icon:'<svg><path d="M3.51 3.07c5.74.02 11.48-.02 17.22.02 1.37.1 2.34 1.64 2.18 3.13 0 4.08.02 8.16 0 12.23-.1 1.54-1.47 2.64-2.79 2.46-5.61-.01-11.24.02-16.86-.01-1.36-.12-2.33-1.65-2.17-3.14 0-4.07-.02-8.16 0-12.23.1-1.36 1.22-2.48 2.42-2.46Z"/><path d="M5.65 8.54h1.49v6.92m8.94-6.92h1.49v6.92M11.5 9.4v.02m0 5.18v0"/></svg>',action:"toggleZoom"},toggleZoom:{icon:'<svg><g><line x1="11" y1="8" x2="11" y2="14"></line></g><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M8 11h6"/></svg>',action:"toggleZoom"},iterateZoom:{icon:'<svg><g><line x1="11" y1="8" x2="11" y2="14"></line></g><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M8 11h6"/></svg>',action:"iterateZoom"},rotateCCW:{icon:'<svg><path d="M15 4.55a8 8 0 0 0-6 14.9M9 15v5H4M18.37 7.16v.01M13 19.94v.01M16.84 18.37v.01M19.37 15.1v.01M19.94 11v.01"/></svg>',action:"rotateCCW"},rotateCW:{icon:'<svg><path d="M9 4.55a8 8 0 0 1 6 14.9M15 15v5h5M5.63 7.16v.01M4.06 11v.01M4.63 15.1v.01M7.16 18.37v.01M11 19.94v.01"/></svg>',action:"rotateCW"},flipX:{icon:'<svg style="stroke-width: 1.3"><path d="M12 3v18M16 7v10h5L16 7M8 7v10H3L8 7"/></svg>',action:"flipX"},flipY:{icon:'<svg style="stroke-width: 1.3"><path d="M3 12h18M7 16h10L7 21v-5M7 8h10L7 3v5"/></svg>',action:"flipY"},fitX:{icon:'<svg><path d="M4 12V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v6M10 18H3M21 18h-7M6 15l-3 3 3 3M18 15l3 3-3 3"/></svg>',action:"fitX"},fitY:{icon:'<svg><path d="M12 20H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h6M18 14v7M18 3v7M15 18l3 3 3-3M15 6l3-3 3 3"/></svg>',action:"fitY"},reset:{icon:'<svg><path d="M20 11A8.1 8.1 0 0 0 4.5 9M4 5v4h4M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4"/></svg>',action:"reset"},toggleFS:{icon:'<svg><g><path d="M14.5 9.5 21 3m0 0h-6m6 0v6M3 21l6.5-6.5M3 21v-6m0 6h6"/></g><g><path d="m14 10 7-7m-7 7h6m-6 0V4M3 21l7-7m0 0v6m0-6H4"/></g></svg>',action:"toggleFS"}};var kn;(function(k){k[k.Init=0]="Init",k[k.Ready=1]="Ready",k[k.Disabled=2]="Disabled"})(kn||(kn={}));const Wl={absolute:"auto",display:{left:["infobar"],middle:[],right:["iterateZoom","slideshow","fullscreen","thumbs","close"]},enabled:"auto",items:{infobar:{tpl:'<div class="fancybox__infobar" tabindex="-1"><span data-fancybox-current-index></span>/<span data-fancybox-count></span></div>'},download:{tpl:'<a class="f-button" title="{{DOWNLOAD}}" data-fancybox-download href="javasript:;"><svg><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2M7 11l5 5 5-5M12 4v12"/></svg></a>'},prev:{tpl:'<button class="f-button" title="{{PREV}}" data-fancybox-prev><svg><path d="m15 6-6 6 6 6"/></svg></button>'},next:{tpl:'<button class="f-button" title="{{NEXT}}" data-fancybox-next><svg><path d="m9 6 6 6-6 6"/></svg></button>'},slideshow:{tpl:'<button class="f-button" title="{{TOGGLE_SLIDESHOW}}" data-fancybox-toggle-slideshow><svg><g><path d="M8 4v16l13 -8z"></path></g><g><path d="M8 4v15M17 4v15"/></g></svg></button>'},fullscreen:{tpl:'<button class="f-button" title="{{TOGGLE_FULLSCREEN}}" data-fancybox-toggle-fullscreen><svg><g><path d="M4 8V6a2 2 0 0 1 2-2h2M4 16v2a2 2 0 0 0 2 2h2M16 4h2a2 2 0 0 1 2 2v2M16 20h2a2 2 0 0 0 2-2v-2"/></g><g><path d="M15 19v-2a2 2 0 0 1 2-2h2M15 5v2a2 2 0 0 0 2 2h2M5 15h2a2 2 0 0 1 2 2v2M5 9h2a2 2 0 0 0 2-2V5"/></g></svg></button>'},thumbs:{tpl:'<button class="f-button" title="{{TOGGLE_THUMBS}}" data-fancybox-toggle-thumbs><svg><circle cx="5.5" cy="5.5" r="1"/><circle cx="12" cy="5.5" r="1"/><circle cx="18.5" cy="5.5" r="1"/><circle cx="5.5" cy="12" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="18.5" cy="12" r="1"/><circle cx="5.5" cy="18.5" r="1"/><circle cx="12" cy="18.5" r="1"/><circle cx="18.5" cy="18.5" r="1"/></svg></button>'},close:{tpl:'<button class="f-button" title="{{CLOSE}}" data-fancybox-close><svg><path d="m19.5 4.5-15 15M4.5 4.5l15 15"/></svg></button>'}},parentEl:null},Yl={tabindex:"-1",width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Aa="has-toolbar",fr="fancybox__toolbar";class vo extends Zt{constructor(){super(...arguments),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:kn.Init}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null})}onReady(n){var r;if(!n.carousel)return;let s=this.option("display"),c=this.option("absolute"),h=this.option("enabled");if(h==="auto"){const T=this.instance.carousel;let C=0;if(T)for(const d of T.slides)(d.panzoom||d.type==="image")&&C++;C||(h=!1)}h||(s=void 0);let p=0;const f={left:[],middle:[],right:[]};if(s)for(const T of["left","middle","right"])for(const C of s[T]){const d=this.createEl(C);d&&((r=f[T])===null||r===void 0||r.push(d),p++)}let y=null;if(p&&(y=this.createContainer()),y){for(const[T,C]of Object.entries(f)){const d=document.createElement("div");Ae(d,fr+"__column is-"+T);for(const u of C)d.appendChild(u);c!=="auto"||T!=="middle"||C.length||(c=!0),y.appendChild(d)}c===!0&&Ae(y,"is-absolute"),this.state=kn.Ready,this.onRefresh()}else this.state=kn.Disabled}onClick(n){var r,s;const c=this.instance,h=c.getSlide(),p=h==null?void 0:h.panzoom,f=n.target,y=f&&It(f)?f.dataset:null;if(!y)return;if(y.fancyboxToggleThumbs!==void 0)return n.preventDefault(),n.stopPropagation(),void((r=c.plugins.Thumbs)===null||r===void 0||r.toggle());if(y.fancyboxToggleFullscreen!==void 0)return n.preventDefault(),n.stopPropagation(),void this.instance.toggleFullscreen();if(y.fancyboxToggleSlideshow!==void 0){n.preventDefault(),n.stopPropagation();const d=(s=c.carousel)===null||s===void 0?void 0:s.plugins.Autoplay;let u=d.isActive;return p&&p.panMode==="mousemove"&&!u&&p.reset(),void(u?d.stop():d.start())}const T=y.panzoomAction,C=y.panzoomChange;if((C||T)&&(n.preventDefault(),n.stopPropagation()),C){let d={};try{d=JSON.parse(C)}catch{}p&&p.applyChange(d)}else T&&p&&p[T]&&p[T]()}onChange(){this.onRefresh()}onRefresh(){if(this.instance.isClosing())return;const n=this.container;if(!n)return;const r=this.instance.getSlide();if(!r||r.state!==At.Ready)return;const s=r&&!r.error&&r.panzoom;for(const p of n.querySelectorAll("[data-panzoom-action]"))s?(p.removeAttribute("disabled"),p.removeAttribute("tabindex")):(p.setAttribute("disabled",""),p.setAttribute("tabindex","-1"));let c=s&&s.canZoomIn(),h=s&&s.canZoomOut();for(const p of n.querySelectorAll('[data-panzoom-action="zoomIn"]'))c?(p.removeAttribute("disabled"),p.removeAttribute("tabindex")):(p.setAttribute("disabled",""),p.setAttribute("tabindex","-1"));for(const p of n.querySelectorAll('[data-panzoom-action="zoomOut"]'))h?(p.removeAttribute("disabled"),p.removeAttribute("tabindex")):(p.setAttribute("disabled",""),p.setAttribute("tabindex","-1"));for(const p of n.querySelectorAll('[data-panzoom-action="toggleZoom"],[data-panzoom-action="iterateZoom"]')){h||c?(p.removeAttribute("disabled"),p.removeAttribute("tabindex")):(p.setAttribute("disabled",""),p.setAttribute("tabindex","-1"));const f=p.querySelector("g");f&&(f.style.display=c?"":"none")}}onDone(n,r){var s;(s=r.panzoom)===null||s===void 0||s.on("afterTransform",()=>{this.instance.isCurrentSlide(r)&&this.onRefresh()}),this.instance.isCurrentSlide(r)&&this.onRefresh()}createContainer(){const n=this.instance.container;if(!n)return null;const r=this.option("parentEl")||n;let s=r.querySelector("."+fr);return s||(s=document.createElement("div"),Ae(s,fr),r.prepend(s)),s.addEventListener("click",this.onClick,{passive:!1,capture:!0}),n&&Ae(n,Aa),this.container=s,s}createEl(n){const r=this.instance,s=r.carousel;if(!s||n==="toggleFS"||n==="fullscreen"&&!ro())return null;let c=null;const h=s.slides.length||0;let p=0,f=0;for(const T of s.slides)(T.panzoom||T.type==="image")&&p++,(T.type==="image"||T.downloadSrc)&&f++;if(h<2&&["infobar","prev","next"].includes(n))return c;if(dr[n]!==void 0&&!p||n==="download"&&!f)return null;if(n==="thumbs"){const T=r.plugins.Thumbs;if(!T||!T.isEnabled)return null}if(n==="slideshow"&&(!s.plugins.Autoplay||h<2))return null;if(dr[n]!==void 0){const T=dr[n];c=document.createElement("button"),c.setAttribute("title",this.instance.localize(`{{${n.toUpperCase()}}}`)),Ae(c,"f-button"),T.action&&(c.dataset.panzoomAction=T.action),T.change&&(c.dataset.panzoomChange=JSON.stringify(T.change)),c.appendChild(en(this.instance.localize(T.icon)))}else{const T=(this.option("items")||[])[n];T&&(c=en(this.instance.localize(T.tpl)),typeof T.click=="function"&&c.addEventListener("click",C=>{C.preventDefault(),C.stopPropagation(),typeof T.click=="function"&&T.click.call(this,this,C)}))}const y=c==null?void 0:c.querySelector("svg");if(y)for(const[T,C]of Object.entries(Yl))y.getAttribute(T)||y.setAttribute(T,String(C));return c}removeContainer(){const n=this.container;n&&n.remove(),this.container=null,this.state=kn.Disabled;const r=this.instance.container;r&&Je(r,Aa)}attach(){const n=this,r=n.instance;r.on("Carousel.initSlides",n.onReady),r.on("done",n.onDone),r.on(["reveal","Carousel.change"],n.onChange),n.onReady(n.instance)}detach(){const n=this,r=n.instance;r.off("Carousel.initSlides",n.onReady),r.off("done",n.onDone),r.off(["reveal","Carousel.change"],n.onChange),n.removeContainer()}}Object.defineProperty(vo,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:Wl});const Kl={Hash:class extends Zt{onReady(){Qn=!1}onChange(k){Sn&&clearTimeout(Sn);const{hash:n}=ao(),{hash:r}=ji(),s=k.isOpeningSlide(k.getSlide());s&&(Ca=r===n?"":r),n&&n!==r&&(Sn=setTimeout(()=>{try{if(k.state===kt.Ready){let c="replaceState";s&&!ki&&(c="pushState",ki=!0),window.history[c]({},document.title,window.location.pathname+window.location.search+n)}}catch{}},300))}onClose(k){if(Sn&&clearTimeout(Sn),!Qn&&ki)return ki=!1,Qn=!1,void window.history.back();if(!Qn)try{window.history.replaceState({},document.title,window.location.pathname+window.location.search+(Ca||""))}catch{}}attach(){const k=this.instance;k.on("ready",this.onReady),k.on(["Carousel.ready","Carousel.change"],this.onChange),k.on("close",this.onClose)}detach(){const k=this.instance;k.off("ready",this.onReady),k.off(["Carousel.ready","Carousel.change"],this.onChange),k.off("close",this.onClose)}static parseURL(){return ji()}static startFromUrl(){oo()}static destroy(){window.removeEventListener("hashchange",lo,!1)}},Html:uo,Images:co,Slideshow:ho,Thumbs:go,Toolbar:vo},Da="with-fancybox",hr="hide-scrollbar",Oa="--fancybox-scrollbar-compensate",Pa="--fancybox-body-margin",pr="aria-hidden",mr="is-using-tab",gr="is-animated",Ra="is-compact",Ia="is-loading",vr="is-opening",Li="has-caption",In="disabled",bn="tabindex",Ha="download",yr="href",Hn="src",hn=k=>typeof k=="string",Na=function(){var k=window.getSelection();return!!k&&k.type==="Range"};let Ft,Ut=null,wn=null,ja=0,Ba=0,za=0,$a=0;const Nn=new Map;let Gl=0;class Xe extends _r{get isIdle(){return this.idle}get isCompact(){return this.option("compact")}constructor(n=[],r={},s={}){super(r),Object.defineProperty(this,"userSlides",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"userPlugins",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"idle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"idleTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"clickTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"pwt",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"ignoreFocusChange",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"startedFs",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:kt.Init}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"footer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"carousel",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"lastFocus",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"prevMouseMoveEvent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Ft||(Ft=ro()),this.id=r.id||++Gl,Nn.set(this.id,this),this.userSlides=n,this.userPlugins=s,queueMicrotask(()=>{this.init()})}init(){if(this.state===kt.Destroy)return;this.state=kt.Init,this.attachPlugins(Object.assign(Object.assign({},Xe.Plugins),this.userPlugins)),this.emit("init"),this.emit("attachPlugins"),this.option("hideScrollbar")===!0&&(()=>{if(!ti)return;const r=document,s=r.body,c=r.documentElement;if(s.classList.contains(hr))return;let h=window.innerWidth-c.getBoundingClientRect().width;const p=parseFloat(window.getComputedStyle(s).marginRight);h<0&&(h=0),c.style.setProperty(Oa,`${h}px`),p&&s.style.setProperty(Pa,`${p}px`),s.classList.add(hr)})(),this.initLayout(),this.scale();const n=()=>{this.initCarousel(this.userSlides),this.state=kt.Ready,this.attachEvents(),this.emit("ready"),setTimeout(()=>{this.container&&this.container.setAttribute(pr,"false")},16)};this.option("Fullscreen.autoStart")&&Ft&&!Ft.isFullscreen()?Ft.request().then(()=>{this.startedFs=!0,n()}).catch(()=>n()):n()}initLayout(){var n,r;const s=this.option("parentEl")||document.body,c=en(this.localize(this.option("tpl.main")||""));if(c){if(c.setAttribute("id",`fancybox-${this.id}`),c.setAttribute("aria-label",this.localize("{{MODAL}}")),c.classList.toggle(Ra,this.isCompact),Ae(c,this.option("mainClass")||""),Ae(c,vr),this.container=c,this.footer=c.querySelector(".fancybox__footer"),s.appendChild(c),Ae(document.documentElement,Da),Ut&&wn||(Ut=document.createElement("span"),Ae(Ut,"fancybox-focus-guard"),Ut.setAttribute(bn,"0"),Ut.setAttribute(pr,"true"),Ut.setAttribute("aria-label","Focus guard"),wn=Ut.cloneNode(),(n=c.parentElement)===null||n===void 0||n.insertBefore(Ut,c),(r=c.parentElement)===null||r===void 0||r.append(wn)),c.addEventListener("mousedown",h=>{ja=h.pageX,Ba=h.pageY,Je(c,mr)}),this.option("closeExisting"))for(const h of Nn.values())h.id!==this.id&&h.close();else this.option("animated")&&(Ae(c,gr),setTimeout(()=>{this.isClosing()||Je(c,gr)},350));this.emit("initLayout")}}initCarousel(n){const r=this.container;if(!r)return;const s=r.querySelector(".fancybox__carousel");if(!s)return;const c=this.carousel=new Tn(s,Nt({},{slides:n,transition:"fade",Panzoom:{lockAxis:this.option("dragToClose")?"xy":"x",infinite:!!this.option("dragToClose")&&"y"},Dots:!1,Navigation:{classes:{container:"fancybox__nav",button:"f-button",isNext:"is-next",isPrev:"is-prev"}},initialPage:this.option("startIndex"),l10n:this.option("l10n")},this.option("Carousel")||{}));c.on("*",(h,p,...f)=>{this.emit(`Carousel.${p}`,h,...f)}),c.on(["ready","change"],()=>{this.manageCaption()}),this.on("Carousel.removeSlide",(h,p,f)=>{this.clearContent(f),f.state=void 0}),c.on("Panzoom.touchStart",()=>{var h,p;this.isCompact||this.endIdle(),!((h=document.activeElement)===null||h===void 0)&&h.closest(".f-thumbs")&&((p=this.container)===null||p===void 0||p.focus())}),c.on("settle",()=>{this.idleTimer||this.isCompact||!this.option("idle")||this.setIdle(),this.option("autoFocus")&&!this.isClosing&&this.checkFocus()}),this.option("dragToClose")&&(c.on("Panzoom.afterTransform",(h,p)=>{const f=this.getSlide();if(f&&wr(f.el))return;const y=this.container;if(y){const T=Math.abs(p.current.f),C=T<1?"":Math.max(.5,Math.min(1,1-T/p.contentRect.fitHeight*1.5));y.style.setProperty("--fancybox-ts",C?"0s":""),y.style.setProperty("--fancybox-opacity",C+"")}}),c.on("Panzoom.touchEnd",(h,p,f)=>{var y;const T=this.getSlide();if(T&&wr(T.el)||p.isMobile&&document.activeElement&&["TEXTAREA","INPUT"].indexOf((y=document.activeElement)===null||y===void 0?void 0:y.nodeName)!==-1)return;const C=Math.abs(p.dragOffset.y);p.lockedAxis==="y"&&(C>=200||C>=50&&p.dragOffset.time<300)&&(f&&f.cancelable&&f.preventDefault(),this.close(f,"f-throwOut"+(p.current.f<0?"Up":"Down")))})),c.on("change",h=>{var p;let f=(p=this.getSlide())===null||p===void 0?void 0:p.triggerEl;if(f){const y=new CustomEvent("slideTo",{bubbles:!0,cancelable:!0,detail:h.page});f.dispatchEvent(y)}}),c.on(["refresh","change"],h=>{const p=this.container;if(!p)return;for(const T of p.querySelectorAll("[data-fancybox-current-index]"))T.innerHTML=h.page+1;for(const T of p.querySelectorAll("[data-fancybox-count]"))T.innerHTML=h.pages.length;if(!h.isInfinite){for(const T of p.querySelectorAll("[data-fancybox-next]"))h.page<h.pages.length-1?(T.removeAttribute(In),T.removeAttribute(bn)):(T.setAttribute(In,""),T.setAttribute(bn,"-1"));for(const T of p.querySelectorAll("[data-fancybox-prev]"))h.page>0?(T.removeAttribute(In),T.removeAttribute(bn)):(T.setAttribute(In,""),T.setAttribute(bn,"-1"))}const f=this.getSlide();if(!f)return;let y=f.downloadSrc||"";y||f.type!=="image"||f.error||!hn(f[Hn])||(y=f[Hn]);for(const T of p.querySelectorAll("[data-fancybox-download]")){const C=f.downloadFilename;y?(T.removeAttribute(In),T.removeAttribute(bn),T.setAttribute(yr,y),T.setAttribute(Ha,C||y),T.setAttribute("target","_blank")):(T.setAttribute(In,""),T.setAttribute(bn,"-1"),T.removeAttribute(yr),T.removeAttribute(Ha))}}),this.emit("initCarousel")}attachEvents(){const n=this,r=n.container;if(!r)return;r.addEventListener("click",n.onClick,{passive:!1,capture:!1}),r.addEventListener("wheel",n.onWheel,{passive:!1,capture:!1}),document.addEventListener("keydown",n.onKeydown,{passive:!1,capture:!0}),document.addEventListener("visibilitychange",n.onVisibilityChange,!1),document.addEventListener("mousemove",n.onMousemove),n.option("trapFocus")&&document.addEventListener("focus",n.onFocus,!0),window.addEventListener("resize",n.onResize);const s=window.visualViewport;s&&(s.addEventListener("scroll",n.onResize),s.addEventListener("resize",n.onResize))}detachEvents(){const n=this,r=n.container;if(!r)return;document.removeEventListener("keydown",n.onKeydown,{passive:!1,capture:!0}),r.removeEventListener("wheel",n.onWheel,{passive:!1,capture:!1}),r.removeEventListener("click",n.onClick,{passive:!1,capture:!1}),document.removeEventListener("mousemove",n.onMousemove),window.removeEventListener("resize",n.onResize);const s=window.visualViewport;s&&(s.removeEventListener("resize",n.onResize),s.removeEventListener("scroll",n.onResize)),document.removeEventListener("visibilitychange",n.onVisibilityChange,!1),document.removeEventListener("focus",n.onFocus,!0)}scale(){const n=this.container;if(!n)return;const r=window.visualViewport,s=Math.max(1,(r==null?void 0:r.scale)||1);let c="",h="",p="";if(r&&s>1){let f=`${r.offsetLeft}px`,y=`${r.offsetTop}px`;c=r.width*s+"px",h=r.height*s+"px",p=`translate3d(${f}, ${y}, 0) scale(${1/s})`}n.style.transform=p,n.style.width=c,n.style.height=h}onClick(n){var r;const{container:s,isCompact:c}=this;if(!s||this.isClosing())return;!c&&this.option("idle")&&this.resetIdle();const h=n.composedPath()[0];if(h.closest(".fancybox-spinner")||h.closest("[data-fancybox-close]"))return n.preventDefault(),void this.close(n);if(h.closest("[data-fancybox-prev]"))return n.preventDefault(),void this.prev();if(h.closest("[data-fancybox-next]"))return n.preventDefault(),void this.next();if(n.type==="click"&&n.detail===0||Math.abs(n.pageX-ja)>30||Math.abs(n.pageY-Ba)>30)return;const p=document.activeElement;if(Na()&&p&&s.contains(p))return;if(c&&((r=this.getSlide())===null||r===void 0?void 0:r.type)==="image")return void(this.clickTimer?(clearTimeout(this.clickTimer),this.clickTimer=null):this.clickTimer=setTimeout(()=>{this.toggleIdle(),this.clickTimer=null},350));if(this.emit("click",n),n.defaultPrevented)return;let f=!1;if(h.closest(".fancybox__content")){if(p){if(p.closest("[contenteditable]"))return;h.matches(lr)||p.blur()}if(Na())return;f=this.option("contentClick")}else h.closest(".fancybox__carousel")&&!h.matches(lr)&&(f=this.option("backdropClick"));f==="close"?(n.preventDefault(),this.close(n)):f==="next"?(n.preventDefault(),this.next()):f==="prev"&&(n.preventDefault(),this.prev())}onWheel(n){const r=n.target;let s=this.option("wheel",n);r.closest(".fancybox__thumbs")&&(s="slide");const c=s==="slide",h=[-n.deltaX||0,-n.deltaY||0,-n.detail||0].reduce(function(y,T){return Math.abs(T)>Math.abs(y)?T:y}),p=Math.max(-1,Math.min(1,h)),f=Date.now();this.pwt&&f-this.pwt<300?c&&n.preventDefault():(this.pwt=f,this.emit("wheel",n,p),n.defaultPrevented||(s==="close"?(n.preventDefault(),this.close(n)):s==="slide"&&(Hi(r)||(n.preventDefault(),this[p>0?"prev":"next"]()))))}onScroll(){window.scrollTo(za,$a)}onKeydown(n){if(!this.isTopmost())return;this.isCompact||!this.option("idle")||this.isClosing()||this.resetIdle();const r=n.key,s=this.option("keyboard");if(!s)return;const c=n.composedPath()[0],h=document.activeElement&&document.activeElement.classList,p=h&&h.contains("f-button")||c.dataset.carouselPage||c.dataset.carouselIndex;if(r!=="Escape"&&!p&&It(c)&&(c.isContentEditable||["TEXTAREA","OPTION","INPUT","SELECT","VIDEO"].indexOf(c.nodeName)!==-1)||(n.key==="Tab"?Ae(this.container,mr):Je(this.container,mr),n.ctrlKey||n.altKey||n.shiftKey))return;this.emit("keydown",r,n);const f=s[r];f&&typeof this[f]=="function"&&(n.preventDefault(),this[f]())}onResize(){const n=this.container;if(!n)return;const r=this.isCompact;n.classList.toggle(Ra,r),this.manageCaption(this.getSlide()),this.isCompact?this.clearIdle():this.endIdle(),this.scale(),this.emit("resize")}onFocus(n){this.isTopmost()&&this.checkFocus(n)}onMousemove(n){this.prevMouseMoveEvent=n,!this.isCompact&&this.option("idle")&&this.resetIdle()}onVisibilityChange(){document.visibilityState==="visible"?this.checkFocus():this.endIdle()}manageCloseBtn(n){const r=this.optionFor(n,"closeButton")||!1;if(r==="auto"){const c=this.plugins.Toolbar;if(c&&c.state===kn.Ready)return}if(!r||!n.contentEl||n.closeBtnEl)return;const s=this.option("tpl.closeButton");if(s){const c=en(this.localize(s));n.closeBtnEl=n.contentEl.appendChild(c),n.el&&Ae(n.el,"has-close-btn")}}manageCaption(n=void 0){var r,s;const c="fancybox__caption",h=this.container;if(!h)return;Je(h,Li);const p=this.isCompact||this.option("commonCaption"),f=!p;if(this.caption&&this.stop(this.caption),f&&this.caption&&(this.caption.remove(),this.caption=null),p&&!this.caption)for(const d of((r=this.carousel)===null||r===void 0?void 0:r.slides)||[])d.captionEl&&(d.captionEl.remove(),d.captionEl=void 0,Je(d.el,Li),(s=d.el)===null||s===void 0||s.removeAttribute("aria-labelledby"));if(n||(n=this.getSlide()),!n||p&&!this.isCurrentSlide(n))return;const y=n.el;let T=this.optionFor(n,"caption","");if(!T)return void(p&&this.caption&&this.animate(this.caption,"f-fadeOut",()=>{this.caption&&(this.caption.innerHTML="")}));let C=null;if(f){if(C=n.captionEl||null,y&&!C){const d=c+`_${this.id}_${n.index}`;C=document.createElement("div"),Ae(C,c),C.setAttribute("id",d),n.captionEl=y.appendChild(C),Ae(y,Li),y.setAttribute("aria-labelledby",d)}}else C=this.caption,C||(C=h.querySelector("."+c)),!C&&(C=document.createElement("div"),C.dataset.fancyboxCaption="",Ae(C,c),(this.footer||h).prepend(C)),Ae(h,Li),this.caption=C;C&&(C.innerHTML="",hn(T)||typeof T=="number"?C.innerHTML=T+"":T instanceof HTMLElement&&C.appendChild(T))}checkFocus(n){this.focus(n)}focus(n){var r;if(this.ignoreFocusChange)return;const s=document.activeElement||null,c=(n==null?void 0:n.target)||null,h=this.container,p=(r=this.carousel)===null||r===void 0?void 0:r.viewport;if(!h||!p||!n&&s&&h.contains(s))return;const f=this.getSlide(),y=f&&f.state===At.Ready?f.el:null;if(!y||y.contains(s)||h===s)return;n&&n.cancelable&&n.preventDefault(),this.ignoreFocusChange=!0;const T=Array.from(h.querySelectorAll(lr));let C=[],d=null;for(let m of T){const g=!m.offsetParent||!!m.closest('[aria-hidden="true"]'),w=y&&y.contains(m),b=!p.contains(m);if(m===h||(w||b)&&!g){C.push(m);const S=m.dataset.origTabindex;S!==void 0&&S&&(m.tabIndex=parseFloat(S)),m.removeAttribute("data-orig-tabindex"),!m.hasAttribute("autoFocus")&&d||(d=m)}else{const S=m.dataset.origTabindex===void 0?m.getAttribute("tabindex")||"":m.dataset.origTabindex;S&&(m.dataset.origTabindex=S),m.tabIndex=-1}}let u=null;n?(!c||C.indexOf(c)<0)&&(u=d||h,C.length&&(s===wn?u=C[0]:this.lastFocus!==h&&s!==Ut||(u=C[C.length-1]))):u=f&&f.type==="image"?h:d||h,u&&Sa(u),this.lastFocus=document.activeElement,this.ignoreFocusChange=!1}next(){const n=this.carousel;n&&n.pages.length>1&&n.slideNext()}prev(){const n=this.carousel;n&&n.pages.length>1&&n.slidePrev()}jumpTo(...n){this.carousel&&this.carousel.slideTo(...n)}isTopmost(){var n;return((n=Xe.getInstance())===null||n===void 0?void 0:n.id)==this.id}animate(n=null,r="",s){if(!n||!r)return void(s&&s());this.stop(n);const c=h=>{h.target===n&&n.dataset.animationName&&(n.removeEventListener("animationend",c),delete n.dataset.animationName,s&&s(),Je(n,r))};n.dataset.animationName=r,n.addEventListener("animationend",c),Ae(n,r)}stop(n){n&&n.dispatchEvent(new CustomEvent("animationend",{bubbles:!1,cancelable:!0,currentTarget:n}))}setContent(n,r="",s=!0){if(this.isClosing())return;const c=n.el;if(!c)return;let h=null;if(It(r)?h=r:(h=en(r+""),It(h)||(h=document.createElement("div"),h.innerHTML=r+"")),["img","picture","iframe","video","audio"].includes(h.nodeName.toLowerCase())){const p=document.createElement("div");p.appendChild(h),h=p}It(h)&&n.filter&&!n.error&&(h=h.querySelector(n.filter)),h&&It(h)?(Ae(h,"fancybox__content"),n.id&&h.setAttribute("id",n.id),c.classList.add(`has-${n.error?"error":n.type||"unknown"}`),c.prepend(h),h.style.display==="none"&&(h.style.display=""),getComputedStyle(h).getPropertyValue("display")==="none"&&(h.style.display=n.display||this.option("defaultDisplay")||"flex"),n.contentEl=h,s&&this.revealContent(n),this.manageCloseBtn(n),this.manageCaption(n)):this.setError(n,"{{ELEMENT_NOT_FOUND}}")}revealContent(n,r){const s=n.el,c=n.contentEl;s&&c&&(this.emit("reveal",n),this.hideLoading(n),n.state=At.Opening,(r=this.isOpeningSlide(n)?r===void 0?this.optionFor(n,"showClass"):r:"f-fadeIn")?this.animate(c,r,()=>{this.done(n)}):this.done(n))}done(n){this.isClosing()||(n.state=At.Ready,this.emit("done",n),Ae(n.el,"is-done"),this.isCurrentSlide(n)&&this.option("autoFocus")&&queueMicrotask(()=>{var r;(r=n.panzoom)===null||r===void 0||r.updateControls(),this.option("autoFocus")&&this.focus()}),this.isOpeningSlide(n)&&(Je(this.container,vr),!this.isCompact&&this.option("idle")&&this.setIdle()))}isCurrentSlide(n){const r=this.getSlide();return!(!n||!r)&&r.index===n.index}isOpeningSlide(n){var r,s;return((r=this.carousel)===null||r===void 0?void 0:r.prevPage)===null&&n&&n.index===((s=this.getSlide())===null||s===void 0?void 0:s.index)}showLoading(n){n.state=At.Loading;const r=n.el;r&&(Ae(r,Ia),this.emit("loading",n),n.spinnerEl||setTimeout(()=>{if(!this.isClosing()&&!n.spinnerEl&&n.state===At.Loading){let s=en(Mr);Ae(s,"fancybox-spinner"),n.spinnerEl=s,r.prepend(s),this.animate(s,"f-fadeIn")}},250))}hideLoading(n){const r=n.el;if(!r)return;const s=n.spinnerEl;this.isClosing()?s==null||s.remove():(Je(r,Ia),s&&this.animate(s,"f-fadeOut",()=>{s.remove()}),n.state===At.Loading&&(this.emit("loaded",n),n.state=At.Ready))}setError(n,r){if(this.isClosing())return;const s=new Event("error",{bubbles:!0,cancelable:!0});if(this.emit("error",s,n),s.defaultPrevented)return;n.error=r,this.hideLoading(n),this.clearContent(n);const c=document.createElement("div");c.classList.add("fancybox-error"),c.innerHTML=this.localize(r||"<p>{{ERROR}}</p>"),this.setContent(n,c)}clearContent(n){if(n.state===void 0)return;this.emit("clearContent",n),n.contentEl&&(n.contentEl.remove(),n.contentEl=void 0);const r=n.el;r&&(Je(r,"has-error"),Je(r,"has-unknown"),Je(r,`has-${n.type||"unknown"}`)),n.closeBtnEl&&n.closeBtnEl.remove(),n.closeBtnEl=void 0,n.captionEl&&n.captionEl.remove(),n.captionEl=void 0,n.spinnerEl&&n.spinnerEl.remove(),n.spinnerEl=void 0}getSlide(){var n;const r=this.carousel;return((n=r==null?void 0:r.pages[r==null?void 0:r.page])===null||n===void 0?void 0:n.slides[0])||void 0}close(n,r){if(this.isClosing())return;const s=new Event("shouldClose",{bubbles:!0,cancelable:!0});if(this.emit("shouldClose",s,n),s.defaultPrevented)return;n&&n.cancelable&&(n.preventDefault(),n.stopPropagation());const c=()=>{this.proceedClose(n,r)};this.startedFs&&Ft&&Ft.isFullscreen()?Promise.resolve(Ft.exit()).then(()=>c()):c()}clearIdle(){this.idleTimer&&clearTimeout(this.idleTimer),this.idleTimer=null}setIdle(n=!1){const r=()=>{this.clearIdle(),this.idle=!0,Ae(this.container,"is-idle"),this.emit("setIdle")};if(this.clearIdle(),!this.isClosing())if(n)r();else{const s=this.option("idle");s&&(this.idleTimer=setTimeout(r,s))}}endIdle(){this.clearIdle(),this.idle&&!this.isClosing()&&(this.idle=!1,Je(this.container,"is-idle"),this.emit("endIdle"))}resetIdle(){this.endIdle(),this.setIdle()}toggleIdle(){this.idle?this.endIdle():this.setIdle(!0)}toggleFullscreen(){Ft&&(Ft.isFullscreen()?Ft.exit():Ft.request().then(()=>{this.startedFs=!0}))}isClosing(){return[kt.Closing,kt.CustomClosing,kt.Destroy].includes(this.state)}proceedClose(n,r){var s,c;this.state=kt.Closing,this.clearIdle(),this.detachEvents();const h=this.container,p=this.carousel,f=this.getSlide(),y=f&&this.option("placeFocusBack")?f.triggerEl||this.option("triggerEl"):null;if(y&&(io(y)?Sa(y):y.focus()),h&&(Je(h,vr),Ae(h,"is-closing"),h.setAttribute(pr,"true"),this.option("animated")&&Ae(h,gr),h.style.pointerEvents="none"),p){p.clearTransitions(),(s=p.panzoom)===null||s===void 0||s.destroy(),(c=p.plugins.Navigation)===null||c===void 0||c.detach();for(const T of p.slides){T.state=At.Closing,this.hideLoading(T);const C=T.contentEl;C&&this.stop(C);const d=T==null?void 0:T.panzoom;d&&(d.stop(),d.detachEvents(),d.detachObserver()),this.isCurrentSlide(T)||p.emit("removeSlide",T)}}za=window.scrollX,$a=window.scrollY,window.addEventListener("scroll",this.onScroll),this.emit("close",n),this.state!==kt.CustomClosing?(r===void 0&&f&&(r=this.optionFor(f,"hideClass")),r&&f?(this.animate(f.contentEl,r,()=>{p&&p.emit("removeSlide",f)}),setTimeout(()=>{this.destroy()},500)):this.destroy()):setTimeout(()=>{this.destroy()},500)}destroy(){var n;if(this.state===kt.Destroy)return;window.removeEventListener("scroll",this.onScroll),this.state=kt.Destroy,(n=this.carousel)===null||n===void 0||n.destroy();const r=this.container;r&&r.remove(),Nn.delete(this.id);const s=Xe.getInstance();s?s.focus():(Ut&&(Ut.remove(),Ut=null),wn&&(wn.remove(),wn=null),Je(document.documentElement,Da),(()=>{if(!ti)return;const c=document,h=c.body;h.classList.remove(hr),h.style.setProperty(Pa,""),c.documentElement.style.setProperty(Oa,"")})(),this.emit("destroy"))}static bind(n,r,s){if(!ti)return;let c,h="",p={};if(n===void 0?c=document.body:hn(n)?(c=document.body,h=n,typeof r=="object"&&(p=r||{})):(c=n,hn(r)&&(h=r),typeof s=="object"&&(p=s||{})),!c||!It(c))return;h=h||"[data-fancybox]";const f=Xe.openers.get(c)||new Map;f.set(h,p),Xe.openers.set(c,f),f.size===1&&c.addEventListener("click",Xe.fromEvent)}static unbind(n,r){let s,c="";if(hn(n)?(s=document.body,c=n):(s=n,hn(r)&&(c=r)),!s)return;const h=Xe.openers.get(s);h&&c&&h.delete(c),c&&h||(Xe.openers.delete(s),s.removeEventListener("click",Xe.fromEvent))}static destroy(){let n;for(;n=Xe.getInstance();)n.destroy();for(const r of Xe.openers.keys())r.removeEventListener("click",Xe.fromEvent);Xe.openers=new Map}static fromEvent(n){if(n.defaultPrevented||n.button&&n.button!==0||n.ctrlKey||n.metaKey||n.shiftKey)return;let r=n.composedPath()[0];const s=r.closest("[data-fancybox-trigger]");if(s){const g=s.dataset.fancyboxTrigger||"",w=document.querySelectorAll(`[data-fancybox="${g}"]`),b=parseInt(s.dataset.fancyboxIndex||"",10)||0;r=w[b]||r}if(!(r&&r instanceof Element))return;let c,h,p,f;if([...Xe.openers].reverse().find(([g,w])=>!(!g.contains(r)||![...w].reverse().find(([b,S])=>{let _=r.closest(b);return!!_&&(c=g,h=b,p=_,f=S,!0)}))),!c||!h||!p)return;f=f||{},n.preventDefault(),r=p;let y=[],T=Nt({},Sr,f);T.event=n,T.triggerEl=r,T.delegate=s;const C=T.groupAll,d=T.groupAttr,u=d&&r?r.getAttribute(`${d}`):"";if((!r||u||C)&&(y=[].slice.call(c.querySelectorAll(h))),r&&!C&&(y=u?y.filter(g=>g.getAttribute(`${d}`)===u):[r]),!y.length)return;const m=Xe.getInstance();return m&&m.options.triggerEl&&y.indexOf(m.options.triggerEl)>-1?void 0:(r&&(T.startIndex=y.indexOf(r)),Xe.fromNodes(y,T))}static fromSelector(n,r,s){let c=null,h="",p={};if(hn(n)?(c=document.body,h=n,typeof r=="object"&&(p=r||{})):n instanceof HTMLElement&&hn(r)&&(c=n,h=r,typeof s=="object"&&(p=s||{})),!c||!h)return!1;const f=Xe.openers.get(c);return!!f&&(p=Nt({},f.get(h)||{},p),!!p&&Xe.fromNodes(Array.from(c.querySelectorAll(h)),p))}static fromNodes(n,r){r=Nt({},Sr,r||{});const s=[];for(const c of n){const h=c.dataset||{},p=h[Hn]||c.getAttribute(yr)||c.getAttribute("currentSrc")||c.getAttribute(Hn)||void 0;let f;const y=r.delegate;let T;y&&s.length===r.startIndex&&(f=y instanceof HTMLImageElement?y:y.querySelector("img:not([aria-hidden])")),f||(f=c instanceof HTMLImageElement?c:c.querySelector("img:not([aria-hidden])")),f&&(T=f.currentSrc||f[Hn]||void 0,!T&&f.dataset&&(T=f.dataset.lazySrc||f.dataset[Hn]||void 0));const C={src:p,triggerEl:c,thumbEl:f,thumbElSrc:T,thumbSrc:T};for(const d in h){let u=h[d]+"";u=u!=="false"&&(u==="true"||u),C[d]=u}s.push(C)}return new Xe(s,r)}static getInstance(n){return n?Nn.get(n):Array.from(Nn.values()).reverse().find(r=>!r.isClosing()&&r)||null}static getSlide(){var n;return((n=Xe.getInstance())===null||n===void 0?void 0:n.getSlide())||null}static show(n=[],r={}){return new Xe(n,r)}static next(){const n=Xe.getInstance();n&&n.next()}static prev(){const n=Xe.getInstance();n&&n.prev()}static close(n=!0,...r){if(n)for(const s of Nn.values())s.close(...r);else{const s=Xe.getInstance();s&&s.close(...r)}}}Object.defineProperty(Xe,"version",{enumerable:!0,configurable:!0,writable:!0,value:"5.0.36"}),Object.defineProperty(Xe,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:Sr}),Object.defineProperty(Xe,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:Kl}),Object.defineProperty(Xe,"openers",{enumerable:!0,configurable:!0,writable:!0,value:new Map});function Zl(k){return k&&k.__esModule&&Object.prototype.hasOwnProperty.call(k,"default")?k.default:k}var Ri={exports:{}};/*!
 * Vditor v3.10.9 - A markdown editor written in TypeScript.
 *
 * MIT License
 *
 * Copyright (c) 2018-present B3log 开源, b3log.org
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */var Xl=Ri.exports,Fa;function Jl(){return Fa||(Fa=1,function(k,n){(function(s,c){k.exports=c()})(Xl,()=>(()=>{var r={192:p=>{var f=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},y=-1,T=1,C=0;f.Diff=function(d,u){return[d,u]},f.prototype.diff_main=function(d,u,m,g){typeof g>"u"&&(this.Diff_Timeout<=0?g=Number.MAX_VALUE:g=new Date().getTime()+this.Diff_Timeout*1e3);var w=g;if(d==null||u==null)throw new Error("Null input. (diff_main)");if(d==u)return d?[new f.Diff(C,d)]:[];typeof m>"u"&&(m=!0);var b=m,S=this.diff_commonPrefix(d,u),_=d.substring(0,S);d=d.substring(S),u=u.substring(S),S=this.diff_commonSuffix(d,u);var M=d.substring(d.length-S);d=d.substring(0,d.length-S),u=u.substring(0,u.length-S);var x=this.diff_compute_(d,u,b,w);return _&&x.unshift(new f.Diff(C,_)),M&&x.push(new f.Diff(C,M)),this.diff_cleanupMerge(x),x},f.prototype.diff_compute_=function(d,u,m,g){var w;if(!d)return[new f.Diff(T,u)];if(!u)return[new f.Diff(y,d)];var b=d.length>u.length?d:u,S=d.length>u.length?u:d,_=b.indexOf(S);if(_!=-1)return w=[new f.Diff(T,b.substring(0,_)),new f.Diff(C,S),new f.Diff(T,b.substring(_+S.length))],d.length>u.length&&(w[0][0]=w[2][0]=y),w;if(S.length==1)return[new f.Diff(y,d),new f.Diff(T,u)];var M=this.diff_halfMatch_(d,u);if(M){var x=M[0],v=M[1],O=M[2],H=M[3],z=M[4],I=this.diff_main(x,O,m,g),R=this.diff_main(v,H,m,g);return I.concat([new f.Diff(C,z)],R)}return m&&d.length>100&&u.length>100?this.diff_lineMode_(d,u,g):this.diff_bisect_(d,u,g)},f.prototype.diff_lineMode_=function(d,u,m){var g=this.diff_linesToChars_(d,u);d=g.chars1,u=g.chars2;var w=g.lineArray,b=this.diff_main(d,u,!1,m);this.diff_charsToLines_(b,w),this.diff_cleanupSemantic(b),b.push(new f.Diff(C,""));for(var S=0,_=0,M=0,x="",v="";S<b.length;){switch(b[S][0]){case T:M++,v+=b[S][1];break;case y:_++,x+=b[S][1];break;case C:if(_>=1&&M>=1){b.splice(S-_-M,_+M),S=S-_-M;for(var O=this.diff_main(x,v,!1,m),H=O.length-1;H>=0;H--)b.splice(S,0,O[H]);S=S+O.length}M=0,_=0,x="",v="";break}S++}return b.pop(),b},f.prototype.diff_bisect_=function(d,u,m){for(var g=d.length,w=u.length,b=Math.ceil((g+w)/2),S=b,_=2*b,M=new Array(_),x=new Array(_),v=0;v<_;v++)M[v]=-1,x[v]=-1;M[S+1]=0,x[S+1]=0;for(var O=g-w,H=O%2!=0,z=0,I=0,R=0,N=0,V=0;V<b&&!(new Date().getTime()>m);V++){for(var se=-V+z;se<=V-I;se+=2){var ue=S+se,ke;se==-V||se!=V&&M[ue-1]<M[ue+1]?ke=M[ue+1]:ke=M[ue-1]+1;for(var Re=ke-se;ke<g&&Re<w&&d.charAt(ke)==u.charAt(Re);)ke++,Re++;if(M[ue]=ke,ke>g)I+=2;else if(Re>w)z+=2;else if(H){var _e=S+O-se;if(_e>=0&&_e<_&&x[_e]!=-1){var Te=g-x[_e];if(ke>=Te)return this.diff_bisectSplit_(d,u,ke,Re,m)}}}for(var Ne=-V+R;Ne<=V-N;Ne+=2){var _e=S+Ne,Te;Ne==-V||Ne!=V&&x[_e-1]<x[_e+1]?Te=x[_e+1]:Te=x[_e-1]+1;for(var Oe=Te-Ne;Te<g&&Oe<w&&d.charAt(g-Te-1)==u.charAt(w-Oe-1);)Te++,Oe++;if(x[_e]=Te,Te>g)N+=2;else if(Oe>w)R+=2;else if(!H){var ue=S+O-Ne;if(ue>=0&&ue<_&&M[ue]!=-1){var ke=M[ue],Re=S+ke-ue;if(Te=g-Te,ke>=Te)return this.diff_bisectSplit_(d,u,ke,Re,m)}}}}return[new f.Diff(y,d),new f.Diff(T,u)]},f.prototype.diff_bisectSplit_=function(d,u,m,g,w){var b=d.substring(0,m),S=u.substring(0,g),_=d.substring(m),M=u.substring(g),x=this.diff_main(b,S,!1,w),v=this.diff_main(_,M,!1,w);return x.concat(v)},f.prototype.diff_linesToChars_=function(d,u){var m=[],g={};m[0]="";function w(M){for(var x="",v=0,O=-1,H=m.length;O<M.length-1;){O=M.indexOf(`
`,v),O==-1&&(O=M.length-1);var z=M.substring(v,O+1);(g.hasOwnProperty?g.hasOwnProperty(z):g[z]!==void 0)?x+=String.fromCharCode(g[z]):(H==b&&(z=M.substring(v),O=M.length),x+=String.fromCharCode(H),g[z]=H,m[H++]=z),v=O+1}return x}var b=4e4,S=w(d);b=65535;var _=w(u);return{chars1:S,chars2:_,lineArray:m}},f.prototype.diff_charsToLines_=function(d,u){for(var m=0;m<d.length;m++){for(var g=d[m][1],w=[],b=0;b<g.length;b++)w[b]=u[g.charCodeAt(b)];d[m][1]=w.join("")}},f.prototype.diff_commonPrefix=function(d,u){if(!d||!u||d.charAt(0)!=u.charAt(0))return 0;for(var m=0,g=Math.min(d.length,u.length),w=g,b=0;m<w;)d.substring(b,w)==u.substring(b,w)?(m=w,b=m):g=w,w=Math.floor((g-m)/2+m);return w},f.prototype.diff_commonSuffix=function(d,u){if(!d||!u||d.charAt(d.length-1)!=u.charAt(u.length-1))return 0;for(var m=0,g=Math.min(d.length,u.length),w=g,b=0;m<w;)d.substring(d.length-w,d.length-b)==u.substring(u.length-w,u.length-b)?(m=w,b=m):g=w,w=Math.floor((g-m)/2+m);return w},f.prototype.diff_commonOverlap_=function(d,u){var m=d.length,g=u.length;if(m==0||g==0)return 0;m>g?d=d.substring(m-g):m<g&&(u=u.substring(0,m));var w=Math.min(m,g);if(d==u)return w;for(var b=0,S=1;;){var _=d.substring(w-S),M=u.indexOf(_);if(M==-1)return b;S+=M,(M==0||d.substring(w-S)==u.substring(0,S))&&(b=S,S++)}},f.prototype.diff_halfMatch_=function(d,u){if(this.Diff_Timeout<=0)return null;var m=d.length>u.length?d:u,g=d.length>u.length?u:d;if(m.length<4||g.length*2<m.length)return null;var w=this;function b(I,R,N){for(var V=I.substring(N,N+Math.floor(I.length/4)),se=-1,ue="",ke,Re,_e,Te;(se=R.indexOf(V,se+1))!=-1;){var Ne=w.diff_commonPrefix(I.substring(N),R.substring(se)),Oe=w.diff_commonSuffix(I.substring(0,N),R.substring(0,se));ue.length<Oe+Ne&&(ue=R.substring(se-Oe,se)+R.substring(se,se+Ne),ke=I.substring(0,N-Oe),Re=I.substring(N+Ne),_e=R.substring(0,se-Oe),Te=R.substring(se+Ne))}return ue.length*2>=I.length?[ke,Re,_e,Te,ue]:null}var S=b(m,g,Math.ceil(m.length/4)),_=b(m,g,Math.ceil(m.length/2)),M;if(!S&&!_)return null;_?S?M=S[4].length>_[4].length?S:_:M=_:M=S;var x,v,O,H;d.length>u.length?(x=M[0],v=M[1],O=M[2],H=M[3]):(O=M[0],H=M[1],x=M[2],v=M[3]);var z=M[4];return[x,v,O,H,z]},f.prototype.diff_cleanupSemantic=function(d){for(var u=!1,m=[],g=0,w=null,b=0,S=0,_=0,M=0,x=0;b<d.length;)d[b][0]==C?(m[g++]=b,S=M,_=x,M=0,x=0,w=d[b][1]):(d[b][0]==T?M+=d[b][1].length:x+=d[b][1].length,w&&w.length<=Math.max(S,_)&&w.length<=Math.max(M,x)&&(d.splice(m[g-1],0,new f.Diff(y,w)),d[m[g-1]+1][0]=T,g--,g--,b=g>0?m[g-1]:-1,S=0,_=0,M=0,x=0,w=null,u=!0)),b++;for(u&&this.diff_cleanupMerge(d),this.diff_cleanupSemanticLossless(d),b=1;b<d.length;){if(d[b-1][0]==y&&d[b][0]==T){var v=d[b-1][1],O=d[b][1],H=this.diff_commonOverlap_(v,O),z=this.diff_commonOverlap_(O,v);H>=z?(H>=v.length/2||H>=O.length/2)&&(d.splice(b,0,new f.Diff(C,O.substring(0,H))),d[b-1][1]=v.substring(0,v.length-H),d[b+1][1]=O.substring(H),b++):(z>=v.length/2||z>=O.length/2)&&(d.splice(b,0,new f.Diff(C,v.substring(0,z))),d[b-1][0]=T,d[b-1][1]=O.substring(0,O.length-z),d[b+1][0]=y,d[b+1][1]=v.substring(z),b++),b++}b++}},f.prototype.diff_cleanupSemanticLossless=function(d){function u(z,I){if(!z||!I)return 6;var R=z.charAt(z.length-1),N=I.charAt(0),V=R.match(f.nonAlphaNumericRegex_),se=N.match(f.nonAlphaNumericRegex_),ue=V&&R.match(f.whitespaceRegex_),ke=se&&N.match(f.whitespaceRegex_),Re=ue&&R.match(f.linebreakRegex_),_e=ke&&N.match(f.linebreakRegex_),Te=Re&&z.match(f.blanklineEndRegex_),Ne=_e&&I.match(f.blanklineStartRegex_);return Te||Ne?5:Re||_e?4:V&&!ue&&ke?3:ue||ke?2:V||se?1:0}for(var m=1;m<d.length-1;){if(d[m-1][0]==C&&d[m+1][0]==C){var g=d[m-1][1],w=d[m][1],b=d[m+1][1],S=this.diff_commonSuffix(g,w);if(S){var _=w.substring(w.length-S);g=g.substring(0,g.length-S),w=_+w.substring(0,w.length-S),b=_+b}for(var M=g,x=w,v=b,O=u(g,w)+u(w,b);w.charAt(0)===b.charAt(0);){g+=w.charAt(0),w=w.substring(1)+b.charAt(0),b=b.substring(1);var H=u(g,w)+u(w,b);H>=O&&(O=H,M=g,x=w,v=b)}d[m-1][1]!=M&&(M?d[m-1][1]=M:(d.splice(m-1,1),m--),d[m][1]=x,v?d[m+1][1]=v:(d.splice(m+1,1),m--))}m++}},f.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,f.whitespaceRegex_=/\s/,f.linebreakRegex_=/[\r\n]/,f.blanklineEndRegex_=/\n\r?\n$/,f.blanklineStartRegex_=/^\r?\n\r?\n/,f.prototype.diff_cleanupEfficiency=function(d){for(var u=!1,m=[],g=0,w=null,b=0,S=!1,_=!1,M=!1,x=!1;b<d.length;)d[b][0]==C?(d[b][1].length<this.Diff_EditCost&&(M||x)?(m[g++]=b,S=M,_=x,w=d[b][1]):(g=0,w=null),M=x=!1):(d[b][0]==y?x=!0:M=!0,w&&(S&&_&&M&&x||w.length<this.Diff_EditCost/2&&S+_+M+x==3)&&(d.splice(m[g-1],0,new f.Diff(y,w)),d[m[g-1]+1][0]=T,g--,w=null,S&&_?(M=x=!0,g=0):(g--,b=g>0?m[g-1]:-1,M=x=!1),u=!0)),b++;u&&this.diff_cleanupMerge(d)},f.prototype.diff_cleanupMerge=function(d){d.push(new f.Diff(C,""));for(var u=0,m=0,g=0,w="",b="",S;u<d.length;)switch(d[u][0]){case T:g++,b+=d[u][1],u++;break;case y:m++,w+=d[u][1],u++;break;case C:m+g>1?(m!==0&&g!==0&&(S=this.diff_commonPrefix(b,w),S!==0&&(u-m-g>0&&d[u-m-g-1][0]==C?d[u-m-g-1][1]+=b.substring(0,S):(d.splice(0,0,new f.Diff(C,b.substring(0,S))),u++),b=b.substring(S),w=w.substring(S)),S=this.diff_commonSuffix(b,w),S!==0&&(d[u][1]=b.substring(b.length-S)+d[u][1],b=b.substring(0,b.length-S),w=w.substring(0,w.length-S))),u-=m+g,d.splice(u,m+g),w.length&&(d.splice(u,0,new f.Diff(y,w)),u++),b.length&&(d.splice(u,0,new f.Diff(T,b)),u++),u++):u!==0&&d[u-1][0]==C?(d[u-1][1]+=d[u][1],d.splice(u,1)):u++,g=0,m=0,w="",b="";break}d[d.length-1][1]===""&&d.pop();var _=!1;for(u=1;u<d.length-1;)d[u-1][0]==C&&d[u+1][0]==C&&(d[u][1].substring(d[u][1].length-d[u-1][1].length)==d[u-1][1]?(d[u][1]=d[u-1][1]+d[u][1].substring(0,d[u][1].length-d[u-1][1].length),d[u+1][1]=d[u-1][1]+d[u+1][1],d.splice(u-1,1),_=!0):d[u][1].substring(0,d[u+1][1].length)==d[u+1][1]&&(d[u-1][1]+=d[u+1][1],d[u][1]=d[u][1].substring(d[u+1][1].length)+d[u+1][1],d.splice(u+1,1),_=!0)),u++;_&&this.diff_cleanupMerge(d)},f.prototype.diff_xIndex=function(d,u){var m=0,g=0,w=0,b=0,S;for(S=0;S<d.length&&(d[S][0]!==T&&(m+=d[S][1].length),d[S][0]!==y&&(g+=d[S][1].length),!(m>u));S++)w=m,b=g;return d.length!=S&&d[S][0]===y?b:b+(u-w)},f.prototype.diff_prettyHtml=function(d){for(var u=[],m=/&/g,g=/</g,w=/>/g,b=/\n/g,S=0;S<d.length;S++){var _=d[S][0],M=d[S][1],x=M.replace(m,"&amp;").replace(g,"&lt;").replace(w,"&gt;").replace(b,"&para;<br>");switch(_){case T:u[S]='<ins style="background:#e6ffe6;">'+x+"</ins>";break;case y:u[S]='<del style="background:#ffe6e6;">'+x+"</del>";break;case C:u[S]="<span>"+x+"</span>";break}}return u.join("")},f.prototype.diff_text1=function(d){for(var u=[],m=0;m<d.length;m++)d[m][0]!==T&&(u[m]=d[m][1]);return u.join("")},f.prototype.diff_text2=function(d){for(var u=[],m=0;m<d.length;m++)d[m][0]!==y&&(u[m]=d[m][1]);return u.join("")},f.prototype.diff_levenshtein=function(d){for(var u=0,m=0,g=0,w=0;w<d.length;w++){var b=d[w][0],S=d[w][1];switch(b){case T:m+=S.length;break;case y:g+=S.length;break;case C:u+=Math.max(m,g),m=0,g=0;break}}return u+=Math.max(m,g),u},f.prototype.diff_toDelta=function(d){for(var u=[],m=0;m<d.length;m++)switch(d[m][0]){case T:u[m]="+"+encodeURI(d[m][1]);break;case y:u[m]="-"+d[m][1].length;break;case C:u[m]="="+d[m][1].length;break}return u.join("	").replace(/%20/g," ")},f.prototype.diff_fromDelta=function(d,u){for(var m=[],g=0,w=0,b=u.split(/\t/g),S=0;S<b.length;S++){var _=b[S].substring(1);switch(b[S].charAt(0)){case"+":try{m[g++]=new f.Diff(T,decodeURI(_))}catch{throw new Error("Illegal escape in diff_fromDelta: "+_)}break;case"-":case"=":var M=parseInt(_,10);if(isNaN(M)||M<0)throw new Error("Invalid number in diff_fromDelta: "+_);var x=d.substring(w,w+=M);b[S].charAt(0)=="="?m[g++]=new f.Diff(C,x):m[g++]=new f.Diff(y,x);break;default:if(b[S])throw new Error("Invalid diff operation in diff_fromDelta: "+b[S])}}if(w!=d.length)throw new Error("Delta length ("+w+") does not equal source text length ("+d.length+").");return m},f.prototype.match_main=function(d,u,m){if(d==null||u==null||m==null)throw new Error("Null input. (match_main)");return m=Math.max(0,Math.min(m,d.length)),d==u?0:d.length?d.substring(m,m+u.length)==u?m:this.match_bitap_(d,u,m):-1},f.prototype.match_bitap_=function(d,u,m){if(u.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var g=this.match_alphabet_(u),w=this;function b(ke,Re){var _e=ke/u.length,Te=Math.abs(m-Re);return w.Match_Distance?_e+Te/w.Match_Distance:Te?1:_e}var S=this.Match_Threshold,_=d.indexOf(u,m);_!=-1&&(S=Math.min(b(0,_),S),_=d.lastIndexOf(u,m+u.length),_!=-1&&(S=Math.min(b(0,_),S)));var M=1<<u.length-1;_=-1;for(var x,v,O=u.length+d.length,H,z=0;z<u.length;z++){for(x=0,v=O;x<v;)b(z,m+v)<=S?x=v:O=v,v=Math.floor((O-x)/2+x);O=v;var I=Math.max(1,m-v+1),R=Math.min(m+v,d.length)+u.length,N=Array(R+2);N[R+1]=(1<<z)-1;for(var V=R;V>=I;V--){var se=g[d.charAt(V-1)];if(z===0?N[V]=(N[V+1]<<1|1)&se:N[V]=(N[V+1]<<1|1)&se|((H[V+1]|H[V])<<1|1)|H[V+1],N[V]&M){var ue=b(z,V-1);if(ue<=S)if(S=ue,_=V-1,_>m)I=Math.max(1,2*m-_);else break}}if(b(z+1,m)>S)break;H=N}return _},f.prototype.match_alphabet_=function(d){for(var u={},m=0;m<d.length;m++)u[d.charAt(m)]=0;for(var m=0;m<d.length;m++)u[d.charAt(m)]|=1<<d.length-m-1;return u},f.prototype.patch_addContext_=function(d,u){if(u.length!=0){if(d.start2===null)throw Error("patch not initialized");for(var m=u.substring(d.start2,d.start2+d.length1),g=0;u.indexOf(m)!=u.lastIndexOf(m)&&m.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)g+=this.Patch_Margin,m=u.substring(d.start2-g,d.start2+d.length1+g);g+=this.Patch_Margin;var w=u.substring(d.start2-g,d.start2);w&&d.diffs.unshift(new f.Diff(C,w));var b=u.substring(d.start2+d.length1,d.start2+d.length1+g);b&&d.diffs.push(new f.Diff(C,b)),d.start1-=w.length,d.start2-=w.length,d.length1+=w.length+b.length,d.length2+=w.length+b.length}},f.prototype.patch_make=function(d,u,m){var g,w;if(typeof d=="string"&&typeof u=="string"&&typeof m>"u")g=d,w=this.diff_main(g,u,!0),w.length>2&&(this.diff_cleanupSemantic(w),this.diff_cleanupEfficiency(w));else if(d&&typeof d=="object"&&typeof u>"u"&&typeof m>"u")w=d,g=this.diff_text1(w);else if(typeof d=="string"&&u&&typeof u=="object"&&typeof m>"u")g=d,w=u;else if(typeof d=="string"&&typeof u=="string"&&m&&typeof m=="object")g=d,w=m;else throw new Error("Unknown call format to patch_make.");if(w.length===0)return[];for(var b=[],S=new f.patch_obj,_=0,M=0,x=0,v=g,O=g,H=0;H<w.length;H++){var z=w[H][0],I=w[H][1];switch(!_&&z!==C&&(S.start1=M,S.start2=x),z){case T:S.diffs[_++]=w[H],S.length2+=I.length,O=O.substring(0,x)+I+O.substring(x);break;case y:S.length1+=I.length,S.diffs[_++]=w[H],O=O.substring(0,x)+O.substring(x+I.length);break;case C:I.length<=2*this.Patch_Margin&&_&&w.length!=H+1?(S.diffs[_++]=w[H],S.length1+=I.length,S.length2+=I.length):I.length>=2*this.Patch_Margin&&_&&(this.patch_addContext_(S,v),b.push(S),S=new f.patch_obj,_=0,v=O,M=x);break}z!==T&&(M+=I.length),z!==y&&(x+=I.length)}return _&&(this.patch_addContext_(S,v),b.push(S)),b},f.prototype.patch_deepCopy=function(d){for(var u=[],m=0;m<d.length;m++){var g=d[m],w=new f.patch_obj;w.diffs=[];for(var b=0;b<g.diffs.length;b++)w.diffs[b]=new f.Diff(g.diffs[b][0],g.diffs[b][1]);w.start1=g.start1,w.start2=g.start2,w.length1=g.length1,w.length2=g.length2,u[m]=w}return u},f.prototype.patch_apply=function(d,u){if(d.length==0)return[u,[]];d=this.patch_deepCopy(d);var m=this.patch_addPadding(d);u=m+u+m,this.patch_splitMax(d);for(var g=0,w=[],b=0;b<d.length;b++){var S=d[b].start2+g,_=this.diff_text1(d[b].diffs),M,x=-1;if(_.length>this.Match_MaxBits?(M=this.match_main(u,_.substring(0,this.Match_MaxBits),S),M!=-1&&(x=this.match_main(u,_.substring(_.length-this.Match_MaxBits),S+_.length-this.Match_MaxBits),(x==-1||M>=x)&&(M=-1))):M=this.match_main(u,_,S),M==-1)w[b]=!1,g-=d[b].length2-d[b].length1;else{w[b]=!0,g=M-S;var v;if(x==-1?v=u.substring(M,M+_.length):v=u.substring(M,x+this.Match_MaxBits),_==v)u=u.substring(0,M)+this.diff_text2(d[b].diffs)+u.substring(M+_.length);else{var O=this.diff_main(_,v,!1);if(_.length>this.Match_MaxBits&&this.diff_levenshtein(O)/_.length>this.Patch_DeleteThreshold)w[b]=!1;else{this.diff_cleanupSemanticLossless(O);for(var H=0,z,I=0;I<d[b].diffs.length;I++){var R=d[b].diffs[I];R[0]!==C&&(z=this.diff_xIndex(O,H)),R[0]===T?u=u.substring(0,M+z)+R[1]+u.substring(M+z):R[0]===y&&(u=u.substring(0,M+z)+u.substring(M+this.diff_xIndex(O,H+R[1].length))),R[0]!==y&&(H+=R[1].length)}}}}}return u=u.substring(m.length,u.length-m.length),[u,w]},f.prototype.patch_addPadding=function(d){for(var u=this.Patch_Margin,m="",g=1;g<=u;g++)m+=String.fromCharCode(g);for(var g=0;g<d.length;g++)d[g].start1+=u,d[g].start2+=u;var w=d[0],b=w.diffs;if(b.length==0||b[0][0]!=C)b.unshift(new f.Diff(C,m)),w.start1-=u,w.start2-=u,w.length1+=u,w.length2+=u;else if(u>b[0][1].length){var S=u-b[0][1].length;b[0][1]=m.substring(b[0][1].length)+b[0][1],w.start1-=S,w.start2-=S,w.length1+=S,w.length2+=S}if(w=d[d.length-1],b=w.diffs,b.length==0||b[b.length-1][0]!=C)b.push(new f.Diff(C,m)),w.length1+=u,w.length2+=u;else if(u>b[b.length-1][1].length){var S=u-b[b.length-1][1].length;b[b.length-1][1]+=m.substring(0,S),w.length1+=S,w.length2+=S}return m},f.prototype.patch_splitMax=function(d){for(var u=this.Match_MaxBits,m=0;m<d.length;m++)if(!(d[m].length1<=u)){var g=d[m];d.splice(m--,1);for(var w=g.start1,b=g.start2,S="";g.diffs.length!==0;){var _=new f.patch_obj,M=!0;for(_.start1=w-S.length,_.start2=b-S.length,S!==""&&(_.length1=_.length2=S.length,_.diffs.push(new f.Diff(C,S)));g.diffs.length!==0&&_.length1<u-this.Patch_Margin;){var x=g.diffs[0][0],v=g.diffs[0][1];x===T?(_.length2+=v.length,b+=v.length,_.diffs.push(g.diffs.shift()),M=!1):x===y&&_.diffs.length==1&&_.diffs[0][0]==C&&v.length>2*u?(_.length1+=v.length,w+=v.length,M=!1,_.diffs.push(new f.Diff(x,v)),g.diffs.shift()):(v=v.substring(0,u-_.length1-this.Patch_Margin),_.length1+=v.length,w+=v.length,x===C?(_.length2+=v.length,b+=v.length):M=!1,_.diffs.push(new f.Diff(x,v)),v==g.diffs[0][1]?g.diffs.shift():g.diffs[0][1]=g.diffs[0][1].substring(v.length))}S=this.diff_text2(_.diffs),S=S.substring(S.length-this.Patch_Margin);var O=this.diff_text1(g.diffs).substring(0,this.Patch_Margin);O!==""&&(_.length1+=O.length,_.length2+=O.length,_.diffs.length!==0&&_.diffs[_.diffs.length-1][0]===C?_.diffs[_.diffs.length-1][1]+=O:_.diffs.push(new f.Diff(C,O))),M||d.splice(++m,0,_)}}},f.prototype.patch_toText=function(d){for(var u=[],m=0;m<d.length;m++)u[m]=d[m];return u.join("")},f.prototype.patch_fromText=function(d){var u=[];if(!d)return u;for(var m=d.split(`
`),g=0,w=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;g<m.length;){var b=m[g].match(w);if(!b)throw new Error("Invalid patch string: "+m[g]);var S=new f.patch_obj;for(u.push(S),S.start1=parseInt(b[1],10),b[2]===""?(S.start1--,S.length1=1):b[2]=="0"?S.length1=0:(S.start1--,S.length1=parseInt(b[2],10)),S.start2=parseInt(b[3],10),b[4]===""?(S.start2--,S.length2=1):b[4]=="0"?S.length2=0:(S.start2--,S.length2=parseInt(b[4],10)),g++;g<m.length;){var _=m[g].charAt(0);try{var M=decodeURI(m[g].substring(1))}catch{throw new Error("Illegal escape in patch_fromText: "+M)}if(_=="-")S.diffs.push(new f.Diff(y,M));else if(_=="+")S.diffs.push(new f.Diff(T,M));else if(_==" ")S.diffs.push(new f.Diff(C,M));else{if(_=="@")break;if(_!=="")throw new Error('Invalid patch mode "'+_+'" in: '+M)}g++}}return u},f.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},f.patch_obj.prototype.toString=function(){var d,u;this.length1===0?d=this.start1+",0":this.length1==1?d=this.start1+1:d=this.start1+1+","+this.length1,this.length2===0?u=this.start2+",0":this.length2==1?u=this.start2+1:u=this.start2+1+","+this.length2;for(var m=["@@ -"+d+" +"+u+` @@
`],g,w=0;w<this.diffs.length;w++){switch(this.diffs[w][0]){case T:g="+";break;case y:g="-";break;case C:g=" ";break}m[w+1]=g+encodeURI(this.diffs[w][1])+`
`}return m.join("").replace(/%20/g," ")},p.exports=f,p.exports.diff_match_patch=f,p.exports.DIFF_DELETE=y,p.exports.DIFF_INSERT=T,p.exports.DIFF_EQUAL=C},923:(p,f,y)=>{y.d(f,{default:()=>Z});var T=y(288),C=y(59),d=y(784),u=y(51),m=y(500),g=y(339),w=y(108),b=function(B){B===void 0&&(B=document);var ae=function(K){var $=document.createElement("img");$.src=K.getAttribute("data-src"),$.addEventListener("load",function(){!K.getAttribute("style")&&!K.getAttribute("class")&&!K.getAttribute("width")&&!K.getAttribute("height")&&$.naturalHeight>$.naturalWidth&&$.naturalWidth/$.naturalHeight<document.querySelector(".vditor-reset").clientWidth/(window.innerHeight-40)&&$.naturalHeight>window.innerHeight-40&&(K.style.height=window.innerHeight-40+"px"),K.src=$.src}),K.removeAttribute("data-src")};if(!("IntersectionObserver"in window))return B.querySelectorAll("img").forEach(function(K){K.getAttribute("data-src")&&ae(K)}),!1;window.vditorImageIntersectionObserver?(window.vditorImageIntersectionObserver.disconnect(),B.querySelectorAll("img").forEach(function(K){window.vditorImageIntersectionObserver.observe(K)})):(window.vditorImageIntersectionObserver=new IntersectionObserver(function(K){K.forEach(function($){(typeof $.isIntersecting>"u"?$.intersectionRatio!==0:$.isIntersecting)&&$.target.getAttribute("data-src")&&ae($.target)})}),B.querySelectorAll("img").forEach(function(K){window.vditorImageIntersectionObserver.observe(K)}))},S=y(960),_=y(0),M=y(975),x=y(931),v=y(597),O=y(162),H=y(70),z=y(591),I=y(913),R=y(873),N=y(161),V=y(598),se=y(905),ue=function(B){document.querySelectorAll(".vditor-anchor").forEach(function(ae){B===1&&ae.classList.add("vditor-anchor--left"),ae.onclick=function(){var K=ae.getAttribute("href").substr(1),$=document.getElementById("vditorAnchor-"+K).offsetTop;document.querySelector("html").scrollTop=$}}),window.onhashchange=function(){var ae=document.getElementById("vditorAnchor-"+decodeURIComponent(window.location.hash.substr(1)));ae&&(document.querySelector("html").scrollTop=ae.offsetTop)}},ke=y(796),Re=y(827),_e=function(B,ae){if(ae===void 0&&(ae="zh_CN"),!(typeof speechSynthesis>"u"||typeof SpeechSynthesisUtterance>"u")){var K=function(){var Ue=speechSynthesis.getVoices(),ge,Ze;return Ue.forEach(function(lt){lt.lang===ae.replace("_","-")&&(ge=lt),lt.default&&(Ze=lt)}),ge||(ge=Ze),ge},$='<svg><use xlink:href="#vditor-icon-play"></use></svg>',xe='<svg><use xlink:href="#vditor-icon-pause"></use></svg>';document.getElementById("vditorIconScript")||($='<svg viewBox="0 0 32 32"><path d="M3.436 0l25.128 16-25.128 16v-32z"></path></svg>',xe='<svg viewBox="0 0 32 32"><path d="M20.617 0h9.128v32h-9.128v-32zM2.255 32v-32h9.128v32h-9.128z"></path></svg>');var re=document.querySelector(".vditor-speech");re||(re=document.createElement("button"),re.className="vditor-speech",B.insertAdjacentElement("beforeend",re),speechSynthesis.onvoiceschanged!==void 0&&(speechSynthesis.onvoiceschanged=K));var qe=K(),Be=new SpeechSynthesisUtterance;Be.voice=qe,Be.onend=Be.onerror=function(){re.style.display="none",speechSynthesis.cancel(),re.classList.remove("vditor-speech--current"),re.innerHTML=$},B.addEventListener(window.ontouchstart!==void 0?"touchend":"click",function(Ue){var ge=Ue.target;if(ge.classList.contains("vditor-speech")||ge.parentElement.classList.contains("vditor-speech")){re.classList.contains("vditor-speech--current")?speechSynthesis.speaking&&(speechSynthesis.paused?(speechSynthesis.resume(),re.innerHTML=xe):(speechSynthesis.pause(),re.innerHTML=$)):(Be.text=re.getAttribute("data-text"),speechSynthesis.speak(Be),re.classList.add("vditor-speech--current"),re.innerHTML=xe),(0,Re.jl)(window.vditorSpeechRange),B.focus();return}if(re.style.display="none",speechSynthesis.cancel(),re.classList.remove("vditor-speech--current"),re.innerHTML=$,getSelection().rangeCount!==0){var Ze=getSelection().getRangeAt(0),lt=Ze.toString().trim();if(lt){window.vditorSpeechRange=Ze.cloneRange();var ct=Ze.getBoundingClientRect();re.innerHTML=$,re.style.display="block",re.style.top=ct.top+ct.height+document.querySelector("html").scrollTop-20+"px",window.ontouchstart!==void 0?re.style.left=Ue.changedTouches[Ue.changedTouches.length-1].pageX+2+"px":re.style.left=Ue.clientX+2+"px",re.setAttribute("data-text",lt)}}})}},Te=function(B,ae,K,$){function xe(re){return re instanceof K?re:new K(function(qe){qe(re)})}return new(K||(K=Promise))(function(re,qe){function Be(Ze){try{ge($.next(Ze))}catch(lt){qe(lt)}}function Ue(Ze){try{ge($.throw(Ze))}catch(lt){qe(lt)}}function ge(Ze){Ze.done?re(Ze.value):xe(Ze.value).then(Be,Ue)}ge(($=$.apply(B,ae||[])).next())})},Ne=function(B,ae){var K={label:0,sent:function(){if(re[0]&1)throw re[1];return re[1]},trys:[],ops:[]},$,xe,re,qe;return qe={next:Be(0),throw:Be(1),return:Be(2)},typeof Symbol=="function"&&(qe[Symbol.iterator]=function(){return this}),qe;function Be(ge){return function(Ze){return Ue([ge,Ze])}}function Ue(ge){if($)throw new TypeError("Generator is already executing.");for(;qe&&(qe=0,ge[0]&&(K=0)),K;)try{if($=1,xe&&(re=ge[0]&2?xe.return:ge[0]?xe.throw||((re=xe.return)&&re.call(xe),0):xe.next)&&!(re=re.call(xe,ge[1])).done)return re;switch(xe=0,re&&(ge=[ge[0]&2,re.value]),ge[0]){case 0:case 1:re=ge;break;case 4:return K.label++,{value:ge[1],done:!1};case 5:K.label++,xe=ge[1],ge=[0];continue;case 7:ge=K.ops.pop(),K.trys.pop();continue;default:if(re=K.trys,!(re=re.length>0&&re[re.length-1])&&(ge[0]===6||ge[0]===2)){K=0;continue}if(ge[0]===3&&(!re||ge[1]>re[0]&&ge[1]<re[3])){K.label=ge[1];break}if(ge[0]===6&&K.label<re[1]){K.label=re[1],re=ge;break}if(re&&K.label<re[2]){K.label=re[2],K.ops.push(ge);break}re[2]&&K.ops.pop(),K.trys.pop();continue}ge=ae.call(B,K)}catch(Ze){ge=[6,Ze],xe=0}finally{$=re=0}if(ge[0]&5)throw ge[1];return{value:ge[0]?ge[1]:void 0,done:!0}}},Oe=function(B){var ae,K={anchor:0,cdn:I.Y.CDN,customEmoji:{},emojiPath:"".concat(I.Y.CDN,"/dist/images/emoji"),hljs:I.Y.HLJS_OPTIONS,icon:"ant",lang:"zh_CN",markdown:I.Y.MARKDOWN_OPTIONS,math:I.Y.MATH_OPTIONS,mode:"light",speech:{enable:!1},render:{media:{enable:!0}},theme:I.Y.THEME_OPTIONS};return B.cdn&&(!((ae=B.theme)===null||ae===void 0)&&ae.path||(K.theme.path="".concat(B.cdn,"/dist/css/content-theme")),B.emojiPath||(K.emojiPath="".concat(B.cdn,"/dist/images/emoji"))),(0,se.h)(K,B)},$e=function(B,ae){var K=Oe(ae);return(0,N.Z)("".concat(K.cdn,"/dist/js/lute/lute.min.js"),"vditorLuteScript").then(function(){var $=(0,ke.X)({autoSpace:K.markdown.autoSpace,gfmAutoLink:K.markdown.gfmAutoLink,codeBlockPreview:K.markdown.codeBlockPreview,emojiSite:K.emojiPath,emojis:K.customEmoji,fixTermTypo:K.markdown.fixTermTypo,footnotes:K.markdown.footnotes,headingAnchor:K.anchor!==0,inlineMathDigit:K.math.inlineDigit,lazyLoadImage:K.lazyLoadImage,linkBase:K.markdown.linkBase,linkPrefix:K.markdown.linkPrefix,listStyle:K.markdown.listStyle,mark:K.markdown.mark,mathBlockPreview:K.markdown.mathBlockPreview,paragraphBeginningSpace:K.markdown.paragraphBeginningSpace,sanitize:K.markdown.sanitize,toc:K.markdown.toc});return ae!=null&&ae.renderers&&$.SetJSRenderers({renderers:{Md2HTML:ae.renderers}}),$.SetHeadingID(!0),$.Md2HTML(B)})},j=function(B,ae,K){return Te(void 0,void 0,void 0,function(){var $,xe,re,qe;return Ne(this,function(Be){switch(Be.label){case 0:return $=Oe(K),[4,$e(ae,$)];case 1:if(xe=Be.sent(),$.transform&&(xe=$.transform(xe)),B.innerHTML=xe,B.classList.add("vditor-reset"),$.i18n)return[3,5];if(["en_US","fr_FR","pt_BR","ja_JP","ko_KR","ru_RU","sv_SE","zh_CN","zh_TW"].includes($.lang))return[3,2];throw new Error("options.lang error, see https://ld246.com/article/1549638745630#options");case 2:return re="vditorI18nScript",qe=re+$.lang,document.querySelectorAll('head script[id^="'.concat(re,'"]')).forEach(function(Ue){Ue.id!==qe&&document.head.removeChild(Ue)}),[4,(0,N.Z)("".concat($.cdn,"/dist/js/i18n/").concat($.lang,".js"),qe)];case 3:Be.sent(),Be.label=4;case 4:return[3,6];case 5:window.VditorI18n=$.i18n,Be.label=6;case 6:return $.icon?[4,(0,N.Z)("".concat($.cdn,"/dist/js/icons/").concat($.icon,".js"),"vditorIconScript")]:[3,8];case 7:Be.sent(),Be.label=8;case 8:return(0,R.H)($.theme.current,$.theme.path),$.anchor===1&&B.classList.add("vditor-reset--anchor"),(0,u.o)(B,$.hljs),(0,w.$)($.hljs,B,$.cdn),(0,S.T)(B,{cdn:$.cdn,math:$.math}),(0,M.e)(B,$.cdn,$.mode),(0,x.Y)(B,$.cdn,$.mode),(0,v.K)(B,$.cdn),(0,m.D)(B,$.cdn),(0,g.m)(B,$.cdn),(0,d.v)(B,$.cdn,$.mode),(0,O.l)(B,$.cdn,$.mode),(0,z.M)(B,$.cdn),(0,T.$)(B,$.cdn),$.render.media.enable&&(0,_.l)(B),$.speech.enable&&_e(B),$.anchor!==0&&ue($.anchor),$.after&&$.after(),$.lazyLoadImage&&b(B),B.addEventListener("click",function(Ue){var ge=(0,V._Y)(Ue.target,"SPAN");if(ge&&(0,V.KJ)(ge,"vditor-toc")){var Ze=B.querySelector("#"+ge.getAttribute("data-target-id"));Ze&&window.scrollTo(window.scrollX,Ze.offsetTop);return}}),[2]}})})},ce=y(726),G=y(13),W=function(){function B(){}return B.adapterRender=C,B.previewImage=ce.o,B.codeRender=u.o,B.graphvizRender=g.m,B.highlightRender=w.$,B.mathRender=S.T,B.mermaidRender=M.e,B.SMILESRender=x.Y,B.markmapRender=v.K,B.flowchartRender=m.D,B.chartRender=d.v,B.abcRender=T.$,B.mindmapRender=O.l,B.plantumlRender=z.M,B.outlineRender=H.N,B.mediaRender=_.l,B.speechRender=_e,B.lazyLoadImageRender=b,B.md2html=$e,B.preview=j,B.setCodeTheme=G.h,B.setContentTheme=R.H,B}();const Z=W},913:(p,f,y)=>{y.d(f,{Y:()=>C,g:()=>T});var T="3.10.9",C=function(){function d(){}return d.ZWSP="​",d.DROP_EDITOR="application/editor",d.MOBILE_WIDTH=520,d.CLASS_MENU_DISABLED="vditor-menu--disabled",d.EDIT_TOOLBARS=["emoji","headings","bold","italic","strike","link","list","ordered-list","outdent","indent","check","line","quote","code","inline-code","insert-after","insert-before","upload","record","table"],d.CODE_THEME=["a11y-dark","agate","an-old-hope","androidstudio","arta","atom-one-dark","atom-one-dark-reasonable","base16/3024","base16/apathy","base16/apprentice","base16/ashes","base16/atelier-cave","base16/atelier-dune","base16/atelier-estuary","base16/atelier-forest","base16/atelier-heath","base16/atelier-lakeside","base16/atelier-plateau","base16/atelier-savanna","base16/atelier-seaside","base16/atelier-sulphurpool","base16/atlas","base16/bespin","base16/black-metal","base16/black-metal-bathory","base16/black-metal-burzum","base16/black-metal-dark-funeral","base16/black-metal-gorgoroth","base16/black-metal-immortal","base16/black-metal-khold","base16/black-metal-marduk","base16/black-metal-mayhem","base16/black-metal-nile","base16/black-metal-venom","base16/brewer","base16/bright","base16/brogrammer","base16/brush-trees-dark","base16/chalk","base16/circus","base16/classic-dark","base16/codeschool","base16/colors","base16/danqing","base16/darcula","base16/dark-violet","base16/darkmoss","base16/darktooth","base16/decaf","base16/default-dark","base16/dracula","base16/edge-dark","base16/eighties","base16/embers","base16/equilibrium-dark","base16/equilibrium-gray-dark","base16/espresso","base16/eva","base16/eva-dim","base16/flat","base16/framer","base16/gigavolt","base16/google-dark","base16/grayscale-dark","base16/green-screen","base16/gruvbox-dark-hard","base16/gruvbox-dark-medium","base16/gruvbox-dark-pale","base16/gruvbox-dark-soft","base16/hardcore","base16/harmonic16-dark","base16/heetch-dark","base16/helios","base16/hopscotch","base16/horizon-dark","base16/humanoid-dark","base16/ia-dark","base16/icy-dark","base16/ir-black","base16/isotope","base16/kimber","base16/london-tube","base16/macintosh","base16/marrakesh","base16/materia","base16/material","base16/material-darker","base16/material-palenight","base16/material-vivid","base16/mellow-purple","base16/mocha","base16/monokai","base16/nebula","base16/nord","base16/nova","base16/ocean","base16/oceanicnext","base16/onedark","base16/outrun-dark","base16/papercolor-dark","base16/paraiso","base16/pasque","base16/phd","base16/pico","base16/pop","base16/porple","base16/qualia","base16/railscasts","base16/rebecca","base16/ros-pine","base16/ros-pine-moon","base16/sandcastle","base16/seti-ui","base16/silk-dark","base16/snazzy","base16/solar-flare","base16/solarized-dark","base16/spacemacs","base16/summercamp","base16/summerfruit-dark","base16/synth-midnight-terminal-dark","base16/tango","base16/tender","base16/tomorrow-night","base16/twilight","base16/unikitty-dark","base16/vulcan","base16/windows-10","base16/windows-95","base16/windows-high-contrast","base16/windows-nt","base16/woodland","base16/xcode-dusk","base16/zenburn","codepen-embed","dark","devibeans","far","felipec","github-dark","github-dark-dimmed","gml","gradient-dark","hybrid","ir-black","isbl-editor-dark","kimbie-dark","lioshi","monokai","monokai-sublime","night-owl","nnfx-dark","nord","obsidian","panda-syntax-dark","paraiso-dark","pojoaque","qtcreator-dark","rainbow","shades-of-purple","srcery","stackoverflow-dark","sunburst","tomorrow-night-blue","tomorrow-night-bright","tokyo-night-dark","vs2015","xt256","ant-design","a11y-light","arduino-light","ascetic","atom-one-light","base16/atelier-cave-light","base16/atelier-dune-light","base16/atelier-estuary-light","base16/atelier-forest-light","base16/atelier-heath-light","base16/atelier-lakeside-light","base16/atelier-plateau-light","base16/atelier-savanna-light","base16/atelier-seaside-light","base16/atelier-sulphurpool-light","base16/brush-trees","base16/classic-light","base16/cupcake","base16/cupertino","base16/default-light","base16/dirtysea","base16/edge-light","base16/equilibrium-gray-light","base16/equilibrium-light","base16/fruit-soda","base16/github","base16/google-light","base16/grayscale-light","base16/gruvbox-light-hard","base16/gruvbox-light-medium","base16/gruvbox-light-soft","base16/harmonic16-light","base16/heetch-light","base16/humanoid-light","base16/horizon-light","base16/ia-light","base16/material-lighter","base16/mexico-light","base16/one-light","base16/papercolor-light","base16/ros-pine-dawn","base16/sagelight","base16/shapeshifter","base16/silk-light","base16/solar-flare-light","base16/solarized-light","base16/summerfruit-light","base16/synth-midnight-terminal-light","base16/tomorrow","base16/unikitty-light","base16/windows-10-light","base16/windows-95-light","base16/windows-high-contrast-light","brown-paper","base16/windows-nt-light","color-brewer","docco","foundation","github","googlecode","gradient-light","grayscale","idea","intellij-light","isbl-editor-light","kimbie-light","lightfair","magula","mono-blue","nnfx-light","panda-syntax-light","paraiso-light","purebasic","qtcreator-light","routeros","school-book","stackoverflow-light","tokyo-night-light","vs","xcode","default"],d.ALIAS_CODE_LANGUAGES=["abc","plantuml","mermaid","flowchart","echarts","mindmap","graphviz","math","markmap","smiles","js","ts","html","toml","c#","bat"],d.CDN="https://unpkg.com/vditor@".concat("3.10.9"),d.MARKDOWN_OPTIONS={autoSpace:!1,gfmAutoLink:!0,codeBlockPreview:!0,fixTermTypo:!1,footnotes:!0,linkBase:"",linkPrefix:"",listStyle:!1,mark:!1,mathBlockPreview:!0,paragraphBeginningSpace:!1,sanitize:!0,toc:!1},d.HLJS_OPTIONS={enable:!0,lineNumber:!1,defaultLang:"",style:"github"},d.MATH_OPTIONS={engine:"KaTeX",inlineDigit:!1,macros:{}},d.THEME_OPTIONS={current:"light",list:{"ant-design":"Ant Design",dark:"Dark",light:"Light",wechat:"WeChat"},path:"".concat(d.CDN,"/dist/css/content-theme")},d}()},931:(p,f,y)=>{y.d(f,{Y:()=>m});var T=y(913),C=y(161),d=y(59),u=y(933),m=function(g,w,b){g===void 0&&(g=document),w===void 0&&(w=T.Y.CDN);var S=d.SMILESRenderAdapter.getElements(g);S.length>0&&(0,C.Z)("".concat(w,"/dist/js/smiles-drawer/smiles-drawer.min.js?v=2.1.7"),"vditorAbcjsScript").then(function(){var _=new SmiDrawer({},{});S.forEach(function(M){var x=d.SMILESRenderAdapter.getCode(M).trim();if(!(M.getAttribute("data-processed")==="true"||x.trim()==="")){var v="smiles"+(0,u.Ee)();M.innerHTML='<svg id="'.concat(v,'"></svg>'),_.draw(x,"#"+v,b==="dark"?"dark":void 0),M.setAttribute("data-processed","true")}})})}},288:(p,f,y)=>{y.d(f,{$:()=>u});var T=y(913),C=y(161),d=y(59),u=function(m,g){m===void 0&&(m=document),g===void 0&&(g=T.Y.CDN);var w=d.abcRenderAdapter.getElements(m);w.length>0&&(0,C.Z)("".concat(g,"/dist/js/abcjs/abcjs_basic.min.js"),"vditorAbcjsScript").then(function(){w.forEach(function(b){b.parentElement.classList.contains("vditor-wysiwyg__pre")||b.parentElement.classList.contains("vditor-ir__marker--pre")||b.getAttribute("data-processed")!=="true"&&(ABCJS.renderAbc(b,d.abcRenderAdapter.getCode(b).trim()),b.style.overflowX="auto",b.setAttribute("data-processed","true"))})})}},59:(p,f,y)=>{y.r(f),y.d(f,{SMILESRenderAdapter:()=>C,abcRenderAdapter:()=>w,chartRenderAdapter:()=>g,flowchartRenderAdapter:()=>S,graphvizRenderAdapter:()=>b,markmapRenderAdapter:()=>u,mathRenderAdapter:()=>T,mermaidRenderAdapter:()=>d,mindmapRenderAdapter:()=>m,plantumlRenderAdapter:()=>_});var T={getCode:function(M){return M.textContent},getElements:function(M){return M.querySelectorAll(".language-math")}},C={getCode:function(M){return M.textContent},getElements:function(M){return M.querySelectorAll(".language-smiles")}},d={getCode:function(M){return M.textContent},getElements:function(M){return M.querySelectorAll(".language-mermaid")}},u={getCode:function(M){return M.textContent},getElements:function(M){return M.querySelectorAll(".language-markmap")}},m={getCode:function(M){return M.getAttribute("data-code")},getElements:function(M){return M.querySelectorAll(".language-mindmap")}},g={getCode:function(M){return M.innerText},getElements:function(M){return M.querySelectorAll(".language-echarts")}},w={getCode:function(M){return M.textContent},getElements:function(M){return M.querySelectorAll(".language-abc")}},b={getCode:function(M){return M.textContent},getElements:function(M){return M.querySelectorAll(".language-graphviz")}},S={getCode:function(M){return M.textContent},getElements:function(M){return M.querySelectorAll(".language-flowchart")}},_={getCode:function(M){return M.textContent},getElements:function(M){return M.querySelectorAll(".language-plantuml")}}},784:(p,f,y)=>{y.d(f,{v:()=>w});var T=y(913),C=y(161),d=y(59),u=y(933),m=function(b,S,_,M){function x(v){return v instanceof _?v:new _(function(O){O(v)})}return new(_||(_=Promise))(function(v,O){function H(R){try{I(M.next(R))}catch(N){O(N)}}function z(R){try{I(M.throw(R))}catch(N){O(N)}}function I(R){R.done?v(R.value):x(R.value).then(H,z)}I((M=M.apply(b,S||[])).next())})},g=function(b,S){var _={label:0,sent:function(){if(v[0]&1)throw v[1];return v[1]},trys:[],ops:[]},M,x,v,O;return O={next:H(0),throw:H(1),return:H(2)},typeof Symbol=="function"&&(O[Symbol.iterator]=function(){return this}),O;function H(I){return function(R){return z([I,R])}}function z(I){if(M)throw new TypeError("Generator is already executing.");for(;O&&(O=0,I[0]&&(_=0)),_;)try{if(M=1,x&&(v=I[0]&2?x.return:I[0]?x.throw||((v=x.return)&&v.call(x),0):x.next)&&!(v=v.call(x,I[1])).done)return v;switch(x=0,v&&(I=[I[0]&2,v.value]),I[0]){case 0:case 1:v=I;break;case 4:return _.label++,{value:I[1],done:!1};case 5:_.label++,x=I[1],I=[0];continue;case 7:I=_.ops.pop(),_.trys.pop();continue;default:if(v=_.trys,!(v=v.length>0&&v[v.length-1])&&(I[0]===6||I[0]===2)){_=0;continue}if(I[0]===3&&(!v||I[1]>v[0]&&I[1]<v[3])){_.label=I[1];break}if(I[0]===6&&_.label<v[1]){_.label=v[1],v=I;break}if(v&&_.label<v[2]){_.label=v[2],_.ops.push(I);break}v[2]&&_.ops.pop(),_.trys.pop();continue}I=S.call(b,_)}catch(R){I=[6,R],x=0}finally{M=v=0}if(I[0]&5)throw I[1];return{value:I[0]?I[1]:void 0,done:!0}}},w=function(b,S,_){b===void 0&&(b=document),S===void 0&&(S=T.Y.CDN);var M=d.chartRenderAdapter.getElements(b);M.length>0&&(0,C.Z)("".concat(S,"/dist/js/echarts/echarts.min.js?v=5.5.1"),"vditorEchartsScript").then(function(){M.forEach(function(x){return m(void 0,void 0,void 0,function(){var v,O,H;return g(this,function(z){switch(z.label){case 0:if(x.parentElement.classList.contains("vditor-wysiwyg__pre")||x.parentElement.classList.contains("vditor-ir__marker--pre"))return[2];if(v=d.chartRenderAdapter.getCode(x).trim(),!v)return[2];z.label=1;case 1:return z.trys.push([1,3,,4]),x.getAttribute("data-processed")==="true"?[2]:[4,(0,u.kY)(v)];case 2:return O=z.sent(),echarts.init(x,_==="dark"?"dark":void 0).setOption(O),x.setAttribute("data-processed","true"),[3,4];case 3:return H=z.sent(),x.className="vditor-reset--error",x.innerHTML="echarts render error: <br>".concat(H),[3,4];case 4:return[2]}})})})})}},51:(p,f,y)=>{y.d(f,{o:()=>d});var T=y(695),C=y(913),d=function(u,m){Array.from(u.querySelectorAll("pre > code")).filter(function(g,w){return!(g.parentElement.classList.contains("vditor-wysiwyg__pre")||g.parentElement.classList.contains("vditor-ir__marker--pre")||g.classList.contains("language-mermaid")||g.classList.contains("language-flowchart")||g.classList.contains("language-echarts")||g.classList.contains("language-mindmap")||g.classList.contains("language-plantuml")||g.classList.contains("language-markmap")||g.classList.contains("language-abc")||g.classList.contains("language-graphviz")||g.classList.contains("language-math")||g.classList.contains("language-smiles")||g.style.maxHeight.indexOf("px")>-1||u.classList.contains("vditor-preview")&&w>5)}).forEach(function(g){var w,b,S,_=g.innerText;if(g.classList.contains("highlight-chroma")){var M=g.cloneNode(!0);M.querySelectorAll(".highlight-ln").forEach(function(H){H.remove()}),_=M.innerText}else _.endsWith(`
`)&&(_=_.substr(0,_.length-1));var x='<svg><use xlink:href="#vditor-icon-copy"></use></svg>';document.getElementById("vditorIconScript")||(x='<svg viewBox="0 0 32 32"><path d="M22.545-0h-17.455c-1.6 0-2.909 1.309-2.909 2.909v20.364h2.909v-20.364h17.455v-2.909zM26.909 5.818h-16c-1.6 0-2.909 1.309-2.909 2.909v20.364c0 1.6 1.309 2.909 2.909 2.909h16c1.6 0 2.909-1.309 2.909-2.909v-20.364c0-1.6-1.309-2.909-2.909-2.909zM26.909 29.091h-16v-20.364h16v20.364z"></path></svg>');var v=document.createElement("div");v.className="vditor-copy",v.innerHTML='<span aria-label="'.concat(((w=window.VditorI18n)===null||w===void 0?void 0:w.copy)||"复制",`"
onmouseover="this.setAttribute('aria-label', '`).concat(((b=window.VditorI18n)===null||b===void 0?void 0:b.copy)||"复制",`')"
class="vditor-tooltipped vditor-tooltipped__w"
onclick="this.previousElementSibling.select();document.execCommand('copy');this.setAttribute('aria-label', '`).concat(((S=window.VditorI18n)===null||S===void 0?void 0:S.copied)||"已复制",`');this.previousElementSibling.blur()">`).concat(x,"</span>");var O=document.createElement("textarea");O.value=(0,T.p)(_),v.insertAdjacentElement("afterbegin",O),m&&m.renderMenu&&m.renderMenu(g,v),g.before(v),g.style.maxHeight=window.outerHeight-40+"px",g.insertAdjacentHTML("afterend",'<span style="position: absolute">'.concat(C.Y.ZWSP,"</span>"))})}},500:(p,f,y)=>{y.d(f,{D:()=>u});var T=y(913),C=y(161),d=y(59),u=function(m,g){g===void 0&&(g=T.Y.CDN);var w=d.flowchartRenderAdapter.getElements(m);w.length!==0&&(0,C.Z)("".concat(g,"/dist/js/flowchart.js/flowchart.min.js"),"vditorFlowchartScript").then(function(){w.forEach(function(b){if(b.getAttribute("data-processed")!=="true"){var S=flowchart.parse(d.flowchartRenderAdapter.getCode(b));b.innerHTML="",S.drawSVG(b),b.setAttribute("data-processed","true")}})})}},339:(p,f,y)=>{y.d(f,{m:()=>u});var T=y(913),C=y(161),d=y(59),u=function(m,g){g===void 0&&(g=T.Y.CDN);var w=d.graphvizRenderAdapter.getElements(m);w.length!==0&&(0,C.Z)("".concat(g,"/dist/js/graphviz/viz.js"),"vditorGraphVizScript").then(function(){w.forEach(function(b){var S=d.graphvizRenderAdapter.getCode(b);if(!(b.parentElement.classList.contains("vditor-wysiwyg__pre")||b.parentElement.classList.contains("vditor-ir__marker--pre"))&&!(b.getAttribute("data-processed")==="true"||S.trim()==="")){try{var _=new Blob(["importScripts('".concat(document.getElementById("vditorGraphVizScript").src.replace("viz.js","full.render.js"),"');")],{type:"application/javascript"}),M=window.URL||window.webkitURL,x=M.createObjectURL(_),v=new Worker(x);new Viz({worker:v}).renderSVGElement(S).then(function(O){b.innerHTML=O.outerHTML}).catch(function(O){b.innerHTML="graphviz render error: <br>".concat(O),b.className="vditor-reset--error"})}catch(O){console.error("graphviz error",O)}b.setAttribute("data-processed","true")}})})}},108:(p,f,y)=>{y.d(f,{$:()=>u});var T=y(913),C=y(161),d=y(505),u=function(m,g,w){g===void 0&&(g=document),w===void 0&&(w=T.Y.CDN);var b=m.style;T.Y.CODE_THEME.includes(b)||(b="github");var S=document.getElementById("vditorHljsStyle"),_="".concat(w,"/dist/js/highlight.js/styles/").concat(b,".min.css");if(S&&S.getAttribute("href")!==_&&S.remove(),(0,d.T)("".concat(w,"/dist/js/highlight.js/styles/").concat(b,".min.css"),"vditorHljsStyle"),m.enable!==!1){var M=g.querySelectorAll("pre > code");M.length!==0&&(0,C.Z)("".concat(w,"/dist/js/highlight.js/highlight.min.js?v=11.7.0"),"vditorHljsScript").then(function(){(0,C.Z)("".concat(w,"/dist/js/highlight.js/third-languages.js?v=1.0.1"),"vditorHljsThirdScript").then(function(){g.querySelectorAll("pre > code").forEach(function(x){if(!(x.parentElement.classList.contains("vditor-ir__marker--pre")||x.parentElement.classList.contains("vditor-wysiwyg__pre"))&&!(x.classList.contains("language-mermaid")||x.classList.contains("language-flowchart")||x.classList.contains("language-echarts")||x.classList.contains("language-mindmap")||x.classList.contains("language-plantuml")||x.classList.contains("language-smiles")||x.classList.contains("language-abc")||x.classList.contains("language-graphviz")||x.classList.contains("language-math"))){m.defaultLang!==""&&x.className.indexOf("language-")===-1&&x.classList.add("language-"+m.defaultLang);var v=x.className.replace("language-","");if(window.hljs.getLanguage(v)||(v="plaintext"),x.innerHTML=window.hljs.highlight(x.textContent,{language:v,ignoreIllegals:!0}).value,x.classList.add("hljs"),!!m.lineNumber){x.classList.add("vditor-linenumber");var O=x.querySelector(".vditor-linenumber__temp");O||(O=document.createElement("div"),O.className="vditor-linenumber__temp",x.insertAdjacentElement("beforeend",O));var H=getComputedStyle(x).whiteSpace,z=!1;(H==="pre-wrap"||H==="pre-line")&&(z=!0);var I="",R=x.textContent.split(/\r\n|\r|\n/g);R.pop(),R.map(function(N){var V="";z&&(O.textContent=N||`
`,V=' style="height:'.concat(O.getBoundingClientRect().height,'px"')),I+="<span".concat(V,"></span>")}),O.style.display="none",I='<span class="vditor-linenumber__rows">'.concat(I,"</span>"),x.insertAdjacentHTML("beforeend",I)}}})})})}}},597:(p,f,y)=>{y.d(f,{K:()=>w});var T=y(913),C=y(161),d=y(59),u={},m=function(b,S){var _=b.transform(S),M=Object.keys(_.features).filter(function(z){return!u[z]});M.forEach(function(z){u[z]=!0});var x=b.getAssets(M),v=x.styles,O=x.scripts,H=window.markmap;return v&&H.loadCSS(v),O&&H.loadJS(O),_},g=function(b,S){var _=window.markmap,M=_.Transformer,x=_.Markmap,v=_.deriveOptions;_.globalCSS;var O=new M;b.innerHTML='<svg style="width:100%"></svg>';var H=b.firstChild,z=x.create(H,null),I=m(O,S),R=I.root,N=I.frontmatter,V=N==null?void 0:N.markmap,se=v(V);z.setData(R,se),z.fit()},w=function(b,S){b===void 0&&(b=document),S===void 0&&(S=T.Y.CDN);var _=d.markmapRenderAdapter.getElements(b);_.length!==0&&(0,C.Z)("".concat(S,"/dist/js/markmap/markmap.min.js"),"vditorMarkerScript").then(function(){_.forEach(function(M){var x=d.markmapRenderAdapter.getCode(M);if(!(M.getAttribute("data-processed")==="true"||x.trim()==="")){var v=document.createElement("div");v.className="language-markmap",M.parentNode.appendChild(v),g(v,x),M.parentNode.childNodes[0].nodeName=="CODE"&&M.parentNode.removeChild(M.parentNode.childNodes[0])}})})}},960:(p,f,y)=>{y.d(f,{T:()=>g});var T=y(913),C=y(161),d=y(505),u=y(695),m=y(59),g=function(w,b){w===void 0&&(w=document);var S=m.mathRenderAdapter.getElements(w);if(S.length!==0){var _={cdn:T.Y.CDN,math:{engine:"KaTeX",inlineDigit:!1,macros:{}}};if(b&&b.math&&(b.math=Object.assign({},_.math,b.math)),b=Object.assign({},_,b),b.math.engine==="KaTeX")(0,d.T)("".concat(b.cdn,"/dist/js/katex/katex.min.css?v=0.16.9"),"vditorKatexStyle"),(0,C.Z)("".concat(b.cdn,"/dist/js/katex/katex.min.js?v=0.16.9"),"vditorKatexScript").then(function(){(0,C.Z)("".concat(b.cdn,"/dist/js/katex/mhchem.min.js?v=0.16.9"),"vditorKatexChemScript").then(function(){S.forEach(function(v){if(!(v.parentElement.classList.contains("vditor-wysiwyg__pre")||v.parentElement.classList.contains("vditor-ir__marker--pre"))&&!v.getAttribute("data-math")){var O=(0,u.p)(m.mathRenderAdapter.getCode(v));v.setAttribute("data-math",O);try{v.innerHTML=katex.renderToString(O,{displayMode:v.tagName==="DIV",output:"html",macros:b.math.macros})}catch(H){v.innerHTML=H.message,v.className="language-math vditor-reset--error"}v.addEventListener("copy",function(H){H.stopPropagation(),H.preventDefault();var z=H.currentTarget.closest(".language-math");H.clipboardData.setData("text/html",z.innerHTML),H.clipboardData.setData("text/plain",z.getAttribute("data-math"))})}})})});else if(b.math.engine==="MathJax"){var M=function(v){if(v.length!==0){var O=0,H=v[v.length-1],z=function(){var I=v[O++];I===H?I():I(z)};z()}};window.MathJax||(window.MathJax={loader:{paths:{mathjax:"".concat(b.cdn,"/dist/js/mathjax")}},startup:{typeset:!1},tex:{macros:b.math.macros}},Object.assign(window.MathJax,b.math.mathJaxOptions)),(0,C.U)("".concat(b.cdn,"/dist/js/mathjax/tex-svg-full.js"),"protyleMathJaxScript");var x=function(v,O){var H=(0,u.p)(v.textContent).trim(),z=window.MathJax.getMetricsFor(v);z.display=v.tagName==="DIV",window.MathJax.tex2svgPromise(H,z).then(function(I){v.innerHTML="",v.setAttribute("data-math",H),v.append(I),window.MathJax.startup.document.clear(),window.MathJax.startup.document.updateDocument();var R=I.querySelector('[data-mml-node="merror"]');R&&R.textContent.trim()!==""&&(v.innerHTML=R.textContent.trim(),v.className="vditor-reset--error"),O&&O()})};window.MathJax.startup.promise.then(function(){for(var v=[],O=function(z){var I=S[z];!I.parentElement.classList.contains("vditor-wysiwyg__pre")&&!I.parentElement.classList.contains("vditor-ir__marker--pre")&&!I.getAttribute("data-math")&&(0,u.p)(I.textContent).trim()&&v.push(function(R){z===S.length-1?x(I):x(I,R)})},H=0;H<S.length;H++)O(H);M(v)})}}}},0:(p,f,y)=>{y.d(f,{l:()=>m});var T=y(933),C=function(g,w){g.insertAdjacentHTML("afterend",'<video controls="controls" src="'.concat(w,'"></video>')),g.remove()},d=function(g,w){g.insertAdjacentHTML("afterend",'<audio controls="controls" src="'.concat(w,'"></audio>')),g.remove()},u=function(g,w){var b=w.match(/\/\/(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))([\w|-]{11})(?:(?:[\?&]t=)(\S+))?/),S=w.match(/\/\/v\.youku\.com\/v_show\/id_(\w+)=*\.html/),_=w.match(/\/\/v\.qq\.com\/x\/cover\/.*\/([^\/]+)\.html\??.*/),M=w.match(/(?:www\.|\/\/)coub\.com\/view\/(\w+)/),x=w.match(/(?:www\.|\/\/)facebook\.com\/([^\/]+)\/videos\/([0-9]+)/),v=w.match(/.+dailymotion.com\/(video|hub)\/(\w+)\?/),O=w.match(/(?:www\.|\/\/)bilibili\.com\/video\/(\w+)/),H=w.match(/(?:www\.|\/\/)ted\.com\/talks\/(\w+)/);if(b&&b[1].length===11)g.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//www.youtube.com/embed/'.concat(b[1]+(b[2]?"?start="+b[2]:""),'"></iframe>')),g.remove();else if(S&&S[1])g.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//player.youku.com/embed/'.concat(S[1],'"></iframe>')),g.remove();else if(_&&_[1])g.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="https://v.qq.com/txp/iframe/player.html?vid='.concat(_[1],'"></iframe>')),g.remove();else if(M&&M[1])g.insertAdjacentHTML("afterend",`<iframe class="iframe__video"
 src="//coub.com/embed/`.concat(M[1],'?muted=false&autostart=false&originalSize=true&startWithHD=true"></iframe>')),g.remove();else if(x&&x[0])g.insertAdjacentHTML("afterend",`<iframe class="iframe__video"
 src="https://www.facebook.com/plugins/video.php?href=`.concat(encodeURIComponent(x[0]),'"></iframe>')),g.remove();else if(v&&v[2])g.insertAdjacentHTML("afterend",`<iframe class="iframe__video"
 src="https://www.dailymotion.com/embed/video/`.concat(v[2],'"></iframe>')),g.remove();else if(w.indexOf("bilibili.com")>-1&&(w.indexOf("bvid=")>-1||O&&O[1])){var z={bvid:(0,T.TK)("bvid",w)||O&&O[1],page:"1",high_quality:"1",as_wide:"1",allowfullscreen:"true",autoplay:"0"};new URL(w.startsWith("http")?w:"https:"+w).search.split("&").forEach(function(N,V){if(N){V===0&&(N=N.substr(1));var se=N.split("=");z[se[0]]=se[1]}});var I="https://player.bilibili.com/player.html?",R=Object.keys(z);R.forEach(function(N,V){I+="".concat(N,"=").concat(z[N]),V<R.length-1&&(I+="&")}),g.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="'.concat(I,'"></iframe>')),g.remove()}else H&&H[1]&&(g.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//embed.ted.com/talks/'.concat(H[1],'"></iframe>')),g.remove())},m=function(g){g&&g.querySelectorAll("a").forEach(function(w){var b=w.getAttribute("href");b&&(b.match(/^.+.(mp4|m4v|ogg|ogv|webm)$/)?C(w,b):b.match(/^.+.(mp3|wav|flac)$/)?d(w,b):u(w,b))})}},975:(p,f,y)=>{y.d(f,{e:()=>w});var T=y(913),C=y(161),d=y(59),u=y(933),m=function(b,S,_,M){function x(v){return v instanceof _?v:new _(function(O){O(v)})}return new(_||(_=Promise))(function(v,O){function H(R){try{I(M.next(R))}catch(N){O(N)}}function z(R){try{I(M.throw(R))}catch(N){O(N)}}function I(R){R.done?v(R.value):x(R.value).then(H,z)}I((M=M.apply(b,S||[])).next())})},g=function(b,S){var _={label:0,sent:function(){if(v[0]&1)throw v[1];return v[1]},trys:[],ops:[]},M,x,v,O;return O={next:H(0),throw:H(1),return:H(2)},typeof Symbol=="function"&&(O[Symbol.iterator]=function(){return this}),O;function H(I){return function(R){return z([I,R])}}function z(I){if(M)throw new TypeError("Generator is already executing.");for(;O&&(O=0,I[0]&&(_=0)),_;)try{if(M=1,x&&(v=I[0]&2?x.return:I[0]?x.throw||((v=x.return)&&v.call(x),0):x.next)&&!(v=v.call(x,I[1])).done)return v;switch(x=0,v&&(I=[I[0]&2,v.value]),I[0]){case 0:case 1:v=I;break;case 4:return _.label++,{value:I[1],done:!1};case 5:_.label++,x=I[1],I=[0];continue;case 7:I=_.ops.pop(),_.trys.pop();continue;default:if(v=_.trys,!(v=v.length>0&&v[v.length-1])&&(I[0]===6||I[0]===2)){_=0;continue}if(I[0]===3&&(!v||I[1]>v[0]&&I[1]<v[3])){_.label=I[1];break}if(I[0]===6&&_.label<v[1]){_.label=v[1],v=I;break}if(v&&_.label<v[2]){_.label=v[2],_.ops.push(I);break}v[2]&&_.ops.pop(),_.trys.pop();continue}I=S.call(b,_)}catch(R){I=[6,R],x=0}finally{M=v=0}if(I[0]&5)throw I[1];return{value:I[0]?I[1]:void 0,done:!0}}},w=function(b,S,_){b===void 0&&(b=document),S===void 0&&(S=T.Y.CDN);var M=d.mermaidRenderAdapter.getElements(b);M.length!==0&&(0,C.Z)("".concat(S,"/dist/js/mermaid/mermaid.min.js"),"vditorMermaidScript").then(function(){var x={securityLevel:"loose",altFontFamily:"sans-serif",fontFamily:"sans-serif",startOnLoad:!1,flowchart:{htmlLabels:!0,useMaxWidth:!0},sequence:{useMaxWidth:!0,diagramMarginX:8,diagramMarginY:8,boxMargin:8,showSequenceNumbers:!0},gantt:{leftPadding:75,rightPadding:20}};_==="dark"&&(x.theme="dark"),mermaid.initialize(x),M.forEach(function(v){return m(void 0,void 0,void 0,function(){var O,H,z,I,R;return g(this,function(N){switch(N.label){case 0:if(O=d.mermaidRenderAdapter.getCode(v),v.getAttribute("data-processed")==="true"||O.trim()==="")return[2];H="mermaid"+(0,u.Ee)(),N.label=1;case 1:return N.trys.push([1,3,,4]),[4,mermaid.render(H,v.textContent)];case 2:return z=N.sent(),v.innerHTML=z.svg,[3,4];case 3:return I=N.sent(),R=document.querySelector("#"+H),v.innerHTML="".concat(R.outerHTML,`<br>
<div style="text-align: left"><small>`).concat(I.message.replace(/\n/,"<br>"),"</small></div>"),R.parentElement.remove(),[3,4];case 4:return v.setAttribute("data-processed","true"),[2]}})})})})}},162:(p,f,y)=>{y.d(f,{l:()=>u});var T=y(913),C=y(161),d=y(59),u=function(m,g,w){m===void 0&&(m=document),g===void 0&&(g=T.Y.CDN);var b=d.mindmapRenderAdapter.getElements(m);b.length>0&&(0,C.Z)("".concat(g,"/dist/js/echarts/echarts.min.js?v=5.5.1"),"vditorEchartsScript").then(function(){b.forEach(function(S){if(!(S.parentElement.classList.contains("vditor-wysiwyg__pre")||S.parentElement.classList.contains("vditor-ir__marker--pre"))){var _=d.mindmapRenderAdapter.getCode(S);if(_)try{if(S.getAttribute("data-processed")==="true")return;echarts.init(S,w==="dark"?"dark":void 0).setOption({series:[{data:[JSON.parse(decodeURIComponent(_))],initialTreeDepth:-1,itemStyle:{borderWidth:0,color:"#4285f4"},label:{backgroundColor:"#f6f8fa",borderColor:"#d1d5da",borderRadius:5,borderWidth:.5,color:"#586069",lineHeight:20,offset:[-5,0],padding:[0,5],position:"insideRight"},lineStyle:{color:"#d1d5da",width:1},roam:!0,symbol:function(M,x){var v;return!((v=x==null?void 0:x.data)===null||v===void 0)&&v.children?"circle":"path://"},type:"tree"}],tooltip:{trigger:"item",triggerOn:"mousemove"}}),S.setAttribute("data-processed","true")}catch(M){S.className="vditor-reset--error",S.innerHTML="mindmap render error: <br>".concat(M)}}})})}},70:(p,f,y)=>{y.d(f,{N:()=>d});var T=y(164),C=y(960),d=function(u,m,g){var w="",b=[];if(Array.from(u.children).forEach(function(x,v){if((0,T.c)(x)){if(g){var O=x.id.lastIndexOf("_");x.id=x.id.substring(0,O===-1?void 0:O)+"_"+v}b.push(x.id),w+=x.outerHTML.replace("<wbr>","")}}),w==="")return m.innerHTML="","";var S=document.createElement("div");if(g)g.lute.SetToC(!0),g.currentMode==="wysiwyg"&&!g.preview.element.contains(u)?S.innerHTML=g.lute.SpinVditorDOM("<p>[ToC]</p>"+w):g.currentMode==="ir"&&!g.preview.element.contains(u)?S.innerHTML=g.lute.SpinVditorIRDOM("<p>[ToC]</p>"+w):S.innerHTML=g.lute.HTML2VditorDOM("<p>[ToC]</p>"+w),g.lute.SetToC(g.options.preview.markdown.toc);else{m.classList.add("vditor-outline");var _=Lute.New();_.SetToC(!0),S.innerHTML=_.HTML2VditorDOM("<p>[ToC]</p>"+w)}var M=S.firstElementChild.querySelectorAll("li > span[data-target-id]");return M.forEach(function(x,v){if(x.nextElementSibling&&x.nextElementSibling.tagName==="UL"){var O="<svg class='vditor-outline__action'><use xlink:href='#vditor-icon-down'></use></svg>";document.getElementById("vditorIconScript")||(O='<svg class="vditor-outline__action" viewBox="0 0 32 32"><path d="M3.76 6.12l12.24 12.213 12.24-12.213 3.76 3.76-16 16-16-16 3.76-3.76z"></path></svg>'),x.innerHTML="".concat(O,"<span>").concat(x.innerHTML,"</span>")}else x.innerHTML="<svg></svg><span>".concat(x.innerHTML,"</span>");x.setAttribute("data-target-id",b[v])}),w=S.firstElementChild.innerHTML,M.length===0?(m.innerHTML="",w):(m.innerHTML=w,g&&(0,C.T)(m,{cdn:g.options.cdn,math:g.options.preview.math}),m.firstElementChild.addEventListener("click",function(x){for(var v=x.target;v&&!v.isEqualNode(m);){if(v.classList.contains("vditor-outline__action")){v.classList.contains("vditor-outline__action--close")?(v.classList.remove("vditor-outline__action--close"),v.parentElement.nextElementSibling.setAttribute("style","display:block")):(v.classList.add("vditor-outline__action--close"),v.parentElement.nextElementSibling.setAttribute("style","display:none")),x.preventDefault(),x.stopPropagation();break}else if(v.getAttribute("data-target-id")){x.preventDefault(),x.stopPropagation();var O=document.getElementById(v.getAttribute("data-target-id"));if(!O)return;if(g)if(g.options.height==="auto"){var H=O.offsetTop+g.element.offsetTop;g.options.toolbarConfig.pin||(H+=g.toolbar.element.offsetHeight),window.scrollTo(window.scrollX,H)}else g.element.offsetTop<window.scrollY&&window.scrollTo(window.scrollX,g.element.offsetTop),g.preview.element.contains(u)?u.parentElement.scrollTop=O.offsetTop:u.scrollTop=O.offsetTop;else window.scrollTo(window.scrollX,O.offsetTop);break}v=v.parentElement}}),w)}},591:(p,f,y)=>{y.d(f,{M:()=>u});var T=y(913),C=y(161),d=y(59),u=function(m,g){m===void 0&&(m=document),g===void 0&&(g=T.Y.CDN);var w=d.plantumlRenderAdapter.getElements(m);w.length!==0&&(0,C.Z)("".concat(g,"/dist/js/plantuml/plantuml-encoder.min.js"),"vditorPlantumlScript").then(function(){w.forEach(function(b){if(!(b.parentElement.classList.contains("vditor-wysiwyg__pre")||b.parentElement.classList.contains("vditor-ir__marker--pre"))){var S=d.plantumlRenderAdapter.getCode(b).trim();if(S)try{b.innerHTML='<object type="image/svg+xml" data="https://www.plantuml.com/plantuml/svg/~1'.concat(plantumlEncoder.encode(S),'"/>')}catch(_){b.className="vditor-reset--error",b.innerHTML="plantuml render error: <br>".concat(_)}}})})}},796:(p,f,y)=>{y.d(f,{X:()=>T});var T=function(C){var d=Lute.New();return d.PutEmojis(C.emojis),d.SetEmojiSite(C.emojiSite),d.SetHeadingAnchor(C.headingAnchor),d.SetInlineMathAllowDigitAfterOpenMarker(C.inlineMathDigit),d.SetAutoSpace(C.autoSpace),d.SetToC(C.toc),d.SetFootnotes(C.footnotes),d.SetFixTermTypo(C.fixTermTypo),d.SetVditorCodeBlockPreview(C.codeBlockPreview),d.SetVditorMathBlockPreview(C.mathBlockPreview),d.SetSanitize(C.sanitize),d.SetChineseParagraphBeginningSpace(C.paragraphBeginningSpace),d.SetRenderListStyle(C.listStyle),d.SetLinkBase(C.linkBase),d.SetLinkPrefix(C.linkPrefix),d.SetMark(C.mark),d.SetGFMAutoLink(C.gfmAutoLink),C.lazyLoadImage&&d.SetImageLazyLoading(C.lazyLoadImage),d}},726:(p,f,y)=>{y.d(f,{o:()=>T});var T=function(C,d,u){u===void 0&&(u="classic");var m=C.getBoundingClientRect(),g=36;document.body.insertAdjacentHTML("beforeend",'<div class="vditor vditor-img'.concat(u==="dark"?" vditor--dark":"",`">
    <div class="vditor-img__bar">
      <span class="vditor-img__btn" data-deg="0">
        <svg><use xlink:href="#vditor-icon-redo"></use></svg>
        `).concat(window.VditorI18n.spin,`
      </span>
      <span class="vditor-img__btn"  onclick="this.parentElement.parentElement.outerHTML = '';document.body.style.overflow = ''">
        X &nbsp;`).concat(window.VditorI18n.close,`
      </span>
    </div>
    <div class="vditor-img__img" onclick="this.parentElement.outerHTML = '';document.body.style.overflow = ''">
      <img style="width: `).concat(C.width,"px;height:").concat(C.height,"px;transform: translate3d(").concat(m.left,"px, ").concat(m.top-g,'px, 0)" src="').concat(C.getAttribute("src"),`">
    </div>
</div>`)),document.body.style.overflow="hidden";var w=document.querySelector(".vditor-img img"),b="translate3d(".concat(Math.max(0,window.innerWidth-C.naturalWidth)/2,"px, ").concat(Math.max(0,window.innerHeight-g-C.naturalHeight)/2,"px, 0)");setTimeout(function(){w.setAttribute("style","transition: transform .3s ease-in-out;transform: ".concat(b)),setTimeout(function(){w.parentElement.scrollTo((w.parentElement.scrollWidth-w.parentElement.clientWidth)/2,(w.parentElement.scrollHeight-w.parentElement.clientHeight)/2)},400)});var S=document.querySelector(".vditor-img__btn");S.addEventListener("click",function(){var _=parseInt(S.getAttribute("data-deg"),10)+90;_/90%2===1&&C.naturalWidth>w.parentElement.clientHeight?w.style.transform="translate3d(".concat(Math.max(0,window.innerWidth-C.naturalWidth)/2,"px, ").concat(C.naturalWidth/2-C.naturalHeight/2,"px, 0) rotateZ(").concat(_,"deg)"):w.style.transform="".concat(b," rotateZ(").concat(_,"deg)"),S.setAttribute("data-deg",_.toString()),setTimeout(function(){w.parentElement.scrollTo((w.parentElement.scrollWidth-w.parentElement.clientWidth)/2,(w.parentElement.scrollHeight-w.parentElement.clientHeight)/2)},400)})}},13:(p,f,y)=>{y.d(f,{h:()=>d});var T=y(913),C=y(505),d=function(u,m){m===void 0&&(m=T.Y.CDN),T.Y.CODE_THEME.includes(u)||(u="github");var g=document.getElementById("vditorHljsStyle"),w="".concat(m,"/dist/js/highlight.js/styles/").concat(u,".min.css");g?g.getAttribute("href")!==w&&(g.remove(),(0,C.T)(w,"vditorHljsStyle")):(0,C.T)(w,"vditorHljsStyle")}},873:(p,f,y)=>{y.d(f,{H:()=>C});var T=y(505),C=function(d,u){if(!(!d||!u)){var m=document.getElementById("vditorContentTheme"),g="".concat(u,"/").concat(d,".css");m?m.getAttribute("href")!==g&&(m.remove(),(0,T.T)(g,"vditorContentTheme")):(0,T.T)(g,"vditorContentTheme")}}},161:(p,f,y)=>{y.d(f,{U:()=>T,Z:()=>C});var T=function(d,u){if(document.getElementById(u))return!1;var m=new XMLHttpRequest;m.open("GET",d,!1),m.setRequestHeader("Accept","text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01"),m.send("");var g=document.createElement("script");g.type="text/javascript",g.text=m.responseText,g.id=u,document.head.appendChild(g)},C=function(d,u){return new Promise(function(m,g){if(document.getElementById(u))return m(!0),!1;var w=document.createElement("script");w.src=d,w.async=!0,document.head.appendChild(w),w.onerror=function(b){g(b)},w.onload=function(){if(document.getElementById(u))return w.remove(),m(!0),!1;w.id=u,m(!0)}})}},505:(p,f,y)=>{y.d(f,{T:()=>T});var T=function(C,d){if(!document.getElementById(d)){var u=document.createElement("link");u.id=d,u.rel="stylesheet",u.type="text/css",u.href=C,document.getElementsByTagName("head")[0].appendChild(u)}}},695:(p,f,y)=>{y.d(f,{p:()=>T});var T=function(C){return C.replace(/\u00a0/g," ")}},629:(p,f,y)=>{y.d(f,{D:()=>d,H8:()=>w,_0:()=>m,fG:()=>g,gm:()=>C,nr:()=>T,y3:()=>u});var T=function(){return navigator.userAgent.indexOf("Safari")>-1&&navigator.userAgent.indexOf("Chrome")===-1},C=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},d=function(){try{return typeof localStorage<"u"}catch{return!1}},u=function(){return navigator.userAgent.indexOf("iPhone")>-1?"touchstart":"click"},m=function(b){return navigator.platform.toUpperCase().indexOf("MAC")>=0?!!(b.metaKey&&!b.ctrlKey):!!(!b.metaKey&&b.ctrlKey)},g=function(b){return/Mac/.test(navigator.platform)||navigator.platform==="iPhone"?b.indexOf("⇧")>-1&&C()&&(b=b.replace(";",":").replace("=","+").replace("-","_")):(b.startsWith("⌘")?b=b.replace("⌘","⌘+"):b.startsWith("⌥")&&b.substr(1,1)!=="⌘"?b=b.replace("⌥","⌥+"):b=b.replace("⇧⌘","⌘+⇧+").replace("⌥⌘","⌥+⌘+"),b=b.replace("⌘","Ctrl").replace("⇧","Shift").replace("⌥","Alt"),b.indexOf("Shift")>-1&&(b=b.replace(";",":").replace("=","+").replace("-","_"))),b},w=function(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}},933:(p,f,y)=>{y.d(f,{Ee:()=>T,TK:()=>C,kY:()=>d});var T=function(){return([1e7].toString()+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(u){return(parseInt(u,10)^window.crypto.getRandomValues(new Uint32Array(1))[0]&15>>parseInt(u,10)/4).toString(16)})},C=function(u,m){m===void 0&&(m=window.location.search);var g=m.substring(m.indexOf("?")),w=g.indexOf("#"),b=new URLSearchParams(g.substring(0,w>=0?w:void 0));return b.get(u)},d=function(u){return Function('"use strict";return ('.concat(u,")"))()}},598:(p,f,y)=>{y.d(f,{Ab:()=>d,KJ:()=>b,KR:()=>u,Rp:()=>S,Th:()=>m,XW:()=>C,_Y:()=>w,pt:()=>g});var T=y(164),C=function(_,M){for(var x=b(_,M),v=!1,O=!1;x&&!x.classList.contains("vditor-reset")&&!O;)v=b(x.parentElement,M),v?x=v:O=!0;return x||!1},d=function(_,M){for(var x=(0,T.f)(_,M),v=!1,O=!1;x&&!x.classList.contains("vditor-reset")&&!O;)v=(0,T.f)(x.parentElement,M),v?x=v:O=!0;return x||!1},u=function(_){var M=d(_,"UL"),x=d(_,"OL"),v=M;return x&&(!M||M&&x.contains(M))&&(v=x),v},m=function(_,M,x){if(!_)return!1;_.nodeType===3&&(_=_.parentElement);for(var v=_,O=!1;v&&!O&&!v.classList.contains("vditor-reset");)v.getAttribute(M)===x?O=!0:v=v.parentElement;return O&&v},g=function(_){if(!_)return!1;_.nodeType===3&&(_=_.parentElement);var M=_,x=!1,v=m(_,"data-block","0");if(v)return v;for(;M&&!x&&!M.classList.contains("vditor-reset");)M.tagName==="H1"||M.tagName==="H2"||M.tagName==="H3"||M.tagName==="H4"||M.tagName==="H5"||M.tagName==="H6"||M.tagName==="P"||M.tagName==="BLOCKQUOTE"||M.tagName==="OL"||M.tagName==="UL"?x=!0:M=M.parentElement;return x&&M},w=function(_,M){if(!_)return!1;_.nodeType===3&&(_=_.parentElement);for(var x=_,v=!1;x&&!v&&!x.classList.contains("vditor-reset");)x.nodeName===M?v=!0:x=x.parentElement;return v&&x},b=function(_,M){if(!_)return!1;_.nodeType===3&&(_=_.parentElement);for(var x=_,v=!1;x&&!v&&!x.classList.contains("vditor-reset");)x.classList.contains(M)?v=!0:x=x.parentElement;return v&&x},S=function(_){for(;_&&_.lastChild;)_=_.lastChild;return _}},164:(p,f,y)=>{y.d(f,{c:()=>C,f:()=>T});var T=function(d,u){if(!d)return!1;d.nodeType===3&&(d=d.parentElement);for(var m=d,g=!1;m&&!g&&!m.classList.contains("vditor-reset");)m.nodeName.indexOf(u)===0?g=!0:m=m.parentElement;return g&&m},C=function(d){var u=T(d,"H");return u&&u.tagName.length===2&&u.tagName!=="HR"?u:!1}},905:(p,f,y)=>{y.d(f,{h:()=>T});var T=function(){for(var C=[],d=0;d<arguments.length;d++)C[d]=arguments[d];for(var u={},m=function(w){for(var b in w)w.hasOwnProperty(b)&&(Object.prototype.toString.call(w[b])==="[object Object]"?u[b]=T(u[b],w[b]):u[b]=w[b])},g=0;g<C.length;g++)m(C[g]);return u}},827:(p,f,y)=>{y.d(f,{Co:()=>g,ED:()=>b,Ey:()=>m,Fm:()=>S,RN:()=>u,Z2:()=>M,ir:()=>_,jl:()=>w});var T=y(913),C=y(629),d=y(598),u=function(x){var v,O=x[x.currentMode].element;return getSelection().rangeCount>0&&(v=getSelection().getRangeAt(0),O.isEqualNode(v.startContainer)||O.contains(v.startContainer))?v:x[x.currentMode].range?x[x.currentMode].range:(O.focus(),v=O.ownerDocument.createRange(),v.setStart(O,0),v.collapse(!0),v)},m=function(x){var v=window.getSelection().getRangeAt(0);if(!x.contains(v.startContainer)&&!(0,d.KJ)(v.startContainer,"vditor-panel--none"))return{left:0,top:0};var O=x.parentElement.getBoundingClientRect(),H;if(v.getClientRects().length===0)if(v.startContainer.nodeType===3){var z=v.startContainer.parentElement;if(z&&z.getClientRects().length>0)H=z.getClientRects()[0];else return{left:0,top:0}}else{var I=v.startContainer.children;if(I[v.startOffset]&&I[v.startOffset].getClientRects().length>0)H=I[v.startOffset].getClientRects()[0];else if(v.startContainer.childNodes.length>0){var R=v.cloneRange();v.selectNode(v.startContainer.childNodes[Math.max(0,v.startOffset-1)]),H=v.getClientRects()[0],v.setEnd(R.endContainer,R.endOffset),v.setStart(R.startContainer,R.startOffset)}else H=v.startContainer.getClientRects()[0];if(!H){for(var N=v.startContainer.childNodes[v.startOffset];!N.getClientRects||N.getClientRects&&N.getClientRects().length===0;)N=N.parentElement;H=N.getClientRects()[0]}}else H=v.getClientRects()[0];return{left:H.left-O.left,top:H.top-O.top}},g=function(x,v){if(!v){if(getSelection().rangeCount===0)return!1;v=getSelection().getRangeAt(0)}var O=v.commonAncestorContainer;return x.isEqualNode(O)||x.contains(O)},w=function(x){var v=window.getSelection();v.removeAllRanges(),v.addRange(x)},b=function(x,v,O){var H={end:0,start:0};if(!O){if(getSelection().rangeCount===0)return H;O=window.getSelection().getRangeAt(0)}if(g(v,O)){var z=O.cloneRange();x.childNodes[0]&&x.childNodes[0].childNodes[0]?z.setStart(x.childNodes[0].childNodes[0],0):z.selectNodeContents(x),z.setEnd(O.startContainer,O.startOffset),H.start=z.toString().length,H.end=H.start+O.toString().length}return H},S=function(x,v,O){var H=0,z=0,I=O.childNodes[z],R=!1,N=!1;x=Math.max(0,x),v=Math.max(0,v);var V=O.ownerDocument.createRange();for(V.setStart(I||O,0),V.collapse(!0);!N&&I;){var se=H+I.textContent.length;if(!R&&x>=H&&x<=se&&(x===0?V.setStart(I,0):I.childNodes[0].nodeType===3?V.setStart(I.childNodes[0],x-H):I.nextSibling?V.setStartBefore(I.nextSibling):V.setStartAfter(I),R=!0,x===v)){N=!0;break}R&&v>=H&&v<=se&&(v===0?V.setEnd(I,0):I.childNodes[0].nodeType===3?V.setEnd(I.childNodes[0],v-H):I.nextSibling?V.setEndBefore(I.nextSibling):V.setEndAfter(I),N=!0),H=se,I=O.childNodes[++z]}return!N&&O.childNodes[z-1]&&V.setStartBefore(O.childNodes[z-1]),w(V),V},_=function(x,v){var O=x.querySelector("wbr");if(O){if(!O.previousElementSibling)O.previousSibling?v.setStart(O.previousSibling,O.previousSibling.textContent.length):O.nextSibling?O.nextSibling.nodeType===3?v.setStart(O.nextSibling,0):v.setStartBefore(O.nextSibling):v.setStart(O.parentElement,0);else if(O.previousElementSibling.isSameNode(O.previousSibling))if(O.previousElementSibling.lastChild){v.setStartBefore(O),v.collapse(!0),w(v),(0,C.H8)()&&(O.previousElementSibling.tagName==="EM"||O.previousElementSibling.tagName==="STRONG"||O.previousElementSibling.tagName==="S")&&(v.insertNode(document.createTextNode(T.Y.ZWSP)),v.collapse(!1)),O.remove();return}else v.setStartAfter(O.previousElementSibling);else v.setStart(O.previousSibling,O.previousSibling.textContent.length);v.collapse(!0),O.remove(),w(v)}},M=function(x,v){var O=document.createElement("div");O.innerHTML=x;var H=O.querySelectorAll("p");H.length===1&&!H[0].previousSibling&&!H[0].nextSibling&&v[v.currentMode].element.children.length>0&&O.firstElementChild.tagName==="P"&&(x=H[0].innerHTML.trim());var z=document.createElement("div");z.innerHTML=x;var I=u(v);if(I.toString()!==""&&(v[v.currentMode].preventInput=!0,document.execCommand("delete",!1,"")),z.firstElementChild&&z.firstElementChild.getAttribute("data-block")==="0"){z.lastElementChild.insertAdjacentHTML("beforeend","<wbr>");var R=(0,d.pt)(I.startContainer);R?R.insertAdjacentHTML("afterend",z.innerHTML):v[v.currentMode].element.insertAdjacentHTML("beforeend",z.innerHTML),_(v[v.currentMode].element,I)}else{var N=document.createElement("template");N.innerHTML=x,I.insertNode(N.content.cloneNode(!0)),I.collapse(!1),w(I)}}}},s={};function c(p){var f=s[p];if(f!==void 0)return f.exports;var y=s[p]={exports:{}};return r[p](y,y.exports,c),y.exports}c.d=(p,f)=>{for(var y in f)c.o(f,y)&&!c.o(p,y)&&Object.defineProperty(p,y,{enumerable:!0,get:f[y]})},c.o=(p,f)=>Object.prototype.hasOwnProperty.call(p,f),c.r=p=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(p,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(p,"__esModule",{value:!0})};var h={};return(()=>{c.d(h,{default:()=>Gs});var p=c(923),f=c(913),y=c(695),T=function(e){return e.currentMode==="sv"?(0,y.p)("".concat(e.sv.element.textContent,`
`).replace(/\n\n$/,`
`)):e.currentMode==="wysiwyg"?e.lute.VditorDOM2Md(e.wysiwyg.element.innerHTML):e.currentMode==="ir"?e.lute.VditorIRDOM2Md(e.ir.element.innerHTML):""},C=c(161),d=function(){function e(){this.element=document.createElement("div"),this.element.className="vditor-devtools",this.element.innerHTML='<div class="vditor-reset--error"></div><div style="height: 100%;"></div>'}return e.prototype.renderEchart=function(t){var i=this;t.devtools.element.style.display==="block"&&(0,C.Z)("".concat(t.options.cdn,"/dist/js/echarts/echarts.min.js?v=5.5.1"),"vditorEchartsScript").then(function(){i.ASTChart||(i.ASTChart=echarts.init(t.devtools.element.lastElementChild));try{i.element.lastElementChild.style.display="block",i.element.firstElementChild.innerHTML="",i.ASTChart.setOption({series:[{data:JSON.parse(t.lute.RenderEChartsJSON(T(t))),initialTreeDepth:-1,label:{align:"left",backgroundColor:"rgba(68, 77, 86, .68)",borderRadius:3,color:"#d1d5da",fontSize:12,lineHeight:12,offset:[9,12],padding:[2,4,2,4],position:"top",verticalAlign:"middle"},lineStyle:{color:"#4285f4",type:"curve",width:1},orient:"vertical",roam:!0,type:"tree"}],toolbox:{bottom:25,emphasis:{iconStyle:{color:"#4285f4"}},feature:{restore:{show:!0},saveAsImage:{show:!0}},right:15,show:!0}}),i.ASTChart.resize()}catch(a){i.element.lastElementChild.style.display="none",i.element.firstElementChild.innerHTML=a}})},e}(),u=c(629),m=function(e,t){t.forEach(function(i){if(e[i]){var a=e[i].children[0];a&&a.classList.contains("vditor-menu--current")&&a.classList.remove("vditor-menu--current")}})},g=function(e,t){t.forEach(function(i){if(e[i]){var a=e[i].children[0];a&&!a.classList.contains("vditor-menu--current")&&a.classList.add("vditor-menu--current")}})},w=function(e,t){t.forEach(function(i){if(e[i]){var a=e[i].children[0];a&&a.classList.contains(f.Y.CLASS_MENU_DISABLED)&&a.classList.remove(f.Y.CLASS_MENU_DISABLED)}})},b=function(e,t){t.forEach(function(i){if(e[i]){var a=e[i].children[0];a&&!a.classList.contains(f.Y.CLASS_MENU_DISABLED)&&a.classList.add(f.Y.CLASS_MENU_DISABLED)}})},S=function(e,t){t.forEach(function(i){e[i]&&e[i]&&(e[i].style.display="none")})},_=function(e,t){t.forEach(function(i){e[i]&&e[i]&&(e[i].style.display="block")})},M=function(e,t,i){t.includes("subToolbar")&&(e.toolbar.element.querySelectorAll(".vditor-hint").forEach(function(a){i&&a.isEqualNode(i)||(a.style.display="none")}),e.toolbar.elements.emoji&&(e.toolbar.elements.emoji.lastElementChild.style.display="none")),t.includes("hint")&&(e.hint.element.style.display="none"),e.wysiwyg.popover&&t.includes("popover")&&(e.wysiwyg.popover.style.display="none")},x=function(e,t,i,a){i.addEventListener((0,u.y3)(),function(o){o.preventDefault(),o.stopPropagation(),!i.classList.contains(f.Y.CLASS_MENU_DISABLED)&&(e.toolbar.element.querySelectorAll(".vditor-hint--current").forEach(function(l){l.classList.remove("vditor-hint--current")}),t.style.display==="block"?t.style.display="none":(M(e,["subToolbar","hint","popover"],i.parentElement.parentElement),i.classList.contains("vditor-tooltipped")||i.classList.add("vditor-hint--current"),t.style.display="block",e.toolbar.element.getBoundingClientRect().right-i.getBoundingClientRect().right<250?t.classList.add("vditor-panel--left"):t.classList.remove("vditor-panel--left")))})},v=c(598),O=c(164),H=function(e,t,i,a){a&&console.log("".concat(e," - ").concat(i,": ").concat(t))},z=c(288),I=c(784),R=c(51),N=c(500),V=c(339),se=c(108),ue=c(960),ke=c(975),Re=c(597),_e=c(162),Te=c(591),Ne=c(931),Oe=function(e,t,i){i===void 0&&(i="sv");var a=document.createElement("div");a.innerHTML=e;var o=!1;a.childElementCount===1&&a.lastElementChild.style.fontFamily.indexOf("monospace")>-1&&(o=!0);var l=a.querySelectorAll("pre");if(a.childElementCount===1&&l.length===1&&l[0].className!=="vditor-wysiwyg"&&l[0].className!=="vditor-sv"&&(o=!0),e.indexOf(`
<p class="p1">`)===0&&(o=!0),a.childElementCount===1&&a.firstElementChild.tagName==="TABLE"&&a.querySelector(".line-number")&&a.querySelector(".line-content")&&(o=!0),o){var E=t||e;return/\n/.test(E)||l.length===1?i==="wysiwyg"?'<div class="vditor-wysiwyg__block" data-block="0" data-type="code-block"><pre><code>'.concat(E.replace(/&/g,"&amp;").replace(/</g,"&lt;"),"<wbr></code></pre></div>"):"\n```\n"+E.replace(/&/g,"&amp;").replace(/</g,"&lt;")+"\n```":i==="wysiwyg"?"<code>".concat(E.replace(/&/g,"&amp;").replace(/</g,"&lt;"),"</code><wbr>"):"`".concat(E,"`")}return!1},$e=function(e,t){if(e){if(e.parentElement.getAttribute("data-type")==="html-block"){e.setAttribute("data-render","1");return}var i=e.firstElementChild.className.replace("language-","");if(i==="abc")(0,z.$)(e,t.options.cdn);else if(i==="mermaid")(0,ke.e)(e,t.options.cdn,t.options.theme);else if(i==="smiles")(0,Ne.Y)(e,t.options.cdn,t.options.theme);else if(i==="markmap")(0,Re.K)(e,t.options.cdn);else if(i==="flowchart")(0,N.D)(e,t.options.cdn);else if(i==="echarts")(0,I.v)(e,t.options.cdn,t.options.theme);else if(i==="mindmap")(0,_e.l)(e,t.options.cdn,t.options.theme);else if(i==="plantuml")(0,Te.M)(e,t.options.cdn);else if(i==="graphviz")(0,V.m)(e,t.options.cdn);else if(i==="math")(0,ue.T)(e,{cdn:t.options.cdn,math:t.options.preview.math});else{var a=t.options.customRenders.find(function(o){if(o.language===i)return o.render(e,t),!0});a||((0,se.$)(Object.assign({},t.options.preview.hljs),e,t.options.cdn),(0,R.o)(e,t.options.preview.hljs))}e.setAttribute("data-render","1")}},j=c(827),ce=function(e){if(e.currentMode!=="sv"){var t=e[e.currentMode].element,i=e.outline.render(e);i===""&&(i="[ToC]"),t.querySelectorAll('[data-type="toc-block"]').forEach(function(a){a.innerHTML=i,(0,ue.T)(a,{cdn:e.options.cdn,math:e.options.preview.math})})}},G=function(e,t){var i=(0,v._Y)(e.target,"SPAN");if(i&&(0,v.KJ)(i,"vditor-toc")){var a=t[t.currentMode].element.querySelector("#"+i.getAttribute("data-target-id"));if(a)if(t.options.height==="auto"){var o=a.offsetTop+t.element.offsetTop;t.options.toolbarConfig.pin||(o+=t.toolbar.element.offsetHeight),window.scrollTo(window.scrollX,o)}else t.element.offsetTop<window.scrollY&&window.scrollTo(window.scrollX,t.element.offsetTop),t[t.currentMode].element.scrollTop=a.offsetTop;return}},W=function(e,t,i,a){if(e.previousElementSibling&&e.previousElementSibling.classList.contains("vditor-toc")){if(i.key==="Backspace"&&(0,j.ED)(e,t[t.currentMode].element,a).start===0)return e.previousElementSibling.remove(),Ke(t),!0;if(Mn(t,i,a,e,e.previousElementSibling))return!0}if(e.nextElementSibling&&e.nextElementSibling.classList.contains("vditor-toc")){if(i.key==="Delete"&&(0,j.ED)(e,t[t.currentMode].element,a).start>=e.textContent.trimRight().length)return e.nextElementSibling.remove(),Ke(t),!0;if(qn(t,i,a,e,e.nextElementSibling))return!0}if(i.key==="Backspace"||i.key==="Delete"){var o=(0,v.KJ)(a.startContainer,"vditor-toc");if(o)return o.remove(),Ke(t),!0}},Z=function(e,t,i,a){i===void 0&&(i=!1);var o=(0,v.pt)(t.startContainer);if(o&&!i&&o.getAttribute("data-type")!=="code-block"){if(Gi(o.innerHTML)&&o.previousElementSibling||Zi(o.innerHTML))return;for(var l=(0,j.ED)(o,e.ir.element,t).start,E=!0,L=l-1;L>o.textContent.substr(0,l).lastIndexOf(`
`);L--)if(o.textContent.charAt(L)!==" "&&o.textContent.charAt(L)!=="	"){E=!1;break}l===0&&(E=!1);for(var D=!0,L=l-1;L<o.textContent.length;L++)if(o.textContent.charAt(L)!==" "&&o.textContent.charAt(L)!==`
`){D=!1;break}if(E){typeof e.options.input=="function"&&e.options.input(T(e));return}if(D&&/^#{1,6} $/.test(o.textContent)&&(D=!1),D){var A=(0,v.KJ)(t.startContainer,"vditor-ir__marker");if(!A){var P=t.startContainer.previousSibling;P&&P.nodeType!==3&&P.classList.contains("vditor-ir__node--expand")&&P.classList.remove("vditor-ir__node--expand"),typeof e.options.input=="function"&&e.options.input(T(e));return}}}if(e.ir.element.querySelectorAll(".vditor-ir__node--expand").forEach(function(We){We.classList.remove("vditor-ir__node--expand")}),o||(o=e.ir.element),!o.querySelector("wbr")){var F=(0,v.KJ)(t.startContainer,"vditor-ir__preview");F?F.previousElementSibling.insertAdjacentHTML("beforeend","<wbr>"):t.insertNode(document.createElement("wbr"))}o.querySelectorAll("[style]").forEach(function(We){We.removeAttribute("style")}),o.getAttribute("data-type")==="link-ref-defs-block"&&(o=e.ir.element);var le=o.isEqualNode(e.ir.element),oe=(0,v.Th)(o,"data-type","footnotes-block"),te="";if(le)te=o.innerHTML;else{var Ce=(0,O.f)(t.startContainer,"BLOCKQUOTE"),he=(0,v.KR)(t.startContainer);if(he&&(o=he),Ce&&(!he||he&&!Ce.contains(he))&&(o=Ce),oe&&(o=oe),te=o.outerHTML,o.tagName==="UL"||o.tagName==="OL"){var Q=o.previousElementSibling,Ie=o.nextElementSibling;Q&&(Q.tagName==="UL"||Q.tagName==="OL")&&(te=Q.outerHTML+te,Q.remove()),Ie&&(Ie.tagName==="UL"||Ie.tagName==="OL")&&(te=te+Ie.outerHTML,Ie.remove()),te=te.replace("<div><wbr><br></div>","<li><p><wbr><br></p></li>")}else o.previousElementSibling&&o.previousElementSibling.textContent.replace(f.Y.ZWSP,"")!==""&&a&&a.inputType==="insertParagraph"&&(te=o.previousElementSibling.outerHTML+te,o.previousElementSibling.remove());o.innerText.startsWith("```")||(e.ir.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(We){We&&!o.isEqualNode(We)&&(te+=We.outerHTML,We.remove())}),e.ir.element.querySelectorAll("[data-type='footnotes-block']").forEach(function(We){We&&!o.isEqualNode(We)&&(te+=We.outerHTML,We.remove())}))}if(H("SpinVditorIRDOM",te,"argument",e.options.debugger),te=e.lute.SpinVditorIRDOM(te),H("SpinVditorIRDOM",te,"result",e.options.debugger),le)o.innerHTML=te;else if(o.outerHTML=te,oe){var we=(0,v.Th)(e.ir.element.querySelector("wbr"),"data-type","footnotes-def");if(we){var je=we.textContent,ot=je.substring(1,je.indexOf("]:")),it=e.ir.element.querySelector('sup[data-type="footnotes-ref"][data-footnotes-label="'.concat(ot,'"]'));it&&it.setAttribute("aria-label",je.substr(ot.length+3).trim().substr(0,24))}}var st,Pt=e.ir.element.querySelectorAll("[data-type='link-ref-defs-block']");Pt.forEach(function(We,yt){yt===0?st=We:(st.insertAdjacentHTML("beforeend",We.innerHTML),We.remove())}),Pt.length>0&&e.ir.element.insertAdjacentElement("beforeend",Pt[0]);var _t,Rt=e.ir.element.querySelectorAll("[data-type='footnotes-block']");Rt.forEach(function(We,yt){yt===0?_t=We:(_t.insertAdjacentHTML("beforeend",We.innerHTML),We.remove())}),Rt.length>0&&e.ir.element.insertAdjacentElement("beforeend",Rt[0]),(0,j.ir)(e.ir.element,t),e.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach(function(We){$e(We,e)}),ce(e),nn(e,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},B=function(e,t){if(e==="")return!1;if(e.indexOf("⇧")===-1&&e.indexOf("⌘")===-1&&e.indexOf("⌥")===-1)return!(0,u._0)(t)&&!t.altKey&&!t.shiftKey&&t.code===e;if(e==="⇧Tab")return!!(!(0,u._0)(t)&&!t.altKey&&t.shiftKey&&t.code==="Tab");var i=e.split("");if(e.startsWith("⌥")){var a=i.length===3?i[2]:i[1];return!!((i.length===3?(0,u._0)(t):!(0,u._0)(t))&&t.altKey&&!t.shiftKey&&t.code===(/^[0-9]$/.test(a)?"Digit":"Key")+a)}e==="⌘Enter"&&(i=["⌘","Enter"]);var o=i.length>2&&i[0]==="⇧",l=o?i[2]:i[1];return o&&((0,u.gm)()||!/Mac/.test(navigator.platform))&&(l==="-"?l="_":l==="="&&(l="+")),!!((0,u._0)(t)&&t.key.toLowerCase()===l.toLowerCase()&&!t.altKey&&(!o&&!t.shiftKey||o&&t.shiftKey))},ae=function(e){var t=e.startContainer;if(t.nodeType===3&&t.nodeValue.length!==e.startOffset)return!1;for(var i=t.nextSibling;i&&i.textContent==="";)i=i.nextSibling;if(i){if(i&&i.nodeType!==3&&i.classList.contains("vditor-ir__node")&&!i.getAttribute("data-block"))return i}else{var a=(0,v.KJ)(t,"vditor-ir__marker");if(a&&!a.nextSibling){var o=t.parentElement.parentElement.nextSibling;if(o&&o.nodeType!==3&&o.classList.contains("vditor-ir__node"))return o}return!1}return!1},K=function(e){var t=e.startContainer,i=t.previousSibling;return t.nodeType===3&&e.startOffset===0&&i&&i.nodeType!==3&&i.classList.contains("vditor-ir__node")&&!i.getAttribute("data-block")?i:!1},$=function(e,t){t.ir.element.querySelectorAll(".vditor-ir__node--expand").forEach(function(E){E.classList.remove("vditor-ir__node--expand")});var i=(0,v.XW)(e.startContainer,"vditor-ir__node"),a=!e.collapsed&&(0,v.XW)(e.endContainer,"vditor-ir__node");if(!(!e.collapsed&&(!i||i!==a))){i&&(i.classList.add("vditor-ir__node--expand"),i.classList.remove("vditor-ir__node--hidden"),(0,j.jl)(e));var o=ae(e);if(o){o.classList.add("vditor-ir__node--expand"),o.classList.remove("vditor-ir__node--hidden");return}var l=K(e);if(l){l.classList.add("vditor-ir__node--expand"),l.classList.remove("vditor-ir__node--hidden");return}}},xe=function(e,t){if(e.ir.composingLock=t.isComposing,t.isComposing)return!1;t.key.indexOf("Arrow")===-1&&t.key!=="Meta"&&t.key!=="Control"&&t.key!=="Alt"&&t.key!=="Shift"&&t.key!=="CapsLock"&&t.key!=="Escape"&&!/^F\d{1,2}$/.test(t.key)&&e.undo.recordFirstPosition(e,t);var i=(0,j.RN)(e),a=i.startContainer;if(!Rr(t,e,a)||(Ir(i,e,t),Zr(i),t.key!=="Enter"&&t.key!=="Tab"&&t.key!=="Backspace"&&t.key.indexOf("Arrow")===-1&&!(0,u._0)(t)&&t.key!=="Escape"&&t.key!=="Delete"))return!1;var o=(0,v.Th)(a,"data-newline","1");if(!(0,u._0)(t)&&!t.altKey&&!t.shiftKey&&t.key==="Enter"&&o&&i.startOffset<o.textContent.length){var l=o.previousElementSibling;l&&(i.insertNode(document.createTextNode(l.textContent)),i.collapse(!1));var E=o.nextSibling;E&&(i.insertNode(document.createTextNode(E.textContent)),i.collapse(!0))}var L=(0,v._Y)(a,"P");if(zr(t,e,L,i)||Br(i,e,L,t)||Yr(e,i,t,L))return!0;var D=(0,v.KJ)(a,"vditor-ir__marker--pre");if(D&&D.tagName==="PRE"){var A=D.firstChild;if(Wr(e,t,D,i)||(A.getAttribute("data-type")==="math-block"||A.getAttribute("data-type")==="html-block")&&Mn(e,t,i,A,D.parentElement)||qn(e,t,i,A,D.parentElement))return!0}var P=(0,v.Th)(a,"data-type","code-block-info");if(P){if(t.key==="Enter"||t.key==="Tab")return i.selectNodeContents(P.nextElementSibling.firstChild),i.collapse(!0),t.preventDefault(),M(e,["hint"]),!0;if(t.key==="Backspace"){var F=(0,j.ED)(P,e.ir.element).start;F===1&&i.setStart(a,0),F===2&&(e.hint.recentLanguage="")}if(Mn(e,t,i,P,P.parentElement))return M(e,["hint"]),!0}var le=(0,v._Y)(a,"TD")||(0,v._Y)(a,"TH");if(t.key.indexOf("Arrow")>-1&&le){var oe=Po(le);if(oe&&Mn(e,t,i,le,oe))return!0;var te=Ro(le);if(te&&qn(e,t,i,le,te))return!0}if(qr(e,t,i)||Kr(e,i,t)||Xi(e,i,t))return!0;var Ce=(0,O.c)(a);if(Ce){if(B("⌘=",t)){var he=Ce.querySelector(".vditor-ir__marker--heading");return he&&he.textContent.trim().length>1&&Wn(e,he.textContent.substr(1)),t.preventDefault(),!0}if(B("⌘-",t)){var he=Ce.querySelector(".vditor-ir__marker--heading");return he&&he.textContent.trim().length<6&&Wn(e,he.textContent.trim()+"# "),t.preventDefault(),!0}}var Q=(0,v.pt)(a);if(t.key==="Backspace"&&!(0,u._0)(t)&&!t.shiftKey&&!t.altKey&&i.toString()===""){if(Gr(e,i,t,L))return!0;if(Q&&Q.previousElementSibling&&Q.tagName!=="UL"&&Q.tagName!=="OL"&&(Q.previousElementSibling.getAttribute("data-type")==="code-block"||Q.previousElementSibling.getAttribute("data-type")==="math-block")){var Ie=(0,j.ED)(Q,e.ir.element,i).start;if(Ie===0||Ie===1&&Q.innerText.startsWith(f.Y.ZWSP))return i.selectNodeContents(Q.previousElementSibling.querySelector(".vditor-ir__marker--pre code")),i.collapse(!1),$(i,e),Q.textContent.trim().replace(f.Y.ZWSP,"")===""&&(Q.remove(),nn(e)),t.preventDefault(),!0}if(Ce){var we=Ce.firstElementChild.textContent.length;(0,j.ED)(Ce,e.ir.element).start===we&&we!==0&&(i.setStart(Ce.firstElementChild.firstChild,we-1),i.collapse(!0),(0,j.jl)(i))}}return(t.key==="ArrowUp"||t.key==="ArrowDown")&&Q&&(Q.querySelectorAll(".vditor-ir__node").forEach(function(je){je.contains(a)||je.classList.add("vditor-ir__node--hidden")}),Xr(t,Q,i))?!0:(Hr(i,t.key),Q&&W(Q,e,t,i)?(t.preventDefault(),!0):!1)},re=c(726),qe=function(e,t){e.querySelectorAll("[data-type=footnotes-link]").forEach(function(i){for(var a=i.parentElement,o=a.nextSibling;o&&o.textContent.startsWith("    ");){var l=o;l.childNodes.forEach(function(E){a.append(E.cloneNode(!0))}),o=o.nextSibling,l.remove()}t&&t(a)})},Be=function(e,t){var i,a=getSelection().getRangeAt(0).cloneRange(),o=a.startContainer;a.startContainer.nodeType!==3&&a.startContainer.tagName==="DIV"&&(o=a.startContainer.childNodes[a.startOffset-1]);var l=(0,v.Th)(o,"data-block","0");if(l&&t&&(t.inputType==="deleteContentBackward"||t.data===" ")){for(var E=(0,j.ED)(l,e.sv.element,a).start,L=!0,D=E-1;D>l.textContent.substr(0,E).lastIndexOf(`
`);D--)if(l.textContent.charAt(D)!==" "&&l.textContent.charAt(D)!=="	"){L=!1;break}if(E===0&&(L=!1),L){St(e);return}if(t.inputType==="deleteContentBackward"){var A=(0,v.Th)(o,"data-type","code-block-open-marker")||(0,v.Th)(o,"data-type","code-block-close-marker");if(A){if(A.getAttribute("data-type")==="code-block-close-marker"){var P=oi(o,"code-block-open-marker");if(P){P.textContent=A.textContent,St(e);return}}if(A.getAttribute("data-type")==="code-block-open-marker"){var P=oi(o,"code-block-close-marker",!1);if(P){P.textContent=A.textContent,St(e);return}}}var F=(0,v.Th)(o,"data-type","math-block-open-marker");if(F){var le=F.nextElementSibling.nextElementSibling;le&&le.getAttribute("data-type")==="math-block-close-marker"&&(le.remove(),St(e));return}l.querySelectorAll('[data-type="code-block-open-marker"]').forEach(function(Q){Q.textContent.length===1&&Q.remove()}),l.querySelectorAll('[data-type="code-block-close-marker"]').forEach(function(Q){Q.textContent.length===1&&Q.remove()});var oe=(0,v.Th)(o,"data-type","heading-marker");if(oe&&oe.textContent.indexOf("#")===-1){St(e);return}}if((t.data===" "||t.inputType==="deleteContentBackward")&&((0,v.Th)(o,"data-type","padding")||(0,v.Th)(o,"data-type","li-marker")||(0,v.Th)(o,"data-type","task-marker")||(0,v.Th)(o,"data-type","blockquote-marker"))){St(e);return}}if(l&&l.textContent.trimRight()==="$$"){St(e);return}l||(l=e.sv.element),((i=l.firstElementChild)===null||i===void 0?void 0:i.getAttribute("data-type"))==="link-ref-defs-block"&&(l=e.sv.element),(0,v.Th)(o,"data-type","footnotes-link")&&(l=e.sv.element),l.textContent.indexOf(Lute.Caret)===-1&&a.insertNode(document.createTextNode(Lute.Caret)),l.querySelectorAll("[style]").forEach(function(Q){Q.removeAttribute("style")}),l.querySelectorAll("font").forEach(function(Q){Q.outerHTML=Q.innerHTML});var te=l.textContent,Ce=l.isEqualNode(e.sv.element);if(Ce)te=l.textContent;else{l.previousElementSibling&&(te=l.previousElementSibling.textContent+te,l.previousElementSibling.remove()),l.previousElementSibling&&te.indexOf(`---
`)===0&&(te=l.previousElementSibling.textContent+te,l.previousElementSibling.remove());var he="";e.sv.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(Q,Ie){Q&&!l.isEqualNode(Q.parentElement)&&(he+=Q.parentElement.textContent+`
`,Q.parentElement.remove())}),e.sv.element.querySelectorAll("[data-type='footnotes-link']").forEach(function(Q,Ie){Q&&!l.isEqualNode(Q.parentElement)&&(he+=Q.parentElement.textContent+`
`,Q.parentElement.remove())}),te=he+te}te=Ar(te,e),Ce?l.innerHTML=te:l.outerHTML=te,e.sv.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(Q){e.sv.element.insertAdjacentElement("beforeend",Q.parentElement)}),qe(e.sv.element,function(Q){e.sv.element.insertAdjacentElement("beforeend",Q)}),(0,j.ir)(e.sv.element,a),vt(e),St(e,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},Ue=function(e,t){var i,a,o,l,E;if(e.sv.composingLock=t.isComposing,t.isComposing||(t.key.indexOf("Arrow")===-1&&t.key!=="Meta"&&t.key!=="Control"&&t.key!=="Alt"&&t.key!=="Shift"&&t.key!=="CapsLock"&&t.key!=="Escape"&&!/^F\d{1,2}$/.test(t.key)&&e.undo.recordFirstPosition(e,t),t.key!=="Enter"&&t.key!=="Tab"&&t.key!=="Backspace"&&t.key.indexOf("Arrow")===-1&&!(0,u._0)(t)&&t.key!=="Escape"))return!1;var L=(0,j.RN)(e),D=L.startContainer;L.startContainer.nodeType!==3&&L.startContainer.tagName==="DIV"&&(D=L.startContainer.childNodes[L.startOffset-1]);var A=(0,v.Th)(D,"data-type","text"),P=(0,v.Th)(D,"data-type","blockquote-marker");if(!P&&L.startOffset===0&&A&&A.previousElementSibling&&A.previousElementSibling.getAttribute("data-type")==="blockquote-marker"&&(P=A.previousElementSibling),P&&t.key==="Enter"&&!(0,u._0)(t)&&!t.altKey&&P.nextElementSibling.textContent.trim()===""&&(0,j.ED)(P,e.sv.element,L).start===P.textContent.length)return((i=P.previousElementSibling)===null||i===void 0?void 0:i.getAttribute("data-type"))==="padding"&&P.previousElementSibling.setAttribute("data-action","enter-remove"),P.remove(),St(e),t.preventDefault(),!0;var F=(0,v.Th)(D,"data-type","li-marker"),le=(0,v.Th)(D,"data-type","task-marker"),oe=F;if(oe||le&&le.nextElementSibling.getAttribute("data-type")!=="task-marker"&&(oe=le),!oe&&L.startOffset===0&&A&&A.previousElementSibling&&(A.previousElementSibling.getAttribute("data-type")==="li-marker"||A.previousElementSibling.getAttribute("data-type")==="task-marker")&&(oe=A.previousElementSibling),oe){var te=(0,j.ED)(oe,e.sv.element,L).start,Ce=oe.getAttribute("data-type")==="task-marker",he=oe;if(Ce&&(he=oe.previousElementSibling.previousElementSibling.previousElementSibling),te===oe.textContent.length){if(t.key==="Enter"&&!(0,u._0)(t)&&!t.altKey&&!t.shiftKey&&oe.nextElementSibling.textContent.trim()==="")return((a=he.previousElementSibling)===null||a===void 0?void 0:a.getAttribute("data-type"))==="padding"?(he.previousElementSibling.remove(),Be(e)):(Ce&&(he.remove(),oe.previousElementSibling.previousElementSibling.remove(),oe.previousElementSibling.remove()),oe.nextElementSibling.remove(),oe.remove(),St(e)),t.preventDefault(),!0;if(t.key==="Tab")return t.shiftKey?he.previousElementSibling.getAttribute("data-type")==="padding"&&he.previousElementSibling.remove():he.insertAdjacentHTML("beforebegin",'<span data-type="padding">'.concat(he.textContent.replace(/\S/g," "),"</span>")),/^\d/.test(he.textContent)&&(he.textContent=he.textContent.replace(/^\d{1,}/,"1"),L.selectNodeContents(oe.firstChild),L.collapse(!1)),Be(e),t.preventDefault(),!0}}if(Xi(e,L,t))return!0;var Q=(0,v.Th)(D,"data-block","0"),Ie=(0,O.f)(D,"SPAN");if(t.key==="Enter"&&!(0,u._0)(t)&&!t.altKey&&!t.shiftKey&&Q){var we=!1,je=Q.textContent.match(/^\n+/);(0,j.ED)(Q,e.sv.element).start<=(je?je[0].length:0)&&(we=!0);var ot=`
`;if(Ie){if(((o=Ie.previousElementSibling)===null||o===void 0?void 0:o.getAttribute("data-action"))==="enter-remove")return Ie.previousElementSibling.remove(),St(e),t.preventDefault(),!0;ot+=Co(Ie)}return L.insertNode(document.createTextNode(ot)),L.collapse(!1),Q&&Q.textContent.trim()!==""&&!we?Be(e):St(e),t.preventDefault(),!0}if(t.key==="Backspace"&&!(0,u._0)(t)&&!t.altKey&&!t.shiftKey){if(Ie&&((l=Ie.previousElementSibling)===null||l===void 0?void 0:l.getAttribute("data-type"))==="newline"&&(0,j.ED)(Ie,e.sv.element,L).start===1&&Ie.getAttribute("data-type").indexOf("code-block-")===-1)return L.setStart(Ie,0),L.extractContents(),Ie.textContent.trim()!==""?Be(e):St(e),t.preventDefault(),!0;if(Q&&(0,j.ED)(Q,e.sv.element,L).start===0&&Q.previousElementSibling){L.extractContents();var it=Q.previousElementSibling.lastElementChild;return it.getAttribute("data-type")==="newline"&&(it.remove(),it=Q.previousElementSibling.lastElementChild),it.getAttribute("data-type")!=="newline"&&(it.insertAdjacentHTML("afterend",Q.innerHTML),Q.remove()),Q.textContent.trim()!==""&&!(!((E=Q.previousElementSibling)===null||E===void 0)&&E.querySelector('[data-type="code-block-open-marker"]'))?Be(e):(it.getAttribute("data-type")!=="newline"&&(L.selectNodeContents(it.lastChild),L.collapse(!1)),St(e)),t.preventDefault(),!0}}return!1},ge=c(873),Ze=function(e){e.options.theme==="dark"?e.element.classList.add("vditor--dark"):e.element.classList.remove("vditor--dark")},lt=function(e){e.element.innerHTML="",e.element.classList.add("vditor"),e.options.rtl&&e.element.setAttribute("dir","rtl"),Ze(e),(0,ge.H)(e.options.preview.theme.current,e.options.preview.theme.path),typeof e.options.height=="number"?e.element.style.height=e.options.height+"px":e.element.style.height=e.options.height,typeof e.options.minHeight=="number"&&(e.element.style.minHeight=e.options.minHeight+"px"),typeof e.options.width=="number"?e.element.style.width=e.options.width+"px":e.element.style.width=e.options.width,e.element.appendChild(e.toolbar.element);var t=document.createElement("div");if(t.className="vditor-content",e.options.outline.position==="left"&&t.appendChild(e.outline.element),t.appendChild(e.wysiwyg.element.parentElement),t.appendChild(e.sv.element),t.appendChild(e.ir.element.parentElement),t.appendChild(e.preview.element),e.toolbar.elements.devtools&&t.appendChild(e.devtools.element),e.options.outline.position==="right"&&(e.outline.element.classList.add("vditor-outline--right"),t.appendChild(e.outline.element)),e.upload&&t.appendChild(e.upload.element),e.options.resize.enable&&t.appendChild(e.resize.element),t.appendChild(e.hint.element),t.appendChild(e.tip.element),e.element.appendChild(t),t.addEventListener("click",function(){M(e,["subToolbar"])}),e.toolbar.elements.export&&e.element.insertAdjacentHTML("beforeend",'<iframe id="vditorExportIframe" style="width: 100%;height: 0;border: 0"></iframe>'),mn(e,e.options.mode,ne(e)),document.execCommand("DefaultParagraphSeparator",!1,"p"),navigator.userAgent.indexOf("iPhone")>-1&&typeof window.visualViewport<"u"){var i=!1,a=function(o){i||(i=!0,requestAnimationFrame(function(){i=!1;var l=e.toolbar.element;l.style.transform="none",l.getBoundingClientRect().top<0&&(l.style.transform="translate(0, ".concat(-l.getBoundingClientRect().top,"px)"))}))};window.visualViewport.addEventListener("scroll",a),window.visualViewport.addEventListener("resize",a)}},ct=function(e){var t=window.innerWidth<=f.Y.MOBILE_WIDTH?10:35;if(e.wysiwyg.element.parentElement.style.display!=="none"){var i=(e.wysiwyg.element.parentElement.clientWidth-e.options.preview.maxWidth)/2;e.wysiwyg.element.style.padding="10px ".concat(Math.max(t,i),"px")}if(e.ir.element.parentElement.style.display!=="none"){var i=(e.ir.element.parentElement.clientWidth-e.options.preview.maxWidth)/2;e.ir.element.style.padding="10px ".concat(Math.max(t,i),"px")}e.preview.element.style.display!=="block"?e.toolbar.element.style.paddingLeft=Math.max(5,parseInt(e[e.currentMode].element.style.paddingLeft||"0",10)+(e.options.outline.position==="left"?e.outline.element.offsetWidth:0))+"px":e.toolbar.element.style.paddingLeft=5+(e.options.outline.position==="left"?e.outline.element.offsetWidth:0)+"px"},Y=function(e){if(e.options.typewriterMode){var t=window.innerHeight;typeof e.options.height=="number"?(t=e.options.height,typeof e.options.minHeight=="number"&&(t=Math.max(t,e.options.minHeight)),t=Math.min(window.innerHeight,t)):t=e.element.clientHeight,e.element.classList.contains("vditor--fullscreen")&&(t=window.innerHeight),e[e.currentMode].element.style.setProperty("--editor-bottom",(t-e.toolbar.element.offsetHeight)/2+"px")}},U;function X(){window.removeEventListener("resize",U)}var ne=function(e){Y(e),X(),window.addEventListener("resize",U=function(){ct(e),Y(e)});var t=(0,u.D)()&&localStorage.getItem(e.options.cache.id);return(!e.options.cache.enable||!t)&&(e.options.value?t=e.options.value:e.originalInnerHTML?t=e.lute.HTML2Md(e.originalInnerHTML):e.options.cache.enable||(t="")),t||""},Le=function(e){clearTimeout(e[e.currentMode].hlToolbarTimeoutId),e[e.currentMode].hlToolbarTimeoutId=window.setTimeout(function(){if(e[e.currentMode].element.getAttribute("contenteditable")!=="false"&&(0,j.Co)(e[e.currentMode].element)){m(e.toolbar.elements,f.Y.EDIT_TOOLBARS),w(e.toolbar.elements,f.Y.EDIT_TOOLBARS);var t=(0,j.RN)(e),i=t.startContainer;t.startContainer.nodeType===3&&(i=t.startContainer.parentElement),i.classList.contains("vditor-reset")&&(i=i.childNodes[t.startOffset]);var a=e.currentMode==="sv"?(0,v.Th)(i,"data-type","heading"):(0,O.c)(i);a&&g(e.toolbar.elements,["headings"]);var o=e.currentMode==="sv"?(0,v.Th)(i,"data-type","blockquote"):(0,v._Y)(i,"BLOCKQUOTE");o&&g(e.toolbar.elements,["quote"]);var l=(0,v.Th)(i,"data-type","strong");l&&g(e.toolbar.elements,["bold"]);var E=(0,v.Th)(i,"data-type","em");E&&g(e.toolbar.elements,["italic"]);var L=(0,v.Th)(i,"data-type","s");L&&g(e.toolbar.elements,["strike"]);var D=(0,v.Th)(i,"data-type","a");D&&g(e.toolbar.elements,["link"]);var A=(0,v._Y)(i,"LI");A?(A.classList.contains("vditor-task")?g(e.toolbar.elements,["check"]):A.parentElement.tagName==="OL"?g(e.toolbar.elements,["ordered-list"]):A.parentElement.tagName==="UL"&&g(e.toolbar.elements,["list"]),w(e.toolbar.elements,["outdent","indent"])):b(e.toolbar.elements,["outdent","indent"]);var P=(0,v.Th)(i,"data-type","code-block");P&&(b(e.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","inline-code","upload","link","table","record"]),g(e.toolbar.elements,["code"]));var F=(0,v.Th)(i,"data-type","code");F&&(b(e.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","upload","link","table","record"]),g(e.toolbar.elements,["inline-code"]));var le=(0,v.Th)(i,"data-type","table");le&&b(e.toolbar.elements,["headings","list","ordered-list","check","line","quote","code","table"])}},200)},ye=function(e,t){t===void 0&&(t={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),t.enableHint&&e.hint.render(e),clearTimeout(e.wysiwyg.afterRenderTimeoutId),e.wysiwyg.afterRenderTimeoutId=window.setTimeout(function(){if(!e.wysiwyg.composingLock){var i=T(e);typeof e.options.input=="function"&&t.enableInput&&e.options.input(i),e.options.counter.enable&&e.counter.render(e,i),e.options.cache.enable&&(0,u.D)()&&(localStorage.setItem(e.options.cache.id,i),e.options.cache.after&&e.options.cache.after(i)),e.devtools&&e.devtools.renderEchart(e),t.enableAddUndoStack&&e.undo.addToUndoStack(e)}},e.options.undoDelay)},ft=function(e){for(var t=e.previousSibling;t;){if(t.nodeType!==3&&t.tagName==="A"&&!t.previousSibling&&t.innerHTML.replace(f.Y.ZWSP,"")===""&&t.nextSibling)return t;t=t.previousSibling}return!1},Yt=function(e){for(var t=e.startContainer.nextSibling;t&&t.textContent==="";)t=t.nextSibling;return!!(t&&t.nodeType!==3&&(t.tagName==="CODE"||t.getAttribute("data-type")==="math-inline"||t.getAttribute("data-type")==="html-entity"||t.getAttribute("data-type")==="html-inline"))},Pe=function(e){for(var t="",i=e.nextSibling;i;)i.nodeType===3?t+=i.textContent:t+=i.outerHTML,i=i.nextSibling;return t},xt=function(e){for(var t="",i=e.previousSibling;i;)i.nodeType===3?t=i.textContent+t:t=i.outerHTML+t,i=i.previousSibling;return t},wt=function(e){for(var t=e;t&&!t.nextSibling;)t=t.parentElement;return t.nextSibling},Ot=function(e){var t=xt(e.startContainer),i=Pe(e.startContainer),a=e.startContainer.textContent,o=e.startOffset,l="",E="";return(a.substr(0,o)!==""&&a.substr(0,o)!==f.Y.ZWSP||t)&&(l="".concat(t).concat(a.substr(0,o))),(a.substr(o)!==""&&a.substr(o)!==f.Y.ZWSP||i)&&(E="".concat(a.substr(o)).concat(i)),{afterHTML:E,beforeHTML:l}},Xt=function(e,t){Array.from(e.wysiwyg.element.childNodes).find(function(i){if(i.nodeType===3){var a=document.createElement("p");a.setAttribute("data-block","0"),a.textContent=i.textContent;var o=t.startContainer.nodeType===3?t.startOffset:i.textContent.length;return i.parentNode.insertBefore(a,i),i.remove(),t.setStart(a.firstChild,Math.min(a.firstChild.textContent.length,o)),t.collapse(!0),(0,j.jl)(t),!0}else if(!i.getAttribute("data-block"))return i.tagName==="P"?i.remove():(i.tagName==="DIV"?(t.insertNode(document.createElement("wbr")),i.outerHTML='<p data-block="0">'.concat(i.innerHTML,"</p>")):i.tagName==="BR"?i.outerHTML='<p data-block="0">'.concat(i.outerHTML,"<wbr></p>"):(t.insertNode(document.createElement("wbr")),i.outerHTML='<p data-block="0">'.concat(i.outerHTML,"</p>")),(0,j.ir)(e.wysiwyg.element,t),t=getSelection().getRangeAt(0)),!0})},J=function(e,t){var i=(0,j.RN)(e),a=(0,v.pt)(i.startContainer);a||(a=i.startContainer.childNodes[i.startOffset]),!a&&e.wysiwyg.element.children.length===0&&(a=e.wysiwyg.element),a&&!a.classList.contains("vditor-wysiwyg__block")&&(i.insertNode(document.createElement("wbr")),a.innerHTML.trim()==="<wbr>"&&(a.innerHTML="<wbr><br>"),a.tagName==="BLOCKQUOTE"||a.classList.contains("vditor-reset")?a.innerHTML="<".concat(t,' data-block="0">').concat(a.innerHTML.trim(),"</").concat(t,">"):a.outerHTML="<".concat(t,' data-block="0">').concat(a.innerHTML.trim(),"</").concat(t,">"),(0,j.ir)(e.wysiwyg.element,i),ce(e))},fe=function(e){var t=getSelection().getRangeAt(0),i=(0,v.pt)(t.startContainer);i||(i=t.startContainer.childNodes[t.startOffset]),i&&(t.insertNode(document.createElement("wbr")),i.outerHTML='<p data-block="0">'.concat(i.innerHTML,"</p>"),(0,j.ir)(e.wysiwyg.element,t)),e.wysiwyg.popover.style.display="none"},Se=function(e,t,i){i===void 0&&(i=!0);var a=e.previousElementSibling,o=a.ownerDocument.createRange();a.tagName==="CODE"?(a.style.display="inline-block",i?o.setStart(a.firstChild,1):o.selectNodeContents(a)):(a.style.display="block",a.firstChild.firstChild||a.firstChild.appendChild(document.createTextNode("")),o.selectNodeContents(a.firstChild)),i?o.collapse(!0):o.collapse(!1),(0,j.jl)(o),!e.firstElementChild.classList.contains("language-mindmap")&&vt(t)},pe=function(e,t){if(e.wysiwyg.composingLock=t.isComposing,t.isComposing)return!1;t.key.indexOf("Arrow")===-1&&t.key!=="Meta"&&t.key!=="Control"&&t.key!=="Alt"&&t.key!=="Shift"&&t.key!=="CapsLock"&&t.key!=="Escape"&&!/^F\d{1,2}$/.test(t.key)&&e.undo.recordFirstPosition(e,t);var i=(0,j.RN)(e),a=i.startContainer;if(!Rr(t,e,a)||(Ir(i,e,t),Zr(i),t.key!=="Enter"&&t.key!=="Tab"&&t.key!=="Backspace"&&t.key.indexOf("Arrow")===-1&&!(0,u._0)(t)&&t.key!=="Escape"&&t.key!=="Delete"))return!1;var o=(0,v.pt)(a),l=(0,v._Y)(a,"P");if(zr(t,e,l,i)||Br(i,e,l,t)||qr(e,t,i))return!0;var E=(0,v.KJ)(a,"vditor-wysiwyg__block");if(E){if(t.key==="Escape"&&E.children.length===2)return e.wysiwyg.popover.style.display="none",E.firstElementChild.style.display="none",e.wysiwyg.element.blur(),t.preventDefault(),!0;if(!(0,u._0)(t)&&!t.shiftKey&&t.altKey&&t.key==="Enter"&&E.getAttribute("data-type")==="code-block"){var L=e.wysiwyg.popover.querySelector(".vditor-input");return L.focus(),L.select(),t.preventDefault(),!0}if(E.getAttribute("data-block")==="0"&&(Wr(e,t,E.firstElementChild,i)||qn(e,t,i,E.firstElementChild,E)||E.getAttribute("data-type")!=="yaml-front-matter"&&Mn(e,t,i,E.firstElementChild,E)))return!0}if(Yr(e,i,t,l))return!0;var D=(0,v.Ab)(a,"BLOCKQUOTE");if(D&&!t.shiftKey&&t.altKey&&t.key==="Enter"){(0,u._0)(t)?i.setStartBefore(D):i.setStartAfter(D),(0,j.jl)(i);var A=document.createElement("p");return A.setAttribute("data-block","0"),A.innerHTML=`
`,i.insertNode(A),i.collapse(!0),(0,j.jl)(i),ye(e),vt(e),t.preventDefault(),!0}var P=(0,O.c)(a);if(P){if(P.tagName==="H6"&&a.textContent.length===i.startOffset&&!(0,u._0)(t)&&!t.shiftKey&&!t.altKey&&t.key==="Enter"){var F=document.createElement("p");return F.textContent=`
`,F.setAttribute("data-block","0"),a.parentElement.insertAdjacentElement("afterend",F),i.setStart(F,0),(0,j.jl)(i),ye(e),vt(e),t.preventDefault(),!0}if(B("⌘=",t)){var le=parseInt(P.tagName.substr(1),10)-1;return le>0&&(J(e,"h".concat(le)),ye(e)),t.preventDefault(),!0}if(B("⌘-",t)){var le=parseInt(P.tagName.substr(1),10)+1;return le<7&&(J(e,"h".concat(le)),ye(e)),t.preventDefault(),!0}t.key==="Backspace"&&!(0,u._0)(t)&&!t.shiftKey&&!t.altKey&&P.textContent.length===1&&fe(e)}if(Kr(e,i,t))return!0;if(t.altKey&&t.key==="Enter"&&!(0,u._0)(t)&&!t.shiftKey){var oe=(0,v._Y)(a,"A"),te=(0,v.Th)(a,"data-type","link-ref"),Ce=(0,v.Th)(a,"data-type","footnotes-ref");if(oe||te||Ce||P&&P.tagName.length===2){var he=e.wysiwyg.popover.querySelector("input");he.focus(),he.select()}}if(be(e,t))return!0;if(B("⇧⌘U",t)){var Q=e.wysiwyg.popover.querySelector('[data-type="up"]');if(Q)return Q.click(),t.preventDefault(),!0}if(B("⇧⌘D",t)){var Q=e.wysiwyg.popover.querySelector('[data-type="down"]');if(Q)return Q.click(),t.preventDefault(),!0}if(Xi(e,i,t))return!0;if(!(0,u._0)(t)&&t.shiftKey&&!t.altKey&&t.key==="Enter"&&a.parentElement.tagName!=="LI"&&a.parentElement.tagName!=="P")return["STRONG","STRIKE","S","I","EM","B"].includes(a.parentElement.tagName)?i.insertNode(document.createTextNode(`
`+f.Y.ZWSP)):i.insertNode(document.createTextNode(`
`)),i.collapse(!1),(0,j.jl)(i),ye(e),vt(e),t.preventDefault(),!0;if(t.key==="Backspace"&&!(0,u._0)(t)&&!t.shiftKey&&!t.altKey&&i.toString()===""){if(Gr(e,i,t,l))return!0;if(o){if(o.previousElementSibling&&o.previousElementSibling.classList.contains("vditor-wysiwyg__block")&&o.previousElementSibling.getAttribute("data-block")==="0"&&o.tagName!=="UL"&&o.tagName!=="OL"){var Ie=(0,j.ED)(o,e.wysiwyg.element,i).start;if(Ie===0&&i.startOffset===0||Ie===1&&o.innerText.startsWith(f.Y.ZWSP))return Se(o.previousElementSibling.lastElementChild,e,!1),o.innerHTML.trim().replace(f.Y.ZWSP,"")===""&&(o.remove(),ye(e)),t.preventDefault(),!0}var we=i.startOffset;if(i.toString()===""&&a.nodeType===3&&a.textContent.charAt(we-2)===`
`&&a.textContent.charAt(we-1)!==f.Y.ZWSP&&["STRONG","STRIKE","S","I","EM","B"].includes(a.parentElement.tagName))return a.textContent=a.textContent.substring(0,we-1)+f.Y.ZWSP,i.setStart(a,we),i.collapse(!0),ye(e),t.preventDefault(),!0;a.textContent===f.Y.ZWSP&&i.startOffset===1&&!a.previousSibling&&Yt(i)&&(a.textContent=""),o.querySelectorAll("span.vditor-wysiwyg__block[data-type='math-inline']").forEach(function(ot){ot.firstElementChild.style.display="inline",ot.lastElementChild.style.display="none"}),o.querySelectorAll("span.vditor-wysiwyg__block[data-type='html-entity']").forEach(function(ot){ot.firstElementChild.style.display="inline",ot.lastElementChild.style.display="none"})}}if((0,u.gm)()&&i.startOffset===1&&a.textContent.indexOf(f.Y.ZWSP)>-1&&a.previousSibling&&a.previousSibling.nodeType!==3&&a.previousSibling.tagName==="CODE"&&(t.key==="Backspace"||t.key==="ArrowLeft"))return i.selectNodeContents(a.previousSibling),i.collapse(!1),t.preventDefault(),!0;if(Xr(t,o,i))return t.preventDefault(),!0;if(Hr(i,t.key),t.key==="ArrowDown"){var je=a.nextSibling;je&&je.nodeType!==3&&je.getAttribute("data-type")==="math-inline"&&i.setStartAfter(je)}return o&&W(o,e,t,i)?(t.preventDefault(),!0):!1},be=function(e,t){if(B("⇧⌘X",t)){var i=e.wysiwyg.popover.querySelector('[data-type="remove"]');return i&&i.click(),t.preventDefault(),!0}},ze=function(e){clearTimeout(e.wysiwyg.hlToolbarTimeoutId),e.wysiwyg.hlToolbarTimeoutId=window.setTimeout(function(){if(e.wysiwyg.element.getAttribute("contenteditable")!=="false"&&(0,j.Co)(e.wysiwyg.element)){m(e.toolbar.elements,f.Y.EDIT_TOOLBARS),w(e.toolbar.elements,f.Y.EDIT_TOOLBARS);var t=getSelection().getRangeAt(0),i=t.startContainer;t.startContainer.nodeType===3?i=t.startContainer.parentElement:i=i.childNodes[t.startOffset>=i.childNodes.length?i.childNodes.length-1:t.startOffset];var a=(0,v.Th)(i,"data-type","footnotes-block");if(a){e.wysiwyg.popover.innerHTML="",mt(a,e),et(e,a);return}var o=(0,v._Y)(i,"LI");o?(o.classList.contains("vditor-task")?g(e.toolbar.elements,["check"]):o.parentElement.tagName==="OL"?g(e.toolbar.elements,["ordered-list"]):o.parentElement.tagName==="UL"&&g(e.toolbar.elements,["list"]),w(e.toolbar.elements,["outdent","indent"])):b(e.toolbar.elements,["outdent","indent"]),(0,v._Y)(i,"BLOCKQUOTE")&&g(e.toolbar.elements,["quote"]),((0,v._Y)(i,"B")||(0,v._Y)(i,"STRONG"))&&g(e.toolbar.elements,["bold"]),((0,v._Y)(i,"I")||(0,v._Y)(i,"EM"))&&g(e.toolbar.elements,["italic"]),((0,v._Y)(i,"STRIKE")||(0,v._Y)(i,"S"))&&g(e.toolbar.elements,["strike"]),e.wysiwyg.element.querySelectorAll(".vditor-comment--focus").forEach(function(Ee){Ee.classList.remove("vditor-comment--focus")});var l=(0,v.KJ)(i,"vditor-comment");if(l){var E=l.getAttribute("data-cmtids").split(" ");if(E.length>1&&l.nextSibling.isSameNode(l.nextElementSibling)){var L=l.nextElementSibling.getAttribute("data-cmtids").split(" ");E.find(function(Ee){if(L.includes(Ee))return E=[Ee],!0})}e.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(Ee){Ee.getAttribute("data-cmtids").indexOf(E[0])>-1&&Ee.classList.add("vditor-comment--focus")})}var D=(0,v._Y)(i,"A");D&&g(e.toolbar.elements,["link"]);var A=(0,v._Y)(i,"TABLE"),P=(0,O.c)(i);(0,v._Y)(i,"CODE")?(0,v._Y)(i,"PRE")?(b(e.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","inline-code","upload","link","table","record"]),g(e.toolbar.elements,["code"])):(b(e.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","upload","link","table","record"]),g(e.toolbar.elements,["inline-code"])):P?(b(e.toolbar.elements,["bold"]),g(e.toolbar.elements,["headings"])):A&&b(e.toolbar.elements,["table"]);var F=(0,v.KJ)(i,"vditor-toc");if(F){e.wysiwyg.popover.innerHTML="",mt(F,e),et(e,F);return}var le=(0,O.f)(i,"BLOCKQUOTE");if(le&&(e.wysiwyg.popover.innerHTML="",ht(t,le,e),ut(t,le,e),mt(le,e),et(e,le)),o&&(e.wysiwyg.popover.innerHTML="",ht(t,o,e),ut(t,o,e),mt(o,e),et(e,o)),A){e.options.lang,e.options,e.wysiwyg.popover.innerHTML="";var oe=function(){var Ee=A.rows.length,Ge=A.rows[0].cells.length,dn=parseInt(yt.value,10)||Ee,fn=parseInt(jt.value,10)||Ge;if(!(dn===Ee&&Ge===fn)){if(Ge!==fn)for(var Kn=fn-Ge,Jt=0;Jt<A.rows.length;Jt++)if(Kn>0)for(var sa=0;sa<Kn;sa++)Jt===0?A.rows[Jt].lastElementChild.insertAdjacentHTML("afterend","<th> </th>"):A.rows[Jt].lastElementChild.insertAdjacentHTML("afterend","<td> </td>");else for(var er=Ge-1;er>=fn;er--)A.rows[Jt].cells[er].remove();if(Ee!==dn){var la=dn-Ee;if(la>0){for(var tr="<tr>",Dn=0;Dn<fn;Dn++)tr+="<td> </td>";for(var ca=0;ca<la;ca++)A.querySelector("tbody")?A.querySelector("tbody").insertAdjacentHTML("beforeend",tr):A.querySelector("thead").insertAdjacentHTML("afterend",tr+"</tr>")}else for(var Dn=Ee-1;Dn>=dn;Dn--)A.rows[Dn].remove(),A.rows.length===1&&A.querySelector("tbody").remove()}typeof e.options.input=="function"&&e.options.input(T(e))}},te=function(Ee){ci(A,Ee),Ee==="right"?(Ie.classList.remove("vditor-icon--current"),we.classList.remove("vditor-icon--current"),je.classList.add("vditor-icon--current")):Ee==="center"?(Ie.classList.remove("vditor-icon--current"),je.classList.remove("vditor-icon--current"),we.classList.add("vditor-icon--current")):(we.classList.remove("vditor-icon--current"),je.classList.remove("vditor-icon--current"),Ie.classList.add("vditor-icon--current")),(0,j.jl)(t),ye(e)},Ce=(0,v._Y)(i,"TD"),he=(0,v._Y)(i,"TH"),Q="left";Ce?Q=Ce.getAttribute("align")||"left":he&&(Q=he.getAttribute("align")||"center");var Ie=document.createElement("button");Ie.setAttribute("type","button"),Ie.setAttribute("aria-label",window.VditorI18n.alignLeft+"<"+(0,u.fG)("⇧⌘L")+">"),Ie.setAttribute("data-type","left"),Ie.innerHTML='<svg><use xlink:href="#vditor-icon-align-left"></use></svg>',Ie.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+(Q==="left"?" vditor-icon--current":""),Ie.onclick=function(){te("left")};var we=document.createElement("button");we.setAttribute("type","button"),we.setAttribute("aria-label",window.VditorI18n.alignCenter+"<"+(0,u.fG)("⇧⌘C")+">"),we.setAttribute("data-type","center"),we.innerHTML='<svg><use xlink:href="#vditor-icon-align-center"></use></svg>',we.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+(Q==="center"?" vditor-icon--current":""),we.onclick=function(){te("center")};var je=document.createElement("button");je.setAttribute("type","button"),je.setAttribute("aria-label",window.VditorI18n.alignRight+"<"+(0,u.fG)("⇧⌘R")+">"),je.setAttribute("data-type","right"),je.innerHTML='<svg><use xlink:href="#vditor-icon-align-right"></use></svg>',je.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+(Q==="right"?" vditor-icon--current":""),je.onclick=function(){te("right")};var ot=document.createElement("button");ot.setAttribute("type","button"),ot.setAttribute("aria-label",window.VditorI18n.insertRowBelow+"<"+(0,u.fG)("⌘=")+">"),ot.setAttribute("data-type","insertRow"),ot.innerHTML='<svg><use xlink:href="#vditor-icon-insert-row"></use></svg>',ot.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",ot.onclick=function(){var Ee=getSelection().getRangeAt(0).startContainer,Ge=(0,v._Y)(Ee,"TD")||(0,v._Y)(Ee,"TH");Ge&&$r(e,t,Ge)};var it=document.createElement("button");it.setAttribute("type","button"),it.setAttribute("aria-label",window.VditorI18n.insertRowAbove+"<"+(0,u.fG)("⇧⌘F")+">"),it.setAttribute("data-type","insertRow"),it.innerHTML='<svg><use xlink:href="#vditor-icon-insert-rowb"></use></svg>',it.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",it.onclick=function(){var Ee=getSelection().getRangeAt(0).startContainer,Ge=(0,v._Y)(Ee,"TD")||(0,v._Y)(Ee,"TH");Ge&&Fr(e,t,Ge)};var st=document.createElement("button");st.setAttribute("type","button"),st.setAttribute("aria-label",window.VditorI18n.insertColumnRight+"<"+(0,u.fG)("⇧⌘=")+">"),st.setAttribute("data-type","insertColumn"),st.innerHTML='<svg><use xlink:href="#vditor-icon-insert-column"></use></svg>',st.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",st.onclick=function(){var Ee=getSelection().getRangeAt(0).startContainer,Ge=(0,v._Y)(Ee,"TD")||(0,v._Y)(Ee,"TH");Ge&&ui(e,A,Ge)};var Pt=document.createElement("button");Pt.setAttribute("type","button"),Pt.setAttribute("aria-label",window.VditorI18n.insertColumnLeft+"<"+(0,u.fG)("⇧⌘G")+">"),Pt.setAttribute("data-type","insertColumn"),Pt.innerHTML='<svg><use xlink:href="#vditor-icon-insert-columnb"></use></svg>',Pt.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",Pt.onclick=function(){var Ee=getSelection().getRangeAt(0).startContainer,Ge=(0,v._Y)(Ee,"TD")||(0,v._Y)(Ee,"TH");Ge&&ui(e,A,Ge,"beforebegin")};var _t=document.createElement("button");_t.setAttribute("type","button"),_t.setAttribute("aria-label",window.VditorI18n["delete-row"]+"<"+(0,u.fG)("⌘-")+">"),_t.setAttribute("data-type","deleteRow"),_t.innerHTML='<svg><use xlink:href="#vditor-icon-delete-row"></use></svg>',_t.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",_t.onclick=function(){var Ee=getSelection().getRangeAt(0).startContainer,Ge=(0,v._Y)(Ee,"TD")||(0,v._Y)(Ee,"TH");Ge&&Ur(e,t,Ge)};var Rt=document.createElement("button");Rt.setAttribute("type","button"),Rt.setAttribute("aria-label",window.VditorI18n["delete-column"]+"<"+(0,u.fG)("⇧⌘-")+">"),Rt.setAttribute("data-type","deleteColumn"),Rt.innerHTML='<svg><use xlink:href="#vditor-icon-delete-column"></use></svg>',Rt.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",Rt.onclick=function(){var Ee=getSelection().getRangeAt(0).startContainer,Ge=(0,v._Y)(Ee,"TD")||(0,v._Y)(Ee,"TH");Ge&&Vr(e,t,A,Ge)};var We=document.createElement("span");We.setAttribute("aria-label",window.VditorI18n.row),We.className="vditor-tooltipped vditor-tooltipped__n";var yt=document.createElement("input");We.appendChild(yt),yt.type="number",yt.min="1",yt.className="vditor-input",yt.style.width="42px",yt.style.textAlign="center",yt.setAttribute("placeholder",window.VditorI18n.row),yt.value=A.rows.length.toString(),yt.oninput=function(){oe()},yt.onkeydown=function(Ee){if(!Ee.isComposing){if(Ee.key==="Tab"){jt.focus(),jt.select(),Ee.preventDefault();return}be(e,Ee)||rt(Ee,t)}};var hi=document.createElement("span");hi.setAttribute("aria-label",window.VditorI18n.column),hi.className="vditor-tooltipped vditor-tooltipped__n";var jt=document.createElement("input");hi.appendChild(jt),jt.type="number",jt.min="1",jt.className="vditor-input",jt.style.width="42px",jt.style.textAlign="center",jt.setAttribute("placeholder",window.VditorI18n.column),jt.value=A.rows[0].cells.length.toString(),jt.oninput=function(){oe()},jt.onkeydown=function(Ee){if(!Ee.isComposing){if(Ee.key==="Tab"){yt.focus(),yt.select(),Ee.preventDefault();return}be(e,Ee)||rt(Ee,t)}},ht(t,A,e),ut(t,A,e),mt(A,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",Ie),e.wysiwyg.popover.insertAdjacentElement("beforeend",we),e.wysiwyg.popover.insertAdjacentElement("beforeend",je),e.wysiwyg.popover.insertAdjacentElement("beforeend",it),e.wysiwyg.popover.insertAdjacentElement("beforeend",ot),e.wysiwyg.popover.insertAdjacentElement("beforeend",Pt),e.wysiwyg.popover.insertAdjacentElement("beforeend",st),e.wysiwyg.popover.insertAdjacentElement("beforeend",_t),e.wysiwyg.popover.insertAdjacentElement("beforeend",Rt),e.wysiwyg.popover.insertAdjacentElement("beforeend",We),e.wysiwyg.popover.insertAdjacentHTML("beforeend"," x "),e.wysiwyg.popover.insertAdjacentElement("beforeend",hi),et(e,A)}var Qi=(0,v.Th)(i,"data-type","link-ref");Qi&&Mt(e,Qi,t);var Ln=(0,v.Th)(i,"data-type","footnotes-ref");if(Ln){e.options.lang,e.options,e.wysiwyg.popover.innerHTML="";var We=document.createElement("span");We.setAttribute("aria-label",window.VditorI18n.footnoteRef+"<"+(0,u.fG)("⌥Enter")+">"),We.className="vditor-tooltipped vditor-tooltipped__n";var rn=document.createElement("input");We.appendChild(rn),rn.className="vditor-input",rn.setAttribute("placeholder",window.VditorI18n.footnoteRef+"<"+(0,u.fG)("⌥Enter")+">"),rn.style.width="120px",rn.value=Ln.getAttribute("data-footnotes-label"),rn.oninput=function(){rn.value.trim()!==""&&Ln.setAttribute("data-footnotes-label",rn.value),typeof e.options.input=="function"&&e.options.input(T(e))},rn.onkeydown=function(Ge){Ge.isComposing||be(e,Ge)||rt(Ge,t)},mt(Ln,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",We),et(e,Ln)}var Ct=(0,v.KJ)(i,"vditor-wysiwyg__block"),aa=Ct?Ct.getAttribute("data-type").indexOf("block")>-1:!1;if(e.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview").forEach(function(Ee){if(!Ct||Ct&&aa&&!Ct.contains(Ee)){var Ge=Ee.previousElementSibling;Ge.style.display="none"}}),Ct&&aa){if(e.wysiwyg.popover.innerHTML="",ht(t,Ct,e),ut(t,Ct,e),mt(Ct,e),Ct.getAttribute("data-type")==="code-block"){var pi=document.createElement("span");pi.setAttribute("aria-label",window.VditorI18n.language+"<"+(0,u.fG)("⌥Enter")+">"),pi.className="vditor-tooltipped vditor-tooltipped__n";var Kt=document.createElement("input");pi.appendChild(Kt);var Yn=Ct.firstElementChild.firstElementChild;Kt.className="vditor-input",Kt.setAttribute("placeholder",window.VditorI18n.language+"<"+(0,u.fG)("⌥Enter")+">"),Kt.value=Yn.className.indexOf("language-")>-1?Yn.className.split("-")[1].split(" ")[0]:"",Kt.oninput=function(Ee){Kt.value.trim()!==""?Yn.className="language-".concat(Kt.value):(Yn.className="",e.hint.recentLanguage=""),Ct.lastElementChild.classList.contains("vditor-wysiwyg__preview")&&(Ct.lastElementChild.innerHTML=Ct.firstElementChild.innerHTML,$e(Ct.lastElementChild,e)),ye(e),Ee.detail===1&&(t.setStart(Yn.firstChild,0),t.collapse(!0),(0,j.jl)(t))},Kt.onkeydown=function(Ee){if(!Ee.isComposing&&!be(e,Ee)){if(Ee.key==="Escape"&&e.hint.element.style.display==="block"){e.hint.element.style.display="none",Ee.preventDefault();return}e.hint.select(Ee,e),rt(Ee,t)}},Kt.onkeyup=function(Ee){var Ge,dn;if(!(Ee.isComposing||Ee.key==="Enter"||Ee.key==="ArrowUp"||Ee.key==="Escape"||Ee.key==="ArrowDown")){var fn=[],Kn=Kt.value.substring(0,Kt.selectionStart);(e.options.preview.hljs.langs||f.Y.ALIAS_CODE_LANGUAGES.concat(((dn=(Ge=window.hljs)===null||Ge===void 0?void 0:Ge.listLanguages())!==null&&dn!==void 0?dn:[]).sort())).forEach(function(Jt){Jt.indexOf(Kn.toLowerCase())>-1&&fn.push({html:Jt,value:Jt})}),e.hint.genHTML(fn,Kn,e),Ee.preventDefault()}},e.wysiwyg.popover.insertAdjacentElement("beforeend",pi)}et(e,Ct)}else Ct=void 0;if(P){e.wysiwyg.popover.innerHTML="";var We=document.createElement("span");We.setAttribute("aria-label","ID<"+(0,u.fG)("⌥Enter")+">"),We.className="vditor-tooltipped vditor-tooltipped__n";var un=document.createElement("input");We.appendChild(un),un.className="vditor-input",un.setAttribute("placeholder","ID<"+(0,u.fG)("⌥Enter")+">"),un.style.width="120px",un.value=P.getAttribute("data-id")||"",un.oninput=function(){P.setAttribute("data-id",un.value),typeof e.options.input=="function"&&e.options.input(T(e))},un.onkeydown=function(Ge){Ge.isComposing||be(e,Ge)||rt(Ge,t)},ht(t,P,e),ut(t,P,e),mt(P,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",We),et(e,P)}if(D&&nt(e,D,t),!le&&!o&&!A&&!Ct&&!D&&!Qi&&!Ln&&!P&&!F){var An=(0,v.Th)(i,"data-block","0");An&&An.parentElement.isEqualNode(e.wysiwyg.element)?(e.wysiwyg.popover.innerHTML="",ht(t,An,e),ut(t,An,e),mt(An,e),et(e,An)):e.wysiwyg.popover.style.display="none"}e.wysiwyg.element.querySelectorAll('span[data-type="backslash"] > span').forEach(function(Ee){Ee.style.display="none"});var oa=(0,v.Th)(t.startContainer,"data-type","backslash");oa&&(oa.querySelector("span").style.display="inline")}},200)},et=function(e,t){var i=t,a=(0,v._Y)(t,"TABLE");a&&(i=a),e.wysiwyg.popover.style.left="0",e.wysiwyg.popover.style.display="block",e.wysiwyg.popover.style.top=Math.max(-8,i.offsetTop-21-e.wysiwyg.element.scrollTop)+"px",e.wysiwyg.popover.style.left=Math.min(i.offsetLeft,e.wysiwyg.element.clientWidth-e.wysiwyg.popover.clientWidth)+"px",e.wysiwyg.popover.setAttribute("data-top",(i.offsetTop-21).toString())},Mt=function(e,t,i){i===void 0&&(i=getSelection().getRangeAt(0)),e.wysiwyg.popover.innerHTML="";var a=function(){l.value.trim()!==""&&(t.tagName==="IMG"?t.setAttribute("alt",l.value):t.textContent=l.value),L.value.trim()!==""&&t.setAttribute("data-link-label",L.value),typeof e.options.input=="function"&&e.options.input(T(e))},o=document.createElement("span");o.setAttribute("aria-label",window.VditorI18n.textIsNotEmpty),o.className="vditor-tooltipped vditor-tooltipped__n";var l=document.createElement("input");o.appendChild(l),l.className="vditor-input",l.setAttribute("placeholder",window.VditorI18n.textIsNotEmpty),l.style.width="120px",l.value=t.getAttribute("alt")||t.textContent,l.oninput=function(){a()},l.onkeydown=function(D){be(e,D)||rt(D,i)||Et(e,t,D,L)};var E=document.createElement("span");E.setAttribute("aria-label",window.VditorI18n.linkRef),E.className="vditor-tooltipped vditor-tooltipped__n";var L=document.createElement("input");E.appendChild(L),L.className="vditor-input",L.setAttribute("placeholder",window.VditorI18n.linkRef),L.value=t.getAttribute("data-link-label"),L.oninput=function(){a()},L.onkeydown=function(D){be(e,D)||rt(D,i)||Et(e,t,D,l)},mt(t,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",o),e.wysiwyg.popover.insertAdjacentElement("beforeend",E),et(e,t)},ht=function(e,t,i){var a=t.previousElementSibling;if(!(!a||!t.parentElement.isEqualNode(i.wysiwyg.element)&&t.tagName!=="LI")){var o=document.createElement("button");o.setAttribute("type","button"),o.setAttribute("data-type","up"),o.setAttribute("aria-label",window.VditorI18n.up+"<"+(0,u.fG)("⇧⌘U")+">"),o.innerHTML='<svg><use xlink:href="#vditor-icon-up"></use></svg>',o.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",o.onclick=function(){e.insertNode(document.createElement("wbr")),a.insertAdjacentElement("beforebegin",t),(0,j.ir)(i.wysiwyg.element,e),ye(i),ze(i),vt(i)},i.wysiwyg.popover.insertAdjacentElement("beforeend",o)}},ut=function(e,t,i){var a=t.nextElementSibling;if(!(!a||!t.parentElement.isEqualNode(i.wysiwyg.element)&&t.tagName!=="LI")){var o=document.createElement("button");o.setAttribute("type","button"),o.setAttribute("data-type","down"),o.setAttribute("aria-label",window.VditorI18n.down+"<"+(0,u.fG)("⇧⌘D")+">"),o.innerHTML='<svg><use xlink:href="#vditor-icon-down"></use></svg>',o.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",o.onclick=function(){e.insertNode(document.createElement("wbr")),a.insertAdjacentElement("afterend",t),(0,j.ir)(i.wysiwyg.element,e),ye(i),ze(i),vt(i)},i.wysiwyg.popover.insertAdjacentElement("beforeend",o)}},mt=function(e,t){var i=document.createElement("button");i.setAttribute("type","button"),i.setAttribute("data-type","remove"),i.setAttribute("aria-label",window.VditorI18n.remove+"<"+(0,u.fG)("⇧⌘X")+">"),i.innerHTML='<svg><use xlink:href="#vditor-icon-trashcan"></use></svg>',i.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",i.onclick=function(){var a=(0,j.RN)(t);a.setStartAfter(e),(0,j.jl)(a),e.remove(),ye(t),ze(t),["H1","H2","H3","H4","H5","H6"].includes(e.tagName)&&ce(t)},t.wysiwyg.popover.insertAdjacentElement("beforeend",i)},Et=function(e,t,i,a){if(!i.isComposing){if(i.key==="Tab"){a.focus(),a.select(),i.preventDefault();return}if(!(0,u._0)(i)&&!i.shiftKey&&i.altKey&&i.key==="Enter"){var o=(0,j.RN)(e);t.insertAdjacentHTML("afterend",f.Y.ZWSP),o.setStartAfter(t.nextSibling),o.collapse(!0),(0,j.jl)(o),i.preventDefault()}}},nt=function(e,t,i){e.wysiwyg.popover.innerHTML="";var a=function(){l.value.trim()!==""&&(t.innerHTML=l.value),t.setAttribute("href",L.value),t.setAttribute("title",A.value),ye(e)};t.querySelectorAll("[data-marker]").forEach(function(P){P.removeAttribute("data-marker")});var o=document.createElement("span");o.setAttribute("aria-label",window.VditorI18n.textIsNotEmpty),o.className="vditor-tooltipped vditor-tooltipped__n";var l=document.createElement("input");o.appendChild(l),l.className="vditor-input",l.setAttribute("placeholder",window.VditorI18n.textIsNotEmpty),l.style.width="120px",l.value=t.innerHTML||"",l.oninput=function(){a()},l.onkeydown=function(P){be(e,P)||rt(P,i)||Et(e,t,P,L)};var E=document.createElement("span");E.setAttribute("aria-label",window.VditorI18n.link),E.className="vditor-tooltipped vditor-tooltipped__n";var L=document.createElement("input");E.appendChild(L),L.className="vditor-input",L.setAttribute("placeholder",window.VditorI18n.link),L.value=t.getAttribute("href")||"",L.oninput=function(){a()},L.onkeydown=function(P){be(e,P)||rt(P,i)||Et(e,t,P,A)};var D=document.createElement("span");D.setAttribute("aria-label",window.VditorI18n.tooltipText),D.className="vditor-tooltipped vditor-tooltipped__n";var A=document.createElement("input");D.appendChild(A),A.className="vditor-input",A.setAttribute("placeholder",window.VditorI18n.tooltipText),A.style.width="60px",A.value=t.getAttribute("title")||"",A.oninput=function(){a()},A.onkeydown=function(P){be(e,P)||rt(P,i)||Et(e,t,P,l)},mt(t,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",o),e.wysiwyg.popover.insertAdjacentElement("beforeend",E),e.wysiwyg.popover.insertAdjacentElement("beforeend",D),et(e,t)},Ve=function(e,t){var i=e.target;t.wysiwyg.popover.innerHTML="";var a=function(){i.setAttribute("src",l.value),i.setAttribute("alt",L.value),i.setAttribute("title",A.value),typeof t.options.input=="function"&&t.options.input(T(t))},o=document.createElement("span");o.setAttribute("aria-label",window.VditorI18n.imageURL),o.className="vditor-tooltipped vditor-tooltipped__n";var l=document.createElement("input");o.appendChild(l),l.className="vditor-input",l.setAttribute("placeholder",window.VditorI18n.imageURL),l.value=i.getAttribute("src")||"",l.oninput=function(){a()},l.onkeydown=function(P){be(t,P)};var E=document.createElement("span");E.setAttribute("aria-label",window.VditorI18n.alternateText),E.className="vditor-tooltipped vditor-tooltipped__n";var L=document.createElement("input");E.appendChild(L),L.className="vditor-input",L.setAttribute("placeholder",window.VditorI18n.alternateText),L.style.width="52px",L.value=i.getAttribute("alt")||"",L.oninput=function(){a()},L.onkeydown=function(P){be(t,P)};var D=document.createElement("span");D.setAttribute("aria-label",window.VditorI18n.title),D.className="vditor-tooltipped vditor-tooltipped__n";var A=document.createElement("input");D.appendChild(A),A.className="vditor-input",A.setAttribute("placeholder",window.VditorI18n.title),A.value=i.getAttribute("title")||"",A.oninput=function(){a()},A.onkeydown=function(P){be(t,P)},mt(i,t),t.wysiwyg.popover.insertAdjacentElement("beforeend",o),t.wysiwyg.popover.insertAdjacentElement("beforeend",E),t.wysiwyg.popover.insertAdjacentElement("beforeend",D),et(t,i)},rt=function(e,t){if(!(0,u._0)(e)&&!e.shiftKey&&e.key==="Enter"||e.key==="Escape")return t&&(0,j.jl)(t),e.preventDefault(),e.stopPropagation(),!0},Lt=function(e){e.currentMode==="wysiwyg"?ze(e):e.currentMode==="ir"&&Le(e)},Bt=function(e,t,i){i===void 0&&(i={enableAddUndoStack:!0,enableHint:!1,enableInput:!0});var a=e.wysiwyg.element;a.innerHTML=e.lute.Md2VditorDOM(t),a.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach(function(o){$e(o,e),o.previousElementSibling.setAttribute("style","display:none")}),ye(e,i)},bo=function(e,t,i){for(var a=e.startContainer.parentElement,o=!1,l="",E="",L=Ot(e),D=L.beforeHTML,A=L.afterHTML;a&&!o;){var P=a.tagName;if(P==="STRIKE"&&(P="S"),P==="I"&&(P="EM"),P==="B"&&(P="STRONG"),P==="S"||P==="STRONG"||P==="EM"){var F="",le="",oe="";a.parentElement.getAttribute("data-block")!=="0"&&(le=xt(a),oe=Pe(a)),(D||le)&&(F="".concat(le,"<").concat(P,">").concat(D,"</").concat(P,">"),D=F),(i==="bold"&&P==="STRONG"||i==="italic"&&P==="EM"||i==="strikeThrough"&&P==="S")&&(F+="".concat(l).concat(f.Y.ZWSP,"<wbr>").concat(E),o=!0),(A||oe)&&(A="<".concat(P,">").concat(A,"</").concat(P,">").concat(oe),F+=A),a.parentElement.getAttribute("data-block")!=="0"?(a=a.parentElement,a.innerHTML=F):(a.outerHTML=F,a=a.parentElement),l="<".concat(P,">")+l,E="</".concat(P,">")+E}else o=!0}(0,j.ir)(t.wysiwyg.element,e)},wo=function(e,t,i){if(!(e.wysiwyg.composingLock&&i instanceof CustomEvent)){var a=!0,o=!0;e.wysiwyg.element.querySelector("wbr")&&e.wysiwyg.element.querySelector("wbr").remove();var l=(0,j.RN)(e),E=t.getAttribute("data-type");if(t.classList.contains("vditor-menu--current"))if(E==="strike"&&(E="strikeThrough"),E==="quote"){var L=(0,v._Y)(l.startContainer,"BLOCKQUOTE");L||(L=l.startContainer.childNodes[l.startOffset]),L&&(a=!1,t.classList.remove("vditor-menu--current"),l.insertNode(document.createElement("wbr")),L.outerHTML=L.innerHTML.trim()===""?'<p data-block="0">'.concat(L.innerHTML,"</p>"):L.innerHTML,(0,j.ir)(e.wysiwyg.element,l))}else if(E==="inline-code"){var D=(0,v._Y)(l.startContainer,"CODE");D||(D=l.startContainer.childNodes[l.startOffset]),D&&(D.outerHTML=D.innerHTML.replace(f.Y.ZWSP,"")+"<wbr>",(0,j.ir)(e.wysiwyg.element,l))}else E==="link"?(l.collapsed&&l.selectNode(l.startContainer.parentElement),document.execCommand("unlink",!1,"")):E==="check"||E==="list"||E==="ordered-list"?(li(e,l,E),(0,j.ir)(e.wysiwyg.element,l),a=!1,t.classList.remove("vditor-menu--current")):(a=!1,t.classList.remove("vditor-menu--current"),l.toString()===""?bo(l,e,E):document.execCommand(E,!1,""));else{e.wysiwyg.element.childNodes.length===0&&(e.wysiwyg.element.innerHTML='<p data-block="0"><wbr></p>',(0,j.ir)(e.wysiwyg.element,l));var A=(0,v.pt)(l.startContainer);if(E==="quote"){if(A||(A=l.startContainer.childNodes[l.startOffset]),A){a=!1,t.classList.add("vditor-menu--current"),l.insertNode(document.createElement("wbr"));var P=(0,v._Y)(l.startContainer,"LI");P&&A.contains(P)?P.innerHTML='<blockquote data-block="0">'.concat(P.innerHTML,"</blockquote>"):A.outerHTML='<blockquote data-block="0">'.concat(A.outerHTML,"</blockquote>"),(0,j.ir)(e.wysiwyg.element,l)}}else if(E==="check"||E==="list"||E==="ordered-list")li(e,l,E,!1),(0,j.ir)(e.wysiwyg.element,l),a=!1,m(e.toolbar.elements,["check","list","ordered-list"]),t.classList.add("vditor-menu--current");else if(E==="inline-code"){if(l.toString()===""){var F=document.createElement("code");F.textContent=f.Y.ZWSP,l.insertNode(F),l.setStart(F.firstChild,1),l.collapse(!0),(0,j.jl)(l)}else if(l.startContainer.nodeType===3){var F=document.createElement("code");l.surroundContents(F),l.insertNode(F),(0,j.jl)(l)}t.classList.add("vditor-menu--current")}else if(E==="code"){var F=document.createElement("div");F.className="vditor-wysiwyg__block",F.setAttribute("data-type","code-block"),F.setAttribute("data-block","0"),F.setAttribute("data-marker","```"),l.toString()===""?F.innerHTML=`<pre><code><wbr>
</code></pre>`:(F.innerHTML="<pre><code>".concat(l.toString(),"<wbr></code></pre>"),l.deleteContents()),l.insertNode(F),A&&(A.outerHTML=e.lute.SpinVditorDOM(A.outerHTML)),(0,j.ir)(e.wysiwyg.element,l),e.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach(function(ot){$e(ot,e)}),t.classList.add("vditor-menu--disabled")}else if(E==="link"){if(l.toString()===""){var le=document.createElement("a");le.innerText=f.Y.ZWSP,l.insertNode(le),l.setStart(le.firstChild,1),l.collapse(!0),nt(e,le,l);var oe=e.wysiwyg.popover.querySelector("input");oe.value="",oe.focus(),o=!1}else{var F=document.createElement("a");F.setAttribute("href",""),F.innerHTML=l.toString(),l.surroundContents(F),l.insertNode(F),(0,j.jl)(l),nt(e,F,l);var te=e.wysiwyg.popover.querySelectorAll("input");te[0].value=F.innerText,te[1].focus()}a=!1,t.classList.add("vditor-menu--current")}else if(E==="table"){var Ce='<table data-block="0"><thead><tr><th>col1<wbr></th><th>col2</th><th>col3</th></tr></thead><tbody><tr><td> </td><td> </td><td> </td></tr><tr><td> </td><td> </td><td> </td></tr></tbody></table>';if(l.toString().trim()==="")A&&A.innerHTML.trim().replace(f.Y.ZWSP,"")===""?A.outerHTML=Ce:document.execCommand("insertHTML",!1,Ce),l.selectNode(e.wysiwyg.element.querySelector("wbr").previousSibling),e.wysiwyg.element.querySelector("wbr").remove(),(0,j.jl)(l);else{Ce='<table data-block="0"><thead><tr>';var he=l.toString().split(`
`),Q=he[0].split(",").length>he[0].split("	").length?",":"	";he.forEach(function(je,ot){ot===0?(je.split(Q).forEach(function(it,st){st===0?Ce+="<th>".concat(it,"<wbr></th>"):Ce+="<th>".concat(it,"</th>")}),Ce+="</tr></thead>"):(ot===1?Ce+="<tbody><tr>":Ce+="<tr>",je.split(Q).forEach(function(it){Ce+="<td>".concat(it,"</td>")}),Ce+="</tr>")}),Ce+="</tbody></table>",document.execCommand("insertHTML",!1,Ce),(0,j.ir)(e.wysiwyg.element,l)}a=!1,t.classList.add("vditor-menu--disabled")}else if(E==="line"){if(A){var Ie=`<hr data-block="0"><p data-block="0"><wbr>
</p>`;A.innerHTML.trim()===""?A.outerHTML=Ie:A.insertAdjacentHTML("afterend",Ie),(0,j.ir)(e.wysiwyg.element,l)}}else if(a=!1,t.classList.add("vditor-menu--current"),E==="strike"&&(E="strikeThrough"),l.toString()===""&&(E==="bold"||E==="italic"||E==="strikeThrough")){var we="strong";E==="italic"?we="em":E==="strikeThrough"&&(we="s");var F=document.createElement(we);F.textContent=f.Y.ZWSP,l.insertNode(F),F.previousSibling&&F.previousSibling.textContent===f.Y.ZWSP&&(F.previousSibling.textContent=""),l.setStart(F.firstChild,1),l.collapse(!0),(0,j.jl)(l)}else document.execCommand(E,!1,"")}a&&ze(e),o&&ye(e)}},pt=function(){function e(t,i){var a,o=this;this.element=document.createElement("div"),i.className&&(a=this.element.classList).add.apply(a,i.className.split(" "));var l=i.hotkey?" <".concat((0,u.fG)(i.hotkey),">"):"";i.level===2&&(l=i.hotkey?" &lt;".concat((0,u.fG)(i.hotkey),"&gt;"):"");var E=i.tip?i.tip+l:"".concat(window.VditorI18n[i.name]).concat(l),L=i.name==="upload"?"div":"button";if(i.level===2)this.element.innerHTML="<".concat(L,' data-type="').concat(i.name,'">').concat(E,"</").concat(L,">");else{this.element.classList.add("vditor-toolbar__item");var D=document.createElement(L);D.setAttribute("data-type",i.name),D.className="vditor-tooltipped vditor-tooltipped__".concat(i.tipPosition),D.setAttribute("aria-label",E),D.innerHTML=i.icon,this.element.appendChild(D)}i.prefix&&this.element.children[0].addEventListener((0,u.y3)(),function(A){A.preventDefault(),!o.element.firstElementChild.classList.contains(f.Y.CLASS_MENU_DISABLED)&&(t.currentMode==="wysiwyg"?wo(t,o.element.children[0],A):t.currentMode==="ir"?Io(t,o.element.children[0],i.prefix||"",i.suffix||""):ko(t,o.element.children[0],i.prefix||"",i.suffix||""))})}return e}(),Eo=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),mn=function(e,t,i){var a;if(typeof i!="string"?(M(e,["subToolbar","hint"]),i.preventDefault(),a=T(e)):a=i,!(e.currentMode===t&&typeof i!="string")){if(e.devtools&&e.devtools.renderEchart(e),e.options.preview.mode==="both"&&t==="sv"?e.preview.element.style.display="block":e.preview.element.style.display="none",w(e.toolbar.elements,f.Y.EDIT_TOOLBARS),m(e.toolbar.elements,f.Y.EDIT_TOOLBARS),b(e.toolbar.elements,["outdent","indent"]),t==="ir")S(e.toolbar.elements,["both"]),_(e.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),e.sv.element.style.display="none",e.wysiwyg.element.parentElement.style.display="none",e.ir.element.parentElement.style.display="block",e.lute.SetVditorIR(!0),e.lute.SetVditorWYSIWYG(!1),e.lute.SetVditorSV(!1),e.currentMode="ir",e.ir.element.innerHTML=e.lute.Md2VditorIRDOM(a),nn(e,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),ct(e),e.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach(function(l){$e(l,e)}),e.ir.element.querySelectorAll(".vditor-toc").forEach(function(l){(0,ue.T)(l,{cdn:e.options.cdn,math:e.options.preview.math})});else if(t==="wysiwyg")S(e.toolbar.elements,["both"]),_(e.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),e.sv.element.style.display="none",e.wysiwyg.element.parentElement.style.display="block",e.ir.element.parentElement.style.display="none",e.lute.SetVditorIR(!1),e.lute.SetVditorWYSIWYG(!0),e.lute.SetVditorSV(!1),e.currentMode="wysiwyg",ct(e),Bt(e,a,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),e.wysiwyg.element.querySelectorAll(".vditor-toc").forEach(function(l){(0,ue.T)(l,{cdn:e.options.cdn,math:e.options.preview.math})}),e.wysiwyg.popover.style.display="none";else if(t==="sv"){_(e.toolbar.elements,["both"]),S(e.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),e.wysiwyg.element.parentElement.style.display="none",e.ir.element.parentElement.style.display="none",(e.options.preview.mode==="both"||e.options.preview.mode==="editor")&&(e.sv.element.style.display="block"),e.lute.SetVditorIR(!1),e.lute.SetVditorWYSIWYG(!1),e.lute.SetVditorSV(!0),e.currentMode="sv";var o=Ar(a,e);o==="<div data-block='0'></div>"&&(o=""),e.sv.element.innerHTML=o,qe(e.sv.element),St(e,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),ct(e)}e.undo.resetIcon(e),typeof i!="string"&&(e[e.currentMode].element.focus(),Lt(e)),ce(e),Y(e),e.toolbar.elements["edit-mode"]&&(e.toolbar.elements["edit-mode"].querySelectorAll("button").forEach(function(l){l.classList.remove("vditor-menu--current")}),e.toolbar.elements["edit-mode"].querySelector('button[data-mode="'.concat(e.currentMode,'"]')).classList.add("vditor-menu--current")),e.outline.toggle(e,e.currentMode!=="sv"&&e.options.outline.enable,typeof i!="string")}},So=function(e){Eo(t,e);function t(i,a){var o=e.call(this,i,a)||this,l=document.createElement("div");return l.className="vditor-hint".concat(a.level===2?"":" vditor-panel--arrow"),l.innerHTML='<button data-mode="wysiwyg">'.concat(window.VditorI18n.wysiwyg," &lt;").concat((0,u.fG)("⌥⌘7"),`></button>
<button data-mode="ir">`).concat(window.VditorI18n.instantRendering," &lt;").concat((0,u.fG)("⌥⌘8"),`></button>
<button data-mode="sv">`).concat(window.VditorI18n.splitView," &lt;").concat((0,u.fG)("⌥⌘9"),"></button>"),o.element.appendChild(l),o._bindEvent(i,l,a),o}return t.prototype._bindEvent=function(i,a,o){var l=this.element.children[0];x(i,a,l,o.level),a.children.item(0).addEventListener((0,u.y3)(),function(E){mn(i,"wysiwyg",E),E.preventDefault(),E.stopPropagation()}),a.children.item(1).addEventListener((0,u.y3)(),function(E){mn(i,"ir",E),E.preventDefault(),E.stopPropagation()}),a.children.item(2).addEventListener((0,u.y3)(),function(E){mn(i,"sv",E),E.preventDefault(),E.stopPropagation()})},t}(pt),Un=function(e,t){return(0,j.Co)(e,t)?getSelection().toString():""},Bi=function(e,t){t.addEventListener("focus",function(){e.options.focus&&e.options.focus(T(e)),M(e,["subToolbar","hint"])})},Lr=function(e,t){t.addEventListener("dblclick",function(i){i.target.tagName==="IMG"&&(e.options.image.preview?e.options.image.preview(i.target):e.options.image.isPreview&&(0,re.o)(i.target,e.options.lang,e.options.theme))})},zi=function(e,t){t.addEventListener("blur",function(i){if(e.currentMode==="ir"){var a=e.ir.element.querySelector(".vditor-ir__node--expand");a&&a.classList.remove("vditor-ir__node--expand")}else e.currentMode==="wysiwyg"&&!e.wysiwyg.selectPopover.contains(i.relatedTarget)&&e.wysiwyg.hideComment();e[e.currentMode].range=(0,j.RN)(e),e.options.blur&&e.options.blur(T(e))})},$i=function(e,t){t.addEventListener("dragstart",function(i){i.dataTransfer.setData(f.Y.DROP_EDITOR,f.Y.DROP_EDITOR)}),t.addEventListener("drop",function(i){i.dataTransfer.getData(f.Y.DROP_EDITOR)?Ke(e):(i.dataTransfer.types.includes("Files")||i.dataTransfer.types.includes("text/html"))&&di(e,i,{pasteCode:function(a){document.execCommand("insertHTML",!1,a)}})})},Fi=function(e,t,i){t.addEventListener("copy",function(a){return i(a,e)})},Ui=function(e,t,i){t.addEventListener("cut",function(a){i(a,e),e.options.comment.enable&&e.currentMode==="wysiwyg"&&e.wysiwyg.getComments(e),document.execCommand("delete")})},vt=function(e){if(e.currentMode==="wysiwyg"&&e.options.comment.enable&&e.options.comment.adjustTop(e.wysiwyg.getComments(e,!0)),!!e.options.typewriterMode){var t=e[e.currentMode].element,i=(0,j.Ey)(t).top;e.options.height==="auto"&&!e.element.classList.contains("vditor--fullscreen")&&window.scrollTo(window.scrollX,i+e.element.offsetTop+e.toolbar.element.offsetHeight-window.innerHeight/2+10),(e.options.height!=="auto"||e.element.classList.contains("vditor--fullscreen"))&&(t.scrollTop=i+t.scrollTop-t.clientHeight/2+10)}},Vi=function(e,t){t.addEventListener("keydown",function(i){if(!i.isComposing&&e.options.keydown&&e.options.keydown(i),!((e.options.hint.extend.length>1||e.toolbar.elements.emoji)&&e.hint.select(i,e))){if(e.options.comment.enable&&e.currentMode==="wysiwyg"&&(i.key==="Backspace"||B("⌘X",i))&&e.wysiwyg.getComments(e),e.currentMode==="sv"){if(Ue(e,i))return}else if(e.currentMode==="wysiwyg"){if(pe(e,i))return}else if(e.currentMode==="ir"&&xe(e,i))return;if(e.options.ctrlEnter&&B("⌘Enter",i)){e.options.ctrlEnter(T(e)),i.preventDefault();return}if(B("⌘Z",i)&&!e.toolbar.elements.undo){e.undo.undo(e),i.preventDefault();return}if(B("⌘Y",i)&&!e.toolbar.elements.redo){e.undo.redo(e),i.preventDefault();return}if(i.key==="Escape"){e.hint.element.style.display==="block"?e.hint.element.style.display="none":e.options.esc&&!i.isComposing&&e.options.esc(T(e)),i.preventDefault();return}if((0,u._0)(i)&&i.altKey&&!i.shiftKey&&/^Digit[1-6]$/.test(i.code)){if(e.currentMode==="wysiwyg"){var a=i.code.replace("Digit","H");(0,v._Y)(getSelection().getRangeAt(0).startContainer,a)?fe(e):J(e,a),ye(e)}else e.currentMode==="sv"?Dr(e,"#".repeat(parseInt(i.code.replace("Digit",""),10))+" "):e.currentMode==="ir"&&Wn(e,"#".repeat(parseInt(i.code.replace("Digit",""),10))+" ");return i.preventDefault(),!0}if((0,u._0)(i)&&i.altKey&&!i.shiftKey&&/^Digit[7-9]$/.test(i.code))return i.code==="Digit7"?mn(e,"wysiwyg",i):i.code==="Digit8"?mn(e,"ir",i):i.code==="Digit9"&&mn(e,"sv",i),!0;e.options.toolbar.find(function(o){if(!o.hotkey||o.toolbar){if(o.toolbar){var l=o.toolbar.find(function(E){if(!E.hotkey)return!1;if(B(E.hotkey,i))return e.toolbar.elements[E.name].children[0].dispatchEvent(new CustomEvent((0,u.y3)())),i.preventDefault(),!0});return!!l}return!1}if(B(o.hotkey,i))return e.toolbar.elements[o.name].children[0].dispatchEvent(new CustomEvent((0,u.y3)())),i.preventDefault(),!0})}})},qi=function(e,t){t.addEventListener("selectstart",function(i){t.onmouseup=function(){setTimeout(function(){var a=Un(e[e.currentMode].element);a.trim()?(e.currentMode==="wysiwyg"&&e.options.comment.enable&&(!(0,v.Th)(i.target,"data-type","footnotes-block")&&!(0,v.Th)(i.target,"data-type","link-ref-defs-block")?e.wysiwyg.showComment():e.wysiwyg.hideComment()),e.options.select&&e.options.select(a)):e.currentMode==="wysiwyg"&&e.options.comment.enable&&e.wysiwyg.hideComment()})}})},Wi=function(e,t){var i=(0,j.RN)(e);i.extractContents(),i.insertNode(document.createTextNode(Lute.Caret)),i.insertNode(document.createTextNode(t));var a=(0,v.Th)(i.startContainer,"data-block","0");a||(a=e.sv.element);var o=e.lute.SpinVditorSVDOM(a.textContent);o="<div data-block='0'>"+o.replace(/<span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span><span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span></g,`<span data-type="newline"><br /><span style="display: none">
</span></span><span data-type="newline"><br /><span style="display: none">
</span></span></div><div data-block="0"><`)+"</div>",a.isEqualNode(e.sv.element)?a.innerHTML=o:a.outerHTML=o,qe(e.sv.element),(0,j.ir)(e.sv.element,i),vt(e)},oi=function(e,t,i){i===void 0&&(i=!0);var a=e;for(a.nodeType===3&&(a=a.parentElement);a;){if(a.getAttribute("data-type")===t)return a;i?a=a.previousElementSibling:a=a.nextElementSibling}return!1},Ar=function(e,t){H("SpinVditorSVDOM",e,"argument",t.options.debugger);var i=t.lute.SpinVditorSVDOM(e);return e="<div data-block='0'>"+i.replace(/<span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span><span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span></g,`<span data-type="newline"><br /><span style="display: none">
</span></span><span data-type="newline"><br /><span style="display: none">
</span></span></div><div data-block="0"><`)+"</div>",H("SpinVditorSVDOM",e,"result",t.options.debugger),e},Co=function(e){var t=e.getAttribute("data-type"),i=e.previousElementSibling,a=t&&t!=="text"&&t!=="table"&&t!=="heading-marker"&&t!=="newline"&&t!=="yaml-front-matter-open-marker"&&t!=="yaml-front-matter-close-marker"&&t!=="code-block-info"&&t!=="code-block-close-marker"&&t!=="code-block-open-marker"?e.textContent:"",o=!1;for(t==="newline"&&(o=!0);i&&!o;){var l=i.getAttribute("data-type");if(l==="li-marker"||l==="blockquote-marker"||l==="task-marker"||l==="padding"){var E=i.textContent;if(l==="li-marker"&&(t==="code-block-open-marker"||t==="code-block-info"))a=E.replace(/\S/g," ")+a;else if(t==="code-block-close-marker"&&i.nextElementSibling.isSameNode(e)){var L=oi(e,"code-block-open-marker");L&&L.previousElementSibling&&(i=L.previousElementSibling,a=E+a)}else a=E+a}else l==="newline"&&(o=!0);i=i.previousElementSibling}return a},St=function(e,t){t===void 0&&(t={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),t.enableHint&&e.hint.render(e),e.preview.render(e);var i=T(e);typeof e.options.input=="function"&&t.enableInput&&e.options.input(i),e.options.counter.enable&&e.counter.render(e,i),e.options.cache.enable&&(0,u.D)()&&(localStorage.setItem(e.options.cache.id,i),e.options.cache.after&&e.options.cache.after(i)),e.devtools&&e.devtools.renderEchart(e),clearTimeout(e.sv.processTimeoutId),e.sv.processTimeoutId=window.setTimeout(function(){t.enableAddUndoStack&&!e.sv.composingLock&&e.undo.addToUndoStack(e)},e.options.undoDelay)},Dr=function(e,t){var i=(0,j.RN)(e),a=(0,O.f)(i.startContainer,"SPAN");a&&a.textContent.trim()!==""&&(t=`
`+t),i.collapse(!0),document.execCommand("insertHTML",!1,t)},ko=function(e,t,i,a){var o=(0,j.RN)(e),l=t.getAttribute("data-type");e.sv.element.childNodes.length===0&&(e.sv.element.innerHTML=`<span data-type="p" data-block="0"><span data-type="text"><wbr></span></span><span data-type="newline"><br><span style="display: none">
</span></span>`,(0,j.ir)(e.sv.element,o));var E=(0,v.pt)(o.startContainer),L=(0,O.f)(o.startContainer,"SPAN");if(E){if(l==="link"){var D=void 0;o.toString()===""?D="".concat(i).concat(Lute.Caret).concat(a):D="".concat(i).concat(o.toString()).concat(a.replace(")",Lute.Caret+")")),document.execCommand("insertHTML",!1,D);return}else if(l==="italic"||l==="bold"||l==="strike"||l==="inline-code"||l==="code"||l==="table"||l==="line"){var D=void 0;o.toString()===""?D="".concat(i).concat(Lute.Caret).concat(l==="code"?"":a):D="".concat(i).concat(o.toString()).concat(Lute.Caret).concat(l==="code"?"":a),l==="table"||l==="code"&&L&&L.textContent!==""?D=`

`+D:l==="line"&&(D=`

`.concat(i,`
`).concat(Lute.Caret)),document.execCommand("insertHTML",!1,D);return}else if((l==="check"||l==="list"||l==="ordered-list"||l==="quote")&&L){var A="* ";l==="check"?A="* [ ] ":l==="ordered-list"?A="1. ":l==="quote"&&(A="> ");var P=oi(L,"newline");P?P.insertAdjacentText("afterend",A):E.insertAdjacentText("afterbegin",A),Be(e);return}(0,j.ir)(e.sv.element,o),St(e)}},Or=function(e){switch(e.currentMode){case"ir":return e.ir.element;case"wysiwyg":return e.wysiwyg.element;case"sv":return e.sv.element}},Pr=function(e,t){e.options.upload.setHeaders&&(e.options.upload.headers=e.options.upload.setHeaders()),e.options.upload.headers&&Object.keys(e.options.upload.headers).forEach(function(i){t.setRequestHeader(i,e.options.upload.headers[i])})},To=function(e,t,i,a){function o(l){return l instanceof i?l:new i(function(E){E(l)})}return new(i||(i=Promise))(function(l,E){function L(P){try{A(a.next(P))}catch(F){E(F)}}function D(P){try{A(a.throw(P))}catch(F){E(F)}}function A(P){P.done?l(P.value):o(P.value).then(L,D)}A((a=a.apply(e,t||[])).next())})},xo=function(e,t){var i={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,o,l,E;return E={next:L(0),throw:L(1),return:L(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function L(A){return function(P){return D([A,P])}}function D(A){if(a)throw new TypeError("Generator is already executing.");for(;E&&(E=0,A[0]&&(i=0)),i;)try{if(a=1,o&&(l=A[0]&2?o.return:A[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,A[1])).done)return l;switch(o=0,l&&(A=[A[0]&2,l.value]),A[0]){case 0:case 1:l=A;break;case 4:return i.label++,{value:A[1],done:!1};case 5:i.label++,o=A[1],A=[0];continue;case 7:A=i.ops.pop(),i.trys.pop();continue;default:if(l=i.trys,!(l=l.length>0&&l[l.length-1])&&(A[0]===6||A[0]===2)){i=0;continue}if(A[0]===3&&(!l||A[1]>l[0]&&A[1]<l[3])){i.label=A[1];break}if(A[0]===6&&i.label<l[1]){i.label=l[1],l=A;break}if(l&&i.label<l[2]){i.label=l[2],i.ops.push(A);break}l[2]&&i.ops.pop(),i.trys.pop();continue}A=t.call(e,i)}catch(P){A=[6,P],o=0}finally{a=l=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}},_o=function(){function e(){this.isUploading=!1,this.element=document.createElement("div"),this.element.className="vditor-upload"}return e}(),Mo=function(e,t){e.tip.hide();var i=[],a="",o="";e.options.lang,e.options;for(var l=function(D,A){var P=t[A],F=!0;P.name||(a+="<li>".concat(window.VditorI18n.nameEmpty,"</li>"),F=!1),P.size>e.options.upload.max&&(a+="<li>".concat(P.name," ").concat(window.VditorI18n.over," ").concat(e.options.upload.max/1024/1024,"M</li>"),F=!1);var le=P.name.lastIndexOf("."),oe=P.name.substr(le),te=e.options.upload.filename(P.name.substr(0,le))+oe;if(e.options.upload.accept){var Ce=e.options.upload.accept.split(",").some(function(he){var Q=he.trim();if(Q.indexOf(".")===0){if(oe.toLowerCase()===Q.toLowerCase())return!0}else if(P.type.split("/")[0]===Q.split("/")[0])return!0;return!1});Ce||(a+="<li>".concat(P.name," ").concat(window.VditorI18n.fileTypeError,"</li>"),F=!1)}F&&(i.push(P),o+="<li>".concat(te," ").concat(window.VditorI18n.uploading,"</li>"))},E=t.length,L=0;L<E;L++)l(E,L);return e.tip.show("<ul>".concat(a).concat(o,"</ul>")),i},Lo=function(e,t){var i=Or(t);i.focus();var a=JSON.parse(e),o="";a.code===1&&(o="".concat(a.msg)),a.data.errFiles&&a.data.errFiles.length>0&&(o="<ul><li>".concat(o,"</li>"),a.data.errFiles.forEach(function(E){var L=E.lastIndexOf("."),D=t.options.upload.filename(E.substr(0,L))+E.substr(L);o+="<li>".concat(D," ").concat(window.VditorI18n.uploadError,"</li>")}),o+="</ul>"),o?t.tip.show(o):t.tip.hide();var l="";Object.keys(a.data.succMap).forEach(function(E){var L=a.data.succMap[E],D=E.lastIndexOf("."),A=E.substr(D),P=t.options.upload.filename(E.substr(0,D))+A;A=A.toLowerCase(),A.indexOf(".wav")===0||A.indexOf(".mp3")===0||A.indexOf(".ogg")===0?t.currentMode==="wysiwyg"?l+=`<div class="vditor-wysiwyg__block" data-type="html-block"
 data-block="0"><pre><code>&lt;audio controls="controls" src="`.concat(L,'"&gt;&lt;/audio&gt;</code></pre><pre class="vditor-wysiwyg__preview" data-render="1"><audio controls="controls" src="').concat(L,`"></audio></pre></div>
`):t.currentMode==="ir"?l+='<audio controls="controls" src="'.concat(L,`"></audio>
`):l+="[".concat(P,"](").concat(L,`)
`):A.indexOf(".apng")===0||A.indexOf(".bmp")===0||A.indexOf(".gif")===0||A.indexOf(".ico")===0||A.indexOf(".cur")===0||A.indexOf(".jpg")===0||A.indexOf(".jpeg")===0||A.indexOf(".jfif")===0||A.indexOf(".pjp")===0||A.indexOf(".pjpeg")===0||A.indexOf(".png")===0||A.indexOf(".svg")===0||A.indexOf(".webp")===0?t.currentMode==="wysiwyg"?l+='<img alt="'.concat(P,'" src="').concat(L,`">
`):l+="![".concat(P,"](").concat(L,`)
`):t.currentMode==="wysiwyg"?l+='<a href="'.concat(L,'">').concat(P,`</a>
`):l+="[".concat(P,"](").concat(L,`)
`)}),(0,j.jl)(t.upload.range),document.execCommand("insertHTML",!1,l),t.upload.range=getSelection().getRangeAt(0).cloneRange()},Yi=function(e,t,i){return To(void 0,void 0,void 0,function(){var a,o,te,l,E,E,L,D,A,P,F,le,oe,te,Ce,he;return xo(this,function(Q){switch(Q.label){case 0:for(a=[],o=e.options.upload.multiple===!0?t.length:1,te=0;te<o;te++)l=t[te],l instanceof DataTransferItem&&(l=l.getAsFile()),a.push(l);return e.options.upload.handler?[4,e.options.upload.handler(a)]:[3,2];case 1:return E=Q.sent(),i&&(i.value=""),typeof E=="string"?(e.tip.show(E),[2]):[2];case 2:return!e.options.upload.url||!e.upload?(i&&(i.value=""),e.tip.show("please config: options.upload.url"),[2]):e.options.upload.file?[4,e.options.upload.file(a)]:[3,4];case 3:a=Q.sent(),Q.label=4;case 4:if(e.options.upload.validate&&(E=e.options.upload.validate(a),typeof E=="string"))return e.tip.show(E),[2];if(L=Or(e),e.upload.range=(0,j.RN)(e),D=Mo(e,a),D.length===0)return i&&(i.value=""),[2];for(A=new FormData,P=e.options.upload.extraData,F=0,le=Object.keys(P);F<le.length;F++)oe=le[F],A.append(oe,P[oe]);for(te=0,Ce=D.length;te<Ce;te++)A.append(e.options.upload.fieldName,D[te]);return he=new XMLHttpRequest,he.open("POST",e.options.upload.url),e.options.upload.token&&he.setRequestHeader("X-Upload-Token",e.options.upload.token),e.options.upload.withCredentials&&(he.withCredentials=!0),Pr(e,he),e.upload.isUploading=!0,L.setAttribute("contenteditable","false"),he.onreadystatechange=function(){if(he.readyState===XMLHttpRequest.DONE){if(e.upload.isUploading=!1,L.setAttribute("contenteditable","true"),he.status>=200&&he.status<300)if(e.options.upload.success)e.options.upload.success(L,he.responseText);else{var Ie=he.responseText;e.options.upload.format&&(Ie=e.options.upload.format(t,he.responseText)),Lo(Ie,e)}else e.options.upload.error?e.options.upload.error(he.responseText):e.tip.show(he.responseText);i&&(i.value=""),e.upload.element.style.display="none"}},he.upload.onprogress=function(Ie){if(Ie.lengthComputable){var we=Ie.loaded/Ie.total*100;e.upload.element.style.display="block";var je=e.upload.element;je.style.width=we+"%"}},he.send(A),[2]}})})},si=function(e,t,i){var a,o=(0,v.pt)(t.startContainer);if(o||(o=e.wysiwyg.element),i&&i.inputType!=="formatItalic"&&i.inputType!=="deleteByDrag"&&i.inputType!=="insertFromDrop"&&i.inputType!=="formatBold"&&i.inputType!=="formatRemove"&&i.inputType!=="formatStrikeThrough"&&i.inputType!=="insertUnorderedList"&&i.inputType!=="insertOrderedList"&&i.inputType!=="formatOutdent"&&i.inputType!=="formatIndent"&&i.inputType!==""||!i){var l=ft(t.startContainer);l&&l.remove(),e.wysiwyg.element.querySelectorAll("wbr").forEach(function(we){we.remove()}),t.insertNode(document.createElement("wbr")),o.querySelectorAll("[style]").forEach(function(we){we.removeAttribute("style")}),o.querySelectorAll(".vditor-comment").forEach(function(we){we.textContent.trim()===""&&(we.classList.remove("vditor-comment","vditor-comment--focus"),we.removeAttribute("data-cmtids"))}),(a=o.previousElementSibling)===null||a===void 0||a.querySelectorAll(".vditor-comment").forEach(function(we){we.textContent.trim()===""&&(we.classList.remove("vditor-comment","vditor-comment--focus"),we.removeAttribute("data-cmtids"))});var E="";o.getAttribute("data-type")==="link-ref-defs-block"&&(o=e.wysiwyg.element);var L=o.isEqualNode(e.wysiwyg.element),D=(0,v.Th)(o,"data-type","footnotes-block");if(L)E=o.innerHTML;else{var A=(0,v.KR)(t.startContainer);if(A&&!D){var P=(0,O.f)(t.startContainer,"BLOCKQUOTE");P?o=(0,v.pt)(t.startContainer)||o:o=A}if(D&&(o=D),E=o.outerHTML,o.tagName==="UL"||o.tagName==="OL"){var F=o.previousElementSibling,le=o.nextElementSibling;F&&(F.tagName==="UL"||F.tagName==="OL")&&(E=F.outerHTML+E,F.remove()),le&&(le.tagName==="UL"||le.tagName==="OL")&&(E=E+le.outerHTML,le.remove()),E=E.replace("<div><wbr><br></div>","<li><p><wbr><br></p></li>")}o.innerText.startsWith("```")||(e.wysiwyg.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(we){we&&!o.isEqualNode(we)&&(E+=we.outerHTML,we.remove())}),e.wysiwyg.element.querySelectorAll("[data-type='footnotes-block']").forEach(function(we){we&&!o.isEqualNode(we)&&(E+=we.outerHTML,we.remove())}))}if(E=E.replace(/<\/(strong|b)><strong data-marker="\W{2}">/g,"").replace(/<\/(em|i)><em data-marker="\W{1}">/g,"").replace(/<\/(s|strike)><s data-marker="~{1,2}">/g,""),E==='<p data-block="0">```<wbr></p>'&&e.hint.recentLanguage&&(E='<p data-block="0">```<wbr></p>'.replace("```","```"+e.hint.recentLanguage)),H("SpinVditorDOM",E,"argument",e.options.debugger),E=e.lute.SpinVditorDOM(E),H("SpinVditorDOM",E,"result",e.options.debugger),L)o.innerHTML=E;else if(o.outerHTML=E,D){var oe=(0,v.Ab)(e.wysiwyg.element.querySelector("wbr"),"LI");if(oe){var te=e.wysiwyg.element.querySelector('sup[data-type="footnotes-ref"][data-footnotes-label="'.concat(oe.getAttribute("data-marker"),'"]'));te&&te.setAttribute("aria-label",oe.textContent.trim().substr(0,24))}}var Ce,he=e.wysiwyg.element.querySelectorAll("[data-type='link-ref-defs-block']");he.forEach(function(we,je){je===0?Ce=we:(Ce.insertAdjacentHTML("beforeend",we.innerHTML),we.remove())}),he.length>0&&e.wysiwyg.element.insertAdjacentElement("beforeend",he[0]);var Q,Ie=e.wysiwyg.element.querySelectorAll("[data-type='footnotes-block']");Ie.forEach(function(we,je){je===0?Q=we:(Q.insertAdjacentHTML("beforeend",we.innerHTML),we.remove())}),Ie.length>0&&e.wysiwyg.element.insertAdjacentElement("beforeend",Ie[0]),(0,j.ir)(e.wysiwyg.element,t),e.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach(function(we){$e(we,e)}),i&&(i.inputType==="deleteContentBackward"||i.inputType==="deleteContentForward")&&e.options.comment.enable&&(e.wysiwyg.triggerRemoveComment(e),e.options.comment.adjustTop(e.wysiwyg.getComments(e,!0)))}ce(e),ye(e,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},Ao=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},Do=function(e,t,i,a){function o(l){return l instanceof i?l:new i(function(E){E(l)})}return new(i||(i=Promise))(function(l,E){function L(P){try{A(a.next(P))}catch(F){E(F)}}function D(P){try{A(a.throw(P))}catch(F){E(F)}}function A(P){P.done?l(P.value):o(P.value).then(L,D)}A((a=a.apply(e,t||[])).next())})},Oo=function(e,t){var i={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,o,l,E;return E={next:L(0),throw:L(1),return:L(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function L(A){return function(P){return D([A,P])}}function D(A){if(a)throw new TypeError("Generator is already executing.");for(;E&&(E=0,A[0]&&(i=0)),i;)try{if(a=1,o&&(l=A[0]&2?o.return:A[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,A[1])).done)return l;switch(o=0,l&&(A=[A[0]&2,l.value]),A[0]){case 0:case 1:l=A;break;case 4:return i.label++,{value:A[1],done:!1};case 5:i.label++,o=A[1],A=[0];continue;case 7:A=i.ops.pop(),i.trys.pop();continue;default:if(l=i.trys,!(l=l.length>0&&l[l.length-1])&&(A[0]===6||A[0]===2)){i=0;continue}if(A[0]===3&&(!l||A[1]>l[0]&&A[1]<l[3])){i.label=A[1];break}if(A[0]===6&&i.label<l[1]){i.label=l[1],l=A;break}if(l&&i.label<l[2]){i.label=l[2],i.ops.push(A);break}l[2]&&i.ops.pop(),i.trys.pop();continue}A=t.call(e,i)}catch(P){A=[6,P],o=0}finally{a=l=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}},Rr=function(e,t,i){if(e.keyCode===229&&e.code===""&&e.key==="Unidentified"&&t.currentMode!=="sv"){var a=(0,v.pt)(i);if(a&&a.textContent.trim()==="")return t[t.currentMode].composingLock=!0,!1}return!0},Ir=function(e,t,i){if(!(i.key==="Enter"||i.key==="Tab"||i.key==="Backspace"||i.key.indexOf("Arrow")>-1||(0,u._0)(i)||i.key==="Escape"||i.shiftKey||i.altKey)){var a=(0,v._Y)(e.startContainer,"P")||(0,v._Y)(e.startContainer,"LI");if(a&&(0,j.ED)(a,t[t.currentMode].element,e).start===0){a.nodeValue&&(a.nodeValue=a.nodeValue.replace(/\u2006/g,""));var o=document.createTextNode(f.Y.ZWSP);e.insertNode(o),e.setStartAfter(o)}}},Hr=function(e,t){if(t==="ArrowDown"||t==="ArrowUp"){var i=(0,v.Th)(e.startContainer,"data-type","math-inline")||(0,v.Th)(e.startContainer,"data-type","html-entity")||(0,v.Th)(e.startContainer,"data-type","html-inline");i&&(t==="ArrowDown"&&e.setStartAfter(i.parentElement),t==="ArrowUp"&&e.setStartBefore(i.parentElement))}},Vn=function(e,t){var i=(0,j.RN)(e),a=(0,v.pt)(i.startContainer);a&&(a.insertAdjacentHTML(t,'<p data-block="0">'.concat(f.Y.ZWSP,`<wbr>
</p>`)),(0,j.ir)(e[e.currentMode].element,i),Lt(e),Ke(e))},Po=function(e){var t=(0,v._Y)(e,"TABLE");return t&&t.rows[0].cells[0].isSameNode(e)?t:!1},Ro=function(e){var t=(0,v._Y)(e,"TABLE");return t&&t.lastElementChild.lastElementChild.lastElementChild.isSameNode(e)?t:!1},Nr=function(e,t,i){i===void 0&&(i=!0);var a=e.previousElementSibling;return a||(e.parentElement.previousElementSibling?a=e.parentElement.previousElementSibling.lastElementChild:e.parentElement.parentElement.tagName==="TBODY"&&e.parentElement.parentElement.previousElementSibling?a=e.parentElement.parentElement.previousElementSibling.lastElementChild.lastElementChild:a=null),a&&(t.selectNodeContents(a),i||t.collapse(!1),(0,j.jl)(t)),a},qn=function(e,t,i,a,o){var l=(0,j.ED)(a,e[e.currentMode].element,i);if(t.key==="ArrowDown"&&a.textContent.trimRight().substr(l.start).indexOf(`
`)===-1||t.key==="ArrowRight"&&l.start>=a.textContent.trimRight().length){var E=o.nextElementSibling;return!E||E&&(E.tagName==="TABLE"||E.getAttribute("data-type"))?(o.insertAdjacentHTML("afterend",'<p data-block="0">'.concat(f.Y.ZWSP,"<wbr></p>")),(0,j.ir)(e[e.currentMode].element,i)):(i.selectNodeContents(E),i.collapse(!0),(0,j.jl)(i)),t.preventDefault(),!0}return!1},Mn=function(e,t,i,a,o){var l=(0,j.ED)(a,e[e.currentMode].element,i);if(t.key==="ArrowUp"&&a.textContent.substr(0,l.start).indexOf(`
`)===-1||(t.key==="ArrowLeft"||t.key==="Backspace"&&i.toString()==="")&&l.start===0){var E=o.previousElementSibling;return!E||E&&(E.tagName==="TABLE"||E.getAttribute("data-type"))?(o.insertAdjacentHTML("beforebegin",'<p data-block="0">'.concat(f.Y.ZWSP,"<wbr></p>")),(0,j.ir)(e[e.currentMode].element,i)):(i.selectNodeContents(E),i.collapse(!1),(0,j.jl)(i)),t.preventDefault(),!0}return!1},li=function(e,t,i,a){a===void 0&&(a=!0);var o=(0,v._Y)(t.startContainer,"LI");if(e[e.currentMode].element.querySelectorAll("wbr").forEach(function(P){P.remove()}),t.insertNode(document.createElement("wbr")),a&&o){for(var l="",E=0;E<o.parentElement.childElementCount;E++){var L=o.parentElement.children[E].querySelector("input");L&&L.remove(),l+='<p data-block="0">'.concat(o.parentElement.children[E].innerHTML.trimLeft(),"</p>")}o.parentElement.insertAdjacentHTML("beforebegin",l),o.parentElement.remove()}else if(o)if(i==="check")o.parentElement.querySelectorAll("li").forEach(function(P){P.insertAdjacentHTML("afterbegin",'<input type="checkbox" />'.concat(P.textContent.indexOf(" ")===0?"":" ")),P.classList.add("vditor-task")});else{o.querySelector("input")&&o.parentElement.querySelectorAll("li").forEach(function(P){P.querySelector("input").remove(),P.classList.remove("vditor-task")});var A=void 0;i==="list"?(A=document.createElement("ul"),A.setAttribute("data-marker","*")):(A=document.createElement("ol"),A.setAttribute("data-marker","1.")),A.setAttribute("data-block","0"),A.setAttribute("data-tight",o.parentElement.getAttribute("data-tight")),A.innerHTML=o.parentElement.innerHTML,o.parentElement.parentNode.replaceChild(A,o.parentElement)}else{var D=(0,v.Th)(t.startContainer,"data-block","0");D||(e[e.currentMode].element.querySelector("wbr").remove(),D=e[e.currentMode].element.querySelector("p"),D.innerHTML="<wbr>"),i==="check"?(D.insertAdjacentHTML("beforebegin",'<ul data-block="0"><li class="vditor-task"><input type="checkbox" /> '.concat(D.innerHTML,"</li></ul>")),D.remove()):i==="list"?(D.insertAdjacentHTML("beforebegin",'<ul data-block="0"><li>'.concat(D.innerHTML,"</li></ul>")),D.remove()):i==="ordered-list"&&(D.insertAdjacentHTML("beforebegin",'<ol data-block="0"><li>'.concat(D.innerHTML,"</li></ol>")),D.remove())}},jr=function(e,t,i){var a=t.previousElementSibling;if(t&&a){var o=[t];Array.from(i.cloneContents().children).forEach(function(D,A){D.nodeType!==3&&t&&D.textContent.trim()!==""&&t.getAttribute("data-node-id")===D.getAttribute("data-node-id")&&(A!==0&&o.push(t),t=t.nextElementSibling)}),e[e.currentMode].element.querySelectorAll("wbr").forEach(function(D){D.remove()}),i.insertNode(document.createElement("wbr"));var l=a.parentElement,E="";o.forEach(function(D){var A=D.getAttribute("data-marker");A.length!==1&&(A="1".concat(A.slice(-1))),E+='<li data-node-id="'.concat(D.getAttribute("data-node-id"),'" data-marker="').concat(A,'">').concat(D.innerHTML,"</li>"),D.remove()}),a.insertAdjacentHTML("beforeend","<".concat(l.tagName,' data-block="0">').concat(E,"</").concat(l.tagName,">")),e.currentMode==="wysiwyg"?l.outerHTML=e.lute.SpinVditorDOM(l.outerHTML):l.outerHTML=e.lute.SpinVditorIRDOM(l.outerHTML),(0,j.ir)(e[e.currentMode].element,i);var L=(0,v.KR)(i.startContainer);L&&L.querySelectorAll(".vditor-".concat(e.currentMode,"__preview[data-render='2']")).forEach(function(D){$e(D,e),e.currentMode==="wysiwyg"&&D.previousElementSibling.setAttribute("style","display:none")}),Ke(e),Lt(e)}else e[e.currentMode].element.focus()},Ki=function(e,t,i,a){var o=(0,v._Y)(t.parentElement,"LI");if(o){e[e.currentMode].element.querySelectorAll("wbr").forEach(function(F){F.remove()}),i.insertNode(document.createElement("wbr"));var l=t.parentElement,E=l.cloneNode(),L=[t];Array.from(i.cloneContents().children).forEach(function(F,le){F.nodeType!==3&&t&&F.textContent.trim()!==""&&t.getAttribute("data-node-id")===F.getAttribute("data-node-id")&&(le!==0&&L.push(t),t=t.nextElementSibling)});var D=!1,A="";l.querySelectorAll("li").forEach(function(F){D&&(A+=F.outerHTML,!F.nextElementSibling&&!F.previousElementSibling?F.parentElement.remove():F.remove()),F.isSameNode(L[L.length-1])&&(D=!0)}),L.reverse().forEach(function(F){o.insertAdjacentElement("afterend",F)}),A&&(E.innerHTML=A,L[0].insertAdjacentElement("beforeend",E)),e.currentMode==="wysiwyg"?a.outerHTML=e.lute.SpinVditorDOM(a.outerHTML):a.outerHTML=e.lute.SpinVditorIRDOM(a.outerHTML),(0,j.ir)(e[e.currentMode].element,i);var P=(0,v.KR)(i.startContainer);P&&P.querySelectorAll(".vditor-".concat(e.currentMode,"__preview[data-render='2']")).forEach(function(F){$e(F,e),e.currentMode==="wysiwyg"&&F.previousElementSibling.setAttribute("style","display:none")}),Ke(e),Lt(e)}else e[e.currentMode].element.focus()},ci=function(e,t){for(var i=getSelection().getRangeAt(0).startContainer.parentElement,a=e.rows[0].cells.length,o=e.rows.length,l=0,E=0;E<o;E++)for(var L=0;L<a;L++)if(e.rows[E].cells[L].isSameNode(i)){l=L;break}for(var D=0;D<o;D++)e.rows[D].cells[l].setAttribute("align",t)},Gi=function(e){var t=e.trimRight().split(`
`).pop();return t===""?!1:(t.replace(/ |-/g,"")===""||t.replace(/ |_/g,"")===""||t.replace(/ |\*/g,"")==="")&&t.replace(/ /g,"").length>2?!(t.indexOf("-")>-1&&t.trimLeft().indexOf(" ")===-1&&e.trimRight().split(`
`).length>1||t.indexOf("    ")===0||t.indexOf("	")===0):!1},Zi=function(e){var t=e.trimRight().split(`
`);return e=t.pop(),e.indexOf("    ")===0||e.indexOf("	")===0||(e=e.trimLeft(),e===""||t.length===0)?!1:e.replace(/-/g,"")===""||e.replace(/=/g,"")===""},Ke=function(e,t){t===void 0&&(t={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),e.currentMode==="wysiwyg"?ye(e,t):e.currentMode==="ir"?nn(e,t):e.currentMode==="sv"&&St(e,t)},Br=function(e,t,i,a){var o,l=e.startContainer,E=(0,v._Y)(l,"LI");if(E){if(!(0,u._0)(a)&&!a.altKey&&a.key==="Enter"&&!a.shiftKey&&i&&E.contains(i)&&i.nextElementSibling)return E&&!E.textContent.endsWith(`
`)&&E.insertAdjacentText("beforeend",`
`),e.insertNode(document.createTextNode(`

`)),e.collapse(!1),Ke(t),a.preventDefault(),!0;if(!(0,u._0)(a)&&!a.shiftKey&&!a.altKey&&a.key==="Backspace"&&!E.previousElementSibling&&e.toString()===""&&(0,j.ED)(E,t[t.currentMode].element,e).start===0)return E.nextElementSibling?(E.parentElement.insertAdjacentHTML("beforebegin",'<p data-block="0"><wbr>'.concat(E.innerHTML,"</p>")),E.remove()):E.parentElement.outerHTML='<p data-block="0"><wbr>'.concat(E.innerHTML,"</p>"),(0,j.ir)(t[t.currentMode].element,e),Ke(t),a.preventDefault(),!0;if(!(0,u._0)(a)&&!a.shiftKey&&!a.altKey&&a.key==="Backspace"&&E.textContent.trim().replace(f.Y.ZWSP,"")===""&&e.toString()===""&&((o=E.previousElementSibling)===null||o===void 0?void 0:o.tagName)==="LI")return E.previousElementSibling.insertAdjacentText("beforeend",`

`),e.selectNodeContents(E.previousElementSibling),e.collapse(!1),E.remove(),(0,j.ir)(t[t.currentMode].element,e),Ke(t),a.preventDefault(),!0;if(!(0,u._0)(a)&&!a.altKey&&a.key==="Tab"){var L=!1;if((e.startOffset===0&&(l.nodeType===3&&!l.previousSibling||l.nodeType!==3&&l.nodeName==="LI")||E.classList.contains("vditor-task")&&e.startOffset===1&&l.previousSibling.nodeType!==3&&l.previousSibling.tagName==="INPUT")&&(L=!0),L||e.toString()!=="")return a.shiftKey?Ki(t,E,e,E.parentElement):jr(t,E,e),a.preventDefault(),!0}}return!1},Xi=function(e,t,i){if(e.options.tab&&i.key==="Tab")return i.shiftKey||(t.toString()===""?(t.insertNode(document.createTextNode(e.options.tab)),t.collapse(!1)):(t.extractContents(),t.insertNode(document.createTextNode(e.options.tab)),t.collapse(!1))),(0,j.jl)(t),Ke(e),i.preventDefault(),!0},zr=function(e,t,i,a){if(i){if(!(0,u._0)(e)&&!e.altKey&&e.key==="Enter"){var o=String.raw(Jr||(Jr=Ao(["",""],["",""])),i.textContent).replace(/\\\|/g,"").trim(),l=o.split("|");if(o.startsWith("|")&&o.endsWith("|")&&l.length>3){var E=l.map(function(){return"---"}).join("|");return E=i.textContent+`
`+E.substring(3,E.length-3)+`
|<wbr>`,i.outerHTML=t.lute.SpinVditorDOM(E),(0,j.ir)(t[t.currentMode].element,a),Ke(t),vt(t),e.preventDefault(),!0}if(Gi(i.innerHTML)&&i.previousElementSibling){var L="",D=i.innerHTML.trimRight().split(`
`);return D.length>1&&(D.pop(),L='<p data-block="0">'.concat(D.join(`
`),"</p>")),i.insertAdjacentHTML("afterend","".concat(L,`<hr data-block="0"><p data-block="0"><wbr>
</p>`)),i.remove(),(0,j.ir)(t[t.currentMode].element,a),Ke(t),vt(t),e.preventDefault(),!0}if(Zi(i.innerHTML))return t.currentMode==="wysiwyg"?i.outerHTML=t.lute.SpinVditorDOM(i.innerHTML+`<p data-block="0"><wbr>
</p>`):i.outerHTML=t.lute.SpinVditorIRDOM(i.innerHTML+`<p data-block="0"><wbr>
</p>`),(0,j.ir)(t[t.currentMode].element,a),Ke(t),vt(t),e.preventDefault(),!0}if(a.collapsed&&i.previousElementSibling&&e.key==="Backspace"&&!(0,u._0)(e)&&!e.altKey&&!e.shiftKey&&i.textContent.trimRight().split(`
`).length>1&&(0,j.ED)(i,t[t.currentMode].element,a).start===0){var A=(0,v.Rp)(i.previousElementSibling);return A.textContent.endsWith(`
`)||(A.textContent=A.textContent+`
`),A.parentElement.insertAdjacentHTML("beforeend","<wbr>".concat(i.innerHTML)),i.remove(),(0,j.ir)(t[t.currentMode].element,a),!1}return!1}},$r=function(e,t,i){for(var a="",o=0;o<i.parentElement.childElementCount;o++)a+='<td align="'.concat(i.parentElement.children[o].getAttribute("align"),'"> </td>');i.tagName==="TH"?i.parentElement.parentElement.insertAdjacentHTML("afterend","<tbody><tr>".concat(a,"</tr></tbody>")):i.parentElement.insertAdjacentHTML("afterend","<tr>".concat(a,"</tr>")),Ke(e)},Fr=function(e,t,i){for(var a="",o=0;o<i.parentElement.childElementCount;o++)i.tagName==="TH"?a+='<th align="'.concat(i.parentElement.children[o].getAttribute("align"),'"> </th>'):a+='<td align="'.concat(i.parentElement.children[o].getAttribute("align"),'"> </td>');if(i.tagName==="TH"){i.parentElement.parentElement.insertAdjacentHTML("beforebegin","<thead><tr>".concat(a,"</tr></thead>")),t.insertNode(document.createElement("wbr"));var l=i.parentElement.innerHTML.replace(/<th>/g,"<td>").replace(/<\/th>/g,"</td>");i.parentElement.parentElement.nextElementSibling.insertAdjacentHTML("afterbegin",l),i.parentElement.parentElement.remove(),(0,j.ir)(e.ir.element,t)}else i.parentElement.insertAdjacentHTML("beforebegin","<tr>".concat(a,"</tr>"));Ke(e)},ui=function(e,t,i,a){a===void 0&&(a="afterend");for(var o=0,l=i.previousElementSibling;l;)o++,l=l.previousElementSibling;for(var E=0;E<t.rows.length;E++)E===0?t.rows[E].cells[o].insertAdjacentHTML(a,"<th> </th>"):t.rows[E].cells[o].insertAdjacentHTML(a,"<td> </td>");Ke(e)},Ur=function(e,t,i){if(i.tagName==="TD"){var a=i.parentElement.parentElement;i.parentElement.previousElementSibling?t.selectNodeContents(i.parentElement.previousElementSibling.lastElementChild):t.selectNodeContents(a.previousElementSibling.lastElementChild.lastElementChild),a.childElementCount===1?a.remove():i.parentElement.remove(),t.collapse(!1),(0,j.jl)(t),Ke(e)}},Vr=function(e,t,i,a){for(var o=0,l=a.previousElementSibling;l;)o++,l=l.previousElementSibling;(a.previousElementSibling||a.nextElementSibling)&&(t.selectNodeContents(a.previousElementSibling||a.nextElementSibling),t.collapse(!0));for(var E=0;E<i.rows.length;E++){var L=i.rows[E].cells;if(L.length===1){i.remove(),Lt(e);break}L[o].remove()}(0,j.jl)(t),Ke(e)},qr=function(e,t,i){var a=i.startContainer,o=(0,v._Y)(a,"TD")||(0,v._Y)(a,"TH");if(o){if(!(0,u._0)(t)&&!t.altKey&&t.key==="Enter"){(!o.lastElementChild||o.lastElementChild&&(!o.lastElementChild.isSameNode(o.lastChild)||o.lastElementChild.tagName!=="BR"))&&o.insertAdjacentHTML("beforeend","<br>");var l=document.createElement("br");return i.insertNode(l),i.setStartAfter(l),Ke(e),vt(e),t.preventDefault(),!0}if(t.key==="Tab"){if(t.shiftKey)return Nr(o,i),t.preventDefault(),!0;var E=o.nextElementSibling;return E||(o.parentElement.nextElementSibling?E=o.parentElement.nextElementSibling.firstElementChild:o.parentElement.parentElement.tagName==="THEAD"&&o.parentElement.parentElement.nextElementSibling?E=o.parentElement.parentElement.nextElementSibling.firstElementChild.firstElementChild:E=null),E&&(i.selectNodeContents(E),(0,j.jl)(i)),t.preventDefault(),!0}var L=o.parentElement.parentElement.parentElement;if(t.key==="ArrowUp"){if(t.preventDefault(),o.tagName==="TH")return L.previousElementSibling?(i.selectNodeContents(L.previousElementSibling),i.collapse(!1),(0,j.jl)(i)):Vn(e,"beforebegin"),!0;for(var D=0,A=o.parentElement;D<A.cells.length&&!A.cells[D].isSameNode(o);D++);var P=A.previousElementSibling;return P||(P=A.parentElement.previousElementSibling.firstChild),i.selectNodeContents(P.cells[D]),i.collapse(!1),(0,j.jl)(i),!0}if(t.key==="ArrowDown"){t.preventDefault();var A=o.parentElement;if(!A.nextElementSibling&&o.tagName==="TD")return L.nextElementSibling?(i.selectNodeContents(L.nextElementSibling),i.collapse(!0),(0,j.jl)(i)):Vn(e,"afterend"),!0;for(var D=0;D<A.cells.length&&!A.cells[D].isSameNode(o);D++);var E=A.nextElementSibling;return E||(E=A.parentElement.nextElementSibling.firstChild),i.selectNodeContents(E.cells[D]),i.collapse(!0),(0,j.jl)(i),!0}if(e.currentMode==="wysiwyg"&&!(0,u._0)(t)&&t.key==="Enter"&&!t.shiftKey&&t.altKey){var F=e.wysiwyg.popover.querySelector(".vditor-input");return F.focus(),F.select(),t.preventDefault(),!0}if(!(0,u._0)(t)&&!t.shiftKey&&!t.altKey&&t.key==="Backspace"&&i.startOffset===0&&i.toString()===""){var le=Nr(o,i,!1);return!le&&L&&(L.textContent.trim()===""?(L.outerHTML=`<p data-block="0"><wbr>
</p>`,(0,j.ir)(e[e.currentMode].element,i)):(i.setStartBefore(L),i.collapse(!0)),Ke(e)),t.preventDefault(),!0}if(B("⇧⌘F",t))return Fr(e,i,o),t.preventDefault(),!0;if(B("⌘=",t))return $r(e,i,o),t.preventDefault(),!0;if(B("⇧⌘G",t))return ui(e,L,o,"beforebegin"),t.preventDefault(),!0;if(B("⇧⌘=",t))return ui(e,L,o),t.preventDefault(),!0;if(B("⌘-",t))return Ur(e,i,o),t.preventDefault(),!0;if(B("⇧⌘-",t))return Vr(e,i,L,o),t.preventDefault(),!0;if(B("⇧⌘L",t)){if(e.currentMode==="ir")return ci(L,"left"),Ke(e),t.preventDefault(),!0;var oe=e.wysiwyg.popover.querySelector('[data-type="left"]');if(oe)return oe.click(),t.preventDefault(),!0}if(B("⇧⌘C",t)){if(e.currentMode==="ir")return ci(L,"center"),Ke(e),t.preventDefault(),!0;var oe=e.wysiwyg.popover.querySelector('[data-type="center"]');if(oe)return oe.click(),t.preventDefault(),!0}if(B("⇧⌘R",t)){if(e.currentMode==="ir")return ci(L,"right"),Ke(e),t.preventDefault(),!0;var oe=e.wysiwyg.popover.querySelector('[data-type="right"]');if(oe)return oe.click(),t.preventDefault(),!0}}return!1},Wr=function(e,t,i,a){if(i.tagName==="PRE"&&B("⌘A",t))return a.selectNodeContents(i.firstElementChild),t.preventDefault(),!0;if(e.options.tab&&t.key==="Tab"&&!t.shiftKey&&a.toString()==="")return a.insertNode(document.createTextNode(e.options.tab)),a.collapse(!1),Ke(e),t.preventDefault(),!0;if(t.key==="Backspace"&&!(0,u._0)(t)&&!t.shiftKey&&!t.altKey){var o=(0,j.ED)(i,e[e.currentMode].element,a);if((o.start===0||o.start===1&&i.innerText===`
`)&&a.toString()==="")return i.parentElement.outerHTML='<p data-block="0"><wbr>'.concat(i.firstElementChild.innerHTML,"</p>"),(0,j.ir)(e[e.currentMode].element,a),Ke(e),t.preventDefault(),!0}return!(0,u._0)(t)&&!t.altKey&&t.key==="Enter"?(i.firstElementChild.textContent.endsWith(`
`)||i.firstElementChild.insertAdjacentText("beforeend",`
`),a.extractContents(),a.insertNode(document.createTextNode(`
`)),a.collapse(!1),(0,j.jl)(a),(0,u.gm)()||(e.currentMode==="wysiwyg"?si(e,a):Z(e,a)),vt(e),t.preventDefault(),!0):!1},Yr=function(e,t,i,a){var o=t.startContainer,l=(0,v._Y)(o,"BLOCKQUOTE");if(l&&t.toString()===""){if(i.key==="Backspace"&&!(0,u._0)(i)&&!i.shiftKey&&!i.altKey&&(0,j.ED)(l,e[e.currentMode].element,t).start===0)return t.insertNode(document.createElement("wbr")),l.outerHTML=l.innerHTML,(0,j.ir)(e[e.currentMode].element,t),Ke(e),i.preventDefault(),!0;if(a&&i.key==="Enter"&&!(0,u._0)(i)&&!i.shiftKey&&!i.altKey&&a.parentElement.tagName==="BLOCKQUOTE"){var E=!1;if(a.innerHTML.replace(f.Y.ZWSP,"")===`
`||a.innerHTML.replace(f.Y.ZWSP,"")===""?(E=!0,a.remove()):a.innerHTML.endsWith(`

`)&&(0,j.ED)(a,e[e.currentMode].element,t).start===a.textContent.length-1&&(a.innerHTML=a.innerHTML.substr(0,a.innerHTML.length-2),E=!0),E)return l.insertAdjacentHTML("afterend",'<p data-block="0">'.concat(f.Y.ZWSP,`<wbr>
</p>`)),(0,j.ir)(e[e.currentMode].element,t),Ke(e),i.preventDefault(),!0}var L=(0,v.pt)(o);if(e.currentMode==="wysiwyg"&&L&&B("⇧⌘;",i))return t.insertNode(document.createElement("wbr")),L.outerHTML='<blockquote data-block="0">'.concat(L.outerHTML,"</blockquote>"),(0,j.ir)(e.wysiwyg.element,t),ye(e),i.preventDefault(),!0;if(qn(e,i,t,l,l)||Mn(e,i,t,l,l))return!0}return!1},Kr=function(e,t,i){var a=t.startContainer,o=(0,v._Y)(a,"li");if(o&&o.classList.contains("vditor-task")){if(B("⇧⌘J",i)){var l=o.firstElementChild;return l.checked?l.removeAttribute("checked"):l.setAttribute("checked","checked"),Ke(e),i.preventDefault(),!0}if(i.key==="Backspace"&&!(0,u._0)(i)&&!i.shiftKey&&!i.altKey&&t.toString()===""&&t.startOffset===1&&(a.nodeType===3&&a.previousSibling&&a.previousSibling.tagName==="INPUT"||a.nodeType!==3)){var E=o.previousElementSibling;if(o.querySelector("input").remove(),E){var L=(0,v.Rp)(E);L.parentElement.insertAdjacentHTML("beforeend","<wbr>"+o.innerHTML.trim()),o.remove()}else o.parentElement.insertAdjacentHTML("beforebegin",'<p data-block="0"><wbr>'.concat(o.innerHTML.trim()||`
`,"</p>")),o.nextElementSibling?o.remove():o.parentElement.remove();return(0,j.ir)(e[e.currentMode].element,t),Ke(e),i.preventDefault(),!0}if(i.key==="Enter"&&!(0,u._0)(i)&&!i.shiftKey&&!i.altKey){if(o.textContent.trim()==="")if((0,v.KJ)(o.parentElement,"vditor-task")){var D=(0,v.KR)(a);D&&Ki(e,o,t,D)}else if(o.nextElementSibling){var A="",P="",F=!1;Array.from(o.parentElement.children).forEach(function(Ce){o.isSameNode(Ce)?F=!0:F?A+=Ce.outerHTML:P+=Ce.outerHTML});var le=o.parentElement.tagName,oe=o.parentElement.tagName==="OL"?"":' data-marker="'.concat(o.parentElement.getAttribute("data-marker"),'"'),te="";P&&(te=o.parentElement.tagName==="UL"?"":' start="1"',P="<".concat(le,' data-tight="true"').concat(oe,' data-block="0">').concat(P,"</").concat(le,">")),o.parentElement.outerHTML="".concat(P,`<p data-block="0"><wbr>
</p><`).concat(le,`
 data-tight="true"`).concat(oe,' data-block="0"').concat(te,">").concat(A,"</").concat(le,">")}else o.parentElement.insertAdjacentHTML("afterend",`<p data-block="0"><wbr>
</p>`),o.parentElement.querySelectorAll("li").length===1?o.parentElement.remove():o.remove();else a.nodeType!==3&&t.startOffset===0&&a.firstChild.tagName==="INPUT"?t.setStart(a.childNodes[1],1):(t.setEndAfter(o.lastChild),o.insertAdjacentHTML("afterend",'<li class="vditor-task" data-marker="'.concat(o.getAttribute("data-marker"),'"><input type="checkbox"> <wbr></li>')),document.querySelector("wbr").after(t.extractContents()));return(0,j.ir)(e[e.currentMode].element,t),Ke(e),vt(e),i.preventDefault(),!0}}return!1},Gr=function(e,t,i,a){if(t.startContainer.nodeType!==3){var o=t.startContainer.children[t.startOffset];if(o&&o.tagName==="HR")return t.selectNodeContents(o.previousElementSibling),t.collapse(!1),i.preventDefault(),!0}if(a){var l=a.previousElementSibling;if(l&&(0,j.ED)(a,e[e.currentMode].element,t).start===0&&((0,u.gm)()&&l.tagName==="HR"||l.tagName==="TABLE")){if(l.tagName==="TABLE"){var E=l.lastElementChild.lastElementChild.lastElementChild;E.innerHTML=E.innerHTML.trimLeft()+"<wbr>"+a.textContent.trim(),a.remove()}else l.remove();return(0,j.ir)(e[e.currentMode].element,t),Ke(e),i.preventDefault(),!0}}return!1},Zr=function(e){(0,u.gm)()&&e.startContainer.nodeType!==3&&e.startContainer.tagName==="HR"&&e.setStartBefore(e.startContainer)},Xr=function(e,t,i){var a,o;if(!(0,u.gm)())return!1;if(e.key==="ArrowUp"&&t&&((a=t.previousElementSibling)===null||a===void 0?void 0:a.tagName)==="TABLE"){var l=t.previousElementSibling;return i.selectNodeContents(l.rows[l.rows.length-1].lastElementChild),i.collapse(!1),e.preventDefault(),!0}return e.key==="ArrowDown"&&t&&((o=t.nextElementSibling)===null||o===void 0?void 0:o.tagName)==="TABLE"?(i.selectNodeContents(t.nextElementSibling.rows[0].cells[0]),i.collapse(!0),e.preventDefault(),!0):!1},di=function(e,t,i){return Do(void 0,void 0,void 0,function(){var a,o,l,E,L,D,A,P,F,le,oe,te,Ce,Q,he,Q,Ie;return Oo(this,function(we){switch(we.label){case 0:return e[e.currentMode].element.getAttribute("contenteditable")!=="true"?[2]:(t.stopPropagation(),t.preventDefault(),"clipboardData"in t?(a=t.clipboardData.getData("text/html"),o=t.clipboardData.getData("text/plain"),l=t.clipboardData.files):(a=t.dataTransfer.getData("text/html"),o=t.dataTransfer.getData("text/plain"),t.dataTransfer.types.includes("Files")&&(l=t.dataTransfer.items)),E={},L=function(je,ot){if(!ot)return["",Lute.WalkContinue];if(e.options.upload.renderLinkDest)return e.options.upload.renderLinkDest(e,je,ot);var it=je.TokensStr();if(je.__internal_object__.Parent.Type===34&&it&&it.indexOf("file://")===-1&&e.options.upload.linkToImgUrl){var st=new XMLHttpRequest;st.open("POST",e.options.upload.linkToImgUrl),e.options.upload.token&&st.setRequestHeader("X-Upload-Token",e.options.upload.token),e.options.upload.withCredentials&&(st.withCredentials=!0),Pr(e,st),st.setRequestHeader("Content-Type","application/json; charset=utf-8"),st.onreadystatechange=function(){if(st.readyState===XMLHttpRequest.DONE){if(st.status===200){var Pt=st.responseText;e.options.upload.linkToImgFormat&&(Pt=e.options.upload.linkToImgFormat(st.responseText));var _t=JSON.parse(Pt);if(_t.code!==0){e.tip.show(_t.msg);return}var Rt=_t.data.originalURL;if(e.currentMode==="sv")e.sv.element.querySelectorAll(".vditor-sv__marker--link").forEach(function(yt){yt.textContent===Rt&&(yt.textContent=_t.data.url)});else{var We=e[e.currentMode].element.querySelector('img[src="'.concat(Rt,'"]'));We.src=_t.data.url,e.currentMode==="ir"&&(We.previousElementSibling.previousElementSibling.innerHTML=_t.data.url)}Ke(e)}else e.tip.show(st.responseText);e.options.upload.linkToImgCallback&&e.options.upload.linkToImgCallback(st.responseText)}},st.send(JSON.stringify({url:it}))}return e.currentMode==="ir"?['<span class="vditor-ir__marker vditor-ir__marker--link">'.concat(Lute.EscapeHTMLStr(it),"</span>"),Lute.WalkContinue]:e.currentMode==="wysiwyg"?["",Lute.WalkContinue]:['<span class="vditor-sv__marker--link">'.concat(Lute.EscapeHTMLStr(it),"</span>"),Lute.WalkContinue]},(a.replace(/&amp;/g,"&").replace(/<(|\/)(html|body|meta)[^>]*?>/ig,"").trim()==='<a href="'.concat(o,'">').concat(o,"</a>")||a.replace(/&amp;/g,"&").replace(/<(|\/)(html|body|meta)[^>]*?>/ig,"").trim()==='<!--StartFragment--><a href="'.concat(o,'">').concat(o,"</a><!--EndFragment-->"))&&(a=""),D=new DOMParser().parseFromString(a,"text/html"),D.body&&(a=D.body.innerHTML),a=Lute.Sanitize(a),e.wysiwyg.getComments(e),A=e[e.currentMode].element.scrollHeight,P=Oe(a,o,e.currentMode),F=e.currentMode==="sv"?(0,v.Th)(t.target,"data-type","code-block"):(0,v._Y)(t.target,"CODE"),F?(e.currentMode==="sv"?document.execCommand("insertHTML",!1,o.replace(/&/g,"&amp;").replace(/</g,"&lt;")):(le=(0,j.ED)(t.target,e[e.currentMode].element),F.parentElement.tagName!=="PRE"&&(o+=f.Y.ZWSP),F.textContent=F.textContent.substring(0,le.start)+o+F.textContent.substring(le.end),(0,j.Fm)(le.start+o.length,le.start+o.length,F.parentElement),!((Ie=F.parentElement)===null||Ie===void 0)&&Ie.nextElementSibling.classList.contains("vditor-".concat(e.currentMode,"__preview"))&&(F.parentElement.nextElementSibling.innerHTML=F.outerHTML,$e(F.parentElement.nextElementSibling,e))),[3,8]):[3,1]);case 1:return P?(i.pasteCode(P),[3,8]):[3,2];case 2:return a.trim()===""?[3,3]:(oe=document.createElement("div"),oe.innerHTML=a,oe.querySelectorAll("[style]").forEach(function(je){je.removeAttribute("style")}),oe.querySelectorAll(".vditor-copy").forEach(function(je){je.remove()}),e.currentMode==="ir"?(E.HTML2VditorIRDOM={renderLinkDest:L},e.lute.SetJSRenderers({renderers:E}),(0,j.Z2)(e.lute.HTML2VditorIRDOM(oe.innerHTML),e)):e.currentMode==="wysiwyg"?(E.HTML2VditorDOM={renderLinkDest:L},e.lute.SetJSRenderers({renderers:E}),(0,j.Z2)(e.lute.HTML2VditorDOM(oe.innerHTML),e)):(E.Md2VditorSVDOM={renderLinkDest:L},e.lute.SetJSRenderers({renderers:E}),Wi(e,e.lute.HTML2Md(oe.innerHTML).trimRight())),e.outline.render(e),[3,8]);case 3:return l.length>0?e.options.upload.url||e.options.upload.handler?[4,Yi(e,l)]:[3,5]:[3,7];case 4:return we.sent(),[3,6];case 5:te=new FileReader,"clipboardData"in t?(l=t.clipboardData.files,Ce=l[0]):t.dataTransfer.types.includes("Files")&&(l=t.dataTransfer.items,Ce=l[0].getAsFile()),Ce&&Ce.type.startsWith("image")&&(te.readAsDataURL(Ce),te.onload=function(){var je="";e.currentMode==="wysiwyg"?je+='<img alt="'.concat(Ce.name,'" src="').concat(te.result.toString(),`">
`):je+="![".concat(Ce.name,"](").concat(te.result.toString(),`)
`),document.execCommand("insertHTML",!1,je)}),we.label=6;case 6:return[3,8];case 7:o.trim()!==""&&l.length===0&&(Q=(0,j.RN)(e),Q.toString()!==""&&e.lute.IsValidLinkDest(o)&&(o="[".concat(Q.toString(),"](").concat(o,")")),e.currentMode==="ir"?(E.Md2VditorIRDOM={renderLinkDest:L},e.lute.SetJSRenderers({renderers:E}),(0,j.Z2)(e.lute.Md2VditorIRDOM(o),e)):e.currentMode==="wysiwyg"?(E.Md2VditorDOM={renderLinkDest:L},e.lute.SetJSRenderers({renderers:E}),(0,j.Z2)(e.lute.Md2VditorDOM(o),e)):(E.Md2VditorSVDOM={renderLinkDest:L},e.lute.SetJSRenderers({renderers:E}),Wi(e,o)),e.outline.render(e)),we.label=8;case 8:return e.currentMode!=="sv"&&(he=(0,v.pt)((0,j.RN)(e).startContainer),he&&(Q=(0,j.RN)(e),e[e.currentMode].element.querySelectorAll("wbr").forEach(function(je){je.remove()}),Q.insertNode(document.createElement("wbr")),e.currentMode==="wysiwyg"?he.outerHTML=e.lute.SpinVditorDOM(he.outerHTML):he.outerHTML=e.lute.SpinVditorIRDOM(he.outerHTML),(0,j.ir)(e[e.currentMode].element,Q)),e[e.currentMode].element.querySelectorAll(".vditor-".concat(e.currentMode,"__preview[data-render='2']")).forEach(function(je){$e(je,e)})),e.wysiwyg.triggerRemoveComment(e),Ke(e),e[e.currentMode].element.scrollHeight-A>Math.min(e[e.currentMode].element.clientHeight,window.innerHeight)/2&&vt(e),[2]}})})},Jr,Qr=function(e){var t,i;e.hint.render(e);var a=(0,j.RN)(e).startContainer,o=(0,v.Th)(a,"data-type","code-block-info");if(o)if(o.textContent.replace(f.Y.ZWSP,"")===""&&e.hint.recentLanguage){o.textContent=f.Y.ZWSP+e.hint.recentLanguage;var l=(0,j.RN)(e);l.selectNodeContents(o)}else{var E=[],L=o.textContent.substring(0,(0,j.ED)(o,e.ir.element).start).replace(f.Y.ZWSP,"");(e.options.preview.hljs.langs||f.Y.ALIAS_CODE_LANGUAGES.concat(((i=(t=window.hljs)===null||t===void 0?void 0:t.listLanguages())!==null&&i!==void 0?i:[]).sort())).forEach(function(D){D.indexOf(L.toLowerCase())>-1&&E.push({html:D,value:D})}),e.hint.genHTML(E,L,e)}},nn=function(e,t){t===void 0&&(t={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),t.enableHint&&Qr(e),clearTimeout(e.ir.processTimeoutId),e.ir.processTimeoutId=window.setTimeout(function(){if(!e.ir.composingLock){var i=T(e);typeof e.options.input=="function"&&t.enableInput&&e.options.input(i),e.options.counter.enable&&e.counter.render(e,i),e.options.cache.enable&&(0,u.D)()&&(localStorage.setItem(e.options.cache.id,i),e.options.cache.after&&e.options.cache.after(i)),e.devtools&&e.devtools.renderEchart(e),t.enableAddUndoStack&&e.undo.addToUndoStack(e)}},e.options.undoDelay)},Wn=function(e,t){var i=(0,j.RN)(e),a=(0,v.pt)(i.startContainer)||i.startContainer;if(a){var o=a.querySelector(".vditor-ir__marker--heading");o?o.innerHTML=t:(a.insertAdjacentText("afterbegin",t),i.selectNodeContents(a),i.collapse(!1)),Z(e,i.cloneRange()),Le(e)}},fi=function(e,t,i){var a=(0,v.Th)(e.startContainer,"data-type",i);if(a){a.firstElementChild.remove(),a.lastElementChild.remove(),e.insertNode(document.createElement("wbr"));var o=document.createElement("div");o.innerHTML=t.lute.SpinVditorIRDOM(a.outerHTML),a.outerHTML=o.firstElementChild.innerHTML.trim()}},Io=function(e,t,i,a){var o=(0,j.RN)(e),l=t.getAttribute("data-type"),E=o.startContainer;E.nodeType===3&&(E=E.parentElement);var L=!0;if(t.classList.contains("vditor-menu--current"))if(l==="quote"){var D=(0,v._Y)(E,"BLOCKQUOTE");D&&(o.insertNode(document.createElement("wbr")),D.outerHTML=D.innerHTML.trim()===""?'<p data-block="0">'.concat(D.innerHTML,"</p>"):D.innerHTML)}else if(l==="link"){var A=(0,v.Th)(o.startContainer,"data-type","a");if(A){var P=(0,v.KJ)(o.startContainer,"vditor-ir__link");P?(o.insertNode(document.createElement("wbr")),A.outerHTML=P.innerHTML):A.outerHTML=A.querySelector(".vditor-ir__link").innerHTML+"<wbr>"}}else l==="italic"?fi(o,e,"em"):l==="bold"?fi(o,e,"strong"):l==="strike"?fi(o,e,"s"):l==="inline-code"?fi(o,e,"code"):(l==="check"||l==="list"||l==="ordered-list")&&(li(e,o,l),L=!1,t.classList.remove("vditor-menu--current"));else{e.ir.element.childNodes.length===0&&(e.ir.element.innerHTML='<p data-block="0"><wbr></p>',(0,j.ir)(e.ir.element,o));var F=(0,v.pt)(o.startContainer);if(l==="line"){if(F){var le=`<hr data-block="0"><p data-block="0"><wbr>
</p>`;F.innerHTML.trim()===""?F.outerHTML=le:F.insertAdjacentHTML("afterend",le)}}else if(l==="quote")F&&(o.insertNode(document.createElement("wbr")),F.outerHTML='<blockquote data-block="0">'.concat(F.outerHTML,"</blockquote>"),L=!1,t.classList.add("vditor-menu--current"));else if(l==="link"){var oe=void 0;o.toString()===""?oe="".concat(i,"<wbr>").concat(a):oe="".concat(i).concat(o.toString()).concat(a.replace(")","<wbr>)")),document.execCommand("insertHTML",!1,oe),L=!1,t.classList.add("vditor-menu--current")}else if(l==="italic"||l==="bold"||l==="strike"||l==="inline-code"||l==="code"||l==="table"){var oe=void 0;o.toString()===""?oe="".concat(i,"<wbr>").concat(a):(l==="code"?oe="".concat(i,`
`).concat(o.toString(),"<wbr>").concat(a):l==="table"?oe="".concat(i).concat(o.toString(),"<wbr>").concat(a):oe="".concat(i).concat(o.toString()).concat(a,"<wbr>"),o.deleteContents()),(l==="table"||l==="code")&&(oe=`
`+oe+`

`);var te=document.createElement("span");te.innerHTML=oe,o.insertNode(te),Z(e,o),l==="table"&&(o.selectNodeContents(getSelection().getRangeAt(0).startContainer.parentElement),(0,j.jl)(o))}else(l==="check"||l==="list"||l==="ordered-list")&&(li(e,o,l,!1),L=!1,m(e.toolbar.elements,["check","list","ordered-list"]),t.classList.add("vditor-menu--current"))}(0,j.ir)(e.ir.element,o),nn(e),L&&Le(e)},Ho=function(e,t,i,a){function o(l){return l instanceof i?l:new i(function(E){E(l)})}return new(i||(i=Promise))(function(l,E){function L(P){try{A(a.next(P))}catch(F){E(F)}}function D(P){try{A(a.throw(P))}catch(F){E(F)}}function A(P){P.done?l(P.value):o(P.value).then(L,D)}A((a=a.apply(e,t||[])).next())})},No=function(e,t){var i={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,o,l,E;return E={next:L(0),throw:L(1),return:L(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function L(A){return function(P){return D([A,P])}}function D(A){if(a)throw new TypeError("Generator is already executing.");for(;E&&(E=0,A[0]&&(i=0)),i;)try{if(a=1,o&&(l=A[0]&2?o.return:A[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,A[1])).done)return l;switch(o=0,l&&(A=[A[0]&2,l.value]),A[0]){case 0:case 1:l=A;break;case 4:return i.label++,{value:A[1],done:!1};case 5:i.label++,o=A[1],A=[0];continue;case 7:A=i.ops.pop(),i.trys.pop();continue;default:if(l=i.trys,!(l=l.length>0&&l[l.length-1])&&(A[0]===6||A[0]===2)){i=0;continue}if(A[0]===3&&(!l||A[1]>l[0]&&A[1]<l[3])){i.label=A[1];break}if(A[0]===6&&i.label<l[1]){i.label=l[1],l=A;break}if(l&&i.label<l[2]){i.label=l[2],i.ops.push(A);break}l[2]&&i.ops.pop(),i.trys.pop();continue}A=t.call(e,i)}catch(P){A=[6,P],o=0}finally{a=l=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}},jo=function(){function e(t){var i=this;this.splitChar="",this.lastIndex=-1,this.fillEmoji=function(a,o){i.element.style.display="none";var l=decodeURIComponent(a.getAttribute("data-value")),E=window.getSelection().getRangeAt(0);if(o.currentMode==="ir"){var L=(0,v.Th)(E.startContainer,"data-type","code-block-info");if(L){L.textContent=f.Y.ZWSP+l.trimRight(),E.selectNodeContents(L),E.collapse(!1),nn(o),L.parentElement.querySelectorAll("code").forEach(function(F){F.className="language-"+l.trimRight()}),$e(L.parentElement.querySelector(".vditor-ir__preview"),o),i.recentLanguage=l.trimRight();return}}if(o.currentMode==="wysiwyg"&&E.startContainer.nodeType!==3){var D=E.startContainer,A=void 0;if(D.classList.contains("vditor-input")?A=D:A=D.firstElementChild,A&&A.classList.contains("vditor-input")){A.value=l.trimRight(),E.selectNodeContents(A),E.collapse(!1),A.dispatchEvent(new CustomEvent("input",{detail:1})),i.recentLanguage=l.trimRight();return}}if(E.setStart(E.startContainer,i.lastIndex),E.deleteContents(),o.options.hint.parse?o.currentMode==="sv"?(0,j.Z2)(o.lute.SpinVditorSVDOM(l),o):o.currentMode==="wysiwyg"?(0,j.Z2)(o.lute.SpinVditorDOM(l),o):(0,j.Z2)(o.lute.SpinVditorIRDOM(l),o):(0,j.Z2)(l,o),i.splitChar===":"&&l.indexOf(":")>-1&&o.currentMode!=="sv"&&E.insertNode(document.createTextNode(" ")),E.collapse(!1),(0,j.jl)(E),o.currentMode==="wysiwyg"){var P=(0,v.KJ)(E.startContainer,"vditor-wysiwyg__block");P&&P.lastElementChild.classList.contains("vditor-wysiwyg__preview")&&(P.lastElementChild.innerHTML=P.firstElementChild.innerHTML,$e(P.lastElementChild,o))}else if(o.currentMode==="ir"){var P=(0,v.KJ)(E.startContainer,"vditor-ir__marker--pre");P&&P.nextElementSibling.classList.contains("vditor-ir__preview")&&(P.nextElementSibling.innerHTML=P.innerHTML,$e(P.nextElementSibling,o))}Ke(o)},this.timeId=-1,this.element=document.createElement("div"),this.element.className="vditor-hint",this.recentLanguage="",t.push({key:":"})}return e.prototype.render=function(t){var i=this;if(window.getSelection().focusNode){var a,o=getSelection().getRangeAt(0);a=o.startContainer.textContent.substring(0,o.startOffset)||"";var l=this.getKey(a,t.options.hint.extend);if(typeof l>"u")this.element.style.display="none",clearTimeout(this.timeId);else if(this.splitChar===":"){var E=l===""?t.options.hint.emoji:t.lute.GetEmojis(),L=[];Object.keys(E).forEach(function(D){D.indexOf(l.toLowerCase())===0&&(E[D].indexOf(".")>-1?L.push({html:'<img src="'.concat(E[D],'" title=":').concat(D,':"/> :').concat(D,":"),value:":".concat(D,":")}):L.push({html:'<span class="vditor-hint__emoji">'.concat(E[D],"</span>").concat(D),value:E[D]}))}),this.genHTML(L,l,t)}else t.options.hint.extend.forEach(function(D){D.key===i.splitChar&&(clearTimeout(i.timeId),i.timeId=window.setTimeout(function(){return Ho(i,void 0,void 0,function(){var A;return No(this,function(P){switch(P.label){case 0:return A=this.genHTML,[4,D.hint(l)];case 1:return A.apply(this,[P.sent(),l,t]),[2]}})})},t.options.hint.delay))})}},e.prototype.genHTML=function(t,i,a){var o=this;if(t.length===0){this.element.style.display="none";return}var l=a[a.currentMode].element,E=(0,j.Ey)(l),L=E.left+(a.options.outline.position==="left"?a.outline.element.offsetWidth:0),D=E.top,A="";t.forEach(function(F,le){if(!(le>7)){var oe=F.html;if(i!==""){var te=oe.lastIndexOf(">")+1,Ce=oe.substr(te),he=Ce.toLowerCase().indexOf(i.toLowerCase());he>-1&&(Ce=Ce.substring(0,he)+"<b>"+Ce.substring(he,he+i.length)+"</b>"+Ce.substring(he+i.length),oe=oe.substr(0,te)+Ce)}A+='<button type="button" data-value="'.concat(encodeURIComponent(F.value),` "
`).concat(le===0?"class='vditor-hint--current'":"","> ").concat(oe,"</button>")}}),this.element.innerHTML=A;var P=parseInt(document.defaultView.getComputedStyle(l,null).getPropertyValue("line-height"),10);this.element.style.top="".concat(D+(P||22),"px"),this.element.style.left="".concat(L,"px"),this.element.style.display="block",this.element.style.right="auto",this.element.querySelectorAll("button").forEach(function(F){F.addEventListener("click",function(le){o.fillEmoji(F,a),le.preventDefault()})}),this.element.getBoundingClientRect().bottom>window.innerHeight&&(this.element.style.top="".concat(D-this.element.offsetHeight,"px")),this.element.getBoundingClientRect().right>window.innerWidth&&(this.element.style.left="auto",this.element.style.right="0")},e.prototype.select=function(t,i){if(this.element.querySelectorAll("button").length===0||this.element.style.display==="none")return!1;var a=this.element.querySelector(".vditor-hint--current");if(t.key==="ArrowDown")return t.preventDefault(),t.stopPropagation(),a.removeAttribute("class"),a.nextElementSibling?a.nextElementSibling.className="vditor-hint--current":this.element.children[0].className="vditor-hint--current",!0;if(t.key==="ArrowUp"){if(t.preventDefault(),t.stopPropagation(),a.removeAttribute("class"),a.previousElementSibling)a.previousElementSibling.className="vditor-hint--current";else{var o=this.element.children.length;this.element.children[o-1].className="vditor-hint--current"}return!0}else if(!(0,u._0)(t)&&!t.shiftKey&&!t.altKey&&t.key==="Enter"&&!t.isComposing)return t.preventDefault(),t.stopPropagation(),this.fillEmoji(a,i),!0;return!1},e.prototype.getKey=function(t,i){var a=this;this.lastIndex=-1,this.splitChar="",i.forEach(function(A){var P=t.lastIndexOf(A.key);a.lastIndex<P&&(a.splitChar=A.key,a.lastIndex=P)});var o;if(this.lastIndex===-1)return o;var l=t.split(this.splitChar),E=l[l.length-1],L=32;if(l.length>1&&E.trim()===E)if(l.length===2&&l[0]===""&&l[1].length<L)o=l[1];else{var D=l[l.length-2].slice(-1);(0,y.p)(D)===" "&&E.length<L&&(o=E)}return o},e}(),Bo=function(){function e(t){this.composingLock=!1;var i=document.createElement("div");i.className="vditor-ir",i.innerHTML='<pre class="vditor-reset" placeholder="'.concat(t.options.placeholder,`"
 contenteditable="true" spellcheck="false"></pre>`),this.element=i.firstElementChild,this.bindEvent(t),Bi(t,this.element),Lr(t,this.element),zi(t,this.element),Vi(t,this.element),qi(t,this.element),$i(t,this.element),Fi(t,this.element,this.copy),Ui(t,this.element,this.copy)}return e.prototype.copy=function(t,i){var a=getSelection().getRangeAt(0);if(a.toString()!==""){t.stopPropagation(),t.preventDefault();var o=document.createElement("div");o.appendChild(a.cloneContents()),t.clipboardData.setData("text/plain",i.lute.VditorIRDOM2Md(o.innerHTML).trim()),t.clipboardData.setData("text/html","")}},e.prototype.bindEvent=function(t){var i=this;this.element.addEventListener("paste",function(a){di(t,a,{pasteCode:function(o){document.execCommand("insertHTML",!1,o)}})}),this.element.addEventListener("scroll",function(){M(t,["hint"])}),this.element.addEventListener("compositionstart",function(a){i.composingLock=!0}),this.element.addEventListener("compositionend",function(a){(0,u.gm)()||Z(t,getSelection().getRangeAt(0).cloneRange()),i.composingLock=!1}),this.element.addEventListener("input",function(a){if(!(a.inputType==="deleteByDrag"||a.inputType==="insertFromDrop")){if(i.preventInput){i.preventInput=!1,nn(t,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0});return}i.composingLock||a.data==="‘"||a.data==="“"||a.data==="《"||Z(t,getSelection().getRangeAt(0).cloneRange(),!1,a)}}),this.element.addEventListener("click",function(a){if(a.target.tagName==="INPUT"){a.target.checked?a.target.setAttribute("checked","checked"):a.target.removeAttribute("checked"),i.preventInput=!0,nn(t);return}var o=(0,j.RN)(t),l=(0,v.KJ)(a.target,"vditor-ir__preview");if(l||(l=(0,v.KJ)(o.startContainer,"vditor-ir__preview")),l&&(l.previousElementSibling.firstElementChild?o.selectNodeContents(l.previousElementSibling.firstElementChild):o.selectNodeContents(l.previousElementSibling),o.collapse(!0),(0,j.jl)(o),vt(t)),a.target.tagName==="IMG"){var E=a.target.parentElement.querySelector(".vditor-ir__marker--link");E&&(o.selectNode(E),(0,j.jl)(o))}var L=(0,v.Th)(a.target,"data-type","a");if(L&&!L.classList.contains("vditor-ir__node--expand")){t.options.link.click?t.options.link.click(L.querySelector(":scope > .vditor-ir__marker--link")):t.options.link.isOpen&&window.open(L.querySelector(":scope > .vditor-ir__marker--link").textContent);return}if(a.target.isEqualNode(i.element)&&i.element.lastElementChild&&o.collapsed){var D=i.element.lastElementChild.getBoundingClientRect();a.y>D.top+D.height&&(i.element.lastElementChild.tagName==="P"&&i.element.lastElementChild.textContent.trim().replace(f.Y.ZWSP,"")===""?(o.selectNodeContents(i.element.lastElementChild),o.collapse(!1)):(i.element.insertAdjacentHTML("beforeend",'<p data-block="0">'.concat(f.Y.ZWSP,"<wbr></p>")),(0,j.ir)(i.element,o)))}o.toString()===""?$(o,t):setTimeout(function(){$((0,j.RN)(t),t)}),G(a,t),Le(t)}),this.element.addEventListener("keyup",function(a){if(!(a.isComposing||(0,u._0)(a))){if(a.key==="Enter"&&vt(t),Le(t),(a.key==="Backspace"||a.key==="Delete")&&t.ir.element.innerHTML!==""&&t.ir.element.childNodes.length===1&&t.ir.element.firstElementChild&&t.ir.element.firstElementChild.tagName==="P"&&t.ir.element.firstElementChild.childElementCount===0&&(t.ir.element.textContent===""||t.ir.element.textContent===`
`)){t.ir.element.innerHTML="";return}var o=(0,j.RN)(t);a.key==="Backspace"?((0,u.gm)()&&o.startContainer.textContent===`
`&&o.startOffset===1&&(o.startContainer.textContent="",$(o,t)),i.element.querySelectorAll(".language-math").forEach(function(E){var L=E.querySelector("br");L&&L.remove()})):a.key.indexOf("Arrow")>-1?((a.key==="ArrowLeft"||a.key==="ArrowRight")&&Qr(t),$(o,t)):a.keyCode===229&&a.code===""&&a.key==="Unidentified"&&$(o,t);var l=(0,v.KJ)(o.startContainer,"vditor-ir__preview");if(l){if(a.key==="ArrowUp"||a.key==="ArrowLeft")return l.previousElementSibling.firstElementChild?o.selectNodeContents(l.previousElementSibling.firstElementChild):o.selectNodeContents(l.previousElementSibling),o.collapse(!1),a.preventDefault(),!0;if(l.tagName==="SPAN"&&(a.key==="ArrowDown"||a.key==="ArrowRight"))return l.parentElement.getAttribute("data-type")==="html-entity"?(l.parentElement.insertAdjacentText("afterend",f.Y.ZWSP),o.setStart(l.parentElement.nextSibling,1)):o.selectNodeContents(l.parentElement.lastElementChild),o.collapse(!1),a.preventDefault(),!0}}})},e}(),ea=function(e){if(e.currentMode==="sv")return e.lute.Md2HTML(T(e));if(e.currentMode==="wysiwyg")return e.lute.VditorDOM2HTML(e.wysiwyg.element.innerHTML);if(e.currentMode==="ir")return e.lute.VditorIRDOM2HTML(e.ir.element.innerHTML)},zo=c(796),ta=c(70),$o=function(){function e(t){this.element=document.createElement("div"),this.element.className="vditor-outline",this.element.innerHTML='<div class="vditor-outline__title">'.concat(t,`</div>
<div class="vditor-outline__content"></div>`)}return e.prototype.render=function(t){var i="";return t.preview.element.style.display==="block"?i=(0,ta.N)(t.preview.previewElement,this.element.lastElementChild,t):i=(0,ta.N)(t[t.currentMode].element,this.element.lastElementChild,t),i},e.prototype.toggle=function(t,i,a){var o;i===void 0&&(i=!0),a===void 0&&(a=!0);var l=(o=t.toolbar.elements.outline)===null||o===void 0?void 0:o.firstElementChild;if(i&&window.innerWidth>=f.Y.MOBILE_WIDTH?(this.element.style.display="block",this.render(t),l==null||l.classList.add("vditor-menu--current")):(this.element.style.display="none",l==null||l.classList.remove("vditor-menu--current")),a&&getSelection().rangeCount>0){var E=getSelection().getRangeAt(0);t[t.currentMode].element.contains(E.startContainer)&&(0,j.jl)(E)}ct(t)},e}(),Fo=c(0),Uo=function(){function e(t){var i=this;this.element=document.createElement("div"),this.element.className="vditor-preview",this.previewElement=document.createElement("div"),this.previewElement.className="vditor-reset",t.options.classes.preview&&this.previewElement.classList.add(t.options.classes.preview),this.previewElement.style.maxWidth=t.options.preview.maxWidth+"px",this.previewElement.addEventListener("copy",function(D){if(D.target.tagName!=="TEXTAREA"){var A=document.createElement("div");A.className="vditor-reset",A.appendChild(getSelection().getRangeAt(0).cloneContents()),i.copyToX(t,A,"default"),D.preventDefault()}}),this.previewElement.addEventListener("click",function(D){var A=(0,v._Y)(D.target,"SPAN");if(A&&(0,v.KJ)(A,"vditor-toc")){var P=i.previewElement.querySelector("#"+A.getAttribute("data-target-id"));P&&(i.element.scrollTop=P.offsetTop);return}if(D.target.tagName==="A"){t.options.link.click?t.options.link.click(D.target):t.options.link.isOpen&&window.open(D.target.getAttribute("href")),D.preventDefault();return}D.target.tagName==="IMG"&&(t.options.image.preview?t.options.image.preview(D.target):t.options.image.isPreview&&(0,re.o)(D.target,t.options.lang,t.options.theme))}),this.element.appendChild(this.previewElement);var a=t.options.preview.actions;if(a.length!==0){var o=document.createElement("div");o.className="vditor-preview__action";for(var l=[],E=0;E<a.length;E++){var L=a[E];if(typeof L=="object"){l.push('<button type="button" data-type="'.concat(L.key,'" class="').concat(L.className,'"').concat(L.tooltip?' aria-label="'.concat(L.tooltip,'"'):"",'">').concat(L.text,"</button>"));continue}switch(L){case"desktop":l.push('<button type="button" class="vditor-preview__action--current" data-type="desktop">Desktop</button>');break;case"tablet":l.push('<button type="button" data-type="tablet">Tablet</button>');break;case"mobile":l.push('<button type="button" data-type="mobile">Mobile/Wechat</button>');break;case"mp-wechat":l.push('<button type="button" data-type="mp-wechat" class="vditor-tooltipped vditor-tooltipped__w" aria-label="复制到公众号"><svg><use xlink:href="#vditor-icon-mp-wechat"></use></svg></button>');break;case"zhihu":l.push('<button type="button" data-type="zhihu" class="vditor-tooltipped vditor-tooltipped__w" aria-label="复制到知乎"><svg><use xlink:href="#vditor-icon-zhihu"></use></svg></button>');break}}o.innerHTML=l.join(""),o.addEventListener((0,u.y3)(),function(D){var A=(0,O.f)(D.target,"BUTTON");if(A){var P=A.getAttribute("data-type"),F=a.find(function(le){return(le==null?void 0:le.key)===P});if(F){F.click(P);return}if(P==="mp-wechat"||P==="zhihu"){i.copyToX(t,i.previewElement.cloneNode(!0),P);return}P==="desktop"?i.previewElement.style.width="auto":P==="tablet"?i.previewElement.style.width="780px":i.previewElement.style.width="360px",i.previewElement.scrollWidth>i.previewElement.parentElement.clientWidth&&(i.previewElement.style.width="auto"),i.render(t),o.querySelectorAll("button").forEach(function(le){le.classList.remove("vditor-preview__action--current")}),A.classList.add("vditor-preview__action--current")}}),this.element.insertBefore(o,this.previewElement)}}return e.prototype.render=function(t,i){var a=this;if(clearTimeout(this.mdTimeoutId),this.element.style.display==="none"){this.element.getAttribute("data-type")==="renderPerformance"&&t.tip.hide();return}if(i){this.previewElement.innerHTML=i;return}if(T(t).replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")===""){this.previewElement.innerHTML="";return}var o=new Date().getTime(),l=T(t);this.mdTimeoutId=window.setTimeout(function(){if(t.options.preview.url){var E=new XMLHttpRequest;E.open("POST",t.options.preview.url),E.setRequestHeader("Content-Type","application/json;charset=UTF-8"),E.onreadystatechange=function(){if(E.readyState===XMLHttpRequest.DONE)if(E.status===200){var D=JSON.parse(E.responseText);if(D.code!==0){t.tip.show(D.msg);return}t.options.preview.transform&&(D.data=t.options.preview.transform(D.data)),a.previewElement.innerHTML=D.data,a.afterRender(t,o)}else{var A=t.lute.Md2HTML(l);t.options.preview.transform&&(A=t.options.preview.transform(A)),a.previewElement.innerHTML=A,a.afterRender(t,o)}},E.send(JSON.stringify({markdownText:l}))}else{var L=t.lute.Md2HTML(l);t.options.preview.transform&&(L=t.options.preview.transform(L)),a.previewElement.innerHTML=L,a.afterRender(t,o)}},t.options.preview.delay)},e.prototype.afterRender=function(t,i){t.options.preview.parse&&t.options.preview.parse(this.element);var a=new Date().getTime()-i;new Date().getTime()-i>2600?(t.tip.show(window.VditorI18n.performanceTip.replace("${x}",a.toString())),t.preview.element.setAttribute("data-type","renderPerformance")):t.preview.element.getAttribute("data-type")==="renderPerformance"&&(t.tip.hide(),t.preview.element.removeAttribute("data-type"));var o=t.preview.element.querySelector(".vditor-comment--focus");o&&o.classList.remove("vditor-comment--focus"),(0,R.o)(t.preview.previewElement,t.options.preview.hljs),(0,se.$)(t.options.preview.hljs,t.preview.previewElement,t.options.cdn),(0,ke.e)(t.preview.previewElement,t.options.cdn,t.options.theme),(0,Re.K)(t.preview.previewElement,t.options.cdn),(0,Ne.Y)(t.preview.previewElement,t.options.cdn,t.options.theme),(0,N.D)(t.preview.previewElement,t.options.cdn),(0,V.m)(t.preview.previewElement,t.options.cdn),(0,I.v)(t.preview.previewElement,t.options.cdn,t.options.theme),(0,_e.l)(t.preview.previewElement,t.options.cdn,t.options.theme),(0,Te.M)(t.preview.previewElement,t.options.cdn),(0,z.$)(t.preview.previewElement,t.options.cdn),t.options.preview.render.media.enable&&(0,Fo.l)(t.preview.previewElement),t.options.customRenders.forEach(function(L){L.render(t.preview.previewElement,t)});var l=t.preview.element,E=t.outline.render(t);E===""&&(E="[ToC]"),l.querySelectorAll('[data-type="toc-block"]').forEach(function(L){L.innerHTML=E,(0,ue.T)(L,{cdn:t.options.cdn,math:t.options.preview.math})}),(0,ue.T)(t.preview.previewElement,{cdn:t.options.cdn,math:t.options.preview.math})},e.prototype.copyToX=function(t,i,a){a===void 0&&(a="mp-wechat"),a!=="zhihu"?i.querySelectorAll(".katex-html .base").forEach(function(l){l.style.display="initial"}):i.querySelectorAll(".language-math").forEach(function(l){l.outerHTML='<img class="Formula-image" data-eeimg="true" src="//www.zhihu.com/equation?tex=" alt="'.concat(l.getAttribute("data-math"),'\\" style="display: block; margin: 0 auto; max-width: 100%;">')}),i.style.backgroundColor="#fff",i.querySelectorAll("code").forEach(function(l){l.style.backgroundImage="none"}),this.element.append(i);var o=i.ownerDocument.createRange();o.selectNode(i),(0,j.jl)(o),document.execCommand("copy"),i.remove(),t.tip.show(["zhihu","mp-wechat"].includes(a)?"已复制，可到".concat(a==="zhihu"?"知乎":"微信公众号平台","进行粘贴"):"已复制到剪切板")},e}(),Vo=function(){function e(t){this.element=document.createElement("div"),this.element.className="vditor-resize vditor-resize--".concat(t.options.resize.position),this.element.innerHTML='<div><svg><use xlink:href="#vditor-icon-resize"></use></svg></div>',this.bindEvent(t)}return e.prototype.bindEvent=function(t){var i=this;this.element.addEventListener("mousedown",function(a){var o=document,l=a.clientY,E=t.element.offsetHeight,L=63+t.element.querySelector(".vditor-toolbar").clientHeight;o.ondragstart=function(){return!1},window.captureEvents&&window.captureEvents(),i.element.classList.add("vditor-resize--selected"),o.onmousemove=function(D){t.options.resize.position==="top"?t.element.style.height=Math.max(L,E+(l-D.clientY))+"px":t.element.style.height=Math.max(L,E+(D.clientY-l))+"px",t.options.typewriterMode&&(t.sv.element.style.paddingBottom=t.sv.element.parentElement.offsetHeight/2+"px")},o.onmouseup=function(){t.options.resize.after&&t.options.resize.after(t.element.offsetHeight-E),window.captureEvents&&window.captureEvents(),o.onmousemove=null,o.onmouseup=null,o.ondragstart=null,o.onselectstart=null,o.onselect=null,i.element.classList.remove("vditor-resize--selected")}})},e}(),qo=function(){function e(t){this.composingLock=!1,this.element=document.createElement("pre"),this.element.className="vditor-sv vditor-reset",this.element.setAttribute("placeholder",t.options.placeholder),this.element.setAttribute("contenteditable","true"),this.element.setAttribute("spellcheck","false"),this.bindEvent(t),Bi(t,this.element),zi(t,this.element),Vi(t,this.element),qi(t,this.element),$i(t,this.element),Fi(t,this.element,this.copy),Ui(t,this.element,this.copy)}return e.prototype.copy=function(t,i){t.stopPropagation(),t.preventDefault(),t.clipboardData.setData("text/plain",Un(i[i.currentMode].element))},e.prototype.bindEvent=function(t){var i=this;this.element.addEventListener("paste",function(a){di(t,a,{pasteCode:function(o){document.execCommand("insertHTML",!1,o)}})}),this.element.addEventListener("scroll",function(){if(t.preview.element.style.display==="block"){var a=i.element.scrollTop,o=i.element.clientHeight,l=i.element.scrollHeight-parseFloat(i.element.style.paddingBottom||"0"),E=t.preview.element;a/o>.5?E.scrollTop=(a+o)*E.scrollHeight/l-o:E.scrollTop=a*E.scrollHeight/l}}),this.element.addEventListener("compositionstart",function(a){i.composingLock=!0}),this.element.addEventListener("compositionend",function(a){(0,u.gm)()||Be(t,a),i.composingLock=!1}),this.element.addEventListener("input",function(a){if(!(a.inputType==="deleteByDrag"||a.inputType==="insertFromDrop")&&!(i.composingLock||a.data==="‘"||a.data==="“"||a.data==="《")){if(i.preventInput){i.preventInput=!1,St(t,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0});return}Be(t,a)}}),this.element.addEventListener("keyup",function(a){if(!(a.isComposing||(0,u._0)(a))){if((a.key==="Backspace"||a.key==="Delete")&&t.sv.element.innerHTML!==""&&t.sv.element.childNodes.length===1&&t.sv.element.firstElementChild&&t.sv.element.firstElementChild.tagName==="DIV"&&t.sv.element.firstElementChild.childElementCount===2&&(t.sv.element.firstElementChild.textContent===""||t.sv.element.textContent===`
`)){t.sv.element.innerHTML="";return}a.key==="Enter"&&vt(t)}})},e}(),na=function(){function e(){this.element=document.createElement("div"),this.element.className="vditor-tip"}return e.prototype.show=function(t,i){var a=this;i===void 0&&(i=6e3),this.element.className="vditor-tip vditor-tip--show",i===0?(this.element.innerHTML='<div class="vditor-tip__content">'.concat(t,`
<div class="vditor-tip__close">X</div></div>`),this.element.querySelector(".vditor-tip__close").addEventListener("click",function(){a.hide()})):(this.element.innerHTML='<div class="vditor-tip__content">'.concat(t,"</div>"),setTimeout(function(){a.hide()},i)),this.element.removeAttribute("style"),setTimeout(function(){var o=a.element.getBoundingClientRect();o.top<46&&(a.element.style.position="fixed",a.element.style.top="46px")},150)},e.prototype.hide=function(){this.element.className="vditor-messageElementtip",this.element.innerHTML=""},e}(),Ji=function(e,t){if(t.options.preview.mode!==e){switch(t.options.preview.mode=e,e){case"both":t.sv.element.style.display="block",t.preview.element.style.display="block",t.preview.render(t),g(t.toolbar.elements,["both"]);break;case"editor":t.sv.element.style.display="block",t.preview.element.style.display="none",m(t.toolbar.elements,["both"]);break}t.devtools&&t.devtools.renderEchart(t)}},Wo=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Yo=function(e){Wo(t,e);function t(i,a){var o=e.call(this,i,a)||this;return i.options.preview.mode==="both"&&o.element.children[0].classList.add("vditor-menu--current"),o.element.children[0].addEventListener((0,u.y3)(),function(l){var E=o.element.firstElementChild;E.classList.contains(f.Y.CLASS_MENU_DISABLED)||(l.preventDefault(),i.currentMode==="sv"&&(i.options.preview.mode==="both"?Ji("editor",i):Ji("both",i)))}),o}return t}(pt),Ko=function(){function e(){this.element=document.createElement("div"),this.element.className="vditor-toolbar__br"}return e}(),ia=c(13),Go=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Zo=function(e){Go(t,e);function t(i,a){var o=e.call(this,i,a)||this,l=o.element.children[0],E=document.createElement("div");E.className="vditor-hint".concat(a.level===2?"":" vditor-panel--arrow");var L="";return f.Y.CODE_THEME.forEach(function(D){L+="<button>".concat(D,"</button>")}),E.innerHTML='<div style="overflow: auto;max-height:'.concat(window.innerHeight/2,'px">').concat(L,"</div>"),E.addEventListener((0,u.y3)(),function(D){D.target.tagName==="BUTTON"&&(M(i,["subToolbar"]),i.options.preview.hljs.style=D.target.textContent,(0,ia.h)(D.target.textContent,i.options.cdn),D.preventDefault(),D.stopPropagation())}),o.element.appendChild(E),x(i,E,l,a.level),o}return t}(pt),Xo=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Jo=function(e){Xo(t,e);function t(i,a){var o=e.call(this,i,a)||this,l=o.element.children[0],E=document.createElement("div");E.className="vditor-hint".concat(a.level===2?"":" vditor-panel--arrow");var L="";return Object.keys(i.options.preview.theme.list).forEach(function(D){L+='<button data-type="'.concat(D,'">').concat(i.options.preview.theme.list[D],"</button>")}),E.innerHTML='<div style="overflow: auto;max-height:'.concat(window.innerHeight/2,'px">').concat(L,"</div>"),E.addEventListener((0,u.y3)(),function(D){D.target.tagName==="BUTTON"&&(M(i,["subToolbar"]),i.options.preview.theme.current=D.target.getAttribute("data-type"),(0,ge.H)(i.options.preview.theme.current,i.options.preview.theme.path),D.preventDefault(),D.stopPropagation())}),o.element.appendChild(E),x(i,E,l,a.level),o}return t}(pt),Qo=function(){function e(t){this.element=document.createElement("span"),this.element.className="vditor-counter vditor-tooltipped vditor-tooltipped__nw",this.render(t,"")}return e.prototype.render=function(t,i){var a=i.endsWith(`
`)?i.length-1:i.length;if(t.options.counter.type==="text"&&t[t.currentMode]){var o=t[t.currentMode].element.cloneNode(!0);o.querySelectorAll(".vditor-wysiwyg__preview").forEach(function(l){l.remove()}),a=o.textContent.length}typeof t.options.counter.max=="number"?(a>t.options.counter.max?this.element.className="vditor-counter vditor-counter--error":this.element.className="vditor-counter",this.element.innerHTML="".concat(a,"/").concat(t.options.counter.max)):this.element.innerHTML="".concat(a),this.element.setAttribute("aria-label",t.options.counter.type),t.options.counter.after&&t.options.counter.after(a,{enable:t.options.counter.enable,max:t.options.counter.max,type:t.options.counter.type})},e}(),es=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),ts=function(e){es(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o.element.children[0].innerHTML=a.icon,o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),!l.currentTarget.classList.contains(f.Y.CLASS_MENU_DISABLED)&&a.click(l,i)}),o}return t}(pt),ns=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),is=function(e){ns(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o.element.firstElementChild.addEventListener((0,u.y3)(),function(l){var E=o.element.firstElementChild;E.classList.contains(f.Y.CLASS_MENU_DISABLED)||(l.preventDefault(),E.classList.contains("vditor-menu--current")?(E.classList.remove("vditor-menu--current"),i.devtools.element.style.display="none",ct(i)):(E.classList.add("vditor-menu--current"),i.devtools.element.style.display="block",ct(i),i.devtools.renderEchart(i)))}),o}return t}(pt),rs=function(){function e(){this.element=document.createElement("div"),this.element.className="vditor-toolbar__divider"}return e}(),as=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),os=function(e){as(t,e);function t(i,a){var o=e.call(this,i,a)||this,l=document.createElement("div");l.className="vditor-panel vditor-panel--arrow";var E="";return Object.keys(i.options.hint.emoji).forEach(function(L){var D=i.options.hint.emoji[L];D.indexOf(".")>-1?E+='<button data-value=":'.concat(L,': " data-key=":').concat(L,`:"><img
data-value=":`).concat(L,': " data-key=":').concat(L,':" class="vditor-emojis__icon" src="').concat(D,'"/></button>'):E+='<button data-value="'.concat(D,` "
 data-key="`).concat(L,'"><span class="vditor-emojis__icon">').concat(D,"</span></button>")}),l.innerHTML='<div class="vditor-emojis" style="max-height: '.concat(i.options.height==="auto"?"auto":i.options.height-80,'px">').concat(E,`</div><div class="vditor-emojis__tail">
    <span class="vditor-emojis__tip"></span><span>`).concat(i.options.hint.emojiTail||"",`</span>
</div>`),o.element.appendChild(l),x(i,l,o.element.firstElementChild,a.level),o.bindEvent(i),o}return t.prototype.bindEvent=function(i){var a=this;this.element.lastElementChild.addEventListener((0,u.y3)(),function(o){var l=(0,O.f)(o.target,"BUTTON");if(l){o.preventDefault();var E=l.getAttribute("data-value"),L=(0,j.RN)(i),D=E;if(i.currentMode==="wysiwyg"?D=i.lute.SpinVditorDOM(E):i.currentMode==="ir"&&(D=i.lute.SpinVditorIRDOM(E)),E.indexOf(":")>-1&&i.currentMode!=="sv"){var A=document.createElement("div");A.innerHTML=D,D=A.firstElementChild.firstElementChild.outerHTML+" ",(0,j.Z2)(D,i)}else L.extractContents(),L.insertNode(document.createTextNode(E)),(0,v.pt)(L.startContainer)||Xt(i,L);L.collapse(!1),(0,j.jl)(L),a.element.lastElementChild.style.display="none",Ke(i)}}),this.element.lastElementChild.addEventListener("mouseover",function(o){var l=(0,O.f)(o.target,"BUTTON");l&&(a.element.querySelector(".vditor-emojis__tip").innerHTML=l.getAttribute("data-key"))})},t}(pt),ra=function(e,t,i){var a=document.createElement("a");"download"in a?(a.download=i,a.style.display="none",a.href=URL.createObjectURL(new Blob([t])),document.body.appendChild(a),a.click(),a.remove()):e.tip.show(window.VditorI18n.downloadTip,0)},ss=function(e){var t=T(e);ra(e,t,t.substr(0,10)+".md")},ls=function(e){e.tip.show(window.VditorI18n.generate,3800);var t=document.querySelector("#vditorExportIframe");t.contentDocument.open(),t.contentDocument.write('<link rel="stylesheet" href="'.concat(e.options.cdn,`/dist/index.css"/>
<script src="`).concat(e.options.cdn,`/dist/method.min.js"><\/script>
<div id="preview" style="width: 800px"></div>
<script>
window.addEventListener("message", (e) => {
  if(!e.data) {
    return;
  }
  Vditor.preview(document.getElementById('preview'), e.data, {
    cdn: "`).concat(e.options.cdn,`",
    markdown: {
      theme: `).concat(JSON.stringify(e.options.preview.theme),`
    },
    hljs: {
      style: "`).concat(e.options.preview.hljs.style,`"
    }
  });
  setTimeout(() => {
        window.print();
    }, 3600);
}, false);
<\/script>`)),t.contentDocument.close(),setTimeout(function(){t.contentWindow.postMessage(T(e),"*")},200)},cs=function(e){var t=ea(e),i='<html><head><link rel="stylesheet" type="text/css" href="'.concat(e.options.cdn,`/dist/index.css"/>
<script src="`).concat(e.options.cdn,"/dist/js/i18n/").concat(e.options.lang,`.js"><\/script>
<script src="`).concat(e.options.cdn,`/dist/method.min.js"><\/script></head>
<body><div class="vditor-reset" id="preview">`).concat(t,`</div>
<script>
    const previewElement = document.getElementById('preview')
    Vditor.setContentTheme('`).concat(e.options.preview.theme.current,"', '").concat(e.options.preview.theme.path,`');
    Vditor.codeRender(previewElement);
    Vditor.highlightRender(`).concat(JSON.stringify(e.options.preview.hljs),", previewElement, '").concat(e.options.cdn,`');
    Vditor.mathRender(previewElement, {
        cdn: '`).concat(e.options.cdn,`',
        math: `).concat(JSON.stringify(e.options.preview.math),`,
    });
    Vditor.mermaidRender(previewElement, '`).concat(e.options.cdn,"', '").concat(e.options.theme,`');
    Vditor.SMILESRender(previewElement, '`).concat(e.options.cdn,"', '").concat(e.options.theme,`');
    Vditor.markmapRender(previewElement, '`).concat(e.options.cdn,`');
    Vditor.flowchartRender(previewElement, '`).concat(e.options.cdn,`');
    Vditor.graphvizRender(previewElement, '`).concat(e.options.cdn,`');
    Vditor.chartRender(previewElement, '`).concat(e.options.cdn,"', '").concat(e.options.theme,`');
    Vditor.mindmapRender(previewElement, '`).concat(e.options.cdn,"', '").concat(e.options.theme,`');
    Vditor.abcRender(previewElement, '`).concat(e.options.cdn,`');
    `).concat(e.options.preview.render.media.enable?"Vditor.mediaRender(previewElement);":"",`
    Vditor.speechRender(previewElement);
<\/script>
<script src="`).concat(e.options.cdn,"/dist/js/icons/").concat(e.options.icon,'.js"><\/script></body></html>');ra(e,i,t.substr(0,10)+".html")},us=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),ds=function(e){us(t,e);function t(i,a){var o=e.call(this,i,a)||this,l=o.element.children[0],E=document.createElement("div");return E.className="vditor-hint".concat(a.level===2?"":" vditor-panel--arrow"),E.innerHTML=`<button data-type="markdown">Markdown</button>
<button data-type="pdf">PDF</button>
<button data-type="html">HTML</button>`,E.addEventListener((0,u.y3)(),function(L){var D=L.target;if(D.tagName==="BUTTON"){switch(D.getAttribute("data-type")){case"markdown":ss(i);break;case"pdf":ls(i);break;case"html":cs(i);break}M(i,["subToolbar"]),L.preventDefault(),L.stopPropagation()}}),o.element.appendChild(E),x(i,E,l,a.level),o}return t}(pt),fs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),hs=function(e){fs(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o._bindEvent(i,a),o}return t.prototype._bindEvent=function(i,a){this.element.children[0].addEventListener((0,u.y3)(),function(o){o.preventDefault(),i.element.className.includes("vditor--fullscreen")?(a.level||(this.innerHTML=a.icon),i.element.style.zIndex="",document.body.style.overflow="",i.element.classList.remove("vditor--fullscreen"),Object.keys(i.toolbar.elements).forEach(function(l){var E=i.toolbar.elements[l].firstChild;E&&(E.className=E.className.replace("__s","__n"),i.options.toolbar.forEach(function(L){typeof L!="string"&&L.tipPosition&&L.name===E.dataset.type&&(E.className="vditor-tooltipped vditor-tooltipped__".concat(L.tipPosition))}))}),i.counter&&(i.counter.element.className=i.counter.element.className.replace("__s","__n"))):(a.level||(this.innerHTML='<svg><use xlink:href="#vditor-icon-contract"></use></svg>'),i.element.style.zIndex=i.options.fullscreen.index.toString(),document.body.style.overflow="hidden",i.element.classList.add("vditor--fullscreen"),Object.keys(i.toolbar.elements).forEach(function(l){var E=i.toolbar.elements[l].firstChild;E&&(E.className=E.className.replace("__n","__s"))}),i.counter&&(i.counter.element.className=i.counter.element.className.replace("__n","__s"))),i.devtools&&i.devtools.renderEchart(i),a.click&&a.click(o,i),ct(i),Y(i)})},t}(pt),ps=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),ms=function(e){ps(t,e);function t(i,a){var o=e.call(this,i,a)||this,l=document.createElement("div");return l.className="vditor-hint vditor-panel--arrow",l.innerHTML='<button data-tag="h1" data-value="# ">'.concat(window.VditorI18n.heading1," ").concat((0,u.fG)("&lt;⌥⌘1>"),`</button>
<button data-tag="h2" data-value="## ">`).concat(window.VditorI18n.heading2," &lt;").concat((0,u.fG)("⌥⌘2"),`></button>
<button data-tag="h3" data-value="### ">`).concat(window.VditorI18n.heading3," &lt;").concat((0,u.fG)("⌥⌘3"),`></button>
<button data-tag="h4" data-value="#### ">`).concat(window.VditorI18n.heading4," &lt;").concat((0,u.fG)("⌥⌘4"),`></button>
<button data-tag="h5" data-value="##### ">`).concat(window.VditorI18n.heading5," &lt;").concat((0,u.fG)("⌥⌘5"),`></button>
<button data-tag="h6" data-value="###### ">`).concat(window.VditorI18n.heading6," &lt;").concat((0,u.fG)("⌥⌘6"),"></button>"),o.element.appendChild(l),o._bindEvent(i,l),o}return t.prototype._bindEvent=function(i,a){var o=this.element.children[0];o.addEventListener((0,u.y3)(),function(E){E.preventDefault(),clearTimeout(i.wysiwyg.afterRenderTimeoutId),clearTimeout(i.ir.processTimeoutId),clearTimeout(i.sv.processTimeoutId),!o.classList.contains(f.Y.CLASS_MENU_DISABLED)&&(o.blur(),o.classList.contains("vditor-menu--current")?(i.currentMode==="wysiwyg"?(fe(i),ye(i)):i.currentMode==="ir"&&Wn(i,""),o.classList.remove("vditor-menu--current")):(M(i,["subToolbar"]),a.style.display="block"))});for(var l=0;l<6;l++)a.children.item(l).addEventListener((0,u.y3)(),function(E){E.preventDefault(),i.currentMode==="wysiwyg"?(J(i,E.target.getAttribute("data-tag")),ye(i),o.classList.add("vditor-menu--current")):i.currentMode==="ir"?(Wn(i,E.target.getAttribute("data-value")),o.classList.add("vditor-menu--current")):Dr(i,E.target.getAttribute("data-value")),a.style.display="none"})},t}(pt),gs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),vs=function(e){gs(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),i.tip.show(`<div style="margin-bottom:14px;font-size: 14px;line-height: 22px;min-width:300px;max-width: 360px;display: flex;">
<div style="margin-top: 14px;flex: 1">
    <div>Markdown 使用指南</div>
    <ul style="list-style: none">
        <li><a href="https://ld246.com/article/1583308420519" target="_blank">语法速查手册</a></li>
        <li><a href="https://ld246.com/article/1583129520165" target="_blank">基础语法</a></li>
        <li><a href="https://ld246.com/article/1583305480675" target="_blank">扩展语法</a></li>
        <li><a href="https://ld246.com/article/1582778815353" target="_blank">键盘快捷键</a></li>
    </ul>
</div>
<div style="margin-top: 14px;flex: 1">
    <div>Vditor 支持</div>
    <ul style="list-style: none">
        <li><a href="https://github.com/Vanessa219/vditor/issues" target="_blank">Issues</a></li>
        <li><a href="https://ld246.com/tag/vditor" target="_blank">官方讨论区</a></li>
        <li><a href="https://ld246.com/article/1549638745630" target="_blank">开发手册</a></li>
        <li><a href="https://ld246.com/guide/markdown" target="_blank">演示地址</a></li>
    </ul>
</div></div>`,0)}),o}return t}(pt),ys=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),bs=function(e){ys(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o.element.children[0].addEventListener((0,u.y3)(),function(l){if(l.preventDefault(),!(o.element.firstElementChild.classList.contains(f.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")){var E=(0,j.RN)(i),L=(0,v._Y)(E.startContainer,"LI");L&&jr(i,L,E)}}),o}return t}(pt),ws=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Es=function(e){ws(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),i.tip.show(`<div style="max-width: 520px; font-size: 14px;line-height: 22px;margin-bottom: 14px;">
<p style="text-align: center;margin: 14px 0">
    <em>下一代的 Markdown 编辑器，为未来而构建</em>
</p>
<div style="display: flex;margin-bottom: 14px;flex-wrap: wrap;align-items: center">
    <img src="https://unpkg.com/vditor/dist/images/logo.png" style="margin: 0 auto;height: 68px"/>
    <div>&nbsp;&nbsp;</div>
    <div style="flex: 1;min-width: 250px">
        Vditor 是一款浏览器端的 Markdown 编辑器，支持所见即所得、即时渲染（类似 Typora）和分屏预览模式。
        它使用 TypeScript 实现，支持原生 JavaScript 以及 Vue、React、Angular 和 Svelte 等框架。
    </div>
</div>
<div style="display: flex;flex-wrap: wrap;">
    <ul style="list-style: none;flex: 1;min-width:148px">
        <li>
        项目地址：<a href="https://b3log.org/vditor" target="_blank">b3log.org/vditor</a>
        </li>
        <li>
        开源协议：MIT
        </li>
    </ul>
    <ul style="list-style: none;margin-right: 18px">
        <li>
        组件版本：Vditor v`.concat(f.g," / Lute v").concat(Lute.Version,`
        </li>
        <li>
        赞助捐赠：<a href="https://ld246.com/sponsor" target="_blank">https://ld246.com/sponsor</a>
        </li>
    </ul>
</div>
</div>`),0)}),o}return t}(pt),Ss=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Cs=function(e){Ss(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),!(o.element.firstElementChild.classList.contains(f.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")&&Vn(i,"afterend")}),o}return t}(pt),ks=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Ts=function(e){ks(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),!(o.element.firstElementChild.classList.contains(f.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")&&Vn(i,"beforebegin")}),o}return t}(pt),xs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),_s=function(e){xs(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o.element.children[0].addEventListener((0,u.y3)(),function(l){if(l.preventDefault(),!(o.element.firstElementChild.classList.contains(f.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")){var E=(0,j.RN)(i),L=(0,v._Y)(E.startContainer,"LI");L&&Ki(i,L,E,L.parentElement)}}),o}return t}(pt),Ms=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Ls=function(e){Ms(t,e);function t(i,a){var o=e.call(this,i,a)||this;return i.options.outline&&o.element.firstElementChild.classList.add("vditor-menu--current"),o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault();var E=i.toolbar.elements.outline.firstElementChild;E.classList.contains(f.Y.CLASS_MENU_DISABLED)||(i.options.outline.enable=!o.element.firstElementChild.classList.contains("vditor-menu--current"),i.outline.toggle(i,i.options.outline.enable))}),o}return t}(pt),As=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Ds=function(e){As(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o._bindEvent(i),o}return t.prototype._bindEvent=function(i){var a=this;this.element.children[0].addEventListener((0,u.y3)(),function(o){o.preventDefault();var l=a.element.firstElementChild;if(!l.classList.contains(f.Y.CLASS_MENU_DISABLED)){var E=f.Y.EDIT_TOOLBARS.concat(["both","edit-mode","devtools"]);l.classList.contains("vditor-menu--current")?(l.classList.remove("vditor-menu--current"),i.currentMode==="sv"?(i.sv.element.style.display="block",i.options.preview.mode==="both"?i.preview.element.style.display="block":i.preview.element.style.display="none"):(i[i.currentMode].element.parentElement.style.display="block",i.preview.element.style.display="none"),w(i.toolbar.elements,E),i.outline.render(i)):(b(i.toolbar.elements,E),i.preview.element.style.display="block",i.currentMode==="sv"?i.sv.element.style.display="none":i[i.currentMode].element.parentElement.style.display="none",i.preview.render(i),l.classList.add("vditor-menu--current"),M(i,["subToolbar","hint","popover"]),setTimeout(function(){i.outline.render(i)},i.options.preview.delay+10)),ct(i)}})},t}(pt),Os=function(){function e(t){this.SAMPLE_RATE=5e3,this.isRecording=!1,this.readyFlag=!1,this.leftChannel=[],this.rightChannel=[],this.recordingLength=0;var i;if(typeof AudioContext<"u")i=new AudioContext;else if(webkitAudioContext)i=new webkitAudioContext;else return;this.DEFAULT_SAMPLE_RATE=i.sampleRate;var a=i.createGain(),o=i.createMediaStreamSource(t);o.connect(a),this.recorder=i.createScriptProcessor(2048,2,1),this.recorder.onaudioprocess=null,a.connect(this.recorder),this.recorder.connect(i.destination),this.readyFlag=!0}return e.prototype.cloneChannelData=function(t,i){this.leftChannel.push(new Float32Array(t)),this.rightChannel.push(new Float32Array(i)),this.recordingLength+=2048},e.prototype.startRecordingNewWavFile=function(){this.readyFlag&&(this.isRecording=!0,this.leftChannel.length=this.rightChannel.length=0,this.recordingLength=0)},e.prototype.stopRecording=function(){this.isRecording=!1},e.prototype.buildWavFileBlob=function(){for(var t=this.mergeBuffers(this.leftChannel),i=this.mergeBuffers(this.rightChannel),a=new Float32Array(t.length),o=0;o<t.length;++o)a[o]=.5*(t[o]+i[o]);this.DEFAULT_SAMPLE_RATE>this.SAMPLE_RATE&&(a=this.downSampleBuffer(a,this.SAMPLE_RATE));var l=44+a.length*2,E=new ArrayBuffer(l),L=new DataView(E);this.writeUTFBytes(L,0,"RIFF"),L.setUint32(4,l,!0),this.writeUTFBytes(L,8,"WAVE"),this.writeUTFBytes(L,12,"fmt "),L.setUint32(16,16,!0),L.setUint16(20,1,!0),L.setUint16(22,1,!0),L.setUint32(24,this.SAMPLE_RATE,!0),L.setUint32(28,this.SAMPLE_RATE*2,!0),L.setUint16(32,2,!0),L.setUint16(34,16,!0);var D=a.length*2;this.writeUTFBytes(L,36,"data"),L.setUint32(40,D,!0);for(var A=a.length,P=44,F=1,le=0;le<A;le++)L.setInt16(P,a[le]*(32767*F),!0),P+=2;return new Blob([L],{type:"audio/wav"})},e.prototype.downSampleBuffer=function(t,i){if(i===this.DEFAULT_SAMPLE_RATE||i>this.DEFAULT_SAMPLE_RATE)return t;for(var a=this.DEFAULT_SAMPLE_RATE/i,o=Math.round(t.length/a),l=new Float32Array(o),E=0,L=0;E<l.length;){for(var D=Math.round((E+1)*a),A=0,P=0,F=L;F<D&&F<t.length;F++)A+=t[F],P++;l[E]=A/P,E++,L=D}return l},e.prototype.mergeBuffers=function(t){for(var i=new Float32Array(this.recordingLength),a=0,o=t.length,l=0;l<o;++l){var E=t[l];i.set(E,a),a+=E.length}return i},e.prototype.writeUTFBytes=function(t,i,a){for(var o=a.length,l=0;l<o;l++)t.setUint8(i+l,a.charCodeAt(l))},e}(),Ps=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Rs=function(e){Ps(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o._bindEvent(i),o}return t.prototype._bindEvent=function(i){var a=this,o;this.element.children[0].addEventListener((0,u.y3)(),function(l){if(l.preventDefault(),!a.element.firstElementChild.classList.contains(f.Y.CLASS_MENU_DISABLED)){var E=i[i.currentMode].element;if(!o){navigator.mediaDevices.getUserMedia({audio:!0}).then(function(D){o=new Os(D),o.recorder.onaudioprocess=function(A){if(o.isRecording){var P=A.inputBuffer.getChannelData(0),F=A.inputBuffer.getChannelData(1);o.cloneChannelData(P,F)}},o.startRecordingNewWavFile(),i.tip.show(window.VditorI18n.recording),E.setAttribute("contenteditable","false"),a.element.children[0].classList.add("vditor-menu--current")}).catch(function(){i.tip.show(window.VditorI18n["record-tip"])});return}if(o.isRecording){o.stopRecording(),i.tip.hide();var L=new File([o.buildWavFileBlob()],"record".concat(new Date().getTime(),".wav"),{type:"video/webm"});Yi(i,[L]),a.element.children[0].classList.remove("vditor-menu--current")}else i.tip.show(window.VditorI18n.recording),E.setAttribute("contenteditable","false"),o.startRecordingNewWavFile(),a.element.children[0].classList.add("vditor-menu--current")}})},t}(pt),Is=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Hs=function(e){Is(t,e);function t(i,a){var o=e.call(this,i,a)||this;return b({redo:o.element},["redo"]),o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),!o.element.firstElementChild.classList.contains(f.Y.CLASS_MENU_DISABLED)&&i.undo.redo(i)}),o}return t}(pt),Ns=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),js=function(e){Ns(t,e);function t(i,a){var o=e.call(this,i,a)||this;return b({undo:o.element},["undo"]),o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),!o.element.firstElementChild.classList.contains(f.Y.CLASS_MENU_DISABLED)&&i.undo.undo(i)}),o}return t}(pt),Bs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),zs=function(e){Bs(t,e);function t(i,a){var o=e.call(this,i,a)||this,l='<input type="file"';return i.options.upload.multiple&&(l+=' multiple="multiple"'),i.options.upload.accept&&(l+=' accept="'.concat(i.options.upload.accept,'"')),o.element.children[0].innerHTML="".concat(a.icon||'<svg><use xlink:href="#vditor-icon-upload"></use></svg>').concat(l,">"),o._bindEvent(i),o}return t.prototype._bindEvent=function(i){var a=this;this.element.children[0].addEventListener((0,u.y3)(),function(o){if(a.element.firstElementChild.classList.contains(f.Y.CLASS_MENU_DISABLED)){o.stopPropagation(),o.preventDefault();return}}),this.element.querySelector("input").addEventListener("change",function(o){if(a.element.firstElementChild.classList.contains(f.Y.CLASS_MENU_DISABLED)){o.stopPropagation(),o.preventDefault();return}o.target.files.length!==0&&Yi(i,o.target.files,o.target)})},t}(pt),$s=function(){function e(t){var i=this,a=t.options;this.elements={},this.element=document.createElement("div"),this.element.className="vditor-toolbar",a.toolbar.forEach(function(o,l){var E=i.genItem(t,o,l);if(i.element.appendChild(E),o.toolbar){var L=document.createElement("div");L.className="vditor-hint vditor-panel--arrow",L.addEventListener((0,u.y3)(),function(D){L.style.display="none"}),o.toolbar.forEach(function(D,A){D.level=2,L.appendChild(i.genItem(t,D,l+A))}),E.appendChild(L),x(t,L,E.children[0])}}),t.options.toolbarConfig.hide&&this.element.classList.add("vditor-toolbar--hide"),t.options.toolbarConfig.pin&&this.element.classList.add("vditor-toolbar--pin"),t.options.counter.enable&&(t.counter=new Qo(t),this.element.appendChild(t.counter.element))}return e.prototype.updateConfig=function(t,i){t.options.toolbarConfig=Object.assign({hide:!1,pin:!1},i),t.options.toolbarConfig.hide?this.element.classList.add("vditor-toolbar--hide"):this.element.classList.remove("vditor-toolbar--hide"),t.options.toolbarConfig.pin?this.element.classList.add("vditor-toolbar--pin"):this.element.classList.remove("vditor-toolbar--pin")},e.prototype.genItem=function(t,i,a){var o;switch(i.name){case"bold":case"italic":case"more":case"strike":case"line":case"quote":case"list":case"ordered-list":case"check":case"code":case"inline-code":case"link":case"table":o=new pt(t,i);break;case"emoji":o=new os(t,i);break;case"headings":o=new ms(t,i);break;case"|":o=new rs;break;case"br":o=new Ko;break;case"undo":o=new js(t,i);break;case"redo":o=new Hs(t,i);break;case"help":o=new vs(t,i);break;case"both":o=new Yo(t,i);break;case"preview":o=new Ds(t,i);break;case"fullscreen":o=new hs(t,i);break;case"upload":o=new zs(t,i);break;case"record":o=new Rs(t,i);break;case"info":o=new Es(t,i);break;case"edit-mode":o=new So(t,i);break;case"devtools":o=new is(t,i);break;case"outdent":o=new _s(t,i);break;case"indent":o=new bs(t,i);break;case"outline":o=new Ls(t,i);break;case"insert-after":o=new Cs(t,i);break;case"insert-before":o=new Ts(t,i);break;case"code-theme":o=new Zo(t,i);break;case"content-theme":o=new Jo(t,i);break;case"export":o=new ds(t,i);break;default:o=new ts(t,i);break}if(o){var l=i.name;return(l==="br"||l==="|")&&(l=l+a),this.elements[l]=o.element,o.element}},e}(),Fs=c(192),Us=function(){function e(){this.stackSize=50,this.resetStack(),this.dmp=new Fs}return e.prototype.clearStack=function(t){this.resetStack(),this.resetIcon(t)},e.prototype.resetIcon=function(t){t.toolbar&&(this[t.currentMode].undoStack.length>1?w(t.toolbar.elements,["undo"]):b(t.toolbar.elements,["undo"]),this[t.currentMode].redoStack.length!==0?w(t.toolbar.elements,["redo"]):b(t.toolbar.elements,["redo"]))},e.prototype.undo=function(t){if(t[t.currentMode].element.getAttribute("contenteditable")!=="false"&&!(this[t.currentMode].undoStack.length<2)){var i=this[t.currentMode].undoStack.pop();i&&(this[t.currentMode].redoStack.push(i),this.renderDiff(i,t),this[t.currentMode].hasUndo=!0,M(t,["hint"]))}},e.prototype.redo=function(t){if(t[t.currentMode].element.getAttribute("contenteditable")!=="false"){var i=this[t.currentMode].redoStack.pop();i&&(this[t.currentMode].undoStack.push(i),this.renderDiff(i,t,!0))}},e.prototype.recordFirstPosition=function(t,i){if(getSelection().rangeCount!==0&&!(this[t.currentMode].undoStack.length!==1||this[t.currentMode].undoStack[0].length===0||this[t.currentMode].redoStack.length>0)&&!((0,u.gm)()&&i.key==="Backspace")&&!(0,u.nr)()){var a=this.addCaret(t);a.replace("<wbr>","").replace(" vditor-ir__node--expand","")===this[t.currentMode].undoStack[0][0].diffs[0][1].replace("<wbr>","")&&(this[t.currentMode].undoStack[0][0].diffs[0][1]=a,this[t.currentMode].lastText=a)}},e.prototype.addToUndoStack=function(t){var i=this.addCaret(t,!0),a=this.dmp.diff_main(i,this[t.currentMode].lastText,!0),o=this.dmp.patch_make(i,this[t.currentMode].lastText,a);o.length===0&&this[t.currentMode].undoStack.length>0||(this[t.currentMode].lastText=i,this[t.currentMode].undoStack.push(o),this[t.currentMode].undoStack.length>this.stackSize&&this[t.currentMode].undoStack.shift(),this[t.currentMode].hasUndo&&(this[t.currentMode].redoStack=[],this[t.currentMode].hasUndo=!1,b(t.toolbar.elements,["redo"])),this[t.currentMode].undoStack.length>1&&w(t.toolbar.elements,["undo"]))},e.prototype.renderDiff=function(t,i,a){a===void 0&&(a=!1);var o;if(a){var l=this.dmp.patch_deepCopy(t).reverse();l.forEach(function(L){L.diffs.forEach(function(D){D[0]=-D[0]})}),o=this.dmp.patch_apply(l,this[i.currentMode].lastText)[0]}else o=this.dmp.patch_apply(t,this[i.currentMode].lastText)[0];if(this[i.currentMode].lastText=o,i[i.currentMode].element.innerHTML=o,i.currentMode!=="sv"&&(i[i.currentMode].element.querySelectorAll(".vditor-".concat(i.currentMode,"__preview")).forEach(function(L){L.parentElement.querySelector(".language-echarts")&&(i.currentMode==="ir"?L.parentElement.outerHTML=i.lute.SpinVditorIRDOM(L.parentElement.outerHTML):L.parentElement.outerHTML=i.lute.SpinVditorDOM(L.parentElement.outerHTML))}),i[i.currentMode].element.querySelectorAll(".vditor-".concat(i.currentMode,"__preview[data-render='2']")).forEach(function(L){$e(L,i)})),i[i.currentMode].element.querySelector("wbr"))(0,j.ir)(i[i.currentMode].element,i[i.currentMode].element.ownerDocument.createRange()),vt(i);else{var E=getSelection().getRangeAt(0);E.setEndBefore(i[i.currentMode].element),E.collapse(!1)}ce(i),Ke(i,{enableAddUndoStack:!1,enableHint:!1,enableInput:!0}),Lt(i),i[i.currentMode].element.querySelectorAll(".vditor-".concat(i.currentMode,"__preview[data-render='2']")).forEach(function(L){$e(L,i)}),this[i.currentMode].undoStack.length>1?w(i.toolbar.elements,["undo"]):b(i.toolbar.elements,["undo"]),this[i.currentMode].redoStack.length!==0?w(i.toolbar.elements,["redo"]):b(i.toolbar.elements,["redo"])},e.prototype.resetStack=function(){this.ir={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]},this.sv={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]},this.wysiwyg={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]}},e.prototype.addCaret=function(t,i){i===void 0&&(i=!1);var a;if(getSelection().rangeCount!==0&&!t[t.currentMode].element.querySelector("wbr")){var o=getSelection().getRangeAt(0);if(t[t.currentMode].element.contains(o.startContainer)){a=o.cloneRange();var l=document.createElement("span");l.className="vditor-wbr",o.insertNode(l)}}var E=t[t.currentMode].element.cloneNode(!0);E.querySelectorAll(".vditor-".concat(t.currentMode,"__preview[data-render='1']")).forEach(function(D){D.firstElementChild&&(D.firstElementChild.classList.contains("language-echarts")||D.firstElementChild.classList.contains("language-plantuml")||D.firstElementChild.classList.contains("language-mindmap")?(D.firstElementChild.removeAttribute("_echarts_instance_"),D.firstElementChild.removeAttribute("data-processed"),D.firstElementChild.innerHTML=D.previousElementSibling.firstElementChild.innerHTML,D.setAttribute("data-render","2")):D.firstElementChild.classList.contains("language-math")&&(D.setAttribute("data-render","2"),D.firstElementChild.textContent=D.firstElementChild.getAttribute("data-math"),D.firstElementChild.removeAttribute("data-math")))});var L=E.innerHTML;return t[t.currentMode].element.querySelectorAll(".vditor-wbr").forEach(function(D){D.remove()}),i&&a&&(0,j.jl)(a),L.replace('<span class="vditor-wbr"></span>',"<wbr>")},e}(),Vs=c(905),qs=function(){function e(t){this.defaultOptions={rtl:!1,after:void 0,cache:{enable:!0},cdn:f.Y.CDN,classes:{preview:""},comment:{enable:!1},counter:{enable:!1,type:"markdown"},customRenders:[],debugger:!1,fullscreen:{index:90},height:"auto",hint:{delay:200,emoji:{"+1":"👍","-1":"👎",confused:"😕",eyes:"👀️",heart:"❤️",rocket:"🚀️",smile:"😄",tada:"🎉️"},emojiPath:"".concat(f.Y.CDN,"/dist/images/emoji"),extend:[],parse:!0},icon:"ant",lang:"zh_CN",mode:"ir",outline:{enable:!1,position:"left"},placeholder:"",preview:{actions:["desktop","tablet","mobile","mp-wechat","zhihu"],delay:1e3,hljs:f.Y.HLJS_OPTIONS,markdown:f.Y.MARKDOWN_OPTIONS,math:f.Y.MATH_OPTIONS,maxWidth:800,mode:"both",theme:f.Y.THEME_OPTIONS,render:{media:{enable:!0}}},link:{isOpen:!0},image:{isPreview:!0},resize:{enable:!1,position:"bottom"},theme:"classic",toolbar:["emoji","headings","bold","italic","strike","link","|","list","ordered-list","check","outdent","indent","|","quote","line","code","inline-code","insert-before","insert-after","|","upload","record","table","|","undo","redo","|","fullscreen","edit-mode",{name:"more",toolbar:["both","code-theme","content-theme","export","outline","preview","devtools","info","help"]}],toolbarConfig:{hide:!1,pin:!1},typewriterMode:!1,undoDelay:800,upload:{extraData:{},fieldName:"file[]",filename:function(i){return i.replace(/\W/g,"")},linkToImgUrl:"",max:10*1024*1024,multiple:!0,url:"",withCredentials:!1},value:"",width:"auto"},this.options=t}return e.prototype.merge=function(){var t,i,a,o,l,E,L,D,A;this.options&&(this.options.toolbar?this.options.toolbar=this.mergeToolbar(this.options.toolbar):this.options.toolbar=this.mergeToolbar(this.defaultOptions.toolbar),!((i=(t=this.options.preview)===null||t===void 0?void 0:t.theme)===null||i===void 0)&&i.list&&(this.defaultOptions.preview.theme.list=this.options.preview.theme.list),!((l=(o=(a=this.options.preview)===null||a===void 0?void 0:a.render)===null||o===void 0?void 0:o.media)===null||l===void 0)&&l.enable&&(this.defaultOptions.preview.render.media.enable=this.options.preview.render.media.enable),!((E=this.options.hint)===null||E===void 0)&&E.emoji&&(this.defaultOptions.hint.emoji=this.options.hint.emoji),this.options.comment&&(this.defaultOptions.comment=this.options.comment),this.options.cdn&&(!((D=(L=this.options.preview)===null||L===void 0?void 0:L.theme)===null||D===void 0)&&D.path||(this.defaultOptions.preview.theme.path="".concat(this.options.cdn,"/dist/css/content-theme")),!((A=this.options.hint)===null||A===void 0)&&A.emojiPath||(this.defaultOptions.hint.emojiPath="".concat(this.options.cdn,"/dist/images/emoji"))));var P=(0,Vs.h)(this.defaultOptions,this.options);if(P.cache.enable&&!P.cache.id)throw new Error("need options.cache.id, see https://ld246.com/article/1549638745630#options");return P},e.prototype.mergeToolbar=function(t){var i=this,a=[{icon:'<svg><use xlink:href="#vditor-icon-export"></use></svg>',name:"export",tipPosition:"ne"},{hotkey:"⌘E",icon:'<svg><use xlink:href="#vditor-icon-emoji"></use></svg>',name:"emoji",tipPosition:"ne"},{hotkey:"⌘H",icon:'<svg><use xlink:href="#vditor-icon-headings"></use></svg>',name:"headings",tipPosition:"ne"},{hotkey:"⌘B",icon:'<svg><use xlink:href="#vditor-icon-bold"></use></svg>',name:"bold",prefix:"**",suffix:"**",tipPosition:"ne"},{hotkey:"⌘I",icon:'<svg><use xlink:href="#vditor-icon-italic"></use></svg>',name:"italic",prefix:"*",suffix:"*",tipPosition:"ne"},{hotkey:"⌘D",icon:'<svg><use xlink:href="#vditor-icon-strike"></use></svg>',name:"strike",prefix:"~~",suffix:"~~",tipPosition:"ne"},{hotkey:"⌘K",icon:'<svg><use xlink:href="#vditor-icon-link"></use></svg>',name:"link",prefix:"[",suffix:"](https://)",tipPosition:"n"},{name:"|"},{hotkey:"⌘L",icon:'<svg><use xlink:href="#vditor-icon-list"></use></svg>',name:"list",prefix:"* ",tipPosition:"n"},{hotkey:"⌘O",icon:'<svg><use xlink:href="#vditor-icon-ordered-list"></use></svg>',name:"ordered-list",prefix:"1. ",tipPosition:"n"},{hotkey:"⌘J",icon:'<svg><use xlink:href="#vditor-icon-check"></use></svg>',name:"check",prefix:"* [ ] ",tipPosition:"n"},{hotkey:"⇧⌘I",icon:'<svg><use xlink:href="#vditor-icon-outdent"></use></svg>',name:"outdent",tipPosition:"n"},{hotkey:"⇧⌘O",icon:'<svg><use xlink:href="#vditor-icon-indent"></use></svg>',name:"indent",tipPosition:"n"},{name:"|"},{hotkey:"⌘;",icon:'<svg><use xlink:href="#vditor-icon-quote"></use></svg>',name:"quote",prefix:"> ",tipPosition:"n"},{hotkey:"⇧⌘H",icon:'<svg><use xlink:href="#vditor-icon-line"></use></svg>',name:"line",prefix:"---",tipPosition:"n"},{hotkey:"⌘U",icon:'<svg><use xlink:href="#vditor-icon-code"></use></svg>',name:"code",prefix:"```",suffix:"\n```",tipPosition:"n"},{hotkey:"⌘G",icon:'<svg><use xlink:href="#vditor-icon-inline-code"></use></svg>',name:"inline-code",prefix:"`",suffix:"`",tipPosition:"n"},{hotkey:"⇧⌘B",icon:'<svg><use xlink:href="#vditor-icon-before"></use></svg>',name:"insert-before",tipPosition:"n"},{hotkey:"⇧⌘E",icon:'<svg><use xlink:href="#vditor-icon-after"></use></svg>',name:"insert-after",tipPosition:"n"},{name:"|"},{icon:'<svg><use xlink:href="#vditor-icon-upload"></use></svg>',name:"upload",tipPosition:"n"},{icon:'<svg><use xlink:href="#vditor-icon-record"></use></svg>',name:"record",tipPosition:"n"},{hotkey:"⌘M",icon:'<svg><use xlink:href="#vditor-icon-table"></use></svg>',name:"table",prefix:"| col1",suffix:` | col2 | col3 |
| --- | --- | --- |
|  |  |  |
|  |  |  |`,tipPosition:"n"},{name:"|"},{hotkey:"⌘Z",icon:'<svg><use xlink:href="#vditor-icon-undo"></use></svg>',name:"undo",tipPosition:"nw"},{hotkey:"⌘Y",icon:'<svg><use xlink:href="#vditor-icon-redo"></use></svg>',name:"redo",tipPosition:"nw"},{name:"|"},{icon:'<svg><use xlink:href="#vditor-icon-more"></use></svg>',name:"more",tipPosition:"e"},{hotkey:"⌘'",icon:'<svg><use xlink:href="#vditor-icon-fullscreen"></use></svg>',name:"fullscreen",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-edit"></use></svg>',name:"edit-mode",tipPosition:"nw"},{hotkey:"⌘P",icon:'<svg><use xlink:href="#vditor-icon-both"></use></svg>',name:"both",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-preview"></use></svg>',name:"preview",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-align-center"></use></svg>',name:"outline",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-theme"></use></svg>',name:"content-theme",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-code-theme"></use></svg>',name:"code-theme",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-bug"></use></svg>',name:"devtools",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-info"></use></svg>',name:"info",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-help"></use></svg>',name:"help",tipPosition:"nw"},{name:"br"}],o=[];return t.forEach(function(l){var E=l;a.forEach(function(L){typeof l=="string"&&L.name===l&&(E=L),typeof l=="object"&&L.name===l.name&&(E=Object.assign({},L,l))}),l.toolbar&&(E.toolbar=i.mergeToolbar(l.toolbar)),o.push(E)}),o},e}(),Ws=function(){function e(t){var i=this;this.composingLock=!1,this.commentIds=[];var a=document.createElement("div");a.className="vditor-wysiwyg",a.innerHTML='<pre class="vditor-reset" placeholder="'.concat(t.options.placeholder,`"
 contenteditable="true" spellcheck="false"></pre>
<div class="vditor-panel vditor-panel--none"></div>
<div class="vditor-panel vditor-panel--none">
    <button type="button" aria-label="`).concat(window.VditorI18n.comment,`" class="vditor-icon vditor-tooltipped vditor-tooltipped__n">
        <svg><use xlink:href="#vditor-icon-comment"></use></svg>
    </button>
</div>`),this.element=a.firstElementChild,this.popover=a.firstElementChild.nextElementSibling,this.selectPopover=a.lastElementChild,this.bindEvent(t),Bi(t,this.element),Lr(t,this.element),zi(t,this.element),Vi(t,this.element),qi(t,this.element),$i(t,this.element),Fi(t,this.element,this.copy),Ui(t,this.element,this.copy),t.options.comment.enable&&(this.selectPopover.querySelector("button").onclick=function(){var o=Lute.NewNodeID(),l=getSelection().getRangeAt(0),E=l.cloneRange(),L=l.extractContents(),D,A,P=!1,F=!1;L.childNodes.forEach(function(te,Ce){var he=!1;if(te.nodeType===3?he=!0:te.classList.contains("vditor-comment")?te.classList.contains("vditor-comment")&&te.setAttribute("data-cmtids",te.getAttribute("data-cmtids")+" "+o):he=!0,he)if(te.nodeType!==3&&te.getAttribute("data-block")==="0"&&Ce===0&&E.startOffset>0)te.innerHTML='<span class="vditor-comment" data-cmtids="'.concat(o,'">').concat(te.innerHTML,"</span>"),D=te;else if(te.nodeType!==3&&te.getAttribute("data-block")==="0"&&Ce===L.childNodes.length-1&&E.endOffset<E.endContainer.textContent.length)te.innerHTML='<span class="vditor-comment" data-cmtids="'.concat(o,'">').concat(te.innerHTML,"</span>"),A=te;else if(te.nodeType!==3&&te.getAttribute("data-block")==="0")Ce===0?P=!0:Ce===L.childNodes.length-1&&(F=!0),te.innerHTML='<span class="vditor-comment" data-cmtids="'.concat(o,'">').concat(te.innerHTML,"</span>");else{var Q=document.createElement("span");Q.classList.add("vditor-comment"),Q.setAttribute("data-cmtids",o),te.parentNode.insertBefore(Q,te),Q.appendChild(te)}});var le=(0,v.pt)(E.startContainer);le&&(D?(le.insertAdjacentHTML("beforeend",D.innerHTML),D.remove()):le.textContent.trim().replace(f.Y.ZWSP,"")===""&&P&&le.remove());var oe=(0,v.pt)(E.endContainer);oe&&(A?(oe.insertAdjacentHTML("afterbegin",A.innerHTML),A.remove()):oe.textContent.trim().replace(f.Y.ZWSP,"")===""&&F&&oe.remove()),l.insertNode(L),t.options.comment.add(o,l.toString(),i.getComments(t,!0)),ye(t,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),i.hideComment()})}return e.prototype.getComments=function(t,i){var a=this;if(i===void 0&&(i=!1),t.currentMode==="wysiwyg"&&t.options.comment.enable){this.commentIds=[],this.element.querySelectorAll(".vditor-comment").forEach(function(l){a.commentIds=a.commentIds.concat(l.getAttribute("data-cmtids").split(" "))}),this.commentIds=Array.from(new Set(this.commentIds));var o=[];if(i)return this.commentIds.forEach(function(l){o.push({id:l,top:a.element.querySelector('.vditor-comment[data-cmtids="'.concat(l,'"]')).offsetTop})}),o}else return[]},e.prototype.triggerRemoveComment=function(t){var i=function(l,E){var L=new Set(E);return l.filter(function(D){return!L.has(D)})};if(t.currentMode==="wysiwyg"&&t.options.comment.enable&&t.wysiwyg.commentIds.length>0){var a=JSON.parse(JSON.stringify(this.commentIds));this.getComments(t);var o=i(a,this.commentIds);o.length>0&&t.options.comment.remove(o)}},e.prototype.showComment=function(){var t=(0,j.Ey)(this.element);this.selectPopover.setAttribute("style","left:".concat(t.left,"px;display:block;top:").concat(Math.max(-8,t.top-21),"px"))},e.prototype.hideComment=function(){this.selectPopover.setAttribute("style","display:none")},e.prototype.unbindListener=function(){window.removeEventListener("scroll",this.scrollListener)},e.prototype.copy=function(t,i){var a=getSelection().getRangeAt(0);if(a.toString()!==""){t.stopPropagation(),t.preventDefault();var o=(0,v._Y)(a.startContainer,"CODE"),l=(0,v._Y)(a.endContainer,"CODE");if(o&&l&&l.isSameNode(o)){var E="";o.parentElement.tagName==="PRE"?E=a.toString():E="`"+a.toString()+"`",t.clipboardData.setData("text/plain",E),t.clipboardData.setData("text/html","");return}var L=(0,v._Y)(a.startContainer,"A"),D=(0,v._Y)(a.endContainer,"A");if(L&&D&&D.isSameNode(L)){var A=L.getAttribute("title")||"";A&&(A=' "'.concat(A,'"')),t.clipboardData.setData("text/plain","[".concat(a.toString(),"](").concat(L.getAttribute("href")).concat(A,")")),t.clipboardData.setData("text/html","");return}var P=document.createElement("div");P.appendChild(a.cloneContents()),t.clipboardData.setData("text/plain",i.lute.VditorDOM2Md(P.innerHTML).trim()),t.clipboardData.setData("text/html","")}},e.prototype.bindEvent=function(t){var i=this;this.unbindListener(),window.addEventListener("scroll",this.scrollListener=function(){if(M(t,["hint"]),!(i.popover.style.display!=="block"||i.selectPopover.style.display!=="block")){var a=parseInt(i.popover.getAttribute("data-top"),10);if(t.options.height!=="auto"){if(t.options.toolbarConfig.pin&&t.toolbar.element.getBoundingClientRect().top===0){var o=Math.max(window.scrollY-t.element.offsetTop-8,Math.min(a-t.wysiwyg.element.scrollTop,i.element.clientHeight-21))+"px";i.popover.style.display==="block"&&(i.popover.style.top=o),i.selectPopover.style.display==="block"&&(i.selectPopover.style.top=o)}return}else if(!t.options.toolbarConfig.pin)return;var l=Math.max(a,window.scrollY-t.element.offsetTop-8)+"px";i.popover.style.display==="block"&&(i.popover.style.top=l),i.selectPopover.style.display==="block"&&(i.selectPopover.style.top=l)}}),this.element.addEventListener("scroll",function(){if(M(t,["hint"]),t.options.comment&&t.options.comment.enable&&t.options.comment.scroll&&t.options.comment.scroll(t.wysiwyg.element.scrollTop),i.popover.style.display==="block"){var a=parseInt(i.popover.getAttribute("data-top"),10)-t.wysiwyg.element.scrollTop,o=-8;t.options.toolbarConfig.pin&&t.toolbar.element.getBoundingClientRect().top===0&&(o=window.scrollY-t.element.offsetTop+o);var l=Math.max(o,Math.min(a,i.element.clientHeight-21))+"px";i.popover.style.top=l,i.selectPopover.style.top=l}}),this.element.addEventListener("paste",function(a){di(t,a,{pasteCode:function(o){var l=(0,j.RN)(t),E=document.createElement("template");E.innerHTML=o,l.insertNode(E.content.cloneNode(!0));var L=(0,v.Th)(l.startContainer,"data-block","0");L?L.outerHTML=t.lute.SpinVditorDOM(L.outerHTML):t.wysiwyg.element.innerHTML=t.lute.SpinVditorDOM(t.wysiwyg.element.innerHTML),(0,j.ir)(t.wysiwyg.element,l)}})}),this.element.addEventListener("compositionstart",function(){i.composingLock=!0}),this.element.addEventListener("compositionend",function(a){var o=(0,O.c)(getSelection().getRangeAt(0).startContainer);if(o&&o.textContent===""){ce(t);return}(0,u.gm)()||si(t,getSelection().getRangeAt(0).cloneRange(),a),i.composingLock=!1}),this.element.addEventListener("input",function(a){if(!(a.inputType==="deleteByDrag"||a.inputType==="insertFromDrop")){if(i.preventInput){i.preventInput=!1,ye(t);return}if(i.composingLock||a.data==="‘"||a.data==="“"||a.data==="《"){ye(t);return}var o=getSelection().getRangeAt(0),l=(0,v.pt)(o.startContainer);if(l||(Xt(t,o),l=(0,v.pt)(o.startContainer)),!!l){for(var E=(0,j.ED)(l,t.wysiwyg.element,o).start,L=!0,D=E-1;D>l.textContent.substr(0,E).lastIndexOf(`
`);D--)if(l.textContent.charAt(D)!==" "&&l.textContent.charAt(D)!=="	"){L=!1;break}E===0&&(L=!1);for(var A=!0,D=E-1;D<l.textContent.length;D++)if(l.textContent.charAt(D)!==" "&&l.textContent.charAt(D)!==`
`){A=!1;break}A&&/^#{1,6} $/.test(l.textContent)&&(A=!1);var P=(0,O.c)(getSelection().getRangeAt(0).startContainer);if(P&&P.textContent===""&&(ce(t),P.remove()),L&&l.getAttribute("data-type")!=="code-block"||A||Zi(l.innerHTML)||Gi(l.innerHTML)&&l.previousElementSibling){typeof t.options.input=="function"&&t.options.input(T(t));return}a.inputType==="insertParagraph"&&i.element.innerHTML==="<p><br></p><p><br></p>"&&l.previousElementSibling.remove(),si(t,o,a)}}}),this.element.addEventListener("click",function(a){if(a.target.tagName==="INPUT"){var o=a.target;o.checked?o.setAttribute("checked","checked"):o.removeAttribute("checked"),i.preventInput=!0,getSelection().rangeCount>0&&(0,j.jl)(getSelection().getRangeAt(0)),ye(t);return}if(a.target.tagName==="IMG"&&!a.target.parentElement.classList.contains("vditor-wysiwyg__preview")){a.target.getAttribute("data-type")==="link-ref"?Mt(t,a.target):Ve(a,t);return}var l=(0,v._Y)(a.target,"A");if(l){t.options.link.click?t.options.link.click(l):t.options.link.isOpen&&window.open(l.getAttribute("href")),a.preventDefault();return}var E=(0,j.RN)(t);if(a.target.isEqualNode(i.element)&&i.element.lastElementChild&&E.collapsed){var L=i.element.lastElementChild.getBoundingClientRect();a.y>L.top+L.height&&(i.element.lastElementChild.tagName==="P"&&i.element.lastElementChild.textContent.trim().replace(f.Y.ZWSP,"")===""?(E.selectNodeContents(i.element.lastElementChild),E.collapse(!1)):(i.element.insertAdjacentHTML("beforeend",'<p data-block="0">'.concat(f.Y.ZWSP,"<wbr></p>")),(0,j.ir)(i.element,E)))}ze(t);var D=(0,v.KJ)(a.target,"vditor-wysiwyg__preview");D||(D=(0,v.KJ)((0,j.RN)(t).startContainer,"vditor-wysiwyg__preview")),D&&Se(D,t),G(a,t)}),this.element.addEventListener("keyup",function(a){if(!(a.isComposing||(0,u._0)(a))){a.key==="Enter"&&vt(t),(a.key==="Backspace"||a.key==="Delete")&&t.wysiwyg.element.innerHTML!==""&&t.wysiwyg.element.childNodes.length===1&&t.wysiwyg.element.firstElementChild&&t.wysiwyg.element.firstElementChild.tagName==="P"&&t.wysiwyg.element.firstElementChild.childElementCount===0&&(t.wysiwyg.element.textContent===""||t.wysiwyg.element.textContent===`
`)&&(t.wysiwyg.element.innerHTML="");var o=(0,j.RN)(t);if(a.key==="Backspace"&&(0,u.gm)()&&o.startContainer.textContent===`
`&&o.startOffset===1&&(o.startContainer.textContent=""),Xt(t,o),ze(t),!(a.key!=="ArrowDown"&&a.key!=="ArrowRight"&&a.key!=="Backspace"&&a.key!=="ArrowLeft"&&a.key!=="ArrowUp")){(a.key==="ArrowLeft"||a.key==="ArrowRight")&&t.hint.render(t);var l=(0,v.KJ)(o.startContainer,"vditor-wysiwyg__preview");if(!l&&o.startContainer.nodeType!==3&&o.startOffset>0){var E=o.startContainer;E.classList.contains("vditor-wysiwyg__block")&&(l=E.lastElementChild)}if(l){var L=l.previousElementSibling;if(L.style.display==="none"){a.key==="ArrowDown"||a.key==="ArrowRight"?Se(l,t):Se(l,t,!1);return}var D=l.previousElementSibling;if(D.tagName==="PRE"&&(D=D.firstElementChild),a.key==="ArrowDown"||a.key==="ArrowRight"){var E=l.parentElement,A=wt(E);if(A&&A.nodeType!==3){var P=A.querySelector(".vditor-wysiwyg__preview");if(P){Se(P,t);return}}if(A.nodeType===3){for(;A.textContent.length===0&&A.nextSibling;)A=A.nextSibling;o.setStart(A,1)}else o.setStart(A.firstChild,0)}else o.selectNodeContents(D),o.collapse(!1)}}}})},e}(),Ys=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Ks=function(e){Ys(t,e);function t(i,a){var o=e.call(this)||this;if(o.version=f.g,typeof i=="string"){if(a?a.cache?a.cache.id||(a.cache.id="vditor".concat(i)):a.cache={id:"vditor".concat(i)}:a={cache:{id:"vditor".concat(i)}},!document.getElementById(i))return o.showErrorTip("Failed to get element by id: ".concat(i)),o;i=document.getElementById(i)}var l=new qs(a),E=l.merge();if(E.i18n)window.VditorI18n=E.i18n,o.init(i,E);else if(["en_US","fr_FR","pt_BR","ja_JP","ko_KR","ru_RU","sv_SE","zh_CN","zh_TW"].includes(E.lang)){var L="vditorI18nScript",D=L+E.lang;document.querySelectorAll('head script[id^="'.concat(L,'"]')).forEach(function(A){A.id!==D&&document.head.removeChild(A)}),(0,C.Z)("".concat(E.cdn,"/dist/js/i18n/").concat(E.lang,".js"),D).then(function(){o.init(i,E)}).catch(function(A){o.showErrorTip("GET ".concat(E.cdn,"/dist/js/i18n/").concat(E.lang,".js net::ERR_ABORTED 404 (Not Found)"))})}else throw new Error("options.lang error, see https://ld246.com/article/1549638745630#options");return o}return t.prototype.showErrorTip=function(i){var a=new na;document.body.appendChild(a.element),a.show(i,0)},t.prototype.updateToolbarConfig=function(i){this.vditor.toolbar.updateConfig(this.vditor,i)},t.prototype.setTheme=function(i,a,o,l){this.vditor.options.theme=i,Ze(this.vditor),a&&(this.vditor.options.preview.theme.current=a,(0,ge.H)(a,l||this.vditor.options.preview.theme.path)),o&&(this.vditor.options.preview.hljs.style=o,(0,ia.h)(o,this.vditor.options.cdn))},t.prototype.getValue=function(){return T(this.vditor)},t.prototype.getCurrentMode=function(){return this.vditor.currentMode},t.prototype.focus=function(){this.vditor.currentMode==="sv"?this.vditor.sv.element.focus():this.vditor.currentMode==="wysiwyg"?this.vditor.wysiwyg.element.focus():this.vditor.currentMode==="ir"&&this.vditor.ir.element.focus()},t.prototype.blur=function(){this.vditor.currentMode==="sv"?this.vditor.sv.element.blur():this.vditor.currentMode==="wysiwyg"?this.vditor.wysiwyg.element.blur():this.vditor.currentMode==="ir"&&this.vditor.ir.element.blur()},t.prototype.disabled=function(){M(this.vditor,["subToolbar","hint","popover"]),b(this.vditor.toolbar.elements,f.Y.EDIT_TOOLBARS.concat(["undo","redo","fullscreen","edit-mode"])),this.vditor[this.vditor.currentMode].element.setAttribute("contenteditable","false")},t.prototype.enable=function(){w(this.vditor.toolbar.elements,f.Y.EDIT_TOOLBARS.concat(["undo","redo","fullscreen","edit-mode"])),this.vditor.undo.resetIcon(this.vditor),this.vditor[this.vditor.currentMode].element.setAttribute("contenteditable","true")},t.prototype.getSelection=function(){if(this.vditor.currentMode==="wysiwyg")return Un(this.vditor.wysiwyg.element);if(this.vditor.currentMode==="sv")return Un(this.vditor.sv.element);if(this.vditor.currentMode==="ir")return Un(this.vditor.ir.element)},t.prototype.renderPreview=function(i){this.vditor.preview.render(this.vditor,i)},t.prototype.getCursorPosition=function(){return(0,j.Ey)(this.vditor[this.vditor.currentMode].element)},t.prototype.isUploading=function(){return this.vditor.upload.isUploading},t.prototype.clearCache=function(){this.vditor.options.cache.enable&&(0,u.D)()&&localStorage.removeItem(this.vditor.options.cache.id)},t.prototype.disabledCache=function(){this.vditor.options.cache.enable=!1},t.prototype.enableCache=function(){if(!this.vditor.options.cache.id)throw new Error("need options.cache.id, see https://ld246.com/article/1549638745630#options");this.vditor.options.cache.enable=!0},t.prototype.html2md=function(i){return this.vditor.lute.HTML2Md(i)},t.prototype.exportJSON=function(i){return this.vditor.lute.RenderJSON(i)},t.prototype.getHTML=function(){return ea(this.vditor)},t.prototype.tip=function(i,a){this.vditor.tip.show(i,a)},t.prototype.setPreviewMode=function(i){Ji(i,this.vditor)},t.prototype.deleteValue=function(){window.getSelection().isCollapsed||document.execCommand("delete",!1)},t.prototype.updateValue=function(i){document.execCommand("insertHTML",!1,i)},t.prototype.insertValue=function(i,a){a===void 0&&(a=!0);var o=(0,j.RN)(this.vditor);o.collapse(!0);var l=document.createElement("template");l.innerHTML=i,o.insertNode(l.content.cloneNode(!0)),o.collapse(!1),this.vditor.currentMode==="sv"?(this.vditor.sv.preventInput=!0,a&&Be(this.vditor)):this.vditor.currentMode==="wysiwyg"?a&&si(this.vditor,getSelection().getRangeAt(0)):this.vditor.currentMode==="ir"&&(this.vditor.ir.preventInput=!0,a&&Z(this.vditor,getSelection().getRangeAt(0),!0))},t.prototype.insertMD=function(i){this.vditor.currentMode==="ir"?(0,j.Z2)(this.vditor.lute.Md2VditorIRDOM(i),this.vditor):this.vditor.currentMode==="wysiwyg"?(0,j.Z2)(this.vditor.lute.Md2VditorDOM(i),this.vditor):Wi(this.vditor,i),this.vditor.outline.render(this.vditor),Ke(this.vditor)},t.prototype.setValue=function(i,a){var o=this;a===void 0&&(a=!1),this.vditor.currentMode==="sv"?(this.vditor.sv.element.innerHTML="<div data-block='0'>".concat(this.vditor.lute.SpinVditorSVDOM(i),"</div>"),St(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})):this.vditor.currentMode==="wysiwyg"?Bt(this.vditor,i,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}):(this.vditor.ir.element.innerHTML=this.vditor.lute.Md2VditorIRDOM(i),this.vditor.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach(function(l){$e(l,o.vditor)}),nn(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})),this.vditor.outline.render(this.vditor),i||(M(this.vditor,["emoji","headings","submenu","hint"]),this.vditor.wysiwyg.popover&&(this.vditor.wysiwyg.popover.style.display="none"),this.clearCache()),a&&this.clearStack()},t.prototype.insertEmptyBlock=function(i){Vn(this.vditor,i)},t.prototype.clearStack=function(){this.vditor.undo.clearStack(this.vditor),this.vditor.undo.addToUndoStack(this.vditor)},t.prototype.destroy=function(){this.vditor.element.innerHTML=this.vditor.originalInnerHTML,this.vditor.element.classList.remove("vditor"),this.vditor.element.removeAttribute("style");var i=document.getElementById("vditorIconScript");i&&i.remove(),this.clearCache(),X(),this.vditor.wysiwyg.unbindListener()},t.prototype.getCommentIds=function(){return this.vditor.currentMode!=="wysiwyg"?[]:this.vditor.wysiwyg.getComments(this.vditor,!0)},t.prototype.hlCommentIds=function(i){if(this.vditor.currentMode==="wysiwyg"){var a=function(o){o.classList.remove("vditor-comment--hover"),i.forEach(function(l){o.getAttribute("data-cmtids").indexOf(l)>-1&&o.classList.add("vditor-comment--hover")})};this.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(o){a(o)}),this.vditor.preview.element.style.display!=="none"&&this.vditor.preview.element.querySelectorAll(".vditor-comment").forEach(function(o){a(o)})}},t.prototype.unHlCommentIds=function(i){if(this.vditor.currentMode==="wysiwyg"){var a=function(o){i.forEach(function(l){o.getAttribute("data-cmtids").indexOf(l)>-1&&o.classList.remove("vditor-comment--hover")})};this.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(o){a(o)}),this.vditor.preview.element.style.display!=="none"&&this.vditor.preview.element.querySelectorAll(".vditor-comment").forEach(function(o){a(o)})}},t.prototype.removeCommentIds=function(i){var a=this;if(this.vditor.currentMode==="wysiwyg"){var o=function(l,E){var L=l.getAttribute("data-cmtids").split(" ");L.find(function(D,A){if(D===E)return L.splice(A,1),!0}),L.length===0?(l.outerHTML=l.innerHTML,(0,j.RN)(a.vditor).collapse(!0)):l.setAttribute("data-cmtids",L.join(" "))};i.forEach(function(l){a.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(E){o(E,l)}),a.vditor.preview.element.style.display!=="none"&&a.vditor.preview.element.querySelectorAll(".vditor-comment").forEach(function(E){o(E,l)})}),ye(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})}},t.prototype.init=function(i,a){var o=this;this.vditor={currentMode:a.mode,element:i,hint:new jo(a.hint.extend),lute:void 0,options:a,originalInnerHTML:i.innerHTML,outline:new $o(window.VditorI18n.outline),tip:new na},this.vditor.sv=new qo(this.vditor),this.vditor.undo=new Us,this.vditor.wysiwyg=new Ws(this.vditor),this.vditor.ir=new Bo(this.vditor),this.vditor.toolbar=new $s(this.vditor),a.resize.enable&&(this.vditor.resize=new Vo(this.vditor)),this.vditor.toolbar.elements.devtools&&(this.vditor.devtools=new d),(a.upload.url||a.upload.handler)&&(this.vditor.upload=new _o),(0,C.Z)(a._lutePath||"".concat(a.cdn,"/dist/js/lute/lute.min.js"),"vditorLuteScript").then(function(){o.vditor.lute=(0,zo.X)({autoSpace:o.vditor.options.preview.markdown.autoSpace,gfmAutoLink:o.vditor.options.preview.markdown.gfmAutoLink,codeBlockPreview:o.vditor.options.preview.markdown.codeBlockPreview,emojiSite:o.vditor.options.hint.emojiPath,emojis:o.vditor.options.hint.emoji,fixTermTypo:o.vditor.options.preview.markdown.fixTermTypo,footnotes:o.vditor.options.preview.markdown.footnotes,headingAnchor:!1,inlineMathDigit:o.vditor.options.preview.math.inlineDigit,linkBase:o.vditor.options.preview.markdown.linkBase,linkPrefix:o.vditor.options.preview.markdown.linkPrefix,listStyle:o.vditor.options.preview.markdown.listStyle,mark:o.vditor.options.preview.markdown.mark,mathBlockPreview:o.vditor.options.preview.markdown.mathBlockPreview,paragraphBeginningSpace:o.vditor.options.preview.markdown.paragraphBeginningSpace,sanitize:o.vditor.options.preview.markdown.sanitize,toc:o.vditor.options.preview.markdown.toc}),o.vditor.preview=new Uo(o.vditor),lt(o.vditor),a.after&&a.after(),a.icon&&(0,C.U)("".concat(a.cdn,"/dist/js/icons/").concat(a.icon,".js"),"vditorIconScript")})},t}(p.default);const Gs=Ks})(),h=h.default,h})())}(Ri)),Ri.exports}var Ql=Jl();const ni=Zl(Ql),ec=Dt({__name:"VditorEditor",props:{modelValue:{type:String,default:""},theme:{type:String,default:"classic"}},emits:["update:modelValue"],setup(k,{expose:n,emit:r}){const s=k,c=r,h=ee();let p=null;const f={mode:"ir",height:"auto",minHeight:140,resize:{enable:!0,position:"bottom"},icon:"ant",lang:"zh_CN",theme:"classic",toolbar:["emoji","headings","bold","italic","strike","link","|","list","ordered-list","check","|","quote","line","code","inline-code","|","preview","fullscreen"],toolbarConfig:{pin:!0,hideTooltip:!0},counter:{enable:!1},cache:{enable:!0,id:"vue-vditor"},input:y=>{c("update:modelValue",y)},preview:{hljs:{style:"native"},markdown:{listStyle:!0,mark:!0},actions:[]},placeholder:"灵感记录~"};return Wt(async()=>{h.value&&(p=new ni(h.value,{...f,after:()=>{p==null||p.setValue(s.modelValue),p==null||p.setTheme(s.theme==="dark"?"dark":"classic")}}))}),ai(()=>{try{p&&(p.destroy(),p=null)}catch(y){console.warn("Vditor destroy error",y)}}),n({clear:()=>{p&&(p.setValue(""),c("update:modelValue",""))},insertValue:y=>{p&&(p.insertValue(y),c("update:modelValue",p.getValue()))}}),gt(()=>s.theme,y=>{p&&p.setTheme(y==="dark"?"dark":"classic")}),(y,T)=>(ie(),de("div",{ref_key:"editorContainer",ref:h,class:"vditor-container"},null,512))}}),tc={class:"bg-gray-800 p-6 rounded-lg"},nc={class:"space-y-4"},ic={class:"flex justify-end gap-2"},rc=Dt({__name:"Searchmode",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","search-result"],setup(k,{expose:n,emit:r}){const s=Ye(),h=$n().public.baseApi||"/api",p=k,f=r,y=Me({get:()=>p.modelValue,set:u=>f("update:modelValue",u)}),T=()=>{f("update:modelValue",!1)},C=ee(""),d=async()=>{var u,m;if(!C.value.trim()){s.add({title:"提示",description:"请输入搜索关键词",color:"yellow"});return}try{const{data:g,error:w}=await xl("/messages/search",{method:"GET",baseURL:h,params:{keyword:C.value,page:1,pageSize:10}},"$4cD5OWGgav");if(w.value)throw new Error(((u=w.value)==null?void 0:u.message)||"网络请求失败");if(!g.value)throw new Error("未收到服务器响应");if(g.value.code===1)f("search-result",g.value),f("update:modelValue",!1),C.value="",s.add({title:"成功",description:"搜索完成",color:"green"});else throw new Error(((m=g.value)==null?void 0:m.msg)||"搜索失败")}catch(g){console.error("Search error:",g),s.add({title:"错误",description:g instanceof Error?g.message:"搜索失败，请稍后重试",color:"red"})}};return n({handleSearch:d}),(u,m)=>{const g=Tr,w=Gt,b=Ga;return ie(),qt(b,{modelValue:y.value,"onUpdate:modelValue":m[1]||(m[1]=S=>y.value=S)},{default:dt(()=>[q("div",tc,[m[4]||(m[4]=q("h3",{class:"text-xl font-semibold text-white mb-4"},"搜索内容",-1)),q("div",nc,[ve(g,{modelValue:C.value,"onUpdate:modelValue":m[0]||(m[0]=S=>C.value=S),placeholder:"输入搜索关键词",class:"w-full",onKeyup:Ya(d,["enter"])},null,8,["modelValue"]),q("div",ic,[ve(w,{variant:"solid",color:"gray",onClick:T,class:"bg-gray-700 hover:bg-gray-700 text-white hover:text-white border border-gray-600"},{default:dt(()=>m[2]||(m[2]=[Tt(" 取消 ")])),_:1}),ve(w,{color:"primary",onClick:d,class:"text-white hover:text-white"},{default:dt(()=>m[3]||(m[3]=[Tt(" 搜索 ")])),_:1})])])])]),_:1},8,["modelValue"])}}}),yo=cn(rc,[["__scopeId","data-v-e473120d"]]),ac=qa("notify",{state:()=>({config:{webhookEnabled:!1,webhookURL:"",telegramEnabled:!1,telegramToken:"",telegramChatID:"",weworkEnabled:!1,weworkKey:"",feishuEnabled:!1,feishuWebhook:"",feishuSecret:"",twitterEnabled:!1,twitterApiKey:"",twitterApiSecret:"",twitterAccessToken:"",twitterAccessTokenSecret:"",customHttpEnabled:!1,customHttpUrl:"",customHttpMethod:"POST",customHttpHeaders:"",customHttpBody:'{"content":"{{content}}"}'}}),actions:{async fetchConfig(){try{const n=await(await fetch("/api/notify/config",{credentials:"include"})).json();n.code===1&&(this.config=n.data)}catch(k){console.error("获取推送配置失败:",k)}},async saveConfig(k){try{const r=await(await fetch("/api/notify/config",{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)})).json();if(r.code===1){const s=r.data||k;return Object.keys(this.config).forEach(c=>{c.endsWith("Enabled")?this.config[c]=!!s[c]&&s[c]!=="false":s[c]!==void 0&&(this.config[c]=s[c])}),!0}return!1}catch(n){return console.error("保存推送配置失败:",n),!1}},async testNotify(k){try{return(await(await fetch("/api/notify/test",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:k})})).json()).code===1}catch(n){return console.error("测试推送失败:",n),!1}},async sendNotify(k){try{let n=k.content;return k.images&&k.images.length>0&&(n+=`

`,k.images.forEach(c=>{n+=`![](${c})
`})),(await(await fetch("/api/notify/send",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:n,format:k.format||"markdown",config:this.config})})).json()).code===1}catch(n){return console.error("发送推送失败:",n),!1}}}}),oc=Dt({__name:"VideoUpload",emits:["video-uploaded","upload-progress"],setup(k,{emit:n}){const r=n,s=ee(null),c=Ye(),h=$n().public.baseApi||"/api",p=()=>{var y;(y=s.value)==null||y.click()},f=async y=>{const T=y.target,C=T.files?T.files[0]:null;if(!C){c.add({title:"错误",description:"未选择视频",color:"red"});return}const d=200*1024*1024;if(C.size>d){c.add({title:"错误",description:"视频不能超过200MB",color:"red"});return}const u=new FormData;u.append("video",C);const m=new XMLHttpRequest;m.open("POST",`${h}/videos/upload`,!0),m.withCredentials=!0,m.upload.onprogress=g=>{if(g.lengthComputable){const w=Math.round(g.loaded/g.total*100);r("upload-progress",w)}},m.onload=()=>{if(m.status===200)try{const g=JSON.parse(m.responseText);if(g.code===1&&g.data)r("video-uploaded",g.data),c.add({title:"成功",description:"视频上传成功",color:"green"});else throw new Error(g.msg||"视频上传失败")}catch(g){c.add({title:"错误",description:g.message||"视频上传失败",color:"red"})}else c.add({title:"错误",description:"视频上传失败",color:"red"});r("upload-progress",0),s.value&&(s.value.value="")},m.onerror=()=>{c.add({title:"错误",description:"视频上传失败",color:"red"}),r("upload-progress",0),s.value&&(s.value.value="")},m.send(u)};return(y,T)=>{const C=Gt;return ie(),de("div",null,[q("input",{ref_key:"videoInput",ref:s,type:"file",accept:"video/*",class:"hidden",onChange:f},null,544),ve(C,{color:"gray",variant:"solid",size:"sm",icon:"i-mdi-video",class:"cursor-pointer",onClick:p,title:"上传视频"})])}}}),jn=Ua(ii.ui.strategy,ii.ui.progress,Ml),sc=Dt({inheritAttrs:!1,props:{value:{type:Number,default:null},max:{type:[Number,Array],default:100},indicator:{type:Boolean,default:!1},animation:{type:String,default:()=>jn.default.animation,validator(k){return Object.keys(jn.animation).includes(k)}},size:{type:String,default:()=>jn.default.size,validator(k){return Object.keys(jn.progress.size).includes(k)}},color:{type:String,default:()=>jn.default.color,validator(k){return ii.ui.colors.includes(k)}},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(k){const{ui:n,attrs:r}=Va("progress",Ii(k,"ui"),jn,Ii(k,"class")),s=Me(()=>pn(n.value.indicator.container.base,n.value.indicator.container.width,n.value.indicator.container.transition)),c=Me(()=>pn(n.value.indicator.align,n.value.indicator.width,n.value.indicator.color,n.value.indicator.size[k.size])),h=Me(()=>{var _;const S=[n.value.progress.base,n.value.progress.width,n.value.progress.size[k.size],n.value.progress.rounded,n.value.progress.track,n.value.progress.bar,(_=n.value.progress.color)==null?void 0:_.replaceAll("{color}",k.color),n.value.progress.background,n.value.progress.indeterminate.base,n.value.progress.indeterminate.rounded];return m.value&&S.push(n.value.animation[k.animation]),pn(...S)}),p=Me(()=>{var S;return pn(n.value.steps.base,(S=n.value.steps.color)==null?void 0:S.replaceAll("{color}",k.color),n.value.steps.size[k.size])}),f=Me(()=>pn(n.value.step.base,n.value.step.align)),y=Me(()=>pn(n.value.step.active)),T=Me(()=>pn(n.value.step.first));function C(S){return S===Number(k.value)}function d(S){return S===0}function u(S){S=Number(S);const _=[f.value];return d(S)&&_.push(T.value),C(S)&&_.push(y.value),_.join(" ")}const m=Me(()=>k.value===void 0||k.value===null),g=Me(()=>Array.isArray(k.max)),w=Me(()=>m.value?null:Array.isArray(k.max)?k.max.length-1:Number(k.max)),b=Me(()=>{if(!m.value)switch(!0){case k.value<0:return 0;case k.value>w.value:return 100;default:return k.value/w.value*100}});return{ui:n,attrs:r,indicatorContainerClass:s,indicatorClass:c,progressClass:h,stepsClass:p,stepClasses:u,isIndeterminate:m,isSteps:g,realMax:w,percent:b}}}),lc=["aria-valuemax","aria-valuenow"];function cc(k,n,r,s,c,h){return ie(),de("div",{class:Fe(k.ui.wrapper),role:"progressbar"},[k.indicator||k.$slots.indicator?br(k.$slots,"indicator",cl(Oi({key:0},{percent:k.percent})),()=>[k.isSteps?He("",!0):(ie(),de("div",{key:0,class:Fe(k.indicatorContainerClass),style:xn({width:`${k.percent}%`})},[q("div",{class:Fe(k.indicatorClass)},Qe(Math.round(k.percent))+"% ",3)],6))],!0):He("",!0),q("progress",Oi({"aria-valuemax":k.realMax,"aria-valuenow":k.value,class:k.progressClass},{value:k.value,max:k.realMax,...k.attrs}),Qe(k.percent!==void 0?`${Math.round(k.percent)}%`:void 0),17,lc),k.isSteps?(ie(),de("div",{key:1,class:Fe(k.stepsClass)},[(ie(!0),de(Ht,null,Vt(k.max,(p,f)=>(ie(),de("div",{key:f,class:Fe(k.stepClasses(f))},[br(k.$slots,`step-${f}`,Oi({ref_for:!0},{step:p}),()=>[Tt(Qe(p),1)],!0)],2))),128))],2)):He("",!0)],2)}const uc=cn(sc,[["render",cc],["__scopeId","data-v-157fbd8e"]]),dc={class:"flex justify-between items-center mb-3"},fc={class:"mb-4"},hc={class:"flex gap-2 mb-3"},pc={key:0,class:"space-y-2 mb-3"},mc={class:"flex items-center gap-2"},gc={class:"flex justify-end mt-2 mb-3"},vc=["src"],yc={key:3,class:"text-sm text-gray-300"},bc={key:4,class:"text-sm text-gray-300"},wc={key:1,class:"flex justify-end mt-2"},Ec={key:2,class:"mt-2 text-red-400 text-sm"},Sc={key:3,class:"mt-2"},Cc={class:"flex items-center gap-2 bg-gray-800 p-2 rounded"},kc=["value"],Tc={class:"flex justify-end mt-2"},xc=Dt({__name:"ImageHostingUploader",props:{position:{type:Object,required:!0,default:()=>({x:0,y:0})},editorRef:{type:Object,required:!1,default:null}},emits:["close","upload-success"],setup(k,{emit:n}){const r=k,s=Me(()=>{if(typeof window>"u")return{};const ce=window.innerWidth,G=window.innerHeight,W=400,Z=500;let B=r.position.x,ae=r.position.y;return B+W>ce&&(B=ce-W-20),B<0&&(B=20),ae+Z>G&&(ae=G-Z-20),ae<0&&(ae=20),ce<768&&(B=(ce-W)/2,ae=60),{position:"fixed",top:`${ae}px`,left:`${B}px`,maxWidth:`${Math.min(W,ce-40)}px`,width:"100%",cursor:"move",userSelect:"none",touchAction:"none"}}),c=ee(!1),h=ee({x:0,y:0}),p=ce=>{c.value=!0;const G="touches"in ce?ce.touches[0].clientX:ce.clientX,W="touches"in ce?ce.touches[0].clientY:ce.clientY;h.value={x:G-r.position.x,y:W-r.position.y},document.addEventListener("mousemove",f),document.addEventListener("touchmove",f),document.addEventListener("mouseup",y),document.addEventListener("touchend",y)},f=ce=>{if(!c.value)return;const G="touches"in ce?ce.touches[0].clientX:ce.clientX,W="touches"in ce?ce.touches[0].clientY:ce.clientY;T("update:position",{x:G-h.value.x,y:W-h.value.y})},y=()=>{c.value=!1,document.removeEventListener("mousemove",f),document.removeEventListener("touchmove",f),document.removeEventListener("mouseup",y),document.removeEventListener("touchend",y)},T=n,C=Ye(),d=ee("smms"),u=ee(null),m=ee(!1),g=ee(!1),w=ee(0),b=ee(""),S=ee(""),_=ee(""),M=ee(""),x=ee(""),v=ee("main"),O=ee("images/"),H=ee(!1),z=ee(""),I=ee(""),R=ee(""),N=()=>{var ce;(ce=u.value)==null||ce.click()},V=ce=>{var W;m.value=!1;const G=(W=ce.dataTransfer)==null?void 0:W.files;G&&G.length>0&&ke(G[0])},se=ce=>{const W=ce.target.files;W&&W.length>0&&ke(W[0])},ue=ee(null),ke=async ce=>{if(!ce.type.startsWith("image/")){_.value="请选择图片文件";return}const G=5*1024*1024;if(ce.size>G){_.value="图片大小不能超过 5MB";return}_.value="",ue.value=ce;const W=new FileReader;W.onload=Z=>{var B;b.value=(B=Z.target)==null?void 0:B.result},W.readAsDataURL(ce)},Re=()=>{if(!S.value){_.value="请先上传图片";return}const ce=`![](${S.value})`;T("upload-success",ce),T("close"),ue.value=null,b.value="",S.value="",w.value=0,g.value=!1,_.value=""},_e=async ce=>{try{await navigator.clipboard.writeText(ce),C.add({title:"成功",description:"已复制到剪贴板",color:"green",timeout:2e3})}catch{C.add({title:"错误",description:"复制失败",color:"red",timeout:2e3})}},Te=async()=>{if(!ue.value){_.value="请先选择图片";return}g.value=!0,w.value=0,_.value="";try{switch(d.value){case"github":await Ne(ue.value);break;default:throw new Error("未知的图床类型")}}catch(ce){console.error("上传错误:",ce),_.value=ce.message||"上传失败",g.value=!1,ce.name==="AbortError"?_.value="请求超时，请检查网络连接":ce.message.includes("Failed to fetch")&&(_.value="网络请求失败，可能是跨域问题或API不可用")}},Ne=async ce=>{if(!M.value||!x.value){_.value="请先配置 GitHub Token 和仓库名";return}try{w.value=30;const G=Date.now(),W=ce.name.split(".").pop(),Z=`${G}.${W}`,B=`${O.value}${Z}`.replace(/\/\//g,"/"),ae=await Oe(ce),K={message:`Upload image ${Z}`,content:ae,branch:v.value||"main"};w.value=50;const $=await fetch(`https://api.github.com/repos/${x.value}/contents/${B}`,{method:"PUT",headers:{Authorization:`token ${M.value}`,"Content-Type":"application/json"},body:JSON.stringify(K)});if(w.value=80,!$.ok)throw new Error(`GitHub 上传失败: ${$.status}`);const xe=await $.json();S.value=H.value&&z.value?`https://${z.value}/gh/${x.value}@${v.value||"main"}/${B}`:xe.content.download_url,w.value=100,g.value=!1,C.add({title:"成功",description:`图片已上传到 GitHub${H.value&&z.value?" (CDN加速)":""}`,color:"green",timeout:2e3})}catch(G){console.error("GitHub 上传错误:",G),_.value=G.message||"GitHub 上传失败",g.value=!1}},Oe=ce=>new Promise((G,W)=>{const Z=new FileReader;Z.onload=()=>G(Z.result.split(",")[1]),Z.onerror=W,Z.readAsDataURL(ce)}),$e=()=>{try{const ce={selectedHost:d.value,github:{token:M.value,repo:x.value,branch:v.value,path:O.value,enableCDN:H.value,cdnDomain:z.value},smms:{token:I.value},freeimage:{token:R.value}};localStorage.setItem("imageHostingConfig",JSON.stringify(ce)),C.add({title:"成功",description:"配置已保存",color:"green",timeout:2e3})}catch(ce){console.error("保存配置失败:",ce),C.add({title:"错误",description:"保存配置失败",color:"red",timeout:2e3})}},j=()=>{const ce=localStorage.getItem("imageHostingConfig");if(ce)try{const G=JSON.parse(ce);d.value=G.selectedHost||"smms",G.github&&(M.value=G.github.token||"",x.value=G.github.repo||"",v.value=G.github.branch||"main",O.value=G.github.path||"images/",H.value=G.github.enableCDN||!1,z.value=G.github.cdnDomain||""),G.smms&&(I.value=G.smms.token||""),G.imgtp&&(imgtpToken.value=G.imgtp.token||""),G.freeimage&&(R.value=G.freeimage.token||"")}catch(G){console.error("加载配置失败:",G)}};return gt([d,M,x,v,O,I],()=>{$e()},{deep:!0}),Wt(()=>{j()}),(ce,G)=>{const W=Gt,Z=Tr,B=fl,ae=Fn,K=uc;return ie(),de("div",{class:"fixed z-[5000] bg-black/80 backdrop-blur-sm rounded-lg shadow-lg p-4 text-white",style:xn(s.value),onMousedown:p,onTouchstart:p},[q("div",dc,[G[11]||(G[11]=q("h3",{class:"text-lg font-medium"},"图床上传",-1)),ve(W,{icon:"i-heroicons-x-mark",color:"gray",variant:"ghost",size:"xs",onClick:G[0]||(G[0]=$=>ce.$emit("close"))})]),q("div",fc,[q("div",hc,[ve(W,{color:d.value==="github"?"blue":"gray",variant:"solid",size:"sm",onClick:G[1]||(G[1]=$=>d.value="github")},{default:dt(()=>G[12]||(G[12]=[Tt(" GitHub ")])),_:1},8,["color"])]),d.value==="github"?(ie(),de("div",pc,[ve(Z,{modelValue:M.value,"onUpdate:modelValue":G[2]||(G[2]=$=>M.value=$),placeholder:"GitHub Token",size:"sm",type:"password"},null,8,["modelValue"]),ve(Z,{modelValue:x.value,"onUpdate:modelValue":G[3]||(G[3]=$=>x.value=$),placeholder:"仓库名 (用户名/仓库)",size:"sm"},null,8,["modelValue"]),ve(Z,{modelValue:v.value,"onUpdate:modelValue":G[4]||(G[4]=$=>v.value=$),placeholder:"分支名 (默认: main)",size:"sm"},null,8,["modelValue"]),ve(Z,{modelValue:O.value,"onUpdate:modelValue":G[5]||(G[5]=$=>O.value=$),placeholder:"存储路径 (默认: images/)",size:"sm"},null,8,["modelValue"]),q("div",mc,[ve(B,{modelValue:H.value,"onUpdate:modelValue":G[6]||(G[6]=$=>H.value=$)},null,8,["modelValue"]),G[13]||(G[13]=q("span",{class:"text-sm"},"启用CDN加速",-1))]),H.value?(ie(),qt(Z,{key:0,modelValue:z.value,"onUpdate:modelValue":G[7]||(G[7]=$=>z.value=$),placeholder:"输入CDN域名 (如: jsd.cdn.noisework.cn)",size:"sm"},null,8,["modelValue"])):He("",!0)])):He("",!0),q("div",gc,[ve(W,{color:"green",variant:"solid",size:"sm",icon:"i-heroicons-check",onClick:$e},{default:dt(()=>G[14]||(G[14]=[Tt(" 保存配置 ")])),_:1})]),q("div",{class:Fe(["flex flex-col items-center justify-center border-2 border-dashed border-gray-500 rounded-lg p-4 cursor-pointer hover:border-blue-400 transition-colors",{"border-blue-400":m.value}]),onClick:N,onDragover:G[8]||(G[8]=Pi($=>m.value=!0,["prevent"])),onDragleave:G[9]||(G[9]=Pi($=>m.value=!1,["prevent"])),onDrop:Pi(V,["prevent"])},[q("input",{ref_key:"fileInput",ref:u,type:"file",accept:"image/*",onChange:se,class:"hidden"},null,544),!g.value&&!b.value?(ie(),qt(ae,{key:0,name:"i-heroicons-cloud-arrow-up",class:"w-10 h-10 text-gray-400 mb-2"})):He("",!0),b.value&&!g.value?(ie(),de("img",{key:1,src:b.value,class:"max-h-32 max-w-full mb-2 rounded"},null,8,vc)):He("",!0),g.value?(ie(),qt(K,{key:2,value:w.value,color:"blue",class:"w-full mb-2"},null,8,["value"])):He("",!0),!g.value&&!b.value?(ie(),de("p",yc," 点击或拖拽图片到此处上传 ")):He("",!0),g.value?(ie(),de("p",bc," 上传中... "+Qe(w.value)+"% ",1)):He("",!0)],34),b.value&&!g.value&&!S.value?(ie(),de("div",wc,[ve(W,{color:"blue",variant:"solid",size:"sm",icon:"i-heroicons-cloud-arrow-up",onClick:Te},{default:dt(()=>G[15]||(G[15]=[Tt(" 开始上传 ")])),_:1})])):He("",!0),_.value?(ie(),de("div",Ec,Qe(_.value),1)):He("",!0),S.value?(ie(),de("div",Sc,[q("div",Cc,[q("input",{type:"text",value:S.value,readonly:"",class:"bg-transparent flex-1 text-sm outline-none"},null,8,kc),ve(W,{icon:"i-heroicons-clipboard",color:"gray",variant:"ghost",size:"xs",onClick:G[10]||(G[10]=$=>_e(S.value))})]),q("div",Tc,[ve(W,{color:"blue",variant:"solid",size:"sm",onClick:Re},{default:dt(()=>G[16]||(G[16]=[Tt(" 插入图片 ")])),_:1})])])):He("",!0)])],36)}}}),_c=cn(xc,[["__scopeId","data-v-b776646b"]]),Mc={class:"flex justify-between mb-3"},Lc={class:"flex justify-start items-center gap-2"},Ac={class:"flex gap-2"},Dc={href:"/rss",target:"_blank"},Oc={class:"flex justify-between items-center"},Pc={class:"flex items-center justify-start gap-2"},Rc={key:0,class:"w-full mt-2"},Ic={class:"bg-gray-700 rounded h-2"},Hc={class:"text-xs text-gray-300 mt-1 text-right"},Nc={class:"flex gap-2"},jc={key:0,class:"mx-auto sm:max-w-2xl mt-5 backdrop-blur-sm bg-black/40 p-4 rounded-md editor-preview"},Bc={class:"prose prose-invert max-w-none"},zc=["innerHTML"],$c={key:0,class:"prose prose-invert max-w-none editor-preview"},Fc=["innerHTML"],Uc=Dt({__name:"AddForm",emits:["search-result","video-uploaded","before-upload","upload-progress"],setup(k,{emit:n}){const r=ee(!1),s=ee({x:400,y:320}),c=G=>{var W;(W=z.value)!=null&&W.insertValue&&z.value.insertValue(G),r.value=!1},h=G=>{s.value=G},p=ee(0),f=G=>{p.value=G},y=ee(!1),T=n,C=G=>{T("search-result",G)},d=Ye(),u=$n().public.baseApi||"/api",{save:m}=Ja(),g=zn("showHeatmap");ei("showHeatmap",g);const w=()=>{g.value=!g.value},b=ee(""),S=ee(""),_=ee(""),M=ee(typeof window<"u"&&localStorage.getItem("postPrivate")==="true"),x=zn("contentTheme"),v=zn("toggleContentTheme"),O=()=>{v&&v(),typeof window<"u"&&(document.documentElement.className=x.value==="dark"?"dark":"")},H=ee(null),z=ee(null),I=Me(()=>M.value?"i-mdi-eye-off-outline":"i-mdi-eye-outline");ac();const R=ee(localStorage.getItem("enableNotify")==="true"),N=()=>{b.value="",S.value="",_.value="",z.value&&z.value.clear()},V=Cr(),se=()=>V.isLogin?!0:(d.add({title:"提示",description:"请先登录",color:"orange",timeout:2e3}),!1),ue=()=>{const G=document.getElementById("file-input");G&&G.click()},ke=async G=>{var xe;if(!se())return;const W=G.target,Z=W.files?W.files[0]:null;if(!Z){d.add({title:"错误",description:"没有选择文件",color:"red",timeout:2e3});return}const B=["image/jpeg","image/png","image/gif","image/webp"],ae=[".jpg",".jpeg",".png",".gif",".webp"],K=Z.name.toLowerCase().substring(Z.name.lastIndexOf("."));if(!B.includes(Z.type)||!ae.includes(K)){d.add({title:"错误",description:"仅支持 JPG、PNG、GIF、WEBP 格式的图片",color:"red",timeout:2e3});return}const $=5*1024*1024;if(Z.size>$){d.add({title:"错误",description:"图片大小不能超过 5MB",color:"red",timeout:2e3});return}try{const re=new FormData;re.append("image",Z);const qe=await fetch(`${u}/images/upload`,{method:"POST",body:re,credentials:"include"});if(!qe.ok){const Ue=await qe.json();throw new Error(Ue.msg||"图片上传失败")}const Be=await qe.json();if(Be.code===1&&Be.data){if((xe=z.value)!=null&&xe.insertValue){const ge=`
![](${typeof window<"u"?window.location.origin:""}${u}${Be.data})
`;z.value.insertValue(ge)}d.add({title:"成功",description:"图片上传成功",color:"green",timeout:2e3})}else throw new Error(Be.msg||"图片上传失败")}catch(re){console.error("上传错误:",re),d.add({title:"错误",description:re.message||"图片上传失败",color:"red",timeout:2e3})}finally{H.value&&(H.value.value="")}},Re=G=>{var ae;const W=typeof window<"u"?window.location.origin:"",Z=G.startsWith("/")?G:`/${G}`,B=`<video width="100%" height="100%" src="${W}${Z}" controls loop></video>
`;(ae=z.value)!=null&&ae.insertValue&&z.value.insertValue(B)},_e=/!\s*(https?:\/\/[^\s!]+\.(?:png|jpe?g|gif|webp))(?:\?[^\s!]*)?/gi,Te=G=>G.replace(_e,(W,Z)=>`![](${Z})`),Ne=G=>{const Z=new DOMParser().parseFromString(G,"text/html"),B=xe=>{let re=!0;const qe=Array.from(xe.childNodes);if(qe.length===0)return!1;for(const Be of qe)if(Be.nodeType===Node.ELEMENT_NODE){const Ue=Be,ge=Ue.tagName.toLowerCase();if(ge==="img"||ge==="a"&&Ue.childElementCount===1&&Ue.querySelector("img"))continue;if(ge==="br"){re=!1;break}re=!1;break}else if(Be.nodeType===Node.TEXT_NODE&&(Be.textContent||"").trim()!==""){re=!1;break}return re},ae=Array.from(Z.body.querySelectorAll("p")),K=[];let $=[];for(const xe of ae)if(B(xe)){const re=$[$.length-1];!re||re.nextElementSibling===xe?$.push(xe):($.length>=2&&K.push($),$=[xe])}else $.length>=2&&K.push($),$=[];$.length>=2&&K.push($);for(const xe of K){const re=Z.createElement("div"),qe=xe.length,Be=qe===2||qe===4?2:Math.min(3,qe);re.className=`image-grid cols-${Be}`;const Ue=`grid-${Math.random().toString(36).slice(2)}`;for(const Ze of xe){const lt=Ze.querySelector("img"),ct=Ze.querySelector("a");if(!lt&&!ct)continue;const Y=Z.createElement("div");Y.className="image-grid-item";let U;if(ct&&ct.querySelector("img")){if(U=ct,U.setAttribute("data-fancybox",Ue),!U.getAttribute("href")){const X=ct.querySelector("img");U.setAttribute("href",X.src)}}else if(lt)U=Z.createElement("a"),U.setAttribute("href",lt.src),U.setAttribute("data-fancybox",Ue),U.appendChild(lt);else continue;Y.appendChild(U),re.appendChild(Y)}xe[0].replaceWith(re);for(let Ze=1;Ze<xe.length;Ze++)xe[Ze].remove()}return Z.body.innerHTML};gt(S,G=>{const W=ni.md2html(Te(G||""));_.value=Ne(W),at(()=>{document.querySelectorAll(".editor-preview").forEach(B=>{B.querySelectorAll(".image-grid-item img").forEach(ae=>{const K=ae,$=K.parentElement,xe=()=>{const re=K.naturalWidth,qe=K.naturalHeight;$.classList.remove("ar-169","ar-34","ar-11"),re>qe?$.classList.add("ar-169"):qe>re?$.classList.add("ar-34"):$.classList.add("ar-11")};K.complete&&K.naturalWidth&&K.naturalHeight?xe():K.addEventListener("load",xe,{once:!0})})})})}),gt(()=>V.isLogin,G=>{G&&(R.value=localStorage.getItem("enableNotify")==="true")},{immediate:!0}),Wt(async()=>{Xe.bind("[data-fancybox]",{}),V.isLogin||localStorage.getItem("token")&&V.fetchUserInfo&&await V.fetchUserInfo(),M.value=localStorage.getItem("postPrivate")==="true",x.value=localStorage.getItem("contentTheme")||x.value}),ai(()=>{Xe.destroy()});const Oe=()=>{R.value=!R.value,localStorage.setItem("enableNotify",R.value.toString())},$e=()=>{M.value=!M.value,localStorage.setItem("postPrivate",M.value?"true":"false")},j=G=>V.isLogin?!0:(d.add({title:"提示",description:"请登录后操作",color:"orange",timeout:2e3}),G.preventDefault&&G.preventDefault(),!1),ce=async()=>{if(!se())return;if(!S.value.trim()){d.add({title:"错误",description:"请输入内容或上传图片/视频",color:"red",timeout:2e3});return}const G={username:b.value,content:S.value,private:M.value,notify:R.value};try{await m(G)&&N()}catch(W){console.error("发布错误:",W),d.add({title:"错误",description:W.message||"发布失败",color:"red",timeout:2e3})}};return(G,W)=>{const Z=Fn,B=Il,ae=ul,K=kr;return ie(),de(Ht,null,[ve(K,{class:"mx-auto sm:max-w-2xl hover:shadow-md backdrop-blur-sm bg-black/20 shadow-lg text-white"},{default:dt(()=>[q("div",Mc,[q("div",Lc,[ve(Z,{name:"i-heroicons-pencil-square",class:"w-6 h-6 transition-all duration-300 hover:scale-110 hover:text-blue-400 animate-pulse"}),W[5]||(W[5]=q("h2",{class:"text-lg font-bold italic text-white"},"说说·笔记~",-1))]),q("div",Ac,[ve(B,null,{default:dt(()=>[q("div",{onClick:W[0]||(W[0]=$=>y.value=!0),class:"cursor-pointer flex"},[ve(Z,{name:"i-heroicons-magnifying-glass",class:"w-5 h-5 text-gray-200"})]),q("button",{onClick:w},[ve(Z,{name:"i-mdi-calendar-month",class:"w-5 h-5 text-gray-200"})]),q("button",{onClick:O,title:"切换暗黑/白天模式"},[ve(Z,{name:De(x)==="dark"?"i-mdi-weather-night":"i-mdi-white-balance-sunny",class:"w-5 h-5 text-gray-200"},null,8,["name"])]),q("a",Dc,[ve(Z,{name:"i-mdi-rss",class:"w-5 h-5 text-gray-200"})])]),_:1}),ve(ae,{to:"/status"},{default:dt(()=>[ve(Z,{name:"i-mdi-server-outline",class:"w-5 h-5 text-gray-200"})]),_:1})])]),q("div",null,[ve(ec,{ref_key:"vditorEditor",ref:z,modelValue:S.value,"onUpdate:modelValue":W[1]||(W[1]=$=>S.value=$),theme:De(x)},null,8,["modelValue","theme"]),q("div",Oc,[q("div",Pc,[q("input",{id:"file-input",ref_key:"fileInput",ref:H,type:"file",accept:"image/*",onChange:ke,class:"hidden",placeholder:"选择图片"},null,544),ve(oc,{onVideoUploaded:Re,onBeforeUpload:j,onUploadProgress:f}),p.value>0&&p.value<100?(ie(),de("div",Rc,[q("div",Ic,[q("div",{class:"bg-blue-500 h-2 rounded",style:xn({width:p.value+"%"})},null,4)]),q("div",Hc,Qe(p.value)+"%",1)])):He("",!0),ve(De(Gt),{color:"gray",variant:"solid",class:"cursor-pointer",size:"sm",icon:"i-fluent-image-20-regular",onClick:ue}),ve(De(Gt),{color:"gray",variant:"solid",class:"cursor-pointer",size:"sm",icon:"i-mdi-cloud-upload-outline",onClick:W[2]||(W[2]=$=>r.value=!0),title:"图床上传"}),ve(De(Gt),{color:"gray",variant:"solid",size:"sm",onClick:$e,icon:I.value,title:M.value?"设为公开":"设为私密",ui:{tooltip:{text:M.value?"设为公开":"设为私密"}}},null,8,["icon","title","ui"]),ve(De(Gt),{color:"gray",variant:"solid",size:"sm",onClick:Oe,icon:R.value?"i-mdi-bell":"i-mdi-bell-off",title:R.value?"关闭推送":"开启推送",ui:{tooltip:{text:R.value?"关闭推送":"开启推送"}},class:"text-gray-600"},null,8,["icon","title","ui"])]),q("div",Nc,[ve(De(Gt),{icon:"i-fluent-broom-16-regular",variant:"solid",color:"gray",size:"sm",onClick:N}),ve(De(Gt),{icon:"i-fluent-add-12-filled",variant:"solid",color:"gray",size:"sm",onClick:ce})])])])]),_:1}),_.value?(ie(),de("div",jc,[q("div",Bc,[q("div",{innerHTML:_.value},null,8,zc)]),W[6]||(W[6]=q("hr",{class:"border-gray-600 my-4"},null,-1)),_.value?(ie(),de("div",$c,[q("div",{innerHTML:_.value},null,8,Fc)])):He("",!0)])):He("",!0),ve(yo,{modelValue:y.value,"onUpdate:modelValue":W[3]||(W[3]=$=>y.value=$),onSearchResult:C},null,8,["modelValue"]),r.value?(ie(),qt(_c,{key:1,position:s.value,onClose:W[4]||(W[4]=$=>r.value=!1),onUploadSuccess:c,"onUpdate:position":h},null,8,["position"])):He("",!0)],64)}}}),Vc=cn(Uc,[["__scopeId","data-v-7b984a80"]]),ri=Dt({__name:"MarkdownRenderer",props:{content:{type:String,required:!0},enableGithubCard:{type:Boolean,default:!0}},emits:["tagClick","rendered"],setup(k,{emit:n}){const r=/https:\/\/www\.bilibili\.com\/video\/(BV[\w]+)\/?$/,s=/https:\/\/(?:www\.)?youtube\.com\/watch\?v=([\w-]+)|https:\/\/youtu\.be\/([\w-]+)/,c=/https:\/\/music\.163\.com(?:\/#)?\/song\?id=(\d+)/,h=/https:\/\/y\.qq\.com\/n\/yqq\/song(\w+)\.html/,p=/https:\/\/v\.qq\.com\/x\/cover\/\w+\/(\w+)\.html/,f=/https:\/\/open\.spotify\.com\/(track|album|playlist)\/([a-zA-Z0-9]+)/,y=/https:\/\/v\.youku\.com\/v_show\/id_([a-zA-Z0-9]+)\.html/,T=n,C=ee(null);let d=null;const u=k,m=zn("contentTheme"),g=()=>{if(!C.value)return;const O=m&&m.value==="dark";C.value.classList.toggle("theme-dark",!!O),C.value.classList.toggle("theme-light",!O)},w=()=>{var O;if(window.mediumZoom){d&&d.detach();const H=(O=C.value)==null?void 0:O.getElementsByTagName("img");H&&H.length>0&&(d=window.mediumZoom(H,{background:"rgba(0, 0, 0, 0.9)",margin:24,scrollOffset:0}))}},b=()=>{if(!C.value)return;const O=R=>{let N=!0;const V=Array.from(R.childNodes);if(V.length===0)return!1;for(const se of V)if(se.nodeType===Node.ELEMENT_NODE){const ue=se,ke=ue.tagName.toLowerCase();if(ke==="img"||ke==="a"&&ue.childElementCount===1&&ue.querySelector("img"))continue;if(ke==="br"){N=!1;break}N=!1;break}else if(se.nodeType===Node.TEXT_NODE&&(se.textContent||"").trim()!==""){N=!1;break}return N},H=Array.from(C.value.querySelectorAll("p")),z=[];let I=[];for(const R of H)if(O(R)){const N=I[I.length-1];!N||N.nextElementSibling===R?I.push(R):(I.length>=2&&z.push(I),I=[R])}else I.length>=2&&z.push(I),I=[];I.length>=2&&z.push(I);for(const R of z){const N=document.createElement("div"),V=R.length,se=V===2||V===4?2:Math.min(3,V);N.className=`image-grid cols-${se}`;const ue=`grid-${Math.random().toString(36).slice(2)}`;for(const Re of R){const _e=Re.querySelector("img"),Te=Re.querySelector("a");if(!_e&&!Te)continue;const Ne=document.createElement("div");Ne.className="image-grid-item";let Oe;if(Te&&Te.querySelector("img")){if(Oe=Te,Oe.setAttribute("data-fancybox",ue),!Oe.getAttribute("href")&&Te.querySelector("img")){const $e=Te.querySelector("img");Oe.setAttribute("href",$e.src)}}else if(_e)Oe=document.createElement("a"),Oe.setAttribute("href",_e.src),Oe.setAttribute("data-fancybox",ue),Oe.appendChild(_e);else continue;Ne.appendChild(Oe),N.appendChild(Ne)}N.querySelectorAll("img").forEach(Re=>{const _e=Re,Te=_e.closest(".image-grid-item"),Ne=()=>{const Oe=_e.naturalWidth,$e=_e.naturalHeight;Te&&(Te.classList.remove("ar-169","ar-34","ar-11"),Oe>$e?Te.classList.add("ar-169"):$e>Oe?Te.classList.add("ar-34"):Te.classList.add("ar-11"))};_e.complete&&_e.naturalWidth&&_e.naturalHeight?Ne():_e.addEventListener("load",Ne,{once:!0})}),R[0].replaceWith(N);for(let Re=1;Re<R.length;Re++)R[Re].remove()}},S=new RegExp("(?<!!)\\[([^\\]]+)\\]\\((https:\\/\\/github\\.com\\/([\\w-]+)\\/([\\w.-]+)(?:\\/[^\\s)]*)?)\\)","g"),_=new RegExp(`(?<!["'\\(])\\bhttps:\\/\\/github\\.com\\/([\\w-]+)\\/([\\w.-]+)(?:\\/[^\\s<\\)]*)?\\b`,"g"),M=O=>(u.enableGithubCard&&(O=O.replace(S,(H,z,I,R,N)=>`<div class="github-card" id="${`github-card-${R}-${N}`}" data-owner="${R}" data-repo="${N}">
        <div class="github-card-loading">Loading GitHub Repo...</div>
      </div>`),O=O.replace(_,(H,z,I)=>`<div class="github-card" id="${`github-card-${z}-${I}`}" data-owner="${z}" data-repo="${I}">
        <div class="github-card-loading">Loading GitHub Repo...</div>
      </div>`)),O.replace(r,"<div class='video-wrapper'><iframe src='https://www.bilibili.com/blackboard/html5mobileplayer.html?bvid=$1&as_wide=1&high_quality=1&danmaku=0' scrolling='no' border='0' frameborder='no' framespacing='0' allowfullscreen='true' style='position:absolute;height:100%;width:100%'></iframe></div>").replace(s,"<div class='video-wrapper'><iframe src='https://www.youtube.com/embed/$1$2' title='YouTube video player' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen></iframe></div>").replace(c,"<div class='music-wrapper'><meting-js auto='https://music.163.com/#/song?id=$1'></meting-js></div>").replace(h,"<meting-js auto='https://y.qq.com/n/yqq/song$1.html'></meting-js>").replace(p,"<div class='video-wrapper'><iframe src='//v.qq.com/iframe/player.html?vid=$1' allowFullScreen='true' frameborder='no'></iframe></div>").replace(f,"<div class='spotify-wrapper'><iframe style='border-radius:12px' src='https://open.spotify.com/embed/$1/$2?utm_source=generator&theme=0' width='100%' frameBorder='0' allowfullscreen='' allow='autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture' loading='lazy'></iframe></div>").replace(y,"<div class='video-wrapper'><iframe src='https://player.youku.com/embed/$1' frameborder=0 'allowfullscreen'></iframe></div>")),x=async(O,H,z)=>{try{const I=await fetch(`https://api.github.com/repos/${O}/${H}`);if(!I.ok)return;const R=await I.json(),N=document.getElementById(z);N&&(N.innerHTML=`
        <div class="github-card-header">
          <img src="${R.owner.avatar_url}" class="github-card-avatar" />
          <div>
            <a href="${R.html_url}" target="_blank" class="github-card-title">${R.full_name}</a>
            <div class="github-card-desc">${R.description||""}</div>
          </div>
        </div>
        <div class="github-card-footer">
          <span>⭐ ${R.stargazers_count}</span>
          <span>🍴 ${R.forks_count}</span>
          <span>🛠️ ${R.language||""}</span>
        </div>
      `)}catch{}},v=async O=>{if(C.value)try{if(typeof ni>"u"){console.error("Vditor is not loaded.");return}let H="";try{H=normalizeInlineImageLinks(O??"")}catch{H=O??""}const z=M(H),R=(ue=>ue.replace(/(^|\s)(https?:\/\/[^\s<]+)/g,(ke,Re,_e)=>`${Re}<a href="${_e}" target="_blank" rel="noopener noreferrer">${_e}</a>`))(z);let N="";try{N=R.replace(/<a /g,'<a target="_blank" ').replace(new RegExp("(?<!<[^>]*)#([^\\s#<>]+)(?![^<]*>)","g"),`<span class="clickable-tag" onclick="window.handleTagClick('$1')" style="cursor: pointer;">#$1</span>`)}catch{N=R.replace(/<a /g,'<a target="_blank" ')}const V=m&&m.value==="dark"?"dark":"light",se=V==="dark"?"github-dark":"github";try{ni.preview(C.value,N,{mode:"light",lang:"zh_CN",theme:{current:V},hljs:{style:se,lineNumber:!0,enable:!0},after:()=>{var _e,Te,Ne;const ue=(_e=C.value)==null?void 0:_e.querySelectorAll("a");ue==null||ue.forEach(Oe=>{Oe.hasAttribute("target")||(Oe.setAttribute("target","_blank"),Oe.setAttribute("rel","noopener noreferrer"))}),g(),b(),w(),console.log("Rendering complete."),T("rendered");const ke=window.processNMPv2Shortcodes;ke&&C.value&&ke(C.value);const Re=(Te=C.value)==null?void 0:Te.querySelectorAll(".clickable-tag");if(Re==null||Re.forEach(Oe=>{Oe.addEventListener("click",$e=>{var ce;$e.preventDefault();const j=(ce=Oe.textContent)==null?void 0:ce.substring(1);j&&T("tagClick",j)})}),u.enableGithubCard){const Oe=(Ne=C.value)==null?void 0:Ne.querySelectorAll(".github-card");Oe==null||Oe.forEach($e=>{const j=$e.getAttribute("data-owner"),ce=$e.getAttribute("data-repo"),G=$e.id;j&&ce&&G&&x(j,ce,G)})}}})}catch{try{C.value.innerHTML=ni.md2html(N),g()}catch{C.value.innerHTML=N}}}catch(H){console.error("Error rendering markdown:",H),C.value.innerHTML=""}};return gt(()=>u.content,async O=>{await v(O)},{immediate:!0}),Wt(()=>{v(u.content),window.APlayer&&window.MetingJSElement?console.log("MetingJS is ready"):console.error("MetingJS or APlayer is not loaded properly"),g()}),ai(()=>{d&&(d.detach(),d=null)}),gt(()=>m&&m.value,()=>{g(),v(u.content)}),(O,H)=>(ie(),de("div",{ref_key:"previewElement",ref:C,class:"markdown-preview"},null,512))}}),qc={class:"builtin-comments"},Wc={key:0,class:"space-y-4 mb-4"},Yc=["href"],Kc={key:1},Gc={class:"mt-2 flex gap-2"},Zc=["onClick"],Xc=["onClick"],Jc=["href"],Qc={key:1},eu={class:"mt-2 flex gap-2"},tu=["onClick"],nu=["onClick"],iu={key:0,class:"flex justify-start"},ru=["onClick"],au={key:0,class:"flex justify-center"},ou={key:3,class:"space-y-3"},su={class:"grid grid-cols-1 md:grid-cols-3 gap-3"},lu={class:"flex flex-wrap items-center gap-2 mb-2"},cu={class:"relative"},uu={class:"flex flex-wrap gap-1 w-56"},du=["onClick"],fu={class:"relative"},hu={class:"px-2 py-1 text-xs"},pu=["onMousedown"],mu={class:"flex justify-end"},Ai="w-full px-2 py-1 border border-black rounded ring-0 focus:ring-0 focus:border-black",Di="w-full px-2 py-1 bg-[rgba(24,28,32,0.85)] text-white border border-white/20 rounded focus:ring-0 focus:border-primary-400 placeholder:text-gray-400",gu=Dt({__name:"BuiltinComments",props:{messageId:{},siteConfig:{},showInput:{type:Boolean}},setup(k){const n=k,r=ee([]),s=ee(""),c=ee(""),h=ee(""),p=ee(""),f=ee(null),y=ee(null),T=ee(!1),C=ee(!1),d=ee(null),u=Cr(),m=Me(()=>{var J;return!!((J=u.user)!=null&&J.is_admin)}),g=zn("contentTheme",ee("light")),w=Me(()=>{const J=g&&typeof g.value<"u"?g.value:g;return String(J||"light")==="dark"}),b=Me(()=>w.value?"bg-[rgba(24,28,32,0.95)]":"bg-white"),S=Me(()=>w.value?"border-white/20":"border-black"),_=Me(()=>w.value?"text-gray-200":"text-black"),M=Me(()=>w.value?"text-gray-400":"text-gray-500"),x=Me(()=>w.value?"bg-[rgba(24,28,32,0.7)]":"bg-white"),v=Me(()=>w.value?"border-white/20":"border-black"),O=Me(()=>T.value?"ring-1 ring-red-500":w.value?Di:`bg-gray-50 ${Ai}`),H=Me(()=>C.value?"ring-1 ring-red-500":w.value?Di:`bg-gray-50 ${Ai}`),z=Me(()=>w.value?Di:`bg-white ${Ai}`),I=Me(()=>w.value?Di:`bg-white ${Ai}`),R=$n().public.baseApi||"/api",N=async()=>{try{const pe=async Mt=>{const ht=await fetch(Mt,{credentials:"include",headers:{Accept:"application/json"}});if(!ht||!ht.ok)return null;const ut=await ht.json();return!ut||ut.code!==1||!Array.isArray(ut.data)?[]:ut.data},be=typeof window<"u"?window.location.origin:"",ze=[`${R}/messages/${n.messageId}/comments`,`${be}/api/messages/${n.messageId}/comments`,`http://localhost:1315/api/messages/${n.messageId}/comments`,`http://127.0.0.1:1315/api/messages/${n.messageId}/comments`];let et=[];for(const Mt of ze){const ht=await pe(Mt);if(ht&&ht.length>=0&&(et=ht,et.length>0))break}r.value=(et||[]).sort((Mt,ht)=>new Date(ht.created_at).getTime()-new Date(Mt.created_at).getTime())}catch{r.value=[]}await at();const J=document.querySelector(`.content-container[data-msg-id="${n.messageId}"] .builtin-comments`),fe=J==null?void 0:J.querySelectorAll(".rounded-md"),Se=fe&&fe.length?fe[fe.length-1]:null;Se==null||Se.scrollIntoView({behavior:"smooth",block:"center"})},V=async()=>{try{if(T.value=!s.value.trim(),C.value=!c.value.trim(),T.value||C.value){Ye().add({title:"缺少必填字段",description:(s.value?"":"昵称 ")+(c.value?"":"邮箱"),color:"red"});return}const J=p.value.trim(),fe={nick:s.value.trim(),mail:c.value.trim(),link:h.value.trim(),content:J};if(!fe.content){Ye().add({title:"内容不能为空",color:"red"});return}if(fe.mail&&!/^\S+@\S+\.\S+$/.test(fe.mail)){Ye().add({title:"邮箱格式不正确",color:"red"});return}y.value&&(fe.parent_id=y.value);const Se=await Cn(`messages/${n.messageId}/comments`,fe,{credentials:"include"});if(Se&&Se.code===1){p.value="",y.value=null,r.value=[...r.value,Se.data],await N(),await at();const pe=document.querySelector(`.content-container[data-msg-id="${n.messageId}"] .builtin-comments`),be=pe==null?void 0:pe.querySelectorAll(".rounded-md"),ze=be&&be.length?be[be.length-1]:null;ze==null||ze.scrollIntoView({behavior:"smooth",block:"center"}),Ye().add({title:"已发布",color:"green"})}else Ye().add({title:"发布失败",description:Se==null?void 0:Se.msg,color:"red"})}catch{Ye().add({title:"发布失败",color:"red"})}},se=J=>new Date(J).toLocaleString(),ue=J=>{const fe=String(J||"").trim();return fe&&/^https?:\/\//i.test(fe)?fe:""};Wt(N);const ke=()=>N();Wt(()=>{window.addEventListener(`refresh-comments-${n.messageId}`,ke)}),ai(()=>{window.removeEventListener(`refresh-comments-${n.messageId}`,ke)}),gt(()=>n.messageId,N);const Re=(J,fe)=>{y.value=J,p.value.startsWith(`@${fe} `)||(p.value=`@${fe} `+p.value)},_e=J=>{d.value=J,confirm("确认删除该评论吗？此操作不可恢复。")?Te():d.value=null},Te=async()=>{if(d.value)try{const J=await Wa(`messages/${n.messageId}/comments/${d.value}`,void 0,{credentials:"include"});J&&J.code===1?(r.value=r.value.filter(fe=>fe.id!==d.value),Ye().add({title:"已删除",color:"green"}),Ne()):Ye().add({title:"删除失败",description:J==null?void 0:J.msg,color:"red"})}catch{Ye().add({title:"删除失败",color:"red"})}finally{d.value=null}},Ne=()=>{const J=document.querySelector(`.content-container[data-msg-id="${n.messageId}"]`);J==null||J.scrollIntoView({behavior:"smooth",block:"start"})},Oe=Me(()=>{const J=Array.isArray(r.value)?r.value:[],fe=new Set;return J.forEach(Se=>{const pe=String((Se==null?void 0:Se.nick)||"").trim();pe&&fe.add(pe)}),Array.from(fe)}),$e=ee(!1),j=ee(""),ce=ee(0),G=Me(()=>{const J=j.value.toLowerCase();return Oe.value.filter(Se=>Se.toLowerCase().startsWith(J)).slice(0,20)}),W=()=>{$e.value=!1,ce.value=0,j.value=""},Z=()=>{$e.value=!0,ce.value=0},B=()=>{const J=f.value;return J?{start:J.selectionStart||0,end:J.selectionEnd||0}:{start:0,end:0}},ae=(J,fe,Se,pe)=>{const be=J.slice(0,fe),ze=J.slice(Se);return be+pe+ze},K=()=>{const J=f.value;if(!J)return;const fe=J.selectionStart||0,Se=p.value;let pe=fe-1;for(;pe>=0&&Se[pe]!==`
`&&Se[pe]!==" ";)pe--;const be=pe+1;if(Se[be]!=="@"){W();return}const ze=fe,et=Se.slice(be+1,ze);j.value=et,Z()},$=()=>{K()},xe=J=>{if(J.key==="@"){at(K);return}if($e.value)if(J.key==="ArrowDown")J.preventDefault(),ce.value=Math.min(ce.value+1,G.value.length-1);else if(J.key==="ArrowUp")J.preventDefault(),ce.value=Math.max(ce.value-1,0);else if(J.key==="Enter"){J.preventDefault();const fe=G.value[ce.value];fe&&re(fe)}else J.key==="Escape"&&W()},re=J=>{const fe=f.value;if(!fe)return;const Se=fe.selectionStart||0,pe=p.value;let be=Se-1;for(;be>=0&&pe[be]!==`
`&&pe[be]!==" ";)be--;const ze=be+1,et=Se;p.value=ae(pe,ze,et,`@${J} `),W(),at(()=>{const Mt=ze+J.length+2;fe.setSelectionRange(Mt,Mt),fe.focus()})},qe=ee(!1),Be=["😀","😄","😁","😆","😊","😍","🤔","👍","🔥","🎉","❤️","🥳","✨","🌟","🍀"],Ue=()=>{qe.value=!qe.value},ge=J=>{const fe=f.value;if(!fe){p.value+=J;return}const{start:Se,end:pe}=B();p.value=ae(p.value,Se,pe,J);const be=Se+J.length;at(()=>{fe.setSelectionRange(be,be),fe.focus()})},Ze=J=>{ge(J),qe.value=!1},lt=J=>{f.value;const{start:fe,end:Se}=B(),pe=p.value.slice(fe,Se);if(J==="bold")ge(pe?`**${pe}**`:"**加粗**");else if(J==="italic")ge(pe?`*${pe}*`:"*斜体*");else if(J==="link"){const be=window.prompt("请输入链接地址","https://")||"";/^https?:\/\//i.test(be)&&ge(pe?`[${pe}](${be})`:`[链接文本](${be})`)}else if(J==="image"){const be=window.prompt("请输入图片地址","https://")||"";/^https?:\/\//i.test(be)&&ge(`![图片](${be})`)}},ct=Me(()=>(Array.isArray(r.value)?r.value:[]).filter(Se=>Se&&(Se.parent_id===null||Number(Se.parent_id||0)===0))),Y=Me(()=>{const J={};return(Array.isArray(r.value)?r.value:[]).forEach(Se=>{J[Number(Se.id)]=Se}),J}),U=Me(()=>{const J={},fe={},Se=Array.isArray(r.value)?r.value:[],pe=/^@([^\s:：]+)/;return Se.forEach(be=>{const ze=Number((be==null?void 0:be.parent_id)||0);if(ze>0){const ht=Y.value[ze];if(ht){fe[Number(be.id)]=String(ht.nick||"");let ut=ht;for(;Number((ut==null?void 0:ut.parent_id)||0)>0;){const Et=Y.value[Number(ut.parent_id)];if(!Et)break;ut=Et}const mt=Number(ut.id);J[mt]||(J[mt]=[]),J[mt].push(be);return}return}const Mt=String((be==null?void 0:be.content)||"").match(pe);if(Mt&&Mt[1]){const ht=Mt[1],ut=new Date(be.created_at).getTime(),mt=Se.filter(Ve=>String((Ve==null?void 0:Ve.nick)||"").trim()===ht);let Et=null;const nt=mt.filter(Ve=>new Date(Ve.created_at).getTime()<=ut);if(nt.length?Et=nt.sort((Ve,rt)=>new Date(rt.created_at).getTime()-new Date(Ve.created_at).getTime())[0]:mt.length&&(Et=mt.sort((Ve,rt)=>new Date(rt.created_at).getTime()-new Date(Ve.created_at).getTime())[0]),Et&&Et.id){let Ve=Et;for(;Number((Ve==null?void 0:Ve.parent_id)||0)>0;){const Lt=Y.value[Number(Ve.parent_id)];if(!Lt)break;Ve=Lt}const rt=Number(Ve.id);J[rt]||(J[rt]=[]),J[rt].some(Lt=>Lt.id===be.id)||J[rt].push(be),fe[Number(be.id)]=String(Et.nick||"")}}}),Object.keys(J).forEach(be=>{J[Number(be)]=(J[Number(be)]||[]).sort((ze,et)=>new Date(et.created_at).getTime()-new Date(ze.created_at).getTime())}),{map:J,targetMap:fe}}),X=Me(()=>U.value.map),ne=Me(()=>U.value.targetMap),Le=Me(()=>{const J=/^@([^\s:：]+)/;return(Array.isArray(ct.value)?ct.value:[]).filter(Se=>{const pe=String((Se==null?void 0:Se.content)||"");return!J.test(pe)}).slice().sort((Se,pe)=>new Date(pe.created_at).getTime()-new Date(Se.created_at).getTime())}),ye=ee(3),ft=Me(()=>Le.value.slice(0,ye.value)),Yt=Me(()=>Le.value.length>ye.value),Pe=()=>{ye.value+=3};gt(()=>n.messageId,()=>{ye.value=3});const xt=ee({}),wt=J=>{const fe=xt.value[J]??3;return(X.value[J]||[]).slice(0,fe)},Ot=J=>{const fe=(X.value[J]||[]).length,Se=xt.value[J]??3;return fe>Se},Xt=J=>{const fe=xt.value[J]??3;xt.value[J]=fe+3};return gt(X,J=>{const fe={...xt.value};Object.keys(J||{}).forEach(Se=>{const pe=Number(Se);fe[pe]||(fe[pe]=3)}),xt.value=fe}),gt(()=>n.messageId,()=>{xt.value={}}),(J,fe)=>{var Se;return ie(),de("div",qc,[q("div",{class:Fe(["waline-wrapper p-3 rounded-lg border",[b.value,S.value]])},[q("div",{class:Fe(["text-sm mb-2",_.value])},"评论区",2),q("div",{class:Fe(["text-[10px] mb-1 opacity-60",M.value])},"已加载 "+Qe(r.value.length)+" 条",3),Le.value.length?(ie(),de("div",Wc,[(ie(!0),de(Ht,null,Vt(ft.value,pe=>{var be;return ie(),de("div",{key:pe.id,class:Fe(["rounded-md p-4 border",[x.value,S.value]])},[q("div",{class:Fe(["text-xs flex items-center justify-between",M.value])},[ue(pe.link)?(ie(),de("a",{key:0,href:ue(pe.link),target:"_blank",rel:"noopener noreferrer"},Qe(pe.nick||"匿名"),9,Yc)):(ie(),de("span",Kc,Qe(pe.nick||"匿名"),1)),q("span",null,Qe(se(pe.created_at)),1)],2),q("div",{class:Fe(["mt-1 text-sm",_.value])},[ve(ri,{content:pe.content},null,8,["content"])],2),q("div",Gc,[q("button",{class:"text-xs px-2 py-1 rounded border",onClick:ze=>Re(pe.id,pe.nick||"匿名")},"回复",8,Zc),m.value?(ie(),de("button",{key:0,class:"text-xs px-2 py-1 rounded border border-red-500 text-red-500",onClick:ze=>_e(pe.id)},"删除",8,Xc)):He("",!0)]),(be=X.value[pe.id])!=null&&be.length?(ie(),de("div",{key:0,class:Fe(["mt-4 pl-4 border-l space-y-2",v.value])},[(ie(!0),de(Ht,null,Vt(wt(pe.id),ze=>(ie(),de("div",{key:ze.id,class:Fe(["rounded-md p-3",[w.value?"bg-[rgba(24,28,32,0.6)]":"bg-gray-50"]])},[q("div",{class:Fe(["text-xs flex items-center justify-between",M.value])},[ue(ze.link)?(ie(),de("a",{key:0,href:ue(ze.link),target:"_blank",rel:"noopener noreferrer"},Qe(ze.nick||"匿名"),9,Jc)):(ie(),de("span",Qc,Qe(ze.nick||"匿名"),1)),q("span",null,Qe(se(ze.created_at)),1)],2),ne.value[ze.id]?(ie(),de("div",{key:0,class:Fe(["text-xs mt-1",M.value])},"回复 @"+Qe(ne.value[ze.id]),3)):He("",!0),q("div",{class:Fe(["mt-1 text-sm",_.value])},[ve(ri,{content:ze.content},null,8,["content"])],2),q("div",eu,[q("button",{class:"text-xs px-2 py-1 rounded border",onClick:et=>Re(ze.id,ze.nick||"匿名")},"回复",8,tu),m.value?(ie(),de("button",{key:0,class:"text-xs px-2 py-1 rounded border border-red-500 text-red-500",onClick:et=>_e(ze.id)},"删除",8,nu)):He("",!0)])],2))),128)),Ot(pe.id)?(ie(),de("div",iu,[q("button",{class:Fe(["text-xs px-2 py-1 rounded border",S.value]),onClick:ze=>Xt(pe.id)},"加载更多回复",10,ru)])):He("",!0)],2)):He("",!0)],2)}),128)),Yt.value?(ie(),de("div",au,[q("button",{class:Fe(["text-xs px-3 py-1 rounded border",S.value]),onClick:Pe},"加载更多评论",2)])):He("",!0)])):(ie(),de("div",{key:1,class:Fe(["text-xs mb-4",M.value])},"暂无评论",2)),(n.showInput||y.value)&&((Se=J.siteConfig)!=null&&Se.commentEmailEnabled)?(ie(),de("div",{key:2,class:Fe(["text-xs mb-2",M.value])},"新评论或回复会发送通知邮件",2)):He("",!0),n.showInput||y.value?(ie(),de("div",ou,[q("div",su,[Jn(q("input",{"onUpdate:modelValue":fe[0]||(fe[0]=pe=>s.value=pe),placeholder:"昵称",class:Fe(O.value)},null,2),[[gi,s.value]]),Jn(q("input",{"onUpdate:modelValue":fe[1]||(fe[1]=pe=>c.value=pe),placeholder:"邮箱",class:Fe(H.value)},null,2),[[gi,c.value]]),Jn(q("input",{"onUpdate:modelValue":fe[2]||(fe[2]=pe=>h.value=pe),placeholder:"网址（可选）",class:Fe(z.value)},null,2),[[gi,h.value]])]),q("div",lu,[q("button",{class:Fe(["text-xs px-2 py-1 rounded border",S.value]),onClick:fe[3]||(fe[3]=pe=>lt("bold"))},"加粗",2),q("button",{class:Fe(["text-xs px-2 py-1 rounded border",S.value]),onClick:fe[4]||(fe[4]=pe=>lt("italic"))},"斜体",2),q("button",{class:Fe(["text-xs px-2 py-1 rounded border",S.value]),onClick:fe[5]||(fe[5]=pe=>lt("link"))},"链接",2),q("button",{class:Fe(["text-xs px-2 py-1 rounded border",S.value]),onClick:fe[6]||(fe[6]=pe=>lt("image"))},"图片",2),q("div",cu,[q("button",{class:Fe(["text-xs px-2 py-1 rounded border",S.value]),onClick:Ue},"表情",2),qe.value?(ie(),de("div",{key:0,class:Fe(["absolute z-10 mt-1 p-2 rounded border bg-white shadow",S.value])},[q("div",uu,[(ie(),de(Ht,null,Vt(Be,pe=>q("button",{key:pe,class:"px-2 py-1 text-sm",onClick:be=>Ze(pe)},Qe(pe),9,du)),64))])],2)):He("",!0)])]),q("div",fu,[Jn(q("textarea",{ref_key:"taRef",ref:f,"onUpdate:modelValue":fe[7]||(fe[7]=pe=>p.value=pe),class:Fe(I.value),rows:"4",placeholder:"写下你的评论...",onInput:$,onKeydown:xe,onBlur:W},null,34),[[gi,p.value]]),$e.value?(ie(),de("div",{key:0,class:Fe(["absolute left-2 top-2 mt-0 z-10 bg-white rounded border shadow max-h-40 overflow-auto",[S.value,w.value?"text-black":""]])},[q("div",hu,"@"+Qe(j.value||"昵称"),1),q("div",null,[(ie(!0),de(Ht,null,Vt(G.value,(pe,be)=>(ie(),de("button",{key:pe,class:Fe(["block w-full text-left px-2 py-1 text-sm hover:bg-gray-100",be===ce.value?"bg-gray-100":""]),onMousedown:Pi(ze=>re(pe),["prevent"])},Qe(pe),43,pu))),128))])],2)):He("",!0)]),q("div",mu,[q("button",{class:"px-3 py-1 rounded bg-green-500 text-white",onClick:V},Qe(y.value?"发布回复":"发布评论"),1)])])):He("",!0)],2)])}}}),vu={class:"min-h-screen flex flex-col"},yu={key:0,class:"text-center text-gray-500 py-8"},bu={class:"flex-grow mx-auto w-full sm:max-w-2xl px-2"},wu={key:0,class:"flex justify-between items-center mb-4 p-4 rounded-lg"},Eu={class:"text-gray-400"},Su={class:"my-4"},Cu={key:0,class:"text-center text-gray-500 py-8"},ku={class:"flex justify-between items-center"},Tu={class:"flex justify-start items-center h-auto overflow-x-auto whitespace-nowrap hide-scrollbar"},xu={class:"flex justify-start items-center text-sm"},_u={class:"text-orange-500"},Mu={class:"text-orange-500"},Lu={key:0,class:"flex items-center text-orange-500 flex-shrink-0 ml-1",title:"置顶"},Au={class:"message-actions flex justify-end items-center space-x-2 flex-shrink-0 px-3 py-1.5 mr-[9px] -mb-[1px]"},Du={key:0,class:"w-5 h-5 flex-shrink-0 transition-transform duration-200 hover:scale-110"},Ou=["onClick","title"],Pu=["onClick"],Ru=["onClick"],Iu=["onClick"],Hu=["onClick"],Nu=["onClick"],ju={class:"border-l-2 border-gray-300 p-4 ml-1"},Bu=["data-msg-id"],zu=["src","fetchpriority"],$u={key:1,class:"border-t border-gray-600 my-4"},Fu={key:2,class:"text-center mt-2 relative",style:{"z-index":"9999"}},Uu=["onClick"],Vu=["id"],qu=["id"],Wu={key:1,class:"flex justify-center items-center space-x-4 w-full my-4 flex-wrap md:flex-nowrap"},Yu={class:"flex justify-center items-center space-x-4 w-full md:w-auto"},Ku={key:2,class:"ml-2 text-orange-400"},Gu={class:"flex items-center justify-center space-x-2 w-full md:w-auto mt-3 md:mt-0"},Zu={class:"text-gray-500 text-shadow-sm text-sm"},Xu={key:2,class:"text-center text-gray-500 mt-4"},Ju={key:1,class:"text-center text-xs text-gray-400 py-4"},Qu=["innerHTML"],ed={class:"flex justify-between items-center"},td={class:"flex flex-col space-y-4"},nd={class:"border-t border-gray-200 my-2 pt-2"},id={class:"p-4 rounded-lg overflow-auto max-h-[300px] bg-[rgba(36,43,50,0.95)]"},rd={class:"text-white"},ad={class:"flex justify-end space-x-2"},od=Dt({__name:"MessageList",props:{siteConfig:{type:Object,required:!0},targetMessageId:{type:String,default:null}},setup(k,{expose:n}){const r=zn("contentTheme",ee(typeof window<"u"&&localStorage.getItem("contentTheme")||"dark")),s=Me(()=>r.value==="dark"?"bg-[rgba(36,43,50,0.95)] text-white":"bg-white text-black"),c=Me(()=>r.value==="dark"?"text-white":"text-black"),h=Me(()=>r.value==="dark"?"from-[rgba(36,43,50,1)] via-[rgba(36,43,50,0.8)] to-transparent":"from-[rgba(255,255,255,1)] via-[rgba(255,255,255,0.8)] to-transparent"),p=Me(()=>r.value==="dark"?"bg-[rgba(36,43,50,0.95)] text-white rounded-lg p-3":"bg-white text-black rounded-lg p-3"),f=Me(()=>r.value==="dark"?"bg-[rgba(36,43,50,0.95)] text-white hover:text-white border-none shadow-sm rounded-full":"bg-white text-black hover:text-black border border-gray-300 shadow-sm rounded-full"),y=Me(()=>r.value==="dark"?"bg-[rgba(36,43,50,0.75)] text-white hover:text-white hover:bg-[rgba(36,43,50,0.85)] active:bg-[rgba(36,43,50,0.9)] focus:bg-[rgba(36,43,50,0.85)] border border-white/70":"bg-[rgba(24,28,32,0.6)] text-white hover:text-white hover:bg-[rgba(24,28,32,0.7)] active:bg-[rgba(24,28,32,0.75)] focus:bg-[rgba(24,28,32,0.7)] border border-white/70"),T=ee(""),C=Me(()=>Math.ceil(S.total/15)),d=async()=>{const Y=parseInt(T.value);if(!Y||Y<1||Y>C.value||S.loading){Ye().add({title:"页码无效",description:`请输入 1-${C.value} 之间的数字`,color:"orange",timeout:2e3});return}try{const U=document.querySelector(".content-wrapper"),X=U?U.scrollTop:window.scrollY,ne=await S.getMessages({page:Y,pageSize:15});if(!ne)throw new Error("跳转页面失败");const Le=ne.items.filter(ye=>!ye.pinned);S.messages=[...ke.value,...Le],S.page=ne.page||Y,T.value="",await at(),U?U.scrollTo({top:X,behavior:"instant"}):window.scrollTo({top:X,behavior:"instant"})}catch(U){console.error("跳转页面失败:",U),Ye().add({title:"跳转失败",color:"red",timeout:2e3})}},u=k,m=Me(()=>{const Y=u.siteConfig||{},U=String(Y.commentSystem||"waline").toLowerCase();return(typeof Y.commentEnabled=="boolean"?!!Y.commentEnabled:!0)&&U==="waline"&&!!Y.walineServerURL});gt(()=>u.targetMessageId,async Y=>{if(!Y)return;await at();const U=document.querySelector(`.content-container[data-msg-id="${Y}"]`);U&&(U.scrollIntoView({behavior:"smooth",block:"center"}),U.classList.add("highlight-message"),setTimeout(()=>{U.classList.remove("highlight-message")},2e3))},{immediate:!0});const g=$n().public.baseApi||"/api",w=ee(!0),b=async()=>{try{const Y=await fetch(`${g}/status`,{credentials:"include"});w.value=!!Y&&Y.ok}catch{w.value=!1}};Ja();const S=Xa(),_=ee(null),M=ee({}),x=ee({}),v=Me(()=>{var U;const Y=(U=u.siteConfig)==null?void 0:U.commentEnabled;return Y===!0||Y==="true"}),O=Me(()=>{const Y=u.siteConfig||{};return String(Y.commentSystem||"waline").toLowerCase()==="builtin"}),H=Cr(),z=Me(()=>H.isLogin),I=async Y=>{try{const U=encodeURIComponent(Y.trim()),X=await fetch(`${g}/messages/tags/${U}`,{credentials:"include",headers:{Accept:"application/json"}});if(!X.ok)throw new Error(`HTTP error! status: ${X.status}`);const ne=await X.json();if(ne.code===1&&Array.isArray(ne.data))Ue.value=!0,ge.value=ne.data,await at(),j(),V();else throw new Error(ne.msg||"获取标签内容失败")}catch(U){console.error("获取标签消息失败:",U),Ye().add({title:"获取标签消息失败",description:U.message||"服务器错误，请稍后重试",color:"red",timeout:3e3})}},R=async()=>{ge.value=[],Ue.value=!1,await S.getMessages({page:1,pageSize:15}),await at(),j(),V()},N=async Y=>{if(confirm("确定要删除这条消息吗？"))try{await S.deleteMessage(Y),S.messages=S.messages.filter(X=>X.id!==Y),Ye().add({title:"删除成功",color:"green",timeout:2e3})}catch(X){console.error("删除失败:",X),Ye().add({title:"删除失败",color:"red",timeout:2e3})}},V=()=>{if(window.Fancybox){window.Fancybox.destroy();const Y={Carousel:{infinite:!1},Toolbar:{display:[{id:"prev",position:"center"},{id:"counter",position:"center"},{id:"next",position:"center"},"zoom","slideshow","fullscreen","close"]},Image:{zoom:!0,click:!0,wheel:"slide"}};document.querySelectorAll(".markdown-preview img").forEach(X=>{const ne=X.getAttribute("src")||"",Le=/^https?:\/\//i.test(ne),ye=X.parentElement;if(ye&&ye.tagName==="A"&&ye.hasAttribute("data-fancybox")){Le||ye.replaceWith(X);return}if(Le){const ft=document.createElement("a");ft.href=ne,ft.setAttribute("data-fancybox","uploaded-image"),ft.style.display="block",X.parentNode.insertBefore(ft,X),ft.appendChild(X)}else ye&&ye.tagName==="A"&&ye.hasAttribute("data-fancybox")&&ye.replaceWith(X)}),window.Fancybox.bind("[data-fancybox]",Y)}},se=async Y=>{var X,ne;if(!!(x.value[Y]||_.value===Y)){x.value[Y]=!1,_.value===Y&&(_.value=null);return}if(_.value=Y,await at(),M.value[Y]=(M.value[Y]||0)+1,x.value[Y]=!0,(((X=u.siteConfig)==null?void 0:X.commentSystem)||"waline")==="builtin"){window.dispatchEvent(new Event(`refresh-comments-${Y}`));const Le=document.querySelector(`.content-container[data-msg-id="${Y}"] .builtin-comments`);if(Le){Le.scrollIntoView({behavior:"smooth",block:"center"});const ye=Le.querySelector("textarea");(ne=ye==null?void 0:ye.focus)==null||ne.call(ye)}return}m.value&&window.Waline&&(document.querySelector(`#waline-${Y}`)?window.Waline.init({el:`#waline-${Y}`,serverURL:u.siteConfig.walineServerURL,path:`messages/${Y}`,reaction:!1,meta:["nick","mail","link"],requiredMeta:["mail","nick"],pageview:!0,search:!1,wordLimit:200,pageSize:5,avatar:"monsterid",emoji:["https://unpkg.com/@waline/emojis@1.2.0/tieba"],imageUploader:!1,copyright:!1,dark:'html[class="dark"]'}):console.error(`评论容器 #waline-${Y} 未找到`))},ue=Y=>{if(!z.value)return!1;const U=H.user;if(!U)return!1;const X=!!(U.IsAdmin||U.is_admin),ne=(U.ID||U.userid)===Y.user_id;return X||ne},ke=ee([]),Re=async Y=>{try{const U=!Y.pinned;await S.setPinned(Y.id,U)&&(U?ke.value.some(ne=>ne.id===Y.id)||(ke.value=[Y,...ke.value]):ke.value=ke.value.filter(ne=>ne.id!==Y.id),Ye().add({title:U?"已置顶":"已取消置顶",color:"green",timeout:1500}))}catch{Ye().add({title:"操作失败",color:"red",timeout:2e3})}},_e=Y=>{const U=new Date(Y),ne=new Date().getTime()-U.getTime(),Le=Math.floor(ne/(1e3*60*60*24)),ye=Math.floor(ne/(1e3*60*60)),ft=Math.floor(ne/(1e3*60));return Math.floor(ne/1e3)<60?"刚刚":ft<60?`${ft}分钟前`:ye<24?`${ye}小时前`:Le<3?`${Le}天前`:U.toLocaleString()},Te=ee({}),Ne=ee({}),Oe=ee({}),$e=Y=>{Te.value[Y]=!Te.value[Y]},j=()=>{at(()=>{(Ue.value?ge.value:S.messages).forEach(U=>{const X=document.querySelector(`.content-container[data-msg-id="${U.id}"] .overflow-y-hidden`);if(!X)return;const ne=!!document.querySelector(`.content-container[data-msg-id="${U.id}"] .image-grid`);if(Oe.value[U.id]=ne,ne){Ne.value[U.id]=!1,Te.value[U.id]=!0;return}X.scrollHeight>700?(Ne.value[U.id]=!0,Te.value[U.id]===void 0&&(Te.value[U.id]=!1)):Ne.value[U.id]=!1})})};gt(()=>S.messages,()=>{ce.hash.includes("/messages/")||at(()=>{requestAnimationFrame(()=>{j(),V()})})},{deep:!0});const ce=Ka();Wt(async()=>{try{await b();const Y=ce.hash.split("/messages/").pop();if(m.value&&!window.Waline){const U=document.createElement("link");U.rel="stylesheet",U.href="https://unpkg.com/@waline/client@v2/dist/waline.css",document.head.appendChild(U),await new Promise((X,ne)=>{const Le=document.createElement("script");Le.src="https://unpkg.com/@waline/client@v2/dist/waline.js",Le.crossOrigin="anonymous",Le.onload=X,Le.onerror=ne,document.head.appendChild(Le)})}if(Y){const U=await fetch(`${g}/messages/${Y}`,{credentials:"include",headers:{Accept:"application/json"}});if(!U.ok)throw new Error("消息加载失败");const X=await U.json();if(X.code===1&&X.data){S.messages=[X.data],S.hasMore=!1,S.page=1,await at();const ne=document.querySelector(`.content-container[data-msg-id="${Y}"]`);ne&&ne.scrollIntoView({behavior:"instant",block:"start"})}else throw new Error("消息不存在")}else if(!ce.hash.includes("/messages/")){const U=await fetch(`${g}/messages/page`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({page:1,pageSize:15})});if(U.ok){const X=await U.json();X.code===1&&X.data&&(S.messages=X.data.items||[],S.total=X.data.total||0,S.hasMore=S.messages.length<S.total,S.page=1)}}await at(),j(),V();try{const U=(S.messages||[]).map(async X=>{try{let ne=null;const Le=await fetch(`${g}/messages/${X.id}/comments`,{credentials:"include",headers:{Accept:"application/json"}});if(Le&&Le.ok)ne=await Le.json();else{const ft=await fetch(`http://localhost:1315/api/messages/${X.id}/comments`,{credentials:"include",headers:{Accept:"application/json"}});ft&&ft.ok&&(ne=await ft.json())}(ne&&Array.isArray(ne.data)?ne.data.length:0)>0&&(x.value[X.id]=!0)}catch{}});await Promise.allSettled(U),await at(),m.value&&window.Waline&&(S.messages||[]).forEach(X=>{if(x.value[X.id]&&document.querySelector(`#waline-${X.id}`))try{window.Waline.init({el:`#waline-${X.id}`,serverURL:u.siteConfig.walineServerURL,path:`messages/${X.id}`,reaction:!1,meta:["nick","mail","link"],requiredMeta:["mail","nick"],pageview:!0,search:!1,wordLimit:200,pageSize:5,avatar:"monsterid",emoji:["https://unpkg.com/@waline/emojis@1.2.0/tieba"],imageUploader:!1,copyright:!1,dark:'html[class="dark"]'})}catch{}})}catch{}}catch(Y){console.error("初始化失败:",Y),Y instanceof Error&&Ye().add({title:"加载失败",description:Y.message||"请刷新重试",color:"red",timeout:2e3})}}),gt(()=>ce.hash,async Y=>{const U=Y.split("/messages/").pop();if(!U){if(!ce.hash.includes("/messages/")){const X=await fetch(`${g}/messages/page`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({page:1,pageSize:15})});if(X.ok){const ne=await X.json();if(ne.code===1&&ne.data){S.messages=ne.data.items||[],S.total=ne.data.total||0,S.hasMore=S.messages.length<S.total,S.page=1,x.value={};try{const Le=(S.messages||[]).map(async ye=>{try{const ft=await fetch(`${g}/messages/${ye.id}/comments`,{credentials:"include",headers:{Accept:"application/json"}});if(ft.ok){const Yt=await ft.json();(Array.isArray(Yt.data)?Yt.data.length:0)>0&&(x.value[ye.id]=!0)}}catch{}});await Promise.allSettled(Le)}catch{}}}}return}try{const X=await fetch(`${g}/messages/${U}`,{credentials:"include",headers:{Accept:"application/json"}});if(!X.ok)throw new Error("消息加载失败");const ne=await X.json();if(ne.code===1&&ne.data){S.messages=[ne.data],S.hasMore=!1,S.page=1,await at();const Le=document.querySelector(`.content-container[data-msg-id="${U}"]`);Le&&Le.scrollIntoView({behavior:"instant",block:"start"})}}catch(X){console.error("加载消息失败:",X),Ye().add({title:"加载失败",color:"red",timeout:2e3})}},{immediate:!0});const G=ee(!1),W=async()=>{if(!(G.value||S.page<=1)){G.value=!0;try{const Y=document.querySelector(".content-wrapper"),U=Y?Y.scrollTop:window.scrollY,X=S.page-1,ne=await S.getMessages({page:X,pageSize:15});if(ne&&Array.isArray(ne.items)){const Le=ne.items.filter(ye=>!ye.pinned);S.messages=[...ke.value,...Le],S.page=ne.page||X}else S.page=X;await at(),Y?Y.scrollTo({top:U,behavior:"instant"}):window.scrollTo({top:U,behavior:"instant"})}catch{Ye().add({title:"加载失败",color:"red",timeout:2e3})}finally{G.value=!1}}},Z=async()=>{if(!(G.value||!S.hasMore)){G.value=!0;try{const Y=document.querySelector(".content-wrapper"),U=Y?Y.scrollTop:window.scrollY,X=S.page+1,ne=await S.getMessages({page:X,pageSize:15});if(ne&&Array.isArray(ne.items)){const Le=ne.items.filter(ye=>!ye.pinned);S.messages=[...ke.value,...Le],S.page=ne.page||X}else S.page=X;await at(),Y?Y.scrollTo({top:U,behavior:"instant"}):window.scrollTo({top:U,behavior:"instant"})}catch{Ye().add({title:"加载失败",color:"red",timeout:2e3})}finally{G.value=!1}}};gt(()=>H.isLogin,Y=>{Y&&S.getMessages({page:1,pageSize:15})}),gt(()=>S.messages,async()=>{try{if(S.page===1){const U=(S.messages||[]).filter(X=>X.pinned).filter((X,ne,Le)=>Le.findIndex(ye=>ye.id===X.id)===ne);ke.value=U}await at(),j(),V()}catch(Y){console.error("更新视图失败:",Y)}},{deep:!0}),ai(()=>{window.Fancybox&&window.Fancybox.destroy()});const B=async Y=>{try{await navigator.clipboard.writeText(Y),Ye().add({title:"复制成功",color:"green",timeout:2e3})}catch(U){console.error("复制失败:",U),Ye().add({title:"复制失败",color:"red",timeout:2e3})}},ae=ee(!1),K=ee(""),$=ee(null),xe=ee(!1),re=Y=>{if($.value=Y.id,K.value=Y.content,Y.image_url){const U=`

<!-- 附件图片(编辑时可删除) -->
![附件图片](${g}${Y.image_url})
<!-- 附件图片结束 -->`;K.value+=U}ae.value=!0},qe=async()=>{if($.value){xe.value=!0;try{const Y=S.messages.find(Le=>Le.id===$.value);if(!Y)return;let U=K.value;if(U=U.replace(/\n*<!-- 附件图片\(编辑时可删除\) -->\n!\[附件图片\]\(.*?\)\n<!-- 附件图片结束 -->\n*/g,""),U===Y.content){Ye().add({title:"内容未修改",description:"请修改内容后再保存",color:"orange",timeout:2e3}),xe.value=!1;return}const X=await fetch(`${g}/messages/${$.value}`,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({content:U,image_url:Y.image_url})});if(!X.ok)throw new Error(`HTTP error! status: ${X.status}`);const ne=await X.json();if(ne.code===1){const Le=S.messages.findIndex(ye=>ye.id===$.value);Le!==-1&&(S.messages[Le]={...S.messages[Le],content:K.value,image_url:Y.image_url}),ae.value=!1,Ye().add({title:"更新成功",color:"green",timeout:2e3})}else throw new Error(ne.msg||"保存失败")}catch(Y){console.error("更新消息失败:",Y),Ye().add({title:"更新失败",color:"red",timeout:2e3})}finally{xe.value=!1}}},Be=async Y=>{var U,X;try{const ne=document.querySelector(`.content-container[data-msg-id="${Y}"]`);if(!ne)return;const Le=(X=(U=ne.querySelector(".markdown-preview"))==null?void 0:U.textContent)==null?void 0:X.trim(),ye=ne.querySelector("img"),ft=ne.querySelector("video"),Yt=ne.querySelector("audio");if(!Le&&!ye&&ft||!Le&&!ye&&Yt){Ye().add({title:"此内容不可生成卡片",color:"orange",timeout:2e3});return}const Pe=setTimeout(()=>{Ye().add({title:"生成超时",description:"卡片生成时间过长，请稍后重试",color:"red",timeout:3e3})},1e4),xt=Te.value[Y];Te.value[Y]=!0,await at();const wt=document.createElement("div");wt.style.cssText=`
  padding: 16px;
  background: transparent;
  border-radius: 12px;
  width: ${ye?"640px":"480px"};
  position: absolute;
  left: -9999px;
  top: 0;
  z-index: -1;
  overflow: visible;
  min-height: fit-content;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
  border: none;
`,document.body.appendChild(wt);const Ot=ne.cloneNode(!0),Xt=window.getComputedStyle(ne),J=Xt.backgroundColor&&Xt.backgroundColor!=="rgba(0, 0, 0, 0)"?Xt.backgroundColor:"#ffffff",fe=Xt.color||"#333";Ot.querySelectorAll(".text-center.mt-2, .bg-gradient-to-t").forEach(nt=>nt.remove()),Ot.style.cssText=`
      max-height: none;
      overflow: visible;
      padding: 0;
      margin: 0;
      background: ${J};
      border-radius: 12px;
    `;const Se=Ot.querySelector(".overflow-y-hidden");Se&&(Se.className="",Se.style.cssText=`
        overflow: visible;
        max-height: none !important;
        height: auto !important;
        padding: 4px 12px;
        line-height: 1.6;
        margin-top: 0;
        margin-bottom: 0;
        white-space: pre-wrap;
        background: ${J};
        border-radius: 12px;
        font-size: 14px;
        color: ${fe};
      `);const be=Array.from(Ot.children).find(nt=>nt.tagName==="IMG");be&&(be.style.margin="1px 0",be.style.display="block"),Ot.querySelectorAll("img").forEach(nt=>{nt.style.margin="1px 0",nt.style.display="block"});const ze=Ot.querySelector(".border-t");ze&&(ze.style.margin="1px 0");const et=Ot.querySelector(".markdown-preview");if(et){et.style.marginTop="1px";const nt=et.firstElementChild;nt&&(nt.style.marginTop="1px"),et.querySelectorAll("p, h1, h2, h3, h4, h5, h6").forEach(Ve=>{Ve.style.marginTop=Ve.style.marginTop||"2px"})}Ot.querySelectorAll("video, audio, iframe").forEach(nt=>{var rt;const Ve=document.createElement("div");Ve.style.cssText=`
        padding: 15px;
        background: rgba(251, 146, 60, 0.1);
        border: 1px solid rgba(251, 146, 60, 0.3);
        border-radius: 8px;
        color: #fb923c;
        margin: 15px 0;
        word-break: break-all;
      `,nt instanceof HTMLVideoElement?Ve.innerHTML=`🎬 视频链接：${nt.src||"未知链接"}`:nt instanceof HTMLAudioElement?Ve.innerHTML=`🎵 音频链接：${nt.src||"未知链接"}`:nt instanceof HTMLIFrameElement&&(Ve.innerHTML=`🔗 嵌入内容链接：${nt.src||"未知链接"}`),(rt=nt.parentNode)==null||rt.replaceChild(Ve,nt)}),await(async()=>{const nt=Ot.querySelectorAll("img");await Promise.all(Array.from(nt).map(async Ve=>new Promise(rt=>{const Lt=Ve.src;Ve.crossOrigin="anonymous",Lt.startsWith("/")?(Ve.src=`${g}${Lt}`,fetch(Ve.src,{credentials:"include"}).then(Bt=>Bt.blob()).then(Bt=>{Ve.src=URL.createObjectURL(Bt),rt()}).catch(()=>{var Bt;console.error("图片加载失败:",Lt),(Bt=Ve.parentElement)==null||Bt.removeChild(Ve),rt()})):Ve.complete?rt():(Ve.onload=()=>rt(),Ve.onerror=()=>{var Bt;console.error("图片加载失败:",Lt),(Bt=Ve.parentElement)==null||Bt.removeChild(Ve),rt()})})))})(),wt.appendChild(Ot);const ut=document.createElement("div");ut.style.cssText=`
    margin-top: 12px;
    padding-top: 12px;
    text-align: center;
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    background: transparent;
  `,ut.innerHTML=`
    <div style="color: #fb923c; font-size: 13px; margin-bottom: 4px; font-weight: 500;">
      ${u.siteConfig.cardFooterTitle}
    </div>
    <a href="https://note.noisework.cn" 
       target="_blank" 
       rel="noopener noreferrer" 
       style="color: rgba(255,255,255,0.5); text-decoration: none;">
      ${u.siteConfig.cardFooterSubtitle}
    </a>
  `,wt.appendChild(ut),await at();const mt=await html2canvas(wt,{backgroundColor:null,scale:2,useCORS:!0,allowTaint:!0,logging:!1,width:wt.offsetWidth,height:wt.scrollHeight,borderRadius:"16px",onclone:nt=>{const Ve=nt.querySelector(".content-container");Ve&&(Ve.style.cssText=`
            overflow: visible !important;
            max-height: none !important;
            height: auto !important;
            padding: 0;
            min-height: ${(Se==null?void 0:Se.scrollHeight)||0}px;
            background: ${J};
            border-radius: 12px;
          `)}});clearTimeout(Pe);const Et=document.createElement("a");Et.download=`message-${Y}.png`,Et.href=mt.toDataURL("image/png"),Et.click(),document.body.removeChild(wt),Te.value[Y]=xt,Ye().add({title:"下载成功",color:"green",timeout:2e3})}catch(ne){console.error("下载失败:",ne),Ye().add({title:"下载失败",color:"red",timeout:2e3})}},Ue=ee(!1),ge=ee([]),Ze=async Y=>{var U;try{const X=Ue.value?null:window.scrollY;if(console.debug("API返回的原始数据:",Y),!Y)throw new Error("API返回数据为空");let ne=[],Le=0;if(Y.code===1?Array.isArray(Y.data)?ne=Y.data:(U=Y.data)!=null&&U.items&&(ne=Y.data.items):Array.isArray(Y)&&(ne=Y),!Array.isArray(ne))throw new Error("无效的数据格式");Le=ne.length,Ue.value=!0,ge.value=ne,Le===0?Ye().add({title:"未找到相关内容",color:"orange",timeout:2e3}):Ye().add({title:`找到 ${Le} 条结果`,color:"green",timeout:2e3}),X!==null&&window.scrollTo({top:0,behavior:"smooth"}),await at(),j(),V()}catch(X){console.error("处理搜索结果时出错:",X),Ye().add({title:"搜索失败",description:X.message||"处理搜索结果时发生错误",color:"red",timeout:2e3}),lt()}},lt=()=>{ge.value=[],Ue.value=!1,console.log("重置搜索 - searchResults:",ge.value),console.log("重置搜索 - isSearchMode:",Ue.value),at(()=>{j(),V()})},ct=Me(()=>{if(Ue.value&&Array.isArray(ge.value))return ge.value;const Y=S.messages||[];if(!ke.value.length)return Y;const U=Y.filter(X=>!ke.value.some(ne=>ne.id===X.id));return[...ke.value,...U]});return n({handleSearchResult:Ze}),gt(ge,Y=>{console.log("searchResults变化:",Y),at(()=>{j(),V()})},{deep:!0,immediate:!0}),gt(Ue,Y=>{console.log("isSearchMode变化:",Y),at(()=>{j(),V()})}),Me(()=>({cardFooterTitle:u.siteConfig.cardFooterTitle,cardFooterSubtitle:u.siteConfig.cardFooterSubtitle,pageFooterHTML:u.siteConfig.pageFooterHTML,walineServerURL:u.siteConfig.walineServerURL})),(Y,U)=>{const X=Fn,ne=Gt,Le=Tr,ye=hl,ft=kr,Yt=Ga;return ie(),de(Ht,null,[q("div",vu,[De(ct).length?He("",!0):(ie(),de("div",yu,[ve(X,{name:"i-heroicons-inbox",class:"w-12 h-12 mx-auto mb-4"}),U[5]||(U[5]=q("p",null,"暂无消息内容",-1))])),q("div",bu,[De(Ue)?(ie(),de("div",wu,[q("p",Eu,"搜索结果 ("+Qe(De(ge).length)+" 条)",1),ve(ne,{size:"sm",variant:"ghost",class:"text-gray-400 hover:text-orange-500",icon:"i-heroicons-arrow-left",onClick:R},{default:dt(()=>U[6]||(U[6]=[Tt(" 返回完整列表 ")])),_:1})])):He("",!0),q("div",Su,[De(Ue)&&De(ge).length===0?(ie(),de("div",Cu,[ve(X,{name:"i-heroicons-magnifying-glass",class:"w-12 h-12 mx-auto mb-4"}),U[7]||(U[7]=q("p",null,"未找到相关内容",-1))])):He("",!0),(ie(!0),de(Ht,null,Vt(De(ct),Pe=>{var xt;return ie(),de("div",{key:Pe.id,class:"w-full h-auto overflow-hidden flex flex-col justify-between"},[q("div",ku,[q("div",Tu,[U[9]||(U[9]=q("div",{class:"w-2 h-2 rounded-full bg-orange-600 mr-2 flex-shrink-0"},null,-1)),q("div",xu,[q("span",_u,Qe(_e(Pe.created_at)),1),U[8]||(U[8]=q("span",{class:"gradient-dot mx-2 flex-shrink-0"},"@",-1)),q("span",Mu,Qe(Pe.username||"匿名用户"),1),Pe.pinned?(ie(),de("div",Lu,[ve(X,{name:"i-mdi-pin",class:"w-4 h-4"})])):He("",!0)])]),q("div",Au,[Pe.private?(ie(),de("div",Du,[ve(X,{name:"i-mdi-lock-outline",class:"text-gray-400"})])):He("",!0),ue(Pe)?(ie(),de("div",{key:1,class:"w-5 h-5 cursor-pointer flex-shrink-0 transition-all duration-200 hover:scale-110",onClick:wt=>Re(Pe),title:Pe.pinned?"取消置顶":"置顶内容"},[ve(X,{name:Pe.pinned?"i-mdi-pin":"i-mdi-pin-outline",class:"text-gray-400 hover:text-orange-500"},null,8,["name"])],8,Ou)):He("",!0),De(z)?(ie(),de("div",{key:2,class:"w-5 h-5 cursor-pointer flex-shrink-0 transition-all duration-200 hover:scale-110",onClick:wt=>re(Pe),title:"编辑内容"},[ve(X,{name:"i-mdi-pencil-outline",class:"text-gray-400 hover:text-orange-500"})],8,Pu)):He("",!0),q("div",{class:"w-5 h-5 cursor-pointer flex-shrink-0 transition-all duration-200 hover:scale-110",onClick:wt=>B(Pe.content),title:"复制内容"},[ve(X,{name:"i-mdi-content-copy",class:"text-gray-400 hover:text-orange-500"})],8,Ru),q("div",{class:"w-5 h-5 cursor-pointer flex-shrink-0 transition-all duration-200 hover:scale-110",onClick:wt=>Be(Pe.id),title:"下载为图片"},[ve(X,{name:"i-mdi-image-outline",class:"text-gray-400 hover:text-orange-500"})],8,Iu),q("div",{class:"w-5 h-5 cursor-pointer flex-shrink-0 transition-all duration-200 hover:scale-110",onClick:wt=>se(Pe.id),title:"评论"},[ve(X,{name:"i-mdi-comment-outline",class:"text-gray-400 hover:text-orange-500"})],8,Hu),De(z)?(ie(),de("div",{key:3,class:"w-5 h-5 cursor-pointer flex-shrink-0 transition-all duration-200 hover:scale-110",onClick:wt=>N(Pe.id),title:"删除"},[ve(X,{name:"i-mdi-paper-roll-outline",class:"text-gray-400 hover:text-orange-500"})],8,Nu)):He("",!0)])]),q("div",ju,[Pe.image_url||Pe.content?(ie(),de("div",{key:0,class:Fe(["content-container",De(s)]),"data-msg-id":Pe.id},[Pe.image_url?(ie(),de("img",{key:0,src:`${De(g)}${Pe.image_url}`,alt:"Image",class:"max-w-full object-cover rounded-lg mb-4",loading:"lazy",fetchpriority:Y.index<3?"high":"low"},null,8,zu)):He("",!0),Pe.image_url&&Pe.content?(ie(),de("div",$u)):He("",!0),q("div",{class:Fe(["overflow-y-hidden relative",[{"max-h-[700px]":!De(Te)[Pe.id]&&!De(Oe)[Pe.id]},De(c)]])},[ve(ri,{content:Pe.content,enableGithubCard:((xt=k.siteConfig)==null?void 0:xt.enableGithubCard)===!0,onTagClick:I,onRendered:j,"link-target":"_blank"},null,8,["content","enableGithubCard"]),De(Ne)[Pe.id]&&!De(Te)[Pe.id]?(ie(),de("div",{key:0,class:Fe(["absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t",De(h)])},null,2)):He("",!0)],2),De(Ne)[Pe.id]?(ie(),de("div",Fu,[q("button",{onClick:wt=>$e(Pe.id),class:Fe(["expand-toggle-btn flex items-center justify-center space-x-1 mx-auto px-4 py-2 focus:outline-none transition-colors duration-200",De(f)])},[q("span",null,Qe(De(Te)[Pe.id]?"收起内容":"展开全文"),1),ve(X,{name:De(Te)[Pe.id]?"i-mdi-chevron-up":"i-mdi-chevron-down",class:"w-5 h-5"},null,8,["name"])],10,Uu)])):He("",!0)],10,Bu)):He("",!0),(De(x)[Pe.id]||De(_)===Pe.id)&&De(v)?(ie(),de("div",{key:1,id:`comment-container-${Pe.id}`,class:Fe(["mt-4",De(p)]),style:{position:"relative"}},[De(O)&&De(w)?(ie(),qt(gu,{key:De(M)[Pe.id]||0,"message-id":Pe.id,"site-config":k.siteConfig,"show-input":De(_)===Pe.id},null,8,["message-id","site-config","show-input"])):De(m)&&De(w)?(ie(),de("div",{key:1,id:`waline-${Pe.id}`},null,8,qu)):He("",!0)],10,Vu)):He("",!0)])])}),128))]),De(Ue)?He("",!0):(ie(),de("div",Wu,[q("div",Yu,[De(S).page>1?(ie(),qt(ne,{key:0,color:"gray",variant:"ghost",size:"xs",class:Fe(["rounded-full px-4 py-1.5 shadow-lg hover:shadow-xl transition-all duration-300 backdrop-blur-sm",De(y)]),onClick:W,disabled:De(G)},{default:dt(()=>[ve(X,{name:"i-heroicons-arrow-left",class:"mr-1 w-4 h-4"}),U[10]||(U[10]=Tt(" 上一页 "))]),_:1},8,["class","disabled"])):He("",!0),De(S).hasMore?(ie(),qt(ne,{key:1,color:"gray",variant:"ghost",size:"xs",class:Fe(["rounded-full px-4 py-1.5 shadow-lg hover:shadow-xl transition-all duration-300 backdrop-blur-sm",De(y)]),onClick:Z,disabled:De(G)},{default:dt(()=>[U[11]||(U[11]=Tt(" 下一页 ")),ve(X,{name:"i-heroicons-arrow-right",class:"ml-1 w-4 h-4"})]),_:1},8,["class","disabled"])):He("",!0),De(G)?(ie(),de("span",Ku,"加载中...")):He("",!0)]),q("div",Gu,[q("span",Zu,"第 "+Qe(De(S).page)+" 页",1),ve(Le,{modelValue:De(T),"onUpdate:modelValue":U[0]||(U[0]=Pe=>nr(T)?T.value=Pe:null),type:"number",min:"1",max:De(C),class:"w-12 text-center text-sm",placeholder:"#",onKeyup:Ya(d,["enter"])},null,8,["modelValue","max"]),ve(ne,{size:"xs",color:"gray",variant:"ghost",class:"text-gray-400 hover:text-orange-500 text-sm",onClick:d},{default:dt(()=>U[12]||(U[12]=[Tt(" 跳转 ")])),_:1})])])),!De(Ue)&&De(S).messages.length>0&&!De(S).hasMore?(ie(),de("div",Xu,[ve(X,{name:"i-fluent-emoji-flat-confetti-ball",size:"lg"}),U[13]||(U[13]=Tt(" 加载完毕~ "))])):He("",!0)]),k.siteConfig.pageFooterHTML?(ie(),de("div",{key:2,innerHTML:k.siteConfig.pageFooterHTML},null,8,Qu)):(ie(),de("div",Ju,U[14]||(U[14]=[Tt(" 来自"),q("a",{href:"https://www.noisework.cn",target:"_blank",rel:"noopener noreferrer",class:"text-orange-400 hover:text-orange-500"},"Noise",-1),Tt(" 使用"),q("a",{href:"https://github.com/rcy1314/echo-noise",target:"_blank",rel:"noopener noreferrer",class:"text-orange-400 hover:text-orange-500"},"Ech0-Noise",-1),Tt("发布 ")])))]),ve(Yt,{modelValue:De(ae),"onUpdate:modelValue":U[4]||(U[4]=Pe=>nr(ae)?ae.value=Pe:null),ui:{width:"sm:max-w-2xl"}},{default:dt(()=>[ve(ft,null,{header:dt(()=>[q("div",ed,[U[15]||(U[15]=q("h3",{class:"text-lg font-medium"},"编辑内容",-1)),ve(ne,{color:"gray",variant:"ghost",icon:"i-mdi-close",class:"-my-1",onClick:U[1]||(U[1]=Pe=>ae.value=!1)})])]),footer:dt(()=>[q("div",ad,[ve(ne,{color:"gray",variant:"outline",onClick:U[3]||(U[3]=Pe=>ae.value=!1),class:"text-white"},{default:dt(()=>U[17]||(U[17]=[Tt(" 取消 ")])),_:1}),ve(ne,{color:"orange",onClick:qe,loading:De(xe),class:"text-white"},{default:dt(()=>U[18]||(U[18]=[Tt(" 保存 ")])),_:1},8,["loading"])])]),default:dt(()=>{var Pe;return[q("div",td,[ve(ye,{modelValue:De(K),"onUpdate:modelValue":U[2]||(U[2]=xt=>nr(K)?K.value=xt:null),placeholder:"编辑内容...",rows:"10",class:"font-mono text-sm"},null,8,["modelValue"]),q("div",nd,[U[16]||(U[16]=q("div",{class:"text-sm text-gray-500 mb-2"},"预览：",-1)),q("div",id,[q("div",rd,[ve(ri,{content:De(K),enableGithubCard:((Pe=k.siteConfig)==null?void 0:Pe.enableGithubCard)===!0},null,8,["content","enableGithubCard"])])])])])]}),_:1})]),_:1},8,["modelValue"])],64)}}}),sd=cn(od,[["__scopeId","data-v-38f15f99"]]),ld={class:"heatmap-header"},cd={class:"heatmap-legend"},ud={class:"legend-colors"},dd={class:"calendar-wrapper"},fd={class:"month-labels"},hd={class:"weekday-labels"},pd={class:"heatmap-grid"},md=["title"],gd=Dt({__name:"heatmap",setup(k){const n=ee([]),r=ee([]),s=ee(null),c=Me(()=>{if(!n.value.length)return Array(12).fill("").map((S,_)=>`${_+1}月`);const u=n.value.map(S=>new Date(S.date)),m=new Date(Math.min(...u)),g=[];let w=new Date(m);w.setDate(1);let b=w.getFullYear();for(let S=0;S<12;S++){const _=w.getMonth(),M=w.getFullYear();M!==b||S===0?(g.push(`${M}年${_+1}月`),b=M):g.push(`${_+1}月`),w.setMonth(_+1)}return g}),h=["日","一","二","三","四","五","六"],p=u=>["#9be9a8","#40c463","#30a14e","#216e39","#0e4429"][Math.min(u-1,4)]||"#ebedf0",f=u=>u.count?p(u.level):"rgba(235, 237, 240, 0.4)",y=async()=>{try{const m=await(await fetch("/api/messages/calendar")).json();m&&m.code===1&&m.data&&m.data.length>0?(n.value=m.data,d()):T()}catch(u){console.error("获取热力图数据失败:",u),T()}},T=()=>{const u=new Date,m=new Date(u);m.setMonth(u.getMonth()-11),m.setDate(1);const g=[];let w=new Date(m);for(;w<=u;){const b=Math.random()>.7?Math.floor(Math.random()*10)+1:0;g.push({date:C(w),count:b}),w.setDate(w.getDate()+1)}n.value=g,d()},C=u=>{const m=u.getFullYear(),g=String(u.getMonth()+1).padStart(2,"0"),w=String(u.getDate()).padStart(2,"0");return`${m}-${g}-${w}`},d=()=>{if(!n.value.length)return;const u=n.value.map(M=>new Date(M.date)),m=new Date(Math.min(...u));new Date(Math.max(...u));const g=new Date(m);g.setDate(1);const w=new Date(g);w.setMonth(g.getMonth()+11),w.setDate(w.getDate()+(6-w.getDay()));const b=new Map;n.value.forEach(M=>{M&&M.date&&M.count!==void 0&&b.set(M.date,M.count)});const S=[];let _=new Date(g);for(_.setDate(_.getDate()-_.getDay());_<=w;){const M=[];for(let x=0;x<7;x++){const v=C(_),O=b.get(v)||0;M.push({date:v,count:O,level:O?Math.min(Math.ceil(O/2),5):0}),_.setDate(_.getDate()+1)}S.push(M)}r.value=S};return Wt(()=>{y()}),(u,m)=>{const g=kr;return ie(),qt(g,{class:"mx-auto sm:max-w-2xl hover:shadow-md backdrop-blur-sm bg-black/40 shadow-lg text-white"},{default:dt(()=>[q("div",ld,[m[2]||(m[2]=q("h3",null,"内容发布日历",-1)),q("div",cd,[m[0]||(m[0]=q("span",null,"少",-1)),q("div",ud,[(ie(),de(Ht,null,Vt(5,w=>q("div",{key:w,style:xn({backgroundColor:p(w)})},null,4)),64))]),m[1]||(m[1]=q("span",null,"多",-1))])]),q("div",dd,[q("div",{class:"calendar-container",ref_key:"calendarContainer",ref:s},[q("div",fd,[(ie(!0),de(Ht,null,Vt(c.value,(w,b)=>(ie(),de("div",{class:"month-label",key:b},Qe(w),1))),128))]),q("div",hd,[(ie(),de(Ht,null,Vt(h,w=>q("div",{class:"weekday-label",key:w},Qe(w),1)),64))]),q("div",pd,[(ie(!0),de(Ht,null,Vt(r.value,(w,b)=>(ie(),de("div",{key:b,class:"heatmap-week"},[(ie(!0),de(Ht,null,Vt(w,(S,_)=>(ie(),de("div",{key:_,class:"heatmap-day",style:xn({backgroundColor:f(S)}),title:`${S.date}: ${S.count||0} 条内容`},null,12,md))),128))]))),128))])],512)])]),_:1})}}}),vd=cn(gd,[["__scopeId","data-v-4da783b8"]]),yd={class:"tags-container mx-auto w-full sm:max-w-2xl"},bd={class:"relative"},wd={class:"tags-wrapper"},Ed={class:"tags-scroll"},Sd=["onClick"],Cd={class:"tag-count"},kd=Dt({__name:"TagList",props:{tags:{type:Array,default:()=>[]}},emits:["tagClick","updateTags"],setup(k,{emit:n}){const r=n,s=ee(!1),c=ee(Date.now()),h=k,p=Me(()=>{const T=/[/?=&]/,C=/^(song|video|playlist)\?id=\d+$/,d=new Map;return h.tags.reduce((u,m)=>(d.has(m.name)||!T.test(m.name)&&!C.test(m.name)&&(d.set(m.name,!0),u.push(m)),u),[])},{}),f=T=>{r("tagClick",T)},y=async()=>{s.value||(s.value=!0,c.value=Date.now(),r("updateTags"),setTimeout(()=>{s.value=!1},1e3))};return(T,C)=>{const d=Fn;return ie(),de("div",yd,[q("div",bd,[q("div",wd,[q("div",Ed,[(ie(!0),de(Ht,null,Vt(p.value,u=>(ie(),de("span",{key:u.name+c.value,class:"tag-item",onClick:m=>f(u.name)},[Tt(" #"+Qe(u.name)+" ",1),q("span",Cd,"("+Qe(u.count)+")",1)],8,Sd))),128))])]),q("div",{class:"absolute -right-1 top-1/2 -translate-y-1/2 p-2 cursor-pointer transition-all duration-200 hover:scale-110 z-10",onClick:y,title:"刷新标签"},[ve(d,{name:"i-mdi-refresh",class:Fe(["w-5 h-5 text-gray-400 hover:text-orange-500",{"animate-spin":s.value}])},null,8,["class"])]),C[0]||(C[0]=q("div",{class:"scroll-fade"},null,-1))])])}}}),Td=cn(kd,[["__scopeId","data-v-a469a53f"]]),xd={class:"announcement-container mx-auto w-full sm:max-w-2xl px-2"},_d={class:"announcement-wrapper"},Md=["title"],Ld=Dt({__name:"AnnouncementBar",props:{text:{}},setup(k){return(n,r)=>{const s=Fn;return ie(),de("div",xd,[r[0]||(r[0]=q("div",{class:"divider"},null,-1)),q("div",_d,[ve(s,{name:"i-mdi-bell-outline",class:"w-5 h-5 text-orange-500 mr-2 flex-shrink-0"}),q("div",{class:"announcement-text",title:n.text},[ve(ri,{content:n.text,enableGithubCard:!1},null,8,["content"])],8,Md)])])}}}),Ad=cn(Ld,[["__scopeId","data-v-a8511e82"]]),Dd={key:0,class:"loading"},Od={class:"moments-header"},Pd={class:"header-title"},Rd={class:"profile-info"},Id=["src","alt"],Hd={class:"profile-text"},Nd={class:"title"},jd={class:"description"},Bd={key:0,class:"mx-auto sm:max-w-2xl mb-4"},zd=["data-playlist-id","data-song-id","data-position","data-theme","data-lyric","data-default-minimized","data-embed","data-autoplay"],Kd=Dt({__name:"index",setup(k){const n=ee(null),r=ee(null),s=W=>{console.log("接收到搜索结果:",W),n.value&&n.value.handleSearchResult(W)},c=ee(!1),h=ee(typeof window<"u"&&localStorage.getItem("contentTheme")||"light");ei("showHeatmap",c),ei("contentTheme",h),ei("toggleContentTheme",()=>{h.value=h.value==="dark"?"light":"dark",typeof window<"u"&&(localStorage.setItem("contentTheme",h.value),document.documentElement.className=h.value==="dark"?"dark":"")});const p=ee(null),f=()=>{const W=p.value;W?W.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"})},y=()=>{const W=p.value;if(W)W.scrollTo({top:W.scrollHeight,behavior:"smooth"});else{const Z=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight);window.scrollTo({top:Z,behavior:"smooth"})}},T=ee(!1),C=ee(!0),d=ee(!1),u=()=>{const W=p.value;if(!W){const ae=window.scrollY||document.documentElement.scrollTop||0,K=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight);C.value=ae<=2,d.value=window.innerHeight+ae>=K-2;return}const Z=W.scrollTop,B=W.scrollHeight;C.value=Z<=2,d.value=W.clientHeight+Z>=B-2};Wt(()=>{var W;u(),(W=p.value)==null||W.addEventListener("scroll",u,{passive:!0})}),Xn(()=>{var W;(W=p.value)==null||W.removeEventListener("scroll",u)});const m=Me(()=>C.value||d.value||T.value),g=Me(()=>d.value&&!C.value?"i-heroicons-arrow-up":"i-heroicons-arrow-down"),w=()=>{d.value&&!C.value?f():y()},b=Me(()=>h.value==="dark"),S=Me(()=>b.value?"scroll-button bg-[rgba(36,43,50,0.85)] hover:bg-[rgba(36,43,50,0.95)] text-white shadow-[0_6px_16px_rgba(0,0,0,0.35)]":"scroll-button bg-white/95 hover:bg-white text-gray-700 ring-1 ring-gray-200 shadow-[0_4px_12px_rgba(0,0,0,0.12)]"),_=Me(()=>b.value?"text-white w-6 h-6":"text-gray-600 w-6 h-6");gt(c,W=>{console.log("index.vue 中热力图状态变化:",W)}),da({meta:[{name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"}]});const M=Ka();gt(()=>M.hash,W=>{const Z=(W||"").split("/messages/").pop();r.value=Z||null},{immediate:!0});const x=ee({siteTitle:"",subtitleText:"",avatarURL:"",username:"",description:"",backgrounds:[],cardFooterTitle:"",cardFooterSubtitle:"",pageFooterHTML:"",rssTitle:"",rssDescription:"",rssAuthorName:"",rssFaviconURL:"",enableGithubCard:!1,pwaEnabled:!0,pwaTitle:"",pwaDescription:"",pwaIconURL:"",announcementText:"",announcementEnabled:!0,commentEnabled:!1,commentSystem:"waline",commentEmailEnabled:!1,walineServerURL:"",musicEnabled:!1,musicPlaylistId:"2141128031",musicSongId:"",musicPosition:"bottom-left",musicTheme:"auto",musicLyric:!0,musicAutoplay:!1,musicDefaultMinimized:!0,musicEmbed:!1,musicCssCdnURL:"",musicJsCdnURL:""}),v=async()=>{await at();const W=window.NeteaseMiniPlayer;W&&typeof W.init=="function"&&W.init()},O=async()=>{if(typeof window>"u")return!1;if(window.NeteaseMiniPlayer)return!0;const W=document.head,Z=document.body,B="nmp-css";if(!document.getElementById(B)){const K=document.createElement("link");K.id=B,K.rel="stylesheet";const $=x.value.musicCssCdnURL||"",xe="/NeteaseMiniPlayer/netease-mini-player-v2.css";K.href=$&&$.trim()!==""?$.trim():xe,K.onerror=()=>{K.href=xe},W.appendChild(K)}const ae="nmp-js";return document.getElementById(ae)?!!window.NeteaseMiniPlayer:await new Promise(K=>{const $=document.createElement("script");$.id=ae;const xe=x.value.musicJsCdnURL||"",re="/NeteaseMiniPlayer/netease-mini-player-v2.js";$.src=xe&&xe.trim()!==""?xe.trim():re,$.defer=!0,$.onload=()=>K(!!window.NeteaseMiniPlayer),$.onerror=()=>{if($.src!==re){$.src=re,$.onload=()=>K(!!window.NeteaseMiniPlayer),$.onerror=()=>K(!1);return}K(!1)},Z.appendChild($)})};gt(()=>x.value.musicEnabled,async W=>{W&&await O()&&await v()});const H=Me(()=>({"--bg-image":`url(${N.value||x.value.backgrounds[0]})`})),z=Me(()=>({"background-image":`url(${N.value||x.value.backgrounds[0]})`,"background-size":"cover","background-position":"center"})),I={siteTitle:"Noise的说说笔记",subtitleText:"欢迎访问，点击头像可更换封面背景！",avatarURL:"https://s2.loli.net/2025/03/24/HnSXKvibAQlosIW.png",username:"Noise",description:"执迷不悟",backgrounds:["https://s2.loli.net/2025/03/27/KJ1trnU2ksbFEYM.jpg","https://s2.loli.net/2025/03/27/MZqaLczCvwjSmW7.jpg","https://s2.loli.net/2025/03/27/UMijKXwJ9yTqSeE.jpg","https://s2.loli.net/2025/03/27/WJQIlkXvBg2afcR.jpg","https://s2.loli.net/2025/03/27/oHNQtf4spkq2iln.jpg","https://s2.loli.net/2025/03/27/PMRuX5loc6Uaimw.jpg","https://s2.loli.net/2025/03/27/U2WIslbNyTLt4rD.jpg","https://s2.loli.net/2025/03/27/xu1jZL5Og4pqT9d.jpg","https://s2.loli.net/2025/03/27/OXqwzZ6v3PVIns9.jpg","https://s2.loli.net/2025/03/27/HGuqlE6apgNywbh.jpg","https://s2.loli.net/2025/03/26/d7iyuPYA8cRqD1K.jpg","https://s2.loli.net/2025/03/27/wYy12qDMH6bGJOI.jpg","https://s2.loli.net/2025/03/27/y67m2k5xcSdTsHN.jpg"],cardFooterTitle:"Noise·说说·笔记~",cardFooterSubtitle:"note.noisework.cn",pageFooterHTML:'<div class="text-center text-xs text-gray-400 py-4">来自<a href="https://www.noisework.cn" target="_blank" rel="noopener noreferrer" class="text-orange-400 hover:text-orange-500">Noise</a> 使用<a href="https://github.com/rcy1314/echo-noise" target="_blank" rel="noopener noreferrer" class="text-orange-400 hover:text-orange-500">Ech0-Noise</a>发布</div>',rssTitle:"Noise的说说笔记",rssDescription:"一个说说笔记~",rssAuthorName:"Noise",rssFaviconURL:"/favicon.ico",enableGithubCard:!1,pwaEnabled:!0,pwaTitle:"",pwaDescription:"",pwaIconURL:"",announcementText:"欢迎访问我的说说笔记！",announcementEnabled:!0,commentEnabled:!1,commentSystem:"waline",commentEmailEnabled:!1,walineServerURL:"",musicEnabled:!1,musicPlaylistId:"2141128031",musicSongId:"",musicPosition:"bottom-left",musicTheme:"auto",musicLyric:!0,musicAutoplay:!1,musicDefaultMinimized:!0,musicEmbed:!1,musicCssCdnURL:"",musicJsCdnURL:""},R=async()=>{var W;try{x.value={...I};const Z=await sn("frontend/config",void 0,{credentials:"include"});if(Z&&Z.code===1&&Z.data&&Z.data.frontendSettings){const B=Z.data.frontendSettings,ae=["enableGithubCard","pwaEnabled","announcementEnabled","commentEnabled","commentEmailEnabled","musicEnabled","musicLyric","musicAutoplay","musicDefaultMinimized","musicEmbed"];Object.keys(x.value).forEach($=>{if(B[$]!==null&&B[$]!==void 0)if($==="backgrounds"&&Array.isArray(B[$]))x.value.backgrounds=[...B[$]];else if(ae.includes($)){const xe=B[$];x.value[$]=xe===!0||xe==="true"}else{const xe=B[$];x.value[$]=typeof xe=="string"?xe.trim():xe}});const K=(B.defaultContentTheme||"light").trim();typeof window<"u"&&!localStorage.getItem("contentTheme")?(h.value=K==="light"?"light":"dark",document.documentElement.className=h.value==="dark"?"dark":""):typeof window<"u"&&(document.documentElement.className=h.value==="dark"?"dark":"")}if((W=x.value.backgrounds)!=null&&W.length||(x.value.backgrounds=[...I.backgrounds]),x.value.backgrounds.length>0){const B=Math.floor(Math.random()*x.value.backgrounds.length);N.value=x.value.backgrounds[B]}V.value=!0}catch(Z){console.error("获取配置失败:",Z),x.value={...I},V.value=!0}},N=ee(""),V=ee(!1),se=ee(!1),ue=async W=>{const Z=B=>new Promise(ae=>{const K=new Image;K.src=B,K.onload=()=>ae(B),K.onerror=()=>ae(null)});await Promise.all(W.map(B=>Z(B)))};Xn(()=>{window.removeEventListener("frontend-config-updated",R)});const ke=async()=>{if(se.value)return;se.value=!0;const W=Math.floor(Math.random()*x.value.backgrounds.length),Z=x.value.backgrounds[W];if(Z===N.value){se.value=!1;return}const B=`${Z}?imageView2/2/w/10/blur/1/q/10`;N.value=B,requestAnimationFrame(()=>{const ae=new Image;ae.src=Z,ae.onload=()=>{requestAnimationFrame(()=>{N.value=Z,se.value=!1})},ae.onerror=()=>{se.value=!1}})};let Re=null;const _e=()=>{Re&&clearTimeout(Re),Re=setTimeout(()=>Te(),100)},Te=()=>{const W=(x.value.pwaTitle||x.value.siteTitle||"说说笔记").trim(),Z=(x.value.rssFaviconURL||"/favicon.ico").trim(),B=x.value.pwaIconURL&&x.value.pwaIconURL.trim()!==""?x.value.pwaIconURL.trim():Z.toLowerCase().endsWith(".png")?Z:"/android-chrome-192x192.png",ae=(x.value.pwaDescription||x.value.description||"").trim();da({title:W,meta:[{key:"description",name:"description",content:ae},{key:"theme-color",name:"theme-color",content:"#000000"}],link:[{key:"icon-32",rel:"icon",type:"image/png",href:"/favicon-32x32.png",sizes:"32x32"},{key:"shortcut-icon-32",rel:"shortcut icon",type:"image/png",href:"/favicon-32x32.png",sizes:"32x32"},{key:"icon-fallback",rel:"icon",href:Z},...x.value.pwaEnabled?[{key:"manifest",rel:"manifest",href:"/manifest.webmanifest"},{key:"apple-touch",rel:"apple-touch-icon",href:B,sizes:"180x180"},{key:"pwa-192",rel:"icon",href:B,sizes:"192x192"},{key:"pwa-512",rel:"icon",href:B.toLowerCase().endsWith(".png")?B:"/android-chrome-512x512.png",sizes:"512x512"}]:[]]})};gt(()=>[x.value.pwaEnabled,x.value.pwaTitle,x.value.pwaIconURL,x.value.pwaDescription,x.value.siteTitle,x.value.rssFaviconURL,x.value.description],()=>{_e()},{immediate:!0});const Ne=ee(null),Oe=ee([]),$e=async()=>{await j()},j=async()=>{try{const W=await sn("messages/tags");W&&W.code===1?Oe.value=W.data||[]:Oe.value=[]}catch(W){console.error("获取标签失败:",W),Oe.value=[]}};Wt(()=>{const W=()=>R();window.addEventListener("frontend-config-updated",W),R(),Xn(()=>window.removeEventListener("frontend-config-updated",W))});const ce=async W=>{try{const Z=encodeURIComponent(W.trim()),B=await sn(`messages/tags/${Z}`,void 0,{credentials:"include"});if(B&&B.code===1&&Array.isArray(B.data))n.value&&n.value.handleSearchResult(B.data);else throw new Error((B==null?void 0:B.msg)||"获取标签内容失败")}catch(Z){console.error("获取标签消息失败:",Z),Ye().add({title:"获取标签消息失败",description:Z.message||"服务器错误，请稍后重试",color:"red",timeout:3e3})}},G=()=>{if(!Ne.value)return;let W=0,Z=!1,B=!1;const ae=ml(()=>{if(!Ne.value){clearInterval(ae);return}B||(Z?(W--,Ne.value.textContent=x.value.subtitleText.slice(0,W),W<=0&&(B=!0,Ne.value.textContent="",setTimeout(()=>{Z=!1,B=!1,W=0},1e3))):(Ne.value.textContent=x.value.subtitleText.slice(0,W+1),W++,W>=x.value.subtitleText.length&&(B=!0,setTimeout(()=>{Z=!0,B=!1},2e3))))},100);return ae};return Wt(async()=>{try{if(V.value=!1,window.requestIdleCallback=window.requestIdleCallback||(Z=>setTimeout(Z,1)),await R(),x.value.musicEnabled&&await v(),fa(async()=>{await j(),await ue(x.value.backgrounds)}),x.value.backgrounds.length>0){const Z=x.value.backgrounds[Math.floor(Math.random()*x.value.backgrounds.length)],B=`${Z}?imageView2/2/w/100/q/30`;N.value=B,fa(async()=>{await ue(x.value.backgrounds)});const ae=new Image;ae.src=Z,ae.onload=()=>{requestAnimationFrame(()=>{N.value=Z,V.value=!0})},ae.onerror=()=>{V.value=!0},setTimeout(()=>{V.value||(V.value=!0)},2e3)}const W=G();Xn(()=>{W&&clearInterval(W)}),window.addEventListener("frontend-config-updated",async Z=>{var B;if(await R(),((B=x.value.backgrounds)==null?void 0:B.length)>0){const ae=Math.floor(Math.random()*x.value.backgrounds.length),K=x.value.backgrounds[ae];N.value=K}})}catch(W){console.error("初始化失败:",W),V.value=!0}}),(W,Z)=>{const B=Pl,ae=Fn,K=Gt;return ie(),de("div",{class:"background-container",style:xn(H.value)},[V.value?He("",!0):(ie(),de("div",Dd,Z[3]||(Z[3]=[q("div",{class:"rainbow-spinner"},null,-1),q("div",{class:"loading-text"},"加载中...",-1)]))),q("div",{ref_key:"contentWrapper",ref:p,class:Fe(["content-wrapper",{"gpu-accelerated":!0}])},[ve(B,{class:"container-fixed py-2 pb-4 my-4"},{default:dt(()=>[q("div",Od,[q("div",{class:"header-image",style:xn(z.value)},[q("h1",Pd,Qe(x.value.siteTitle),1),q("div",{ref_key:"subtitleEl",ref:Ne,class:"header-subtitle"},Qe(x.value.subtitleText),513),q("div",Rd,[q("img",{class:"avatar",onClick:ke,src:x.value.avatarURL,alt:x.value.username},null,8,Id),q("div",Hd,[q("div",Nd,Qe(x.value.username),1),q("div",jd,Qe(x.value.description),1)])])],4)]),c.value?(ie(),de("div",Bd,[ve(vd)])):He("",!0),ve(Vc,{onSearchResult:s}),Oe.value&&Oe.value.length>0?(ie(),qt(Td,{key:1,tags:Oe.value,onTagClick:ce,onUpdateTags:$e},null,8,["tags"])):He("",!0),x.value.announcementEnabled&&(x.value.announcementText||"").trim()!==""?(ie(),qt(Ad,{key:2,text:x.value.announcementText||"欢迎访问我的说说笔记！"},null,8,["text"])):He("",!0),ve(sd,{ref_key:"messageList",ref:n,class:"message-list-container","site-config":x.value,"target-message-id":r.value},null,8,["site-config","target-message-id"]),x.value.musicEnabled?(ie(),de("div",{key:3,class:"netease-mini-player","data-playlist-id":x.value.musicPlaylistId||"","data-song-id":x.value.musicSongId||"","data-position":x.value.musicPosition||"bottom-left","data-theme":x.value.musicTheme||"auto","data-lyric":x.value.musicLyric?"true":"false","data-default-minimized":x.value.musicDefaultMinimized?"true":"false","data-embed":x.value.musicEmbed?"true":"false","data-autoplay":x.value.musicAutoplay?"true":"false"},null,8,zd)):He("",!0)]),_:1}),ve(pl),ve(yo,{modelValue:W.showSearchModal,"onUpdate:modelValue":Z[0]||(Z[0]=$=>W.showSearchModal=$),onSearchResult:s},null,8,["modelValue"]),q("div",{class:"scroll-buttons",onMouseenter:Z[1]||(Z[1]=$=>T.value=!0),onMouseleave:Z[2]||(Z[2]=$=>T.value=!1)},[Jn(ve(K,{class:Fe(S.value),variant:"ghost",size:"sm",onClick:w},{default:dt(()=>[ve(ae,{class:Fe(_.value),name:g.value},null,8,["class","name"])]),_:1},8,["class"]),[[dl,m.value]])],32)],512)],4)}}});export{Kd as default};
