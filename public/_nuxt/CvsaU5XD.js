import{m as N,n as C,_ as J,p as P,B as U,t as I,a3 as Z,i as S,r as j,ae as Y,G as O,F as u,v as d,Q as B,V as E,X as p,y as m,Z as c,z as h,$,U as k,Y as w,as as G,E as M,c as R,at as D,a1 as Q}from"./B5Ug7n5G.js";import{b as T}from"./D4kD5da7.js";const X={wrapper:"",inner:"",label:{wrapper:"flex content-center items-center justify-between",base:"block font-medium text-gray-700 dark:text-gray-200",required:"after:content-['*'] after:ms-0.5 after:text-red-500 dark:after:text-red-400"},size:{"2xs":"text-xs",xs:"text-xs",sm:"text-sm",md:"text-sm",lg:"text-sm",xl:"text-base"},container:"mt-1 relative",description:"text-gray-500 dark:text-gray-400",hint:"text-gray-500 dark:text-gray-400",help:"mt-2 text-gray-500 dark:text-gray-400",error:"mt-2 text-red-500 dark:text-red-400",default:{size:"sm"}},F=N(C.ui.strategy,C.ui.formGroup,X),H=P({inheritAttrs:!1,props:{name:{type:String,default:null},size:{type:String,default:null,validator(e){return Object.keys(F.size).includes(e)}},label:{type:String,default:null},description:{type:String,default:null},required:{type:Boolean,default:!1},help:{type:String,default:null},error:{type:[String,Boolean],default:null},hint:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})},eagerValidation:{type:Boolean,default:!1}},setup(e){const{ui:r,attrs:t}=U("formGroup",I(e,"ui"),F,I(e,"class")),o=Z("form-errors",null),n=S(()=>{var v,b;return e.error&&typeof e.error=="string"||typeof e.error=="boolean"?e.error:(b=(v=o==null?void 0:o.value)==null?void 0:v.find(g=>g.path===e.name))==null?void 0:b.message}),l=S(()=>r.value.size[e.size??F.default.size]),a=j(Y());return O("form-group",{error:n,inputId:a,name:S(()=>e.name),size:S(()=>e.size),eagerValidation:S(()=>e.eagerValidation)}),{ui:r,attrs:t,inputId:a,size:l,error:n}}}),K=["for"];function L(e,r,t,o,n,l){return d(),u("div",h({class:e.ui.wrapper},e.attrs),[B("div",{class:p(e.ui.inner)},[e.label||e.$slots.label?(d(),u("div",{key:0,class:p([e.ui.label.wrapper,e.size])},[B("label",{for:e.inputId,class:p([e.ui.label.base,e.required?e.ui.label.required:""])},[e.$slots.label?m(e.$slots,"label",c(h({key:0},{error:e.error,label:e.label,name:e.name,hint:e.hint,description:e.description,help:e.help}))):(d(),u($,{key:1},[k(w(e.label),1)],64))],10,K),e.hint||e.$slots.hint?(d(),u("span",{key:0,class:p([e.ui.hint])},[e.$slots.hint?m(e.$slots,"hint",c(h({key:0},{error:e.error,label:e.label,name:e.name,hint:e.hint,description:e.description,help:e.help}))):(d(),u($,{key:1},[k(w(e.hint),1)],64))],2)):E("",!0)],2)):E("",!0),e.description||e.$slots.description?(d(),u("p",{key:1,class:p([e.ui.description,e.size])},[e.$slots.description?m(e.$slots,"description",c(h({key:0},{error:e.error,label:e.label,name:e.name,hint:e.hint,description:e.description,help:e.help}))):(d(),u($,{key:1},[k(w(e.description),1)],64))],2)):E("",!0)],2),B("div",{class:p([e.label?e.ui.container:""])},[m(e.$slots,"default",c(G({error:e.error}))),typeof e.error=="string"&&e.error?(d(),u("p",{key:0,class:p([e.ui.error,e.size])},[e.$slots.error?m(e.$slots,"error",c(h({key:0},{error:e.error,label:e.label,name:e.name,hint:e.hint,description:e.description,help:e.help}))):(d(),u($,{key:1},[k(w(e.error),1)],64))],2)):e.help||e.$slots.help?(d(),u("p",{key:1,class:p([e.ui.help,e.size])},[e.$slots.help?m(e.$slots,"help",c(h({key:0},{error:e.error,label:e.label,name:e.name,hint:e.hint,description:e.description,help:e.help}))):(d(),u($,{key:1},[k(w(e.help),1)],64))],2)):E("",!0)],2)],16)}const he=J(H,[["render",L]]);class V extends Error{constructor(r){super(r),this.message=r,Object.setPrototypeOf(this,V.prototype)}}const W=P({props:{schema:{type:[Object,Function],default:void 0},state:{type:Object,required:!0},validate:{type:Function,default:()=>[]},validateOn:{type:Array,default:()=>["blur","input","change","submit"]}},emits:["submit","error"],setup(e,{expose:r,emit:t}){const o=Y(),n=T(`form-${o}`),l=j(null);M(()=>{n.on(async s=>{var i;s.type!=="submit"&&((i=e.validateOn)!=null&&i.includes(s.type))&&await g(s.path,{silent:!0})})}),R(()=>{n.reset()});const a=j([]);O("form-errors",a),O("form-events",n);const v=j({});O("form-inputs",v);async function b(){let s=await e.validate(e.state);if(e.schema){const{errors:i,result:f}=await pe(e.state,e.schema);i?s=s.concat(i):l.value=f}return s}async function g(s,i={silent:!1}){let f=s;if(s&&!Array.isArray(s)&&(f=[s]),f){const z=a.value.filter(y=>!f.includes(y.path)),A=(await b()).filter(y=>f.includes(y.path));a.value=z.concat(A)}else a.value=await b();if(a.value.length>0){if(i.silent)return!1;throw new V(`Form validation failed: ${JSON.stringify(a.value,null,2)}`)}return e.state}async function q(s){var f;const i=s;try{(f=e.validateOn)!=null&&f.includes("submit")&&await g(),i.data=e.schema?l.value:e.state,t("submit",i)}catch(z){if(!(z instanceof V))throw z;const A={...i,errors:a.value.map(y=>({...y,id:v.value[y.path]}))};t("error",A)}}return r({validate:g,errors:a,setErrors(s,i){i?a.value=a.value.filter(f=>f.path!==i).concat(s):a.value=s},async submit(){await q(new Event("submit"))},getErrors(s){return s?a.value.filter(i=>i.path===s):a.value},clear(s){s?a.value=a.value.filter(i=>i.path!==s):a.value=[]}}),{onSubmit:q,errors:D(a)}}});function _(e){return e.validate&&e.__isYupSchema__}function x(e){return e.inner!==void 0}function ee(e){return"schema"in e&&typeof e.coercer=="function"&&typeof e.validator=="function"&&typeof e.refiner=="function"}function re(e){return e.validateAsync!==void 0&&e.id!==void 0}function te(e){return e.isJoi===!0}function ae(e){return"_parse"in e||"_run"in e||typeof e=="function"&&"schema"in e}function ne(e){return e.parse!==void 0}function se(e){return"~standard"in e}async function ie(e,r){const t=await r["~standard"].validate(e);return!t.issues||t.issues.length===0?{errors:null,result:"value"in t?t.value:null}:{errors:t.issues.map(n=>{var l;return{path:((l=n.path)==null?void 0:l.map(a=>typeof a=="object"?a.key:a).join("."))||"",message:n.message}}),result:null}}async function le(e,r){const t=await("_parse"in r?r._parse(e):"_run"in r?r._run({typed:!1,value:e},{}):r(e));return!t.issues||t.issues.length===0?{errors:null,result:"output"in t?t.output:"value"in t?t.value:null}:{errors:t.issues.map(n=>{var l;return{path:((l=n.path)==null?void 0:l.map(a=>a.key).join("."))||"",message:n.message}}),result:null}}async function oe(e,r){try{return{errors:null,result:await r.validateAsync(e,{abortEarly:!1})}}catch(t){if(te(t))return{errors:t.details.map(n=>({path:n.path.join("."),message:n.message})),result:null};throw t}}async function ue(e,r){const t=await r.safeParseAsync(e);return t.success===!1?{errors:t.error.issues.map(n=>({path:n.path.join("."),message:n.message})),result:null}:{result:t.data,errors:null}}async function de(e,r){const[t,o]=r.validate(e);return t?{errors:t.failures().map(l=>({message:l.message,path:l.path.join(".")})),result:null}:{errors:null,result:o}}async function fe(e,r){try{return{errors:null,result:await r.validate(e,{abortEarly:!1})}}catch(t){if(x(t))return{errors:t.inner.map(n=>({path:n.path??"",message:n.message})),result:null};throw t}}function pe(e,r){if(se(r))return ie(e,r);if(ne(r))return ue(e,r);if(re(r))return oe(e,r);if(ae(r))return le(e,r);if(_(r))return fe(e,r);if(ee(r))return de(e,r);throw new Error("Form validation failed: Unsupported form schema")}function me(e,r,t,o,n,l){return d(),u("form",{onSubmit:r[0]||(r[0]=Q((...a)=>e.onSubmit&&e.onSubmit(...a),["prevent"]))},[m(e.$slots,"default",c(G({errors:e.errors})))],32)}const ve=J(W,[["render",me]]);export{ve as _,he as a};
