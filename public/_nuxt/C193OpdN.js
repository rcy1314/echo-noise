import{m as Ml,n as Je,_ as vl,p as at,B as zl,t as Kt,ai as sa,a7 as aa,i as I,C as Nl,D as pt,q as b,v as f,K as t,G as $,a9 as qt,aj as oa,A as Ol,H as n,x as Gt,y as v,z as x,ak as na,a2 as Jt,al as ia,L as ue,M as ce,I as s,am as Il,a8 as Wl,U as w,af as Fl,E as Ve,k as fe,w as Ae,an as ql,a4 as gl,J as m,$ as Vt,r as V,a1 as Kl,c as da,h as Re,N as ml,a5 as ra,aa as ua,a6 as Dl,ab as ca,ad as ma,ae as pa,W as va,V as mt,X as _e,Y as he,Z as Hl,ag as _l,a0 as ga}from"./DDKjefeD.js";import{b as Gl,_ as fl,a as fa}from"./pWhDNHY1.js";import{b as bl,_ as ba,a as wa,N as ya}from"./Cr4eZn5w.js";import{_ as xa}from"./PWaiHQUp.js";import{_ as Jl}from"./4G2LGrRG.js";import{_ as ha}from"./DatnGhQ5.js";const ka={wrapper:"relative flex items-start",container:"flex items-center h-5",base:"h-4 w-4 dark:checked:bg-current dark:checked:border-transparent disabled:opacity-50 disabled:cursor-not-allowed focus:ring-0 focus:ring-transparent focus:ring-offset-transparent",form:"form-radio",color:"text-{color}-500 dark:text-{color}-400",background:"bg-white dark:bg-gray-900",border:"border border-gray-300 dark:border-gray-700",ring:"focus-visible:ring-2 focus-visible:ring-{color}-500 dark:focus-visible:ring-{color}-400 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:focus-visible:ring-offset-gray-900",inner:"ms-3 flex flex-col",label:"text-sm font-medium text-gray-700 dark:text-gray-200",required:"text-sm text-red-500 dark:text-red-400",help:"text-sm text-gray-500 dark:text-gray-400",default:{color:"primary"}},pl=Ml(Je.ui.strategy,Je.ui.radio,ka),Ca=at({inheritAttrs:!1,props:{id:{type:String,default:null},value:{type:[String,Number,Boolean],default:null},modelValue:{type:[String,Number,Boolean,Object],default:null},name:{type:String,default:null},disabled:{type:Boolean,default:!1},help:{type:String,default:null},label:{type:String,default:null},required:{type:Boolean,default:!1},color:{type:String,default:()=>pl.default.color,validator(p){return Je.ui.colors.includes(p)}},inputClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue","change"],setup(p,{emit:J}){const{ui:M,attrs:U}=zl("radio",Kt(p,"ui"),pl,Kt(p,"class")),u=p.id??sa(),B=aa("radio-group",null),{emitFormChange:X,color:z,name:j}=B??Gl(p,pl),T=I({get(){return p.modelValue},set(W){J("update:modelValue",W),B||X()}});function P(W){J("change",W.target.value)}const o=I(()=>Nl(pt(M.value.base,M.value.form,M.value.background,M.value.border,z.value&&M.value.ring.replaceAll("{color}",z.value),z.value&&M.value.color.replaceAll("{color}",z.value)),p.inputClass));return{inputId:u,ui:M,attrs:U,pick:T,name:j,inputClass:o,onChange:P}}}),Va=["data-n-ids"],Ua=["id","name","required","value","disabled"],Ea=["for"];function Ta(p,J,M,U,u,B){return f(),b("div",{class:n(p.ui.wrapper),"data-n-ids":p.attrs["data-n-ids"]},[t("div",{class:n(p.ui.container)},[qt(t("input",Ol({id:p.inputId,"onUpdate:modelValue":J[0]||(J[0]=X=>p.pick=X),name:p.name,required:p.required,value:p.value,disabled:p.disabled,type:"radio",class:p.inputClass},p.attrs,{onChange:J[1]||(J[1]=(...X)=>p.onChange&&p.onChange(...X))}),null,16,Ua),[[oa,p.pick]])],2),p.label||p.$slots.label?(f(),b("div",{key:0,class:n(p.ui.inner)},[t("label",{for:p.inputId,class:n(p.ui.label)},[Gt(p.$slots,"label",{label:p.label},()=>[v(x(p.label),1)]),p.required?(f(),b("span",{key:0,class:n(p.ui.required)},"*",2)):$("",!0)],10,Ea),p.help||p.$slots.help?(f(),b("p",{key:0,class:n(p.ui.help)},[Gt(p.$slots,"help",{help:p.help},()=>[v(x(p.help),1)])],2)):$("",!0)],2)):$("",!0)],10,Va)}const La=vl(Ca,[["render",Ta]]),je=Ml(Je.ui.strategy,Je.ui.select,na),Sa=at({components:{UIcon:Jt},inheritAttrs:!1,props:{modelValue:{type:[String,Number,Object],default:""},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:null},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},icon:{type:String,default:null},loadingIcon:{type:String,default:()=>je.default.loadingIcon},leadingIcon:{type:String,default:null},trailingIcon:{type:String,default:()=>je.default.trailingIcon},trailing:{type:Boolean,default:!1},leading:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},padded:{type:Boolean,default:!0},options:{type:Array,default:()=>[]},size:{type:String,default:null,validator(p){return Object.keys(je.size).includes(p)}},color:{type:String,default:()=>je.default.color,validator(p){return[...Je.ui.colors,...Object.keys(je.color)].includes(p)}},variant:{type:String,default:()=>je.default.variant,validator(p){return[...Object.keys(je.variant),...Object.values(je.color).flatMap(J=>Object.keys(J))].includes(p)}},optionAttribute:{type:String,default:"label"},valueAttribute:{type:String,default:"value"},selectClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue","change"],setup(p,{emit:J,slots:M}){const{ui:U,attrs:u}=zl("select",Kt(p,"ui"),je,Kt(p,"class")),{size:B,rounded:X}=ia({ui:U,props:p}),{emitFormChange:z,inputId:j,color:T,size:P,name:o}=Gl(p,je),W=I(()=>B.value??P.value),ne=S=>{J("update:modelValue",S.target.value)},se=S=>{J("change",S.target.value),z()},k=S=>Il(S,p.valueAttribute,""),c=S=>Il(S,p.optionAttribute,""),N=S=>["string","number","boolean"].includes(typeof S)?{[p.valueAttribute]:S,[p.optionAttribute]:S}:{...S,[p.valueAttribute]:k(S),[p.optionAttribute]:c(S)},D=I(()=>p.options.map(S=>N(S))),O=I(()=>p.placeholder?[{[p.valueAttribute]:"",[p.optionAttribute]:p.placeholder,disabled:!0},...D.value]:D.value),Y=I(()=>{const S=N(p.modelValue),F=O.value.find(_=>_[p.valueAttribute]===S[p.valueAttribute]);return F?F[p.valueAttribute]:""}),ae=I(()=>{var F,_;const S=((_=(F=U.value.color)==null?void 0:F[T.value])==null?void 0:_[p.variant])||U.value.variant[p.variant];return Nl(pt(U.value.base,U.value.form,X.value,U.value.size[W.value],p.padded?U.value.padding[W.value]:"p-0",S==null?void 0:S.replaceAll("{color}",T.value),(g.value||M.leading)&&U.value.leading.padding[W.value],(be.value||M.trailing)&&U.value.trailing.padding[W.value]),p.placeholder&&!p.modelValue&&U.value.placeholder,p.selectClass)}),g=I(()=>p.icon&&p.leading||p.icon&&!p.trailing||p.loading&&!p.trailing||p.leadingIcon),be=I(()=>p.icon&&p.trailing||p.loading&&p.trailing||p.trailingIcon),we=I(()=>p.loading?p.loadingIcon:p.leadingIcon||p.icon),me=I(()=>p.loading&&!g.value?p.loadingIcon:p.trailingIcon||p.icon),Ue=I(()=>pt(U.value.icon.leading.wrapper,U.value.icon.leading.pointer,U.value.icon.leading.padding[W.value])),ze=I(()=>pt(U.value.icon.base,T.value&&Je.ui.colors.includes(T.value)&&U.value.icon.color.replaceAll("{color}",T.value),U.value.icon.size[W.value],p.loading&&U.value.icon.loading)),Be=I(()=>pt(U.value.icon.trailing.wrapper,U.value.icon.trailing.pointer,U.value.icon.trailing.padding[W.value])),Ee=I(()=>pt(U.value.icon.base,T.value&&Je.ui.colors.includes(T.value)&&U.value.icon.color.replaceAll("{color}",T.value),U.value.icon.size[W.value],p.loading&&!g.value&&U.value.icon.loading));return{ui:U,attrs:u,name:o,inputId:j,normalizedOptionsWithPlaceholder:O,normalizedValue:Y,isLeading:g,isTrailing:be,selectClass:ae,leadingIconName:we,leadingIconClass:ze,leadingWrapperIconClass:Ue,trailingIconName:me,trailingIconClass:Ee,trailingWrapperIconClass:Be,onInput:ne,onChange:se}}}),Aa=["id","name","value","required","disabled"],Ba=["value","label"],$a=["value","selected","disabled","textContent"],Ra=["value","selected","disabled","textContent"];function ja(p,J,M,U,u,B){const X=Jt;return f(),b("div",{class:n(p.ui.wrapper)},[t("select",Ol({id:p.inputId,name:p.name,value:p.modelValue,required:p.required,disabled:p.disabled,class:p.selectClass},p.attrs,{onInput:J[0]||(J[0]=(...z)=>p.onInput&&p.onInput(...z)),onChange:J[1]||(J[1]=(...z)=>p.onChange&&p.onChange(...z))}),[(f(!0),b(ue,null,ce(p.normalizedOptionsWithPlaceholder,(z,j)=>(f(),b(ue,null,[z.children?(f(),b("optgroup",{key:`${z[p.valueAttribute]}-optgroup-${j}`,value:z[p.valueAttribute],label:z[p.optionAttribute]},[(f(!0),b(ue,null,ce(z.children,(T,P)=>(f(),b("option",{key:`${T[p.valueAttribute]}-${j}-${P}`,value:T[p.valueAttribute],selected:T[p.valueAttribute]===p.normalizedValue,disabled:T.disabled,textContent:x(T[p.optionAttribute])},null,8,$a))),128))],8,Ba)):(f(),b("option",{key:`${z[p.valueAttribute]}-${j}`,value:z[p.valueAttribute],selected:z[p.valueAttribute]===p.normalizedValue,disabled:z.disabled,textContent:x(z[p.optionAttribute])},null,8,Ra))],64))),256))],16,Aa),p.isLeading&&p.leadingIconName||p.$slots.leading?(f(),b("span",{key:0,class:n(p.leadingWrapperIconClass)},[Gt(p.$slots,"leading",{disabled:p.disabled,loading:p.loading},()=>[s(X,{name:p.leadingIconName,class:n(p.leadingIconClass)},null,8,["name","class"])],!0)],2)):$("",!0),p.isTrailing&&p.trailingIconName||p.$slots.trailing?(f(),b("span",{key:1,class:n(p.trailingWrapperIconClass)},[Gt(p.$slots,"trailing",{disabled:p.disabled,loading:p.loading},()=>[s(X,{name:p.trailingIconName,class:n(p.trailingIconClass),"aria-hidden":"true"},null,8,["name","class"])],!0)],2)):$("",!0)],2)}const Xl=vl(Sa,[["render",ja],["__scopeId","data-v-db8f1118"]]),Pa=()=>{const p=Wl(),J=w(),M=Fl(),U=async()=>{const j=await p.getStatus();return j&&p.setUserStatus(j),j},u=async j=>{await p.register(j)&&J.add({title:"注册成功",description:"欢迎使用！请登录",icon:"i-fluent-checkmark-starburst-16-filled",color:"green",timeout:1e3})},B=async j=>{await p.login(j)&&(await U(),J.add({title:"登录成功",description:"欢迎回来！",icon:"i-fluent-checkmark-starburst-16-filled",color:"green",timeout:1e3}))},X=async()=>{await p.logout(),p.clearUserStatus(),J.add({title:"注销成功",description:"欢迎再次使用！",icon:"i-fluent-checkmark-starburst-16-filled",color:"green",timeout:1e3}),M.push("/")},z=async()=>await U();return Ve(async()=>{await U()}),{register:u,login:B,logout:X,getStatus:z}},Ia={class:"rounded-lg p-4 mb-6"},Da={class:"flex justify-between items-center mb-4"},Ha={class:"flex justify-between items-center mb-2"},_a={class:"flex items-center gap-2"},Ma={key:0,class:"space-y-2"},za={class:"flex justify-end gap-2"},Na={class:"flex justify-between items-center mb-2"},Oa={class:"flex items-center gap-2"},Wa={key:0,class:"space-y-2"},Fa={class:"flex justify-end gap-2"},qa={class:"flex justify-between items-center mb-2"},Ka={class:"flex items-center gap-2"},Ga={key:0,class:"space-y-2"},Ja={class:"flex justify-end gap-2"},Xa={class:"flex justify-between items-center mb-2"},Ya={class:"flex items-center gap-2"},Za={key:0,class:"space-y-2"},Qa={class:"flex justify-end gap-2"},eo={class:"flex justify-between items-center mb-2"},to={class:"flex items-center gap-2"},lo={key:0,class:"space-y-2"},so={class:"flex justify-end gap-2"},ao={class:"flex justify-between items-center mb-2"},oo={class:"flex items-center gap-2"},no={key:0,class:"space-y-2"},io={class:"flex justify-end gap-2"},ro=at({__name:"NotifyPanel",props:{config:{},immediate:{type:Boolean},subtleBg:{},text:{},mutedText:{},disabled:{type:Boolean}},emits:["save"],setup(p,{emit:J}){const M=J,U=p,u=fe({webhookEnabled:!1,webhookURL:"",telegramEnabled:!1,telegramToken:"",telegramChatID:"",weworkEnabled:!1,weworkKey:"",feishuEnabled:!1,feishuWebhook:"",feishuSecret:"",twitterEnabled:!1,twitterApiKey:"",twitterApiSecret:"",twitterAccessToken:"",twitterAccessTokenSecret:"",customHttpEnabled:!1,customHttpUrl:"",customHttpMethod:"POST",customHttpHeaders:"",customHttpBody:'{"content":"{{content}}"}'}),B=fe({webhook:!1,telegram:!1,wework:!1,feishu:!1,twitter:!1,customHttp:!1}),X=["webhook","telegram","wework","feishu","twitter","customHttp"],z=k=>({webhook:"Webhook",telegram:"Telegram",wework:"企业微信",feishu:"飞书",twitter:"Twitter",customHttp:"自定义HTTP"})[k]||k,j=k=>{const c=k.toLowerCase();Object.keys(u).forEach(N=>{N.toLowerCase().startsWith(c)&&(u[N]=U.config[N])}),B[k]=!1},T=k=>{var N,D,O,Y,ae,g,be,we,me,Ue;const c=u;switch(k){case"webhook":return c.webhookEnabled&&!!((N=c.webhookURL)!=null&&N.trim());case"telegram":return c.telegramEnabled&&!!((D=c.telegramToken)!=null&&D.trim())&&!!((O=c.telegramChatID)!=null&&O.trim());case"wework":return c.weworkEnabled&&!!((Y=c.weworkKey)!=null&&Y.trim());case"feishu":return c.feishuEnabled&&!!((ae=c.feishuWebhook)!=null&&ae.trim());case"twitter":return c.twitterEnabled&&!!((g=c.twitterApiKey)!=null&&g.trim())&&!!((be=c.twitterApiSecret)!=null&&be.trim())&&!!((we=c.twitterAccessToken)!=null&&we.trim())&&!!((me=c.twitterAccessTokenSecret)!=null&&me.trim());case"customHttp":return c.customHttpEnabled&&!!((Ue=c.customHttpUrl)!=null&&Ue.trim());default:return!1}},P=async k=>{try{switch(k){case"webhook":if(u.webhookEnabled&&!u.webhookURL)throw new Error("Webhook URL不能为空");break;case"telegram":if(u.telegramEnabled&&(!u.telegramToken||!u.telegramChatID))throw new Error("Telegram配置不完整");break;case"wework":if(u.weworkEnabled&&!u.weworkKey)throw new Error("企业微信Key不能为空");break;case"feishu":if(u.feishuEnabled&&!u.feishuWebhook)throw new Error("飞书Webhook不能为空");break;case"twitter":if(u.twitterEnabled&&(!u.twitterApiKey||!u.twitterApiSecret||!u.twitterAccessToken||!u.twitterAccessTokenSecret))throw new Error("Twitter配置不完整");break;case"customHttp":if(u.customHttpEnabled&&!u.customHttpUrl)throw new Error("自定义HTTP URL不能为空");break}const c={webhookEnabled:u.webhookEnabled,webhookURL:u.webhookURL,telegramEnabled:u.telegramEnabled,telegramToken:u.telegramToken,telegramChatID:u.telegramChatID,weworkEnabled:u.weworkEnabled,weworkKey:u.weworkKey,feishuEnabled:u.feishuEnabled,feishuWebhook:u.feishuWebhook,feishuSecret:u.feishuSecret,twitterEnabled:u.twitterEnabled,twitterApiKey:u.twitterApiKey,twitterApiSecret:u.twitterApiSecret,twitterAccessToken:u.twitterAccessToken,twitterAccessTokenSecret:u.twitterAccessTokenSecret,customHttpEnabled:u.customHttpEnabled,customHttpUrl:u.customHttpUrl,customHttpMethod:u.customHttpMethod,customHttpHeaders:u.customHttpHeaders,customHttpBody:u.customHttpBody},N=Vt().public.baseApi||"/api",O=await(await fetch(`${N}/notify/config`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(c)})).json();if(O.code===1)B[k]=!1,O.data&&Object.keys(O.data).forEach(Y=>{Y.endsWith("Enabled")?u[Y]=!!O.data[Y]&&O.data[Y]!=="false":u[Y]=O.data[Y]||""}),M("save",{...u}),w().add({title:"成功",description:`${z(k)}配置已保存`,color:"green"});else throw new Error(O.msg||"保存失败")}catch(c){console.error("保存配置失败:",c),w().add({title:"错误",description:c.message||"保存失败",color:"red"})}},o=async k=>{try{if(!T(k))throw new Error(`请先完成并启用${z(k)}配置`);const N=await(await fetch("/api/notify/test",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({type:k})})).json();if(N.code===1)w().add({title:"成功",description:`${z(k)}测试消息已发送`,color:"green"});else throw new Error(N.msg||"测试失败")}catch(c){console.error("测试失败:",c),w().add({title:"错误",description:c.message||"测试失败",color:"red"})}};Ae(()=>U.config,k=>{k&&Object.keys(u).forEach(c=>{k[c]!==void 0&&(c.endsWith("Enabled")?u[c]=!!k[c]&&k[c]!=="false":u[c]=k[c])})},{deep:!0,immediate:!0}),Ve(async()=>{try{const c=await(await fetch("/api/notify/config",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}})).json();if(c.code===1&&c.data){const N=c.data;Object.keys(N).forEach(D=>{D.endsWith("Enabled")?u[D]=!!N[D]&&N[D]!=="false":u[D]=N[D]||""}),console.log("加载的配置:",u)}}catch(k){console.error("获取配置失败:",k),w().add({title:"错误",description:"获取推送配置失败",color:"red"})}});const W=I(()=>U.subtleBg||"bg-gray-800"),ne=I(()=>U.text||"text-white"),se=I(()=>U.mutedText||"text-gray-300");return(k,c)=>{const N=ql("USwitch"),D=gl,O=fl,Y=Xl,ae=bl;return f(),b("div",Ia,[t("div",Da,[t("h2",{class:n(["text-xl font-semibold",ne.value])},"推送渠道配置",2)]),t("div",{class:n(["space-y-4",U.disabled?"opacity-60 pointer-events-none":""])},[t("div",{class:n(["rounded p-3",W.value])},[t("div",Ha,[t("span",{class:n(se.value)},"Webhook推送",2),t("div",_a,[s(N,{modelValue:u.webhookEnabled,"onUpdate:modelValue":c[0]||(c[0]=g=>u.webhookEnabled=g)},null,8,["modelValue"]),s(D,{size:"sm",onClick:c[1]||(c[1]=g=>B.webhook=!B.webhook),color:B.webhook?"gray":"primary",variant:"soft"},{default:m(()=>[v(x(B.webhook?"取消":"编辑"),1)]),_:1},8,["color"])])]),B.webhook?(f(),b("div",Ma,[s(O,{modelValue:u.webhookURL,"onUpdate:modelValue":c[2]||(c[2]=g=>u.webhookURL=g),placeholder:"Webhook URL"},null,8,["modelValue"]),t("div",za,[s(D,{onClick:c[3]||(c[3]=g=>j("webhook")),variant:"ghost",color:"gray"},{default:m(()=>c[38]||(c[38]=[v(" 重置 ")])),_:1}),s(D,{onClick:c[4]||(c[4]=g=>P("webhook")),color:"primary"},{default:m(()=>c[39]||(c[39]=[v(" 保存 ")])),_:1})])])):$("",!0)],2),t("div",{class:n(["rounded p-3",W.value])},[t("div",Na,[t("span",{class:n(se.value)},"Telegram推送",2),t("div",Oa,[s(N,{modelValue:u.telegramEnabled,"onUpdate:modelValue":c[5]||(c[5]=g=>u.telegramEnabled=g)},null,8,["modelValue"]),s(D,{size:"sm",onClick:c[6]||(c[6]=g=>B.telegram=!B.telegram),color:B.telegram?"gray":"primary",variant:"soft"},{default:m(()=>[v(x(B.telegram?"取消":"编辑"),1)]),_:1},8,["color"])])]),B.telegram?(f(),b("div",Wa,[s(O,{modelValue:u.telegramToken,"onUpdate:modelValue":c[7]||(c[7]=g=>u.telegramToken=g),placeholder:"Bot Token"},null,8,["modelValue"]),s(O,{modelValue:u.telegramChatID,"onUpdate:modelValue":c[8]||(c[8]=g=>u.telegramChatID=g),placeholder:"Chat ID"},null,8,["modelValue"]),t("div",Fa,[s(D,{onClick:c[9]||(c[9]=g=>j("telegram")),variant:"ghost",color:"gray"},{default:m(()=>c[40]||(c[40]=[v(" 重置 ")])),_:1}),s(D,{onClick:c[10]||(c[10]=g=>P("telegram")),color:"primary"},{default:m(()=>c[41]||(c[41]=[v(" 保存 ")])),_:1})])])):$("",!0)],2),t("div",{class:n(["rounded p-3",W.value])},[t("div",qa,[t("span",{class:n(se.value)},"企业微信推送",2),t("div",Ka,[s(N,{modelValue:u.weworkEnabled,"onUpdate:modelValue":c[11]||(c[11]=g=>u.weworkEnabled=g)},null,8,["modelValue"]),s(D,{size:"sm",onClick:c[12]||(c[12]=g=>B.wework=!B.wework),color:B.wework?"gray":"primary",variant:"soft"},{default:m(()=>[v(x(B.wework?"取消":"编辑"),1)]),_:1},8,["color"])])]),B.wework?(f(),b("div",Ga,[s(O,{modelValue:u.weworkKey,"onUpdate:modelValue":c[13]||(c[13]=g=>u.weworkKey=g),placeholder:"WebHook Key"},null,8,["modelValue"]),t("div",Ja,[s(D,{onClick:c[14]||(c[14]=g=>j("wework")),variant:"ghost",color:"gray"},{default:m(()=>c[42]||(c[42]=[v(" 重置 ")])),_:1}),s(D,{onClick:c[15]||(c[15]=g=>P("wework")),color:"primary"},{default:m(()=>c[43]||(c[43]=[v(" 保存 ")])),_:1})])])):$("",!0)],2),t("div",{class:n(["rounded p-3",W.value])},[t("div",Xa,[t("span",{class:n(se.value)},"飞书推送",2),t("div",Ya,[s(N,{modelValue:u.feishuEnabled,"onUpdate:modelValue":c[16]||(c[16]=g=>u.feishuEnabled=g)},null,8,["modelValue"]),s(D,{size:"sm",onClick:c[17]||(c[17]=g=>B.feishu=!B.feishu),color:B.feishu?"gray":"primary",variant:"soft"},{default:m(()=>[v(x(B.feishu?"取消":"编辑"),1)]),_:1},8,["color"])])]),B.feishu?(f(),b("div",Za,[s(O,{modelValue:u.feishuWebhook,"onUpdate:modelValue":c[18]||(c[18]=g=>u.feishuWebhook=g),placeholder:"WebHook URL"},null,8,["modelValue"]),s(O,{modelValue:u.feishuSecret,"onUpdate:modelValue":c[19]||(c[19]=g=>u.feishuSecret=g),placeholder:"签名密钥",type:"password"},null,8,["modelValue"]),t("div",Qa,[s(D,{onClick:c[20]||(c[20]=g=>j("feishu")),variant:"ghost",color:"gray"},{default:m(()=>c[44]||(c[44]=[v(" 重置 ")])),_:1}),s(D,{onClick:c[21]||(c[21]=g=>P("feishu")),color:"primary"},{default:m(()=>c[45]||(c[45]=[v(" 保存 ")])),_:1})])])):$("",!0)],2),t("div",{class:n(["rounded p-3",W.value])},[t("div",eo,[t("span",{class:n(se.value)},"Twitter推送",2),t("div",to,[s(N,{modelValue:u.twitterEnabled,"onUpdate:modelValue":c[22]||(c[22]=g=>u.twitterEnabled=g)},null,8,["modelValue"]),s(D,{size:"sm",onClick:c[23]||(c[23]=g=>B.twitter=!B.twitter),color:B.twitter?"gray":"primary",variant:"soft"},{default:m(()=>[v(x(B.twitter?"取消":"编辑"),1)]),_:1},8,["color"])])]),B.twitter?(f(),b("div",lo,[s(O,{modelValue:u.twitterApiKey,"onUpdate:modelValue":c[24]||(c[24]=g=>u.twitterApiKey=g),placeholder:"API Key"},null,8,["modelValue"]),s(O,{modelValue:u.twitterApiSecret,"onUpdate:modelValue":c[25]||(c[25]=g=>u.twitterApiSecret=g),placeholder:"API Secret"},null,8,["modelValue"]),s(O,{modelValue:u.twitterAccessToken,"onUpdate:modelValue":c[26]||(c[26]=g=>u.twitterAccessToken=g),placeholder:"Access Token"},null,8,["modelValue"]),s(O,{modelValue:u.twitterAccessTokenSecret,"onUpdate:modelValue":c[27]||(c[27]=g=>u.twitterAccessTokenSecret=g),placeholder:"Access Token Secret"},null,8,["modelValue"]),t("div",so,[s(D,{onClick:c[28]||(c[28]=g=>j("twitter")),variant:"ghost",color:"gray"},{default:m(()=>c[46]||(c[46]=[v("重置")])),_:1}),s(D,{onClick:c[29]||(c[29]=g=>P("twitter")),color:"primary"},{default:m(()=>c[47]||(c[47]=[v("保存")])),_:1})])])):$("",!0)],2),t("div",{class:n(["rounded p-3",W.value])},[t("div",ao,[t("span",{class:n(se.value)},"自定义HTTP推送",2),t("div",oo,[s(N,{modelValue:u.customHttpEnabled,"onUpdate:modelValue":c[30]||(c[30]=g=>u.customHttpEnabled=g)},null,8,["modelValue"]),s(D,{size:"sm",onClick:c[31]||(c[31]=g=>B.customHttp=!B.customHttp),color:B.customHttp?"gray":"primary",variant:"soft"},{default:m(()=>[v(x(B.customHttp?"取消":"编辑"),1)]),_:1},8,["color"])])]),B.customHttp?(f(),b("div",no,[s(O,{modelValue:u.customHttpUrl,"onUpdate:modelValue":c[32]||(c[32]=g=>u.customHttpUrl=g),placeholder:"请求URL"},null,8,["modelValue"]),s(Y,{modelValue:u.customHttpMethod,"onUpdate:modelValue":c[33]||(c[33]=g=>u.customHttpMethod=g),options:["POST","PUT","PATCH"]},null,8,["modelValue"]),s(ae,{modelValue:u.customHttpHeaders,"onUpdate:modelValue":c[34]||(c[34]=g=>u.customHttpHeaders=g),placeholder:"请求Headers（JSON格式）"},null,8,["modelValue"]),s(ae,{modelValue:u.customHttpBody,"onUpdate:modelValue":c[35]||(c[35]=g=>u.customHttpBody=g),placeholder:'请求Body模板（如：{"content":"{{content}}"})'},null,8,["modelValue"]),t("div",io,[s(D,{onClick:c[36]||(c[36]=g=>j("customHttp")),variant:"ghost",color:"gray"},{default:m(()=>c[48]||(c[48]=[v("重置")])),_:1}),s(D,{onClick:c[37]||(c[37]=g=>P("customHttp")),color:"primary"},{default:m(()=>c[49]||(c[49]=[v("保存")])),_:1})])])):$("",!0)],2)],2),t("div",{class:n(["mt-4 flex flex-wrap gap-2",U.disabled?"opacity-60 pointer-events-none":""])},[(f(),b(ue,null,ce(X,g=>s(D,{key:g,onClick:be=>o(g),class:"flex-grow sm:flex-grow-0",variant:"solid",disabled:U.disabled},{default:m(()=>[v(" 测试"+x(z(g)),1)]),_:2},1032,["onClick","disabled"])),64))],2)])}}}),uo={class:"flex flex-col gap-3 w-full"},co={key:1,class:"grid grid-cols-1 md:grid-cols-3 gap-3"},mo=["innerHTML"],po=["innerHTML"],vo=at({__name:"CommentsSettings",props:{config:{},theme:{}},emits:["update:config","comment-system-changed"],setup(p,{emit:J}){const M=p,U=J,u=fe({commentEnabled:!1,commentSystem:"builtin",commentEmailEnabled:!1,commentEmailReplyName:"",commentEmailAdminPrefix:"",commentEmailReplyPrefix:"",commentEmailReplyTemplate:"",commentEmailAdminTemplate:"",commentEmailReplyTemplateHTML:"",commentEmailAdminTemplateHTML:""});Ae(()=>M.config,T=>{T&&(u.commentEnabled=!!T.commentEnabled,u.commentSystem="builtin",u.commentEmailEnabled=!!T.commentEmailEnabled,u.commentEmailReplyName=String(T.commentEmailReplyName||""),u.commentEmailAdminPrefix=String(T.commentEmailAdminPrefix||""),u.commentEmailReplyPrefix=String(T.commentEmailReplyPrefix||""),u.commentEmailReplyTemplate=String(T.commentEmailReplyTemplate||""),u.commentEmailAdminTemplate=String(T.commentEmailAdminTemplate||""),u.commentEmailSiteURL=String(T.commentEmailSiteURL||""),u.commentEmailReplyTemplateHTML=String(T.commentEmailReplyTemplateHTML||""),u.commentEmailAdminTemplateHTML=String(T.commentEmailAdminTemplateHTML||""))},{immediate:!0,deep:!0}),Ae(()=>u.commentSystem,T=>{const P=String(T||"").toLowerCase();P==="builtin"&&(u.walineServerURL=""),U("comment-system-changed",P)});const B=I(()=>"bg-gray-800");I(()=>"text-slate-400");const X=I(()=>"text-white"),z=I(()=>{var k;const T=String(((k=M.config)==null?void 0:k.siteTitle)||"站点"),P="Mike",o="这里是示例内容",W=String(u.commentEmailSiteURL||""),ne=(W?W.replace(/\/$/,""):"")+"/m/123";return(u.commentEmailReplyTemplateHTML||`
<div>
  <p>您在<strong>{site}</strong>主页上的内容有了新的评论</p>
  <p><strong>{nick}</strong> 回复说：</p>
  <p>{content}</p>
  <p>您可以点击查看回复的完整内容：<a href="{url}" target="_blank">{url}</a></p>
</div>`).replaceAll("{site}",T).replaceAll("{nick}",P).replaceAll("{content}",o).replaceAll("{url}",ne)}),j=I(()=>{var N;const T=String(((N=M.config)==null?void 0:N.siteTitle)||"站点"),P="Mike",o="mike@example.com",W="https://example.com",ne="这里是示例内容",se=String(u.commentEmailSiteURL||""),k=(se?se.replace(/\/$/,""):"")+"/m/123";return(u.commentEmailAdminTemplateHTML||`
<div>
  <p>站点：<strong>{site}</strong></p>
  <p>用户：{nick}（{mail}）</p>
  <p>网址：<a href="{link}" target="_blank">{link}</a></p>
  <p>内容：</p>
  <div>{content}</div>
  <p>查看：<a href="{url}" target="_blank">{url}</a></p>
</div>`).replaceAll("{site}",T).replaceAll("{nick}",P).replaceAll("{mail}",o).replaceAll("{link}",W).replaceAll("{content}",ne).replaceAll("{url}",k)});return(T,P)=>{var ne,se,k,c,N,D,O,Y,ae,g,be,we,me,Ue,ze,Be,Ee;const o=fl,W=bl;return f(),b("div",{id:"site-comments-section",class:n(["flex flex-wrap items-center rounded-lg p-3 justify-between gap-3",((ne=T.theme)==null?void 0:ne.subtleBg)||B.value])},[t("div",uo,[u.commentSystem==="builtin"&&!((se=M.config)!=null&&se.commentEmailEnabled)?(f(),b("div",{key:0,class:n(["rounded border p-3",(k=T.theme)==null?void 0:k.border])},[t("div",{class:n(((c=T.theme)==null?void 0:c.text)||X.value)},"开启“邮件通知”后，可配置站点链接地址、主题前缀、发件显示名、文本/HTML 模板，并实时预览。",2)],2)):$("",!0),u.commentSystem==="builtin"&&((N=M.config)!=null&&N.commentEmailEnabled)?(f(),b("div",co,[s(o,{modelValue:u.commentEmailSiteURL,"onUpdate:modelValue":P[0]||(P[0]=S=>u.commentEmailSiteURL=S),ui:{base:(D=T.theme)==null?void 0:D.text},placeholder:"站点链接地址（用于邮件中的 {url} 基础） 如 https://note.noisework.cn"},null,8,["modelValue","ui"]),s(o,{modelValue:u.commentEmailReplyName,"onUpdate:modelValue":P[1]||(P[1]=S=>u.commentEmailReplyName=S),ui:{base:(O=T.theme)==null?void 0:O.text},placeholder:"邮件发件显示名（回复通知）"},null,8,["modelValue","ui"]),s(o,{modelValue:u.commentEmailAdminPrefix,"onUpdate:modelValue":P[2]||(P[2]=S=>u.commentEmailAdminPrefix=S),ui:{base:(Y=T.theme)==null?void 0:Y.text},placeholder:"管理员通知主题前缀（可选）"},null,8,["modelValue","ui"]),s(o,{modelValue:u.commentEmailReplyPrefix,"onUpdate:modelValue":P[3]||(P[3]=S=>u.commentEmailReplyPrefix=S),ui:{base:(ae=T.theme)==null?void 0:ae.text},placeholder:"回复通知主题前缀（可选）"},null,8,["modelValue","ui"]),s(W,{modelValue:u.commentEmailReplyTemplate,"onUpdate:modelValue":P[4]||(P[4]=S=>u.commentEmailReplyTemplate=S),ui:{base:(g=T.theme)==null?void 0:g.text},placeholder:"回复通知正文模板（默认示例）支持 {site} {nick} {content} {url}"},null,8,["modelValue","ui"]),s(W,{modelValue:u.commentEmailAdminTemplate,"onUpdate:modelValue":P[5]||(P[5]=S=>u.commentEmailAdminTemplate=S),ui:{base:(be=T.theme)==null?void 0:be.text},placeholder:"管理员通知正文模板（可选）支持 {site} {nick} {mail} {link} {content} {url}"},null,8,["modelValue","ui"]),s(W,{modelValue:u.commentEmailReplyTemplateHTML,"onUpdate:modelValue":P[6]||(P[6]=S=>u.commentEmailReplyTemplateHTML=S),ui:{base:(we=T.theme)==null?void 0:we.text},placeholder:"回复通知 HTML 模板（可选）支持 {site} {nick} {content} {url}"},null,8,["modelValue","ui"]),s(W,{modelValue:u.commentEmailAdminTemplateHTML,"onUpdate:modelValue":P[7]||(P[7]=S=>u.commentEmailAdminTemplateHTML=S),ui:{base:(me=T.theme)==null?void 0:me.text},placeholder:"管理员通知 HTML 模板（可选）支持 {site} {nick} {mail} {link} {content} {url}"},null,8,["modelValue","ui"]),t("div",{class:n(["md:col-span-3 rounded border p-3",(Ue=T.theme)==null?void 0:Ue.border])},[t("div",{class:n((ze=T.theme)==null?void 0:ze.text)},"回复通知富文本预览",2),t("div",{class:"mt-2 rounded p-2 bg-white text-black",innerHTML:z.value},null,8,mo)],2),t("div",{class:n(["md:col-span-3 rounded border p-3",(Be=T.theme)==null?void 0:Be.border])},[t("div",{class:n((Ee=T.theme)==null?void 0:Ee.text)},"管理员通知富文本预览",2),t("div",{class:"mt-2 rounded p-2 bg-white text-black",innerHTML:j.value},null,8,po)],2)])):$("",!0)])],2)}}}),go={class:"px-4 py-3 flex items-center justify-between"},fo={class:"flex items-center gap-2"},bo={class:"px-4"},wo={class:"flex gap-2 mb-3"},yo={key:0},xo={key:1,class:"grid grid-cols-1 md:grid-cols-2 gap-3"},ho={class:"flex items-center justify-between"},ko={class:"flex items-center gap-2"},Co=["src"],Vo={class:"mt-2"},Uo={key:1,class:"space-y-2"},Eo={class:"flex items-center gap-2"},To={key:0,class:"md:col-span-2 flex justify-center mt-2"},Lo={key:1,class:"md:col-span-2 flex justify-center mt-2"},So={key:1},Ao={key:1,class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Bo={class:"flex items-center justify-between"},$o={class:"flex items-center gap-2"},Ro=["src"],jo={class:"mt-2"},Po={key:1,class:"space-y-2"},Io={class:"flex items-center gap-2"},Do={key:0,class:"md:col-span-2 flex justify-center mt-2"},Ho={key:1,class:"md:col-span-2 flex justify-center mt-2"},_o={class:"flex justify-end gap-2 mt-3"},Mo=at({__name:"AttachmentManager",props:{theme:{}},setup(p){const J=p,M=V("images"),U=V([]),u=V([]),B=V(!1),X=V({}),z=V(!1),j=V(!1),T=V("image"),P=V(null),o=V(4),W=V(4),ne=Vt().public.baseApi||"/api",se=_=>{const E=typeof window<"u"?window.location.origin:"";return _.startsWith("http")?_:(_.startsWith("/api"),E+_)},k=_=>_<1024?`${_} B`:_<1024*1024?`${(_/1024).toFixed(1)} KB`:_<1024*1024*1024?`${(_/1024/1024).toFixed(1)} MB`:`${(_/1024/1024/1024).toFixed(1)} GB`,c=_=>new Date(_).toLocaleString(),N=_=>!!X.value[_.name],D=_=>{X.value[_.name]=!X.value[_.name]},O=async()=>{const E=await(await fetch(`${ne}/attachments/images`,{credentials:"include"})).json().catch(()=>null),pe=E&&E.code===1&&Array.isArray(E.data)?E.data:[];U.value=pe.filter(le=>/\.(png|jpe?g|gif|webp)$/i.test(String(le.name||""))),o.value=4},Y=async()=>{const E=await(await fetch(`${ne}/attachments/video`,{credentials:"include"})).json().catch(()=>null),pe=E&&E.code===1&&Array.isArray(E.data)?E.data:[];u.value=pe.filter(le=>/\.(mp4|webm|mov|avi)$/i.test(String(le.name||""))),W.value=4},ae=async()=>{try{B.value=!0,await Promise.all([O(),Y()])}finally{B.value=!1}};Ve(ae);const g=(_,E)=>{T.value=_,P.value=E,z.value=!0},be=async()=>{if(P.value)try{j.value=!0;const _=`${ne}/attachments/${T.value==="image"?"images":"video"}/${encodeURIComponent(P.value.name)}`,E=await fetch(_,{method:"DELETE",credentials:"include"}),pe=await E.json().catch(()=>null);if(!E.ok||!pe||pe.code!==1)throw new Error((pe==null?void 0:pe.msg)||"删除失败");w().add({title:"已删除",color:"green"}),z.value=!1,P.value=null,await ae()}catch(_){w().add({title:"删除失败",description:_==null?void 0:_.message,color:"red"})}finally{j.value=!1}},we=I(()=>U.value.slice(0,o.value)),me=I(()=>u.value.slice(0,W.value)),Ue=()=>{o.value+=4},ze=()=>{W.value+=4},Be=()=>{o.value=4},Ee=()=>{W.value=4},S=_=>{const E=document.createElement("a");E.href=se(_.url),E.download=_.name||"",document.body.appendChild(E),E.click(),document.body.removeChild(E)},F=I(()=>J.theme||{});return(_,E)=>{var gt,Ut,ft,Ne;const pe=Jt,le=gl,Xt=Kl,vt=Jl;return f(),b("div",{class:n(["rounded-xl",(gt=F.value)==null?void 0:gt.cardBg])},[t("div",go,[t("div",{class:n(["font-semibold flex items-center gap-2",(Ut=F.value)==null?void 0:Ut.text])},[s(pe,{name:"i-heroicons-paper-clip",class:"w-5 h-5 text-indigo-300"}),E[4]||(E[4]=t("span",null,"附件管理",-1))],2),t("div",fo,[s(le,{loading:B.value,color:"gray",variant:"soft",class:"shadow",onClick:ae},{default:m(()=>E[5]||(E[5]=[v("刷新")])),_:1},8,["loading"])])]),t("div",bo,[t("div",wo,[s(le,{color:M.value==="images"?"primary":"gray",variant:"soft",onClick:E[0]||(E[0]=q=>M.value="images")},{default:m(()=>E[6]||(E[6]=[v("图片")])),_:1},8,["color"]),s(le,{color:M.value==="videos"?"primary":"gray",variant:"soft",onClick:E[1]||(E[1]=q=>M.value="videos")},{default:m(()=>E[7]||(E[7]=[v("视频")])),_:1},8,["color"])]),M.value==="images"?(f(),b("div",yo,[U.value.length===0?(f(),b("div",{key:0,class:n(["text-sm",(ft=F.value)==null?void 0:ft.mutedText])},"暂无图片附件",2)):(f(),b("div",xo,[(f(!0),b(ue,null,ce(we.value,q=>{var ke,Oe,Te,$e,Xe,Ye;return f(),b("div",{key:q.name,class:n(["rounded-lg border p-3",(ke=F.value)==null?void 0:ke.border])},[t("div",ho,[t("div",null,[t("div",{class:n(["text-sm",(Oe=F.value)==null?void 0:Oe.text])},x(q.name),3),t("div",{class:n(["text-xs",(Te=F.value)==null?void 0:Te.mutedText])},x(k(q.size))+" · "+x(c(q.modified_at)),3)]),t("div",ko,[s(le,{size:"xs",icon:"i-heroicons-arrow-down-tray",color:"gray",variant:"soft",onClick:ie=>S(q)},{default:m(()=>E[8]||(E[8]=[v("下载")])),_:2},1032,["onClick"]),s(le,{size:"xs",icon:"i-heroicons-trash",color:"red",variant:"soft",onClick:ie=>g("image",q)},{default:m(()=>E[9]||(E[9]=[v("删除")])),_:2},1032,["onClick"])])]),t("img",{src:se(q.url),class:"mt-2 rounded w-full max-h-40 object-contain bg-black/20",loading:"lazy"},null,8,Co),t("div",Vo,[s(le,{size:"xs",color:"gray",variant:"ghost",onClick:ie=>D(q)},{default:m(()=>[v(x(N(q)?"收起关联内容":"查看关联内容"),1)]),_:2},1032,["onClick"]),N(q)?(f(),b("div",{key:0,class:n(["mt-2 rounded p-2",($e=F.value)==null?void 0:$e.subtleBg])},[(Xe=q.belongs)!=null&&Xe.length?(f(),b("div",Uo,[(f(!0),b(ue,null,ce(q.belongs,ie=>{var Ze,Pe,Qe,et;return f(),b("div",{key:ie.id,class:n(["text-xs",(Ze=F.value)==null?void 0:Ze.text])},[t("div",Eo,[t("span",{class:n(["px-2 py-1 rounded text-[10px]",(Pe=F.value)==null?void 0:Pe.subtleBg])},"#"+x(ie.id),3),t("span",{class:n((Qe=F.value)==null?void 0:Qe.mutedText)},x(c(ie.created_at)),3)]),t("div",{class:n(["mt-1 line-clamp-2",(et=F.value)==null?void 0:et.mutedText])},x(ie.snippet),3)],2)}),128))])):(f(),b("div",{key:0,class:n(["text-xs",(Ye=F.value)==null?void 0:Ye.mutedText])},"无关联内容",2))],2)):$("",!0)])],2)}),128)),U.value.length>we.value.length?(f(),b("div",To,[s(le,{color:"gray",variant:"soft",onClick:Ue},{default:m(()=>E[10]||(E[10]=[v("加载更多")])),_:1})])):U.value.length>4?(f(),b("div",Lo,[s(le,{color:"gray",variant:"soft",onClick:Be},{default:m(()=>E[11]||(E[11]=[v("收起")])),_:1})])):$("",!0)]))])):(f(),b("div",So,[u.value.length===0?(f(),b("div",{key:0,class:n(["text-sm",(Ne=F.value)==null?void 0:Ne.mutedText])},"暂无视频附件",2)):(f(),b("div",Ao,[(f(!0),b(ue,null,ce(me.value,q=>{var ke,Oe,Te,$e,Xe,Ye;return f(),b("div",{key:q.name,class:n(["rounded-lg border p-3",(ke=F.value)==null?void 0:ke.border])},[t("div",Bo,[t("div",null,[t("div",{class:n(["text-sm",(Oe=F.value)==null?void 0:Oe.text])},x(q.name),3),t("div",{class:n(["text-xs",(Te=F.value)==null?void 0:Te.mutedText])},x(k(q.size))+" · "+x(c(q.modified_at)),3)]),t("div",$o,[s(le,{size:"xs",icon:"i-heroicons-arrow-down-tray",color:"gray",variant:"soft",onClick:ie=>S(q)},{default:m(()=>E[12]||(E[12]=[v("下载")])),_:2},1032,["onClick"]),s(le,{size:"xs",icon:"i-heroicons-trash",color:"red",variant:"soft",onClick:ie=>g("video",q)},{default:m(()=>E[13]||(E[13]=[v("删除")])),_:2},1032,["onClick"])])]),t("video",{src:se(q.url),class:"mt-2 rounded w-full max-h-64 bg-black/20",controls:"",preload:"metadata"},null,8,Ro),t("div",jo,[s(le,{size:"xs",color:"gray",variant:"ghost",onClick:ie=>D(q)},{default:m(()=>[v(x(N(q)?"收起关联内容":"查看关联内容"),1)]),_:2},1032,["onClick"]),N(q)?(f(),b("div",{key:0,class:n(["mt-2 rounded p-2",($e=F.value)==null?void 0:$e.subtleBg])},[(Xe=q.belongs)!=null&&Xe.length?(f(),b("div",Po,[(f(!0),b(ue,null,ce(q.belongs,ie=>{var Ze,Pe,Qe,et;return f(),b("div",{key:ie.id,class:n(["text-xs",(Ze=F.value)==null?void 0:Ze.text])},[t("div",Io,[t("span",{class:n(["px-2 py-1 rounded text-[10px]",(Pe=F.value)==null?void 0:Pe.subtleBg])},"#"+x(ie.id),3),t("span",{class:n((Qe=F.value)==null?void 0:Qe.mutedText)},x(c(ie.created_at)),3)]),t("div",{class:n(["mt-1 line-clamp-2",(et=F.value)==null?void 0:et.mutedText])},x(ie.snippet),3)],2)}),128))])):(f(),b("div",{key:0,class:n(["text-xs",(Ye=F.value)==null?void 0:Ye.mutedText])},"无关联内容",2))],2)):$("",!0)])],2)}),128)),u.value.length>me.value.length?(f(),b("div",Do,[s(le,{color:"gray",variant:"soft",onClick:ze},{default:m(()=>E[14]||(E[14]=[v("加载更多")])),_:1})])):u.value.length>4?(f(),b("div",Ho,[s(le,{color:"gray",variant:"soft",onClick:Ee},{default:m(()=>E[15]||(E[15]=[v("收起")])),_:1})])):$("",!0)]))]))]),s(vt,{modelValue:z.value,"onUpdate:modelValue":E[3]||(E[3]=q=>z.value=q)},{default:m(()=>{var q;return[s(Xt,{class:n((q=F.value)==null?void 0:q.cardBg)},{default:m(()=>{var ke;return[t("div",{class:n(["text-sm",(ke=F.value)==null?void 0:ke.text])},"确定删除该"+x(T.value==="image"?"图片":"视频")+"附件吗？此操作不可恢复。",3),t("div",_o,[s(le,{color:"gray",variant:"soft",onClick:E[2]||(E[2]=Oe=>z.value=!1)},{default:m(()=>E[16]||(E[16]=[v("取消")])),_:1}),s(le,{color:"red",loading:j.value,onClick:be},{default:m(()=>E[17]||(E[17]=[v("确认删除")])),_:1},8,["loading"])])]}),_:1},8,["class"])]}),_:1},8,["modelValue"])],2)}}}),zo={class:"min-h-screen w-full"},No={class:"px-4 py-4 border-b border-slate-700/40 flex flex-col items-center gap-2"},Oo=["src"],Wo={class:"w-full text-center"},Fo={class:"font-semibold truncate"},qo={class:"flex-1 overflow-y-auto px-2 py-3 space-y-2"},Ko={key:0,class:"space-y-2"},Go={class:"px-4 py-3 border-t border-slate-700/40"},Jo={class:"text-xs text-slate-400"},Xo={class:"mt-2 flex items-center gap-2"},Yo={key:0,class:"mt-2 text-orange-400 flex items-center gap-2"},Zo={class:"flex items-center gap-2"},Qo={class:"flex items-center gap-2"},en={class:"flex-1 px-4 pb-24 flex flex-col w-full space-y-4"},tn={class:"col-span-12"},ln={class:"col-span-12"},sn={class:"px-4 py-3 flex items-center justify-between"},an={class:"flex items-center gap-4"},on={class:"flex items-center gap-3"},nn={class:"flex items-center"},dn={class:"flex items-center"},rn={class:"flex items-center"},un={class:"flex items-center"},cn={class:"flex items-center gap-2"},mn={id:"system-section",class:"col-span-12"},pn={class:"px-4 py-3 flex flex-wrap items-center gap-6"},vn={class:"inline-flex items-center font-medium rounded-md px-2 py-1 gap-1 ml-2 text-sm bg-primary-50 dark:bg-primary-400 dark:bg-opacity-10 text-slate-800 dark:text-slate-200"},gn={class:"inline-flex items-center font-medium rounded-md px-2 py-1 gap-1 ml-2 text-sm bg-primary-50 dark:bg-primary-400 dark:bg-opacity-10 text-slate-800 dark:text-slate-200"},fn={class:"inline-flex items-center font-medium rounded-md px-2 py-1 gap-1 ml-2 text-sm bg-primary-50 dark:bg-primary-400 dark:bg-opacity-10 text-slate-800 dark:text-slate-200"},bn={key:2,id:"user-section",class:"col-span-12"},wn={class:"px-4 pb-4 grid grid-cols-1 md:grid-cols-3 gap-y-2 md:gap-x-4"},yn={class:"flex justify-between items-center mb-2"},xn={key:0},hn={class:"flex justify-end gap-2"},kn={key:1},Cn={class:"mt-3"},Vn={class:"flex justify-between items-center mb-2"},Un={class:"flex items-center gap-2"},En={class:"flex items-center gap-3"},Tn=["src"],Ln={class:"flex items-center gap-2 w-full mt-2"},Sn={class:"p-4"},An={class:"mx-auto",style:{width:"240px",height:"240px","border-radius":"9999px",overflow:"hidden",position:"relative",background:"#111"}},Bn=["src"],$n={class:"mt-3 flex items-center gap-3"},Rn={class:"mt-3"},jn={class:"flex justify-between items-center mb-2"},Pn={key:0},In={class:"flex justify-end gap-2"},Dn={key:1},Hn={class:"flex justify-between items-center mb-2"},_n={class:"flex items-center gap-2"},Mn={key:0,class:"mb-2"},zn={class:"flex items-center gap-2 w-full flex-nowrap"},Nn={key:1},On={class:"flex justify-between items-center mb-2"},Wn={key:0},Fn={class:"w-full mb-2 flex items-center gap-2"},qn={class:"w-full mb-2 flex items-center gap-2"},Kn={class:"w-full mb-2 flex items-center gap-2"},Gn={class:"flex justify-end gap-2"},Jn={class:"flex justify-between items-center mb-2"},Xn={key:0},Yn={class:"w-full mb-2 flex items-center gap-2"},Zn={class:"w-full mb-2 flex items-center gap-2"},Qn={class:"flex justify-between items-center mb-2"},ei={key:0},ti={class:"w-full mb-2 flex items-center gap-2"},li={class:"w-full mb-2 flex items-center gap-2"},si={key:0,class:"w-full mb-2 flex items-center gap-2"},ai={id:"site-section",class:"col-span-12"},oi={class:"flex items-center justify-between px-4 py-3"},ni={class:"px-4 pb-4 space-y-4"},ii={class:"flex justify-between items-center mb-3"},di={class:"flex items-center gap-2"},ri={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},ui={class:"md:col-span-2"},ci={class:"flex items-center gap-4"},mi={class:"flex items-center"},pi={class:"flex items-center"},vi={class:"flex justify-between items-center mb-3"},gi={class:"flex items-center gap-4"},fi={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},bi={class:"md:col-span-2"},wi={class:"flex items-center gap-4"},yi={class:"flex items-center"},xi={class:"flex items-center"},hi={class:"flex items-center gap-4"},ki={class:"flex justify-end"},Ci={id:"site-music-section",class:"col-span-12 mt-4"},Vi={class:"flex items-center justify-between px-4 py-3"},Ui={class:"flex items-center gap-3"},Ei={class:"px-4 pb-4"},Ti={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Li={key:0},Si={key:1},Ai={class:"flex items-center gap-2 md:col-span-2"},Bi={class:"flex justify-end gap-2"},$i={class:"flex items-center gap-4"},Ri={class:"flex items-center"},ji={class:"flex items-center"},Pi={id:"site-configs-section",class:"space-y-4"},Ii={class:"flex justify-between items-center mb-2"},Di={key:0},Hi={key:0,class:"space-y-3"},_i=["src","onClick"],Mi={class:"flex items-center gap-2"},zi={class:"flex items-center justify-center gap-3"},Ni={key:0,class:"mt-3"},Oi={key:1,class:"space-y-2"},Wi={class:"flex items-center gap-3"},Fi=["src"],qi={class:"flex justify-end gap-2"},Ki={key:1},Gi={key:0,class:"grid grid-cols-3 gap-2"},Ji=["src","onClick"],Xi={key:1,class:"flex items-center gap-3"},Yi=["src"],Zi={key:0,class:"flex justify-end gap-2"},Qi={id:"site-ads-section",class:"col-span-12"},ed={class:"flex items-center justify-between px-4 py-3"},td={class:"flex items-center gap-3"},ld={class:"px-4 pb-4"},sd={class:"mt-2"},ad={class:"space-y-2"},od={class:"flex items-center justify-between mb-2"},nd={class:"flex items-center gap-2"},id={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},dd={class:"flex items-center justify-between"},rd={class:"flex items-center gap-2"},ud={class:"flex items-center gap-2"},cd={class:"flex justify-end mt-3"},md={id:"hitokoto-section",class:"col-span-12"},pd={class:"flex items-center justify-between px-4 py-3"},vd={class:"flex items-center gap-3"},gd={class:"px-4 pb-4"},fd={id:"site-social-links-section",class:"col-span-12"},bd={class:"flex items-center justify-between px-4 py-3"},wd={class:"flex items-center gap-3"},yd={class:"px-4 pb-4"},xd={key:0,class:"space-y-2"},hd={class:"grid grid-cols-1 md:grid-cols-3 gap-3"},kd={class:"flex justify-end mt-2"},Cd={class:"flex items-center justify-between"},Vd={id:"friend-links-section",class:"col-span-12 mt-4"},Ud={class:"flex items-center justify-between px-4 py-3"},Ed={class:"flex items-center gap-3"},Td={class:"px-4 pb-4"},Ld={class:"flex items-center justify-between"},Sd={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Ad={id:"comments-section",class:"col-span-12"},Bd={class:"flex items-center justify-between px-4 py-3"},$d={class:"flex items-center gap-3"},Rd={class:"flex items-center gap-2"},jd={class:"flex items-center gap-2"},Pd={class:"px-4 pb-4"},Id={class:"flex items-center gap-2 mb-2"},Dd={key:0,class:"space-y-2"},Hd={class:"flex items-center justify-between gap-2"},_d={key:0,class:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-2 text-sm"},Md={class:"md:col-span-3"},zd=["href"],Nd={class:"md:col-span-3 flex gap-2"},Od={key:0,class:"flex justify-center"},Wd={class:"flex justify-between items-center"},Fd={class:"space-y-3"},qd={class:"text-sm"},Kd={class:"text-sm"},Gd={class:"text-sm"},Jd={class:"text-sm break-words"},Xd={class:"flex items-center gap-2 text-sm"},Yd={class:"flex justify-end gap-2"},Zd={key:3,id:"email-section",class:"col-span-12"},Qd={class:"flex items-center justify-between px-4 py-3"},er={class:"flex items-center gap-3"},tr={class:"px-4 pb-4"},lr={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},sr={class:"text-xs"},ar={class:"flex justify-end gap-2 mt-3"},or={key:4,id:"admin-users-section",class:"col-span-12"},nr={class:"flex items-center justify-between px-4 py-3"},ir={class:"px-4 pb-4"},dr={class:"flex items-center gap-2"},rr={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2"},ur={class:"flex items-center justify-between gap-2 min-w-0"},cr={class:"mt-2 flex items-center gap-2"},mr={class:"grid grid-cols-1 md:grid-cols-3 gap-2"},pr={class:"mt-3"},vr={class:"flex items-center gap-2"},gr={class:"space-y-3"},fr={class:"flex items-center gap-2"},br={class:"flex items-center gap-2"},wr={class:"flex justify-end gap-2"},yr={key:5,id:"notify-section",class:"col-span-12"},xr={class:"flex items-center justify-between px-4 py-3"},hr={class:"flex items-center gap-3"},kr={class:"flex items-center gap-2"},Cr={class:"px-4 pb-4"},Vr={key:6,id:"site-github-login-section",class:"col-span-12"},Ur={class:"flex items-center justify-between px-4 py-3"},Er={class:"flex items-center gap-3"},Tr={class:"flex items-center gap-2"},Lr={class:"px-4 pb-4 space-y-3"},Sr={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Ar={class:"md:col-span-2"},Br={class:"flex justify-end gap-2"},$r={key:7,id:"attachments-section",class:"col-span-12"},Rr={key:8,id:"db-section",class:"col-span-12"},jr={class:"flex items-center justify-between px-4 py-3"},Pr={class:"flex gap-2 flex-wrap justify-end items-center"},Ir={class:"px-4 pb-4 space-y-4"},Dr={class:"flex items-center gap-3"},Hr={class:"flex items-center gap-2"},_r={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Mr={key:0,class:"flex items-center gap-2"},zr={class:"md:col-span-2"},Nr={class:"flex justify-end gap-2 mt-2"},Or={class:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-3"},Wr={class:"md:col-span-2 flex flex-wrap items-center gap-4"},Fr={class:"flex items-center gap-2"},qr={class:"flex items-center gap-2"},Kr={key:0,class:"flex items-center gap-2"},Gr={class:"flex items-center gap-3 ml-auto"},Jr={class:"flex gap-2"},Xr={class:"flex gap-2"},Yr={class:"flex justify-end gap-2 mt-2"},Zr={key:0},Qr={key:1,class:"flex gap-2"},eu={class:"flex justify-between items-center"},tu={class:"p-2"},lu=["src"],Me="rounded-2xl border shadow-2xl",su=at({__name:"StatusPanel",emits:["restore-success"],setup(p,{emit:J}){const M=V(!0),U=V(!1),u=V(typeof window<"u"&&localStorage.getItem("adminTheme")||"dark"),B=Vt().public.baseApi||"/api",X=V(""),z=I(()=>{var h,y,C,Z;if(X.value)return X.value;const l=String(((h=k.user)==null?void 0:h.avatar_url)||((y=k.user)==null?void 0:y.AvatarURL)||"").trim(),e=((C=k.user)==null?void 0:C.username)||((Z=k.user)==null?void 0:Z.Username)||"",d=te=>te?/^https?:\/\//i.test(te)?te:`${B}${te}`:"",i=(te,ge=100)=>te?`https://api.dicebear.com/7.x/initials/svg?seed=${encodeURIComponent(te)}&backgroundType=gradient&radius=50&scale=100&size=${ge}`:"";return d(l)||(e?i(String(e)):"")||"/favicon-32x32.png"}),j=async(l,e)=>{await va();const d=document.getElementById(`${l}-section`);d&&(d.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),window.innerWidth<768&&(U.value=!1))};Ve(()=>{cl(),U.value=window.innerWidth>=768;try{const l=document.documentElement,e=u.value!=="light",d=l.classList.contains("dark");e&&!d?l.classList.add("dark"):!e&&d&&l.classList.remove("dark")}catch{}}),Ae(()=>u.value,l=>{try{const e=document.documentElement,d=l!=="light",i=e.classList.contains("dark");d&&!i?e.classList.add("dark"):!d&&i&&e.classList.remove("dark")}catch{}});const T=V(typeof window<"u"?window.innerWidth>=768:!0),P=()=>{typeof window>"u"||(T.value=window.innerWidth>=768)};Ve(()=>{P(),typeof window<"u"&&window.addEventListener("resize",P)}),da(()=>{typeof window<"u"&&window.removeEventListener("resize",P)});const o=I(()=>u.value==="light"?{sidebarBg:"bg-white/90",headerBg:"bg-white",bottomBg:"bg-white",cardBg:"bg-white",subtleBg:"bg-white",border:"border-gray-300",text:"text-slate-900",sidebarText:"text-slate-900",mutedText:"text-slate-700",pageBg:"bg-gray-50",navBtnBg:"bg-gray-100",navBtnHoverBg:"hover:bg-gray-200"}:u.value==="dark"?{sidebarBg:"bg-gray-950/80",headerBg:"bg-gray-950/70",bottomBg:"bg-gray-950/70",cardBg:"bg-gray-900/70",subtleBg:"bg-gray-900/50",border:"border-gray-800/60",text:"text-white",sidebarText:"text-white",mutedText:"text-gray-300",pageBg:"bg-gradient-to-br from-slate-900 via-indigo-950 to-slate-800",navBtnBg:"bg-slate-800/70",navBtnHoverBg:"hover:bg-slate-700/70"}:u.value==="midnight"?{sidebarBg:"bg-indigo-950/60",headerBg:"bg-indigo-950/50",bottomBg:"bg-indigo-950/50",cardBg:"bg-indigo-900/40",subtleBg:"bg-indigo-950/30",border:"border-indigo-800/40",text:"text-white",sidebarText:"text-white",mutedText:"text-indigo-200",pageBg:"bg-gradient-to-br from-indigo-950 via-indigo-900 to-slate-900",navBtnBg:"bg-indigo-950/40",navBtnHoverBg:"hover:bg-indigo-900/40"}:u.value==="slate"?{sidebarBg:"bg-slate-900/70",headerBg:"bg-slate-900/60",bottomBg:"bg-slate-900/60",cardBg:"bg-slate-800/70",subtleBg:"bg-slate-900/40",border:"border-slate-700/40",text:"text-white",sidebarText:"text-white",mutedText:"text-slate-200",pageBg:"bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",navBtnBg:"bg-slate-800/70",navBtnHoverBg:"hover:bg-slate-700/70"}:{sidebarBg:"bg-slate-900/70",headerBg:"bg-slate-900/60",bottomBg:"bg-slate-900/60",cardBg:"bg-slate-800/70",subtleBg:"bg-slate-900/40",border:"border-slate-700/40",text:"text-white",sidebarText:"text-white",mutedText:"text-slate-200",pageBg:"bg-gradient-to-br from-slate-900 via-indigo-950 to-slate-800",navBtnBg:"bg-slate-800/70",navBtnHoverBg:"hover:bg-slate-700/70"}),W=async()=>{localStorage.setItem("adminTheme",u.value);try{const l=document.documentElement,e=u.value!=="light",d=l.classList.contains("dark");e&&!d?l.classList.add("dark"):!e&&d&&l.classList.remove("dark")}catch{}try{const e=await(await fetch("/api/frontend/config",{credentials:"include"})).json();let d={};e.code===1?d={...e.data,adminTheme:u.value}:d={adminTheme:u.value};const i=await fetch("/api/settings",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(d)});(await i.json()).code===1&&w().add({title:(i==null?void 0:i.msg)||"已保存",color:"green"})}catch{}},ne=async()=>{try{const e=await(await fetch("/api/frontend/config",{credentials:"include"})).json();e.code===1&&typeof e.data.allowRegistration=="boolean"&&(M.value=e.data.allowRegistration)}catch{w().add({title:"获取注册配置失败",color:"red"})}};Ve(ne);const se=async()=>{try{const e=await(await fetch("/api/frontend/config",{credentials:"include"})).json();let d={};e.code===1?d={...e.data,allowRegistration:M.value}:d={allowRegistration:M.value};const h=await(await fetch("/api/settings",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(d)})).json();if(h.code===1)w().add({title:"保存成功",color:"green"});else throw new Error(h.msg||"保存失败")}catch{w().add({title:"保存失败",color:"red"})}},k=Wl(),{login:c,register:N}=Pa(),D=Fl(),O=V(""),Y=fe({checking:!1,hasUpdate:!1,latestVersion:"",currentVersion:""});let ae=fe({webhookEnabled:!1,webhookURL:"",telegramEnabled:!1,telegramToken:"",telegramChatID:"",weworkEnabled:!1,weworkKey:"",feishuEnabled:!1,feishuWebhook:"",feishuSecret:""});const g=fe({enabled:!1,driver:"smtp",host:"",port:"",user:"",pass:"",from:"",tls:!1,encryption:"tls"}),be=V(!1),we=async()=>{try{const l=await mt("frontend/config",void 0,{credentials:"include"});if(l&&l.code===1){const e=l.data||{};g.enabled=!!e.smtpEnabled,g.driver=e.smtpDriver||"smtp",g.host=e.smtpHost||"",g.port=(e.smtpPort??"").toString(),g.user=e.smtpUser||"",g.pass=e.smtpPass||"",g.from=e.smtpFrom||"",g.tls=!!e.smtpTLS,g.encryption=e.smtpEncryption||(g.tls?"tls":"ssl")}}catch{}};Ve(we);const me=async()=>{try{const l=await mt("frontend/config",void 0,{credentials:"include"}),e=(l==null?void 0:l.code)===1?{...l.data}:{};e.smtpEnabled=g.enabled,e.smtpDriver=g.driver,e.smtpHost=g.host,e.smtpPort=parseInt(g.port||"0")||0,e.smtpUser=g.user,e.smtpPass=g.pass,e.smtpFrom=g.from,e.smtpEncryption=g.encryption,e.smtpTLS=g.encryption==="tls";const d=await _e("settings",e,{credentials:"include"});if(d&&d.code===1)w().add({title:(d==null?void 0:d.msg)||"已保存",color:"green"});else throw new Error((d==null?void 0:d.msg)||"保存失败")}catch(l){w().add({title:"保存失败",description:l.message,color:"red"})}},Ue=V([]);V("");const ze=V(""),Be=V(!1),Ee=V(!1),S=fe({newPass:"",confirmPass:""}),F=I(()=>{const l=S.newPass||"";let e=0;return l.length>=8&&e++,/[A-Z]/.test(l)&&/[a-z]/.test(l)&&e++,/\d/.test(l)&&/[^A-Za-z0-9]/.test(l)&&e++,Math.min(e,3)}),_=I(()=>F.value<=1?"弱":F.value===2?"中":"强"),E=I(()=>F.value<=1?"red":F.value===2?"orange":"green"),pe=I(()=>!S.newPass||!S.confirmPass||S.newPass!==S.confirmPass?!1:F.value>=2),le=async()=>{try{const l=await mt("frontend/config",void 0,{credentials:"include"});if(l&&l.code===1){const e=l.data||{};Ue.value=Array.isArray(e.adminUsers)?e.adminUsers:[],ze.value=e.adminPasswordMasked||""}}catch{}};Ve(le);const Xt=async()=>{try{if(!pe.value)throw new Error("请填写符合强度的新密码并确认一致");const l=await mt("frontend/config",void 0,{credentials:"include"}),e=(l==null?void 0:l.code)===1?{...l.data}:{};e.adminPasswordReset=S.newPass;const d=await _e("settings",e,{credentials:"include"});if(d&&d.code===1)w().add({title:(d==null?void 0:d.msg)||"管理员密码已重置",color:"green"}),await le(),Be.value=!1,Ee.value=!1,S.newPass="",S.confirmPass="";else throw new Error((d==null?void 0:d.msg)||"重置失败")}catch(l){w().add({title:"重置失败",description:l.message,color:"red"})}},vt=V(""),gt=I(()=>{const l=k.status||{},e=l.users||l.Users||[];return Array.isArray(e)?e:[]}),Ut=I(()=>{const l=(vt.value||"").trim().toLowerCase();return l?gt.value.filter(e=>{const d=String(e.id??e.ID??e.user_id??""),i=String(e.username??e.Username??"").toLowerCase();return d.includes(l)||i.includes(l)}):gt.value}),ft=async()=>{await k.getStatus()},Ne=V(!1),q=V({}),ke=l=>!!q.value[String(l.id??l.ID)],Oe=l=>{const e=String(l.id??l.ID);q.value[e]=!q.value[e]},Te=fe({password:{}}),$e=V(!1),Xe=l=>(Te.password[String(l.id??l.ID)]||"").trim().length>=6,Ye=async l=>{try{const e=l.id??l.ID??l.user_id,d=(Te.password[String(e)]||"").trim();if(d.length<6)throw new Error("密码至少6位");const i=await he("user/reset_password",{id:e,password:d},{credentials:"include"});if(i&&i.code===1)w().add({title:(i==null?void 0:i.msg)||"已重置密码",color:"green"}),Te.password[String(e)]="";else throw new Error((i==null?void 0:i.msg)||"重置失败")}catch(e){w().add({title:"重置失败",description:e.message,color:"red"})}},ie=async l=>{try{const e=l.username??l.Username;if(!window.confirm(`确定要切换用户“${e}”的管理员权限吗？`)||!window.confirm("该操作存在风险，是否继续？"))return;const d=l.id??l.ID??l.user_id,i=await _e(`user/admin?id=${d}`,{},{credentials:"include"});if(i&&i.code===1)w().add({title:(i==null?void 0:i.msg)||"已更新管理员状态",color:"green"}),await k.getStatus();else throw new Error((i==null?void 0:i.msg)||"更新失败")}catch(e){w().add({title:"更新失败",description:e.message,color:"red"})}},Ze=async l=>{try{const e=l.username??l.Username;if(!window.confirm(`确定要删除用户“${e}”吗？删除后不可恢复。`)||!window.confirm("该操作存在风险，是否继续？"))return;const d=l.id??l.ID??l.user_id,i=await Hl("user",{id:d},{credentials:"include"});if(i&&i.code===1)w().add({title:(i==null?void 0:i.msg)||"已删除用户",color:"green"}),await k.getStatus();else throw new Error((i==null?void 0:i.msg)||"删除失败")}catch(e){w().add({title:"删除失败",description:e.message,color:"red"})}},Pe=V(!1),Qe=async()=>{try{const l=(g.from||g.user||"").trim();if(!l||!g.host||!g.port||!g.user||!g.pass||!g.encryption)throw new Error("请完整填写地址、主机、端口、加密协议、用户名和密码");Pe.value=!0,g.enabled||(g.enabled=!0,await me());let e=await he("notify/test",{type:"email",to:l},{credentials:"include"});if((!e||e.code!==1)&&(e=await he("email/test",{to:l},{credentials:"include"})),e&&e.code===1)w().add({title:(e==null?void 0:e.msg)||"测试邮件已发送",color:"green"});else throw new Error((e==null?void 0:e.msg)||"发送失败或接口不存在")}catch(l){w().add({title:"失败",description:l.message,color:"red"})}finally{Pe.value=!1}},et=()=>{try{if(!r.githubOAuthEnabled)throw new Error("请先开启 GitHub 登录");if(!r.githubClientId||!r.githubCallbackURL)throw new Error("请先填写 Client ID 与回调地址");const l=Vt().public.baseApi||"/api";window.open(`${l}/oauth/github/login`,"_blank")}catch(l){w().add({title:"无法测试",description:l.message,color:"red"})}},Yl=async()=>{Y.checking=!0;try{const e=await(await fetch("/api/version/check",{credentials:"include",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}})).json();if(e.code===1){const{hasUpdate:d,lastUpdateTime:i}=e.data;Y.hasUpdate=d,Y.latestVersion=new Date(i).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),d?w().add({title:"发现版本",description:`最新版本发布于 ${Y.latestVersion}`,color:"orange"}):w().add({title:"已是最新版本",description:"当前使用的是最新版本",color:"green"})}else throw new Error(e.msg||"检查更新失败")}catch(l){console.error("检查版本更新失败:",l),w().add({title:"检查更新失败",description:"请科学上网后重试",color:"red"})}finally{Y.checking=!1}};Ve(async()=>{var l;try{const d=await(await fetch("/api/version",{credentials:"include"})).json();d&&d.code===1&&(Y.currentVersion=String(((l=d.data)==null?void 0:l.version)||""))}catch{}});const Zl=async()=>{var l;if(!k.isLogin){w().add({title:"错误",description:"请先登录",color:"red"});return}try{if(typeof window<"u"&&!window.confirm("重新生成将使旧 Token 失效，确认继续？"))return;Qt.value=!0;const e=await fetch("/api/user/token/regenerate",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}}),d=await e.json();if(!e.ok)throw new Error(d.msg||"Token生成请求失败");if(d.code===1&&((l=d.data)!=null&&l.token))O.value=d.data.token,ot.value=!1,w().add({title:"成功",description:(d==null?void 0:d.msg)||"Token 已更新",color:"green"});else throw new Error(d.msg||"Token 生成失败")}catch(e){console.error("Token生成错误:",e),w().add({title:"错误",description:e.message||"Token 生成失败",color:"red"})}finally{Qt.value=!1}},Ql=async()=>{try{await navigator.clipboard.writeText(O.value),w().add({title:"成功",description:"Token 已复制到剪贴板",color:"green"})}catch{w().add({title:"错误",description:"复制失败",color:"red"})}},wl=async()=>{try{const l=await fetch("/api/user/logout",{method:"POST",credentials:"include"}),e=await l.json().catch(()=>({}));if(!l.ok||e.code!==1)throw new Error((e==null?void 0:e.msg)||"退出失败");k.clearUserStatus(),w().add({title:"成功",description:"已退出登录",color:"green"}),D.push("/")}catch{k.clearUserStatus(),w().add({title:"成功",description:"已退出登录",color:"green"}),D.push("/")}},Et=I(()=>(k==null?void 0:k.isLogin)??!1),Le=I(()=>{var l;return((l=k.user)==null?void 0:l.is_admin)??!1}),We=V(!0),Tt=V(!1),yl=V(!1),bt=V(null),wt=V(null),Lt=V(null),xl=V(null),Se=V(!1),St=V(""),yt=V(!1),Ie=V(""),xt=V(1),At=V(0),Bt=V(0);let Yt=!1,$t={x:0,y:0};const L=fe({username:"",description:"",oldPassword:"",newPassword:"",confirmPassword:"",email:"",emailCode:"",newEmail:"",changeCode:""}),G=fe({username:!1,description:!1,password:!1,emailBind:!1,emailChange:!1}),Zt=V(!1),ot=V(!1),Qt=V(!1),Rt=V(!1),jt=V(!1),Pt=V(!1),nt=I(()=>{const l=L.newPassword||"";let e=0;return l.length>=8&&e++,/[A-Z]/.test(l)&&/[a-z]/.test(l)&&e++,/\d/.test(l)&&/[^A-Za-z0-9]/.test(l)&&e++,Math.min(e,3)}),es=I(()=>nt.value<=1?"弱":nt.value===2?"中":"强"),ts=I(()=>nt.value<=1?"red":nt.value===2?"orange":"green"),ls=I(()=>!L.oldPassword||!L.newPassword||!L.confirmPassword||L.newPassword===L.oldPassword||L.newPassword!==L.confirmPassword?!1:nt.value>=2),ss=async()=>{try{if(!L.username.trim())throw new Error("用户名不能为空");const l=await _e("user/update",{username:L.username,type:"username"},{credentials:"include"});if(l&&l.code===1)await k.getUser(),G.username=!1,L.username="",w().add({title:"成功",description:(l==null?void 0:l.msg)||"用户名已更新",color:"green"});else throw new Error(l==null?void 0:l.msg)}catch(l){w().add({title:"错误",description:l.message||"更新失败",color:"red"})}},as=async()=>{try{const l=(L.description||"").trim(),e=await _e("user/update",{description:l},{credentials:"include"});if(e&&e.code===1)await k.getUser(),G.description=!1,L.description="",w().add({title:"成功",description:"个性签名已更新",color:"green"});else throw new Error((e==null?void 0:e.msg)||"保存失败")}catch(l){w().add({title:"错误",description:(l==null?void 0:l.message)||"更新失败",color:"red"})}},os=async()=>{try{if(!L.newPassword||!L.oldPassword||!L.confirmPassword)throw new Error("密码不能为空");if(L.newPassword===L.oldPassword)throw new Error("新密码不能与当前密码相同");if(L.newPassword!==L.confirmPassword)throw new Error("两次输入不一致");if(nt.value<2)throw new Error("密码强度不足");const l=await _e("user/change_password",{password:L.newPassword,oldPassword:L.oldPassword},{credentials:"include"});if(l&&l.code===1)G.password=!1,L.oldPassword="",L.newPassword="",L.confirmPassword="",w().add({title:"成功",description:(l==null?void 0:l.msg)||"密码已更新",color:"green"});else throw new Error(l==null?void 0:l.msg)}catch(l){w().add({title:"错误",description:l.message||"更新失败",color:"red"})}},ns=async()=>{try{const l=String(L.email||"").trim();if(!l)throw new Error("邮箱不能为空");const e=await he("user/email/bind",{email:l},{credentials:"include"});if(!e||e.code!==1)throw new Error((e==null?void 0:e.msg)||"发送失败");w().add({title:"成功",description:"验证码已发送",color:"green"})}catch(l){w().add({title:"错误",description:l.message||"发送失败",color:"red"})}},is=async()=>{try{const l=String(L.emailCode||"").trim();if(!l)throw new Error("请输入验证码");const e=await he("user/email/verify",{code:l},{credentials:"include"});if(!e||e.code!==1)throw new Error((e==null?void 0:e.msg)||"绑定失败");await k.getUser(),G.emailBind=!1,L.email="",L.emailCode="",w().add({title:"成功",description:"邮箱已绑定",color:"green"})}catch(l){w().add({title:"错误",description:l.message||"绑定失败",color:"red"})}},ds=async()=>{try{const l=await he("user/email/change/send_code",{},{credentials:"include"});if(!l||l.code!==1)throw new Error((l==null?void 0:l.msg)||"发送失败");w().add({title:"成功",description:"验证码已发送到当前邮箱",color:"green"})}catch(l){w().add({title:"错误",description:l.message||"发送失败",color:"red"})}},rs=async()=>{try{const l=String(L.changeCode||"").trim(),e=String(L.newEmail||"").trim();if(!l||!e)throw new Error("请输入验证码与新邮箱");const d=await he("user/email/change",{code:l,newEmail:e},{credentials:"include"});if(!d||d.code!==1)throw new Error((d==null?void 0:d.msg)||"更换失败");Zt.value=!0,L.email=e,L.emailCode="",w().add({title:"成功",description:"已向新邮箱发送验证码，请在下方输入验证码完成更换",color:"green"})}catch(l){w().add({title:"错误",description:l.message||"更换失败",color:"red"})}},us=async()=>{try{const l=String(L.emailCode||"").trim();if(!l)throw new Error("请输入新邮箱验证码");const e=await he("user/email/verify",{code:l},{credentials:"include"});if(!e||e.code!==1)throw new Error((e==null?void 0:e.msg)||"确认失败");Zt.value=!1,G.emailChange=!1,L.changeCode="",L.newEmail="",L.email="",L.emailCode="",await k.getUser(),w().add({title:"成功",description:"邮箱已更换",color:"green"})}catch(l){w().add({title:"错误",description:l.message||"确认失败",color:"red"})}},cs=()=>{var l;(l=bt.value)==null||l.click()},ms=()=>{var e,d;const l=((d=(e=bt.value)==null?void 0:e.files)==null?void 0:d[0])||null;xl.value=l||null,l&&(Ie.value=URL.createObjectURL(l),X.value=Ie.value,xt.value=1,At.value=0,Bt.value=0,yt.value=!0)},ps=async l=>{try{if(!l){w().add({title:"错误",description:"请先选择头像图片",color:"red"});return}Se.value=!0;const e=new FormData;e.append("image",l);const d=await fetch("/api/images/upload",{method:"POST",body:e,credentials:"include"}),i=await d.json().catch(()=>({}));if(!d.ok||i.code!==1||!i.data)throw new Error((i==null?void 0:i.msg)||"上传失败");const h=String(i.data||"").trim(),y=await _e("user/update",{avatar_url:h},{credentials:"include"});if(!y||y.code!==1)throw new Error((y==null?void 0:y.msg)||"保存失败");await k.getUser(),w().add({title:"成功",description:"头像已更新",color:"green"}),xl.value=null,bt.value&&(bt.value.value=""),X.value=""}catch(e){w().add({title:"错误",description:e.message||"操作失败",color:"red"})}finally{Se.value=!1}},vs=async()=>{try{const l=String(St.value||"").trim();if(!l)throw new Error("请填写头像链接");if(!/^https?:\/\//i.test(l)&&!l.startsWith("/api"))throw new Error("链接需以 http 或 /api 开头");Se.value=!0,X.value=l.startsWith("http")?l:`${B}${l}`;const e=await _e("user/update",{avatar_url:l},{credentials:"include"});if(!e||e.code!==1)throw new Error((e==null?void 0:e.msg)||"保存失败");await k.getUser(),w().add({title:"成功",description:"头像链接已保存",color:"green"})}catch(l){w().add({title:"错误",description:l.message||"操作失败",color:"red"})}finally{Se.value=!1}};Ae(St,l=>{const e=String(l||"").trim();if(!e){X.value="";return}/^https?:\/\//i.test(e)?X.value=e:e.startsWith("/api")&&(X.value=`${B}${e}`)});const hl=l=>{Yt=!0;const e=l.touches?l.touches[0]:l;$t={x:e.clientX,y:e.clientY},window.addEventListener("mousemove",It),window.addEventListener("mouseup",Dt),window.addEventListener("touchmove",It),window.addEventListener("touchend",Dt)},It=l=>{if(!Yt)return;const e=l.touches?l.touches[0]:l,d=e.clientX-$t.x,i=e.clientY-$t.y;At.value+=d,Bt.value+=i,$t={x:e.clientX,y:e.clientY}},Dt=()=>{Yt=!1,window.removeEventListener("mousemove",It),window.removeEventListener("mouseup",Dt),window.removeEventListener("touchmove",It),window.removeEventListener("touchend",Dt)},gs=async()=>{try{if(!Ie.value)return;Se.value=!0;const l=await new Promise((ye,K)=>{const Q=new Image;Q.crossOrigin="anonymous",Q.onload=()=>ye(Q),Q.onerror=K,Q.src=Ie.value}),e=400,d=document.createElement("canvas");d.width=e,d.height=e;const i=d.getContext("2d"),h=xt.value,y=l.naturalWidth,C=l.naturalHeight,Z=y*h,te=C*h,ge=e/2+At.value-Z/2,re=e/2+Bt.value-te/2;i.clearRect(0,0,e,e),i.drawImage(l,ge,re,Z,te);const Ge=await new Promise(ye=>d.toBlob(K=>ye(K),"image/png")),Ce=new File([Ge],"avatar.png",{type:"image/png"});await ps(Ce),yt.value=!1,Ie.value&&URL.revokeObjectURL(Ie.value),Ie.value="",X.value=""}catch(l){w().add({title:"错误",description:l.message||"裁剪失败",color:"red"})}finally{Se.value=!1}},fs=()=>{yt.value=!1},bs=async()=>{var l,e;try{const d=String(((l=k.user)==null?void 0:l.username)||((e=k.user)==null?void 0:e.Username)||"").trim();if(!d)throw new Error("请先设置用户名");const i=`https://api.dicebear.com/7.x/initials/svg?seed=${encodeURIComponent(d)}&backgroundType=gradient&radius=50&scale=100&size=100`;Se.value=!0;const h=await _e("user/update",{avatar_url:i},{credentials:"include"});if(!h||h.code!==1)throw new Error((h==null?void 0:h.msg)||"保存失败");await k.getUser(),X.value="",w().add({title:"成功",description:"已切换为首字母头像",color:"green"})}catch(d){w().add({title:"错误",description:(d==null?void 0:d.message)||"操作失败",color:"red"})}finally{Se.value=!1}},el={siteTitle:"站点标题",subtitleText:"欢迎语",backgrounds:"背景图片",cardFooterTitle:"卡片页脚标题",cardFooterLink:"卡片页脚链接",pageFooterHTML:"页面底部HTML",rssTitle:"RSS 标题",rssDescription:"RSS 描述",rssAuthorName:"RSS 作者",rssFaviconURL:"RSS 图标链接",linksTitle:"友链页面标题",linksDescription:"友链页面说明",commentPageTitle:"留言页面标题",commentPageDescription:"留言页面说明",aboutPageTitle:"关于页面标题",aboutPageDescription:"关于页面说明",aboutMarkdown:"关于页面 Markdown 内容"},r=fe({siteTitle:"",subtitleText:"",welcomeName:"",welcomeAvatarURL:"",welcomeDescription:"",welcomeUseAdmin:!1,backgrounds:[],cardFooterTitle:"",cardFooterLink:"",pageFooterHTML:"",rssTitle:"",rssDescription:"",rssAuthorName:"",rssFaviconURL:"",hitokotoEnabled:!0,friendLinks:[],linksTitle:"",linksDescription:"",commentPageTitle:"",commentPageDescription:"",aboutPageTitle:"",aboutPageDescription:"",aboutMarkdown:"",walineServerURL:"",commentEnabled:!0,commentSystem:"builtin",commentEmailEnabled:!1,commentLoginRequired:!0,githubOAuthEnabled:!1,githubClientId:"",githubClientSecret:"",githubCallbackURL:"",notifyEnabled:!1,enableGithubCard:!1,pwaEnabled:!0,pwaTitle:"",pwaDescription:"",pwaIconURL:"",defaultContentTheme:"light",announcementText:"",announcementEnabled:!0,musicEnabled:!1,musicPlaylistId:"",musicSongId:"",musicPosition:"bottom-left",musicTheme:"auto",musicLyric:!0,musicAutoplay:!1,musicDefaultMinimized:!0,musicEmbed:!1,musicCssCdnURL:"",musicJsCdnURL:"",socialLinks:[],calendarEnabled:!0,timeEnabled:!0,leftAdEnabled:!0,leftAdImageURL:"https://picsum.photos/seed/single-ad/640/640",leftAdLinkURL:"https://note.noisework.cn",leftAdDescription:"示例广告（单条配置）",leftAds:[{imageURL:"https://picsum.photos/seed/ad-1/640/640",linkURL:"https://note.noisework.cn",description:"写作与记录，开启灵感之旅"},{imageURL:"https://picsum.photos/seed/ad-2/640/640",linkURL:"https://noisework.cn",description:"探索新主题与小工具"},{imageURL:"https://picsum.photos/seed/ad-3/640/640",linkURL:"https://github.com",description:"开源项目，欢迎 Star"}],leftAdsIntervalMs:4e3}),Fe=I({get:()=>r.enableGithubCard===!0,set:l=>{const e=l===!0||l==="true"||l===1||l==="1";r.enableGithubCard=e}}),tt=fe({username:"",password:""}),ve=fe({siteTitle:!1,subtitleText:!1,backgrounds:!1,cardFooterTitle:!1,cardFooterLink:!1,pageFooterHTML:!1,rssTitle:!1,rssDescription:!1,rssAuthorName:!1,rssFaviconURL:!1,walineServerURL:!1,socialLinks:!1,linksTitle:!1,linksDescription:!1,commentPageTitle:!1,commentPageDescription:!1,aboutPageTitle:!1,aboutPageDescription:!1}),oe={siteTitle:"说说笔记",subtitleText:"欢迎访问，点击头像可更换封面背景！",avatarURL:"",welcomeName:"",welcomeAvatarURL:"",welcomeDescription:"",welcomeUseAdmin:!1,backgrounds:["https://s2.loli.net/2025/03/27/KJ1trnU2ksbFEYM.jpg","https://s2.loli.net/2025/03/27/MZqaLczCvwjSmW7.jpg","https://s2.loli.net/2025/03/27/UMijKXwJ9yTqSeE.jpg","https://s2.loli.net/2025/03/27/WJQIlkXvBg2afcR.jpg","https://s2.loli.net/2025/03/27/oHNQtf4spkq2iln.jpg","https://s2.loli.net/2025/03/27/PMRuX5loc6Uaimw.jpg","https://s2.loli.net/2025/03/27/U2WIslbNyTLt4rD.jpg","https://s2.loli.net/2025/03/27/xu1jZL5Og4pqT9d.jpg","https://s2.loli.net/2025/03/27/OXqwzZ6v3PVIns9.jpg","https://s2.loli.net/2025/03/27/HGuqlE6apgNywbh.jpg","https://s2.loli.net/2025/03/26/d7iyuPYA8cRqD1K.jpg","https://s2.loli.net/2025/03/27/wYy12qDMH6bGJOI.jpg","https://s2.loli.net/2025/03/27/y67m2k5xcSdTsHN.jpg"],cardFooterTitle:"Noise·说说·笔记~",cardFooterLink:"note.noisework.cn",pageFooterHTML:'<div class="text-center text-xs text-gray-400 py-4">来自<a href="https://www.noisework.cn" target="_blank" rel="noopener noreferrer" class="text-orange-400 hover:text-orange-500">Noise</a> 使用<a href="https://github.com/rcy1314/echo-noise" target="_blank" rel="noopener noreferrer" class="text-orange-400 hover:text-orange-500">Ech0-Noise</a>发布</div>',rssTitle:"Noise的说说笔记",rssDescription:"一个说说笔记~",rssAuthorName:"Noise",rssFaviconURL:"/favicon.ico",hitokotoEnabled:!0,linksTitle:"友情链接",linksDescription:"推荐站点和朋友们的主页",commentPageTitle:"留言",commentPageDescription:"欢迎留下你的看法",aboutPageTitle:"关于本站",aboutPageDescription:"这里是站点的介绍与说明",aboutMarkdown:`# 关于我

这里是一个默认的个人简介示例：

- 喜欢记录与分享
- 热爱开源与学习
- 持续打磨产品体验

欢迎通过友链或留言与我交流！`,walineServerURL:"请前往waline官网https://waline.js.org查看部署配置",githubOAuthEnabled:!1,githubClientId:"",githubClientSecret:"",githubCallbackURL:"",pwaEnabled:!0,pwaTitle:"",pwaDescription:"",pwaIconURL:"",defaultContentTheme:"light",announcementText:"欢迎访问我的说说笔记！",announcementEnabled:!0,musicEnabled:!1,musicPlaylistId:"2141128031",musicSongId:"",musicPosition:"bottom-left",musicTheme:"auto",musicLyric:!0,musicAutoplay:!1,musicDefaultMinimized:!0,musicEmbed:!1,musicCssCdnURL:"https://api.hypcvgm.top/NeteaseMiniPlayer/netease-mini-player-v2.css",musicJsCdnURL:"https://api.hypcvgm.top/NeteaseMiniPlayer/netease-mini-player-v2.js",socialLinks:[{name:"GitHub",url:"https://github.com/rcy1314",icon:"i-mdi-github"},{name:"X",url:"https://x.com/liangwenhao3",icon:"i-mdi-twitter"},{name:"主页",url:"https://www.noisework.cn/",icon:"i-mdi-home"},{name:"博客",url:"https://www.noiseblogs.top/",icon:"i-mdi-notebook"}],friendLinks:[{title:"NoiseWork",link:"https://www.noisework.cn/",icon:"i-mdi-home",description:"个人主页与作品集合"},{title:"NoiseBlogs",link:"https://www.noiseblogs.top/",icon:"i-mdi-notebook",description:"技术随笔与学习记录"}],calendarEnabled:!0,timeEnabled:!0,leftAdEnabled:!0,leftAds:[{imageURL:"https://picsum.photos/seed/ad-1/640/640",linkURL:"https://note.noisework.cn",description:"写作与记录，开启灵感之旅"},{imageURL:"https://picsum.photos/seed/ad-2/640/640",linkURL:"https://noisework.cn",description:"探索新主题与小工具"},{imageURL:"https://picsum.photos/seed/ad-3/640/640",linkURL:"https://github.com",description:"开源项目，欢迎 Star"}],leftAdsIntervalMs:4e3},ws=l=>{r[l]=oe[l],ve[l]=!1},qe=async()=>{var l,e;try{const i=await(await fetch("/api/frontend/config",{credentials:"include",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}})).json();if((l=i==null?void 0:i.data)!=null&&l.frontendSettings){const h=i.data.frontendSettings,y=["enableGithubCard","pwaEnabled","announcementEnabled","hitokotoEnabled","musicEnabled","musicLyric","musicAutoplay","musicDefaultMinimized","musicEmbed","commentEnabled","commentEmailEnabled","commentLoginRequired","githubOAuthEnabled","notifyEnabled","calendarEnabled","timeEnabled","leftAdEnabled","welcomeUseAdmin"];if(Object.keys(r).forEach(K=>{if(K==="backgrounds"){const Q=h[K];Array.isArray(Q)&&(r[K]=[...Q])}else if(K==="socialLinks"){const Q=h[K];Array.isArray(Q)?r[K]=[...Q]:r[K]=[...oe.socialLinks||[]]}else if(K==="leftAds"){const Q=h[K];Array.isArray(Q)?r[K]=[...Q]:r[K]=[...oe.leftAds||[]]}else if(K==="friendLinks"){const Q=h[K];Array.isArray(Q)?r[K]=[...Q]:r[K]=[...oe.friendLinks||[]]}else if(y.includes(K)){const Q=h[K]??oe[K];r[K]=Q===!0||Q==="true"}else{const Q=h[K]??oe[K];r[K]=typeof Q=="string"?Q.trim():Q}}),h.enableGithubCard!==void 0){const K=h.enableGithubCard;r.enableGithubCard=K===!0||K==="true"}const C=(r.pwaTitle||r.siteTitle||"说说笔记").trim(),Z=(r.rssFaviconURL||"/favicon.ico").trim(),te=(r.pwaDescription||"").trim();if(!!r.pwaEnabled)_l({title:C,meta:[{name:"description",content:te},{name:"theme-color",content:"#000000"}],link:[{rel:"manifest",href:"/manifest.webmanifest"},{rel:"icon",href:Z},{rel:"apple-touch-icon",href:Z}]});else try{const K=document.querySelector('link[rel="manifest"]');K&&((e=K.parentElement)==null||e.removeChild(K)),"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(async Q=>{for(const ct of Q)await ct.unregister();const Ft=await caches.keys();await Promise.all(Ft.map(ct=>caches.delete(ct)))})}catch{}const re=String(r.musicCssCdnURL||"").trim(),Ge=String(r.musicJsCdnURL||"").trim();(re||Ge)&&ol();const Ce=String(r.musicCssCdnURL||"").trim().toLowerCase(),ye=String(r.musicJsCdnURL||"").trim().toLowerCase();Ce.includes("api.hypcvgm.top")&&ye.includes("api.hypcvgm.top")?He.value="hypcvgm":Ce.includes("jsdelivr")&&ye.includes("jsdelivr")?He.value="jsdelivr":Ce.includes("unpkg")&&ye.includes("unpkg")?He.value="unpkg":He.value="custom"}}catch(d){console.error("获取配置失败:",d)}},de=async l=>{try{if(l==="backgrounds"){const h=r.backgrounds.filter(y=>y&&y.trim()!=="");r.backgrounds=h}if(l==="leftAds"){const h=(r.leftAds||[]).map(y=>({imageURL:String((y==null?void 0:y.imageURL)||"").trim(),linkURL:String((y==null?void 0:y.linkURL)||"").trim(),description:String((y==null?void 0:y.description)||"").trim()})).filter(y=>y.imageURL!=="");r.leftAds=h}const d=await fetch("/api/settings",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({frontendSettings:r})});if(!d.ok){const h=await d.json();throw new Error(h.msg||"请求失败")}const i=await d.json();if(i.code===1){if(ve[l]=!1,await qe(),l==="leftAds"||l==="leftAdEnabled")w().add({title:"成功",description:"广告模块更新成功",color:"green"});else if(l==="announcementEnabled"){const h=!!r.announcementEnabled;w().add({title:"成功",description:h?"已开启公告":"已关闭公告",color:h?"green":"gray"})}else{const h=l==="defaultContentTheme"?"默认主题色":el[l]||(l==="pwa"?"PWA 设置":l);w().add({title:"成功",description:`${h}已更新`,color:"green"})}if(l==="defaultContentTheme"){const h=(r.defaultContentTheme||"dark").trim()}}else throw new Error(i.msg||"保存失败")}catch(e){console.error("保存配置失败:",e);const d=l==="defaultContentTheme"?"默认主题色":el[l]||l;w().add({title:"失败",description:`${d}保存失败`,color:"red"})}},ys=async()=>{try{const e=await fetch("/api/settings",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({frontendSettings:r})}),d=await e.json();if(e.ok&&d.code===1){if(await qe(),w().add({title:"成功",description:"PWA 设置已更新",color:"green"}),"serviceWorker"in navigator){const i=await navigator.serviceWorker.getRegistrations();if(r.pwaEnabled)await navigator.serviceWorker.register("/sw.js");else{for(const y of i)await y.unregister();const h=await caches.keys();await Promise.all(h.map(y=>caches.delete(y)))}}window.dispatchEvent(new Event("frontend-config-updated"))}else throw new Error(d.msg||"保存失败")}catch(l){w().add({title:"错误",description:l.message||"保存失败",color:"red"})}},xs=async()=>{var l,e;try{const i=await(await fetch("/api/status",{credentials:"include"})).json().catch(()=>({})),h=((l=i==null?void 0:i.data)==null?void 0:l.users)||((e=i==null?void 0:i.data)==null?void 0:e.Users)||[],y=Array.isArray(h)?h.find(Z=>!!((Z==null?void 0:Z.is_admin)??(Z==null?void 0:Z.IsAdmin))):null,C=Vt().public.baseApi||"/api";if(y){const Z=String((y==null?void 0:y.username)||(y==null?void 0:y.Username)||"").trim(),te=String((y==null?void 0:y.avatar_url)||(y==null?void 0:y.AvatarURL)||"").trim(),ge=String((y==null?void 0:y.description)||"").trim();r.welcomeName=Z||r.welcomeName||"",r.welcomeAvatarURL=te?te.startsWith("http")?te:`${C}${te}`:r.welcomeAvatarURL||"",r.welcomeDescription=ge||r.welcomeDescription||"",r.welcomeUseAdmin=!0,w().add({title:"已填充管理员信息",color:"green"})}else w().add({title:"未找到管理员",color:"orange"})}catch(d){w().add({title:"失败",description:(d==null?void 0:d.message)||"获取失败",color:"red"})}},hs=()=>{r.welcomeName="",r.welcomeAvatarURL="",r.welcomeDescription="",r.welcomeUseAdmin=!1,w().add({title:"已重置欢迎组件",color:"gray"})},ks=async l=>{const e=l.target.files;if(!(!e||!e[0]))try{const d=e[0],i=new FormData;i.append("image",d);const h=await fetch("/api/images/upload",{method:"POST",credentials:"include",body:i}),y=await h.json().catch(()=>({}));if(!h.ok||y.code!==1||!y.data)throw new Error((y==null?void 0:y.msg)||"上传失败");const C=String(y.data||"").startsWith("http")?y.data:`/api${y.data}`;r.avatarURL=C,await de("avatarURL"),w().add({title:"成功",description:"站点头像已更新",color:"green"})}catch(d){w().add({title:"失败",description:(d==null?void 0:d.message)||"上传失败",color:"red"})}finally{Lt.value&&(Lt.value.value="")}},kl=async()=>{try{const l={frontendSettings:{commentEnabled:!!r.commentEnabled,commentSystem:"builtin",commentEmailEnabled:!!r.commentEmailEnabled,commentLoginRequired:!!r.commentLoginRequired}},e=await fetch("/api/settings",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(l)}),d=await e.json();if(e.ok&&d.code===1)await qe(),window.dispatchEvent(new Event("frontend-config-updated")),w().add({title:"成功",description:"评论设置已更新",color:"green"});else throw new Error(d.msg||"保存失败")}catch(l){w().add({title:"错误",description:l.message||"保存失败",color:"red"})}},Cl=V(!1);Ae(()=>r.commentLoginRequired,async()=>{if(!Cl.value||ul.value){Cl.value=!0;return}try{await kl()}catch{}});const Cs=()=>{r.socialLinks.push({name:"",url:"",icon:""})},Vs=l=>{r.socialLinks.splice(l,1)},Us=async()=>{try{await de("socialLinks"),window.dispatchEvent(new Event("frontend-config-updated")),w().add({title:"成功",description:"社交链接已更新",color:"green"})}catch(l){w().add({title:"错误",description:(l==null?void 0:l.message)||"保存失败",color:"red"})}},Ht=V(""),De=V(!1),it=V([]),dt=V(1),_t=V(!1),ht=V({}),tl=V("builtin"),Es=l=>{try{const e=new Date(l);if(isNaN(e.getTime()))return String(l);const d=i=>i.toString().padStart(2,"0");return`${e.getFullYear()}-${d(e.getMonth()+1)}-${d(e.getDate())} ${d(e.getHours())}:${d(e.getMinutes())}`}catch{return String(l)}},Ts=()=>{De.value=!De.value,De.value&&Vl()},ll=l=>!!ht.value[l.id],Ls=l=>{ht.value[l.id]=!ht.value[l.id]},Vl=async()=>{var l,e;try{De.value=!0,it.value.splice(0),dt.value=1;const d=(Ht.value||"").trim(),i=await mt("comments",{q:d,page:dt.value,pageSize:5},{credentials:"include"});if(i&&i.code===1){const h=Array.isArray((l=i.data)==null?void 0:l.items)?i.data.items:[];h.forEach(C=>{it.value.push(C),ht.value[C.id]=!0});const y=Number(((e=i.data)==null?void 0:e.total)||0);_t.value=dt.value*5<y,h.length===0?w().add({title:"无结果",description:"未找到匹配评论",color:"gray"}):w().add({title:"已加载",description:`本页 ${h.length} 条${_t.value?"，还有更多":""}`,color:"green"})}else throw new Error((i==null?void 0:i.msg)||"加载失败")}catch(d){w().add({title:"加载失败",description:d.message,color:"red"})}},Ss=async()=>{var l,e;try{dt.value+=1;const d=(Ht.value||"").trim(),i=await mt("comments",{q:d,page:dt.value,pageSize:5},{credentials:"include"});if(i&&i.code===1){(Array.isArray((l=i.data)==null?void 0:l.items)?i.data.items:[]).forEach(C=>it.value.push(C));const y=Number(((e=i.data)==null?void 0:e.total)||0);_t.value=dt.value*5<y}else throw new Error((i==null?void 0:i.msg)||"加载失败")}catch(d){w().add({title:"加载失败",description:d.message,color:"red"})}},As=async l=>{try{const e=await Hl(`messages/${l.message_id}/comments/${l.id}`,void 0,{credentials:"include"});if(e&&e.code===1){const d=it.value.findIndex(i=>i.id===l.id);d>=0&&it.value.splice(d,1),delete ht.value[l.id],w().add({title:"成功",description:"已删除该评论",color:"green"})}else throw new Error((e==null?void 0:e.msg)||"删除失败")}catch(e){w().add({title:"删除失败",description:e.message,color:"red"})}},Mt=V(!1),rt=V(!1),Ke=V(null),Bs=I(()=>{var e;const l=String(((e=Ke.value)==null?void 0:e.content)||"").trim();return l.length>120?l.slice(0,120)+"...":l}),$s=l=>{confirm("确认删除该评论吗？此操作不可恢复。")&&(Ke.value=l,rt.value=!1,Mt.value=!0)},sl=()=>{rt.value=!1,Mt.value=!1,Ke.value=null},Rs=async()=>{if(!rt.value||!Ke.value){w().add({title:"请先勾选确认",color:"orange"});return}await As(Ke.value),sl()};Ae(()=>String(r.commentSystem||"").toLowerCase(),l=>{tl.value=l,l!=="builtin"&&(De.value=!1)}),Ae(()=>!!r.commentEnabled,l=>{l||(De.value=!1)});const js=async()=>{try{const l={frontendSettings:{enableGithubCard:!!Fe.value}},e=await fetch("/api/settings",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(l)}),d=await e.json();if(e.ok&&d.code===1)r.enableGithubCard=!!Fe.value,await qe(),window.dispatchEvent(new Event("frontend-config-updated")),w().add({title:"成功",description:"GitHub 解析设置已保存",color:"green"});else throw new Error(d.msg||"保存失败")}catch(l){w().add({title:"错误",description:l.message||"保存失败",color:"red"})}},Ul=async()=>{try{const l={frontendSettings:{musicEnabled:!!r.musicEnabled,musicPlaylistId:String(r.musicPlaylistId||""),musicSongId:String(r.musicSongId||""),musicPosition:String(r.musicPosition||"bottom-left"),musicTheme:String(r.musicTheme||"auto"),musicLyric:!!r.musicLyric,musicAutoplay:!!r.musicAutoplay,musicDefaultMinimized:!!r.musicDefaultMinimized,musicEmbed:!!r.musicEmbed,musicCssCdnURL:String(r.musicCssCdnURL||""),musicJsCdnURL:String(r.musicJsCdnURL||"")}},e=await fetch("/api/settings",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(l)}),d=await e.json();if(e.ok&&d.code===1)await qe(),ol(),window.dispatchEvent(new Event("frontend-config-updated")),w().add({title:"成功",description:"音乐配置已更新",color:"green"});else throw new Error(d.msg||"保存失败")}catch(l){w().add({title:"错误",description:l.message||"保存失败",color:"red"})}},Ps=()=>{r.musicEnabled=oe.musicEnabled,r.musicPlaylistId=oe.musicPlaylistId,r.musicSongId=oe.musicSongId,r.musicPosition=oe.musicPosition,r.musicTheme=oe.musicTheme,r.musicLyric=oe.musicLyric,r.musicAutoplay=oe.musicAutoplay,r.musicDefaultMinimized=oe.musicDefaultMinimized,r.musicEmbed=oe.musicEmbed,r.musicCssCdnURL=oe.musicCssCdnURL,r.musicJsCdnURL=oe.musicJsCdnURL},Is=()=>{r.leftAdEnabled=!0;const l=oe,e=Array.isArray(l.leftAds)?l.leftAds:[];r.leftAds=e.map(d=>({imageURL:String((d==null?void 0:d.imageURL)||""),linkURL:String((d==null?void 0:d.linkURL)||""),description:String((d==null?void 0:d.description)||"")})),r.leftAdsIntervalMs=Number(l.leftAdsIntervalMs)},al=I({get:()=>r.musicEmbed?"embed":"float",set:l=>{r.musicEmbed=l==="embed"}}),He=V("hypcvgm"),ol=()=>{const l=String(r.musicCssCdnURL||"").trim(),e=String(r.musicJsCdnURL||"").trim(),d=[],i=[];l&&d.push({rel:"stylesheet",href:l}),e&&i.push({src:e,body:!0}),(d.length||i.length)&&_l({link:d,script:i})};Ae(He,l=>{l==="hypcvgm"?(r.musicCssCdnURL="https://api.hypcvgm.top/NeteaseMiniPlayer/netease-mini-player-v2.css",r.musicJsCdnURL="https://api.hypcvgm.top/NeteaseMiniPlayer/netease-mini-player-v2.js"):l==="jsdelivr"?(r.musicCssCdnURL="https://cdn.jsdelivr.net/gh/ImBHCN/NeteaseMiniPlayer@v2/netease-mini-player-v2.css",r.musicJsCdnURL="https://cdn.jsdelivr.net/gh/ImBHCN/NeteaseMiniPlayer@v2/netease-mini-player-v2.js"):l==="unpkg"&&(r.musicCssCdnURL="https://unpkg.com/netease-mini-player/dist/netease-mini-player-v2.css",r.musicJsCdnURL="https://unpkg.com/netease-mini-player/dist/netease-mini-player-v2.js"),ol()});const Ds=async()=>{try{await de("githubOAuthEnabled"),await de("githubClientId"),await de("githubClientSecret"),await de("githubCallbackURL"),w().add({title:"成功",description:"GitHub 登录配置已保存",color:"green"})}catch(l){w().add({title:"错误",description:(l==null?void 0:l.message)||"保存失败",color:"red"})}},nl=V(!1),zt=V(0),il=V(""),Hs=async l=>{const e=l.target.files;if(!e)return;const d=["image/jpeg","image/png","image/webp"];for(const i of Array.from(e))try{if(!d.includes(i.type))throw new Error("仅支持 JPG/PNG/WEBP 格式");nl.value=!0,zt.value=0,il.value=i.name;const h=new FormData;h.append("image",i);const y=new XMLHttpRequest,C=await new Promise((re,Ge)=>{y.upload.onprogress=Ce=>{Ce.lengthComputable&&(zt.value=Math.round(Ce.loaded/Ce.total*100))},y.onreadystatechange=()=>{if(y.readyState===4)if(y.status>=200&&y.status<300)try{re(JSON.parse(y.responseText))}catch{Ge(new Error("响应解析失败"))}else Ge(new Error("上传失败"))},y.open("POST","/api/images/upload",!0),y.withCredentials=!0,y.send(h)});if(!C||C.code!==1)throw new Error((C==null?void 0:C.msg)||"上传失败");const Z=String(C.data||""),te=Z.startsWith("http")?Z:`/api${Z}`,ge=[...r.backgrounds,te];r.backgrounds=ge,await de("backgrounds"),w().add({title:"上传成功",description:`${i.name} 已添加到背景图片列表`,color:"green"})}catch(h){w().add({title:"错误",description:(h==null?void 0:h.message)||"上传失败",color:"red"})}finally{nl.value=!1,zt.value=0,il.value=""}wt.value&&(wt.value.value="")};Ve(()=>{window.addEventListener("frontend-config-updated",l=>{const{key:e,value:d}=l.detail;e&&d!==void 0&&(r[e]=d);try{const i=document.documentElement,h=u.value!=="light",y=i.classList.contains("dark");h&&!y?i.classList.add("dark"):!h&&y&&i.classList.remove("dark")}catch{}})});const _s=()=>{qe(),yl.value=!1},Ms=async()=>{r.backgrounds.push("")},zs=async l=>{r.backgrounds.splice(l,1),await de("backgrounds")},Ns=()=>{var l;(l=wt.value)==null||l.click()},dl=V(!1),El=V(""),rl=l=>{l&&(El.value=l,dl.value=!0)},Os=l=>{if(l<=0)return;const e=[...r.backgrounds],[d]=e.splice(l,1);e.splice(l-1,0,d),r.backgrounds=e},Ws=l=>{const e=[...r.backgrounds];if(l>=e.length-1)return;const[d]=e.splice(l,1);e.splice(l+1,0,d),r.backgrounds=e},Fs=l=>{var h;const e=(h=l.dataTransfer)==null?void 0:h.files;if(!e||e.length===0)return;const d=wt.value;if(!d)return;const i=new DataTransfer;Array.from(e).forEach(y=>i.items.add(y)),d.files=i.files,d.dispatchEvent(new Event("change"))};Ae(()=>k.isLogin,l=>{l||(k.getStatus(),k.getUser(),k.$reset())});const ul=V(!1);Ve(async()=>{var l;try{if(ul.value=!0,await Promise.all([k.getStatus(),k.getUser(),qe(),ne()]),k.isLogin){const d=await(await fetch("/api/user/token",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}})).json();d.code===1&&((l=d.data)!=null&&l.token)&&(O.value=d.data.token)}}catch(e){console.error("初始化失败:",e),w().add({title:"系统提示",description:"当前未登录",color:"red",timeout:3e3})}finally{ul.value=!1}});const kt=V(null),ut=V("sqlite"),qs=I(()=>({sqlite:"SQLite",postgres:"Postgres",mysql:"MySQL",other:"其它"})[ut.value]||ut.value),Ks=async()=>{try{const l=await fetch("/api/backup/download",{credentials:"include"});if(!l.ok)throw new Error("下载失败");const e=await l.blob(),d=window.URL.createObjectURL(e),i=document.createElement("a");i.href=d,i.download=`noise_backup_${new Date().toISOString().slice(0,10)}.zip`,document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(d),document.body.removeChild(i)}catch(l){w().add({title:"错误",description:l.message||"备份下载失败",color:"red"})}},Gs=()=>{var l;(l=kt.value)==null||l.click()},Js=J,Tl=async l=>{const e=l.target.files;if(!(!e||!e[0])){try{const d=new FormData;d.append("database",e[0]);const h=await(await fetch("/api/backup/restore",{method:"POST",credentials:"include",body:d})).json();if(h.code===1)w().add({title:"成功",description:"数据库恢复成功",color:"green"}),Js("restore-success"),setTimeout(()=>{window.location.reload()},1500);else throw new Error(h.msg)}catch(d){w().add({title:"错误",description:d.message||"数据库恢复失败",color:"red"})}kt.value&&(kt.value.value="")}},ee=V(!1),A=fe({provider:"",endpoint:"",region:"",bucket:"",accessKey:"",secretKey:"",usePathStyle:!0,publicBaseURL:""}),lt=V(!1),Ct=V("instant"),Nt=V(15),Ll=V(""),Ot=V(""),Wt=V(""),cl=async()=>{try{const e=await(await fetch("/api/frontend/config",{credentials:"include"})).json();if((e==null?void 0:e.code)===1){const d=(e.data.dbType||"sqlite").toLowerCase();ut.value=d==="sqlite"||d==="postgres"||d==="mysql"?d:"other",ee.value=!!e.data.storageEnabled;const i=e.data.storageConfig||{};A.provider=i.provider||"",A.endpoint=i.endpoint||"",A.region=i.region||"",A.bucket=i.bucket||"",A.accessKey=i.accessKey||"",A.secretKey=i.secretKey||"",A.usePathStyle=!!i.usePathStyle,A.publicBaseURL=i.publicBaseURL||"",lt.value=!!i.autoSyncEnabled,Ct.value=i.syncMode||"instant",Nt.value=Number(i.syncIntervalMinute||15),Ll.value=(i.lastSyncTime||"").replace("T"," ").replace("Z","")}}catch{}},Xs=async()=>{try{const l={storageEnabled:ee.value,storageConfig:{...A,autoSyncEnabled:lt.value,syncMode:Ct.value,syncIntervalMinute:Nt.value}},d=await(await fetch("/api/settings",{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})).json();if((d==null?void 0:d.code)===1)w().add({title:"已保存云存储配置",color:"green"});else throw new Error((d==null?void 0:d.msg)||"保存失败")}catch(l){w().add({title:"保存失败",description:l.message,color:"red"})}},Ys=async()=>{try{const e=await(await fetch("/api/backup/storage/sync-now",{method:"POST",credentials:"include"})).json();if((e==null?void 0:e.code)===1)w().add({title:"已同步到云端",color:"green"}),await cl();else throw new Error((e==null?void 0:e.msg)||"同步失败")}catch(l){w().add({title:"同步失败",description:l.message,color:"red"})}};Ae(()=>A.provider,l=>{l==="r2"?(A.usePathStyle=!0,A.region||(A.region="auto")):l==="s3"&&A.usePathStyle===void 0&&(A.usePathStyle=!1)});const Zs=async()=>{try{const l=Ot.value.trim();if(!l)throw new Error("请填写预签名上传URL");const e=await he("backup/storage/upload",{uploadURL:l},{credentials:"include"});if((e==null?void 0:e.code)===1)w().add({title:"云备份上传成功",color:"green"});else throw new Error((e==null?void 0:e.msg)||"上传失败")}catch(l){w().add({title:"上传失败",description:l.message,color:"red"})}},Qs=async()=>{try{const l=Wt.value.trim();if(!l)throw new Error("请填写预签名下载URL");const e=await he("backup/storage/restore",{downloadURL:l},{credentials:"include"});if((e==null?void 0:e.code)===1)w().add({title:"云备份恢复成功",color:"green"});else throw new Error((e==null?void 0:e.msg)||"恢复失败")}catch(l){w().add({title:"恢复失败",description:l.message,color:"red"})}},ea=async()=>{var l;try{const e=await he("backup/storage/presign/upload",{objectKey:"backup.zip",contentType:"application/zip",expiresSeconds:3600},{credentials:"include"});if((e==null?void 0:e.code)===1&&((l=e==null?void 0:e.data)!=null&&l.url))Ot.value=e.data.url,w().add({title:"生成上传预签名成功",color:"green"});else throw new Error((e==null?void 0:e.msg)||"生成失败")}catch(e){w().add({title:"生成失败",description:e.message,color:"red"})}},ta=async()=>{var l;try{const e=await he("backup/storage/presign/download",{objectKey:"backup.zip",expiresSeconds:3600},{credentials:"include"});if((e==null?void 0:e.code)===1&&((l=e==null?void 0:e.data)!=null&&l.url))Wt.value=e.data.url,w().add({title:"生成下载预签名成功",color:"green"});else throw new Error((e==null?void 0:e.msg)||"生成失败")}catch(e){w().add({title:"生成失败",description:e.message,color:"red"})}},la=async()=>{try{const l=(A.publicBaseURL||"").trim();if(!l)throw new Error("请先在配置中填写公共访问前缀");const e=(l.endsWith("/")?l:l+"/")+"backup.zip",d=await he("backup/storage/restore",{downloadURL:e},{credentials:"include"});if((d==null?void 0:d.code)===1)w().add({title:"云备份恢复成功",color:"green"});else throw new Error((d==null?void 0:d.msg)||"恢复失败")}catch(l){w().add({title:"恢复失败",description:l.message,color:"red"})}};return V(null),(l,e)=>{var Ft,ct,Sl,Al,Bl,$l,Rl,jl,Pl;const d=Jt,i=gl,h=La,y=ba,C=fl,Z=bl,te=xa,ge=Jl,re=Xl,Ge=wa,Ce=Kl,ye=ql("USwitch"),K=ha,Q=fa;return f(),b("div",{class:n(["fixed inset-0 w-full h-full overflow-x-hidden overflow-y-auto",o.value.pageBg])},[t("div",zo,[t("aside",{class:n(["w-72 h-screen overflow-y-auto backdrop-blur-md flex flex-col fixed left-0 top-0 z-40 transition-transform duration-300 md:transition-none border-r",[{"translate-x-0":U.value,"-translate-x-full md:translate-x-0":!U.value},o.value.sidebarBg,o.value.border,o.value.sidebarText]])},[t("div",No,[t("img",{src:z.value,class:"w-14 h-14 rounded-full ring-2 ring-indigo-400/60 shadow-lg object-cover",alt:"avatar"},null,8,Oo),t("div",Wo,[t("div",Fo,x(((Ft=Re(k).user)==null?void 0:Ft.username)||"未登录"),1),t("div",{class:n(["text-xs",o.value.mutedText])},"总笔记 "+x(((Sl=(ct=Re(k))==null?void 0:ct.status)==null?void 0:Sl.total_messages)||0),3)])]),t("nav",qo,[t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[o.value.navBtnBg,o.value.navBtnHoverBg]]),onClick:e[0]||(e[0]=a=>j("system"))},[s(d,{name:"i-heroicons-cpu-chip",class:"w-5 h-5 text-indigo-300"}),e[198]||(e[198]=t("span",{class:"text-sm text-center"},"系统信息",-1))],2),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[o.value.navBtnBg,o.value.navBtnHoverBg]]),onClick:e[1]||(e[1]=a=>j("user"))},[s(d,{name:"i-heroicons-user-circle",class:"w-5 h-5 text-indigo-300"}),e[199]||(e[199]=t("span",{class:"text-sm text-center"},"用户信息",-1))],2),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[o.value.navBtnBg,o.value.navBtnHoverBg]]),onClick:e[2]||(e[2]=a=>j("site"))},[s(d,{name:"i-heroicons-wrench-screwdriver",class:"w-5 h-5 text-indigo-300"}),e[200]||(e[200]=t("span",{class:"text-sm text-center"},"网站配置",-1))],2),Le.value?(f(),b("div",Ko,[t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[o.value.navBtnBg,o.value.navBtnHoverBg]]),onClick:e[3]||(e[3]=a=>j("site-register"))},[s(d,{name:"i-heroicons-user-plus",class:"w-5 h-5 text-indigo-300"}),e[201]||(e[201]=t("span",{class:"text-sm text-center"},"注册开关",-1))],2),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[o.value.navBtnBg,o.value.navBtnHoverBg]]),onClick:e[4]||(e[4]=a=>j("site-pwa"))},[s(d,{name:"i-heroicons-rocket-launch",class:"w-5 h-5 text-indigo-300"}),e[202]||(e[202]=t("span",{class:"text-sm text-center"},"PWA 模式",-1))],2),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[o.value.navBtnBg,o.value.navBtnHoverBg]]),onClick:e[5]||(e[5]=a=>j("site-github-card"))},[s(d,{name:"i-mdi-github",class:"w-5 h-5 text-indigo-300"}),e[203]||(e[203]=t("span",{class:"text-sm text-center"},"GitHub 卡片",-1))],2),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[o.value.navBtnBg,o.value.navBtnHoverBg]]),onClick:e[6]||(e[6]=a=>j("site-github-login"))},[s(d,{name:"i-mdi-github",class:"w-5 h-5 text-indigo-300"}),e[204]||(e[204]=t("span",{class:"text-sm text-center"},"GitHub 登录",-1))],2),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[o.value.navBtnBg,o.value.navBtnHoverBg]]),onClick:e[7]||(e[7]=a=>j("site-announcement"))},[s(d,{name:"i-heroicons-megaphone",class:"w-5 h-5 text-indigo-300"}),e[205]||(e[205]=t("span",{class:"text-sm text-center"},"公告栏",-1))],2),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[o.value.navBtnBg,o.value.navBtnHoverBg]]),onClick:e[8]||(e[8]=a=>j("site-music"))},[s(d,{name:"i-heroicons-musical-note",class:"w-5 h-5 text-indigo-300"}),e[206]||(e[206]=t("span",{class:"text-sm text-center"},"音乐配置",-1))],2),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[o.value.navBtnBg,o.value.navBtnHoverBg]]),onClick:e[9]||(e[9]=a=>j("site-default-theme"))},[s(d,{name:"i-heroicons-swatch",class:"w-5 h-5 text-indigo-300"}),e[207]||(e[207]=t("span",{class:"text-sm text-center"},"默认主题",-1))],2),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[o.value.navBtnBg,o.value.navBtnHoverBg]]),onClick:e[10]||(e[10]=a=>j("site-configs"))},[s(d,{name:"i-heroicons-cog-6-tooth",class:"w-5 h-5 text-indigo-300"}),e[208]||(e[208]=t("span",{class:"text-sm text-center"},"站点信息",-1))],2),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[o.value.navBtnBg,o.value.navBtnHoverBg]]),onClick:e[11]||(e[11]=a=>j("comments"))},[s(d,{name:"i-heroicons-chat-bubble-left-right",class:"w-5 h-5 text-indigo-300"}),e[209]||(e[209]=t("span",{class:"text-sm text-center"},"评论系统",-1))],2),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[o.value.navBtnBg,o.value.navBtnHoverBg]]),onClick:e[12]||(e[12]=a=>j("email"))},[s(d,{name:"i-heroicons-envelope",class:"w-5 h-5 text-indigo-300"}),e[210]||(e[210]=t("span",{class:"text-sm text-center"},"邮件设置",-1))],2),t("button",{class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[o.value.navBtnBg,o.value.navBtnHoverBg]]),onClick:e[13]||(e[13]=a=>j("admin-users"))},[s(d,{name:"i-heroicons-shield-check",class:"w-5 h-5 text-indigo-300"}),e[211]||(e[211]=t("span",{class:"text-sm text-center"},"管理员用户",-1))],2)])):$("",!0),Le.value?(f(),b("button",{key:1,class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[o.value.navBtnBg,o.value.navBtnHoverBg]]),onClick:e[14]||(e[14]=a=>j("notify"))},[s(d,{name:"i-heroicons-bell-alert",class:"w-5 h-5 text-indigo-300"}),e[212]||(e[212]=t("span",{class:"text-sm text-center"},"推送配置",-1))],2)):$("",!0),Le.value?(f(),b("button",{key:2,class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[o.value.navBtnBg,o.value.navBtnHoverBg]]),onClick:e[15]||(e[15]=a=>j("attachments"))},[s(d,{name:"i-heroicons-paper-clip",class:"w-5 h-5 text-indigo-300"}),e[213]||(e[213]=t("span",{class:"text-sm text-center"},"附件管理",-1))],2)):$("",!0),Le.value?(f(),b("button",{key:3,class:n(["w-full flex justify-center items-center gap-2 px-3 py-2 rounded-lg transition shadow",[o.value.navBtnBg,o.value.navBtnHoverBg]]),onClick:e[16]||(e[16]=a=>j("db"))},[s(d,{name:"i-heroicons-circle-stack",class:"w-5 h-5 text-indigo-300"}),e[214]||(e[214]=t("span",{class:"text-sm text-center"},"数据库管理",-1))],2)):$("",!0)]),t("div",Go,[t("div",Jo,"当前版本: "+x(Y.currentVersion||"最新"),1),t("div",Xo,[s(i,{size:"xs",color:"gray",variant:"soft",loading:Y.checking,class:"shadow-md",onClick:Yl},{default:m(()=>[v(x(Y.checking?"检测中...":"检查版本发布时间"),1)]),_:1},8,["loading"])]),Y.hasUpdate?(f(),b("div",Yo,[s(d,{name:"i-heroicons-arrow-up-circle",class:"w-4 h-4"}),t("span",null,"最近更新于 "+x(Y.latestVersion),1)])):$("",!0)])],2),t("main",{class:n(["w-full min-h-screen md:pl-72 overflow-y-auto",o.value.text])},[t("div",{class:n(["md:hidden flex items-center justify-between px-4 py-3 border-b rounded-b-2xl",[o.value.headerBg,o.value.border,o.value.text]])},[t("div",Zo,[t("button",{class:"p-2 rounded-lg bg-slate-800/70 shadow",onClick:e[17]||(e[17]=a=>U.value=!U.value)},[s(d,{name:"i-heroicons-bars-3",class:"w-5 h-5"})]),e[215]||(e[215]=t("span",{class:"font-semibold"},"系统管理面板",-1))]),t("div",Qo,[s(i,{variant:"soft",color:u.value==="light"?"gray":"white",class:"shadow",onClick:e[18]||(e[18]=a=>l.$router.push("/"))},{default:m(()=>e[216]||(e[216]=[v("返回首页")])),_:1},8,["color"]),Et.value?(f(),ml(i,{key:0,icon:"i-heroicons-power",color:"red",variant:"solid",onClick:wl},{default:m(()=>e[217]||(e[217]=[v("退出登录")])),_:1})):$("",!0)])],2),U.value?(f(),b("div",{key:0,class:"fixed inset-0 bg-black/40 md:hidden",onClick:e[19]||(e[19]=a=>U.value=!1)})):$("",!0),t("div",en,[t("div",tn,[t("h1",{class:n(["text-2xl md:text-3xl font-bold text-center",o.value.text])},"系统管理面板",2)]),t("div",ln,[t("div",{class:n([o.value.cardBg,o.value.border,Me])},[t("div",sn,[t("div",an,[t("span",{class:n(o.value.text)},"配色",2),t("div",on,[t("div",nn,[s(h,{modelValue:u.value,"onUpdate:modelValue":e[20]||(e[20]=a=>u.value=a),value:"dark",class:"mr-2"},null,8,["modelValue"]),t("span",{class:n(u.value==="dark"?o.value.text:"text-slate-400")},"暗黑",2)]),t("div",dn,[s(h,{modelValue:u.value,"onUpdate:modelValue":e[21]||(e[21]=a=>u.value=a),value:"midnight",class:"mr-2"},null,8,["modelValue"]),t("span",{class:n(u.value==="midnight"?o.value.text:"text-slate-400")},"深蓝",2)]),t("div",rn,[s(h,{modelValue:u.value,"onUpdate:modelValue":e[22]||(e[22]=a=>u.value=a),value:"slate",class:"mr-2"},null,8,["modelValue"]),t("span",{class:n(u.value==="slate"?o.value.text:"text-slate-400")},"石板",2)]),t("div",un,[s(h,{modelValue:u.value,"onUpdate:modelValue":e[23]||(e[23]=a=>u.value=a),value:"light",class:"mr-2"},null,8,["modelValue"]),t("span",{class:n(u.value==="light"?o.value.text:"text-slate-400")},"明亮",2)])])]),t("div",cn,[s(i,{size:"sm",color:"green",class:"shadow",onClick:W},{default:m(()=>e[218]||(e[218]=[v("保存")])),_:1})])])],2)]),$("",!0),$("",!0),t("div",mn,[t("div",{class:n(["rounded-xl border shadow-xl",[o.value.cardBg,o.value.border]])},[t("div",pn,[t("div",null,[t("span",{class:n(o.value.text)},"系统管理员",2),t("span",vn,x((Bl=(Al=Re(k))==null?void 0:Al.status)==null?void 0:Bl.username),1)]),t("div",null,[t("span",{class:n(o.value.text)},"当前用户",2),t("span",gn,x(Et.value&&(($l=Re(k).user)==null?void 0:$l.username)||"未登录"),1)]),t("div",null,[t("span",{class:n(o.value.text)},"笔记总数",2),t("span",fn,x((jl=(Rl=Re(k))==null?void 0:Rl.status)==null?void 0:jl.total_messages)+" 条",1)])])],2)]),Et.value?(f(),b("div",bn,[t("div",{class:n(["rounded-xl border shadow-xl",[o.value.cardBg,o.value.border]])},[t("div",{class:n(["flex items-center justify-between px-4 py-3",o.value.text])},e[228]||(e[228]=[t("div",{class:"font-semibold"},"用户信息配置",-1)]),2),t("div",wn,[t("div",{class:n(["rounded-lg p-3 h-full",o.value.subtleBg])},[t("div",yn,[t("span",{class:n(o.value.mutedText)},"用户名",2),s(i,{size:"sm",onClick:e[31]||(e[31]=a=>G.username=!G.username),color:G.username?"gray":"green",variant:G.username?"soft":"solid",class:"shadow"},{default:m(()=>[v(x(G.username?"取消":"编辑"),1)]),_:1},8,["color","variant"])]),G.username?(f(),b("div",xn,[s(C,{modelValue:L.username,"onUpdate:modelValue":e[32]||(e[32]=a=>L.username=a),placeholder:"新用户名",class:"w-full mb-2"},null,8,["modelValue"]),t("div",hn,[s(i,{onClick:ss,color:"primary",class:"shadow"},{default:m(()=>e[229]||(e[229]=[v("保存")])),_:1})])])):(f(),b("div",kn,[s(te,{color:"primary",variant:"soft",class:"ml-0 text-xs px-2 py-1 rounded-md !text-slate-800 dark:!text-slate-200"},{default:m(()=>{var a;return[v(x((a=Re(k).user)==null?void 0:a.username),1)]}),_:1})])),t("div",Cn,[t("div",Vn,[t("span",{class:n(o.value.mutedText)},"头像",2),t("div",Un,[s(i,{size:"sm",onClick:cs,color:"gray",variant:"soft",class:"shadow"},{default:m(()=>e[230]||(e[230]=[v("上传头像")])),_:1}),s(i,{size:"sm",loading:Se.value,onClick:bs,color:"orange",variant:"soft",class:"shadow"},{default:m(()=>e[231]||(e[231]=[v("使用首字母头像")])),_:1},8,["loading"])])]),t("div",En,[t("img",{src:z.value,class:"w-10 h-10 rounded-full object-cover",alt:"avatar"},null,8,Tn)]),t("p",{class:n(["text-xs mt-1",o.value.mutedText])},"选择图片后自动进入裁剪，裁剪完成即可保存并预览",2),t("input",{ref_key:"avatarInput",ref:bt,type:"file",accept:"image/*",class:"hidden",onChange:ms},null,544),t("div",Ln,[s(C,{modelValue:St.value,"onUpdate:modelValue":e[33]||(e[33]=a=>St.value=a),placeholder:"头像链接（http或/api开头）",class:"flex-1"},null,8,["modelValue"]),s(i,{size:"sm",loading:Se.value,onClick:vs,color:"primary",variant:"solid",class:"shadow"},{default:m(()=>e[232]||(e[232]=[v("保存链接")])),_:1},8,["loading"])]),s(ge,{modelValue:yt.value,"onUpdate:modelValue":e[35]||(e[35]=a=>yt.value=a)},{default:m(()=>[t("div",Sn,[t("div",{class:n([o.value.mutedText,"mb-2"])},"裁剪头像（拖动图片调整位置，滑块调整缩放）",2),t("div",An,[Ie.value?(f(),b("img",{key:0,src:Ie.value,alt:"to-crop",style:ra({position:"absolute",left:"50%",top:"50%",transform:`translate(-50%, -50%) translate(${At.value}px, ${Bt.value}px) scale(${xt.value})`,userSelect:"none"}),onMousedown:hl,onTouchstart:hl},null,44,Bn)):$("",!0)]),t("div",$n,[t("span",{class:n(o.value.mutedText)},"缩放",2),qt(t("input",{type:"range",min:"0.5",max:"3",step:"0.01","onUpdate:modelValue":e[34]||(e[34]=a=>xt.value=a)},null,512),[[ua,xt.value,void 0,{number:!0}]]),s(i,{loading:Se.value,color:"green",onClick:gs},{default:m(()=>e[233]||(e[233]=[v("裁剪并保存")])),_:1},8,["loading"]),s(i,{color:"gray",variant:"soft",onClick:fs},{default:m(()=>e[234]||(e[234]=[v("取消")])),_:1})])])]),_:1},8,["modelValue"]),t("div",Rn,[t("div",jn,[t("span",{class:n(o.value.mutedText)},"个性签名",2),s(i,{size:"sm",onClick:e[36]||(e[36]=a=>G.description=!G.description),color:G.description?"gray":"green",variant:G.description?"soft":"solid",class:"shadow"},{default:m(()=>[v(x(G.description?"取消":"编辑"),1)]),_:1},8,["color","variant"])]),G.description?(f(),b("div",Pn,[s(Z,{modelValue:L.description,"onUpdate:modelValue":e[37]||(e[37]=a=>L.description=a),placeholder:"一句话介绍自己",class:"w-full mb-2"},null,8,["modelValue"]),t("div",In,[s(i,{onClick:as,color:"primary",class:"shadow"},{default:m(()=>e[235]||(e[235]=[v("保存")])),_:1})])])):(f(),b("div",Dn,[t("div",{class:n([o.value.subtleBg,o.value.border,"rounded-md p-3 border"])},[t("p",{class:n([o.value.text,"break-words"])},x(((Pl=Re(k).user)==null?void 0:Pl.description)||"执迷不悟"),3)],2)]))])])],2),t("div",{class:n(["rounded-lg p-3 md:col-span-2",o.value.subtleBg])},[t("div",Hn,[t("div",_n,[t("span",{class:n(o.value.mutedText)},"API Token",2),s(te,{color:"primary",variant:"subtle",class:"text-xs px-2 py-1 rounded-md !text-primary-600 dark:!text-primary-300"},{default:m(()=>[v(x(O.value?"已生成":"未生成"),1)]),_:1}),s(i,{size:"xs",loading:Qt.value,onClick:Zl,color:"gray",variant:"soft",class:"shadow text-xs px-2 py-1 rounded-md text-slate-600 dark:text-slate-200",title:"重新生成将使旧 Token 失效"},{default:m(()=>e[236]||(e[236]=[v("重新生成")])),_:1},8,["loading"])])]),O.value?(f(),b("div",Mn,[t("div",zn,[s(C,{modelValue:O.value,"onUpdate:modelValue":e[38]||(e[38]=a=>O.value=a),type:ot.value?"text":"password",readonly:"",class:"font-mono text-sm flex-1 min-w-0"},null,8,["modelValue","type"]),s(i,{icon:ot.value?"i-heroicons-eye-slash":"i-heroicons-eye",color:"gray",variant:"ghost",onClick:e[39]||(e[39]=a=>ot.value=!ot.value),title:ot.value?"隐藏":"显示"},null,8,["icon","title"]),s(i,{icon:"i-heroicons-clipboard",color:"gray",variant:"ghost",onClick:Ql,title:"复制 Token"})]),t("p",{class:n(["text-xs mt-1",o.value.mutedText])},"请妥善保管此 Token",2)])):(f(),b("div",Nn,[t("p",{class:n(o.value.mutedText)},"暂无 Token",2)])),t("div",{class:n(["border-t mt-4 pt-3",o.value.border])},[t("div",On,[t("span",{class:n(o.value.mutedText)},"修改密码",2),s(i,{size:"sm",onClick:e[40]||(e[40]=a=>G.password=!G.password),color:G.password?"gray":"green",variant:G.password?"soft":"solid",class:"shadow"},{default:m(()=>[v(x(G.password?"取消":"编辑"),1)]),_:1},8,["color","variant"])]),G.password?(f(),b("div",Wn,[t("div",Fn,[s(C,{modelValue:L.oldPassword,"onUpdate:modelValue":e[41]||(e[41]=a=>L.oldPassword=a),type:Rt.value?"text":"password",placeholder:"当前密码",class:"flex-1"},null,8,["modelValue","type"]),s(i,{icon:Rt.value?"i-heroicons-eye-slash":"i-heroicons-eye",color:"gray",variant:"ghost",onClick:e[42]||(e[42]=a=>Rt.value=!Rt.value)},null,8,["icon"])]),t("div",qn,[s(C,{modelValue:L.newPassword,"onUpdate:modelValue":e[43]||(e[43]=a=>L.newPassword=a),type:jt.value?"text":"password",placeholder:"新密码",class:"flex-1"},null,8,["modelValue","type"]),s(te,{color:ts.value,variant:"soft"},{default:m(()=>[v(x(es.value),1)]),_:1},8,["color"]),s(i,{icon:jt.value?"i-heroicons-eye-slash":"i-heroicons-eye",color:"gray",variant:"ghost",onClick:e[44]||(e[44]=a=>jt.value=!jt.value)},null,8,["icon"])]),t("div",Kn,[s(C,{modelValue:L.confirmPassword,"onUpdate:modelValue":e[45]||(e[45]=a=>L.confirmPassword=a),type:Pt.value?"text":"password",placeholder:"确认新密码",class:"flex-1"},null,8,["modelValue","type"]),s(i,{icon:Pt.value?"i-heroicons-eye-slash":"i-heroicons-eye",color:"gray",variant:"ghost",onClick:e[46]||(e[46]=a=>Pt.value=!Pt.value)},null,8,["icon"])]),t("div",Gn,[s(i,{onClick:os,disabled:!ls.value,color:"primary",class:"shadow"},{default:m(()=>e[237]||(e[237]=[v("保存")])),_:1},8,["disabled"])])])):$("",!0)],2),t("div",{class:n(["border-t mt-4 pt-3",o.value.border])},[t("div",Jn,[t("span",{class:n(o.value.mutedText)},"绑定邮箱",2),s(i,{size:"sm",onClick:e[47]||(e[47]=a=>G.emailBind=!G.emailBind),color:G.emailBind?"gray":"green",variant:G.emailBind?"soft":"solid",class:"shadow"},{default:m(()=>[v(x(G.emailBind?"取消":"编辑"),1)]),_:1},8,["color","variant"])]),G.emailBind?(f(),b("div",Xn,[t("div",Yn,[s(C,{modelValue:L.email,"onUpdate:modelValue":e[48]||(e[48]=a=>L.email=a),type:"email",placeholder:"输入邮箱",class:"flex-1"},null,8,["modelValue"]),s(i,{color:"gray",variant:"soft",onClick:ns},{default:m(()=>e[238]||(e[238]=[v("发送验证码")])),_:1})]),t("div",Zn,[s(C,{modelValue:L.emailCode,"onUpdate:modelValue":e[49]||(e[49]=a=>L.emailCode=a),placeholder:"验证码",class:"flex-1"},null,8,["modelValue"]),s(i,{color:"primary",class:"shadow",onClick:is},{default:m(()=>e[239]||(e[239]=[v("绑定")])),_:1})])])):$("",!0)],2),t("div",{class:n(["border-t mt-4 pt-3",o.value.border])},[t("div",Qn,[t("span",{class:n(o.value.mutedText)},"更换邮箱",2),s(i,{size:"sm",onClick:e[50]||(e[50]=a=>G.emailChange=!G.emailChange),color:G.emailChange?"gray":"green",variant:G.emailChange?"soft":"solid",class:"shadow"},{default:m(()=>[v(x(G.emailChange?"取消":"编辑"),1)]),_:1},8,["color","variant"])]),G.emailChange?(f(),b("div",ei,[t("div",ti,[s(i,{color:"gray",variant:"soft",onClick:ds},{default:m(()=>e[240]||(e[240]=[v("向当前邮箱发送验证码")])),_:1}),s(C,{modelValue:L.changeCode,"onUpdate:modelValue":e[51]||(e[51]=a=>L.changeCode=a),placeholder:"收到的验证码",class:"flex-1"},null,8,["modelValue"])]),t("div",li,[s(C,{modelValue:L.newEmail,"onUpdate:modelValue":e[52]||(e[52]=a=>L.newEmail=a),type:"email",placeholder:"新的邮箱",class:"flex-1"},null,8,["modelValue"]),s(i,{color:"primary",class:"shadow",onClick:rs},{default:m(()=>e[241]||(e[241]=[v("更换")])),_:1})]),Zt.value?(f(),b("div",si,[s(C,{modelValue:L.emailCode,"onUpdate:modelValue":e[53]||(e[53]=a=>L.emailCode=a),placeholder:"新邮箱验证码",class:"flex-1"},null,8,["modelValue"]),s(i,{color:"primary",class:"shadow",onClick:us},{default:m(()=>e[242]||(e[242]=[v("确认更换")])),_:1})])):$("",!0)])):$("",!0)],2)],2)])],2)])):$("",!0),t("div",ai,[t("div",{class:n(["rounded-xl border shadow-xl",[o.value.cardBg,o.value.border]])},[t("div",oi,[t("div",{class:n(["font-semibold flex items-center gap-2",o.value.text])},[s(d,{name:"i-heroicons-cog-6-tooth",class:"w-5 h-5"}),e[243]||(e[243]=t("span",null,"网站配置",-1))],2)]),t("div",ni,[t("div",{class:n(["rounded-lg p-3",o.value.subtleBg])},[t("div",ii,[t("div",{class:n(["flex items-center gap-2",o.value.text])},[s(d,{name:"i-heroicons-hand-thumb-up",class:"w-4 h-4"}),e[244]||(e[244]=t("span",null,"系统欢迎组件",-1))],2),t("div",di,[s(i,{size:"sm",color:"gray",variant:"soft",onClick:xs},{default:m(()=>e[245]||(e[245]=[v("使用管理员头像信息")])),_:1}),s(i,{size:"sm",color:"gray",variant:"soft",onClick:hs},{default:m(()=>e[246]||(e[246]=[v("重置")])),_:1}),s(i,{size:"sm",color:"primary",class:"shadow",onClick:e[54]||(e[54]=a=>de("welcome"))},{default:m(()=>e[247]||(e[247]=[v("保存")])),_:1})])]),t("div",ri,[t("div",null,[t("label",{class:n([o.value.mutedText,"text-sm mb-1 block"])},"显示名称",2),s(C,{modelValue:r.welcomeName,"onUpdate:modelValue":e[55]||(e[55]=a=>r.welcomeName=a),placeholder:"如 Noise 或站点名"},null,8,["modelValue"])]),t("div",null,[t("label",{class:n([o.value.mutedText,"text-sm mb-1 block"])},"头像URL",2),s(C,{modelValue:r.welcomeAvatarURL,"onUpdate:modelValue":e[56]||(e[56]=a=>r.welcomeAvatarURL=a),placeholder:"http/https 或以 /api 开头的站内路径"},null,8,["modelValue"])]),t("div",ui,[t("label",{class:n([o.value.mutedText,"text-sm mb-1 block"])},"简介文案",2),s(Z,{modelValue:r.welcomeDescription,"onUpdate:modelValue":e[57]||(e[57]=a=>r.welcomeDescription=a),placeholder:"一句话欢迎语或个人签名"},null,8,["modelValue"])])]),t("div",{class:n(["text-xs mt-2",o.value.mutedText])},"未登录时展示该组件；登录后显示当前用户的头像与签名",2)],2),t("div",{id:"site-register-section",class:n(["flex items-center rounded-lg p-3 justify-between",o.value.subtleBg])},[t("div",{class:n(["flex items-center gap-2",o.value.text])},[s(d,{name:"i-heroicons-user-plus",class:"w-4 h-4"}),e[248]||(e[248]=v()),e[249]||(e[249]=t("span",null,"新用户注册",-1))],2),t("div",ci,[t("div",mi,[s(h,{modelValue:M.value,"onUpdate:modelValue":e[58]||(e[58]=a=>M.value=a),value:!0,class:"mr-2"},null,8,["modelValue"]),t("span",{class:n(M.value?o.value.text:"text-slate-400")},"允许",2)]),t("div",pi,[s(h,{modelValue:M.value,"onUpdate:modelValue":e[59]||(e[59]=a=>M.value=a),value:!1,class:"mr-2"},null,8,["modelValue"]),t("span",{class:n(M.value?"text-slate-400":o.value.text)},"不允许",2)]),s(i,{color:"green",onClick:se,class:"shadow"},{default:m(()=>e[250]||(e[250]=[v("保存")])),_:1})])],2),t("div",{id:"site-pwa-section",class:n(["rounded-lg p-4",o.value.subtleBg])},[t("div",vi,[t("div",{class:n(["flex items-center gap-2",o.value.text])},[s(d,{name:"i-heroicons-rocket-launch",class:"w-4 h-4"}),e[251]||(e[251]=v()),e[252]||(e[252]=t("span",null,"PWA 模式",-1))],2),t("div",gi,[s(y,{modelValue:r.pwaEnabled,"onUpdate:modelValue":e[60]||(e[60]=a=>r.pwaEnabled=a)},null,8,["modelValue"]),s(i,{color:"green",onClick:ys,class:"shadow"},{default:m(()=>e[253]||(e[253]=[v("保存")])),_:1})])]),t("div",fi,[t("div",null,[t("label",{class:n([o.value.mutedText,"text-sm mb-1 block"])},"PWA 标题",2),s(C,{modelValue:r.pwaTitle,"onUpdate:modelValue":e[61]||(e[61]=a=>r.pwaTitle=a),placeholder:r.siteTitle||"说说笔记"},null,8,["modelValue","placeholder"])]),t("div",null,[t("label",{class:n([o.value.mutedText,"text-sm mb-1 block"])},"PWA 图标",2),s(C,{modelValue:r.pwaIconURL,"onUpdate:modelValue":e[62]||(e[62]=a=>r.pwaIconURL=a),placeholder:"/favicon.ico"},null,8,["modelValue"])]),t("div",bi,[t("label",{class:n([o.value.mutedText,"text-sm mb-1 block"])},"PWA 描述",2),s(Z,{modelValue:r.pwaDescription,"onUpdate:modelValue":e[63]||(e[63]=a=>r.pwaDescription=a),placeholder:r.description||""},null,8,["modelValue","placeholder"])])])],2),t("div",{id:"site-github-card-section",class:n(["flex items-center rounded-lg p-3 justify-between",o.value.subtleBg])},[t("div",{class:n(["flex items-center gap-2",o.value.text])},[s(d,{name:"i-mdi-github",class:"w-4 h-4"}),e[254]||(e[254]=v()),e[255]||(e[255]=t("span",null,"GitHub 链接卡片解析",-1))],2),t("div",wi,[t("div",yi,[s(h,{modelValue:Fe.value,"onUpdate:modelValue":e[64]||(e[64]=a=>Fe.value=a),value:!0,class:"mr-2"},null,8,["modelValue"]),t("span",{class:n(Fe.value?o.value.text:"text-slate-400")},"开启",2)]),t("div",xi,[s(h,{modelValue:Fe.value,"onUpdate:modelValue":e[65]||(e[65]=a=>Fe.value=a),value:!1,class:"mr-2"},null,8,["modelValue"]),t("span",{class:n(Fe.value?"text-slate-400":o.value.text)},"关闭",2)]),s(i,{color:"green",onClick:js,class:"shadow"},{default:m(()=>e[256]||(e[256]=[v("保存")])),_:1})])],2),t("div",{id:"site-announcement-section",class:n(["flex items-center rounded-lg p-3 justify-between",o.value.subtleBg])},[t("div",{class:n(["flex items-center gap-2",o.value.text])},[s(d,{name:"i-heroicons-megaphone",class:"w-4 h-4"}),e[257]||(e[257]=v()),e[258]||(e[258]=t("span",null,"公告栏开关",-1))],2),t("div",hi,[s(y,{modelValue:r.announcementEnabled,"onUpdate:modelValue":e[66]||(e[66]=a=>r.announcementEnabled=a)},null,8,["modelValue"]),s(i,{color:"green",onClick:e[67]||(e[67]=a=>de("announcementEnabled")),class:"shadow"},{default:m(()=>e[259]||(e[259]=[v("保存")])),_:1})])],2),t("div",{class:n(["rounded-lg p-3 mt-3",o.value.subtleBg])},[t("div",{class:n(["text-sm mb-2",o.value.mutedText])},"公告栏文本",2),s(Z,{modelValue:r.announcementText,"onUpdate:modelValue":e[68]||(e[68]=a=>r.announcementText=a),placeholder:"请输入公告内容",class:"w-full mb-2"},null,8,["modelValue"]),t("div",ki,[s(i,{color:"primary",class:"shadow",onClick:e[69]||(e[69]=a=>de("announcementText"))},{default:m(()=>e[260]||(e[260]=[v("保存公告文本")])),_:1})])],2),t("div",Ci,[t("div",{class:n([o.value.cardBg,o.value.border,Me])},[t("div",Vi,[t("div",{class:n(["font-semibold flex items-center gap-2",o.value.text])},[s(d,{name:"i-heroicons-musical-note",class:"w-5 h-5"}),e[261]||(e[261]=t("span",null,"音乐配置",-1))],2),t("div",Ui,[s(y,{modelValue:r.musicEnabled,"onUpdate:modelValue":e[70]||(e[70]=a=>r.musicEnabled=a)},null,8,["modelValue"]),s(i,{color:"green",onClick:Ul,class:"shadow"},{default:m(()=>e[262]||(e[262]=[v("保存")])),_:1})])]),t("div",Ei,[t("div",{class:n(["rounded-lg p-4 space-y-4",o.value.subtleBg])},[t("div",Ti,[t("div",null,[t("label",{class:n(["text-sm mb-1 block",o.value.mutedText])},"歌单 ID",2),s(C,{modelValue:r.musicPlaylistId,"onUpdate:modelValue":e[71]||(e[71]=a=>r.musicPlaylistId=a),disabled:(r.musicSongId||"").trim()!=="",placeholder:"如 14273792576"},null,8,["modelValue","disabled"])]),t("div",null,[t("label",{class:n(["text-sm mb-1 block",o.value.mutedText])},"歌曲 ID",2),s(C,{modelValue:r.musicSongId,"onUpdate:modelValue":e[72]||(e[72]=a=>r.musicSongId=a),disabled:(r.musicPlaylistId||"").trim()!=="",placeholder:"可选，优先歌单"},null,8,["modelValue","disabled"])]),t("div",null,[t("label",{class:n(["text-sm mb-1 block",o.value.mutedText])},"显示位置",2),s(re,{modelValue:r.musicPosition,"onUpdate:modelValue":e[73]||(e[73]=a=>r.musicPosition=a),disabled:al.value==="embed",options:[{label:"左下角",value:"bottom-left"},{label:"右下角",value:"bottom-right"},{label:"左上角",value:"top-left"},{label:"右上角",value:"top-right"}]},null,8,["modelValue","disabled"])]),t("div",null,[t("label",{class:n(["text-sm mb-1 block",o.value.mutedText])},"主题",2),s(re,{modelValue:r.musicTheme,"onUpdate:modelValue":e[74]||(e[74]=a=>r.musicTheme=a),options:[{label:"自动",value:"auto"},{label:"深色",value:"dark"},{label:"浅色",value:"light"}]},null,8,["modelValue"])]),t("div",null,[t("label",{class:n(["text-sm mb-1 block",o.value.mutedText])},"CDN 源",2),s(re,{modelValue:He.value,"onUpdate:modelValue":e[75]||(e[75]=a=>He.value=a),options:[{label:"官方 CDN",value:"hypcvgm"},{label:"jsDelivr",value:"jsdelivr"},{label:"unpkg",value:"unpkg"},{label:"自定义",value:"custom"}]},null,8,["modelValue"])]),He.value==="custom"?(f(),b("div",Li,[t("label",{class:n(["text-sm mb-1 block",o.value.mutedText])},"CSS CDN 地址",2),s(C,{modelValue:r.musicCssCdnURL,"onUpdate:modelValue":e[76]||(e[76]=a=>r.musicCssCdnURL=a),placeholder:"https://api.hypcvgm.top/NeteaseMiniPlayer/netease-mini-player-v2.css"},null,8,["modelValue"])])):$("",!0),He.value==="custom"?(f(),b("div",Si,[t("label",{class:n(["text-sm mb-1 block",o.value.mutedText])},"JS CDN 地址",2),s(C,{modelValue:r.musicJsCdnURL,"onUpdate:modelValue":e[77]||(e[77]=a=>r.musicJsCdnURL=a),placeholder:"https://api.hypcvgm.top/NeteaseMiniPlayer/netease-mini-player-v2.js"},null,8,["modelValue"])])):$("",!0),t("div",null,[t("label",{class:n(["text-sm mb-1 block",o.value.mutedText])},"显示歌词",2),s(re,{modelValue:r.musicLyric,"onUpdate:modelValue":e[78]||(e[78]=a=>r.musicLyric=a),options:[{label:"是",value:!0},{label:"否",value:!1}]},null,8,["modelValue"])]),t("div",null,[t("label",{class:n(["text-sm mb-1 block",o.value.mutedText])},"自动播放",2),s(re,{modelValue:r.musicAutoplay,"onUpdate:modelValue":e[79]||(e[79]=a=>r.musicAutoplay=a),options:[{label:"是",value:!0},{label:"否",value:!1}]},null,8,["modelValue"])]),t("div",null,[t("label",{class:n(["text-sm mb-1 block",o.value.mutedText])},"默认最小化",2),s(re,{modelValue:r.musicDefaultMinimized,"onUpdate:modelValue":e[80]||(e[80]=a=>r.musicDefaultMinimized=a),options:[{label:"是",value:!0},{label:"否",value:!1}]},null,8,["modelValue"])]),t("div",Ai,[t("span",{class:n(["text-sm",o.value.mutedText])},"展示模式",2),s(re,{modelValue:al.value,"onUpdate:modelValue":e[81]||(e[81]=a=>al.value=a),options:[{label:"嵌入",value:"embed"},{label:"浮动",value:"float"}]},null,8,["modelValue"])])]),t("div",Bi,[s(i,{variant:"soft",color:"gray",onClick:Ps},{default:m(()=>e[263]||(e[263]=[v("重置")])),_:1}),s(i,{color:"green",onClick:Ul},{default:m(()=>e[264]||(e[264]=[v("保存")])),_:1})]),t("div",{class:n(["text-xs mt-2",o.value.mutedText])},"保存后首页自动刷新显示播放器；歌单与单曲任选其一",2)],2)])],2)]),t("div",{id:"site-default-theme-section",class:n(["flex items-center rounded-lg p-3 justify-between",o.value.subtleBg])},[t("div",{class:n(["flex items-center gap-2",o.value.text])},[s(d,{name:"i-heroicons-swatch",class:"w-4 h-4"}),e[265]||(e[265]=v()),e[266]||(e[266]=t("span",null,"默认主题色",-1))],2),t("div",$i,[t("div",Ri,[s(h,{modelValue:r.defaultContentTheme,"onUpdate:modelValue":e[82]||(e[82]=a=>r.defaultContentTheme=a),value:"dark",class:"mr-2"},null,8,["modelValue"]),t("span",{class:n(r.defaultContentTheme==="dark"?o.value.text:"text-slate-400")},"暗黑",2)]),t("div",ji,[s(h,{modelValue:r.defaultContentTheme,"onUpdate:modelValue":e[83]||(e[83]=a=>r.defaultContentTheme=a),value:"light",class:"mr-2"},null,8,["modelValue"]),t("span",{class:n(r.defaultContentTheme==="light"?o.value.text:"text-slate-400")},"白天",2)]),s(i,{color:"green",onClick:e[84]||(e[84]=a=>de("defaultContentTheme")),class:"shadow"},{default:m(()=>e[267]||(e[267]=[v("保存")])),_:1})])],2),t("div",Pi,[(f(),b(ue,null,ce(el,(a,R)=>t("div",{key:R,class:n(["rounded-lg p-3",o.value.subtleBg])},[t("div",Ii,[t("span",{class:n(o.value.mutedText)},x(a),3),s(i,{size:"sm",onClick:H=>ve[R]=!ve[R],color:ve[R]?"gray":"green",variant:ve[R]?"soft":"solid",class:"shadow"},{default:m(()=>[v(x(ve[R]?"取消":"编辑"),1)]),_:2},1032,["onClick","color","variant"])]),ve[R]?(f(),b("div",Di,[R==="背景图片"||R==="backgrounds"?(f(),b("div",Hi,[(f(!0),b(ue,null,ce(r.backgrounds,(H,xe)=>(f(),b("div",{key:xe,class:"flex items-center gap-3"},[t("img",{src:H||"/favicon.ico",class:n(["w-14 h-14 rounded object-cover border",o.value.border]),onClick:st=>rl(H)},null,10,_i),s(C,{modelValue:r.backgrounds[xe],"onUpdate:modelValue":st=>r.backgrounds[xe]=st,placeholder:"输入图片URL",class:"flex-1"},null,8,["modelValue","onUpdate:modelValue"]),t("div",Mi,[s(i,{size:"xs",variant:"soft",icon:"i-heroicons-arrow-up",onClick:st=>Os(xe)},{default:m(()=>e[268]||(e[268]=[v("上移")])),_:2},1032,["onClick"]),s(i,{size:"xs",variant:"soft",icon:"i-heroicons-arrow-down",onClick:st=>Ws(xe)},{default:m(()=>e[269]||(e[269]=[v("下移")])),_:2},1032,["onClick"]),s(i,{size:"xs",variant:"soft",icon:"i-heroicons-eye",onClick:st=>rl(H)},{default:m(()=>e[270]||(e[270]=[v("预览")])),_:2},1032,["onClick"]),s(i,{size:"xs",color:"red",variant:"soft",icon:"i-heroicons-trash",onClick:st=>zs(xe)},{default:m(()=>e[271]||(e[271]=[v("删除")])),_:2},1032,["onClick"])])]))),128)),t("div",{class:n(["rounded border-2 border-dashed p-4 text-center",o.value.border]),onDragover:e[85]||(e[85]=Dl(()=>{},["prevent"])),onDrop:Dl(Fs,["prevent"])},[t("div",zi,[s(i,{onClick:Ms,icon:"i-heroicons-plus",variant:"ghost"},{default:m(()=>e[272]||(e[272]=[v("添加链接")])),_:1}),s(i,{onClick:Ns,icon:"i-heroicons-cloud-arrow-up",variant:"ghost"},{default:m(()=>e[273]||(e[273]=[v("上传图片")])),_:1})]),nl.value?(f(),b("div",Ni,[t("div",{class:n(["text-xs",o.value.mutedText])},x(il.value),3),s(Ge,{value:zt.value,class:"mt-1"},null,8,["value"])])):$("",!0)],34)])):R==="avatarURL"?(f(),b("div",Oi,[t("div",Wi,[t("img",{src:r.avatarURL,class:"w-12 h-12 rounded-full object-cover",alt:"site-avatar"},null,8,Fi),s(i,{size:"sm",color:"gray",variant:"soft",onClick:e[86]||(e[86]=H=>{var xe;return(xe=Lt.value)==null?void 0:xe.click()})},{default:m(()=>e[274]||(e[274]=[v("上传图片")])),_:1}),t("input",{ref_for:!0,ref_key:"siteAvatarInput",ref:Lt,type:"file",accept:"image/*",class:"hidden",onChange:ks},null,544)]),s(C,{modelValue:r.avatarURL,"onUpdate:modelValue":e[87]||(e[87]=H=>r.avatarURL=H),placeholder:"输入图片URL",class:"w-full"},null,8,["modelValue"])])):R==="subtitleText"||R==="linksDescription"||R==="commentPageDescription"||R==="aboutPageDescription"||R==="aboutMarkdown"?(f(),ml(Z,{key:2,modelValue:r[R],"onUpdate:modelValue":H=>r[R]=H,placeholder:`输入${a}`,class:"w-full mb-2"},null,8,["modelValue","onUpdate:modelValue","placeholder"])):(f(),ml(C,{key:3,modelValue:r[R],"onUpdate:modelValue":H=>r[R]=H,placeholder:`输入${a}`,class:"w-full mb-2"},null,8,["modelValue","onUpdate:modelValue","placeholder"])),t("div",qi,[s(i,{onClick:H=>ws(R),variant:"ghost",color:"gray"},{default:m(()=>e[275]||(e[275]=[v("重置")])),_:2},1032,["onClick"]),s(i,{onClick:H=>de(R),color:"primary",class:"shadow"},{default:m(()=>e[276]||(e[276]=[v("保存")])),_:2},1032,["onClick"])])])):(f(),b("div",Ki,[R==="backgrounds"?(f(),b("div",Gi,[(f(!0),b(ue,null,ce(r.backgrounds,(H,xe)=>(f(),b("img",{key:xe,src:H,class:n(["w-full h-24 object-cover rounded cursor-pointer border",o.value.border]),onClick:st=>rl(H)},null,10,Ji))),128))])):R==="avatarURL"?(f(),b("div",Xi,[t("img",{src:r.avatarURL,class:"w-12 h-12 rounded-full object-cover",alt:"site-avatar"},null,8,Yi),t("span",{class:n(o.value.mutedText)},"站点头像预览",2)])):(f(),b("div",{key:2,class:n([o.value.subtleBg,o.value.border,"rounded-md p-3 border"])},[t("p",{class:n([o.value.text,"break-words"])},x(r[R]),3)],2))]))],2)),64))]),yl.value?(f(),b("div",Zi,[s(i,{onClick:_s,variant:"ghost",color:"gray"},{default:m(()=>e[277]||(e[277]=[v("重置")])),_:1}),s(i,{onClick:l.saveConfig,color:"primary",class:"shadow"},{default:m(()=>e[278]||(e[278]=[v("保存所有更改")])),_:1},8,["onClick"])])):$("",!0),t("div",Qi,[t("div",{class:n([o.value.cardBg,o.value.border,Me])},[t("div",ed,[t("div",{class:n(["font-semibold flex items-center gap-2",o.value.text])},[s(d,{name:"i-heroicons-megaphone",class:"w-5 h-5"}),e[279]||(e[279]=t("span",null,"左侧广告模块",-1))],2),t("div",td,[t("span",{class:n(["text-sm",o.value.mutedText])},"状态",2),t("span",{class:n([r.leftAdEnabled?"text-green-400":"text-red-400","text-sm"])},x(r.leftAdEnabled?"已启用":"未启用"),3),s(y,{modelValue:r.leftAdEnabled,"onUpdate:modelValue":e[88]||(e[88]=a=>r.leftAdEnabled=a)},null,8,["modelValue"]),s(i,{color:"green",onClick:e[89]||(e[89]=a=>de("leftAdEnabled")),class:"shadow"},{default:m(()=>e[280]||(e[280]=[v("保存")])),_:1})])]),t("div",ld,[t("div",{class:n(["rounded-lg p-4",o.value.subtleBg])},[t("div",sd,[t("div",{class:n(["text-sm font-semibold mb-2",o.value.text])},"多广告（自动轮播）",2),t("div",{class:n(["text-xs mb-2",o.value.mutedText])},"若同时配置单条与多条，优先显示多条",2),t("div",ad,[(f(!0),b(ue,null,ce(r.leftAds,(a,R)=>(f(),b("div",{key:R,class:n(["rounded-md border p-3",o.value.border])},[t("div",od,[t("div",{class:n(["text-sm",o.value.text])},"广告 #"+x(R+1),3),t("div",nd,[s(i,{size:"xs",color:"red",variant:"soft",onClick:H=>r.leftAds.splice(R,1)},{default:m(()=>e[281]||(e[281]=[v("删除")])),_:2},1032,["onClick"])])]),t("div",id,[s(C,{modelValue:a.imageURL,"onUpdate:modelValue":H=>a.imageURL=H,placeholder:"海报图片 URL"},null,8,["modelValue","onUpdate:modelValue"]),s(C,{modelValue:a.linkURL,"onUpdate:modelValue":H=>a.linkURL=H,placeholder:"跳转链接"},null,8,["modelValue","onUpdate:modelValue"]),s(Z,{modelValue:a.description,"onUpdate:modelValue":H=>a.description=H,placeholder:"描述文本（可选）",class:"md:col-span-2"},null,8,["modelValue","onUpdate:modelValue"])])],2))),128)),t("div",dd,[t("div",rd,[s(i,{size:"sm",color:"indigo",variant:"soft",class:"shadow",onClick:e[90]||(e[90]=a=>r.leftAds.push({imageURL:"",linkURL:"",description:""}))},{default:m(()=>e[282]||(e[282]=[v("新增广告")])),_:1}),s(i,{size:"sm",color:"gray",variant:"soft",class:"shadow",onClick:Is},{default:m(()=>e[283]||(e[283]=[v("重置为默认")])),_:1})]),t("div",ud,[t("span",{class:n(["text-sm",o.value.mutedText])},"轮播间隔(ms)",2),s(C,{modelValue:r.leftAdsIntervalMs,"onUpdate:modelValue":e[91]||(e[91]=a=>r.leftAdsIntervalMs=a),modelModifiers:{number:!0},type:"number",class:"w-28"},null,8,["modelValue"])])])])]),t("div",cd,[s(i,{color:"primary",class:"shadow",onClick:e[92]||(e[92]=a=>de("leftAds"))},{default:m(()=>e[284]||(e[284]=[v("保存广告配置")])),_:1})])],2)])],2)]),t("div",md,[t("div",{class:n([o.value.cardBg,o.value.border,Me])},[t("div",pd,[t("div",{class:n(["font-semibold flex items-center gap-2",o.value.text])},[s(d,{name:"i-heroicons-sparkles",class:"w-5 h-5"}),e[285]||(e[285]=t("span",null,"随机一言（Hitokoto）",-1))],2),t("div",vd,[s(y,{modelValue:r.hitokotoEnabled,"onUpdate:modelValue":e[93]||(e[93]=a=>r.hitokotoEnabled=a)},null,8,["modelValue"]),s(i,{color:"green",onClick:e[94]||(e[94]=a=>de("hitokotoEnabled")),class:"shadow"},{default:m(()=>e[286]||(e[286]=[v("保存")])),_:1})])]),t("div",gd,[t("div",{class:n(["rounded-lg p-4",o.value.subtleBg])},[t("div",{class:n(["text-sm",o.value.mutedText])},"开启后，首页左栏广告位下方显示随机一言",2)],2)])],2)]),t("div",fd,[t("div",{class:n([o.value.cardBg,o.value.border,Me])},[t("div",bd,[t("div",{class:n(["font-semibold flex items-center gap-2",o.value.text])},[s(d,{name:"i-heroicons-link",class:"w-5 h-5"}),e[287]||(e[287]=t("span",null,"社交链接配置",-1))],2),t("div",wd,[s(i,{size:"sm",onClick:e[95]||(e[95]=a=>ve.socialLinks=!ve.socialLinks),color:ve.socialLinks?"gray":"green",variant:ve.socialLinks?"soft":"solid",class:"shadow"},{default:m(()=>[v(x(ve.socialLinks?"取消":"编辑"),1)]),_:1},8,["color","variant"]),s(i,{color:"green",class:"shadow",onClick:Us},{default:m(()=>e[288]||(e[288]=[v("保存")])),_:1})])]),t("div",yd,[t("div",{class:n(["rounded-lg p-4",o.value.subtleBg])},[ve.socialLinks?(f(),b("div",xd,[(f(!0),b(ue,null,ce(r.socialLinks,(a,R)=>(f(),b("div",{key:R,class:n(["rounded-md border p-3",o.value.border])},[t("div",hd,[s(C,{modelValue:a.name,"onUpdate:modelValue":H=>a.name=H,placeholder:"名称"},null,8,["modelValue","onUpdate:modelValue"]),s(C,{modelValue:a.url,"onUpdate:modelValue":H=>a.url=H,placeholder:"链接 URL"},null,8,["modelValue","onUpdate:modelValue"]),s(C,{modelValue:a.icon,"onUpdate:modelValue":H=>a.icon=H,placeholder:"图标名称(可选)"},null,8,["modelValue","onUpdate:modelValue"])]),t("div",kd,[s(i,{size:"xs",color:"red",variant:"soft",onClick:H=>Vs(R)},{default:m(()=>e[289]||(e[289]=[v("删除")])),_:2},1032,["onClick"])])],2))),128)),t("div",Cd,[s(i,{size:"sm",color:"indigo",variant:"soft",class:"shadow",onClick:Cs},{default:m(()=>e[290]||(e[290]=[v("新增链接")])),_:1})])])):(f(),b("div",{key:1,class:n(["text-sm",o.value.mutedText])},"共有 "+x((r.socialLinks||[]).length)+" 条社交链接",3))],2)])],2)]),t("div",Vd,[t("div",{class:n([o.value.cardBg,o.value.border,Me])},[t("div",Ud,[t("div",{class:n(["font-semibold flex items-center gap-2",o.value.text])},[s(d,{name:"i-heroicons-link",class:"w-5 h-5"}),e[291]||(e[291]=t("span",null,"友链配置",-1))],2),t("div",Ed,[s(i,{size:"sm",color:"indigo",variant:"soft",class:"shadow",onClick:e[96]||(e[96]=a=>r.friendLinks.push({title:"",link:"",icon:"",description:""}))},{default:m(()=>e[292]||(e[292]=[v("新增友链")])),_:1}),s(i,{color:"primary",class:"shadow",onClick:e[97]||(e[97]=a=>de("friendLinks"))},{default:m(()=>e[293]||(e[293]=[v("保存")])),_:1})])]),t("div",Td,[t("div",{class:n(["rounded-lg p-4 space-y-3",o.value.subtleBg])},[(f(!0),b(ue,null,ce(r.friendLinks,(a,R)=>(f(),b("div",{key:R,class:n(["rounded-md border p-3 space-y-2",o.value.border])},[t("div",Ld,[t("div",{class:n(["text-sm",o.value.text])},"友链 #"+x(R+1),3),s(i,{size:"xs",color:"red",variant:"soft",onClick:H=>r.friendLinks.splice(R,1)},{default:m(()=>e[294]||(e[294]=[v("删除")])),_:2},1032,["onClick"])]),t("div",Sd,[s(C,{modelValue:a.title,"onUpdate:modelValue":H=>a.title=H,placeholder:"网站标题"},null,8,["modelValue","onUpdate:modelValue"]),s(C,{modelValue:a.link,"onUpdate:modelValue":H=>a.link=H,placeholder:"链接 (http/https)"},null,8,["modelValue","onUpdate:modelValue"]),s(C,{modelValue:a.icon,"onUpdate:modelValue":H=>a.icon=H,placeholder:"图标名称 (如 i-mdi-github，可选)"},null,8,["modelValue","onUpdate:modelValue"]),s(Z,{modelValue:a.description,"onUpdate:modelValue":H=>a.description=H,placeholder:"网站介绍 (可选)",class:"md:col-span-2"},null,8,["modelValue","onUpdate:modelValue"])])],2))),128))],2)])],2)])])],2)]),t("div",Ad,[t("div",{class:n([o.value.cardBg,o.value.border,Me])},[t("div",Bd,[t("div",{class:n(["font-semibold flex items-center gap-2",o.value.text])},[s(d,{name:"i-heroicons-chat-bubble-left-right",class:"w-5 h-5"}),e[295]||(e[295]=t("span",{class:"whitespace-nowrap"},"评论系统",-1))],2),t("div",$d,[t("span",{class:n(["text-sm",o.value.mutedText])},"状态",2),t("span",{class:n([r.commentEnabled?"text-green-400":"text-red-400","text-sm"])},x(r.commentEnabled?"已启用":"未启用"),3),s(y,{modelValue:r.commentEnabled,"onUpdate:modelValue":e[98]||(e[98]=a=>r.commentEnabled=a)},null,8,["modelValue"]),t("div",Rd,[t("span",{class:n(["text-sm",o.value.mutedText])},"邮件通知",2),s(y,{modelValue:r.commentEmailEnabled,"onUpdate:modelValue":e[99]||(e[99]=a=>r.commentEmailEnabled=a),disabled:!r.commentEnabled},null,8,["modelValue","disabled"])]),t("div",jd,[t("span",{class:n(["text-sm",o.value.mutedText])},"仅登录后评论",2),s(y,{modelValue:r.commentLoginRequired,"onUpdate:modelValue":e[100]||(e[100]=a=>r.commentLoginRequired=a),disabled:!r.commentEnabled},null,8,["modelValue","disabled"])]),s(i,{color:"green",onClick:kl,class:"shadow"},{default:m(()=>e[296]||(e[296]=[v("保存")])),_:1})])]),t("div",Pd,[s(vo,{config:r,"onUpdate:config":e[101]||(e[101]=a=>r=a),theme:o.value,onCommentSystemChanged:e[102]||(e[102]=a=>tl.value=a)},null,8,["config","theme"]),Le.value&&r.commentEnabled&&String(tl.value||r.commentSystem).toLowerCase()==="builtin"?(f(),b("div",{key:0,class:n(["mt-4 rounded-lg p-3",o.value.subtleBg])},[t("div",Id,[s(C,{modelValue:Ht.value,"onUpdate:modelValue":e[103]||(e[103]=a=>Ht.value=a),placeholder:"搜索评论内容/昵称/邮箱/网址",class:"flex-1"},null,8,["modelValue"]),s(i,{color:"primary",variant:"soft",onClick:Vl},{default:m(()=>e[297]||(e[297]=[v("搜索")])),_:1}),s(i,{variant:"soft",color:De.value?"gray":"indigo",onClick:Ts},{default:m(()=>[v(x(De.value?"折叠":"展开"),1)]),_:1},8,["color"])]),De.value?(f(),b("div",Dd,[(f(!0),b(ue,null,ce(it.value,a=>(f(),b("div",{key:a.id,class:n(["rounded border px-3 py-2",o.value.border])},[t("div",Hd,[t("div",{class:n(["text-sm truncate",o.value.text])},"#"+x(a.id)+" · "+x(a.nick||"匿名")+" · "+x(Es(a.created_at)),3),s(i,{size:"xs",variant:"ghost",color:ll(a)?"gray":"primary",onClick:R=>Ls(a)},{default:m(()=>[v(x(ll(a)?"收起":"展开"),1)]),_:2},1032,["color","onClick"])]),t("div",{class:n(["mt-1 text-sm truncate",o.value.text])},x(a.content),3),ll(a)?(f(),b("div",_d,[t("div",null,[t("span",{class:n(o.value.mutedText)},"消息ID",2),e[298]||(e[298]=v("：")),t("span",{class:n(o.value.text)},x(a.message_id),3)]),t("div",null,[t("span",{class:n(o.value.mutedText)},"父评论ID",2),e[299]||(e[299]=v("：")),t("span",{class:n(o.value.text)},x(a.parent_id||0),3)]),t("div",null,[t("span",{class:n(o.value.mutedText)},"邮箱",2),e[300]||(e[300]=v("：")),t("span",{class:n(o.value.text)},x(a.mail||"-"),3)]),t("div",Md,[t("span",{class:n(o.value.mutedText)},"网址",2),e[301]||(e[301]=v("：")),a.link?(f(),b("a",{key:0,href:a.link,target:"_blank",rel:"noopener",class:"underline"},x(a.link),9,zd)):(f(),b("span",{key:1,class:n(o.value.text)},"-",2))]),t("div",Nd,[s(i,{color:"red",variant:"soft",onClick:R=>$s(a)},{default:m(()=>e[302]||(e[302]=[v("删除该评论")])),_:2},1032,["onClick"])])])):$("",!0)],2))),128)),_t.value?(f(),b("div",Od,[s(i,{variant:"soft",onClick:Ss},{default:m(()=>e[303]||(e[303]=[v("加载更多")])),_:1})])):$("",!0)])):$("",!0)],2)):$("",!0)])],2),s(ge,{modelValue:Mt.value,"onUpdate:modelValue":e[105]||(e[105]=a=>Mt.value=a),ui:{width:"sm:max-w-md"}},{default:m(()=>[s(Ce,null,{header:m(()=>[t("div",Wd,[e[304]||(e[304]=t("h3",{class:"text-lg font-medium"},"再次确认删除",-1)),s(i,{color:"gray",variant:"ghost",icon:"i-mdi-close",class:"-my-1",onClick:sl})])]),footer:m(()=>[t("div",Yd,[s(i,{color:"gray",variant:"outline",onClick:sl},{default:m(()=>e[307]||(e[307]=[v("取消")])),_:1}),s(i,{color:"red",disabled:!rt.value,onClick:Rs},{default:m(()=>e[308]||(e[308]=[v("确认删除")])),_:1},8,["disabled"])])]),default:m(()=>{var a,R,H;return[t("div",Fd,[e[306]||(e[306]=t("div",{class:"text-sm"},"此操作不可恢复，确认删除该评论？",-1)),t("div",qd,"评论ID："+x((a=Ke.value)==null?void 0:a.id),1),t("div",Kd,"消息ID："+x((R=Ke.value)==null?void 0:R.message_id),1),t("div",Gd,"昵称："+x(((H=Ke.value)==null?void 0:H.nick)||"匿名"),1),t("div",Jd,"内容片段："+x(Bs.value),1),t("label",Xd,[qt(t("input",{type:"checkbox","onUpdate:modelValue":e[104]||(e[104]=xe=>rt.value=xe)},null,512),[[ca,rt.value]]),e[305]||(e[305]=v(" 我已知晓此操作不可恢复 "))])])]}),_:1})]),_:1},8,["modelValue"])]),t("div",{class:n(["mx-4 my-2 border-t",o.value.border])},null,2),Le.value?(f(),b("div",Zd,[t("div",{class:n([o.value.cardBg,o.value.border,Me])},[t("div",Qd,[t("div",{class:n(["font-semibold flex items-center gap-2",o.value.text])},[s(d,{name:"i-heroicons-envelope",class:"w-5 h-5"}),e[309]||(e[309]=t("span",null,"邮件设置（SMTP）",-1))],2),t("div",er,[s(y,{modelValue:g.enabled,"onUpdate:modelValue":e[106]||(e[106]=a=>g.enabled=a)},null,8,["modelValue"]),s(i,{color:"green",onClick:me,class:"shadow"},{default:m(()=>e[310]||(e[310]=[v("保存")])),_:1})])]),t("div",tr,[t("div",{class:n(["rounded-lg p-4 space-y-4",o.value.subtleBg])},[t("div",null,[t("div",{class:n(["text-sm font-medium mb-2",o.value.text])},"地址",2),s(C,{modelValue:g.from,"onUpdate:modelValue":e[107]||(e[107]=a=>g.from=a),placeholder:"发件地址，如 name@example.com"},null,8,["modelValue"])]),t("div",null,[t("div",{class:n(["text-sm font-medium mb-2",o.value.text])},"驱动",2),s(re,{modelValue:g.driver,"onUpdate:modelValue":e[108]||(e[108]=a=>g.driver=a),options:["smtp"]},null,8,["modelValue"])]),t("div",{class:n(["text-sm font-semibold mt-1 mb-2",o.value.text])},"SMTP 设置",2),t("div",lr,[t("div",null,[t("div",{class:n(["text-sm mb-2",o.value.text])},"主机",2),s(C,{modelValue:g.host,"onUpdate:modelValue":e[109]||(e[109]=a=>g.host=a),placeholder:"smtp.example.com"},null,8,["modelValue"])]),t("div",null,[t("div",{class:n(["text-sm mb-2",o.value.text])},"端口",2),s(C,{modelValue:g.port,"onUpdate:modelValue":e[110]||(e[110]=a=>g.port=a),placeholder:"465 或 587"},null,8,["modelValue"])]),t("div",null,[t("div",{class:n(["text-sm mb-2",o.value.text])},"加密协议（小写 ssl 或 tls）",2),s(re,{modelValue:g.encryption,"onUpdate:modelValue":e[111]||(e[111]=a=>g.encryption=a),options:["ssl","tls"]},null,8,["modelValue"])]),e[311]||(e[311]=t("div",{class:"md:col-span-1"},null,-1)),t("div",null,[t("div",{class:n(["text-sm mb-2",o.value.text])},"用户名",2),s(C,{modelValue:g.user,"onUpdate:modelValue":e[112]||(e[112]=a=>g.user=a),placeholder:"通常与发件地址一致"},null,8,["modelValue"])]),t("div",null,[t("div",{class:n(["text-sm mb-2",o.value.text])},"密码",2),s(C,{modelValue:g.pass,"onUpdate:modelValue":e[113]||(e[113]=a=>g.pass=a),type:be.value?"text":"password",placeholder:"邮箱或应用专用密码"},null,8,["modelValue","type"])])]),t("div",{class:n(["flex items-center justify-between mt-2",o.value.mutedText])},[t("span",sr,"使用上述设置发送测试邮件到："+x(g.from||g.user||"请先填写地址"),1),s(i,{disabled:!(g.from||g.user),loading:Pe.value,color:"primary",onClick:Qe},{default:m(()=>e[312]||(e[312]=[v("发送测试邮件")])),_:1},8,["disabled","loading"])],2),t("div",ar,[s(i,{variant:"soft",color:"gray",onClick:we},{default:m(()=>e[313]||(e[313]=[v("刷新")])),_:1}),s(i,{color:"green",onClick:me},{default:m(()=>e[314]||(e[314]=[v("保存")])),_:1})])],2)])],2)])):$("",!0),Le.value?(f(),b("div",or,[t("div",{class:n([o.value.cardBg,o.value.border,Me])},[t("div",nr,[t("div",{class:n(["font-semibold flex items-center gap-2",o.value.text])},[s(d,{name:"i-heroicons-shield-check",class:"w-5 h-5"}),e[315]||(e[315]=t("span",null,"用户管理",-1))],2)]),t("div",ir,[t("div",{class:n(["rounded-lg p-3 mb-3",o.value.subtleBg])},[t("div",dr,[s(C,{modelValue:vt.value,"onUpdate:modelValue":e[114]||(e[114]=a=>vt.value=a),placeholder:"搜索用户名或ID",class:"flex-1"},null,8,["modelValue"]),s(i,{color:"primary",variant:"soft",onClick:ft},{default:m(()=>e[316]||(e[316]=[v("搜索")])),_:1}),s(i,{variant:"soft",color:"gray",onClick:ft},{default:m(()=>e[317]||(e[317]=[v("刷新")])),_:1}),s(i,{variant:"soft",color:Ne.value?"gray":"indigo",onClick:e[115]||(e[115]=a=>Ne.value=!Ne.value)},{default:m(()=>[v(x(Ne.value?"折叠":"展开"),1)]),_:1},8,["color"])])],2),Ne.value?(f(),b("div",{key:0,class:n(["rounded-lg p-3",o.value.subtleBg])},[t("div",rr,[(f(!0),b(ue,null,ce(Ut.value,a=>(f(),b("div",{key:a.id??a.ID,class:n(["rounded border px-3 py-2",o.value.border])},[t("div",ur,[s(te,{color:"gray",variant:"soft"},{default:m(()=>[v("#"+x(a.id??a.ID),1)]),_:2},1024),t("span",{class:n(["truncate",o.value.text])},x(a.username??a.Username),3),s(te,{color:a.is_admin??a.IsAdmin?"primary":"gray",variant:"subtle"},{default:m(()=>[v(x(a.is_admin??a.IsAdmin?"管理员":"普通"),1)]),_:2},1032,["color"]),e[318]||(e[318]=t("div",{class:"flex-1"},null,-1)),s(i,{size:"xs",variant:"ghost",color:ke(a)?"gray":"primary",onClick:R=>Oe(a)},{default:m(()=>[v(x(ke(a)?"收起":"展开"),1)]),_:2},1032,["color","onClick"])]),t("div",cr,[s(i,{color:a.is_admin??a.IsAdmin?"orange":"green",variant:a.is_admin??a.IsAdmin?"soft":"solid",class:"shadow",onClick:R=>ie(a)},{default:m(()=>[v(x(a.is_admin??a.IsAdmin?"取消管理员":"设为管理员"),1)]),_:2},1032,["color","variant","onClick"]),s(i,{color:"red",variant:"soft",class:"shadow",onClick:R=>Ze(a)},{default:m(()=>e[319]||(e[319]=[v("删除")])),_:2},1032,["onClick"])]),ke(a)?(f(),b("div",{key:0,class:n(["mt-3 rounded p-3",o.value.subtleBg])},[t("div",mr,[t("div",null,[t("div",{class:n(["text-xs",o.value.mutedText])},"用户ID",2),t("div",{class:n(o.value.text)},x(a.id??a.ID),3)]),t("div",null,[t("div",{class:n(["text-xs",o.value.mutedText])},"用户名",2),t("div",{class:n(o.value.text)},x(a.username??a.Username),3)]),t("div",null,[t("div",{class:n(["text-xs",o.value.mutedText])},"角色",2),t("div",{class:n(o.value.text)},x(a.is_admin??a.IsAdmin?"管理员":"普通用户"),3)])]),t("div",pr,[t("div",{class:n(["text-sm mb-1",o.value.text])},"重置密码",2),t("div",vr,[s(C,{modelValue:Te.password[a.id??a.ID],"onUpdate:modelValue":R=>Te.password[a.id??a.ID]=R,type:$e.value?"text":"password",placeholder:"新密码",class:"flex-1"},null,8,["modelValue","onUpdate:modelValue","type"]),s(i,{icon:$e.value?"i-heroicons-eye-slash":"i-heroicons-eye",color:"gray",variant:"ghost",onClick:e[116]||(e[116]=R=>$e.value=!$e.value)},null,8,["icon"]),s(i,{disabled:!Xe(a),color:"primary",onClick:R=>Ye(a)},{default:m(()=>e[320]||(e[320]=[v("保存")])),_:2},1032,["disabled","onClick"])])])],2)):$("",!0)],2))),128))])],2)):$("",!0)])],2)])):$("",!0),s(ge,{modelValue:Ee.value,"onUpdate:modelValue":e[120]||(e[120]=a=>Ee.value=a)},{default:m(()=>[s(Ce,null,{default:m(()=>[e[323]||(e[323]=t("div",{class:"font-semibold mb-2"},"重置管理员密码",-1)),t("div",gr,[t("div",fr,[s(C,{modelValue:S.newPass,"onUpdate:modelValue":e[117]||(e[117]=a=>S.newPass=a),type:Be.value?"text":"password",placeholder:"新密码",class:"flex-1"},null,8,["modelValue","type"]),s(te,{color:E.value,variant:"soft"},{default:m(()=>[v(x(_.value),1)]),_:1},8,["color"])]),t("div",br,[s(C,{modelValue:S.confirmPass,"onUpdate:modelValue":e[118]||(e[118]=a=>S.confirmPass=a),type:Be.value?"text":"password",placeholder:"确认新密码",class:"flex-1"},null,8,["modelValue","type"])]),t("div",wr,[s(i,{variant:"ghost",color:"gray",onClick:e[119]||(e[119]=a=>Ee.value=!1)},{default:m(()=>e[321]||(e[321]=[v("取消")])),_:1}),s(i,{disabled:!pe.value,color:"primary",onClick:Xt},{default:m(()=>e[322]||(e[322]=[v("保存")])),_:1},8,["disabled"])])])]),_:1})]),_:1},8,["modelValue"]),Le.value?(f(),b("div",yr,[t("div",{class:n(["rounded-xl border shadow-xl",[o.value.cardBg,o.value.border]])},[t("div",xr,[t("div",{class:n(["font-semibold flex items-center gap-2",o.value.text])},[s(d,{name:"i-heroicons-bell-alert",class:"w-5 h-5"}),e[324]||(e[324]=t("span",null,"推送配置",-1))],2),t("div",hr,[t("span",{class:n(["text-sm",o.value.mutedText])},"状态",2),t("span",{class:n([r.notifyEnabled?"text-green-400":"text-red-400","text-sm"])},x(r.notifyEnabled?"已启用":"未启用"),3),s(ye,{modelValue:r.notifyEnabled,"onUpdate:modelValue":e[121]||(e[121]=a=>r.notifyEnabled=a),color:"primary",size:"lg"},null,8,["modelValue"]),t("div",kr,[s(h,{modelValue:r.notifyEnabled,"onUpdate:modelValue":e[122]||(e[122]=a=>r.notifyEnabled=a),value:!0},null,8,["modelValue"]),t("span",{class:n(r.notifyEnabled?o.value.text:"text-gray-400")},"开启",2),s(h,{modelValue:r.notifyEnabled,"onUpdate:modelValue":e[123]||(e[123]=a=>r.notifyEnabled=a),value:!1},null,8,["modelValue"]),t("span",{class:n(r.notifyEnabled?"text-gray-400":o.value.text)},"关闭",2)])])]),t("div",Cr,[s(ro,{config:Re(ae),"onUpdate:config":e[124]||(e[124]=a=>ma(ae)?ae.value=a:ae=a),immediate:!0,subtleBg:o.value.subtleBg,text:o.value.text,mutedText:o.value.mutedText,disabled:!r.notifyEnabled},null,8,["config","subtleBg","text","mutedText","disabled"])])],2)])):$("",!0),Le.value?(f(),b("div",Vr,[t("div",{class:n(["rounded-xl border shadow-xl",[o.value.cardBg,o.value.border]])},[t("div",Ur,[t("div",{class:n(["font-semibold flex items-center gap-2",o.value.text])},[s(d,{name:"i-mdi-github",class:"w-5 h-5"}),e[325]||(e[325]=t("span",null,"GitHub 登录",-1))],2),t("div",Er,[t("span",{class:n(["text-sm",o.value.mutedText])},"状态",2),t("span",{class:n([r.githubOAuthEnabled?"text-green-400":"text-red-400","text-sm"])},x(r.githubOAuthEnabled?"已启用":"未启用"),3),s(ye,{modelValue:r.githubOAuthEnabled,"onUpdate:modelValue":e[125]||(e[125]=a=>r.githubOAuthEnabled=a),color:"primary",size:"lg"},null,8,["modelValue"]),s(y,{modelValue:r.githubOAuthEnabled,"onUpdate:modelValue":e[126]||(e[126]=a=>r.githubOAuthEnabled=a)},null,8,["modelValue"]),t("div",Tr,[s(h,{modelValue:r.githubOAuthEnabled,"onUpdate:modelValue":e[127]||(e[127]=a=>r.githubOAuthEnabled=a),value:!0},null,8,["modelValue"]),t("span",{class:n(r.githubOAuthEnabled?o.value.text:"text-gray-400")},"开启",2),s(h,{modelValue:r.githubOAuthEnabled,"onUpdate:modelValue":e[128]||(e[128]=a=>r.githubOAuthEnabled=a),value:!1},null,8,["modelValue"]),t("span",{class:n(r.githubOAuthEnabled?"text-gray-400":o.value.text)},"关闭",2)])])]),t("div",Lr,[t("div",Sr,[t("div",null,[t("div",{class:n(["text-sm mb-2",o.value.text])},"Client ID",2),s(C,{modelValue:r.githubClientId,"onUpdate:modelValue":e[129]||(e[129]=a=>r.githubClientId=a),placeholder:"GitHub OAuth App Client ID",disabled:!r.githubOAuthEnabled},null,8,["modelValue","disabled"])]),t("div",null,[t("div",{class:n(["text-sm mb-2",o.value.text])},"Client Secret",2),s(C,{modelValue:r.githubClientSecret,"onUpdate:modelValue":e[130]||(e[130]=a=>r.githubClientSecret=a),type:"password",placeholder:"GitHub OAuth App Client Secret",disabled:!r.githubOAuthEnabled},null,8,["modelValue","disabled"])]),t("div",Ar,[t("div",{class:n(["text-sm mb-2",o.value.text])},"回调地址",2),s(C,{modelValue:r.githubCallbackURL,"onUpdate:modelValue":e[131]||(e[131]=a=>r.githubCallbackURL=a),placeholder:"例如 https://your.domain.com/oauth/github/callback",disabled:!r.githubOAuthEnabled},null,8,["modelValue","disabled"])])]),t("div",Br,[s(i,{variant:"soft",color:"gray",onClick:qe},{default:m(()=>e[326]||(e[326]=[v("刷新")])),_:1}),s(i,{color:"green",onClick:Ds},{default:m(()=>e[327]||(e[327]=[v("保存")])),_:1}),s(i,{color:"primary",onClick:et},{default:m(()=>e[328]||(e[328]=[v("测试")])),_:1})]),t("div",{class:n(["text-xs",o.value.mutedText])},"默认不开启，开启后登录页显示“GitHub 一键登录”按钮",2)])],2)])):$("",!0),Le.value?(f(),b("div",$r,[t("div",{class:n(["rounded-xl border shadow-xl",[o.value.cardBg,o.value.border]])},[s(Mo,{theme:o.value},null,8,["theme"])],2)])):$("",!0),Le.value?(f(),b("div",Rr,[t("div",{class:n(["rounded-xl border shadow-xl",[o.value.cardBg,o.value.border]])},[t("div",jr,[t("div",{class:n(["font-semibold flex items-center gap-2",o.value.text])},[s(d,{name:"i-heroicons-circle-stack",class:"w-5 h-5 text-indigo-300"}),e[329]||(e[329]=t("span",null,"本地数据库管理配置",-1)),t("span",{class:n(["ml-2 text-xs px-2 py-1 rounded",o.value.subtleBg])},"当前 DB："+x(qs.value),3)],2),t("div",Pr,[s(i,{color:"primary",icon:"i-heroicons-arrow-down-tray",disabled:ut.value!=="sqlite",onClick:Ks},{default:m(()=>e[330]||(e[330]=[v("下载本地备份")])),_:1},8,["disabled"]),s(i,{color:"warning",variant:"soft",icon:"i-heroicons-arrow-up-tray",disabled:ut.value!=="sqlite",onClick:Gs},{default:m(()=>e[331]||(e[331]=[v("恢复本地数据库")])),_:1},8,["disabled"]),t("input",{type:"file",ref_key:"databaseFileInput",ref:kt,accept:".zip",class:"hidden",onChange:Tl},null,544)])]),t("div",Ir,[t("div",{class:n(["text-yellow-400 text-sm rounded p-2",o.value.subtleBg])},"🔔：仅针对 SQLite 本地数据库；"+x(ut.value!=="sqlite"?"当前为云/外部数据库，请在服务端操作":"可在此下载与恢复本地备份"),3),t("input",{type:"file",ref_key:"databaseFileInput",ref:kt,accept:".zip",class:"hidden",onChange:Tl},null,544),t("div",{class:n(["rounded-lg p-3",o.value.subtleBg])},[t("div",{class:n(["font-semibold mb-2 flex items-center justify-between",o.value.text])},[e[332]||(e[332]=t("span",null,"云存储接入（R2/S3）",-1)),t("div",Dr,[t("span",{class:n(["text-sm",o.value.mutedText])},"状态",2),t("span",{class:n([ee.value?"text-green-400":"text-red-400","text-sm"])},x(ee.value?"已启用":"未启用"),3),s(ye,{modelValue:ee.value,"onUpdate:modelValue":e[132]||(e[132]=a=>ee.value=a)},null,8,["modelValue"]),t("div",Hr,[s(h,{modelValue:ee.value,"onUpdate:modelValue":e[133]||(e[133]=a=>ee.value=a),value:!0},null,8,["modelValue"]),t("span",{class:n(ee.value?o.value.text:"text-gray-400")},"开启",2),s(h,{modelValue:ee.value,"onUpdate:modelValue":e[134]||(e[134]=a=>ee.value=a),value:!1},null,8,["modelValue"]),t("span",{class:n(ee.value?"text-gray-400":o.value.text)},"关闭",2)])])],2),t("div",_r,[t("div",null,[t("label",{class:n(["text-sm mb-1 block",o.value.mutedText])},"提供方",2),s(re,{modelValue:A.provider,"onUpdate:modelValue":e[135]||(e[135]=a=>A.provider=a),options:[{label:"S3",value:"s3"},{label:"R2",value:"r2"}],disabled:!ee.value},null,8,["modelValue","disabled"])]),t("div",null,[t("label",{class:n(["text-sm mb-1 block",o.value.mutedText])},"Endpoint",2),s(C,{modelValue:A.endpoint,"onUpdate:modelValue":e[136]||(e[136]=a=>A.endpoint=a),placeholder:"https://...",disabled:!ee.value},null,8,["modelValue","disabled"])]),t("div",null,[t("label",{class:n(["text-sm mb-1 block",o.value.mutedText])},"Region",2),s(C,{modelValue:A.region,"onUpdate:modelValue":e[137]||(e[137]=a=>A.region=a),placeholder:"auto 或区域名",disabled:!ee.value},null,8,["modelValue","disabled"])]),t("div",null,[t("label",{class:n(["text-sm mb-1 block",o.value.mutedText])},"Bucket",2),s(C,{modelValue:A.bucket,"onUpdate:modelValue":e[138]||(e[138]=a=>A.bucket=a),placeholder:"bucket 名称",disabled:!ee.value},null,8,["modelValue","disabled"])]),t("div",null,[t("label",{class:n(["text-sm mb-1 block",o.value.mutedText])},"Access Key",2),s(C,{modelValue:A.accessKey,"onUpdate:modelValue":e[139]||(e[139]=a=>A.accessKey=a),disabled:!ee.value},null,8,["modelValue","disabled"])]),t("div",null,[t("label",{class:n(["text-sm mb-1 block",o.value.mutedText])},"Secret Key",2),s(C,{modelValue:A.secretKey,"onUpdate:modelValue":e[140]||(e[140]=a=>A.secretKey=a),type:"password",disabled:!ee.value},null,8,["modelValue","disabled"])]),A.provider==="s3"?(f(),b("div",Mr,[t("span",{class:n(["text-sm",o.value.mutedText])},"使用路径风格地址",2),s(ye,{modelValue:A.usePathStyle,"onUpdate:modelValue":e[141]||(e[141]=a=>A.usePathStyle=a),disabled:!ee.value},null,8,["modelValue","disabled"])])):$("",!0),t("div",zr,[t("label",{class:n(["text-sm mb-1 block",o.value.mutedText])},"公共访问前缀",2),s(C,{modelValue:A.publicBaseURL,"onUpdate:modelValue":e[142]||(e[142]=a=>A.publicBaseURL=a),placeholder:"https://bucket.example.com/",disabled:!ee.value},null,8,["modelValue","disabled"])])]),t("div",Nr,[s(i,{variant:"soft",color:"gray",onClick:cl},{default:m(()=>e[333]||(e[333]=[v("刷新")])),_:1}),s(i,{color:"green",onClick:Xs},{default:m(()=>e[334]||(e[334]=[v("保存")])),_:1})]),t("div",Or,[t("div",Wr,[t("div",Fr,[t("span",{class:n(["text-sm",o.value.mutedText])},"自动同步至云端",2),s(ye,{modelValue:lt.value,"onUpdate:modelValue":e[143]||(e[143]=a=>lt.value=a),disabled:!(ee.value&&A.provider&&A.endpoint&&A.bucket&&A.accessKey&&A.secretKey)},null,8,["modelValue","disabled"])]),t("div",qr,[t("span",{class:n(["text-sm",o.value.mutedText])},"模式",2),s(re,{modelValue:Ct.value,"onUpdate:modelValue":e[144]||(e[144]=a=>Ct.value=a),options:[{label:"即时",value:"instant"},{label:"定时",value:"scheduled"}],disabled:!lt.value||!(ee.value&&A.provider&&A.endpoint&&A.bucket&&A.accessKey&&A.secretKey)},null,8,["modelValue","disabled"])]),Ct.value==="scheduled"?(f(),b("div",Kr,[t("span",{class:n(["text-sm",o.value.mutedText])},"间隔(分钟)",2),s(C,{modelValue:Nt.value,"onUpdate:modelValue":e[145]||(e[145]=a=>Nt.value=a),modelModifiers:{number:!0},type:"number",min:"1",class:"w-24",disabled:!lt.value||!(ee.value&&A.provider&&A.endpoint&&A.bucket&&A.accessKey&&A.secretKey)},null,8,["modelValue","disabled"])])):$("",!0),t("div",Gr,[t("span",{class:n(["text-sm",o.value.mutedText])},"上次同步",2),t("span",{class:n(["text-sm",o.value.text])},x(Ll.value||"—"),3),s(i,{color:"primary",disabled:!lt.value||!(ee.value&&A.provider&&A.endpoint&&A.bucket&&A.accessKey&&A.secretKey),onClick:Ys},{default:m(()=>e[335]||(e[335]=[v("立即同步")])),_:1},8,["disabled"])])]),t("div",null,[t("label",{class:n(["text-sm mb-1 block",o.value.mutedText])},"上传URL（预签名）",2),t("div",Jr,[s(C,{modelValue:Ot.value,"onUpdate:modelValue":e[146]||(e[146]=a=>Ot.value=a),placeholder:"粘贴R2/S3预签名上传URL",class:"flex-1"},null,8,["modelValue"]),s(i,{disabled:!ee.value,onClick:ea},{default:m(()=>e[336]||(e[336]=[v("生成")])),_:1},8,["disabled"])])]),t("div",null,[t("label",{class:n(["text-sm mb-1 block",o.value.mutedText])},"下载URL（预签名）",2),t("div",Xr,[s(C,{modelValue:Wt.value,"onUpdate:modelValue":e[147]||(e[147]=a=>Wt.value=a),placeholder:"粘贴R2/S3预签名下载URL",class:"flex-1"},null,8,["modelValue"]),s(i,{disabled:!ee.value,onClick:ta},{default:m(()=>e[337]||(e[337]=[v("生成")])),_:1},8,["disabled"])])])]),t("div",Yr,[s(i,{color:"primary",onClick:Zs},{default:m(()=>e[338]||(e[338]=[v("上传备份到云")])),_:1}),s(i,{color:"warning",onClick:Qs},{default:m(()=>e[339]||(e[339]=[v("从云恢复备份")])),_:1}),s(i,{color:"blue",variant:"solid",disabled:!ee.value||!A.publicBaseURL,onClick:la},{default:m(()=>e[340]||(e[340]=[v("按配置恢复")])),_:1},8,["disabled"])])],2)])],2)])):$("",!0)])],2),qt(t("div",{class:n(["flex fixed bottom-0 left-0 right-0 md:left-72 z-50 border-t px-3 py-3 justify-between items-center backdrop-blur-md shadow-xl",[o.value.bottomBg,o.value.border]])},[s(i,{icon:"i-heroicons-arrow-left",color:u.value==="light"?"gray":u.value==="midnight"?"blue":u.value==="slate"?"slate":"gray",variant:u.value==="light"?"soft":"solid",onClick:e[148]||(e[148]=a=>l.$router.push("/")),class:"shadow ring-1 ring-inset ring-slate-400/30 transition hover:opacity-90"},{default:m(()=>e[341]||(e[341]=[v(" 返回首页 ")])),_:1},8,["color","variant"]),Et.value?(f(),b("div",Zr,[s(i,{icon:"i-heroicons-power",color:"red",variant:"solid",onClick:wl,class:"shadow transition hover:opacity-90"},{default:m(()=>e[342]||(e[342]=[v(" 退出登录 ")])),_:1})])):(f(),b("div",Qr,[s(i,{color:"primary",onClick:e[149]||(e[149]=a=>{Tt.value=!0,We.value=!0})},{default:m(()=>e[343]||(e[343]=[v("登录")])),_:1}),s(i,{color:"secondary",onClick:e[150]||(e[150]=a=>{Tt.value=!0,We.value=!1})},{default:m(()=>e[344]||(e[344]=[v("注册")])),_:1})]))],2),[[pa,T.value]]),$("",!0)]),s(ge,{modelValue:Tt.value,"onUpdate:modelValue":e[196]||(e[196]=a=>Tt.value=a)},{default:m(()=>[t("div",{class:n(["p-6 rounded-lg",o.value.cardBg])},[t("h3",{class:n(["text-xl font-semibold mb-4",o.value.text])},x(We.value?"用户登录":"用户注册"),3),s(Q,{state:tt,class:"space-y-4"},{default:m(()=>[s(K,null,{default:m(()=>[s(C,{modelValue:tt.username,"onUpdate:modelValue":e[192]||(e[192]=a=>tt.username=a),placeholder:"用户名",class:"w-full"},null,8,["modelValue"])]),_:1}),s(K,null,{default:m(()=>[s(C,{modelValue:tt.password,"onUpdate:modelValue":e[193]||(e[193]=a=>tt.password=a),type:"password",placeholder:"密码",class:"w-full"},null,8,["modelValue"])]),_:1}),t("div",eu,[s(i,{variant:"ghost",onClick:e[194]||(e[194]=a=>We.value=!We.value)},{default:m(()=>[v(x(We.value?"去注册":"去登录"),1)]),_:1}),s(i,{color:"primary",onClick:e[195]||(e[195]=a=>We.value?Re(c)(tt):Re(N)(tt))},{default:m(()=>[v(x(We.value?"登录":"注册"),1)]),_:1})])]),_:1},8,["state"])],2)]),_:1},8,["modelValue"]),s(ge,{modelValue:dl.value,"onUpdate:modelValue":e[197]||(e[197]=a=>dl.value=a)},{default:m(()=>[t("div",tu,[t("img",{src:El.value,class:"max-h-[70vh] w-auto mx-auto rounded"},null,8,lu)])]),_:1},8,["modelValue"]),t("input",{type:"file",ref_key:"bgFileInput",ref:wt,accept:"image/*",multiple:"",class:"hidden",onChange:Hs},null,544)],2)}}}),au=vl(su,[["__scopeId","data-v-ecba8b54"]]),mu=at({__name:"status",setup(p){const J=typeof document<"u"?Array.from(document.documentElement.classList):[];return Ve(()=>{if(typeof window>"u")return;const U=(localStorage.getItem("adminTheme")||"dark").toLowerCase(),u=document.documentElement;u.classList.remove("dark"),U!=="light"&&u.classList.add("dark")}),ga(()=>{if(typeof window>"u")return;const U=document.documentElement;Array.from(U.classList).forEach(u=>U.classList.remove(u)),J.forEach(u=>U.classList.add(u))}),(U,u)=>(f(),b(ue,null,[s(au),s(ya)],64))}});export{mu as default};
