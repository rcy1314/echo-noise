var Gs=Object.defineProperty;var Zs=(w,n,r)=>n in w?Gs(w,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):w[n]=r;var Yt=(w,n,r)=>Zs(w,typeof n!="symbol"?n+"":n,r);import{s as Xs,u as Js,a as Cn,r as te,b as Qs,t as fi,g as el,o as tl,c as ir,w as lt,d as Xr,e as nl,f as il,h as Te,i as _e,j as Qt,k as rl,l as al,m as Ha,n as Ie,p as Hn,q as nt,v as ji,x as Tn,y as ol,z as rn,A as mt,B as Pt,C as vi,D as me,E as le,F as sl,G as Ia,H as Jr,I as kt,J as Ot,K as Ve,L as V,M as ce,N as Na,_ as jt,O as et,P as sn,Q as ja,R as kn,S as Mn,T as Ba,U as ll,V as St,W as cl,X as at,Y as Se,Z as ci,$ as ul,a0 as Qr,a1 as dl,a2 as Ze,a3 as Vt,a4 as an,a5 as Bi,a6 as za,a7 as sr,a8 as fl,a9 as Fa,aa as hl,ab as zi,ac as pl,ad as ml,ae as ea,af as ta,ag as gl}from"./DIdX6-tg.js";import{o as ui,i as vl,A as yl,f as bl,E as wl,u as El,T as Sl,a as na,_ as lr,b as Ua,c as Cl,s as Tl,d as kl,e as Ml,N as xl}from"./oKCyEVGW.js";const _l=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],Ll=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],Al="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",Kt=[];let Dl=class{constructor(){Yt(this,"_data",new Zn);Yt(this,"_hash",new Zn([..._l]));Yt(this,"_nDataBytes",0);Yt(this,"_minBufferSize",0)}finalize(n){n&&this._append(n);const r=this._nDataBytes*8,s=this._data.sigBytes*8;return this._data.words[s>>>5]|=128<<24-s%32,this._data.words[(s+64>>>9<<4)+14]=Math.floor(r/4294967296),this._data.words[(s+64>>>9<<4)+15]=r,this._data.sigBytes=this._data.words.length*4,this._process(),this._hash}_doProcessBlock(n,r){const s=this._hash.words;let c=s[0],h=s[1],g=s[2],d=s[3],y=s[4],T=s[5],C=s[6],f=s[7];for(let u=0;u<64;u++){if(u<16)Kt[u]=n[r+u]|0;else{const x=Kt[u-15],A=(x<<25|x>>>7)^(x<<14|x>>>18)^x>>>3,m=Kt[u-2],O=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;Kt[u]=A+Kt[u-7]+O+Kt[u-16]}const p=y&T^~y&C,v=c&h^c&g^h&g,E=(c<<30|c>>>2)^(c<<19|c>>>13)^(c<<10|c>>>22),b=(y<<26|y>>>6)^(y<<21|y>>>11)^(y<<7|y>>>25),k=f+b+p+Ll[u]+Kt[u],M=E+v;f=C,C=T,T=y,y=d+k|0,d=g,g=h,h=c,c=k+M|0}s[0]=s[0]+c|0,s[1]=s[1]+h|0,s[2]=s[2]+g|0,s[3]=s[3]+d|0,s[4]=s[4]+y|0,s[5]=s[5]+T|0,s[6]=s[6]+C|0,s[7]=s[7]+f|0}_append(n){typeof n=="string"&&(n=Zn.fromUtf8(n)),this._data.concat(n),this._nDataBytes+=n.sigBytes}_process(n){let r,s=this._data.sigBytes/64;n?s=Math.ceil(s):s=Math.max((s|0)-this._minBufferSize,0);const c=s*16,h=Math.min(c*4,this._data.sigBytes);if(c){for(let g=0;g<c;g+=16)this._doProcessBlock(this._data.words,g);r=this._data.words.splice(0,c),this._data.sigBytes-=h}return new Zn(r,h)}},Zn=class $a{constructor(n,r){Yt(this,"words");Yt(this,"sigBytes");n=this.words=n||[],this.sigBytes=r===void 0?n.length*4:r}static fromUtf8(n){const r=unescape(encodeURIComponent(n)),s=r.length,c=[];for(let h=0;h<s;h++)c[h>>>2]|=(r.charCodeAt(h)&255)<<24-h%4*8;return new $a(c,s)}toBase64(){const n=[];for(let r=0;r<this.sigBytes;r+=3){const s=this.words[r>>>2]>>>24-r%4*8&255,c=this.words[r+1>>>2]>>>24-(r+1)%4*8&255,h=this.words[r+2>>>2]>>>24-(r+2)%4*8&255,g=s<<16|c<<8|h;for(let d=0;d<4&&r*8+d*6<this.sigBytes*8;d++)n.push(Al.charAt(g>>>6*(3-d)&63))}return n.join("")}concat(n){if(this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4),this.sigBytes%4)for(let r=0;r<n.sigBytes;r++){const s=n.words[r>>>2]>>>24-r%4*8&255;this.words[this.sigBytes+r>>>2]|=s<<24-(this.sigBytes+r)%4*8}else for(let r=0;r<n.sigBytes;r+=4)this.words[this.sigBytes+r>>>2]=n.words[r>>>2];this.sigBytes+=n.sigBytes}};function Ol(w){return new Dl().finalize(w).toBase64()}function Pl(w){return Ol(Xs(w))}const Rl=w=>w==="defer"||w===!1;function Hl(...w){var E;const n=typeof w[w.length-1]=="string"?w.pop():void 0;typeof w[0]!="string"&&w.unshift(n);let[r,s,c={}]=w;if(typeof r!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof s!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");const h=Js(),g=s,d=()=>Cn.value,y=()=>h.isHydrating?h.payload.data[r]:h.static.data[r];c.server??(c.server=!0),c.default??(c.default=d),c.getCachedData??(c.getCachedData=y),c.lazy??(c.lazy=!1),c.immediate??(c.immediate=!0),c.deep??(c.deep=Cn.deep),c.dedupe??(c.dedupe="cancel");const T=c.getCachedData(r,h),C=T!=null;if(!h._asyncData[r]||!c.immediate){(E=h.payload._errors)[r]??(E[r]=Cn.errorValue);const b=c.deep?te:Qs;h._asyncData[r]={data:b(C?T:c.default()),pending:te(!C),error:fi(h.payload._errors,r),status:te("idle"),_default:c.default}}const f={...h._asyncData[r]};delete f._default,f.refresh=f.execute=(b={})=>{if(h._asyncDataPromises[r]){if(Rl(b.dedupe??c.dedupe))return h._asyncDataPromises[r];h._asyncDataPromises[r].cancelled=!0}if(b._initial||h.isHydrating&&b._initial!==!1){const M=b._initial?T:c.getCachedData(r,h);if(M!=null)return Promise.resolve(M)}f.pending.value=!0,f.status.value="pending";const k=new Promise((M,x)=>{try{M(g(h))}catch(A){x(A)}}).then(async M=>{if(k.cancelled)return h._asyncDataPromises[r];let x=M;c.transform&&(x=await c.transform(M)),c.pick&&(x=Nl(x,c.pick)),h.payload.data[r]=x,f.data.value=x,f.error.value=Cn.errorValue,f.status.value="success"}).catch(M=>{if(k.cancelled)return h._asyncDataPromises[r];f.error.value=il(M),f.data.value=Te(c.default()),f.status.value="error"}).finally(()=>{k.cancelled||(f.pending.value=!1,delete h._asyncDataPromises[r])});return h._asyncDataPromises[r]=k,h._asyncDataPromises[r]},f.clear=()=>Il(h,r);const u=()=>f.refresh({_initial:!0}),p=c.server!==!1&&h.payload.serverRendered;{const b=el();if(b&&p&&c.immediate&&!b.sp&&(b.sp=[]),b&&!b._nuxtOnBeforeMountCbs){b._nuxtOnBeforeMountCbs=[];const x=b._nuxtOnBeforeMountCbs;tl(()=>{x.forEach(A=>{A()}),x.splice(0,x.length)}),ir(()=>x.splice(0,x.length))}p&&h.isHydrating&&(f.error.value||T!=null)?(f.pending.value=!1,f.status.value=f.error.value?"error":"success"):b&&(h.payload.serverRendered&&h.isHydrating||c.lazy)&&c.immediate?b._nuxtOnBeforeMountCbs.push(u):c.immediate&&u();const k=nl();if(c.watch){const x=lt(c.watch,()=>f.refresh());k&&Xr(x)}const M=h.hook("app:data:refresh",async x=>{(!x||x.includes(r))&&await f.refresh()});k&&Xr(M)}const v=Promise.resolve(h._asyncDataPromises[r]).then(()=>f);return Object.assign(v,f),v}function Il(w,n){n in w.payload.data&&(w.payload.data[n]=void 0),n in w.payload._errors&&(w.payload._errors[n]=Cn.errorValue),w._asyncData[n]&&(w._asyncData[n].data.value=void 0,w._asyncData[n].error.value=Cn.errorValue,w._asyncData[n].pending.value=!1,w._asyncData[n].status.value="idle"),n in w._asyncDataPromises&&(w._asyncDataPromises[n]&&(w._asyncDataPromises[n].cancelled=!0),w._asyncDataPromises[n]=void 0)}function Nl(w,n){const r={};for(const s of n)r[s]=w[s];return r}function jl(w,n,r){const[s={},c]=typeof n=="string"?[{},n]:[n,r],h=_e(()=>Qt(w)),g=s.key||Pl([c,typeof h.value=="string"?h.value:"",...Bl(s)]);if(!g||typeof g!="string")throw new TypeError("[nuxt] [useFetch] key must be a string: "+g);const d=g===c?"$f"+g:g;if(!s.baseURL&&typeof h.value=="string"&&h.value[0]==="/"&&h.value[1]==="/")throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:y,lazy:T,default:C,transform:f,pick:u,watch:p,immediate:v,getCachedData:E,deep:b,dedupe:k,...M}=s,x=rl({...al,...M,cache:typeof s.cache=="boolean"?void 0:s.cache}),A={server:y,lazy:T,default:C,transform:f,pick:u,immediate:v,getCachedData:E,deep:b,dedupe:k,watch:p===!1?[]:[x,h,...p||[]]};let m;return Hl(d,()=>{var z;(z=m==null?void 0:m.abort)==null||z.call(m,new DOMException("Request aborted as another request to the same endpoint was initiated.","AbortError")),m=typeof AbortController<"u"?new AbortController:{};const N=Qt(s.timeout);let H;return N&&(H=setTimeout(()=>m.abort(new DOMException("Request aborted due to timeout.","AbortError")),N),m.signal.onabort=()=>clearTimeout(H)),(s.$fetch||globalThis.$fetch)(h.value,{signal:m.signal,...x}).finally(()=>{clearTimeout(H)})},A)}function Bl(w){var r;const n=[((r=Qt(w.method))==null?void 0:r.toUpperCase())||"GET",Qt(w.baseURL)];for(const s of[w.params||w.query]){const c=Qt(s);if(!c)continue;const h={};for(const[g,d]of Object.entries(c))h[Qt(g)]=Qt(d);n.push(h)}return n}const zl={wrapper:"w-full flex flex-col gap-2",indicator:{container:{base:"flex flex-row justify-end",width:"min-w-fit",transition:"transition-all"},align:"text-end",width:"w-fit",color:"text-gray-400 dark:text-gray-500",size:{"2xs":"text-xs",xs:"text-xs",sm:"text-sm",md:"text-sm",lg:"text-sm",xl:"text-base","2xl":"text-base"}},progress:{base:"block appearance-none border-none overflow-hidden",width:"w-full [&::-webkit-progress-bar]:w-full",size:{"2xs":"h-px",xs:"h-0.5",sm:"h-1",md:"h-2",lg:"h-3",xl:"h-4","2xl":"h-5"},rounded:"rounded-full [&::-webkit-progress-bar]:rounded-full",track:"[&::-webkit-progress-bar]:bg-gray-200 [&::-webkit-progress-bar]:dark:bg-gray-700 [@supports(selector(&::-moz-progress-bar))]:bg-gray-200 [@supports(selector(&::-moz-progress-bar))]:dark:bg-gray-700",bar:"[&::-webkit-progress-value]:rounded-full [&::-webkit-progress-value]:transition-all [&::-webkit-progress-value]:ease-in-out [&::-moz-progress-bar]:rounded-full",color:"text-{color}-500 dark:text-{color}-400",background:"[&::-webkit-progress-value]:bg-current [&::-moz-progress-bar]:bg-current",indeterminate:{base:"indeterminate:relative",rounded:"indeterminate:after:rounded-full [&:indeterminate::-webkit-progress-value]:rounded-full [&:indeterminate::-moz-progress-bar]:rounded-full"}},steps:{base:"grid grid-cols-1",color:"text-{color}-500 dark:text-{color}-400",size:{"2xs":"text-xs",xs:"text-xs",sm:"text-sm",md:"text-sm",lg:"text-sm",xl:"text-base","2xl":"text-base"}},step:{base:"transition-all opacity-0 truncate row-start-1 col-start-1",align:"text-end",active:"opacity-100",first:"text-gray-500 dark:text-gray-400"},animation:{carousel:"bar-animation-carousel","carousel-inverse":"bar-animation-carousel-inverse",swing:"bar-animation-swing",elastic:"bar-animation-elastic"},default:{color:"primary",size:"md",animation:"carousel"}},Fl={base:"relative inline-flex flex-shrink-0 border-2 border-transparent disabled:cursor-not-allowed disabled:opacity-50 focus:outline-none",rounded:"rounded-full",ring:"focus-visible:ring-2 focus-visible:ring-{color}-500 dark:focus-visible:ring-{color}-400 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:focus-visible:ring-offset-gray-900",active:"bg-{color}-500 dark:bg-{color}-400",inactive:"bg-gray-200 dark:bg-gray-700",size:{"2xs":"h-3 w-5",xs:"h-3.5 w-6",sm:"h-4 w-7",md:"h-5 w-9",lg:"h-6 w-11",xl:"h-7 w-[3.25rem]","2xl":"h-8 w-[3.75rem]"},container:{base:"pointer-events-none relative inline-block rounded-full bg-white dark:bg-gray-900 shadow transform ring-0 transition ease-in-out duration-200",active:{"2xs":"translate-x-2 rtl:-translate-x-2",xs:"translate-x-2.5 rtl:-translate-x-2.5",sm:"translate-x-3 rtl:-translate-x-3",md:"translate-x-4 rtl:-translate-x-4",lg:"translate-x-5 rtl:-translate-x-5",xl:"translate-x-6 rtl:-translate-x-6","2xl":"translate-x-7 rtl:-translate-x-7"},inactive:"translate-x-0 rtl:-translate-x-0",size:{"2xs":"h-2 w-2",xs:"h-2.5 w-2.5",sm:"h-3 w-3",md:"h-4 w-4",lg:"h-5 w-5",xl:"h-6 w-6","2xl":"h-7 w-7"}},icon:{base:"absolute inset-0 h-full w-full flex items-center justify-center transition-opacity",active:"opacity-100 ease-in duration-200",inactive:"opacity-0 ease-out duration-100",size:{"2xs":"h-2 w-2",xs:"h-2 w-2",sm:"h-2 w-2",md:"h-3 w-3",lg:"h-4 w-4",xl:"h-5 w-5","2xl":"h-6 w-6"},on:"text-{color}-500 dark:text-{color}-400",off:"text-gray-400 dark:text-gray-500",loading:"animate-spin text-{color}-500 dark:text-{color}-400"},default:{onIcon:null,offIcon:null,loadingIcon:"i-heroicons-arrow-path-20-solid",color:"primary",size:"md"}},Va=Ha("messageStore",()=>{const w=te([]),n=te(0),r=te(!0),s=te(1),c=te(15),h=Ie(),g=te(!1),d=te(null),y=te([]),T=te([]),C=te(null);return{messages:w,total:n,hasMore:r,page:s,pageSize:c,loading:g,siteConfig:d,reset:()=>{w.value=[],n.value=0,r.value=!0,s.value=1,g.value=!1},getMessages:async H=>{if(!g.value){g.value=!0;try{const R=await Tn("messages/page",H,{credentials:"include"});if(!R)return h.add({title:"获取笔记列表失败",description:"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const z=R.data.items.filter(Y=>!w.value.some(K=>K.id===Y.id));return H.page===1?w.value=R.data.items:w.value=[...w.value,...z],n.value=R.data.total,s.value=H.page,c.value=H.pageSize,r.value=w.value.length<n.value,R.data}catch(R){console.error("获取笔记列表失败:",R),h.add({title:"获取笔记列表失败",description:"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3})}finally{g.value=!1}}},deleteMessage:async H=>{try{const R=await ol(`messages/${H}`,{credentials:"include"});return!R||R.code!==1?(h.add({title:"删除笔记失败",description:R==null?void 0:R.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):(w.value=w.value.filter(z=>z.id!==H),n.value-=1,R)}catch(R){throw console.error("删除笔记失败:",R),R}},updateMessage:async(H,R)=>{try{const z=await ji(`messages/${H}`,{content:R},{credentials:"include"});if(!z||z.code!==1)return h.add({title:"更新笔记失败",description:z==null?void 0:z.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const Y=w.value.findIndex(K=>K.id===H);return Y!==-1&&(w.value[Y]=z.data),z}catch(z){throw console.error("更新笔记失败:",z),z}},getSiteConfig:async()=>{try{const H=await Hn("site/config",{credentials:"include"});return!H||H.code!==1?(h.add({title:"获取网站配置失败",description:(H==null?void 0:H.msg)||"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):(d.value=H.data,nt(),H.data)}catch(H){throw console.error("获取网站配置失败:",H),H}},updateSiteConfig:async(H,R)=>{try{const z=await ji("site/config",{[H]:R},{credentials:"include"});return!z||z.code!==1?(h.add({title:"更新配置失败",description:z==null?void 0:z.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):(d.value={...d.value,[H]:R},z.data)}catch(z){throw console.error("更新配置失败:",z),z}},tags:y,images:T,getAllTags:async()=>{try{const H=await Hn("messages/tags",{credentials:"include"});return!H||H.code!==1?(h.add({title:"获取标签列表失败",description:(H==null?void 0:H.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(y.value=H.data,H.data)}catch(H){throw console.error("获取标签列表失败:",H),H}},getMessagesByTag:async H=>{try{const R=await Hn(`messages/tags/${encodeURIComponent(H)}`,{credentials:"include"});return!R||R.code!==1?(h.add({title:"获取标签消息失败",description:(R==null?void 0:R.msg)||"请稍后重试",color:"red",timeout:2e3}),null):R.data}catch(R){throw console.error("获取标签消息失败:",R),R}},getAllImages:async()=>{try{const H=await Hn("messages/images",{credentials:"include"});return!H||H.code!==1?(h.add({title:"获取图片列表失败",description:(H==null?void 0:H.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(T.value=H.data,H.data)}catch(H){throw console.error("获取图片列表失败:",H),H}},notifyConfig:C,getNotifyConfig:async()=>{try{const H=await Hn("notify/config",{credentials:"include"});return!H||H.code!==1?(h.add({title:"获取推送配置失败",description:(H==null?void 0:H.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(C.value=H.data,H.data)}catch(H){throw console.error("获取推送配置失败:",H),H}},updateNotifyConfig:async H=>{try{const R=await ji("notify/config",H,{credentials:"include"});return!R||R.code!==1?(h.add({title:"更新推送配置失败",description:(R==null?void 0:R.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(C.value=R.data,R.data)}catch(R){throw console.error("更新推送配置失败:",R),R}},testNotify:async H=>{try{const R=await Tn(`notify/test?type=${H}`,{},{credentials:"include"});if(!R||R.code!==1)throw new Error((R==null?void 0:R.msg)||"测试失败");return R.data}catch(R){throw console.error("推送测试失败:",R),R}},createMessage:async H=>{try{const R=await Tn("messages",H,{credentials:"include"});if(!R||R.code!==1)throw new Error((R==null?void 0:R.msg)||"创建消息失败");if(H.notify)try{const z=rn().public.baseApi,Y={content:H.content,images:H.image_url?[`${z}${H.image_url}`].filter(Boolean):[],format:"markdown"},K=await Tn("notify/send",Y,{credentials:"include"});(!K||K.code!==1)&&console.warn("推送失败:",K==null?void 0:K.msg)}catch(z){console.error("消息推送失败:",z)}return h.add({title:"成功",description:"发布成功",color:"green",timeout:2e3}),R.data}catch(R){throw console.error("创建消息失败:",R),R}}}}),qa=()=>{const w=Va(),n=Ie();return{save:async h=>{try{const g=await Tn("messages",h);if(!g||g.code!==1)return console.log(g==null?void 0:g.code),n.add({title:"添加失败",description:String(g==null?void 0:g.msg),icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const d=g.data;return w.messages.unshift(d),n.add({title:"保存成功",description:"消息已保存",icon:"i-fluent-checkmark-starburst-16-filled",color:"green",timeout:1e3}),g.data}catch(g){console.error(g)}},uploadImage:async h=>{try{const g=new FormData;g.append("image",h);const d=await Tn("images/upload",g);return!d||d.code!==1?(console.log(d==null?void 0:d.code),n.add({title:"上传失败",description:String(d==null?void 0:d.msg),icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):d.data}catch(g){return console.error("上传图片错误:",g),null}},deleteMessage:async h=>{try{const g=await w.deleteMessage(h);if(g&&g.code===1)return n.add({title:"删除成功",description:"笔记已删除",icon:"i-fluent-checkmark-starburst-16-filled",color:"green",timeout:1e3}),!0}catch(g){console.error(g)}}}},ee=(w,n=1e4)=>(w=parseFloat(w+"")||0,Math.round((w+Number.EPSILON)*n)/n),rr=function(w){if(!(w&&w instanceof Element&&w.offsetParent))return!1;const n=w.scrollHeight>w.clientHeight,r=window.getComputedStyle(w).overflowY,s=r.indexOf("hidden")!==-1,c=r.indexOf("visible")!==-1;return n&&!s&&!c},hi=function(w,n=void 0){return!(!w||w===document.body||n&&w===n)&&(rr(w)?w:hi(w.parentElement,n))},At=function(w){var n=new DOMParser().parseFromString(w,"text/html").body;if(n.childElementCount>1){for(var r=document.createElement("div");n.firstChild;)r.appendChild(n.firstChild);return r}return n.firstChild},cr=w=>`${w||""}`.split(" ").filter(n=>!!n),Dt=(w,n,r)=>{w&&cr(n).forEach(s=>{w.classList.toggle(s,r||!1)})};class gn{constructor(n){Object.defineProperty(this,"pageX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pageY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"nativePointer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.nativePointer=n,this.pageX=n.pageX,this.pageY=n.pageY,this.clientX=n.clientX,this.clientY=n.clientY,this.id=self.Touch&&n instanceof Touch?n.identifier:-1,this.time=Date.now()}}const vn={passive:!1};class Ul{constructor(n,{start:r=()=>!0,move:s=()=>{},end:c=()=>{}}){Object.defineProperty(this,"element",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"startCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"moveCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"endCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"currentPointers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"startPointers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.element=n,this.startCallback=r,this.moveCallback=s,this.endCallback=c;for(const h of["onPointerStart","onTouchStart","onMove","onTouchEnd","onPointerEnd","onWindowBlur"])this[h]=this[h].bind(this);this.element.addEventListener("mousedown",this.onPointerStart,vn),this.element.addEventListener("touchstart",this.onTouchStart,vn),this.element.addEventListener("touchmove",this.onMove,vn),this.element.addEventListener("touchend",this.onTouchEnd),this.element.addEventListener("touchcancel",this.onTouchEnd)}onPointerStart(n){if(!n.buttons||n.button!==0)return;const r=new gn(n);this.currentPointers.some(s=>s.id===r.id)||this.triggerPointerStart(r,n)&&(window.addEventListener("mousemove",this.onMove),window.addEventListener("mouseup",this.onPointerEnd),window.addEventListener("blur",this.onWindowBlur))}onTouchStart(n){for(const r of Array.from(n.changedTouches||[]))this.triggerPointerStart(new gn(r),n);window.addEventListener("blur",this.onWindowBlur)}onMove(n){const r=this.currentPointers.slice(),s="changedTouches"in n?Array.from(n.changedTouches||[]).map(h=>new gn(h)):[new gn(n)],c=[];for(const h of s){const g=this.currentPointers.findIndex(d=>d.id===h.id);g<0||(c.push(h),this.currentPointers[g]=h)}c.length&&this.moveCallback(n,this.currentPointers.slice(),r)}onPointerEnd(n){n.buttons>0&&n.button!==0||(this.triggerPointerEnd(n,new gn(n)),window.removeEventListener("mousemove",this.onMove),window.removeEventListener("mouseup",this.onPointerEnd),window.removeEventListener("blur",this.onWindowBlur))}onTouchEnd(n){for(const r of Array.from(n.changedTouches||[]))this.triggerPointerEnd(n,new gn(r))}triggerPointerStart(n,r){return!!this.startCallback(r,n,this.currentPointers.slice())&&(this.currentPointers.push(n),this.startPointers.push(n),!0)}triggerPointerEnd(n,r){const s=this.currentPointers.findIndex(c=>c.id===r.id);s<0||(this.currentPointers.splice(s,1),this.startPointers.splice(s,1),this.endCallback(n,r,this.currentPointers.slice()))}onWindowBlur(){this.clear()}clear(){for(;this.currentPointers.length;){const n=this.currentPointers[this.currentPointers.length-1];this.currentPointers.splice(this.currentPointers.length-1,1),this.startPointers.splice(this.currentPointers.length-1,1),this.endCallback(new Event("touchend",{bubbles:!0,cancelable:!0,clientX:n.clientX,clientY:n.clientY}),n,this.currentPointers.slice())}}stop(){this.element.removeEventListener("mousedown",this.onPointerStart,vn),this.element.removeEventListener("touchstart",this.onTouchStart,vn),this.element.removeEventListener("touchmove",this.onMove,vn),this.element.removeEventListener("touchend",this.onTouchEnd),this.element.removeEventListener("touchcancel",this.onTouchEnd),window.removeEventListener("mousemove",this.onMove),window.removeEventListener("mouseup",this.onPointerEnd),window.removeEventListener("blur",this.onWindowBlur)}}function ia(w,n){return n?Math.sqrt(Math.pow(n.clientX-w.clientX,2)+Math.pow(n.clientY-w.clientY,2)):0}function ra(w,n){return n?{clientX:(w.clientX+n.clientX)/2,clientY:(w.clientY+n.clientY)/2}:w}const ar=w=>typeof w=="object"&&w!==null&&w.constructor===Object&&Object.prototype.toString.call(w)==="[object Object]",ht=(w,...n)=>{const r=n.length;for(let s=0;s<r;s++){const c=n[s]||{};Object.entries(c).forEach(([h,g])=>{const d=Array.isArray(g)?[]:{};w[h]||Object.assign(w,{[h]:d}),ar(g)?Object.assign(w[h],ht(d,g)):Array.isArray(g)?Object.assign(w,{[h]:[...g]}):Object.assign(w,{[h]:g})})}return w},Fi=function(w,n){return w.split(".").reduce((r,s)=>typeof r=="object"?r[s]:void 0,n)};class pi{constructor(n={}){Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),this.setOptions(n);for(const r of Object.getOwnPropertyNames(Object.getPrototypeOf(this)))r.startsWith("on")&&typeof this[r]=="function"&&(this[r]=this[r].bind(this))}setOptions(n){this.options=n?ht({},this.constructor.defaults,n):{};for(const[r,s]of Object.entries(this.option("on")||{}))this.on(r,s)}option(n,...r){let s=Fi(n,this.options);return s&&typeof s=="function"&&(s=s.call(this,this,...r)),s}optionFor(n,r,s,...c){let h=Fi(r,n);var g;typeof(g=h)!="string"||isNaN(g)||isNaN(parseFloat(g))||(h=parseFloat(h)),h==="true"&&(h=!0),h==="false"&&(h=!1),h&&typeof h=="function"&&(h=h.call(this,this,n,...c));let d=Fi(r,this.options);return d&&typeof d=="function"?h=d.call(this,this,n,...c,h):h===void 0&&(h=d),h===void 0?s:h}cn(n){const r=this.options.classes;return r&&r[n]||""}localize(n,r=[]){n=String(n).replace(/\{\{(\w+).?(\w+)?\}\}/g,(s,c,h)=>{let g="";return h?g=this.option(`${c[0]+c.toLowerCase().substring(1)}.l10n.${h}`):c&&(g=this.option(`l10n.${c}`)),g||(g=s),g});for(let s=0;s<r.length;s++)n=n.split(r[s][0]).join(r[s][1]);return n=n.replace(/\{\{(.*?)\}\}/g,(s,c)=>c)}on(n,r){let s=[];typeof n=="string"?s=n.split(" "):Array.isArray(n)&&(s=n),this.events||(this.events=new Map),s.forEach(c=>{let h=this.events.get(c);h||(this.events.set(c,[]),h=[]),h.includes(r)||h.push(r),this.events.set(c,h)})}off(n,r){let s=[];typeof n=="string"?s=n.split(" "):Array.isArray(n)&&(s=n),s.forEach(c=>{const h=this.events.get(c);if(Array.isArray(h)){const g=h.indexOf(r);g>-1&&h.splice(g,1)}})}emit(n,...r){[...this.events.get(n)||[]].forEach(s=>s(this,...r)),n!=="*"&&this.emit("*",n,...r)}}Object.defineProperty(pi,"version",{enumerable:!0,configurable:!0,writable:!0,value:"5.0.36"}),Object.defineProperty(pi,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{}});class ur extends pi{constructor(n={}){super(n),Object.defineProperty(this,"plugins",{enumerable:!0,configurable:!0,writable:!0,value:{}})}attachPlugins(n={}){const r=new Map;for(const[s,c]of Object.entries(n)){const h=this.option(s),g=this.plugins[s];g||h===!1?g&&h===!1&&(g.detach(),delete this.plugins[s]):r.set(s,new c(this,h||{}))}for(const[s,c]of r)this.plugins[s]=c,c.attach()}detachPlugins(n){n=n||Object.keys(this.plugins);for(const r of n){const s=this.plugins[r];s&&s.detach(),delete this.plugins[r]}return this.emit("detachPlugins"),this}}var Oe;(function(w){w[w.Init=0]="Init",w[w.Error=1]="Error",w[w.Ready=2]="Ready",w[w.Panning=3]="Panning",w[w.Mousemove=4]="Mousemove",w[w.Destroy=5]="Destroy"})(Oe||(Oe={}));const It=["a","b","c","d","e","f"],Wa={PANUP:"Move up",PANDOWN:"Move down",PANLEFT:"Move left",PANRIGHT:"Move right",ZOOMIN:"Zoom in",ZOOMOUT:"Zoom out",TOGGLEZOOM:"Toggle zoom level",TOGGLE1TO1:"Toggle zoom level",ITERATEZOOM:"Toggle zoom level",ROTATECCW:"Rotate counterclockwise",ROTATECW:"Rotate clockwise",FLIPX:"Flip horizontally",FLIPY:"Flip vertically",FITX:"Fit horizontally",FITY:"Fit vertically",RESET:"Reset",TOGGLEFS:"Toggle fullscreen"},$l={content:null,width:"auto",height:"auto",panMode:"drag",touch:!0,dragMinThreshold:3,lockAxis:!1,mouseMoveFactor:1,mouseMoveFriction:.12,zoom:!0,pinchToZoom:!0,panOnlyZoomed:"auto",minScale:1,maxScale:2,friction:.25,dragFriction:.35,decelFriction:.05,click:"toggleZoom",dblClick:!1,wheel:"zoom",wheelLimit:7,spinner:!0,bounds:"auto",infinite:!1,rubberband:!0,bounce:!0,maxVelocity:75,transformParent:!1,classes:{content:"f-panzoom__content",isLoading:"is-loading",canZoomIn:"can-zoom_in",canZoomOut:"can-zoom_out",isDraggable:"is-draggable",isDragging:"is-dragging",inFullscreen:"in-fullscreen",htmlHasFullscreen:"with-panzoom-in-fullscreen"},l10n:Wa},aa='<circle cx="25" cy="25" r="20"></circle>',dr='<div class="f-spinner"><svg viewBox="0 0 50 50">'+aa+aa+"</svg></div>",ft=w=>w&&w!==null&&w instanceof Element&&"nodeType"in w,De=(w,n)=>{w&&cr(n).forEach(r=>{w.classList.remove(r)})},de=(w,n)=>{w&&cr(n).forEach(r=>{w.classList.add(r)})},Xn={a:1,b:0,c:0,d:1,e:0,f:0},Vl=1e5,Jn=1e4,yt="mousemove",oa="drag",sa="content",bt="auto";let Ui=null,$i=null;class on extends ur{get fits(){return this.contentRect.width-this.contentRect.fitWidth<1&&this.contentRect.height-this.contentRect.fitHeight<1}get isTouchDevice(){return $i===null&&($i=window.matchMedia("(hover: none)").matches),$i}get isMobile(){return Ui===null&&(Ui=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)),Ui}get panMode(){return this.options.panMode!==yt||this.isTouchDevice?oa:yt}get panOnlyZoomed(){const n=this.options.panOnlyZoomed;return n===bt?this.isTouchDevice:n}get isInfinite(){return this.option("infinite")}get angle(){return 180*Math.atan2(this.current.b,this.current.a)/Math.PI||0}get targetAngle(){return 180*Math.atan2(this.target.b,this.target.a)/Math.PI||0}get scale(){const{a:n,b:r}=this.current;return Math.sqrt(n*n+r*r)||1}get targetScale(){const{a:n,b:r}=this.target;return Math.sqrt(n*n+r*r)||1}get minScale(){return this.option("minScale")||1}get fullScale(){const{contentRect:n}=this;return n.fullWidth/n.fitWidth||1}get maxScale(){return this.fullScale*(this.option("maxScale")||1)||1}get coverScale(){const{containerRect:n,contentRect:r}=this,s=Math.max(n.height/r.fitHeight,n.width/r.fitWidth)||1;return Math.min(this.fullScale,s)}get isScaling(){return Math.abs(this.targetScale-this.scale)>1e-5&&!this.isResting}get isContentLoading(){const n=this.content;return!!(n&&n instanceof HTMLImageElement)&&!n.complete}get isResting(){if(this.isBouncingX||this.isBouncingY)return!1;for(const n of It){const r=n=="e"||n==="f"?1e-4:1e-5;if(Math.abs(this.target[n]-this.current[n])>r)return!1}return!(!this.ignoreBounds&&!this.checkBounds().inBounds)}constructor(n,r={},s={}){var c;if(super(r),Object.defineProperty(this,"pointerTracker",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"resizeObserver",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"updateTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"clickTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"rAF",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"isTicking",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreBounds",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isBouncingX",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isBouncingY",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"clicks",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"trackingPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"pwt",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"cwd",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"pmme",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"friction",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:Oe.Init}),Object.defineProperty(this,"isDragging",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"spinner",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"containerRect",{enumerable:!0,configurable:!0,writable:!0,value:{width:0,height:0,innerWidth:0,innerHeight:0}}),Object.defineProperty(this,"contentRect",{enumerable:!0,configurable:!0,writable:!0,value:{top:0,right:0,bottom:0,left:0,fullWidth:0,fullHeight:0,fitWidth:0,fitHeight:0,width:0,height:0}}),Object.defineProperty(this,"dragStart",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0,top:0,left:0,time:0}}),Object.defineProperty(this,"dragOffset",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0,time:0}}),Object.defineProperty(this,"current",{enumerable:!0,configurable:!0,writable:!0,value:Object.assign({},Xn)}),Object.defineProperty(this,"target",{enumerable:!0,configurable:!0,writable:!0,value:Object.assign({},Xn)}),Object.defineProperty(this,"velocity",{enumerable:!0,configurable:!0,writable:!0,value:{a:0,b:0,c:0,d:0,e:0,f:0}}),Object.defineProperty(this,"lockedAxis",{enumerable:!0,configurable:!0,writable:!0,value:!1}),!n)throw new Error("Container Element Not Found");this.container=n,this.initContent(),this.attachPlugins(Object.assign(Object.assign({},on.Plugins),s)),this.emit("attachPlugins"),this.emit("init");const h=this.content;if(h.addEventListener("load",this.onLoad),h.addEventListener("error",this.onError),this.isContentLoading){if(this.option("spinner")){n.classList.add(this.cn("isLoading"));const g=At(dr);!n.contains(h)||h.parentElement instanceof HTMLPictureElement?this.spinner=n.appendChild(g):this.spinner=((c=h.parentElement)===null||c===void 0?void 0:c.insertBefore(g,h))||null}this.emit("beforeLoad")}else queueMicrotask(()=>{this.enable()})}initContent(){const{container:n}=this,r=this.cn(sa);let s=this.option(sa)||n.querySelector(`.${r}`);if(s||(s=n.querySelector("img,picture")||n.firstElementChild,s&&de(s,r)),s instanceof HTMLPictureElement&&(s=s.querySelector("img")),!s)throw new Error("No content found");this.content=s}onLoad(){const{spinner:n,container:r,state:s}=this;n&&(n.remove(),this.spinner=null),this.option("spinner")&&r.classList.remove(this.cn("isLoading")),this.emit("afterLoad"),s===Oe.Init?this.enable():this.updateMetrics()}onError(){this.state!==Oe.Destroy&&(this.spinner&&(this.spinner.remove(),this.spinner=null),this.stop(),this.detachEvents(),this.state=Oe.Error,this.emit("error"))}getNextScale(n){const{fullScale:r,targetScale:s,coverScale:c,maxScale:h,minScale:g}=this;let d=g;switch(n){case"toggleMax":d=s-g<.5*(h-g)?h:g;break;case"toggleCover":d=s-g<.5*(c-g)?c:g;break;case"toggleZoom":d=s-g<.5*(r-g)?r:g;break;case"iterateZoom":let y=[1,r,h].sort((C,f)=>C-f),T=y.findIndex(C=>C>s+1e-5);d=y[T]||1}return d}attachObserver(){var n;const r=()=>{const{container:s,containerRect:c}=this;return Math.abs(c.width-s.getBoundingClientRect().width)>.1||Math.abs(c.height-s.getBoundingClientRect().height)>.1};this.resizeObserver||window.ResizeObserver===void 0||(this.resizeObserver=new ResizeObserver(()=>{this.updateTimer||(r()?(this.onResize(),this.isMobile&&(this.updateTimer=setTimeout(()=>{r()&&this.onResize(),this.updateTimer=null},500))):this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null))})),(n=this.resizeObserver)===null||n===void 0||n.observe(this.container)}detachObserver(){var n;(n=this.resizeObserver)===null||n===void 0||n.disconnect()}attachEvents(){const{container:n}=this;n.addEventListener("click",this.onClick,{passive:!1,capture:!1}),n.addEventListener("wheel",this.onWheel,{passive:!1}),this.pointerTracker=new Ul(n,{start:this.onPointerDown,move:this.onPointerMove,end:this.onPointerUp}),document.addEventListener(yt,this.onMouseMove)}detachEvents(){var n;const{container:r}=this;r.removeEventListener("click",this.onClick,{passive:!1,capture:!1}),r.removeEventListener("wheel",this.onWheel,{passive:!1}),(n=this.pointerTracker)===null||n===void 0||n.stop(),this.pointerTracker=null,document.removeEventListener(yt,this.onMouseMove),document.removeEventListener("keydown",this.onKeydown,!0),this.clickTimer&&(clearTimeout(this.clickTimer),this.clickTimer=null),this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null)}animate(){this.setTargetForce();const n=this.friction,r=this.option("maxVelocity");for(const s of It)n?(this.velocity[s]*=1-n,r&&!this.isScaling&&(this.velocity[s]=Math.max(Math.min(this.velocity[s],r),-1*r)),this.current[s]+=this.velocity[s]):this.current[s]=this.target[s];this.setTransform(),this.setEdgeForce(),!this.isResting||this.isDragging?this.rAF=requestAnimationFrame(()=>this.animate()):this.stop("current")}setTargetForce(){for(const n of It)n==="e"&&this.isBouncingX||n==="f"&&this.isBouncingY||(this.velocity[n]=(1/(1-this.friction)-1)*(this.target[n]-this.current[n]))}checkBounds(n=0,r=0){const{current:s}=this,c=s.e+n,h=s.f+r,g=this.getBounds(),{x:d,y}=g,T=d.min,C=d.max,f=y.min,u=y.max;let p=0,v=0;return T!==1/0&&c<T?p=T-c:C!==1/0&&c>C&&(p=C-c),f!==1/0&&h<f?v=f-h:u!==1/0&&h>u&&(v=u-h),Math.abs(p)<1e-4&&(p=0),Math.abs(v)<1e-4&&(v=0),Object.assign(Object.assign({},g),{xDiff:p,yDiff:v,inBounds:!p&&!v})}clampTargetBounds(){const{target:n}=this,{x:r,y:s}=this.getBounds();r.min!==1/0&&(n.e=Math.max(n.e,r.min)),r.max!==1/0&&(n.e=Math.min(n.e,r.max)),s.min!==1/0&&(n.f=Math.max(n.f,s.min)),s.max!==1/0&&(n.f=Math.min(n.f,s.max))}calculateContentDim(n=this.current){const{content:r,contentRect:s}=this,{fitWidth:c,fitHeight:h,fullWidth:g,fullHeight:d}=s;let y=g,T=d;if(this.option("zoom")||this.angle!==0){const C=!(r instanceof HTMLImageElement)&&(window.getComputedStyle(r).maxWidth==="none"||window.getComputedStyle(r).maxHeight==="none"),f=C?g:c,u=C?d:h,p=this.getMatrix(n),v=new DOMPoint(0,0).matrixTransform(p),E=new DOMPoint(0+f,0).matrixTransform(p),b=new DOMPoint(0+f,0+u).matrixTransform(p),k=new DOMPoint(0,0+u).matrixTransform(p),M=Math.abs(b.x-v.x),x=Math.abs(b.y-v.y),A=Math.abs(k.x-E.x),m=Math.abs(k.y-E.y);y=Math.max(M,A),T=Math.max(x,m)}return{contentWidth:y,contentHeight:T}}setEdgeForce(){if(this.ignoreBounds||this.isDragging||this.panMode===yt||this.targetScale<this.scale)return this.isBouncingX=!1,void(this.isBouncingY=!1);const{target:n}=this,{x:r,y:s,xDiff:c,yDiff:h}=this.checkBounds(),g=this.option("maxVelocity");let d=this.velocity.e,y=this.velocity.f;c!==0?(this.isBouncingX=!0,c*d<=0?d+=.14*c:(d=.14*c,r.min!==1/0&&(this.target.e=Math.max(n.e,r.min)),r.max!==1/0&&(this.target.e=Math.min(n.e,r.max))),g&&(d=Math.max(Math.min(d,g),-1*g))):this.isBouncingX=!1,h!==0?(this.isBouncingY=!0,h*y<=0?y+=.14*h:(y=.14*h,s.min!==1/0&&(this.target.f=Math.max(n.f,s.min)),s.max!==1/0&&(this.target.f=Math.min(n.f,s.max))),g&&(y=Math.max(Math.min(y,g),-1*g))):this.isBouncingY=!1,this.isBouncingX&&(this.velocity.e=d),this.isBouncingY&&(this.velocity.f=y)}enable(){const{content:n}=this,r=new DOMMatrixReadOnly(window.getComputedStyle(n).transform);for(const s of It)this.current[s]=this.target[s]=r[s];this.updateMetrics(),this.attachObserver(),this.attachEvents(),this.state=Oe.Ready,this.emit("ready")}onClick(n){var r;n.type==="click"&&n.detail===0&&(this.dragOffset.x=0,this.dragOffset.y=0),this.isDragging&&((r=this.pointerTracker)===null||r===void 0||r.clear(),this.trackingPoints=[],this.startDecelAnim());const s=n.target;if(!s||n.defaultPrevented)return;if(s.hasAttribute("disabled"))return n.preventDefault(),void n.stopPropagation();if((()=>{const p=window.getSelection();return p&&p.type==="Range"})()&&!s.closest("button"))return;const c=s.closest("[data-panzoom-action]"),h=s.closest("[data-panzoom-change]"),g=c||h,d=g&&ft(g)?g.dataset:null;if(d){const p=d.panzoomChange,v=d.panzoomAction;if((p||v)&&n.preventDefault(),p){let E={};try{E=JSON.parse(p)}catch{console&&console.warn("The given data was not valid JSON")}return void this.applyChange(E)}if(v)return void(this[v]&&this[v]())}if(Math.abs(this.dragOffset.x)>3||Math.abs(this.dragOffset.y)>3)return n.preventDefault(),void n.stopPropagation();if(s.closest("[data-fancybox]"))return;const y=this.content.getBoundingClientRect(),T=this.dragStart;if(T.time&&!this.canZoomOut()&&(Math.abs(y.x-T.x)>2||Math.abs(y.y-T.y)>2))return;this.dragStart.time=0;const C=p=>{this.option("zoom",n)&&p&&typeof p=="string"&&/(iterateZoom)|(toggle(Zoom|Full|Cover|Max)|(zoomTo(Fit|Cover|Max)))/.test(p)&&typeof this[p]=="function"&&(n.preventDefault(),this[p]({event:n}))},f=this.option("click",n),u=this.option("dblClick",n);u?(this.clicks++,this.clicks==1&&(this.clickTimer=setTimeout(()=>{this.clicks===1?(this.emit("click",n),!n.defaultPrevented&&f&&C(f)):(this.emit("dblClick",n),n.defaultPrevented||C(u)),this.clicks=0,this.clickTimer=null},350))):(this.emit("click",n),!n.defaultPrevented&&f&&C(f))}addTrackingPoint(n){const r=this.trackingPoints.filter(s=>s.time>Date.now()-100);r.push(n),this.trackingPoints=r}onPointerDown(n,r,s){var c;if(this.option("touch",n)===!1)return!1;this.pwt=0,this.dragOffset={x:0,y:0,time:0},this.trackingPoints=[];const h=this.content.getBoundingClientRect();if(this.dragStart={x:h.x,y:h.y,top:h.top,left:h.left,time:Date.now()},this.clickTimer)return!1;if(this.panMode===yt&&this.targetScale>1)return n.preventDefault(),n.stopPropagation(),!1;const g=n.composedPath()[0];if(!s.length){if(["TEXTAREA","OPTION","INPUT","SELECT","VIDEO","IFRAME"].includes(g.nodeName)||g.closest("[contenteditable],[data-selectable],[data-draggable],[data-clickable],[data-panzoom-change],[data-panzoom-action]"))return!1;(c=window.getSelection())===null||c===void 0||c.removeAllRanges()}if(n.type==="mousedown")["A","BUTTON"].includes(g.nodeName)||n.preventDefault();else if(Math.abs(this.velocity.a)>.3)return!1;return this.target.e=this.current.e,this.target.f=this.current.f,this.stop(),this.isDragging||(this.isDragging=!0,this.addTrackingPoint(r),this.emit("touchStart",n)),!0}onPointerMove(n,r,s){if(this.option("touch",n)===!1||!this.isDragging||r.length<2&&this.panOnlyZoomed&&ee(this.targetScale)<=ee(this.minScale)||(this.emit("touchMove",n),n.defaultPrevented))return;this.addTrackingPoint(r[0]);const{content:c}=this,h=ra(s[0],s[1]),g=ra(r[0],r[1]);let d=0,y=0;if(r.length>1){const x=c.getBoundingClientRect();d=h.clientX-x.left-.5*x.width,y=h.clientY-x.top-.5*x.height}const T=ia(s[0],s[1]),C=ia(r[0],r[1]);let f=T?C/T:1,u=g.clientX-h.clientX,p=g.clientY-h.clientY;this.dragOffset.x+=u,this.dragOffset.y+=p,this.dragOffset.time=Date.now()-this.dragStart.time;let v=ee(this.targetScale)===ee(this.minScale)&&this.option("lockAxis");if(v&&!this.lockedAxis)if(v==="xy"||v==="y"||n.type==="touchmove"){if(Math.abs(this.dragOffset.x)<6&&Math.abs(this.dragOffset.y)<6)return void n.preventDefault();const x=Math.abs(180*Math.atan2(this.dragOffset.y,this.dragOffset.x)/Math.PI);this.lockedAxis=x>45&&x<135?"y":"x",this.dragOffset.x=0,this.dragOffset.y=0,u=0,p=0}else this.lockedAxis=v;if(hi(n.target,this.content)&&(v="x",this.dragOffset.y=0),v&&v!=="xy"&&this.lockedAxis!==v&&ee(this.targetScale)===ee(this.minScale))return;n.cancelable&&n.preventDefault(),this.container.classList.add(this.cn("isDragging"));const E=this.checkBounds(u,p);this.option("rubberband")?(this.isInfinite!=="x"&&(E.xDiff>0&&u<0||E.xDiff<0&&u>0)&&(u*=Math.max(0,.5-Math.abs(.75/this.contentRect.fitWidth*E.xDiff))),this.isInfinite!=="y"&&(E.yDiff>0&&p<0||E.yDiff<0&&p>0)&&(p*=Math.max(0,.5-Math.abs(.75/this.contentRect.fitHeight*E.yDiff)))):(E.xDiff&&(u=0),E.yDiff&&(p=0));const b=this.targetScale,k=this.minScale,M=this.maxScale;b<.5*k&&(f=Math.max(f,k)),b>1.5*M&&(f=Math.min(f,M)),this.lockedAxis==="y"&&ee(b)===ee(k)&&(u=0),this.lockedAxis==="x"&&ee(b)===ee(k)&&(p=0),this.applyChange({originX:d,originY:y,panX:u,panY:p,scale:f,friction:this.option("dragFriction"),ignoreBounds:!0})}onPointerUp(n,r,s){if(s.length)return this.dragOffset.x=0,this.dragOffset.y=0,void(this.trackingPoints=[]);this.container.classList.remove(this.cn("isDragging")),this.isDragging&&(this.addTrackingPoint(r),this.panOnlyZoomed&&this.contentRect.width-this.contentRect.fitWidth<1&&this.contentRect.height-this.contentRect.fitHeight<1&&(this.trackingPoints=[]),hi(n.target,this.content)&&this.lockedAxis==="y"&&(this.trackingPoints=[]),this.emit("touchEnd",n),this.isDragging=!1,this.lockedAxis=!1,this.state!==Oe.Destroy&&(n.defaultPrevented||this.startDecelAnim()))}startDecelAnim(){var n;const r=this.isScaling;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.isBouncingX=!1,this.isBouncingY=!1;for(const x of It)this.velocity[x]=0;this.target.e=this.current.e,this.target.f=this.current.f,De(this.container,"is-scaling"),De(this.container,"is-animating"),this.isTicking=!1;const{trackingPoints:s}=this,c=s[0],h=s[s.length-1];let g=0,d=0,y=0;h&&c&&(g=h.clientX-c.clientX,d=h.clientY-c.clientY,y=h.time-c.time);const T=((n=window.visualViewport)===null||n===void 0?void 0:n.scale)||1;T!==1&&(g*=T,d*=T);let C=0,f=0,u=0,p=0,v=this.option("decelFriction");const E=this.targetScale;if(y>0){u=Math.abs(g)>3?g/(y/30):0,p=Math.abs(d)>3?d/(y/30):0;const x=this.option("maxVelocity");x&&(u=Math.max(Math.min(u,x),-1*x),p=Math.max(Math.min(p,x),-1*x))}u&&(C=u/(1/(1-v)-1)),p&&(f=p/(1/(1-v)-1)),(this.option("lockAxis")==="y"||this.option("lockAxis")==="xy"&&this.lockedAxis==="y"&&ee(E)===this.minScale)&&(C=u=0),(this.option("lockAxis")==="x"||this.option("lockAxis")==="xy"&&this.lockedAxis==="x"&&ee(E)===this.minScale)&&(f=p=0);const b=this.dragOffset.x,k=this.dragOffset.y,M=this.option("dragMinThreshold")||0;Math.abs(b)<M&&Math.abs(k)<M&&(C=f=0,u=p=0),(this.option("zoom")&&(E<this.minScale-1e-5||E>this.maxScale+1e-5)||r&&!C&&!f)&&(v=.35),this.applyChange({panX:C,panY:f,friction:v}),this.emit("decel",u,p,b,k)}onWheel(n){var r=[-n.deltaX||0,-n.deltaY||0,-n.detail||0].reduce(function(h,g){return Math.abs(g)>Math.abs(h)?g:h});const s=Math.max(-1,Math.min(1,r));if(this.emit("wheel",n,s),this.panMode===yt||n.defaultPrevented)return;const c=this.option("wheel");c==="pan"?(n.preventDefault(),this.panOnlyZoomed&&!this.canZoomOut()||this.applyChange({panX:2*-n.deltaX,panY:2*-n.deltaY,bounce:!1})):c==="zoom"&&this.option("zoom")!==!1&&this.zoomWithWheel(n)}onMouseMove(n){this.panWithMouse(n)}onKeydown(n){n.key==="Escape"&&this.toggleFS()}onResize(){this.updateMetrics(),this.checkBounds().inBounds||this.requestTick()}setTransform(){this.emit("beforeTransform");const{current:n,target:r,content:s,contentRect:c}=this,h=Object.assign({},Xn);for(const b of It){const k=b=="e"||b==="f"?Jn:Vl;h[b]=ee(n[b],k),Math.abs(r[b]-n[b])<(b=="e"||b==="f"?.51:.001)&&(n[b]=r[b])}let{a:g,b:d,c:y,d:T,e:C,f}=h,u=`matrix(${g}, ${d}, ${y}, ${T}, ${C}, ${f})`,p=s.parentElement instanceof HTMLPictureElement?s.parentElement:s;if(this.option("transformParent")&&(p=p.parentElement||p),p.style.transform===u)return;p.style.transform=u;const{contentWidth:v,contentHeight:E}=this.calculateContentDim();c.width=v,c.height=E,this.emit("afterTransform")}updateMetrics(n=!1){var r;if(!this||this.state===Oe.Destroy||this.isContentLoading)return;const s=Math.max(1,((r=window.visualViewport)===null||r===void 0?void 0:r.scale)||1),{container:c,content:h}=this,g=h instanceof HTMLImageElement,d=c.getBoundingClientRect(),y=getComputedStyle(this.container);let T=d.width*s,C=d.height*s;const f=parseFloat(y.paddingTop)+parseFloat(y.paddingBottom),u=T-(parseFloat(y.paddingLeft)+parseFloat(y.paddingRight)),p=C-f;this.containerRect={width:T,height:C,innerWidth:u,innerHeight:p};const v=parseFloat(h.dataset.width||"")||(re=>{let pe=0;return pe=re instanceof HTMLImageElement?re.naturalWidth:re instanceof SVGElement?re.width.baseVal.value:Math.max(re.offsetWidth,re.scrollWidth),pe||0})(h),E=parseFloat(h.dataset.height||"")||(re=>{let pe=0;return pe=re instanceof HTMLImageElement?re.naturalHeight:re instanceof SVGElement?re.height.baseVal.value:Math.max(re.offsetHeight,re.scrollHeight),pe||0})(h);let b=this.option("width",v)||bt,k=this.option("height",E)||bt;const M=b===bt,x=k===bt;typeof b!="number"&&(b=v),typeof k!="number"&&(k=E),M&&(b=v*(k/E)),x&&(k=E/(v/b));let A=h.parentElement instanceof HTMLPictureElement?h.parentElement:h;this.option("transformParent")&&(A=A.parentElement||A);const m=A.getAttribute("style")||"";A.style.setProperty("transform","none","important"),g&&(A.style.width="",A.style.height=""),A.offsetHeight;const O=h.getBoundingClientRect();let N=O.width*s,H=O.height*s,R=N,z=H;N=Math.min(N,b),H=Math.min(H,k),g?{width:N,height:H}=((re,pe,we,ge)=>{const ie=we/re,fe=ge/pe,Ae=Math.min(ie,fe);return{width:re*=Ae,height:pe*=Ae}})(b,k,N,H):(N=Math.min(N,b),H=Math.min(H,k));let Y=.5*(z-H),K=.5*(R-N);this.contentRect=Object.assign(Object.assign({},this.contentRect),{top:O.top-d.top+Y,bottom:d.bottom-O.bottom+Y,left:O.left-d.left+K,right:d.right-O.right+K,fitWidth:N,fitHeight:H,width:N,height:H,fullWidth:b,fullHeight:k}),A.style.cssText=m,g&&(A.style.width=`${N}px`,A.style.height=`${H}px`),this.setTransform(),n!==!0&&this.emit("refresh"),this.ignoreBounds||(ee(this.targetScale)<ee(this.minScale)?this.zoomTo(this.minScale,{friction:0}):this.targetScale>this.maxScale?this.zoomTo(this.maxScale,{friction:0}):this.state===Oe.Init||this.checkBounds().inBounds||this.requestTick()),this.updateControls()}calculateBounds(){const{contentWidth:n,contentHeight:r}=this.calculateContentDim(this.target),{targetScale:s,lockedAxis:c}=this,{fitWidth:h,fitHeight:g}=this.contentRect;let d=0,y=0,T=0,C=0;const f=this.option("infinite");if(f===!0||c&&f===c)d=-1/0,T=1/0,y=-1/0,C=1/0;else{let{containerRect:u,contentRect:p}=this,v=ee(h*s,Jn),E=ee(g*s,Jn),{innerWidth:b,innerHeight:k}=u;if(u.width===v&&(b=u.width),u.width===E&&(k=u.height),n>b){T=.5*(n-b),d=-1*T;let M=.5*(p.right-p.left);d+=M,T+=M}if(h>b&&n<b&&(d-=.5*(h-b),T-=.5*(h-b)),r>k){C=.5*(r-k),y=-1*C;let M=.5*(p.bottom-p.top);y+=M,C+=M}g>k&&r<k&&(d-=.5*(g-k),T-=.5*(g-k))}return{x:{min:d,max:T},y:{min:y,max:C}}}getBounds(){const n=this.option("bounds");return n!==bt?n:this.calculateBounds()}updateControls(){const n=this,r=n.container,{panMode:s,contentRect:c,targetScale:h,minScale:g}=n;let d=g,y=n.option("click")||!1;y&&(d=n.getNextScale(y));let T=n.canZoomIn(),C=n.canZoomOut(),f=s===oa&&!!this.option("touch"),u=C&&f;if(f&&(ee(h)<ee(g)&&!this.panOnlyZoomed&&(u=!0),(ee(c.width,1)>ee(c.fitWidth,1)||ee(c.height,1)>ee(c.fitHeight,1))&&(u=!0)),ee(c.width*h,1)<ee(c.fitWidth,1)&&(u=!1),s===yt&&(u=!1),Dt(r,this.cn("isDraggable"),u),!this.option("zoom"))return;let p=T&&ee(d)>ee(h),v=!p&&!u&&C&&ee(d)<ee(h);Dt(r,this.cn("canZoomIn"),p),Dt(r,this.cn("canZoomOut"),v);for(const E of r.querySelectorAll("[data-panzoom-action]")){let b=!1,k=!1;switch(E.dataset.panzoomAction){case"zoomIn":T?b=!0:k=!0;break;case"zoomOut":C?b=!0:k=!0;break;case"toggleZoom":case"iterateZoom":T||C?b=!0:k=!0;const M=E.querySelector("g");M&&(M.style.display=T?"":"none")}b?(E.removeAttribute("disabled"),E.removeAttribute("tabindex")):k&&(E.setAttribute("disabled",""),E.setAttribute("tabindex","-1"))}}panTo({x:n=this.target.e,y:r=this.target.f,scale:s=this.targetScale,friction:c=this.option("friction"),angle:h=0,originX:g=0,originY:d=0,flipX:y=!1,flipY:T=!1,ignoreBounds:C=!1}){this.state!==Oe.Destroy&&this.applyChange({panX:n-this.target.e,panY:r-this.target.f,scale:s/this.targetScale,angle:h,originX:g,originY:d,friction:c,flipX:y,flipY:T,ignoreBounds:C})}applyChange({panX:n=0,panY:r=0,scale:s=1,angle:c=0,originX:h=-this.current.e,originY:g=-this.current.f,friction:d=this.option("friction"),flipX:y=!1,flipY:T=!1,ignoreBounds:C=!1,bounce:f=this.option("bounce")}){const u=this.state;if(u===Oe.Destroy)return;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.friction=d||0,this.ignoreBounds=C;const{current:p}=this,v=p.e,E=p.f,b=this.getMatrix(this.target);let k=new DOMMatrix().translate(v,E).translate(h,g).translate(n,r);if(this.option("zoom")){if(!C){const M=this.targetScale,x=this.minScale,A=this.maxScale;M*s<x&&(s=x/M),M*s>A&&(s=A/M)}k=k.scale(s)}k=k.translate(-h,-g).translate(-v,-E).multiply(b),c&&(k=k.rotate(c)),y&&(k=k.scale(-1,1)),T&&(k=k.scale(1,-1));for(const M of It)M!=="e"&&M!=="f"&&(k[M]>this.minScale+1e-5||k[M]<this.minScale-1e-5)?this.target[M]=k[M]:this.target[M]=ee(k[M],Jn);(this.targetScale<this.scale||Math.abs(s-1)>.1||this.panMode===yt||f===!1)&&!C&&this.clampTargetBounds(),u===Oe.Init?this.animate():this.isResting||(this.state=Oe.Panning,this.requestTick())}stop(n=!1){if(this.state===Oe.Init||this.state===Oe.Destroy)return;const r=this.isTicking;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.isBouncingX=!1,this.isBouncingY=!1;for(const s of It)this.velocity[s]=0,n==="current"?this.current[s]=this.target[s]:n==="target"&&(this.target[s]=this.current[s]);this.setTransform(),De(this.container,"is-scaling"),De(this.container,"is-animating"),this.isTicking=!1,this.state=Oe.Ready,r&&(this.emit("endAnimation"),this.updateControls())}requestTick(){this.isTicking||(this.emit("startAnimation"),this.updateControls(),de(this.container,"is-animating"),this.isScaling&&de(this.container,"is-scaling")),this.isTicking=!0,this.rAF||(this.rAF=requestAnimationFrame(()=>this.animate()))}panWithMouse(n,r=this.option("mouseMoveFriction")){if(this.pmme=n,this.panMode!==yt||!n||ee(this.targetScale)<=ee(this.minScale))return;this.emit("mouseMove",n);const{container:s,containerRect:c,contentRect:h}=this,g=c.width,d=c.height,y=s.getBoundingClientRect(),T=(n.clientX||0)-y.left,C=(n.clientY||0)-y.top;let{contentWidth:f,contentHeight:u}=this.calculateContentDim(this.target);const p=this.option("mouseMoveFactor");p>1&&(f!==g&&(f*=p),u!==d&&(u*=p));let v=.5*(f-g)-T/g*100/100*(f-g);v+=.5*(h.right-h.left);let E=.5*(u-d)-C/d*100/100*(u-d);E+=.5*(h.bottom-h.top),this.applyChange({panX:v-this.target.e,panY:E-this.target.f,friction:r})}zoomWithWheel(n){if(this.state===Oe.Destroy||this.state===Oe.Init)return;const r=Date.now();if(r-this.pwt<45)return void n.preventDefault();this.pwt=r;var s=[-n.deltaX||0,-n.deltaY||0,-n.detail||0].reduce(function(T,C){return Math.abs(C)>Math.abs(T)?C:T});const c=Math.max(-1,Math.min(1,s)),{targetScale:h,maxScale:g,minScale:d}=this;let y=h*(100+45*c)/100;ee(y)<ee(d)&&ee(h)<=ee(d)?(this.cwd+=Math.abs(c),y=d):ee(y)>ee(g)&&ee(h)>=ee(g)?(this.cwd+=Math.abs(c),y=g):(this.cwd=0,y=Math.max(Math.min(y,g),d)),this.cwd>this.option("wheelLimit")||(n.preventDefault(),ee(y)!==ee(h)&&this.zoomTo(y,{event:n}))}canZoomIn(){return this.option("zoom")&&(ee(this.contentRect.width,1)<ee(this.contentRect.fitWidth,1)||ee(this.targetScale)<ee(this.maxScale))}canZoomOut(){return this.option("zoom")&&ee(this.targetScale)>ee(this.minScale)}zoomIn(n=1.25,r){this.zoomTo(this.targetScale*n,r)}zoomOut(n=.8,r){this.zoomTo(this.targetScale*n,r)}zoomToFit(n){this.zoomTo("fit",n)}zoomToCover(n){this.zoomTo("cover",n)}zoomToFull(n){this.zoomTo("full",n)}zoomToMax(n){this.zoomTo("max",n)}toggleZoom(n){this.zoomTo(this.getNextScale("toggleZoom"),n)}toggleMax(n){this.zoomTo(this.getNextScale("toggleMax"),n)}toggleCover(n){this.zoomTo(this.getNextScale("toggleCover"),n)}iterateZoom(n){this.zoomTo("next",n)}zoomTo(n=1,{friction:r=bt,originX:s=bt,originY:c=bt,event:h}={}){if(this.isContentLoading||this.state===Oe.Destroy)return;const{targetScale:g,fullScale:d,maxScale:y,coverScale:T}=this;if(this.stop(),this.panMode===yt&&(h=this.pmme||h),h||s===bt||c===bt){const f=this.content.getBoundingClientRect(),u=this.container.getBoundingClientRect(),p=h?h.clientX:u.left+.5*u.width,v=h?h.clientY:u.top+.5*u.height;s=p-f.left-.5*f.width,c=v-f.top-.5*f.height}let C=1;typeof n=="number"?C=n:n==="full"?C=d:n==="cover"?C=T:n==="max"?C=y:n==="fit"?C=1:n==="next"&&(C=this.getNextScale("iterateZoom")),C=C/g||1,r=r===bt?C>1?.15:.25:r,this.applyChange({scale:C,originX:s,originY:c,friction:r}),h&&this.panMode===yt&&this.panWithMouse(h,r)}rotateCCW(){this.applyChange({angle:-90})}rotateCW(){this.applyChange({angle:90})}flipX(){this.applyChange({flipX:!0})}flipY(){this.applyChange({flipY:!0})}fitX(){this.stop("target");const{containerRect:n,contentRect:r,target:s}=this;this.applyChange({panX:.5*n.width-(r.left+.5*r.fitWidth)-s.e,panY:.5*n.height-(r.top+.5*r.fitHeight)-s.f,scale:n.width/r.fitWidth/this.targetScale,originX:0,originY:0,ignoreBounds:!0})}fitY(){this.stop("target");const{containerRect:n,contentRect:r,target:s}=this;this.applyChange({panX:.5*n.width-(r.left+.5*r.fitWidth)-s.e,panY:.5*n.innerHeight-(r.top+.5*r.fitHeight)-s.f,scale:n.height/r.fitHeight/this.targetScale,originX:0,originY:0,ignoreBounds:!0})}toggleFS(){const{container:n}=this,r=this.cn("inFullscreen"),s=this.cn("htmlHasFullscreen");n.classList.toggle(r);const c=n.classList.contains(r);c?(document.documentElement.classList.add(s),document.addEventListener("keydown",this.onKeydown,!0)):(document.documentElement.classList.remove(s),document.removeEventListener("keydown",this.onKeydown,!0)),this.updateMetrics(),this.emit(c?"enterFS":"exitFS")}getMatrix(n=this.current){const{a:r,b:s,c,d:h,e:g,f:d}=n;return new DOMMatrix([r,s,c,h,g,d])}reset(n){if(this.state!==Oe.Init&&this.state!==Oe.Destroy){this.stop("current");for(const r of It)this.target[r]=Xn[r];this.target.a=this.minScale,this.target.d=this.minScale,this.clampTargetBounds(),this.isResting||(this.friction=n===void 0?this.option("friction"):n,this.state=Oe.Panning,this.requestTick())}}destroy(){this.stop(),this.state=Oe.Destroy,this.detachEvents(),this.detachObserver();const{container:n,content:r}=this,s=this.option("classes")||{};for(const c of Object.values(s))n.classList.remove(c+"");r&&(r.removeEventListener("load",this.onLoad),r.removeEventListener("error",this.onError)),this.detachPlugins()}}Object.defineProperty(on,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:$l}),Object.defineProperty(on,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:{}});const la=function(w,n){let r=!0;return(...s)=>{r&&(r=!1,w(...s),setTimeout(()=>{r=!0},n))}},ca=(w,n)=>{let r=[];return w.childNodes.forEach(s=>{s.nodeType!==Node.ELEMENT_NODE||n&&!s.matches(n)||r.push(s)}),r},ql={viewport:null,track:null,enabled:!0,slides:[],axis:"x",transition:"fade",preload:1,slidesPerPage:"auto",initialPage:0,friction:.12,Panzoom:{decelFriction:.12},center:!0,infinite:!0,fill:!0,dragFree:!1,adaptiveHeight:!1,direction:"ltr",classes:{container:"f-carousel",viewport:"f-carousel__viewport",track:"f-carousel__track",slide:"f-carousel__slide",isLTR:"is-ltr",isRTL:"is-rtl",isHorizontal:"is-horizontal",isVertical:"is-vertical",inTransition:"in-transition",isSelected:"is-selected"},l10n:{NEXT:"Next slide",PREV:"Previous slide",GOTO:"Go to slide #%d"}};var Ye;(function(w){w[w.Init=0]="Init",w[w.Ready=1]="Ready",w[w.Destroy=2]="Destroy"})(Ye||(Ye={}));const Vi=w=>{if(typeof w=="string"||w instanceof HTMLElement)w={html:w};else{const n=w.thumb;n!==void 0&&(typeof n=="string"&&(w.thumbSrc=n),n instanceof HTMLImageElement&&(w.thumbEl=n,w.thumbElSrc=n.src,w.thumbSrc=n.src),delete w.thumb)}return Object.assign({html:"",el:null,isDom:!1,class:"",customClass:"",index:-1,dim:0,gap:0,pos:0,transition:!1},w)},Wl=(w={})=>Object.assign({index:-1,slides:[],dim:0,pos:-1},w);class Mt extends pi{constructor(n,r){super(r),Object.defineProperty(this,"instance",{enumerable:!0,configurable:!0,writable:!0,value:n})}attach(){}detach(){}}const Yl={classes:{list:"f-carousel__dots",isDynamic:"is-dynamic",hasDots:"has-dots",dot:"f-carousel__dot",isBeforePrev:"is-before-prev",isPrev:"is-prev",isCurrent:"is-current",isNext:"is-next",isAfterNext:"is-after-next"},dotTpl:'<button type="button" data-carousel-page="%i" aria-label="{{GOTO}}"><span class="f-carousel__dot" aria-hidden="true"></span></button>',dynamicFrom:11,maxCount:1/0,minCount:2};class Ya extends Mt{constructor(){super(...arguments),Object.defineProperty(this,"isDynamic",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"list",{enumerable:!0,configurable:!0,writable:!0,value:null})}onRefresh(){this.refresh()}build(){let n=this.list;if(!n){n=document.createElement("ul"),de(n,this.cn("list")),n.setAttribute("role","tablist");const r=this.instance.container;r.appendChild(n),de(r,this.cn("hasDots")),this.list=n}return n}refresh(){var n;const r=this.instance.pages.length,s=Math.min(2,this.option("minCount")),c=Math.max(2e3,this.option("maxCount")),h=this.option("dynamicFrom");if(r<s||r>c)return void this.cleanup();const g=typeof h=="number"&&r>5&&r>=h,d=!this.list||this.isDynamic!==g||this.list.children.length!==r;d&&this.cleanup();const y=this.build();if(Dt(y,this.cn("isDynamic"),!!g),d)for(let f=0;f<r;f++)y.append(this.createItem(f));let T,C=0;for(const f of[...y.children]){const u=C===this.instance.page;u&&(T=f),Dt(f,this.cn("isCurrent"),u),(n=f.children[0])===null||n===void 0||n.setAttribute("aria-selected",u?"true":"false");for(const p of["isBeforePrev","isPrev","isNext","isAfterNext"])De(f,this.cn(p));C++}if(T=T||y.firstChild,g&&T){const f=T.previousElementSibling,u=f&&f.previousElementSibling;de(f,this.cn("isPrev")),de(u,this.cn("isBeforePrev"));const p=T.nextElementSibling,v=p&&p.nextElementSibling;de(p,this.cn("isNext")),de(v,this.cn("isAfterNext"))}this.isDynamic=g}createItem(n=0){var r;const s=document.createElement("li");s.setAttribute("role","presentation");const c=At(this.instance.localize(this.option("dotTpl"),[["%d",n+1]]).replace(/\%i/g,n+""));return s.appendChild(c),(r=s.children[0])===null||r===void 0||r.setAttribute("role","tab"),s}cleanup(){this.list&&(this.list.remove(),this.list=null),this.isDynamic=!1,De(this.instance.container,this.cn("hasDots"))}attach(){this.instance.on(["refresh","change"],this.onRefresh)}detach(){this.instance.off(["refresh","change"],this.onRefresh),this.cleanup()}}Object.defineProperty(Ya,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:Yl});const Qn="disabled",ei="next",ua="prev";class Ka extends Mt{constructor(){super(...arguments),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"prev",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"next",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"isDom",{enumerable:!0,configurable:!0,writable:!0,value:!1})}onRefresh(){const n=this.instance,r=n.pages.length,s=n.page;if(r<2)return void this.cleanup();this.build();let c=this.prev,h=this.next;c&&h&&(c.removeAttribute(Qn),h.removeAttribute(Qn),n.isInfinite||(s<=0&&c.setAttribute(Qn,""),s>=r-1&&h.setAttribute(Qn,"")))}addBtn(n){var r;const s=this.instance,c=document.createElement("button");c.setAttribute("tabindex","0"),c.setAttribute("title",s.localize(`{{${n.toUpperCase()}}}`)),de(c,this.cn("button")+" "+this.cn(n===ei?"isNext":"isPrev"));const h=s.isRTL?n===ei?ua:ei:n;var g;return c.innerHTML=s.localize(this.option(`${h}Tpl`)),c.dataset[`carousel${g=n,g?g.match("^[a-z]")?g.charAt(0).toUpperCase()+g.substring(1):g:""}`]="true",(r=this.container)===null||r===void 0||r.appendChild(c),c}build(){const n=this.instance.container,r=this.cn("container");let{container:s,prev:c,next:h}=this;s||(s=n.querySelector("."+r),this.isDom=!!s),s||(s=document.createElement("div"),de(s,r),n.appendChild(s)),this.container=s,h||(h=s.querySelector("[data-carousel-next]")),h||(h=this.addBtn(ei)),this.next=h,c||(c=s.querySelector("[data-carousel-prev]")),c||(c=this.addBtn(ua)),this.prev=c}cleanup(){this.isDom||(this.prev&&this.prev.remove(),this.next&&this.next.remove(),this.container&&this.container.remove()),this.prev=null,this.next=null,this.container=null,this.isDom=!1}attach(){this.instance.on(["refresh","change"],this.onRefresh)}detach(){this.instance.off(["refresh","change"],this.onRefresh),this.cleanup()}}Object.defineProperty(Ka,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{classes:{container:"f-carousel__nav",button:"f-button",isNext:"is-next",isPrev:"is-prev"},nextTpl:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M9 3l9 9-9 9"/></svg>',prevTpl:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M15 3l-9 9 9 9"/></svg>'}});class Ga extends Mt{constructor(){super(...arguments),Object.defineProperty(this,"selectedIndex",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"target",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"nav",{enumerable:!0,configurable:!0,writable:!0,value:null})}addAsTargetFor(n){this.target=this.instance,this.nav=n,this.attachEvents()}addAsNavFor(n){this.nav=this.instance,this.target=n,this.attachEvents()}attachEvents(){const{nav:n,target:r}=this;n&&r&&(n.options.initialSlide=r.options.initialPage,n.state===Ye.Ready?this.onNavReady(n):n.on("ready",this.onNavReady),r.state===Ye.Ready?this.onTargetReady(r):r.on("ready",this.onTargetReady))}onNavReady(n){n.on("createSlide",this.onNavCreateSlide),n.on("Panzoom.click",this.onNavClick),n.on("Panzoom.touchEnd",this.onNavTouch),this.onTargetChange()}onTargetReady(n){n.on("change",this.onTargetChange),n.on("Panzoom.refresh",this.onTargetChange),this.onTargetChange()}onNavClick(n,r,s){this.onNavTouch(n,n.panzoom,s)}onNavTouch(n,r,s){var c,h;if(Math.abs(r.dragOffset.x)>3||Math.abs(r.dragOffset.y)>3)return;const g=s.target,{nav:d,target:y}=this;if(!d||!y||!g)return;const T=g.closest("[data-index]");if(s.stopPropagation(),s.preventDefault(),!T)return;const C=parseInt(T.dataset.index||"",10)||0,f=y.getPageForSlide(C),u=d.getPageForSlide(C);d.slideTo(u),y.slideTo(f,{friction:((h=(c=this.nav)===null||c===void 0?void 0:c.plugins)===null||h===void 0?void 0:h.Sync.option("friction"))||0}),this.markSelectedSlide(C)}onNavCreateSlide(n,r){r.index===this.selectedIndex&&this.markSelectedSlide(r.index)}onTargetChange(){var n,r;const{target:s,nav:c}=this;if(!s||!c||c.state!==Ye.Ready||s.state!==Ye.Ready)return;const h=(r=(n=s.pages[s.page])===null||n===void 0?void 0:n.slides[0])===null||r===void 0?void 0:r.index,g=c.getPageForSlide(h);this.markSelectedSlide(h),c.slideTo(g,c.prevPage===null&&s.prevPage===null?{friction:0}:void 0)}markSelectedSlide(n){const r=this.nav;r&&r.state===Ye.Ready&&(this.selectedIndex=n,[...r.slides].map(s=>{s.el&&s.el.classList[s.index===n?"add":"remove"]("is-nav-selected")}))}attach(){const n=this;let r=n.options.target,s=n.options.nav;r?n.addAsNavFor(r):s&&n.addAsTargetFor(s)}detach(){const n=this,r=n.nav,s=n.target;r&&(r.off("ready",n.onNavReady),r.off("createSlide",n.onNavCreateSlide),r.off("Panzoom.click",n.onNavClick),r.off("Panzoom.touchEnd",n.onNavTouch)),n.nav=null,s&&(s.off("ready",n.onTargetReady),s.off("refresh",n.onTargetChange),s.off("change",n.onTargetChange)),n.target=null}}Object.defineProperty(Ga,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{friction:.35}});const Kl={Navigation:Ka,Dots:Ya,Sync:Ga},ti="animationend",da="isSelected",ni="slide";class nn extends ur{get axis(){return this.isHorizontal?"e":"f"}get isEnabled(){return this.state===Ye.Ready}get isInfinite(){let n=!1;const{contentDim:r,viewportDim:s,pages:c,slides:h}=this,g=h[0];return c.length>=2&&g&&r+g.dim>=s&&(n=this.option("infinite")),n}get isRTL(){return this.option("direction")==="rtl"}get isHorizontal(){return this.option("axis")==="x"}constructor(n,r={},s={}){if(super(),Object.defineProperty(this,"bp",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"lp",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"userOptions",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"userPlugins",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:Ye.Init}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"prevPage",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"viewport",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"track",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"slides",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"pages",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"panzoom",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"inTransition",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"contentDim",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"viewportDim",{enumerable:!0,configurable:!0,writable:!0,value:0}),typeof n=="string"&&(n=document.querySelector(n)),!n||!ft(n))throw new Error("No Element found");this.container=n,this.slideNext=la(this.slideNext.bind(this),150),this.slidePrev=la(this.slidePrev.bind(this),150),this.userOptions=r,this.userPlugins=s,queueMicrotask(()=>{this.processOptions()})}processOptions(){var n,r;const s=ht({},nn.defaults,this.userOptions);let c="";const h=s.breakpoints;if(h&&ar(h))for(const[g,d]of Object.entries(h))window.matchMedia(g).matches&&ar(d)&&(c+=g,ht(s,d));c===this.bp&&this.state!==Ye.Init||(this.bp=c,this.state===Ye.Ready&&(s.initialSlide=((r=(n=this.pages[this.page])===null||n===void 0?void 0:n.slides[0])===null||r===void 0?void 0:r.index)||0),this.state!==Ye.Init&&this.destroy(),super.setOptions(s),this.option("enabled")===!1?this.attachEvents():setTimeout(()=>{this.init()},0))}init(){this.state=Ye.Init,this.emit("init"),this.attachPlugins(Object.assign(Object.assign({},nn.Plugins),this.userPlugins)),this.emit("attachPlugins"),this.initLayout(),this.initSlides(),this.updateMetrics(),this.setInitialPosition(),this.initPanzoom(),this.attachEvents(),this.state=Ye.Ready,this.emit("ready")}initLayout(){const{container:n}=this,r=this.option("classes");de(n,this.cn("container")),Dt(n,r.isLTR,!this.isRTL),Dt(n,r.isRTL,this.isRTL),Dt(n,r.isVertical,!this.isHorizontal),Dt(n,r.isHorizontal,this.isHorizontal);let s=this.option("viewport")||n.querySelector(`.${r.viewport}`);s||(s=document.createElement("div"),de(s,r.viewport),s.append(...ca(n,`.${r.slide}`)),n.prepend(s)),s.addEventListener("scroll",this.onScroll);let c=this.option("track")||n.querySelector(`.${r.track}`);c||(c=document.createElement("div"),de(c,r.track),c.append(...Array.from(s.childNodes))),c.setAttribute("aria-live","polite"),s.contains(c)||s.prepend(c),this.viewport=s,this.track=c,this.emit("initLayout")}initSlides(){const{track:n}=this;if(!n)return;const r=[...this.slides],s=[];[...ca(n,`.${this.cn(ni)}`)].forEach(c=>{if(ft(c)){const h=Vi({el:c,isDom:!0,index:this.slides.length});s.push(h)}});for(let c of[...this.option("slides",[])||[],...r])s.push(Vi(c));this.slides=s;for(let c=0;c<this.slides.length;c++)this.slides[c].index=c;for(const c of s)this.emit("beforeInitSlide",c,c.index),this.emit("initSlide",c,c.index);this.emit("initSlides")}setInitialPage(){const n=this.option("initialSlide");this.page=typeof n=="number"?this.getPageForSlide(n):parseInt(this.option("initialPage",0)+"",10)||0}setInitialPosition(){const{track:n,pages:r,isHorizontal:s}=this;if(!n||!r.length)return;let c=this.page;r[c]||(this.page=c=0);const h=(r[c].pos||0)*(this.isRTL&&s?1:-1),g=s?`${h}px`:"0",d=s?"0":`${h}px`;n.style.transform=`translate3d(${g}, ${d}, 0) scale(1)`,this.option("adaptiveHeight")&&this.setViewportHeight()}initPanzoom(){this.panzoom&&(this.panzoom.destroy(),this.panzoom=null);const n=this.option("Panzoom")||{};this.panzoom=new on(this.viewport,ht({},{content:this.track,zoom:!1,panOnlyZoomed:!1,lockAxis:this.isHorizontal?"x":"y",infinite:this.isInfinite,click:!1,dblClick:!1,touch:r=>!(this.pages.length<2&&!r.options.infinite),bounds:()=>this.getBounds(),maxVelocity:r=>Math.abs(r.target[this.axis]-r.current[this.axis])<2*this.viewportDim?100:0},n)),this.panzoom.on("*",(r,s,...c)=>{this.emit(`Panzoom.${s}`,r,...c)}),this.panzoom.on("decel",this.onDecel),this.panzoom.on("refresh",this.onRefresh),this.panzoom.on("beforeTransform",this.onBeforeTransform),this.panzoom.on("endAnimation",this.onEndAnimation)}attachEvents(){const n=this.container;n&&(n.addEventListener("click",this.onClick,{passive:!1,capture:!1}),n.addEventListener("slideTo",this.onSlideTo)),window.addEventListener("resize",this.onResize)}createPages(){let n=[];const{contentDim:r,viewportDim:s}=this;let c=this.option("slidesPerPage");c=(c==="auto"||r<=s)&&this.option("fill")!==!1?1/0:parseFloat(c+"");let h=0,g=0,d=0;for(const y of this.slides)(!n.length||g+y.dim-s>.05||d>=c)&&(n.push(Wl()),h=n.length-1,g=0,d=0),n[h].slides.push(y),g+=y.dim+y.gap,d++;return n}processPages(){const n=this.pages,{contentDim:r,viewportDim:s,isInfinite:c}=this,h=this.option("center"),g=this.option("fill"),d=g&&h&&r>s&&!c;if(n.forEach((C,f)=>{var u;C.index=f,C.pos=((u=C.slides[0])===null||u===void 0?void 0:u.pos)||0,C.dim=0;for(const[p,v]of C.slides.entries())C.dim+=v.dim,p<C.slides.length-1&&(C.dim+=v.gap);d&&C.pos+.5*C.dim<.5*s?C.pos=0:d&&C.pos+.5*C.dim>=r-.5*s?C.pos=r-s:h&&(C.pos+=-.5*(s-C.dim))}),n.forEach(C=>{g&&!c&&r>s&&(C.pos=Math.max(C.pos,0),C.pos=Math.min(C.pos,r-s)),C.pos=ee(C.pos,1e3),C.dim=ee(C.dim,1e3),Math.abs(C.pos)<=.1&&(C.pos=0)}),c)return n;const y=[];let T;return n.forEach(C=>{const f=Object.assign({},C);T&&f.pos===T.pos?(T.dim+=f.dim,T.slides=[...T.slides,...f.slides]):(f.index=y.length,T=f,y.push(f))}),y}getPageFromIndex(n=0){const r=this.pages.length;let s;return n=parseInt((n||0).toString())||0,s=this.isInfinite?(n%r+r)%r:Math.max(Math.min(n,r-1),0),s}getSlideMetrics(n){var r,s;const c=this.isHorizontal?"width":"height";let h=0,g=0,d=n.el;const y=!(!d||d.parentNode);if(d?h=parseFloat(d.dataset[c]||"")||0:(d=document.createElement("div"),d.style.visibility="hidden",(this.track||document.body).prepend(d)),de(d,this.cn(ni)+" "+n.class+" "+n.customClass),h)d.style[c]=`${h}px`,d.style[c==="width"?"height":"width"]="";else{y&&(this.track||document.body).prepend(d),h=d.getBoundingClientRect()[c]*Math.max(1,((r=window.visualViewport)===null||r===void 0?void 0:r.scale)||1);let C=d[this.isHorizontal?"offsetWidth":"offsetHeight"];C-1>h&&(h=C)}const T=getComputedStyle(d);return T.boxSizing==="content-box"&&(this.isHorizontal?(h+=parseFloat(T.paddingLeft)||0,h+=parseFloat(T.paddingRight)||0):(h+=parseFloat(T.paddingTop)||0,h+=parseFloat(T.paddingBottom)||0)),g=parseFloat(T[this.isHorizontal?"marginRight":"marginBottom"])||0,y?(s=d.parentElement)===null||s===void 0||s.removeChild(d):n.el||d.remove(),{dim:ee(h,1e3),gap:ee(g,1e3)}}getBounds(){const{isInfinite:n,isRTL:r,isHorizontal:s,pages:c}=this;let h={min:0,max:0};if(n)h={min:-1/0,max:1/0};else if(c.length){const g=c[0].pos,d=c[c.length-1].pos;h=r&&s?{min:g,max:d}:{min:-1*d,max:-1*g}}return{x:s?h:{min:0,max:0},y:s?{min:0,max:0}:h}}repositionSlides(){let n,{isHorizontal:r,isRTL:s,isInfinite:c,viewport:h,viewportDim:g,contentDim:d,page:y,pages:T,slides:C,panzoom:f}=this,u=0,p=0,v=0,E=0;f?E=-1*f.current[this.axis]:T[y]&&(E=T[y].pos||0),n=r?s?"right":"left":"top",s&&r&&(E*=-1);for(const x of C){const A=x.el;A?(n==="top"?(A.style.right="",A.style.left=""):A.style.top="",x.index!==u?A.style[n]=p===0?"":`${ee(p,1e3)}px`:A.style[n]="",v+=x.dim+x.gap,u++):p+=x.dim+x.gap}if(c&&v&&h){let x=getComputedStyle(h),A="padding",m=r?"Right":"Bottom",O=parseFloat(x[A+(r?"Left":"Top")]);E-=O,g+=O,g+=parseFloat(x[A+m]);for(const N of C)N.el&&(ee(N.pos)<ee(g)&&ee(N.pos+N.dim+N.gap)<ee(E)&&ee(E)>ee(d-g)&&(N.el.style[n]=`${ee(p+v,1e3)}px`),ee(N.pos+N.gap)>=ee(d-g)&&ee(N.pos)>ee(E+g)&&ee(E)<ee(g)&&(N.el.style[n]=`-${ee(v,1e3)}px`))}let b,k,M=[...this.inTransition];if(M.length>1&&(b=T[M[0]],k=T[M[1]]),b&&k){let x=0;for(const A of C)A.el?this.inTransition.has(A.index)&&b.slides.indexOf(A)<0&&(A.el.style[n]=`${ee(x+(b.pos-k.pos),1e3)}px`):x+=A.dim+A.gap}}createSlideEl(n){const{track:r,slides:s}=this;if(!r||!n||n.el&&n.el.parentNode)return;const c=n.el||document.createElement("div");de(c,this.cn(ni)),de(c,n.class),de(c,n.customClass);const h=n.html;h&&(h instanceof HTMLElement?c.appendChild(h):c.innerHTML=n.html+"");const g=[];s.forEach((C,f)=>{C.el&&g.push(f)});const d=n.index;let y=null;g.length&&(y=s[g.reduce((C,f)=>Math.abs(f-d)<Math.abs(C-d)?f:C)]);const T=y&&y.el&&y.el.parentNode?y.index<n.index?y.el.nextSibling:y.el:null;r.insertBefore(c,r.contains(T)?T:null),n.el=c,this.emit("createSlide",n)}removeSlideEl(n,r=!1){const s=n==null?void 0:n.el;if(!s||!s.parentNode)return;const c=this.cn(da);if(s.classList.contains(c)&&(De(s,c),this.emit("unselectSlide",n)),n.isDom&&!r)return s.removeAttribute("aria-hidden"),s.removeAttribute("data-index"),void(s.style.left="");this.emit("removeSlide",n);const h=new CustomEvent(ti);s.dispatchEvent(h),n.el&&(n.el.remove(),n.el=null)}transitionTo(n=0,r=this.option("transition")){var s,c,h,g;if(!r)return!1;const d=this.page,{pages:y,panzoom:T}=this;n=parseInt((n||0).toString())||0;const C=this.getPageFromIndex(n);if(!T||!y[C]||y.length<2||Math.abs((((c=(s=y[d])===null||s===void 0?void 0:s.slides[0])===null||c===void 0?void 0:c.dim)||0)-this.viewportDim)>1)return!1;let f=n>d?1:-1;this.isInfinite&&(d===0&&n===y.length-1&&(f=-1),d===y.length-1&&n===0&&(f=1));const u=y[C].pos*(this.isRTL?1:-1);if(d===C&&Math.abs(u-T.target[this.axis])<1)return!1;this.clearTransitions();const p=T.isResting;de(this.container,this.cn("inTransition"));const v=((h=y[d])===null||h===void 0?void 0:h.slides[0])||null,E=((g=y[C])===null||g===void 0?void 0:g.slides[0])||null;this.inTransition.add(E.index),this.createSlideEl(E);let b=v.el,k=E.el;p||r===ni||(r="fadeFast",b=null);const M=this.isRTL?"next":"prev",x=this.isRTL?"prev":"next";return b&&(this.inTransition.add(v.index),v.transition=r,b.addEventListener(ti,this.onAnimationEnd),b.classList.add(`f-${r}Out`,`to-${f>0?x:M}`)),k&&(E.transition=r,k.addEventListener(ti,this.onAnimationEnd),k.classList.add(`f-${r}In`,`from-${f>0?M:x}`)),T.current[this.axis]=u,T.target[this.axis]=u,T.requestTick(),this.onChange(C),!0}manageSlideVisiblity(){const n=new Set,r=new Set,s=this.getVisibleSlides(parseFloat(this.option("preload",0)+"")||0);for(const c of this.slides)s.has(c)?n.add(c):r.add(c);for(const c of this.inTransition)n.add(this.slides[c]);for(const c of n)this.createSlideEl(c),this.lazyLoadSlide(c);for(const c of r)n.has(c)||this.removeSlideEl(c);this.markSelectedSlides(),this.repositionSlides()}markSelectedSlides(){if(!this.pages[this.page]||!this.pages[this.page].slides)return;const n="aria-hidden";let r=this.cn(da);if(r)for(const s of this.slides){const c=s.el;c&&(c.dataset.index=`${s.index}`,c.classList.contains("f-thumbs__slide")?this.getVisibleSlides(0).has(s)?c.removeAttribute(n):c.setAttribute(n,"true"):this.pages[this.page].slides.includes(s)?(c.classList.contains(r)||(de(c,r),this.emit("selectSlide",s)),c.removeAttribute(n)):(c.classList.contains(r)&&(De(c,r),this.emit("unselectSlide",s)),c.setAttribute(n,"true")))}}flipInfiniteTrack(){const{axis:n,isHorizontal:r,isInfinite:s,isRTL:c,viewportDim:h,contentDim:g}=this,d=this.panzoom;if(!d||!s)return;let y=d.current[n],T=d.target[n]-y,C=0,f=.5*h;c&&r?(y<-f&&(C=-1,y+=g),y>g-f&&(C=1,y-=g)):(y>f&&(C=1,y-=g),y<-g+f&&(C=-1,y+=g)),C&&(d.current[n]=y,d.target[n]=y+T)}lazyLoadImg(n,r){const s=this,c="f-fadeIn",h="is-preloading";let g=!1,d=null;const y=()=>{g||(g=!0,d&&(d.remove(),d=null),De(r,h),r.complete&&(de(r,c),setTimeout(()=>{De(r,c)},350)),this.option("adaptiveHeight")&&n.el&&this.pages[this.page].slides.indexOf(n)>-1&&(s.updateMetrics(),s.setViewportHeight()),this.emit("load",n))};de(r,h),r.src=r.dataset.lazySrcset||r.dataset.lazySrc||"",delete r.dataset.lazySrc,delete r.dataset.lazySrcset,r.addEventListener("error",()=>{y()}),r.addEventListener("load",()=>{y()}),setTimeout(()=>{const T=r.parentNode;T&&n.el&&(r.complete?y():g||(d=At(dr),T.insertBefore(d,r)))},300)}lazyLoadSlide(n){const r=n&&n.el;if(!r)return;const s=new Set;let c=Array.from(r.querySelectorAll("[data-lazy-src],[data-lazy-srcset]"));r.dataset.lazySrc&&c.push(r),c.map(h=>{h instanceof HTMLImageElement?s.add(h):h instanceof HTMLElement&&h.dataset.lazySrc&&(h.style.backgroundImage=`url('${h.dataset.lazySrc}')`,delete h.dataset.lazySrc)});for(const h of s)this.lazyLoadImg(n,h)}onAnimationEnd(n){var r;const s=n.target,c=s?parseInt(s.dataset.index||"",10)||0:-1,h=this.slides[c],g=n.animationName;if(!s||!h||!g)return;const d=!!this.inTransition.has(c)&&h.transition;d&&g.substring(0,d.length+2)===`f-${d}`&&this.inTransition.delete(c),this.inTransition.size||this.clearTransitions(),c===this.page&&(!((r=this.panzoom)===null||r===void 0)&&r.isResting)&&this.emit("settle")}onDecel(n,r=0,s=0,c=0,h=0){if(this.option("dragFree"))return void this.setPageFromPosition();const{isRTL:g,isHorizontal:d,axis:y,pages:T}=this,C=T.length,f=Math.abs(Math.atan2(s,r)/(Math.PI/180));let u=0;if(u=f>45&&f<135?d?0:s:d?r:0,!C)return;let p=this.page,v=g&&d?1:-1;const E=n.current[y]*v;let{pageIndex:b}=this.getPageFromPosition(E);Math.abs(u)>5?(T[p].dim<document.documentElement["client"+(this.isHorizontal?"Width":"Height")]-1&&(p=b),p=g&&d?u<0?p-1:p+1:u<0?p+1:p-1):p=c===0&&h===0?p:b,this.slideTo(p,{transition:!1,friction:n.option("decelFriction")})}onClick(n){const r=n.target,s=r&&ft(r)?r.dataset:null;let c,h;s&&(s.carouselPage!==void 0?(h="slideTo",c=s.carouselPage):s.carouselNext!==void 0?h="slideNext":s.carouselPrev!==void 0&&(h="slidePrev")),h?(n.preventDefault(),n.stopPropagation(),r&&!r.hasAttribute("disabled")&&this[h](c)):this.emit("click",n)}onSlideTo(n){const r=n.detail||0;this.slideTo(this.getPageForSlide(r),{friction:0})}onChange(n,r=0){const s=this.page;this.prevPage=s,this.page=n,this.option("adaptiveHeight")&&this.setViewportHeight(),n!==s&&(this.markSelectedSlides(),this.emit("change",n,s,r))}onRefresh(){let n=this.contentDim,r=this.viewportDim;this.updateMetrics(),this.contentDim===n&&this.viewportDim===r||this.slideTo(this.page,{friction:0,transition:!1})}onScroll(){var n;(n=this.viewport)===null||n===void 0||n.scroll(0,0)}onResize(){this.option("breakpoints")&&this.processOptions()}onBeforeTransform(n){this.lp!==n.current[this.axis]&&(this.flipInfiniteTrack(),this.manageSlideVisiblity()),this.lp=n.current.e}onEndAnimation(){this.inTransition.size||this.emit("settle")}reInit(n=null,r=null){this.destroy(),this.state=Ye.Init,this.prevPage=null,this.userOptions=n||this.userOptions,this.userPlugins=r||this.userPlugins,this.processOptions()}slideTo(n=0,{friction:r=this.option("friction"),transition:s=this.option("transition")}={}){if(this.state===Ye.Destroy)return;n=parseInt((n||0).toString())||0;const c=this.getPageFromIndex(n),{axis:h,isHorizontal:g,isRTL:d,pages:y,panzoom:T}=this,C=y.length,f=d&&g?1:-1;if(!T||!C)return;if(this.page!==c){const p=new Event("beforeChange",{bubbles:!0,cancelable:!0});if(this.emit("beforeChange",p,n),p.defaultPrevented)return}if(this.transitionTo(n,s))return;let u=y[c].pos;if(this.isInfinite){const p=this.contentDim,v=T.target[h]*f;C===2?u+=p*Math.floor(parseFloat(n+"")/2):u=[u,u-p,u+p].reduce(function(E,b){return Math.abs(b-v)<Math.abs(E-v)?b:E})}u*=f,Math.abs(T.target[h]-u)<1||(T.panTo({x:g?u:0,y:g?0:u,friction:r}),this.onChange(c))}slideToClosest(n){if(this.panzoom){const{pageIndex:r}=this.getPageFromPosition();this.slideTo(r,n)}}slideNext(){this.slideTo(this.page+1)}slidePrev(){this.slideTo(this.page-1)}clearTransitions(){this.inTransition.clear(),De(this.container,this.cn("inTransition"));const n=["to-prev","to-next","from-prev","from-next"];for(const r of this.slides){const s=r.el;if(s){s.removeEventListener(ti,this.onAnimationEnd),s.classList.remove(...n);const c=r.transition;c&&s.classList.remove(`f-${c}Out`,`f-${c}In`)}}this.manageSlideVisiblity()}addSlide(n,r){var s,c,h,g;const d=this.panzoom,y=((s=this.pages[this.page])===null||s===void 0?void 0:s.pos)||0,T=((c=this.pages[this.page])===null||c===void 0?void 0:c.dim)||0,C=this.contentDim<this.viewportDim;let f=Array.isArray(r)?r:[r];const u=[];for(const p of f)u.push(Vi(p));this.slides.splice(n,0,...u);for(let p=0;p<this.slides.length;p++)this.slides[p].index=p;for(const p of u)this.emit("beforeInitSlide",p,p.index);if(this.page>=n&&(this.page+=u.length),this.updateMetrics(),d){const p=((h=this.pages[this.page])===null||h===void 0?void 0:h.pos)||0,v=((g=this.pages[this.page])===null||g===void 0?void 0:g.dim)||0,E=this.pages.length||1,b=this.isRTL?T-v:v-T,k=this.isRTL?y-p:p-y;C&&E===1?(n<=this.page&&(d.current[this.axis]-=b,d.target[this.axis]-=b),d.panTo({[this.isHorizontal?"x":"y"]:-1*p})):k&&n<=this.page&&(d.target[this.axis]-=k,d.current[this.axis]-=k,d.requestTick())}for(const p of u)this.emit("initSlide",p,p.index)}prependSlide(n){this.addSlide(0,n)}appendSlide(n){this.addSlide(this.slides.length,n)}removeSlide(n){const r=this.slides.length;n=(n%r+r)%r;const s=this.slides[n];if(s){this.removeSlideEl(s,!0),this.slides.splice(n,1);for(let c=0;c<this.slides.length;c++)this.slides[c].index=c;this.updateMetrics(),this.slideTo(this.page,{friction:0,transition:!1}),this.emit("destroySlide",s)}}updateMetrics(){const{panzoom:n,viewport:r,track:s,slides:c,isHorizontal:h,isInfinite:g}=this;if(!s)return;const d=h?"width":"height",y=h?"offsetWidth":"offsetHeight";if(r){let f=Math.max(r[y],ee(r.getBoundingClientRect()[d],1e3)),u=getComputedStyle(r),p="padding",v=h?"Right":"Bottom";f-=parseFloat(u[p+(h?"Left":"Top")])+parseFloat(u[p+v]),this.viewportDim=f}let T,C=0;for(const[f,u]of c.entries()){let p=0,v=0;!u.el&&T?(p=T.dim,v=T.gap):({dim:p,gap:v}=this.getSlideMetrics(u),T=u),p=ee(p,1e3),v=ee(v,1e3),u.dim=p,u.gap=v,u.pos=C,C+=p,(g||f<c.length-1)&&(C+=v)}C=ee(C,1e3),this.contentDim=C,n&&(n.contentRect[d]=C,n.contentRect[h?"fullWidth":"fullHeight"]=C),this.pages=this.createPages(),this.pages=this.processPages(),this.state===Ye.Init&&this.setInitialPage(),this.page=Math.max(0,Math.min(this.page,this.pages.length-1)),this.manageSlideVisiblity(),this.emit("refresh")}getProgress(n,r=!1,s=!1){n===void 0&&(n=this.page);const c=this,h=c.panzoom,g=c.contentDim,d=c.pages[n]||0;if(!d||!h)return n>this.page?-1:1;let y=-1*h.current.e,T=ee((y-d.pos)/(1*d.dim),1e3),C=T,f=T;this.isInfinite&&s!==!0&&(C=ee((y-d.pos+g)/(1*d.dim),1e3),f=ee((y-d.pos-g)/(1*d.dim),1e3));let u=[T,C,f].reduce(function(p,v){return Math.abs(v)<Math.abs(p)?v:p});return r?u:u>1?1:u<-1?-1:u}setViewportHeight(){const{page:n,pages:r,viewport:s,isHorizontal:c}=this;if(!s||!r[n])return;let h=0;c&&this.track&&(this.track.style.height="auto",r[n].slides.forEach(g=>{g.el&&(h=Math.max(h,g.el.offsetHeight))})),s.style.height=h?`${h}px`:""}getPageForSlide(n){for(const r of this.pages)for(const s of r.slides)if(s.index===n)return r.index;return-1}getVisibleSlides(n=0){var r;const s=new Set;let{panzoom:c,contentDim:h,viewportDim:g,pages:d,page:y}=this;if(g){h=h+((r=this.slides[this.slides.length-1])===null||r===void 0?void 0:r.gap)||0;let T=0;T=c&&c.state!==Oe.Init&&c.state!==Oe.Destroy?-1*c.current[this.axis]:d[y]&&d[y].pos||0,this.isInfinite&&(T-=Math.floor(T/h)*h),this.isRTL&&this.isHorizontal&&(T*=-1);const C=T-g*n,f=T+g*(n+1),u=this.isInfinite?[-1,0,1]:[0];for(const p of this.slides)for(const v of u){const E=p.pos+v*h,b=E+p.dim+p.gap;E<f&&b>C&&s.add(p)}}return s}getPageFromPosition(n){const{viewportDim:r,contentDim:s,slides:c,pages:h,panzoom:g}=this,d=h.length,y=c.length,T=c[0],C=c[y-1],f=this.option("center");let u=0,p=0,v=0,E=n===void 0?-1*((g==null?void 0:g.target[this.axis])||0):n;f&&(E+=.5*r),this.isInfinite?(E<T.pos-.5*C.gap&&(E-=s,v=-1),E>C.pos+C.dim+.5*C.gap&&(E-=s,v=1)):E=Math.max(T.pos||0,Math.min(E,C.pos));let b=C,k=c.find(M=>{const x=M.pos-.5*b.gap,A=M.pos+M.dim+.5*M.gap;return b=M,E>=x&&E<A});return k||(k=C),p=this.getPageForSlide(k.index),u=p+v*d,{page:u,pageIndex:p}}setPageFromPosition(){const{pageIndex:n}=this.getPageFromPosition();this.onChange(n)}destroy(){if([Ye.Destroy].includes(this.state))return;this.state=Ye.Destroy;const{container:n,viewport:r,track:s,slides:c,panzoom:h}=this,g=this.option("classes");n.removeEventListener("click",this.onClick,{passive:!1,capture:!1}),n.removeEventListener("slideTo",this.onSlideTo),window.removeEventListener("resize",this.onResize),h&&(h.destroy(),this.panzoom=null),c&&c.forEach(y=>{this.removeSlideEl(y)}),this.detachPlugins(),r&&(r.removeEventListener("scroll",this.onScroll),r.offsetParent&&s&&s.offsetParent&&r.replaceWith(...s.childNodes));for(const[y,T]of Object.entries(g))y!=="container"&&T&&n.classList.remove(T);this.track=null,this.viewport=null,this.page=0,this.slides=[];const d=this.events.get("ready");this.events=new Map,d&&this.events.set("ready",d)}}Object.defineProperty(nn,"Panzoom",{enumerable:!0,configurable:!0,writable:!0,value:on}),Object.defineProperty(nn,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:ql}),Object.defineProperty(nn,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:Kl});const Za=function(w){if(!ft(w))return 0;const n=window.scrollY,r=window.innerHeight,s=n+r,c=w.getBoundingClientRect(),h=c.y+n,g=c.height,d=h+g;if(n>d||s<h)return 0;if(n<h&&s>d||h<n&&d>s)return 100;let y=g;h<n&&(y-=n-h),d>s&&(y-=d-s);const T=y/r*100;return Math.round(T)},Bn=!(typeof window>"u"||!window.document||!window.document.createElement);let qi;const Wi=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden]):not(.fancybox-focus-guard)","iframe","object","embed","video","audio","[contenteditable]",'[tabindex]:not([tabindex^="-"]):not([disabled]):not([aria-hidden])'].join(","),fa=w=>{if(w&&Bn){qi===void 0&&document.createElement("div").focus({get preventScroll(){return qi=!0,!1}});try{if(qi)w.focus({preventScroll:!0});else{const n=window.scrollY||document.body.scrollTop,r=window.scrollX||document.body.scrollLeft;w.focus(),document.body.scrollTo({top:n,left:r,behavior:"auto"})}}catch{}}},Xa=()=>{const w=document;let n,r="",s="",c="";return w.fullscreenEnabled?(r="requestFullscreen",s="exitFullscreen",c="fullscreenElement"):w.webkitFullscreenEnabled&&(r="webkitRequestFullscreen",s="webkitExitFullscreen",c="webkitFullscreenElement"),r&&(n={request:function(h=w.documentElement){return r==="webkitRequestFullscreen"?h[r](Element.ALLOW_KEYBOARD_INPUT):h[r]()},exit:function(){return w[c]&&w[s]()},isFullscreen:function(){return w[c]}}),n},or={animated:!0,autoFocus:!0,backdropClick:"close",Carousel:{classes:{container:"fancybox__carousel",viewport:"fancybox__viewport",track:"fancybox__track",slide:"fancybox__slide"}},closeButton:"auto",closeExisting:!1,commonCaption:!1,compact:()=>window.matchMedia("(max-width: 578px), (max-height: 578px)").matches,contentClick:"toggleZoom",contentDblClick:!1,defaultType:"image",defaultDisplay:"flex",dragToClose:!0,Fullscreen:{autoStart:!1},groupAll:!1,groupAttr:"data-fancybox",hideClass:"f-fadeOut",hideScrollbar:!0,idle:3500,keyboard:{Escape:"close",Delete:"close",Backspace:"close",PageUp:"next",PageDown:"prev",ArrowUp:"prev",ArrowDown:"next",ArrowRight:"next",ArrowLeft:"prev"},l10n:Object.assign(Object.assign({},Wa),{CLOSE:"Close",NEXT:"Next",PREV:"Previous",MODAL:"You can close this modal content with the ESC key",ERROR:"Something Went Wrong, Please Try Again Later",IMAGE_ERROR:"Image Not Found",ELEMENT_NOT_FOUND:"HTML Element Not Found",AJAX_NOT_FOUND:"Error Loading AJAX : Not Found",AJAX_FORBIDDEN:"Error Loading AJAX : Forbidden",IFRAME_ERROR:"Error Loading Page",TOGGLE_ZOOM:"Toggle zoom level",TOGGLE_THUMBS:"Toggle thumbnails",TOGGLE_SLIDESHOW:"Toggle slideshow",TOGGLE_FULLSCREEN:"Toggle full-screen mode",DOWNLOAD:"Download"}),parentEl:null,placeFocusBack:!0,showClass:"f-zoomInUp",startIndex:0,tpl:{closeButton:'<button data-fancybox-close class="f-button is-close-btn" title="{{CLOSE}}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M20 20L4 4m16 0L4 20"/></svg></button>',main:`<div class="fancybox__container" role="dialog" aria-modal="true" aria-label="{{MODAL}}" tabindex="-1">
    <div class="fancybox__backdrop"></div>
    <div class="fancybox__carousel"></div>
    <div class="fancybox__footer"></div>
  </div>`},trapFocus:!0,wheel:"zoom"};var Qe,rt;(function(w){w[w.Init=0]="Init",w[w.Ready=1]="Ready",w[w.Closing=2]="Closing",w[w.CustomClosing=3]="CustomClosing",w[w.Destroy=4]="Destroy"})(Qe||(Qe={})),function(w){w[w.Loading=0]="Loading",w[w.Opening=1]="Opening",w[w.Ready=2]="Ready",w[w.Closing=3]="Closing"}(rt||(rt={}));let ha="",jn=!1,ii=!1,en=null;const Ja=()=>{let w="",n="";const r=xe.getInstance();if(r){const s=r.carousel,c=r.getSlide();if(s&&c){let h=c.slug||void 0,g=c.triggerEl||void 0;n=h||r.option("slug")||"",!n&&g&&g.dataset&&(n=g.dataset.fancybox||""),n&&n!=="true"&&(w="#"+n+(!h&&s.slides.length>1?"-"+(c.index+1):""))}}return{hash:w,slug:n,index:1}},mi=()=>{const w=new URL(document.URL).hash,n=w.slice(1).split("-"),r=n[n.length-1],s=r&&/^\+?\d+$/.test(r)&&parseInt(n.pop()||"1",10)||1;return{hash:w,slug:n.join("-"),index:s}},Qa=()=>{const{slug:w,index:n}=mi();if(!w)return;let r=document.querySelector(`[data-slug="${w}"]`);if(r&&r.dispatchEvent(new CustomEvent("click",{bubbles:!0,cancelable:!0})),xe.getInstance())return;const s=document.querySelectorAll(`[data-fancybox="${w}"]`);s.length&&(r=s[n-1],r&&r.dispatchEvent(new CustomEvent("click",{bubbles:!0,cancelable:!0})))},eo=()=>{if(xe.defaults.Hash===!1)return;const w=xe.getInstance();if((w==null?void 0:w.options.Hash)===!1)return;const{slug:n,index:r}=mi(),{slug:s}=Ja();w&&(n===s?w.jumpTo(r-1):(jn=!0,w.close())),Qa()},to=()=>{en&&clearTimeout(en),queueMicrotask(()=>{eo()})},pa=()=>{window.addEventListener("hashchange",to,!1),setTimeout(()=>{eo()},500)};Bn&&(/complete|interactive|loaded/.test(document.readyState)?pa():document.addEventListener("DOMContentLoaded",pa));const ri="is-zooming-in";class no extends Mt{onCreateSlide(n,r,s){const c=this.instance.optionFor(s,"src")||"";s.el&&s.type==="image"&&typeof c=="string"&&this.setImage(s,c)}onRemoveSlide(n,r,s){s.panzoom&&s.panzoom.destroy(),s.panzoom=void 0,s.imageEl=void 0}onChange(n,r,s,c){De(this.instance.container,ri);for(const h of r.slides){const g=h.panzoom;g&&h.index!==s&&g.reset(.35)}}onClose(){var n;const r=this.instance,s=r.container,c=r.getSlide();if(!s||!s.parentElement||!c)return;const{el:h,contentEl:g,panzoom:d,thumbElSrc:y}=c;if(!h||!y||!g||!d||d.isContentLoading||d.state===Oe.Init||d.state===Oe.Destroy)return;d.updateMetrics();let T=this.getZoomInfo(c);if(!T)return;this.instance.state=Qe.CustomClosing,s.classList.remove(ri),s.classList.add("is-zooming-out"),g.style.backgroundImage=`url('${y}')`;const C=s.getBoundingClientRect();(((n=window.visualViewport)===null||n===void 0?void 0:n.scale)||1)===1&&Object.assign(s.style,{position:"absolute",top:`${s.offsetTop+window.scrollY}px`,left:`${s.offsetLeft+window.scrollX}px`,bottom:"auto",right:"auto",width:`${C.width}px`,height:`${C.height}px`,overflow:"hidden"});const{x:f,y:u,scale:p,opacity:v}=T;if(v){const E=((b,k,M,x)=>{const A=k-b,m=x-M;return O=>M+((O-b)/A*m||0)})(d.scale,p,1,0);d.on("afterTransform",()=>{g.style.opacity=E(d.scale)+""})}d.on("endAnimation",()=>{r.destroy()}),d.target.a=p,d.target.b=0,d.target.c=0,d.target.d=p,d.panTo({x:f,y:u,scale:p,friction:v?.2:.33,ignoreBounds:!0}),d.isResting&&r.destroy()}setImage(n,r){const s=this.instance;n.src=r,this.process(n,r).then(c=>{const{contentEl:h,imageEl:g,thumbElSrc:d,el:y}=n;if(s.isClosing()||!h||!g)return;h.offsetHeight;const T=!!s.isOpeningSlide(n)&&this.getZoomInfo(n);if(this.option("protected")&&y){y.addEventListener("contextmenu",u=>{u.preventDefault()});const f=document.createElement("div");de(f,"fancybox-protected"),h.appendChild(f)}if(d&&T){const f=c.contentRect,u=Math.max(f.fullWidth,f.fullHeight);let p=null;!T.opacity&&u>1200&&(p=document.createElement("img"),de(p,"fancybox-ghost"),p.src=d,h.appendChild(p));const v=()=>{p&&(de(p,"f-fadeFastOut"),setTimeout(()=>{p&&(p.remove(),p=null)},200))};(C=d,new Promise((E,b)=>{const k=new Image;k.onload=E,k.onerror=b,k.src=C})).then(()=>{s.hideLoading(n),n.state=rt.Opening,this.instance.emit("reveal",n),this.zoomIn(n).then(()=>{v(),this.instance.done(n)},()=>{}),p&&setTimeout(()=>{v()},u>2500?800:200)},()=>{s.hideLoading(n),s.revealContent(n)})}else{const f=this.optionFor(n,"initialSize"),u=this.optionFor(n,"zoom"),p={event:s.prevMouseMoveEvent||s.options.event,friction:u?.12:0};let v=s.optionFor(n,"showClass")||void 0,E=!0;s.isOpeningSlide(n)&&(f==="full"?c.zoomToFull(p):f==="cover"?c.zoomToCover(p):f==="max"?c.zoomToMax(p):E=!1,c.stop("current")),E&&v&&(v=c.isDragging?"f-fadeIn":""),s.hideLoading(n),s.revealContent(n,v)}var C},()=>{s.setError(n,"{{IMAGE_ERROR}}")})}process(n,r){return new Promise((s,c)=>{var h;const g=this.instance,d=n.el;g.clearContent(n),g.showLoading(n);let y=this.optionFor(n,"content");if(typeof y=="string"&&(y=At(y)),!y||!ft(y)){if(y=document.createElement("img"),y instanceof HTMLImageElement){let T="",C=n.caption;T=typeof C=="string"&&C?C.replace(/<[^>]+>/gi,"").substring(0,1e3):`Image ${n.index+1} of ${((h=g.carousel)===null||h===void 0?void 0:h.pages.length)||1}`,y.src=r||"",y.alt=T,y.draggable=!1,n.srcset&&y.setAttribute("srcset",n.srcset),this.instance.isOpeningSlide(n)&&(y.fetchPriority="high")}n.sizes&&y.setAttribute("sizes",n.sizes)}de(y,"fancybox-image"),n.imageEl=y,g.setContent(n,y,!1),n.panzoom=new on(d,ht({transformParent:!0},this.option("Panzoom")||{},{content:y,width:(T,C)=>g.optionFor(n,"width","auto",C)||"auto",height:(T,C)=>g.optionFor(n,"height","auto",C)||"auto",wheel:()=>{const T=g.option("wheel");return(T==="zoom"||T=="pan")&&T},click:(T,C)=>{var f,u;if(g.isCompact||g.isClosing()||n.index!==((f=g.getSlide())===null||f===void 0?void 0:f.index))return!1;if(C){const v=C.composedPath()[0];if(["A","BUTTON","TEXTAREA","OPTION","INPUT","SELECT","VIDEO"].includes(v.nodeName))return!1}let p=!C||C.target&&((u=n.contentEl)===null||u===void 0?void 0:u.contains(C.target));return g.option(p?"contentClick":"backdropClick")||!1},dblClick:()=>g.isCompact?"toggleZoom":g.option("contentDblClick")||!1,spinner:!1,panOnlyZoomed:!0,wheelLimit:1/0,on:{ready:T=>{s(T)},error:()=>{c()},destroy:()=>{c()}}}))})}zoomIn(n){return new Promise((r,s)=>{const c=this.instance,h=c.container,{panzoom:g,contentEl:d,el:y}=n;g&&g.updateMetrics();const T=this.getZoomInfo(n);if(!(T&&y&&d&&g&&h))return void s();const{x:C,y:f,scale:u,opacity:p}=T,v=()=>{n.state!==rt.Closing&&(p&&(d.style.opacity=Math.max(Math.min(1,1-(1-g.scale)/(1-u)),0)+""),g.scale>=1&&g.scale>g.targetScale-.1&&r(g))},E=M=>{(M.scale<.99||M.scale>1.01)&&!M.isDragging||(De(h,ri),d.style.opacity="",M.off("endAnimation",E),M.off("touchStart",E),M.off("afterTransform",v),r(M))};g.on("endAnimation",E),g.on("touchStart",E),g.on("afterTransform",v),g.on(["error","destroy"],()=>{s()}),g.panTo({x:C,y:f,scale:u,friction:0,ignoreBounds:!0}),g.stop("current");const b={event:g.panMode==="mousemove"?c.prevMouseMoveEvent||c.options.event:void 0},k=this.optionFor(n,"initialSize");de(h,ri),c.hideLoading(n),k==="full"?g.zoomToFull(b):k==="cover"?g.zoomToCover(b):k==="max"?g.zoomToMax(b):g.reset(.172)})}getZoomInfo(n){const{el:r,imageEl:s,thumbEl:c,panzoom:h}=n,g=this.instance,d=g.container;if(!r||!s||!c||!h||Za(c)<3||!this.optionFor(n,"zoom")||!d||g.state===Qe.Destroy||getComputedStyle(d).getPropertyValue("--f-images-zoom")==="0")return!1;const y=window.visualViewport||null;if((y?y.scale:1)!==1)return!1;let{top:T,left:C,width:f,height:u}=c.getBoundingClientRect(),{top:p,left:v,fitWidth:E,fitHeight:b}=h.contentRect;if(!(f&&u&&E&&b))return!1;const k=h.container.getBoundingClientRect();v+=k.left,p+=k.top;const M=-1*(v+.5*E-(C+.5*f)),x=-1*(p+.5*b-(T+.5*u)),A=f/E;let m=this.option("zoomOpacity")||!1;return m==="auto"&&(m=Math.abs(f/u-E/b)>.1),{x:M,y:x,scale:A,opacity:m}}attach(){const n=this,r=n.instance;r.on("Carousel.change",n.onChange),r.on("Carousel.createSlide",n.onCreateSlide),r.on("Carousel.removeSlide",n.onRemoveSlide),r.on("close",n.onClose)}detach(){const n=this,r=n.instance;r.off("Carousel.change",n.onChange),r.off("Carousel.createSlide",n.onCreateSlide),r.off("Carousel.removeSlide",n.onRemoveSlide),r.off("close",n.onClose)}}Object.defineProperty(no,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{initialSize:"fit",Panzoom:{maxScale:1},protected:!1,zoom:!0,zoomOpacity:"auto"}}),typeof SuppressedError=="function"&&SuppressedError;const Yi="html",ma="image",Ki="map",Nt="youtube",Gt="vimeo",In="html5video",ga=(w,n={})=>{const r=new URL(w),s=new URLSearchParams(r.search),c=new URLSearchParams;for(const[d,y]of[...s,...Object.entries(n)]){let T=y+"";if(d==="t"){let C=T.match(/((\d*)m)?(\d*)s?/);C&&c.set("start",60*parseInt(C[2]||"0")+parseInt(C[3]||"0")+"")}else c.set(d,T)}let h=c+"",g=w.match(/#t=((.*)?\d+s)/);return g&&(h+=`#t=${g[1]}`),h},Gl={ajax:null,autoSize:!0,iframeAttr:{allow:"autoplay; fullscreen",scrolling:"auto"},preload:!0,videoAutoplay:!0,videoRatio:16/9,videoTpl:`<video class="fancybox__html5video" playsinline controls controlsList="nodownload" poster="{{poster}}">
  <source src="{{src}}" type="{{format}}" />Sorry, your browser doesn't support embedded videos.</video>`,videoFormat:"",vimeo:{byline:1,color:"00adef",controls:1,dnt:1,muted:0},youtube:{controls:1,enablejsapi:1,nocookie:1,rel:0,fs:1}},Zl=["image","html","ajax","inline","clone","iframe","map","pdf","html5video","youtube","vimeo"];class io extends Mt{onBeforeInitSlide(n,r,s){this.processType(s)}onCreateSlide(n,r,s){this.setContent(s)}onClearContent(n,r){r.xhr&&(r.xhr.abort(),r.xhr=null);const s=r.iframeEl;s&&(s.onload=s.onerror=null,s.src="//about:blank",r.iframeEl=null);const c=r.contentEl,h=r.placeholderEl;if(r.type==="inline"&&c&&h)c.classList.remove("fancybox__content"),getComputedStyle(c).getPropertyValue("display")!=="none"&&(c.style.display="none"),setTimeout(()=>{h&&(c&&h.parentNode&&h.parentNode.insertBefore(c,h),h.remove())},0),r.contentEl=void 0,r.placeholderEl=void 0;else for(;r.el&&r.el.firstChild;)r.el.removeChild(r.el.firstChild)}onSelectSlide(n,r,s){s.state===rt.Ready&&this.playVideo()}onUnselectSlide(n,r,s){var c,h;if(s.type===In){try{(h=(c=s.el)===null||c===void 0?void 0:c.querySelector("video"))===null||h===void 0||h.pause()}catch{}return}let g;s.type===Gt?g={method:"pause",value:"true"}:s.type===Nt&&(g={event:"command",func:"pauseVideo"}),g&&s.iframeEl&&s.iframeEl.contentWindow&&s.iframeEl.contentWindow.postMessage(JSON.stringify(g),"*"),s.poller&&clearTimeout(s.poller)}onDone(n,r){n.isCurrentSlide(r)&&!n.isClosing()&&this.playVideo()}onRefresh(n,r){r.slides.forEach(s=>{s.el&&(this.resizeIframe(s),this.setAspectRatio(s))})}onMessage(n){try{let r=JSON.parse(n.data);if(n.origin==="https://player.vimeo.com"){if(r.event==="ready")for(let s of Array.from(document.getElementsByClassName("fancybox__iframe")))s instanceof HTMLIFrameElement&&s.contentWindow===n.source&&(s.dataset.ready="true")}else if(n.origin.match(/^https:\/\/(www.)?youtube(-nocookie)?.com$/)&&r.event==="onReady"){const s=document.getElementById(r.id);s&&(s.dataset.ready="true")}}catch{}}loadAjaxContent(n){const r=this.instance.optionFor(n,"src")||"";this.instance.showLoading(n);const s=this.instance,c=new XMLHttpRequest;s.showLoading(n),c.onreadystatechange=function(){c.readyState===XMLHttpRequest.DONE&&s.state===Qe.Ready&&(s.hideLoading(n),c.status===200?s.setContent(n,c.responseText):s.setError(n,c.status===404?"{{AJAX_NOT_FOUND}}":"{{AJAX_FORBIDDEN}}"))};const h=n.ajax||null;c.open(h?"POST":"GET",r+""),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.send(h),n.xhr=c}setInlineContent(n){let r=null;if(ft(n.src))r=n.src;else if(typeof n.src=="string"){const s=n.src.split("#",2).pop();r=s?document.getElementById(s):null}if(r){if(n.type==="clone"||r.closest(".fancybox__slide")){r=r.cloneNode(!0);const s=r.dataset.animationName;s&&(r.classList.remove(s),delete r.dataset.animationName);let c=r.getAttribute("id");c=c?`${c}--clone`:`clone-${this.instance.id}-${n.index}`,r.setAttribute("id",c)}else if(r.parentNode){const s=document.createElement("div");s.classList.add("fancybox-placeholder"),r.parentNode.insertBefore(s,r),n.placeholderEl=s}this.instance.setContent(n,r)}else this.instance.setError(n,"{{ELEMENT_NOT_FOUND}}")}setIframeContent(n){const{src:r,el:s}=n;if(!r||typeof r!="string"||!s)return;s.classList.add("is-loading");const c=this.instance,h=document.createElement("iframe");h.className="fancybox__iframe",h.setAttribute("id",`fancybox__iframe_${c.id}_${n.index}`);for(const[d,y]of Object.entries(this.optionFor(n,"iframeAttr")||{}))h.setAttribute(d,y);h.onerror=()=>{c.setError(n,"{{IFRAME_ERROR}}")},n.iframeEl=h;const g=this.optionFor(n,"preload");if(n.type!=="iframe"||g===!1)return h.setAttribute("src",n.src+""),c.setContent(n,h,!1),this.resizeIframe(n),void c.revealContent(n);c.showLoading(n),h.onload=()=>{if(!h.src.length)return;const d=h.dataset.ready!=="true";h.dataset.ready="true",this.resizeIframe(n),d?c.revealContent(n):c.hideLoading(n)},h.setAttribute("src",r),c.setContent(n,h,!1)}resizeIframe(n){const{type:r,iframeEl:s}=n;if(r===Nt||r===Gt)return;const c=s==null?void 0:s.parentElement;if(!s||!c)return;let h=n.autoSize;h===void 0&&(h=this.optionFor(n,"autoSize"));let g=n.width||0,d=n.height||0;g&&d&&(h=!1);const y=c&&c.style;if(n.preload!==!1&&h!==!1&&y)try{const T=window.getComputedStyle(c),C=parseFloat(T.paddingLeft)+parseFloat(T.paddingRight),f=parseFloat(T.paddingTop)+parseFloat(T.paddingBottom),u=s.contentWindow;if(u){const p=u.document,v=p.getElementsByTagName(Yi)[0],E=p.body;y.width="",E.style.overflow="hidden",g=g||v.scrollWidth+C,y.width=`${g}px`,E.style.overflow="",y.flex="0 0 auto",y.height=`${E.scrollHeight}px`,d=v.scrollHeight+f}}catch{}if(g||d){const T={flex:"0 1 auto",width:"",height:""};g&&g!=="auto"&&(T.width=`${g}px`),d&&d!=="auto"&&(T.height=`${d}px`),Object.assign(y,T)}}playVideo(){const n=this.instance.getSlide();if(!n)return;const{el:r}=n;if(!r||!r.offsetParent||!this.optionFor(n,"videoAutoplay"))return;if(n.type===In)try{const c=r.querySelector("video");if(c){const h=c.play();h!==void 0&&h.then(()=>{}).catch(g=>{c.muted=!0,c.play()})}}catch{}if(n.type!==Nt&&n.type!==Gt)return;const s=()=>{if(n.iframeEl&&n.iframeEl.contentWindow){let c;if(n.iframeEl.dataset.ready==="true")return c=n.type===Nt?{event:"command",func:"playVideo"}:{method:"play",value:"true"},c&&n.iframeEl.contentWindow.postMessage(JSON.stringify(c),"*"),void(n.poller=void 0);n.type===Nt&&(c={event:"listening",id:n.iframeEl.getAttribute("id")},n.iframeEl.contentWindow.postMessage(JSON.stringify(c),"*"))}n.poller=setTimeout(s,250)};s()}processType(n){if(n.html)return n.type=Yi,n.src=n.html,void(n.html="");const r=this.instance.optionFor(n,"src","");if(!r||typeof r!="string")return;let s=n.type,c=null;if(c=r.match(/(youtube\.com|youtu\.be|youtube\-nocookie\.com)\/(?:watch\?(?:.*&)?v=|v\/|u\/|shorts\/|embed\/?)?(videoseries\?list=(?:.*)|[\w-]{11}|\?listType=(?:.*)&list=(?:.*))(?:.*)/i)){const h=this.optionFor(n,Nt),{nocookie:g}=h,d=function(f,u){var p={};for(var v in f)Object.prototype.hasOwnProperty.call(f,v)&&u.indexOf(v)<0&&(p[v]=f[v]);if(f!=null&&typeof Object.getOwnPropertySymbols=="function"){var E=0;for(v=Object.getOwnPropertySymbols(f);E<v.length;E++)u.indexOf(v[E])<0&&Object.prototype.propertyIsEnumerable.call(f,v[E])&&(p[v[E]]=f[v[E]])}return p}(h,["nocookie"]),y=`www.youtube${g?"-nocookie":""}.com`,T=ga(r,d),C=encodeURIComponent(c[2]);n.videoId=C,n.src=`https://${y}/embed/${C}?${T}`,n.thumbSrc=n.thumbSrc||`https://i.ytimg.com/vi/${C}/mqdefault.jpg`,s=Nt}else if(c=r.match(/^.+vimeo.com\/(?:\/)?([\d]+)((\/|\?h=)([a-z0-9]+))?(.*)?/)){const h=ga(r,this.optionFor(n,Gt)),g=encodeURIComponent(c[1]),d=c[4]||"";n.videoId=g,n.src=`https://player.vimeo.com/video/${g}?${d?`h=${d}${h?"&":""}`:""}${h}`,s=Gt}if(!s&&n.triggerEl){const h=n.triggerEl.dataset.type;Zl.includes(h)&&(s=h)}s||typeof r=="string"&&(r.charAt(0)==="#"?s="inline":(c=r.match(/\.(mp4|mov|ogv|webm)((\?|#).*)?$/i))?(s=In,n.videoFormat=n.videoFormat||"video/"+(c[1]==="ogv"?"ogg":c[1])):r.match(/(^data:image\/[a-z0-9+\/=]*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg|ico)((\?|#).*)?$)/i)?s=ma:r.match(/\.(pdf)((\?|#).*)?$/i)&&(s="pdf")),(c=r.match(/(?:maps\.)?google\.([a-z]{2,3}(?:\.[a-z]{2})?)\/(?:(?:(?:maps\/(?:place\/(?:.*)\/)?\@(.*),(\d+.?\d+?)z))|(?:\?ll=))(.*)?/i))?(n.src=`https://maps.google.${c[1]}/?ll=${(c[2]?c[2]+"&z="+Math.floor(parseFloat(c[3]))+(c[4]?c[4].replace(/^\//,"&"):""):c[4]+"").replace(/\?/,"&")}&output=${c[4]&&c[4].indexOf("layer=c")>0?"svembed":"embed"}`,s=Ki):(c=r.match(/(?:maps\.)?google\.([a-z]{2,3}(?:\.[a-z]{2})?)\/(?:maps\/search\/)(.*)/i))&&(n.src=`https://maps.google.${c[1]}/maps?q=${c[2].replace("query=","q=").replace("api=1","")}&output=embed`,s=Ki),s=s||this.instance.option("defaultType"),n.type=s,s===ma&&(n.thumbSrc=n.thumbSrc||n.src)}setContent(n){const r=this.instance.optionFor(n,"src")||"";if(n&&n.type&&r){switch(n.type){case Yi:this.instance.setContent(n,r);break;case In:const s=this.option("videoTpl");s&&this.instance.setContent(n,s.replace(/\{\{src\}\}/gi,r+"").replace(/\{\{format\}\}/gi,this.optionFor(n,"videoFormat")||"").replace(/\{\{poster\}\}/gi,n.poster||n.thumbSrc||""));break;case"inline":case"clone":this.setInlineContent(n);break;case"ajax":this.loadAjaxContent(n);break;case"pdf":case Ki:case Nt:case Gt:n.preload=!1;case"iframe":this.setIframeContent(n)}this.setAspectRatio(n)}}setAspectRatio(n){const r=n.contentEl;if(!(n.el&&r&&n.type&&[Nt,Gt,In].includes(n.type)))return;let s,c=n.width||"auto",h=n.height||"auto";if(c==="auto"||h==="auto"){s=this.optionFor(n,"videoRatio");const T=(s+"").match(/(\d+)\s*\/\s?(\d+)/);s=T&&T.length>2?parseFloat(T[1])/parseFloat(T[2]):parseFloat(s+"")}else c&&h&&(s=c/h);if(!s)return;r.style.aspectRatio="",r.style.width="",r.style.height="",r.offsetHeight;const g=r.getBoundingClientRect(),d=g.width||1,y=g.height||1;r.style.aspectRatio=s+"",s<d/y?(h=h==="auto"?y:Math.min(y,h),r.style.width="auto",r.style.height=`${h}px`):(c=c==="auto"?d:Math.min(d,c),r.style.width=`${c}px`,r.style.height="auto")}attach(){const n=this,r=n.instance;r.on("Carousel.beforeInitSlide",n.onBeforeInitSlide),r.on("Carousel.createSlide",n.onCreateSlide),r.on("Carousel.selectSlide",n.onSelectSlide),r.on("Carousel.unselectSlide",n.onUnselectSlide),r.on("Carousel.Panzoom.refresh",n.onRefresh),r.on("done",n.onDone),r.on("clearContent",n.onClearContent),window.addEventListener("message",n.onMessage)}detach(){const n=this,r=n.instance;r.off("Carousel.beforeInitSlide",n.onBeforeInitSlide),r.off("Carousel.createSlide",n.onCreateSlide),r.off("Carousel.selectSlide",n.onSelectSlide),r.off("Carousel.unselectSlide",n.onUnselectSlide),r.off("Carousel.Panzoom.refresh",n.onRefresh),r.off("done",n.onDone),r.off("clearContent",n.onClearContent),window.removeEventListener("message",n.onMessage)}}Object.defineProperty(io,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:Gl});const ai="play",oi="pause",Nn="ready";class ro extends Mt{constructor(){super(...arguments),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:Nn}),Object.defineProperty(this,"inHover",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"timer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"progressBar",{enumerable:!0,configurable:!0,writable:!0,value:null})}get isActive(){return this.state!==Nn}onReady(n){this.option("autoStart")&&(n.isInfinite||n.page<n.pages.length-1)&&this.start()}onChange(){this.removeProgressBar(),this.pause()}onSettle(){this.resume()}onVisibilityChange(){document.visibilityState==="visible"?this.resume():this.pause()}onMouseEnter(){this.inHover=!0,this.pause()}onMouseLeave(){var n;this.inHover=!1,!((n=this.instance.panzoom)===null||n===void 0)&&n.isResting&&this.resume()}onTimerEnd(){const n=this.instance;this.state==="play"&&(n.isInfinite||n.page!==n.pages.length-1?n.slideNext():n.slideTo(0))}removeProgressBar(){this.progressBar&&(this.progressBar.remove(),this.progressBar=null)}createProgressBar(){var n;if(!this.option("showProgress"))return null;this.removeProgressBar();const r=this.instance,s=((n=r.pages[r.page])===null||n===void 0?void 0:n.slides)||[];let c=this.option("progressParentEl");if(c||(c=(s.length===1?s[0].el:null)||r.viewport),!c)return null;const h=document.createElement("div");return de(h,"f-progress"),c.prepend(h),this.progressBar=h,h.offsetHeight,h}set(){const n=this,r=n.instance;if(r.pages.length<2||n.timer)return;const s=n.option("timeout");n.state=ai,de(r.container,"has-autoplay");let c=n.createProgressBar();c&&(c.style.transitionDuration=`${s}ms`,c.style.transform="scaleX(1)"),n.timer=setTimeout(()=>{n.timer=null,n.inHover||n.onTimerEnd()},s),n.emit("set")}clear(){const n=this;n.timer&&(clearTimeout(n.timer),n.timer=null),n.removeProgressBar()}start(){const n=this;if(n.set(),n.state!==Nn){if(n.option("pauseOnHover")){const r=n.instance.container;r.addEventListener("mouseenter",n.onMouseEnter,!1),r.addEventListener("mouseleave",n.onMouseLeave,!1)}document.addEventListener("visibilitychange",n.onVisibilityChange,!1),n.emit("start")}}stop(){const n=this,r=n.state,s=n.instance.container;n.clear(),n.state=Nn,s.removeEventListener("mouseenter",n.onMouseEnter,!1),s.removeEventListener("mouseleave",n.onMouseLeave,!1),document.removeEventListener("visibilitychange",n.onVisibilityChange,!1),De(s,"has-autoplay"),r!==Nn&&n.emit("stop")}pause(){const n=this;n.state===ai&&(n.state=oi,n.clear(),n.emit(oi))}resume(){const n=this,r=n.instance;if(r.isInfinite||r.page!==r.pages.length-1)if(n.state!==ai){if(n.state===oi&&!n.inHover){const s=new Event("resume",{bubbles:!0,cancelable:!0});n.emit("resume",s),s.defaultPrevented||n.set()}}else n.set();else n.stop()}toggle(){this.state===ai||this.state===oi?this.stop():this.start()}attach(){const n=this,r=n.instance;r.on("ready",n.onReady),r.on("Panzoom.startAnimation",n.onChange),r.on("Panzoom.endAnimation",n.onSettle),r.on("Panzoom.touchMove",n.onChange)}detach(){const n=this,r=n.instance;r.off("ready",n.onReady),r.off("Panzoom.startAnimation",n.onChange),r.off("Panzoom.endAnimation",n.onSettle),r.off("Panzoom.touchMove",n.onChange),n.stop()}}Object.defineProperty(ro,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{autoStart:!0,pauseOnHover:!0,progressParentEl:null,showProgress:!0,timeout:3e3}});class ao extends Mt{constructor(){super(...arguments),Object.defineProperty(this,"ref",{enumerable:!0,configurable:!0,writable:!0,value:null})}onPrepare(n){const r=n.carousel;if(!r)return;const s=n.container;s&&(r.options.Autoplay=ht({autoStart:!1},this.option("Autoplay")||{},{pauseOnHover:!1,timeout:this.option("timeout"),progressParentEl:()=>this.option("progressParentEl")||null,on:{start:()=>{n.emit("startSlideshow")},set:c=>{var h;s.classList.add("has-slideshow"),((h=n.getSlide())===null||h===void 0?void 0:h.state)!==rt.Ready&&c.pause()},stop:()=>{s.classList.remove("has-slideshow"),n.isCompact||n.endIdle(),n.emit("endSlideshow")},resume:(c,h)=>{var g,d,y;!h||!h.cancelable||((g=n.getSlide())===null||g===void 0?void 0:g.state)===rt.Ready&&(!((y=(d=n.carousel)===null||d===void 0?void 0:d.panzoom)===null||y===void 0)&&y.isResting)||h.preventDefault()}}}),r.attachPlugins({Autoplay:ro}),this.ref=r.plugins.Autoplay)}onReady(n){const r=n.carousel,s=this.ref;s&&r&&this.option("playOnStart")&&(r.isInfinite||r.page<r.pages.length-1)&&s.start()}onDone(n,r){const s=this.ref,c=n.carousel;if(!s||!c)return;const h=r.panzoom;h&&h.on("startAnimation",()=>{n.isCurrentSlide(r)&&s.stop()}),n.isCurrentSlide(r)&&s.resume()}onKeydown(n,r){var s;const c=this.ref;c&&r===this.option("key")&&((s=document.activeElement)===null||s===void 0?void 0:s.nodeName)!=="BUTTON"&&c.toggle()}attach(){const n=this,r=n.instance;r.on("Carousel.init",n.onPrepare),r.on("Carousel.ready",n.onReady),r.on("done",n.onDone),r.on("keydown",n.onKeydown)}detach(){const n=this,r=n.instance;r.off("Carousel.init",n.onPrepare),r.off("Carousel.ready",n.onReady),r.off("done",n.onDone),r.off("keydown",n.onKeydown)}}Object.defineProperty(ao,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{key:" ",playOnStart:!1,progressParentEl:w=>{var n;return((n=w.instance.container)===null||n===void 0?void 0:n.querySelector(".fancybox__toolbar [data-fancybox-toggle-slideshow]"))||w.instance.container},timeout:3e3}});const oo={classes:{container:"f-thumbs f-carousel__thumbs",viewport:"f-thumbs__viewport",track:"f-thumbs__track",slide:"f-thumbs__slide",isResting:"is-resting",isSelected:"is-selected",isLoading:"is-loading",hasThumbs:"has-thumbs"},minCount:2,parentEl:null,thumbTpl:'<button class="f-thumbs__slide__button" tabindex="0" type="button" aria-label="{{GOTO}}" data-carousel-index="%i"><img class="f-thumbs__slide__img" data-lazy-src="{{%s}}" alt="" /></button>',type:"modern"};var Bt;(function(w){w[w.Init=0]="Init",w[w.Ready=1]="Ready",w[w.Hidden=2]="Hidden"})(Bt||(Bt={}));const va="isResting",si="thumbWidth",yn="thumbHeight",Lt="thumbClipWidth";let so=class extends Mt{constructor(){super(...arguments),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:"modern"}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"track",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"carousel",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"thumbWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbClipWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbGap",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbExtraGap",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:Bt.Init})}get isModern(){return this.type==="modern"}onInitSlide(w,n){const r=n.el?n.el.dataset:void 0;r&&(n.thumbSrc=r.thumbSrc||n.thumbSrc||"",n[Lt]=parseFloat(r[Lt]||"")||n[Lt]||0,n[yn]=parseFloat(r.thumbHeight||"")||n[yn]||0),this.addSlide(n)}onInitSlides(){this.build()}onChange(){var w;if(!this.isModern)return;const n=this.container,r=this.instance,s=r.panzoom,c=this.carousel,h=c?c.panzoom:null,g=r.page;if(s&&c&&h){if(s.isDragging){De(n,this.cn(va));let d=((w=c.pages[g])===null||w===void 0?void 0:w.pos)||0;d+=r.getProgress(g)*(this[Lt]+this.thumbGap);let y=h.getBounds();-1*d>y.x.min&&-1*d<y.x.max&&h.panTo({x:-1*d,friction:.12})}else Dt(n,this.cn(va),s.isResting);this.shiftModern()}}onRefresh(){this.updateProps();for(const w of this.instance.slides||[])this.resizeModernSlide(w);this.shiftModern()}isDisabled(){const w=this.option("minCount")||0;if(w){const r=this.instance;let s=0;for(const c of r.slides||[])c.thumbSrc&&s++;if(s<w)return!0}const n=this.option("type");return["modern","classic"].indexOf(n)<0}getThumb(w){const n=this.option("thumbTpl")||"";return{html:this.instance.localize(n,[["%i",w.index],["%d",w.index+1],["%s",w.thumbSrc||"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"]])}}addSlide(w){const n=this.carousel;n&&n.addSlide(w.index,this.getThumb(w))}getSlides(){const w=[];for(const n of this.instance.slides||[])w.push(this.getThumb(n));return w}resizeModernSlide(w){this.isModern&&(w[si]=w[Lt]&&w[yn]?Math.round(this[yn]*(w[Lt]/w[yn])):this[si])}updateProps(){const w=this.container;if(!w)return;const n=r=>parseFloat(getComputedStyle(w).getPropertyValue("--f-thumb-"+r))||0;this.thumbGap=n("gap"),this.thumbExtraGap=n("extra-gap"),this[si]=n("width")||40,this[Lt]=n("clip-width")||40,this[yn]=n("height")||40}build(){const w=this;if(w.state!==Bt.Init)return;if(w.isDisabled())return void w.emit("disabled");const n=w.instance,r=n.container,s=w.getSlides(),c=w.option("type");w.type=c;const h=w.option("parentEl"),g=w.cn("container"),d=w.cn("track");let y=h==null?void 0:h.querySelector("."+g);y||(y=document.createElement("div"),de(y,g),h?h.appendChild(y):r.after(y)),de(y,`is-${c}`),de(r,w.cn("hasThumbs")),w.container=y,w.updateProps();let T=y.querySelector("."+d);T||(T=document.createElement("div"),de(T,w.cn("track")),y.appendChild(T)),w.track=T;const C=ht({},{track:T,infinite:!1,center:!0,fill:c==="classic",dragFree:!0,slidesPerPage:1,transition:!1,preload:.25,friction:.12,Panzoom:{maxVelocity:0},Dots:!1,Navigation:!1,classes:{container:"f-thumbs",viewport:"f-thumbs__viewport",track:"f-thumbs__track",slide:"f-thumbs__slide"}},w.option("Carousel")||{},{Sync:{target:n},slides:s}),f=new n.constructor(y,C);f.on("createSlide",(u,p)=>{w.setProps(p.index),w.emit("createSlide",p,p.el)}),f.on("ready",()=>{w.shiftModern(),w.emit("ready")}),f.on("refresh",()=>{w.shiftModern()}),f.on("Panzoom.click",(u,p,v)=>{w.onClick(v)}),w.carousel=f,w.state=Bt.Ready}onClick(w){w.preventDefault(),w.stopPropagation();const n=this.instance,{pages:r,page:s}=n,c=E=>{if(E){const b=E.closest("[data-carousel-index]");if(b)return[parseInt(b.dataset.carouselIndex||"",10)||0,b]}return[-1,void 0]},h=(E,b)=>{const k=document.elementFromPoint(E,b);return k?c(k):[-1,void 0]};let[g,d]=c(w.target);if(g>-1)return;const y=this[Lt],T=w.clientX,C=w.clientY;let[f,u]=h(T-y,C),[p,v]=h(T+y,C);u&&v?(g=Math.abs(T-u.getBoundingClientRect().right)<Math.abs(T-v.getBoundingClientRect().left)?f:p,g===s&&(g=g===f?p:f)):u?g=f:v&&(g=p),g>-1&&r[g]&&n.slideTo(g)}getShift(w){var n;const r=this,{instance:s}=r,c=r.carousel;if(!s||!c)return 0;const h=r[si],g=r[Lt],d=r.thumbGap,y=r.thumbExtraGap;if(!(!((n=c.slides[w])===null||n===void 0)&&n.el))return 0;const T=.5*(h-g),C=s.pages.length-1;let f=s.getProgress(0),u=s.getProgress(C),p=s.getProgress(w,!1,!0),v=0,E=T+y+d;const b=f<0&&f>-1,k=u>0&&u<1;return w===0?(v=E*Math.abs(f),k&&f===1&&(v-=E*Math.abs(u))):w===C?(v=E*Math.abs(u)*-1,b&&u===-1&&(v+=E*Math.abs(f))):b||k?(v=-1*E,v+=E*Math.abs(f),v+=E*(1-Math.abs(u))):v=E*p,v}setProps(w){var n;const r=this;if(!r.isModern)return;const{instance:s}=r,c=r.carousel;if(s&&c){const h=(n=c.slides[w])===null||n===void 0?void 0:n.el;if(h&&h.childNodes.length){let g=ee(1-Math.abs(s.getProgress(w))),d=ee(r.getShift(w));h.style.setProperty("--progress",g?g+"":""),h.style.setProperty("--shift",d+"")}}}shiftModern(){const w=this;if(!w.isModern)return;const{instance:n,track:r}=w,s=n.panzoom,c=w.carousel;if(!(n&&r&&s&&c)||s.state===Oe.Init||s.state===Oe.Destroy)return;for(const g of n.slides)w.setProps(g.index);let h=(w[Lt]+w.thumbGap)*(c.slides.length||0);r.style.setProperty("--width",h+"")}cleanup(){const w=this;w.carousel&&w.carousel.destroy(),w.carousel=null,w.container&&w.container.remove(),w.container=null,w.track&&w.track.remove(),w.track=null,w.state=Bt.Init,De(w.instance.container,w.cn("hasThumbs"))}attach(){const w=this,n=w.instance;n.on("initSlide",w.onInitSlide),n.state===Ye.Init?n.on("initSlides",w.onInitSlides):w.onInitSlides(),n.on(["change","Panzoom.afterTransform"],w.onChange),n.on("Panzoom.refresh",w.onRefresh)}detach(){const w=this,n=w.instance;n.off("initSlide",w.onInitSlide),n.off("initSlides",w.onInitSlides),n.off(["change","Panzoom.afterTransform"],w.onChange),n.off("Panzoom.refresh",w.onRefresh),w.cleanup()}};Object.defineProperty(so,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:oo});const Xl=Object.assign(Object.assign({},oo),{key:"t",showOnStart:!0,parentEl:null}),ya="is-masked",ba="aria-hidden";class lo extends Mt{constructor(){super(...arguments),Object.defineProperty(this,"ref",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hidden",{enumerable:!0,configurable:!0,writable:!0,value:!1})}get isEnabled(){const n=this.ref;return n&&!n.isDisabled()}get isHidden(){return this.hidden}onClick(n,r){r.stopPropagation()}onCreateSlide(n,r){var s,c,h;const g=((h=(c=(s=this.instance)===null||s===void 0?void 0:s.carousel)===null||c===void 0?void 0:c.slides[r.index])===null||h===void 0?void 0:h.type)||"",d=r.el;if(d&&g){let y=`for-${g}`;["video","youtube","vimeo","html5video"].includes(g)&&(y+=" for-video"),de(d,y)}}onInit(){var n;const r=this,s=r.instance,c=s.carousel;if(r.ref||!c)return;const h=r.option("parentEl")||s.footer||s.container;if(!h)return;const g=ht({},r.options,{parentEl:h,classes:{container:"f-thumbs fancybox__thumbs"},Carousel:{Sync:{friction:s.option("Carousel.friction")||0}},on:{ready:d=>{const y=d.container;y&&this.hidden&&(r.refresh(),y.style.transition="none",r.hide(),y.offsetHeight,queueMicrotask(()=>{y.style.transition="",r.show()}))}}});g.Carousel=g.Carousel||{},g.Carousel.on=ht(((n=r.options.Carousel)===null||n===void 0?void 0:n.on)||{},{click:this.onClick,createSlide:this.onCreateSlide}),c.options.Thumbs=g,c.attachPlugins({Thumbs:so}),r.ref=c.plugins.Thumbs,r.option("showOnStart")||(r.ref.state=Bt.Hidden,r.hidden=!0)}onResize(){var n;const r=(n=this.ref)===null||n===void 0?void 0:n.container;r&&(r.style.maxHeight="")}onKeydown(n,r){const s=this.option("key");s&&s===r&&this.toggle()}toggle(){const n=this.ref;if(n&&!n.isDisabled())return n.state===Bt.Hidden?(n.state=Bt.Init,void n.build()):void(this.hidden?this.show():this.hide())}show(){const n=this.ref;if(!n||n.isDisabled())return;const r=n.container;r&&(this.refresh(),r.offsetHeight,r.removeAttribute(ba),r.classList.remove(ya),this.hidden=!1)}hide(){const n=this.ref,r=n&&n.container;r&&(this.refresh(),r.offsetHeight,r.classList.add(ya),r.setAttribute(ba,"true")),this.hidden=!0}refresh(){const n=this.ref;if(!n||!n.state)return;const r=n.container,s=(r==null?void 0:r.firstChild)||null;r&&s&&s.childNodes.length&&(r.style.maxHeight=`${s.getBoundingClientRect().height}px`)}attach(){const n=this,r=n.instance;r.state===Qe.Init?r.on("Carousel.init",n.onInit):n.onInit(),r.on("resize",n.onResize),r.on("keydown",n.onKeydown)}detach(){var n;const r=this,s=r.instance;s.off("Carousel.init",r.onInit),s.off("resize",r.onResize),s.off("keydown",r.onKeydown),(n=s.carousel)===null||n===void 0||n.detachPlugins(["Thumbs"]),r.ref=null}}Object.defineProperty(lo,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:Xl});const Gi={panLeft:{icon:'<svg><path d="M5 12h14M5 12l6 6M5 12l6-6"/></svg>',change:{panX:-100}},panRight:{icon:'<svg><path d="M5 12h14M13 18l6-6M13 6l6 6"/></svg>',change:{panX:100}},panUp:{icon:'<svg><path d="M12 5v14M18 11l-6-6M6 11l6-6"/></svg>',change:{panY:-100}},panDown:{icon:'<svg><path d="M12 5v14M18 13l-6 6M6 13l6 6"/></svg>',change:{panY:100}},zoomIn:{icon:'<svg><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M11 8v6M8 11h6"/></svg>',action:"zoomIn"},zoomOut:{icon:'<svg><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M8 11h6"/></svg>',action:"zoomOut"},toggle1to1:{icon:'<svg><path d="M3.51 3.07c5.74.02 11.48-.02 17.22.02 1.37.1 2.34 1.64 2.18 3.13 0 4.08.02 8.16 0 12.23-.1 1.54-1.47 2.64-2.79 2.46-5.61-.01-11.24.02-16.86-.01-1.36-.12-2.33-1.65-2.17-3.14 0-4.07-.02-8.16 0-12.23.1-1.36 1.22-2.48 2.42-2.46Z"/><path d="M5.65 8.54h1.49v6.92m8.94-6.92h1.49v6.92M11.5 9.4v.02m0 5.18v0"/></svg>',action:"toggleZoom"},toggleZoom:{icon:'<svg><g><line x1="11" y1="8" x2="11" y2="14"></line></g><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M8 11h6"/></svg>',action:"toggleZoom"},iterateZoom:{icon:'<svg><g><line x1="11" y1="8" x2="11" y2="14"></line></g><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M8 11h6"/></svg>',action:"iterateZoom"},rotateCCW:{icon:'<svg><path d="M15 4.55a8 8 0 0 0-6 14.9M9 15v5H4M18.37 7.16v.01M13 19.94v.01M16.84 18.37v.01M19.37 15.1v.01M19.94 11v.01"/></svg>',action:"rotateCCW"},rotateCW:{icon:'<svg><path d="M9 4.55a8 8 0 0 1 6 14.9M15 15v5h5M5.63 7.16v.01M4.06 11v.01M4.63 15.1v.01M7.16 18.37v.01M11 19.94v.01"/></svg>',action:"rotateCW"},flipX:{icon:'<svg style="stroke-width: 1.3"><path d="M12 3v18M16 7v10h5L16 7M8 7v10H3L8 7"/></svg>',action:"flipX"},flipY:{icon:'<svg style="stroke-width: 1.3"><path d="M3 12h18M7 16h10L7 21v-5M7 8h10L7 3v5"/></svg>',action:"flipY"},fitX:{icon:'<svg><path d="M4 12V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v6M10 18H3M21 18h-7M6 15l-3 3 3 3M18 15l3 3-3 3"/></svg>',action:"fitX"},fitY:{icon:'<svg><path d="M12 20H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h6M18 14v7M18 3v7M15 18l3 3 3-3M15 6l3-3 3 3"/></svg>',action:"fitY"},reset:{icon:'<svg><path d="M20 11A8.1 8.1 0 0 0 4.5 9M4 5v4h4M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4"/></svg>',action:"reset"},toggleFS:{icon:'<svg><g><path d="M14.5 9.5 21 3m0 0h-6m6 0v6M3 21l6.5-6.5M3 21v-6m0 6h6"/></g><g><path d="m14 10 7-7m-7 7h6m-6 0V4M3 21l7-7m0 0v6m0-6H4"/></g></svg>',action:"toggleFS"}};var tn;(function(w){w[w.Init=0]="Init",w[w.Ready=1]="Ready",w[w.Disabled=2]="Disabled"})(tn||(tn={}));const Jl={absolute:"auto",display:{left:["infobar"],middle:[],right:["iterateZoom","slideshow","fullscreen","thumbs","close"]},enabled:"auto",items:{infobar:{tpl:'<div class="fancybox__infobar" tabindex="-1"><span data-fancybox-current-index></span>/<span data-fancybox-count></span></div>'},download:{tpl:'<a class="f-button" title="{{DOWNLOAD}}" data-fancybox-download href="javasript:;"><svg><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2M7 11l5 5 5-5M12 4v12"/></svg></a>'},prev:{tpl:'<button class="f-button" title="{{PREV}}" data-fancybox-prev><svg><path d="m15 6-6 6 6 6"/></svg></button>'},next:{tpl:'<button class="f-button" title="{{NEXT}}" data-fancybox-next><svg><path d="m9 6 6 6-6 6"/></svg></button>'},slideshow:{tpl:'<button class="f-button" title="{{TOGGLE_SLIDESHOW}}" data-fancybox-toggle-slideshow><svg><g><path d="M8 4v16l13 -8z"></path></g><g><path d="M8 4v15M17 4v15"/></g></svg></button>'},fullscreen:{tpl:'<button class="f-button" title="{{TOGGLE_FULLSCREEN}}" data-fancybox-toggle-fullscreen><svg><g><path d="M4 8V6a2 2 0 0 1 2-2h2M4 16v2a2 2 0 0 0 2 2h2M16 4h2a2 2 0 0 1 2 2v2M16 20h2a2 2 0 0 0 2-2v-2"/></g><g><path d="M15 19v-2a2 2 0 0 1 2-2h2M15 5v2a2 2 0 0 0 2 2h2M5 15h2a2 2 0 0 1 2 2v2M5 9h2a2 2 0 0 0 2-2V5"/></g></svg></button>'},thumbs:{tpl:'<button class="f-button" title="{{TOGGLE_THUMBS}}" data-fancybox-toggle-thumbs><svg><circle cx="5.5" cy="5.5" r="1"/><circle cx="12" cy="5.5" r="1"/><circle cx="18.5" cy="5.5" r="1"/><circle cx="5.5" cy="12" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="18.5" cy="12" r="1"/><circle cx="5.5" cy="18.5" r="1"/><circle cx="12" cy="18.5" r="1"/><circle cx="18.5" cy="18.5" r="1"/></svg></button>'},close:{tpl:'<button class="f-button" title="{{CLOSE}}" data-fancybox-close><svg><path d="m19.5 4.5-15 15M4.5 4.5l15 15"/></svg></button>'}},parentEl:null},Ql={tabindex:"-1",width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},wa="has-toolbar",Zi="fancybox__toolbar";class co extends Mt{constructor(){super(...arguments),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:tn.Init}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null})}onReady(n){var r;if(!n.carousel)return;let s=this.option("display"),c=this.option("absolute"),h=this.option("enabled");if(h==="auto"){const T=this.instance.carousel;let C=0;if(T)for(const f of T.slides)(f.panzoom||f.type==="image")&&C++;C||(h=!1)}h||(s=void 0);let g=0;const d={left:[],middle:[],right:[]};if(s)for(const T of["left","middle","right"])for(const C of s[T]){const f=this.createEl(C);f&&((r=d[T])===null||r===void 0||r.push(f),g++)}let y=null;if(g&&(y=this.createContainer()),y){for(const[T,C]of Object.entries(d)){const f=document.createElement("div");de(f,Zi+"__column is-"+T);for(const u of C)f.appendChild(u);c!=="auto"||T!=="middle"||C.length||(c=!0),y.appendChild(f)}c===!0&&de(y,"is-absolute"),this.state=tn.Ready,this.onRefresh()}else this.state=tn.Disabled}onClick(n){var r,s;const c=this.instance,h=c.getSlide(),g=h==null?void 0:h.panzoom,d=n.target,y=d&&ft(d)?d.dataset:null;if(!y)return;if(y.fancyboxToggleThumbs!==void 0)return n.preventDefault(),n.stopPropagation(),void((r=c.plugins.Thumbs)===null||r===void 0||r.toggle());if(y.fancyboxToggleFullscreen!==void 0)return n.preventDefault(),n.stopPropagation(),void this.instance.toggleFullscreen();if(y.fancyboxToggleSlideshow!==void 0){n.preventDefault(),n.stopPropagation();const f=(s=c.carousel)===null||s===void 0?void 0:s.plugins.Autoplay;let u=f.isActive;return g&&g.panMode==="mousemove"&&!u&&g.reset(),void(u?f.stop():f.start())}const T=y.panzoomAction,C=y.panzoomChange;if((C||T)&&(n.preventDefault(),n.stopPropagation()),C){let f={};try{f=JSON.parse(C)}catch{}g&&g.applyChange(f)}else T&&g&&g[T]&&g[T]()}onChange(){this.onRefresh()}onRefresh(){if(this.instance.isClosing())return;const n=this.container;if(!n)return;const r=this.instance.getSlide();if(!r||r.state!==rt.Ready)return;const s=r&&!r.error&&r.panzoom;for(const g of n.querySelectorAll("[data-panzoom-action]"))s?(g.removeAttribute("disabled"),g.removeAttribute("tabindex")):(g.setAttribute("disabled",""),g.setAttribute("tabindex","-1"));let c=s&&s.canZoomIn(),h=s&&s.canZoomOut();for(const g of n.querySelectorAll('[data-panzoom-action="zoomIn"]'))c?(g.removeAttribute("disabled"),g.removeAttribute("tabindex")):(g.setAttribute("disabled",""),g.setAttribute("tabindex","-1"));for(const g of n.querySelectorAll('[data-panzoom-action="zoomOut"]'))h?(g.removeAttribute("disabled"),g.removeAttribute("tabindex")):(g.setAttribute("disabled",""),g.setAttribute("tabindex","-1"));for(const g of n.querySelectorAll('[data-panzoom-action="toggleZoom"],[data-panzoom-action="iterateZoom"]')){h||c?(g.removeAttribute("disabled"),g.removeAttribute("tabindex")):(g.setAttribute("disabled",""),g.setAttribute("tabindex","-1"));const d=g.querySelector("g");d&&(d.style.display=c?"":"none")}}onDone(n,r){var s;(s=r.panzoom)===null||s===void 0||s.on("afterTransform",()=>{this.instance.isCurrentSlide(r)&&this.onRefresh()}),this.instance.isCurrentSlide(r)&&this.onRefresh()}createContainer(){const n=this.instance.container;if(!n)return null;const r=this.option("parentEl")||n;let s=r.querySelector("."+Zi);return s||(s=document.createElement("div"),de(s,Zi),r.prepend(s)),s.addEventListener("click",this.onClick,{passive:!1,capture:!0}),n&&de(n,wa),this.container=s,s}createEl(n){const r=this.instance,s=r.carousel;if(!s||n==="toggleFS"||n==="fullscreen"&&!Xa())return null;let c=null;const h=s.slides.length||0;let g=0,d=0;for(const T of s.slides)(T.panzoom||T.type==="image")&&g++,(T.type==="image"||T.downloadSrc)&&d++;if(h<2&&["infobar","prev","next"].includes(n))return c;if(Gi[n]!==void 0&&!g||n==="download"&&!d)return null;if(n==="thumbs"){const T=r.plugins.Thumbs;if(!T||!T.isEnabled)return null}if(n==="slideshow"&&(!s.plugins.Autoplay||h<2))return null;if(Gi[n]!==void 0){const T=Gi[n];c=document.createElement("button"),c.setAttribute("title",this.instance.localize(`{{${n.toUpperCase()}}}`)),de(c,"f-button"),T.action&&(c.dataset.panzoomAction=T.action),T.change&&(c.dataset.panzoomChange=JSON.stringify(T.change)),c.appendChild(At(this.instance.localize(T.icon)))}else{const T=(this.option("items")||[])[n];T&&(c=At(this.instance.localize(T.tpl)),typeof T.click=="function"&&c.addEventListener("click",C=>{C.preventDefault(),C.stopPropagation(),typeof T.click=="function"&&T.click.call(this,this,C)}))}const y=c==null?void 0:c.querySelector("svg");if(y)for(const[T,C]of Object.entries(Ql))y.getAttribute(T)||y.setAttribute(T,String(C));return c}removeContainer(){const n=this.container;n&&n.remove(),this.container=null,this.state=tn.Disabled;const r=this.instance.container;r&&De(r,wa)}attach(){const n=this,r=n.instance;r.on("Carousel.initSlides",n.onReady),r.on("done",n.onDone),r.on(["reveal","Carousel.change"],n.onChange),n.onReady(n.instance)}detach(){const n=this,r=n.instance;r.off("Carousel.initSlides",n.onReady),r.off("done",n.onDone),r.off(["reveal","Carousel.change"],n.onChange),n.removeContainer()}}Object.defineProperty(co,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:Jl});const ec={Hash:class extends Mt{onReady(){jn=!1}onChange(w){en&&clearTimeout(en);const{hash:n}=Ja(),{hash:r}=mi(),s=w.isOpeningSlide(w.getSlide());s&&(ha=r===n?"":r),n&&n!==r&&(en=setTimeout(()=>{try{if(w.state===Qe.Ready){let c="replaceState";s&&!ii&&(c="pushState",ii=!0),window.history[c]({},document.title,window.location.pathname+window.location.search+n)}}catch{}},300))}onClose(w){if(en&&clearTimeout(en),!jn&&ii)return ii=!1,jn=!1,void window.history.back();if(!jn)try{window.history.replaceState({},document.title,window.location.pathname+window.location.search+(ha||""))}catch{}}attach(){const w=this.instance;w.on("ready",this.onReady),w.on(["Carousel.ready","Carousel.change"],this.onChange),w.on("close",this.onClose)}detach(){const w=this.instance;w.off("ready",this.onReady),w.off(["Carousel.ready","Carousel.change"],this.onChange),w.off("close",this.onClose)}static parseURL(){return mi()}static startFromUrl(){Qa()}static destroy(){window.removeEventListener("hashchange",to,!1)}},Html:io,Images:no,Slideshow:ao,Thumbs:lo,Toolbar:co},Ea="with-fancybox",Xi="hide-scrollbar",Sa="--fancybox-scrollbar-compensate",Ca="--fancybox-body-margin",Ji="aria-hidden",Qi="is-using-tab",er="is-animated",Ta="is-compact",ka="is-loading",tr="is-opening",li="has-caption",bn="disabled",Zt="tabindex",Ma="download",nr="href",wn="src",$t=w=>typeof w=="string",xa=function(){var w=window.getSelection();return!!w&&w.type==="Range"};let wt,Et=null,Xt=null,_a=0,La=0,Aa=0,Da=0;const En=new Map;let tc=0;class xe extends ur{get isIdle(){return this.idle}get isCompact(){return this.option("compact")}constructor(n=[],r={},s={}){super(r),Object.defineProperty(this,"userSlides",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"userPlugins",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"idle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"idleTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"clickTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"pwt",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"ignoreFocusChange",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"startedFs",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:Qe.Init}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"footer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"carousel",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"lastFocus",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"prevMouseMoveEvent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),wt||(wt=Xa()),this.id=r.id||++tc,En.set(this.id,this),this.userSlides=n,this.userPlugins=s,queueMicrotask(()=>{this.init()})}init(){if(this.state===Qe.Destroy)return;this.state=Qe.Init,this.attachPlugins(Object.assign(Object.assign({},xe.Plugins),this.userPlugins)),this.emit("init"),this.emit("attachPlugins"),this.option("hideScrollbar")===!0&&(()=>{if(!Bn)return;const r=document,s=r.body,c=r.documentElement;if(s.classList.contains(Xi))return;let h=window.innerWidth-c.getBoundingClientRect().width;const g=parseFloat(window.getComputedStyle(s).marginRight);h<0&&(h=0),c.style.setProperty(Sa,`${h}px`),g&&s.style.setProperty(Ca,`${g}px`),s.classList.add(Xi)})(),this.initLayout(),this.scale();const n=()=>{this.initCarousel(this.userSlides),this.state=Qe.Ready,this.attachEvents(),this.emit("ready"),setTimeout(()=>{this.container&&this.container.setAttribute(Ji,"false")},16)};this.option("Fullscreen.autoStart")&&wt&&!wt.isFullscreen()?wt.request().then(()=>{this.startedFs=!0,n()}).catch(()=>n()):n()}initLayout(){var n,r;const s=this.option("parentEl")||document.body,c=At(this.localize(this.option("tpl.main")||""));if(c){if(c.setAttribute("id",`fancybox-${this.id}`),c.setAttribute("aria-label",this.localize("{{MODAL}}")),c.classList.toggle(Ta,this.isCompact),de(c,this.option("mainClass")||""),de(c,tr),this.container=c,this.footer=c.querySelector(".fancybox__footer"),s.appendChild(c),de(document.documentElement,Ea),Et&&Xt||(Et=document.createElement("span"),de(Et,"fancybox-focus-guard"),Et.setAttribute(Zt,"0"),Et.setAttribute(Ji,"true"),Et.setAttribute("aria-label","Focus guard"),Xt=Et.cloneNode(),(n=c.parentElement)===null||n===void 0||n.insertBefore(Et,c),(r=c.parentElement)===null||r===void 0||r.append(Xt)),c.addEventListener("mousedown",h=>{_a=h.pageX,La=h.pageY,De(c,Qi)}),this.option("closeExisting"))for(const h of En.values())h.id!==this.id&&h.close();else this.option("animated")&&(de(c,er),setTimeout(()=>{this.isClosing()||De(c,er)},350));this.emit("initLayout")}}initCarousel(n){const r=this.container;if(!r)return;const s=r.querySelector(".fancybox__carousel");if(!s)return;const c=this.carousel=new nn(s,ht({},{slides:n,transition:"fade",Panzoom:{lockAxis:this.option("dragToClose")?"xy":"x",infinite:!!this.option("dragToClose")&&"y"},Dots:!1,Navigation:{classes:{container:"fancybox__nav",button:"f-button",isNext:"is-next",isPrev:"is-prev"}},initialPage:this.option("startIndex"),l10n:this.option("l10n")},this.option("Carousel")||{}));c.on("*",(h,g,...d)=>{this.emit(`Carousel.${g}`,h,...d)}),c.on(["ready","change"],()=>{this.manageCaption()}),this.on("Carousel.removeSlide",(h,g,d)=>{this.clearContent(d),d.state=void 0}),c.on("Panzoom.touchStart",()=>{var h,g;this.isCompact||this.endIdle(),!((h=document.activeElement)===null||h===void 0)&&h.closest(".f-thumbs")&&((g=this.container)===null||g===void 0||g.focus())}),c.on("settle",()=>{this.idleTimer||this.isCompact||!this.option("idle")||this.setIdle(),this.option("autoFocus")&&!this.isClosing&&this.checkFocus()}),this.option("dragToClose")&&(c.on("Panzoom.afterTransform",(h,g)=>{const d=this.getSlide();if(d&&rr(d.el))return;const y=this.container;if(y){const T=Math.abs(g.current.f),C=T<1?"":Math.max(.5,Math.min(1,1-T/g.contentRect.fitHeight*1.5));y.style.setProperty("--fancybox-ts",C?"0s":""),y.style.setProperty("--fancybox-opacity",C+"")}}),c.on("Panzoom.touchEnd",(h,g,d)=>{var y;const T=this.getSlide();if(T&&rr(T.el)||g.isMobile&&document.activeElement&&["TEXTAREA","INPUT"].indexOf((y=document.activeElement)===null||y===void 0?void 0:y.nodeName)!==-1)return;const C=Math.abs(g.dragOffset.y);g.lockedAxis==="y"&&(C>=200||C>=50&&g.dragOffset.time<300)&&(d&&d.cancelable&&d.preventDefault(),this.close(d,"f-throwOut"+(g.current.f<0?"Up":"Down")))})),c.on("change",h=>{var g;let d=(g=this.getSlide())===null||g===void 0?void 0:g.triggerEl;if(d){const y=new CustomEvent("slideTo",{bubbles:!0,cancelable:!0,detail:h.page});d.dispatchEvent(y)}}),c.on(["refresh","change"],h=>{const g=this.container;if(!g)return;for(const T of g.querySelectorAll("[data-fancybox-current-index]"))T.innerHTML=h.page+1;for(const T of g.querySelectorAll("[data-fancybox-count]"))T.innerHTML=h.pages.length;if(!h.isInfinite){for(const T of g.querySelectorAll("[data-fancybox-next]"))h.page<h.pages.length-1?(T.removeAttribute(bn),T.removeAttribute(Zt)):(T.setAttribute(bn,""),T.setAttribute(Zt,"-1"));for(const T of g.querySelectorAll("[data-fancybox-prev]"))h.page>0?(T.removeAttribute(bn),T.removeAttribute(Zt)):(T.setAttribute(bn,""),T.setAttribute(Zt,"-1"))}const d=this.getSlide();if(!d)return;let y=d.downloadSrc||"";y||d.type!=="image"||d.error||!$t(d[wn])||(y=d[wn]);for(const T of g.querySelectorAll("[data-fancybox-download]")){const C=d.downloadFilename;y?(T.removeAttribute(bn),T.removeAttribute(Zt),T.setAttribute(nr,y),T.setAttribute(Ma,C||y),T.setAttribute("target","_blank")):(T.setAttribute(bn,""),T.setAttribute(Zt,"-1"),T.removeAttribute(nr),T.removeAttribute(Ma))}}),this.emit("initCarousel")}attachEvents(){const n=this,r=n.container;if(!r)return;r.addEventListener("click",n.onClick,{passive:!1,capture:!1}),r.addEventListener("wheel",n.onWheel,{passive:!1,capture:!1}),document.addEventListener("keydown",n.onKeydown,{passive:!1,capture:!0}),document.addEventListener("visibilitychange",n.onVisibilityChange,!1),document.addEventListener("mousemove",n.onMousemove),n.option("trapFocus")&&document.addEventListener("focus",n.onFocus,!0),window.addEventListener("resize",n.onResize);const s=window.visualViewport;s&&(s.addEventListener("scroll",n.onResize),s.addEventListener("resize",n.onResize))}detachEvents(){const n=this,r=n.container;if(!r)return;document.removeEventListener("keydown",n.onKeydown,{passive:!1,capture:!0}),r.removeEventListener("wheel",n.onWheel,{passive:!1,capture:!1}),r.removeEventListener("click",n.onClick,{passive:!1,capture:!1}),document.removeEventListener("mousemove",n.onMousemove),window.removeEventListener("resize",n.onResize);const s=window.visualViewport;s&&(s.removeEventListener("resize",n.onResize),s.removeEventListener("scroll",n.onResize)),document.removeEventListener("visibilitychange",n.onVisibilityChange,!1),document.removeEventListener("focus",n.onFocus,!0)}scale(){const n=this.container;if(!n)return;const r=window.visualViewport,s=Math.max(1,(r==null?void 0:r.scale)||1);let c="",h="",g="";if(r&&s>1){let d=`${r.offsetLeft}px`,y=`${r.offsetTop}px`;c=r.width*s+"px",h=r.height*s+"px",g=`translate3d(${d}, ${y}, 0) scale(${1/s})`}n.style.transform=g,n.style.width=c,n.style.height=h}onClick(n){var r;const{container:s,isCompact:c}=this;if(!s||this.isClosing())return;!c&&this.option("idle")&&this.resetIdle();const h=n.composedPath()[0];if(h.closest(".fancybox-spinner")||h.closest("[data-fancybox-close]"))return n.preventDefault(),void this.close(n);if(h.closest("[data-fancybox-prev]"))return n.preventDefault(),void this.prev();if(h.closest("[data-fancybox-next]"))return n.preventDefault(),void this.next();if(n.type==="click"&&n.detail===0||Math.abs(n.pageX-_a)>30||Math.abs(n.pageY-La)>30)return;const g=document.activeElement;if(xa()&&g&&s.contains(g))return;if(c&&((r=this.getSlide())===null||r===void 0?void 0:r.type)==="image")return void(this.clickTimer?(clearTimeout(this.clickTimer),this.clickTimer=null):this.clickTimer=setTimeout(()=>{this.toggleIdle(),this.clickTimer=null},350));if(this.emit("click",n),n.defaultPrevented)return;let d=!1;if(h.closest(".fancybox__content")){if(g){if(g.closest("[contenteditable]"))return;h.matches(Wi)||g.blur()}if(xa())return;d=this.option("contentClick")}else h.closest(".fancybox__carousel")&&!h.matches(Wi)&&(d=this.option("backdropClick"));d==="close"?(n.preventDefault(),this.close(n)):d==="next"?(n.preventDefault(),this.next()):d==="prev"&&(n.preventDefault(),this.prev())}onWheel(n){const r=n.target;let s=this.option("wheel",n);r.closest(".fancybox__thumbs")&&(s="slide");const c=s==="slide",h=[-n.deltaX||0,-n.deltaY||0,-n.detail||0].reduce(function(y,T){return Math.abs(T)>Math.abs(y)?T:y}),g=Math.max(-1,Math.min(1,h)),d=Date.now();this.pwt&&d-this.pwt<300?c&&n.preventDefault():(this.pwt=d,this.emit("wheel",n,g),n.defaultPrevented||(s==="close"?(n.preventDefault(),this.close(n)):s==="slide"&&(hi(r)||(n.preventDefault(),this[g>0?"prev":"next"]()))))}onScroll(){window.scrollTo(Aa,Da)}onKeydown(n){if(!this.isTopmost())return;this.isCompact||!this.option("idle")||this.isClosing()||this.resetIdle();const r=n.key,s=this.option("keyboard");if(!s)return;const c=n.composedPath()[0],h=document.activeElement&&document.activeElement.classList,g=h&&h.contains("f-button")||c.dataset.carouselPage||c.dataset.carouselIndex;if(r!=="Escape"&&!g&&ft(c)&&(c.isContentEditable||["TEXTAREA","OPTION","INPUT","SELECT","VIDEO"].indexOf(c.nodeName)!==-1)||(n.key==="Tab"?de(this.container,Qi):De(this.container,Qi),n.ctrlKey||n.altKey||n.shiftKey))return;this.emit("keydown",r,n);const d=s[r];d&&typeof this[d]=="function"&&(n.preventDefault(),this[d]())}onResize(){const n=this.container;if(!n)return;const r=this.isCompact;n.classList.toggle(Ta,r),this.manageCaption(this.getSlide()),this.isCompact?this.clearIdle():this.endIdle(),this.scale(),this.emit("resize")}onFocus(n){this.isTopmost()&&this.checkFocus(n)}onMousemove(n){this.prevMouseMoveEvent=n,!this.isCompact&&this.option("idle")&&this.resetIdle()}onVisibilityChange(){document.visibilityState==="visible"?this.checkFocus():this.endIdle()}manageCloseBtn(n){const r=this.optionFor(n,"closeButton")||!1;if(r==="auto"){const c=this.plugins.Toolbar;if(c&&c.state===tn.Ready)return}if(!r||!n.contentEl||n.closeBtnEl)return;const s=this.option("tpl.closeButton");if(s){const c=At(this.localize(s));n.closeBtnEl=n.contentEl.appendChild(c),n.el&&de(n.el,"has-close-btn")}}manageCaption(n=void 0){var r,s;const c="fancybox__caption",h=this.container;if(!h)return;De(h,li);const g=this.isCompact||this.option("commonCaption"),d=!g;if(this.caption&&this.stop(this.caption),d&&this.caption&&(this.caption.remove(),this.caption=null),g&&!this.caption)for(const f of((r=this.carousel)===null||r===void 0?void 0:r.slides)||[])f.captionEl&&(f.captionEl.remove(),f.captionEl=void 0,De(f.el,li),(s=f.el)===null||s===void 0||s.removeAttribute("aria-labelledby"));if(n||(n=this.getSlide()),!n||g&&!this.isCurrentSlide(n))return;const y=n.el;let T=this.optionFor(n,"caption","");if(!T)return void(g&&this.caption&&this.animate(this.caption,"f-fadeOut",()=>{this.caption&&(this.caption.innerHTML="")}));let C=null;if(d){if(C=n.captionEl||null,y&&!C){const f=c+`_${this.id}_${n.index}`;C=document.createElement("div"),de(C,c),C.setAttribute("id",f),n.captionEl=y.appendChild(C),de(y,li),y.setAttribute("aria-labelledby",f)}}else C=this.caption,C||(C=h.querySelector("."+c)),!C&&(C=document.createElement("div"),C.dataset.fancyboxCaption="",de(C,c),(this.footer||h).prepend(C)),de(h,li),this.caption=C;C&&(C.innerHTML="",$t(T)||typeof T=="number"?C.innerHTML=T+"":T instanceof HTMLElement&&C.appendChild(T))}checkFocus(n){this.focus(n)}focus(n){var r;if(this.ignoreFocusChange)return;const s=document.activeElement||null,c=(n==null?void 0:n.target)||null,h=this.container,g=(r=this.carousel)===null||r===void 0?void 0:r.viewport;if(!h||!g||!n&&s&&h.contains(s))return;const d=this.getSlide(),y=d&&d.state===rt.Ready?d.el:null;if(!y||y.contains(s)||h===s)return;n&&n.cancelable&&n.preventDefault(),this.ignoreFocusChange=!0;const T=Array.from(h.querySelectorAll(Wi));let C=[],f=null;for(let p of T){const v=!p.offsetParent||!!p.closest('[aria-hidden="true"]'),E=y&&y.contains(p),b=!g.contains(p);if(p===h||(E||b)&&!v){C.push(p);const k=p.dataset.origTabindex;k!==void 0&&k&&(p.tabIndex=parseFloat(k)),p.removeAttribute("data-orig-tabindex"),!p.hasAttribute("autoFocus")&&f||(f=p)}else{const k=p.dataset.origTabindex===void 0?p.getAttribute("tabindex")||"":p.dataset.origTabindex;k&&(p.dataset.origTabindex=k),p.tabIndex=-1}}let u=null;n?(!c||C.indexOf(c)<0)&&(u=f||h,C.length&&(s===Xt?u=C[0]:this.lastFocus!==h&&s!==Et||(u=C[C.length-1]))):u=d&&d.type==="image"?h:f||h,u&&fa(u),this.lastFocus=document.activeElement,this.ignoreFocusChange=!1}next(){const n=this.carousel;n&&n.pages.length>1&&n.slideNext()}prev(){const n=this.carousel;n&&n.pages.length>1&&n.slidePrev()}jumpTo(...n){this.carousel&&this.carousel.slideTo(...n)}isTopmost(){var n;return((n=xe.getInstance())===null||n===void 0?void 0:n.id)==this.id}animate(n=null,r="",s){if(!n||!r)return void(s&&s());this.stop(n);const c=h=>{h.target===n&&n.dataset.animationName&&(n.removeEventListener("animationend",c),delete n.dataset.animationName,s&&s(),De(n,r))};n.dataset.animationName=r,n.addEventListener("animationend",c),de(n,r)}stop(n){n&&n.dispatchEvent(new CustomEvent("animationend",{bubbles:!1,cancelable:!0,currentTarget:n}))}setContent(n,r="",s=!0){if(this.isClosing())return;const c=n.el;if(!c)return;let h=null;if(ft(r)?h=r:(h=At(r+""),ft(h)||(h=document.createElement("div"),h.innerHTML=r+"")),["img","picture","iframe","video","audio"].includes(h.nodeName.toLowerCase())){const g=document.createElement("div");g.appendChild(h),h=g}ft(h)&&n.filter&&!n.error&&(h=h.querySelector(n.filter)),h&&ft(h)?(de(h,"fancybox__content"),n.id&&h.setAttribute("id",n.id),c.classList.add(`has-${n.error?"error":n.type||"unknown"}`),c.prepend(h),h.style.display==="none"&&(h.style.display=""),getComputedStyle(h).getPropertyValue("display")==="none"&&(h.style.display=n.display||this.option("defaultDisplay")||"flex"),n.contentEl=h,s&&this.revealContent(n),this.manageCloseBtn(n),this.manageCaption(n)):this.setError(n,"{{ELEMENT_NOT_FOUND}}")}revealContent(n,r){const s=n.el,c=n.contentEl;s&&c&&(this.emit("reveal",n),this.hideLoading(n),n.state=rt.Opening,(r=this.isOpeningSlide(n)?r===void 0?this.optionFor(n,"showClass"):r:"f-fadeIn")?this.animate(c,r,()=>{this.done(n)}):this.done(n))}done(n){this.isClosing()||(n.state=rt.Ready,this.emit("done",n),de(n.el,"is-done"),this.isCurrentSlide(n)&&this.option("autoFocus")&&queueMicrotask(()=>{var r;(r=n.panzoom)===null||r===void 0||r.updateControls(),this.option("autoFocus")&&this.focus()}),this.isOpeningSlide(n)&&(De(this.container,tr),!this.isCompact&&this.option("idle")&&this.setIdle()))}isCurrentSlide(n){const r=this.getSlide();return!(!n||!r)&&r.index===n.index}isOpeningSlide(n){var r,s;return((r=this.carousel)===null||r===void 0?void 0:r.prevPage)===null&&n&&n.index===((s=this.getSlide())===null||s===void 0?void 0:s.index)}showLoading(n){n.state=rt.Loading;const r=n.el;r&&(de(r,ka),this.emit("loading",n),n.spinnerEl||setTimeout(()=>{if(!this.isClosing()&&!n.spinnerEl&&n.state===rt.Loading){let s=At(dr);de(s,"fancybox-spinner"),n.spinnerEl=s,r.prepend(s),this.animate(s,"f-fadeIn")}},250))}hideLoading(n){const r=n.el;if(!r)return;const s=n.spinnerEl;this.isClosing()?s==null||s.remove():(De(r,ka),s&&this.animate(s,"f-fadeOut",()=>{s.remove()}),n.state===rt.Loading&&(this.emit("loaded",n),n.state=rt.Ready))}setError(n,r){if(this.isClosing())return;const s=new Event("error",{bubbles:!0,cancelable:!0});if(this.emit("error",s,n),s.defaultPrevented)return;n.error=r,this.hideLoading(n),this.clearContent(n);const c=document.createElement("div");c.classList.add("fancybox-error"),c.innerHTML=this.localize(r||"<p>{{ERROR}}</p>"),this.setContent(n,c)}clearContent(n){if(n.state===void 0)return;this.emit("clearContent",n),n.contentEl&&(n.contentEl.remove(),n.contentEl=void 0);const r=n.el;r&&(De(r,"has-error"),De(r,"has-unknown"),De(r,`has-${n.type||"unknown"}`)),n.closeBtnEl&&n.closeBtnEl.remove(),n.closeBtnEl=void 0,n.captionEl&&n.captionEl.remove(),n.captionEl=void 0,n.spinnerEl&&n.spinnerEl.remove(),n.spinnerEl=void 0}getSlide(){var n;const r=this.carousel;return((n=r==null?void 0:r.pages[r==null?void 0:r.page])===null||n===void 0?void 0:n.slides[0])||void 0}close(n,r){if(this.isClosing())return;const s=new Event("shouldClose",{bubbles:!0,cancelable:!0});if(this.emit("shouldClose",s,n),s.defaultPrevented)return;n&&n.cancelable&&(n.preventDefault(),n.stopPropagation());const c=()=>{this.proceedClose(n,r)};this.startedFs&&wt&&wt.isFullscreen()?Promise.resolve(wt.exit()).then(()=>c()):c()}clearIdle(){this.idleTimer&&clearTimeout(this.idleTimer),this.idleTimer=null}setIdle(n=!1){const r=()=>{this.clearIdle(),this.idle=!0,de(this.container,"is-idle"),this.emit("setIdle")};if(this.clearIdle(),!this.isClosing())if(n)r();else{const s=this.option("idle");s&&(this.idleTimer=setTimeout(r,s))}}endIdle(){this.clearIdle(),this.idle&&!this.isClosing()&&(this.idle=!1,De(this.container,"is-idle"),this.emit("endIdle"))}resetIdle(){this.endIdle(),this.setIdle()}toggleIdle(){this.idle?this.endIdle():this.setIdle(!0)}toggleFullscreen(){wt&&(wt.isFullscreen()?wt.exit():wt.request().then(()=>{this.startedFs=!0}))}isClosing(){return[Qe.Closing,Qe.CustomClosing,Qe.Destroy].includes(this.state)}proceedClose(n,r){var s,c;this.state=Qe.Closing,this.clearIdle(),this.detachEvents();const h=this.container,g=this.carousel,d=this.getSlide(),y=d&&this.option("placeFocusBack")?d.triggerEl||this.option("triggerEl"):null;if(y&&(Za(y)?fa(y):y.focus()),h&&(De(h,tr),de(h,"is-closing"),h.setAttribute(Ji,"true"),this.option("animated")&&de(h,er),h.style.pointerEvents="none"),g){g.clearTransitions(),(s=g.panzoom)===null||s===void 0||s.destroy(),(c=g.plugins.Navigation)===null||c===void 0||c.detach();for(const T of g.slides){T.state=rt.Closing,this.hideLoading(T);const C=T.contentEl;C&&this.stop(C);const f=T==null?void 0:T.panzoom;f&&(f.stop(),f.detachEvents(),f.detachObserver()),this.isCurrentSlide(T)||g.emit("removeSlide",T)}}Aa=window.scrollX,Da=window.scrollY,window.addEventListener("scroll",this.onScroll),this.emit("close",n),this.state!==Qe.CustomClosing?(r===void 0&&d&&(r=this.optionFor(d,"hideClass")),r&&d?(this.animate(d.contentEl,r,()=>{g&&g.emit("removeSlide",d)}),setTimeout(()=>{this.destroy()},500)):this.destroy()):setTimeout(()=>{this.destroy()},500)}destroy(){var n;if(this.state===Qe.Destroy)return;window.removeEventListener("scroll",this.onScroll),this.state=Qe.Destroy,(n=this.carousel)===null||n===void 0||n.destroy();const r=this.container;r&&r.remove(),En.delete(this.id);const s=xe.getInstance();s?s.focus():(Et&&(Et.remove(),Et=null),Xt&&(Xt.remove(),Xt=null),De(document.documentElement,Ea),(()=>{if(!Bn)return;const c=document,h=c.body;h.classList.remove(Xi),h.style.setProperty(Ca,""),c.documentElement.style.setProperty(Sa,"")})(),this.emit("destroy"))}static bind(n,r,s){if(!Bn)return;let c,h="",g={};if(n===void 0?c=document.body:$t(n)?(c=document.body,h=n,typeof r=="object"&&(g=r||{})):(c=n,$t(r)&&(h=r),typeof s=="object"&&(g=s||{})),!c||!ft(c))return;h=h||"[data-fancybox]";const d=xe.openers.get(c)||new Map;d.set(h,g),xe.openers.set(c,d),d.size===1&&c.addEventListener("click",xe.fromEvent)}static unbind(n,r){let s,c="";if($t(n)?(s=document.body,c=n):(s=n,$t(r)&&(c=r)),!s)return;const h=xe.openers.get(s);h&&c&&h.delete(c),c&&h||(xe.openers.delete(s),s.removeEventListener("click",xe.fromEvent))}static destroy(){let n;for(;n=xe.getInstance();)n.destroy();for(const r of xe.openers.keys())r.removeEventListener("click",xe.fromEvent);xe.openers=new Map}static fromEvent(n){if(n.defaultPrevented||n.button&&n.button!==0||n.ctrlKey||n.metaKey||n.shiftKey)return;let r=n.composedPath()[0];const s=r.closest("[data-fancybox-trigger]");if(s){const v=s.dataset.fancyboxTrigger||"",E=document.querySelectorAll(`[data-fancybox="${v}"]`),b=parseInt(s.dataset.fancyboxIndex||"",10)||0;r=E[b]||r}if(!(r&&r instanceof Element))return;let c,h,g,d;if([...xe.openers].reverse().find(([v,E])=>!(!v.contains(r)||![...E].reverse().find(([b,k])=>{let M=r.closest(b);return!!M&&(c=v,h=b,g=M,d=k,!0)}))),!c||!h||!g)return;d=d||{},n.preventDefault(),r=g;let y=[],T=ht({},or,d);T.event=n,T.triggerEl=r,T.delegate=s;const C=T.groupAll,f=T.groupAttr,u=f&&r?r.getAttribute(`${f}`):"";if((!r||u||C)&&(y=[].slice.call(c.querySelectorAll(h))),r&&!C&&(y=u?y.filter(v=>v.getAttribute(`${f}`)===u):[r]),!y.length)return;const p=xe.getInstance();return p&&p.options.triggerEl&&y.indexOf(p.options.triggerEl)>-1?void 0:(r&&(T.startIndex=y.indexOf(r)),xe.fromNodes(y,T))}static fromSelector(n,r,s){let c=null,h="",g={};if($t(n)?(c=document.body,h=n,typeof r=="object"&&(g=r||{})):n instanceof HTMLElement&&$t(r)&&(c=n,h=r,typeof s=="object"&&(g=s||{})),!c||!h)return!1;const d=xe.openers.get(c);return!!d&&(g=ht({},d.get(h)||{},g),!!g&&xe.fromNodes(Array.from(c.querySelectorAll(h)),g))}static fromNodes(n,r){r=ht({},or,r||{});const s=[];for(const c of n){const h=c.dataset||{},g=h[wn]||c.getAttribute(nr)||c.getAttribute("currentSrc")||c.getAttribute(wn)||void 0;let d;const y=r.delegate;let T;y&&s.length===r.startIndex&&(d=y instanceof HTMLImageElement?y:y.querySelector("img:not([aria-hidden])")),d||(d=c instanceof HTMLImageElement?c:c.querySelector("img:not([aria-hidden])")),d&&(T=d.currentSrc||d[wn]||void 0,!T&&d.dataset&&(T=d.dataset.lazySrc||d.dataset[wn]||void 0));const C={src:g,triggerEl:c,thumbEl:d,thumbElSrc:T,thumbSrc:T};for(const f in h){let u=h[f]+"";u=u!=="false"&&(u==="true"||u),C[f]=u}s.push(C)}return new xe(s,r)}static getInstance(n){return n?En.get(n):Array.from(En.values()).reverse().find(r=>!r.isClosing()&&r)||null}static getSlide(){var n;return((n=xe.getInstance())===null||n===void 0?void 0:n.getSlide())||null}static show(n=[],r={}){return new xe(n,r)}static next(){const n=xe.getInstance();n&&n.next()}static prev(){const n=xe.getInstance();n&&n.prev()}static close(n=!0,...r){if(n)for(const s of En.values())s.close(...r);else{const s=xe.getInstance();s&&s.close(...r)}}}Object.defineProperty(xe,"version",{enumerable:!0,configurable:!0,writable:!0,value:"5.0.36"}),Object.defineProperty(xe,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:or}),Object.defineProperty(xe,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:ec}),Object.defineProperty(xe,"openers",{enumerable:!0,configurable:!0,writable:!0,value:new Map});function nc(w){return w&&w.__esModule&&Object.prototype.hasOwnProperty.call(w,"default")?w.default:w}var di={exports:{}};/*!
 * Vditor v3.10.9 - A markdown editor written in TypeScript.
 *
 * MIT License
 *
 * Copyright (c) 2018-present B3log 开源, b3log.org
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */var ic=di.exports,Oa;function rc(){return Oa||(Oa=1,function(w,n){(function(s,c){w.exports=c()})(ic,()=>(()=>{var r={192:g=>{var d=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},y=-1,T=1,C=0;d.Diff=function(f,u){return[f,u]},d.prototype.diff_main=function(f,u,p,v){typeof v>"u"&&(this.Diff_Timeout<=0?v=Number.MAX_VALUE:v=new Date().getTime()+this.Diff_Timeout*1e3);var E=v;if(f==null||u==null)throw new Error("Null input. (diff_main)");if(f==u)return f?[new d.Diff(C,f)]:[];typeof p>"u"&&(p=!0);var b=p,k=this.diff_commonPrefix(f,u),M=f.substring(0,k);f=f.substring(k),u=u.substring(k),k=this.diff_commonSuffix(f,u);var x=f.substring(f.length-k);f=f.substring(0,f.length-k),u=u.substring(0,u.length-k);var A=this.diff_compute_(f,u,b,E);return M&&A.unshift(new d.Diff(C,M)),x&&A.push(new d.Diff(C,x)),this.diff_cleanupMerge(A),A},d.prototype.diff_compute_=function(f,u,p,v){var E;if(!f)return[new d.Diff(T,u)];if(!u)return[new d.Diff(y,f)];var b=f.length>u.length?f:u,k=f.length>u.length?u:f,M=b.indexOf(k);if(M!=-1)return E=[new d.Diff(T,b.substring(0,M)),new d.Diff(C,k),new d.Diff(T,b.substring(M+k.length))],f.length>u.length&&(E[0][0]=E[2][0]=y),E;if(k.length==1)return[new d.Diff(y,f),new d.Diff(T,u)];var x=this.diff_halfMatch_(f,u);if(x){var A=x[0],m=x[1],O=x[2],N=x[3],H=x[4],R=this.diff_main(A,O,p,v),z=this.diff_main(m,N,p,v);return R.concat([new d.Diff(C,H)],z)}return p&&f.length>100&&u.length>100?this.diff_lineMode_(f,u,v):this.diff_bisect_(f,u,v)},d.prototype.diff_lineMode_=function(f,u,p){var v=this.diff_linesToChars_(f,u);f=v.chars1,u=v.chars2;var E=v.lineArray,b=this.diff_main(f,u,!1,p);this.diff_charsToLines_(b,E),this.diff_cleanupSemantic(b),b.push(new d.Diff(C,""));for(var k=0,M=0,x=0,A="",m="";k<b.length;){switch(b[k][0]){case T:x++,m+=b[k][1];break;case y:M++,A+=b[k][1];break;case C:if(M>=1&&x>=1){b.splice(k-M-x,M+x),k=k-M-x;for(var O=this.diff_main(A,m,!1,p),N=O.length-1;N>=0;N--)b.splice(k,0,O[N]);k=k+O.length}x=0,M=0,A="",m="";break}k++}return b.pop(),b},d.prototype.diff_bisect_=function(f,u,p){for(var v=f.length,E=u.length,b=Math.ceil((v+E)/2),k=b,M=2*b,x=new Array(M),A=new Array(M),m=0;m<M;m++)x[m]=-1,A[m]=-1;x[k+1]=0,A[k+1]=0;for(var O=v-E,N=O%2!=0,H=0,R=0,z=0,Y=0,K=0;K<b&&!(new Date().getTime()>p);K++){for(var re=-K+H;re<=K-R;re+=2){var pe=k+re,we;re==-K||re!=K&&x[pe-1]<x[pe+1]?we=x[pe+1]:we=x[pe-1]+1;for(var ge=we-re;we<v&&ge<E&&f.charAt(we)==u.charAt(ge);)we++,ge++;if(x[pe]=we,we>v)R+=2;else if(ge>E)H+=2;else if(N){var ie=k+O-re;if(ie>=0&&ie<M&&A[ie]!=-1){var fe=v-A[ie];if(we>=fe)return this.diff_bisectSplit_(f,u,we,ge,p)}}}for(var Ae=-K+z;Ae<=K-Y;Ae+=2){var ie=k+Ae,fe;Ae==-K||Ae!=K&&A[ie-1]<A[ie+1]?fe=A[ie+1]:fe=A[ie-1]+1;for(var Fe=fe-Ae;fe<v&&Fe<E&&f.charAt(v-fe-1)==u.charAt(E-Fe-1);)fe++,Fe++;if(A[ie]=fe,fe>v)Y+=2;else if(Fe>E)z+=2;else if(!N){var pe=k+O-Ae;if(pe>=0&&pe<M&&x[pe]!=-1){var we=x[pe],ge=k+we-pe;if(fe=v-fe,we>=fe)return this.diff_bisectSplit_(f,u,we,ge,p)}}}}return[new d.Diff(y,f),new d.Diff(T,u)]},d.prototype.diff_bisectSplit_=function(f,u,p,v,E){var b=f.substring(0,p),k=u.substring(0,v),M=f.substring(p),x=u.substring(v),A=this.diff_main(b,k,!1,E),m=this.diff_main(M,x,!1,E);return A.concat(m)},d.prototype.diff_linesToChars_=function(f,u){var p=[],v={};p[0]="";function E(x){for(var A="",m=0,O=-1,N=p.length;O<x.length-1;){O=x.indexOf(`
`,m),O==-1&&(O=x.length-1);var H=x.substring(m,O+1);(v.hasOwnProperty?v.hasOwnProperty(H):v[H]!==void 0)?A+=String.fromCharCode(v[H]):(N==b&&(H=x.substring(m),O=x.length),A+=String.fromCharCode(N),v[H]=N,p[N++]=H),m=O+1}return A}var b=4e4,k=E(f);b=65535;var M=E(u);return{chars1:k,chars2:M,lineArray:p}},d.prototype.diff_charsToLines_=function(f,u){for(var p=0;p<f.length;p++){for(var v=f[p][1],E=[],b=0;b<v.length;b++)E[b]=u[v.charCodeAt(b)];f[p][1]=E.join("")}},d.prototype.diff_commonPrefix=function(f,u){if(!f||!u||f.charAt(0)!=u.charAt(0))return 0;for(var p=0,v=Math.min(f.length,u.length),E=v,b=0;p<E;)f.substring(b,E)==u.substring(b,E)?(p=E,b=p):v=E,E=Math.floor((v-p)/2+p);return E},d.prototype.diff_commonSuffix=function(f,u){if(!f||!u||f.charAt(f.length-1)!=u.charAt(u.length-1))return 0;for(var p=0,v=Math.min(f.length,u.length),E=v,b=0;p<E;)f.substring(f.length-E,f.length-b)==u.substring(u.length-E,u.length-b)?(p=E,b=p):v=E,E=Math.floor((v-p)/2+p);return E},d.prototype.diff_commonOverlap_=function(f,u){var p=f.length,v=u.length;if(p==0||v==0)return 0;p>v?f=f.substring(p-v):p<v&&(u=u.substring(0,p));var E=Math.min(p,v);if(f==u)return E;for(var b=0,k=1;;){var M=f.substring(E-k),x=u.indexOf(M);if(x==-1)return b;k+=x,(x==0||f.substring(E-k)==u.substring(0,k))&&(b=k,k++)}},d.prototype.diff_halfMatch_=function(f,u){if(this.Diff_Timeout<=0)return null;var p=f.length>u.length?f:u,v=f.length>u.length?u:f;if(p.length<4||v.length*2<p.length)return null;var E=this;function b(R,z,Y){for(var K=R.substring(Y,Y+Math.floor(R.length/4)),re=-1,pe="",we,ge,ie,fe;(re=z.indexOf(K,re+1))!=-1;){var Ae=E.diff_commonPrefix(R.substring(Y),z.substring(re)),Fe=E.diff_commonSuffix(R.substring(0,Y),z.substring(0,re));pe.length<Fe+Ae&&(pe=z.substring(re-Fe,re)+z.substring(re,re+Ae),we=R.substring(0,Y-Fe),ge=R.substring(Y+Ae),ie=z.substring(0,re-Fe),fe=z.substring(re+Ae))}return pe.length*2>=R.length?[we,ge,ie,fe,pe]:null}var k=b(p,v,Math.ceil(p.length/4)),M=b(p,v,Math.ceil(p.length/2)),x;if(!k&&!M)return null;M?k?x=k[4].length>M[4].length?k:M:x=M:x=k;var A,m,O,N;f.length>u.length?(A=x[0],m=x[1],O=x[2],N=x[3]):(O=x[0],N=x[1],A=x[2],m=x[3]);var H=x[4];return[A,m,O,N,H]},d.prototype.diff_cleanupSemantic=function(f){for(var u=!1,p=[],v=0,E=null,b=0,k=0,M=0,x=0,A=0;b<f.length;)f[b][0]==C?(p[v++]=b,k=x,M=A,x=0,A=0,E=f[b][1]):(f[b][0]==T?x+=f[b][1].length:A+=f[b][1].length,E&&E.length<=Math.max(k,M)&&E.length<=Math.max(x,A)&&(f.splice(p[v-1],0,new d.Diff(y,E)),f[p[v-1]+1][0]=T,v--,v--,b=v>0?p[v-1]:-1,k=0,M=0,x=0,A=0,E=null,u=!0)),b++;for(u&&this.diff_cleanupMerge(f),this.diff_cleanupSemanticLossless(f),b=1;b<f.length;){if(f[b-1][0]==y&&f[b][0]==T){var m=f[b-1][1],O=f[b][1],N=this.diff_commonOverlap_(m,O),H=this.diff_commonOverlap_(O,m);N>=H?(N>=m.length/2||N>=O.length/2)&&(f.splice(b,0,new d.Diff(C,O.substring(0,N))),f[b-1][1]=m.substring(0,m.length-N),f[b+1][1]=O.substring(N),b++):(H>=m.length/2||H>=O.length/2)&&(f.splice(b,0,new d.Diff(C,m.substring(0,H))),f[b-1][0]=T,f[b-1][1]=O.substring(0,O.length-H),f[b+1][0]=y,f[b+1][1]=m.substring(H),b++),b++}b++}},d.prototype.diff_cleanupSemanticLossless=function(f){function u(H,R){if(!H||!R)return 6;var z=H.charAt(H.length-1),Y=R.charAt(0),K=z.match(d.nonAlphaNumericRegex_),re=Y.match(d.nonAlphaNumericRegex_),pe=K&&z.match(d.whitespaceRegex_),we=re&&Y.match(d.whitespaceRegex_),ge=pe&&z.match(d.linebreakRegex_),ie=we&&Y.match(d.linebreakRegex_),fe=ge&&H.match(d.blanklineEndRegex_),Ae=ie&&R.match(d.blanklineStartRegex_);return fe||Ae?5:ge||ie?4:K&&!pe&&we?3:pe||we?2:K||re?1:0}for(var p=1;p<f.length-1;){if(f[p-1][0]==C&&f[p+1][0]==C){var v=f[p-1][1],E=f[p][1],b=f[p+1][1],k=this.diff_commonSuffix(v,E);if(k){var M=E.substring(E.length-k);v=v.substring(0,v.length-k),E=M+E.substring(0,E.length-k),b=M+b}for(var x=v,A=E,m=b,O=u(v,E)+u(E,b);E.charAt(0)===b.charAt(0);){v+=E.charAt(0),E=E.substring(1)+b.charAt(0),b=b.substring(1);var N=u(v,E)+u(E,b);N>=O&&(O=N,x=v,A=E,m=b)}f[p-1][1]!=x&&(x?f[p-1][1]=x:(f.splice(p-1,1),p--),f[p][1]=A,m?f[p+1][1]=m:(f.splice(p+1,1),p--))}p++}},d.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,d.whitespaceRegex_=/\s/,d.linebreakRegex_=/[\r\n]/,d.blanklineEndRegex_=/\n\r?\n$/,d.blanklineStartRegex_=/^\r?\n\r?\n/,d.prototype.diff_cleanupEfficiency=function(f){for(var u=!1,p=[],v=0,E=null,b=0,k=!1,M=!1,x=!1,A=!1;b<f.length;)f[b][0]==C?(f[b][1].length<this.Diff_EditCost&&(x||A)?(p[v++]=b,k=x,M=A,E=f[b][1]):(v=0,E=null),x=A=!1):(f[b][0]==y?A=!0:x=!0,E&&(k&&M&&x&&A||E.length<this.Diff_EditCost/2&&k+M+x+A==3)&&(f.splice(p[v-1],0,new d.Diff(y,E)),f[p[v-1]+1][0]=T,v--,E=null,k&&M?(x=A=!0,v=0):(v--,b=v>0?p[v-1]:-1,x=A=!1),u=!0)),b++;u&&this.diff_cleanupMerge(f)},d.prototype.diff_cleanupMerge=function(f){f.push(new d.Diff(C,""));for(var u=0,p=0,v=0,E="",b="",k;u<f.length;)switch(f[u][0]){case T:v++,b+=f[u][1],u++;break;case y:p++,E+=f[u][1],u++;break;case C:p+v>1?(p!==0&&v!==0&&(k=this.diff_commonPrefix(b,E),k!==0&&(u-p-v>0&&f[u-p-v-1][0]==C?f[u-p-v-1][1]+=b.substring(0,k):(f.splice(0,0,new d.Diff(C,b.substring(0,k))),u++),b=b.substring(k),E=E.substring(k)),k=this.diff_commonSuffix(b,E),k!==0&&(f[u][1]=b.substring(b.length-k)+f[u][1],b=b.substring(0,b.length-k),E=E.substring(0,E.length-k))),u-=p+v,f.splice(u,p+v),E.length&&(f.splice(u,0,new d.Diff(y,E)),u++),b.length&&(f.splice(u,0,new d.Diff(T,b)),u++),u++):u!==0&&f[u-1][0]==C?(f[u-1][1]+=f[u][1],f.splice(u,1)):u++,v=0,p=0,E="",b="";break}f[f.length-1][1]===""&&f.pop();var M=!1;for(u=1;u<f.length-1;)f[u-1][0]==C&&f[u+1][0]==C&&(f[u][1].substring(f[u][1].length-f[u-1][1].length)==f[u-1][1]?(f[u][1]=f[u-1][1]+f[u][1].substring(0,f[u][1].length-f[u-1][1].length),f[u+1][1]=f[u-1][1]+f[u+1][1],f.splice(u-1,1),M=!0):f[u][1].substring(0,f[u+1][1].length)==f[u+1][1]&&(f[u-1][1]+=f[u+1][1],f[u][1]=f[u][1].substring(f[u+1][1].length)+f[u+1][1],f.splice(u+1,1),M=!0)),u++;M&&this.diff_cleanupMerge(f)},d.prototype.diff_xIndex=function(f,u){var p=0,v=0,E=0,b=0,k;for(k=0;k<f.length&&(f[k][0]!==T&&(p+=f[k][1].length),f[k][0]!==y&&(v+=f[k][1].length),!(p>u));k++)E=p,b=v;return f.length!=k&&f[k][0]===y?b:b+(u-E)},d.prototype.diff_prettyHtml=function(f){for(var u=[],p=/&/g,v=/</g,E=/>/g,b=/\n/g,k=0;k<f.length;k++){var M=f[k][0],x=f[k][1],A=x.replace(p,"&amp;").replace(v,"&lt;").replace(E,"&gt;").replace(b,"&para;<br>");switch(M){case T:u[k]='<ins style="background:#e6ffe6;">'+A+"</ins>";break;case y:u[k]='<del style="background:#ffe6e6;">'+A+"</del>";break;case C:u[k]="<span>"+A+"</span>";break}}return u.join("")},d.prototype.diff_text1=function(f){for(var u=[],p=0;p<f.length;p++)f[p][0]!==T&&(u[p]=f[p][1]);return u.join("")},d.prototype.diff_text2=function(f){for(var u=[],p=0;p<f.length;p++)f[p][0]!==y&&(u[p]=f[p][1]);return u.join("")},d.prototype.diff_levenshtein=function(f){for(var u=0,p=0,v=0,E=0;E<f.length;E++){var b=f[E][0],k=f[E][1];switch(b){case T:p+=k.length;break;case y:v+=k.length;break;case C:u+=Math.max(p,v),p=0,v=0;break}}return u+=Math.max(p,v),u},d.prototype.diff_toDelta=function(f){for(var u=[],p=0;p<f.length;p++)switch(f[p][0]){case T:u[p]="+"+encodeURI(f[p][1]);break;case y:u[p]="-"+f[p][1].length;break;case C:u[p]="="+f[p][1].length;break}return u.join("	").replace(/%20/g," ")},d.prototype.diff_fromDelta=function(f,u){for(var p=[],v=0,E=0,b=u.split(/\t/g),k=0;k<b.length;k++){var M=b[k].substring(1);switch(b[k].charAt(0)){case"+":try{p[v++]=new d.Diff(T,decodeURI(M))}catch{throw new Error("Illegal escape in diff_fromDelta: "+M)}break;case"-":case"=":var x=parseInt(M,10);if(isNaN(x)||x<0)throw new Error("Invalid number in diff_fromDelta: "+M);var A=f.substring(E,E+=x);b[k].charAt(0)=="="?p[v++]=new d.Diff(C,A):p[v++]=new d.Diff(y,A);break;default:if(b[k])throw new Error("Invalid diff operation in diff_fromDelta: "+b[k])}}if(E!=f.length)throw new Error("Delta length ("+E+") does not equal source text length ("+f.length+").");return p},d.prototype.match_main=function(f,u,p){if(f==null||u==null||p==null)throw new Error("Null input. (match_main)");return p=Math.max(0,Math.min(p,f.length)),f==u?0:f.length?f.substring(p,p+u.length)==u?p:this.match_bitap_(f,u,p):-1},d.prototype.match_bitap_=function(f,u,p){if(u.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var v=this.match_alphabet_(u),E=this;function b(we,ge){var ie=we/u.length,fe=Math.abs(p-ge);return E.Match_Distance?ie+fe/E.Match_Distance:fe?1:ie}var k=this.Match_Threshold,M=f.indexOf(u,p);M!=-1&&(k=Math.min(b(0,M),k),M=f.lastIndexOf(u,p+u.length),M!=-1&&(k=Math.min(b(0,M),k)));var x=1<<u.length-1;M=-1;for(var A,m,O=u.length+f.length,N,H=0;H<u.length;H++){for(A=0,m=O;A<m;)b(H,p+m)<=k?A=m:O=m,m=Math.floor((O-A)/2+A);O=m;var R=Math.max(1,p-m+1),z=Math.min(p+m,f.length)+u.length,Y=Array(z+2);Y[z+1]=(1<<H)-1;for(var K=z;K>=R;K--){var re=v[f.charAt(K-1)];if(H===0?Y[K]=(Y[K+1]<<1|1)&re:Y[K]=(Y[K+1]<<1|1)&re|((N[K+1]|N[K])<<1|1)|N[K+1],Y[K]&x){var pe=b(H,K-1);if(pe<=k)if(k=pe,M=K-1,M>p)R=Math.max(1,2*p-M);else break}}if(b(H+1,p)>k)break;N=Y}return M},d.prototype.match_alphabet_=function(f){for(var u={},p=0;p<f.length;p++)u[f.charAt(p)]=0;for(var p=0;p<f.length;p++)u[f.charAt(p)]|=1<<f.length-p-1;return u},d.prototype.patch_addContext_=function(f,u){if(u.length!=0){if(f.start2===null)throw Error("patch not initialized");for(var p=u.substring(f.start2,f.start2+f.length1),v=0;u.indexOf(p)!=u.lastIndexOf(p)&&p.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)v+=this.Patch_Margin,p=u.substring(f.start2-v,f.start2+f.length1+v);v+=this.Patch_Margin;var E=u.substring(f.start2-v,f.start2);E&&f.diffs.unshift(new d.Diff(C,E));var b=u.substring(f.start2+f.length1,f.start2+f.length1+v);b&&f.diffs.push(new d.Diff(C,b)),f.start1-=E.length,f.start2-=E.length,f.length1+=E.length+b.length,f.length2+=E.length+b.length}},d.prototype.patch_make=function(f,u,p){var v,E;if(typeof f=="string"&&typeof u=="string"&&typeof p>"u")v=f,E=this.diff_main(v,u,!0),E.length>2&&(this.diff_cleanupSemantic(E),this.diff_cleanupEfficiency(E));else if(f&&typeof f=="object"&&typeof u>"u"&&typeof p>"u")E=f,v=this.diff_text1(E);else if(typeof f=="string"&&u&&typeof u=="object"&&typeof p>"u")v=f,E=u;else if(typeof f=="string"&&typeof u=="string"&&p&&typeof p=="object")v=f,E=p;else throw new Error("Unknown call format to patch_make.");if(E.length===0)return[];for(var b=[],k=new d.patch_obj,M=0,x=0,A=0,m=v,O=v,N=0;N<E.length;N++){var H=E[N][0],R=E[N][1];switch(!M&&H!==C&&(k.start1=x,k.start2=A),H){case T:k.diffs[M++]=E[N],k.length2+=R.length,O=O.substring(0,A)+R+O.substring(A);break;case y:k.length1+=R.length,k.diffs[M++]=E[N],O=O.substring(0,A)+O.substring(A+R.length);break;case C:R.length<=2*this.Patch_Margin&&M&&E.length!=N+1?(k.diffs[M++]=E[N],k.length1+=R.length,k.length2+=R.length):R.length>=2*this.Patch_Margin&&M&&(this.patch_addContext_(k,m),b.push(k),k=new d.patch_obj,M=0,m=O,x=A);break}H!==T&&(x+=R.length),H!==y&&(A+=R.length)}return M&&(this.patch_addContext_(k,m),b.push(k)),b},d.prototype.patch_deepCopy=function(f){for(var u=[],p=0;p<f.length;p++){var v=f[p],E=new d.patch_obj;E.diffs=[];for(var b=0;b<v.diffs.length;b++)E.diffs[b]=new d.Diff(v.diffs[b][0],v.diffs[b][1]);E.start1=v.start1,E.start2=v.start2,E.length1=v.length1,E.length2=v.length2,u[p]=E}return u},d.prototype.patch_apply=function(f,u){if(f.length==0)return[u,[]];f=this.patch_deepCopy(f);var p=this.patch_addPadding(f);u=p+u+p,this.patch_splitMax(f);for(var v=0,E=[],b=0;b<f.length;b++){var k=f[b].start2+v,M=this.diff_text1(f[b].diffs),x,A=-1;if(M.length>this.Match_MaxBits?(x=this.match_main(u,M.substring(0,this.Match_MaxBits),k),x!=-1&&(A=this.match_main(u,M.substring(M.length-this.Match_MaxBits),k+M.length-this.Match_MaxBits),(A==-1||x>=A)&&(x=-1))):x=this.match_main(u,M,k),x==-1)E[b]=!1,v-=f[b].length2-f[b].length1;else{E[b]=!0,v=x-k;var m;if(A==-1?m=u.substring(x,x+M.length):m=u.substring(x,A+this.Match_MaxBits),M==m)u=u.substring(0,x)+this.diff_text2(f[b].diffs)+u.substring(x+M.length);else{var O=this.diff_main(M,m,!1);if(M.length>this.Match_MaxBits&&this.diff_levenshtein(O)/M.length>this.Patch_DeleteThreshold)E[b]=!1;else{this.diff_cleanupSemanticLossless(O);for(var N=0,H,R=0;R<f[b].diffs.length;R++){var z=f[b].diffs[R];z[0]!==C&&(H=this.diff_xIndex(O,N)),z[0]===T?u=u.substring(0,x+H)+z[1]+u.substring(x+H):z[0]===y&&(u=u.substring(0,x+H)+u.substring(x+this.diff_xIndex(O,N+z[1].length))),z[0]!==y&&(N+=z[1].length)}}}}}return u=u.substring(p.length,u.length-p.length),[u,E]},d.prototype.patch_addPadding=function(f){for(var u=this.Patch_Margin,p="",v=1;v<=u;v++)p+=String.fromCharCode(v);for(var v=0;v<f.length;v++)f[v].start1+=u,f[v].start2+=u;var E=f[0],b=E.diffs;if(b.length==0||b[0][0]!=C)b.unshift(new d.Diff(C,p)),E.start1-=u,E.start2-=u,E.length1+=u,E.length2+=u;else if(u>b[0][1].length){var k=u-b[0][1].length;b[0][1]=p.substring(b[0][1].length)+b[0][1],E.start1-=k,E.start2-=k,E.length1+=k,E.length2+=k}if(E=f[f.length-1],b=E.diffs,b.length==0||b[b.length-1][0]!=C)b.push(new d.Diff(C,p)),E.length1+=u,E.length2+=u;else if(u>b[b.length-1][1].length){var k=u-b[b.length-1][1].length;b[b.length-1][1]+=p.substring(0,k),E.length1+=k,E.length2+=k}return p},d.prototype.patch_splitMax=function(f){for(var u=this.Match_MaxBits,p=0;p<f.length;p++)if(!(f[p].length1<=u)){var v=f[p];f.splice(p--,1);for(var E=v.start1,b=v.start2,k="";v.diffs.length!==0;){var M=new d.patch_obj,x=!0;for(M.start1=E-k.length,M.start2=b-k.length,k!==""&&(M.length1=M.length2=k.length,M.diffs.push(new d.Diff(C,k)));v.diffs.length!==0&&M.length1<u-this.Patch_Margin;){var A=v.diffs[0][0],m=v.diffs[0][1];A===T?(M.length2+=m.length,b+=m.length,M.diffs.push(v.diffs.shift()),x=!1):A===y&&M.diffs.length==1&&M.diffs[0][0]==C&&m.length>2*u?(M.length1+=m.length,E+=m.length,x=!1,M.diffs.push(new d.Diff(A,m)),v.diffs.shift()):(m=m.substring(0,u-M.length1-this.Patch_Margin),M.length1+=m.length,E+=m.length,A===C?(M.length2+=m.length,b+=m.length):x=!1,M.diffs.push(new d.Diff(A,m)),m==v.diffs[0][1]?v.diffs.shift():v.diffs[0][1]=v.diffs[0][1].substring(m.length))}k=this.diff_text2(M.diffs),k=k.substring(k.length-this.Patch_Margin);var O=this.diff_text1(v.diffs).substring(0,this.Patch_Margin);O!==""&&(M.length1+=O.length,M.length2+=O.length,M.diffs.length!==0&&M.diffs[M.diffs.length-1][0]===C?M.diffs[M.diffs.length-1][1]+=O:M.diffs.push(new d.Diff(C,O))),x||f.splice(++p,0,M)}}},d.prototype.patch_toText=function(f){for(var u=[],p=0;p<f.length;p++)u[p]=f[p];return u.join("")},d.prototype.patch_fromText=function(f){var u=[];if(!f)return u;for(var p=f.split(`
`),v=0,E=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;v<p.length;){var b=p[v].match(E);if(!b)throw new Error("Invalid patch string: "+p[v]);var k=new d.patch_obj;for(u.push(k),k.start1=parseInt(b[1],10),b[2]===""?(k.start1--,k.length1=1):b[2]=="0"?k.length1=0:(k.start1--,k.length1=parseInt(b[2],10)),k.start2=parseInt(b[3],10),b[4]===""?(k.start2--,k.length2=1):b[4]=="0"?k.length2=0:(k.start2--,k.length2=parseInt(b[4],10)),v++;v<p.length;){var M=p[v].charAt(0);try{var x=decodeURI(p[v].substring(1))}catch{throw new Error("Illegal escape in patch_fromText: "+x)}if(M=="-")k.diffs.push(new d.Diff(y,x));else if(M=="+")k.diffs.push(new d.Diff(T,x));else if(M==" ")k.diffs.push(new d.Diff(C,x));else{if(M=="@")break;if(M!=="")throw new Error('Invalid patch mode "'+M+'" in: '+x)}v++}}return u},d.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},d.patch_obj.prototype.toString=function(){var f,u;this.length1===0?f=this.start1+",0":this.length1==1?f=this.start1+1:f=this.start1+1+","+this.length1,this.length2===0?u=this.start2+",0":this.length2==1?u=this.start2+1:u=this.start2+1+","+this.length2;for(var p=["@@ -"+f+" +"+u+` @@
`],v,E=0;E<this.diffs.length;E++){switch(this.diffs[E][0]){case T:v="+";break;case y:v="-";break;case C:v=" ";break}p[E+1]=v+encodeURI(this.diffs[E][1])+`
`}return p.join("").replace(/%20/g," ")},g.exports=d,g.exports.diff_match_patch=d,g.exports.DIFF_DELETE=y,g.exports.DIFF_INSERT=T,g.exports.DIFF_EQUAL=C},923:(g,d,y)=>{y.d(d,{default:()=>ue});var T=y(288),C=y(59),f=y(784),u=y(51),p=y(500),v=y(339),E=y(108),b=function($){$===void 0&&($=document);var he=function(J){var F=document.createElement("img");F.src=J.getAttribute("data-src"),F.addEventListener("load",function(){!J.getAttribute("style")&&!J.getAttribute("class")&&!J.getAttribute("width")&&!J.getAttribute("height")&&F.naturalHeight>F.naturalWidth&&F.naturalWidth/F.naturalHeight<document.querySelector(".vditor-reset").clientWidth/(window.innerHeight-40)&&F.naturalHeight>window.innerHeight-40&&(J.style.height=window.innerHeight-40+"px"),J.src=F.src}),J.removeAttribute("data-src")};if(!("IntersectionObserver"in window))return $.querySelectorAll("img").forEach(function(J){J.getAttribute("data-src")&&he(J)}),!1;window.vditorImageIntersectionObserver?(window.vditorImageIntersectionObserver.disconnect(),$.querySelectorAll("img").forEach(function(J){window.vditorImageIntersectionObserver.observe(J)})):(window.vditorImageIntersectionObserver=new IntersectionObserver(function(J){J.forEach(function(F){(typeof F.isIntersecting>"u"?F.intersectionRatio!==0:F.isIntersecting)&&F.target.getAttribute("data-src")&&he(F.target)})}),$.querySelectorAll("img").forEach(function(J){window.vditorImageIntersectionObserver.observe(J)}))},k=y(960),M=y(0),x=y(975),A=y(931),m=y(597),O=y(162),N=y(70),H=y(591),R=y(913),z=y(873),Y=y(161),K=y(598),re=y(905),pe=function($){document.querySelectorAll(".vditor-anchor").forEach(function(he){$===1&&he.classList.add("vditor-anchor--left"),he.onclick=function(){var J=he.getAttribute("href").substr(1),F=document.getElementById("vditorAnchor-"+J).offsetTop;document.querySelector("html").scrollTop=F}}),window.onhashchange=function(){var he=document.getElementById("vditorAnchor-"+decodeURIComponent(window.location.hash.substr(1)));he&&(document.querySelector("html").scrollTop=he.offsetTop)}},we=y(796),ge=y(827),ie=function($,he){if(he===void 0&&(he="zh_CN"),!(typeof speechSynthesis>"u"||typeof SpeechSynthesisUtterance>"u")){var J=function(){var Xe=speechSynthesis.getVoices(),ye,He;return Xe.forEach(function(ot){ot.lang===he.replace("_","-")&&(ye=ot),ot.default&&(He=ot)}),ye||(ye=He),ye},F='<svg><use xlink:href="#vditor-icon-play"></use></svg>',Le='<svg><use xlink:href="#vditor-icon-pause"></use></svg>';document.getElementById("vditorIconScript")||(F='<svg viewBox="0 0 32 32"><path d="M3.436 0l25.128 16-25.128 16v-32z"></path></svg>',Le='<svg viewBox="0 0 32 32"><path d="M20.617 0h9.128v32h-9.128v-32zM2.255 32v-32h9.128v32h-9.128z"></path></svg>');var ne=document.querySelector(".vditor-speech");ne||(ne=document.createElement("button"),ne.className="vditor-speech",$.insertAdjacentElement("beforeend",ne),speechSynthesis.onvoiceschanged!==void 0&&(speechSynthesis.onvoiceschanged=J));var Ne=J(),Me=new SpeechSynthesisUtterance;Me.voice=Ne,Me.onend=Me.onerror=function(){ne.style.display="none",speechSynthesis.cancel(),ne.classList.remove("vditor-speech--current"),ne.innerHTML=F},$.addEventListener(window.ontouchstart!==void 0?"touchend":"click",function(Xe){var ye=Xe.target;if(ye.classList.contains("vditor-speech")||ye.parentElement.classList.contains("vditor-speech")){ne.classList.contains("vditor-speech--current")?speechSynthesis.speaking&&(speechSynthesis.paused?(speechSynthesis.resume(),ne.innerHTML=Le):(speechSynthesis.pause(),ne.innerHTML=F)):(Me.text=ne.getAttribute("data-text"),speechSynthesis.speak(Me),ne.classList.add("vditor-speech--current"),ne.innerHTML=Le),(0,ge.jl)(window.vditorSpeechRange),$.focus();return}if(ne.style.display="none",speechSynthesis.cancel(),ne.classList.remove("vditor-speech--current"),ne.innerHTML=F,getSelection().rangeCount!==0){var He=getSelection().getRangeAt(0),ot=He.toString().trim();if(ot){window.vditorSpeechRange=He.cloneRange();var it=He.getBoundingClientRect();ne.innerHTML=F,ne.style.display="block",ne.style.top=it.top+it.height+document.querySelector("html").scrollTop-20+"px",window.ontouchstart!==void 0?ne.style.left=Xe.changedTouches[Xe.changedTouches.length-1].pageX+2+"px":ne.style.left=Xe.clientX+2+"px",ne.setAttribute("data-text",ot)}}})}},fe=function($,he,J,F){function Le(ne){return ne instanceof J?ne:new J(function(Ne){Ne(ne)})}return new(J||(J=Promise))(function(ne,Ne){function Me(He){try{ye(F.next(He))}catch(ot){Ne(ot)}}function Xe(He){try{ye(F.throw(He))}catch(ot){Ne(ot)}}function ye(He){He.done?ne(He.value):Le(He.value).then(Me,Xe)}ye((F=F.apply($,he||[])).next())})},Ae=function($,he){var J={label:0,sent:function(){if(ne[0]&1)throw ne[1];return ne[1]},trys:[],ops:[]},F,Le,ne,Ne;return Ne={next:Me(0),throw:Me(1),return:Me(2)},typeof Symbol=="function"&&(Ne[Symbol.iterator]=function(){return this}),Ne;function Me(ye){return function(He){return Xe([ye,He])}}function Xe(ye){if(F)throw new TypeError("Generator is already executing.");for(;Ne&&(Ne=0,ye[0]&&(J=0)),J;)try{if(F=1,Le&&(ne=ye[0]&2?Le.return:ye[0]?Le.throw||((ne=Le.return)&&ne.call(Le),0):Le.next)&&!(ne=ne.call(Le,ye[1])).done)return ne;switch(Le=0,ne&&(ye=[ye[0]&2,ne.value]),ye[0]){case 0:case 1:ne=ye;break;case 4:return J.label++,{value:ye[1],done:!1};case 5:J.label++,Le=ye[1],ye=[0];continue;case 7:ye=J.ops.pop(),J.trys.pop();continue;default:if(ne=J.trys,!(ne=ne.length>0&&ne[ne.length-1])&&(ye[0]===6||ye[0]===2)){J=0;continue}if(ye[0]===3&&(!ne||ye[1]>ne[0]&&ye[1]<ne[3])){J.label=ye[1];break}if(ye[0]===6&&J.label<ne[1]){J.label=ne[1],ne=ye;break}if(ne&&J.label<ne[2]){J.label=ne[2],J.ops.push(ye);break}ne[2]&&J.ops.pop(),J.trys.pop();continue}ye=he.call($,J)}catch(He){ye=[6,He],Le=0}finally{F=ne=0}if(ye[0]&5)throw ye[1];return{value:ye[0]?ye[1]:void 0,done:!0}}},Fe=function($){var he,J={anchor:0,cdn:R.Y.CDN,customEmoji:{},emojiPath:"".concat(R.Y.CDN,"/dist/images/emoji"),hljs:R.Y.HLJS_OPTIONS,icon:"ant",lang:"zh_CN",markdown:R.Y.MARKDOWN_OPTIONS,math:R.Y.MATH_OPTIONS,mode:"light",speech:{enable:!1},render:{media:{enable:!0}},theme:R.Y.THEME_OPTIONS};return $.cdn&&(!((he=$.theme)===null||he===void 0)&&he.path||(J.theme.path="".concat($.cdn,"/dist/css/content-theme")),$.emojiPath||(J.emojiPath="".concat($.cdn,"/dist/images/emoji"))),(0,re.h)(J,$)},Pe=function($,he){var J=Fe(he);return(0,Y.Z)("".concat(J.cdn,"/dist/js/lute/lute.min.js"),"vditorLuteScript").then(function(){var F=(0,we.X)({autoSpace:J.markdown.autoSpace,gfmAutoLink:J.markdown.gfmAutoLink,codeBlockPreview:J.markdown.codeBlockPreview,emojiSite:J.emojiPath,emojis:J.customEmoji,fixTermTypo:J.markdown.fixTermTypo,footnotes:J.markdown.footnotes,headingAnchor:J.anchor!==0,inlineMathDigit:J.math.inlineDigit,lazyLoadImage:J.lazyLoadImage,linkBase:J.markdown.linkBase,linkPrefix:J.markdown.linkPrefix,listStyle:J.markdown.listStyle,mark:J.markdown.mark,mathBlockPreview:J.markdown.mathBlockPreview,paragraphBeginningSpace:J.markdown.paragraphBeginningSpace,sanitize:J.markdown.sanitize,toc:J.markdown.toc});return he!=null&&he.renderers&&F.SetJSRenderers({renderers:{Md2HTML:he.renderers}}),F.SetHeadingID(!0),F.Md2HTML($)})},P=function($,he,J){return fe(void 0,void 0,void 0,function(){var F,Le,ne,Ne;return Ae(this,function(Me){switch(Me.label){case 0:return F=Fe(J),[4,Pe(he,F)];case 1:if(Le=Me.sent(),F.transform&&(Le=F.transform(Le)),$.innerHTML=Le,$.classList.add("vditor-reset"),F.i18n)return[3,5];if(["en_US","fr_FR","pt_BR","ja_JP","ko_KR","ru_RU","sv_SE","zh_CN","zh_TW"].includes(F.lang))return[3,2];throw new Error("options.lang error, see https://ld246.com/article/1549638745630#options");case 2:return ne="vditorI18nScript",Ne=ne+F.lang,document.querySelectorAll('head script[id^="'.concat(ne,'"]')).forEach(function(Xe){Xe.id!==Ne&&document.head.removeChild(Xe)}),[4,(0,Y.Z)("".concat(F.cdn,"/dist/js/i18n/").concat(F.lang,".js"),Ne)];case 3:Me.sent(),Me.label=4;case 4:return[3,6];case 5:window.VditorI18n=F.i18n,Me.label=6;case 6:return F.icon?[4,(0,Y.Z)("".concat(F.cdn,"/dist/js/icons/").concat(F.icon,".js"),"vditorIconScript")]:[3,8];case 7:Me.sent(),Me.label=8;case 8:return(0,z.H)(F.theme.current,F.theme.path),F.anchor===1&&$.classList.add("vditor-reset--anchor"),(0,u.o)($,F.hljs),(0,E.$)(F.hljs,$,F.cdn),(0,k.T)($,{cdn:F.cdn,math:F.math}),(0,x.e)($,F.cdn,F.mode),(0,A.Y)($,F.cdn,F.mode),(0,m.K)($,F.cdn),(0,p.D)($,F.cdn),(0,v.m)($,F.cdn),(0,f.v)($,F.cdn,F.mode),(0,O.l)($,F.cdn,F.mode),(0,H.M)($,F.cdn),(0,T.$)($,F.cdn),F.render.media.enable&&(0,M.l)($),F.speech.enable&&ie($),F.anchor!==0&&pe(F.anchor),F.after&&F.after(),F.lazyLoadImage&&b($),$.addEventListener("click",function(Xe){var ye=(0,K._Y)(Xe.target,"SPAN");if(ye&&(0,K.KJ)(ye,"vditor-toc")){var He=$.querySelector("#"+ye.getAttribute("data-target-id"));He&&window.scrollTo(window.scrollX,He.offsetTop);return}}),[2]}})})},j=y(726),U=y(13),X=function(){function $(){}return $.adapterRender=C,$.previewImage=j.o,$.codeRender=u.o,$.graphvizRender=v.m,$.highlightRender=E.$,$.mathRender=k.T,$.mermaidRender=x.e,$.SMILESRender=A.Y,$.markmapRender=m.K,$.flowchartRender=p.D,$.chartRender=f.v,$.abcRender=T.$,$.mindmapRender=O.l,$.plantumlRender=H.M,$.outlineRender=N.N,$.mediaRender=M.l,$.speechRender=ie,$.lazyLoadImageRender=b,$.md2html=Pe,$.preview=P,$.setCodeTheme=U.h,$.setContentTheme=z.H,$}();const ue=X},913:(g,d,y)=>{y.d(d,{Y:()=>C,g:()=>T});var T="3.10.9",C=function(){function f(){}return f.ZWSP="​",f.DROP_EDITOR="application/editor",f.MOBILE_WIDTH=520,f.CLASS_MENU_DISABLED="vditor-menu--disabled",f.EDIT_TOOLBARS=["emoji","headings","bold","italic","strike","link","list","ordered-list","outdent","indent","check","line","quote","code","inline-code","insert-after","insert-before","upload","record","table"],f.CODE_THEME=["a11y-dark","agate","an-old-hope","androidstudio","arta","atom-one-dark","atom-one-dark-reasonable","base16/3024","base16/apathy","base16/apprentice","base16/ashes","base16/atelier-cave","base16/atelier-dune","base16/atelier-estuary","base16/atelier-forest","base16/atelier-heath","base16/atelier-lakeside","base16/atelier-plateau","base16/atelier-savanna","base16/atelier-seaside","base16/atelier-sulphurpool","base16/atlas","base16/bespin","base16/black-metal","base16/black-metal-bathory","base16/black-metal-burzum","base16/black-metal-dark-funeral","base16/black-metal-gorgoroth","base16/black-metal-immortal","base16/black-metal-khold","base16/black-metal-marduk","base16/black-metal-mayhem","base16/black-metal-nile","base16/black-metal-venom","base16/brewer","base16/bright","base16/brogrammer","base16/brush-trees-dark","base16/chalk","base16/circus","base16/classic-dark","base16/codeschool","base16/colors","base16/danqing","base16/darcula","base16/dark-violet","base16/darkmoss","base16/darktooth","base16/decaf","base16/default-dark","base16/dracula","base16/edge-dark","base16/eighties","base16/embers","base16/equilibrium-dark","base16/equilibrium-gray-dark","base16/espresso","base16/eva","base16/eva-dim","base16/flat","base16/framer","base16/gigavolt","base16/google-dark","base16/grayscale-dark","base16/green-screen","base16/gruvbox-dark-hard","base16/gruvbox-dark-medium","base16/gruvbox-dark-pale","base16/gruvbox-dark-soft","base16/hardcore","base16/harmonic16-dark","base16/heetch-dark","base16/helios","base16/hopscotch","base16/horizon-dark","base16/humanoid-dark","base16/ia-dark","base16/icy-dark","base16/ir-black","base16/isotope","base16/kimber","base16/london-tube","base16/macintosh","base16/marrakesh","base16/materia","base16/material","base16/material-darker","base16/material-palenight","base16/material-vivid","base16/mellow-purple","base16/mocha","base16/monokai","base16/nebula","base16/nord","base16/nova","base16/ocean","base16/oceanicnext","base16/onedark","base16/outrun-dark","base16/papercolor-dark","base16/paraiso","base16/pasque","base16/phd","base16/pico","base16/pop","base16/porple","base16/qualia","base16/railscasts","base16/rebecca","base16/ros-pine","base16/ros-pine-moon","base16/sandcastle","base16/seti-ui","base16/silk-dark","base16/snazzy","base16/solar-flare","base16/solarized-dark","base16/spacemacs","base16/summercamp","base16/summerfruit-dark","base16/synth-midnight-terminal-dark","base16/tango","base16/tender","base16/tomorrow-night","base16/twilight","base16/unikitty-dark","base16/vulcan","base16/windows-10","base16/windows-95","base16/windows-high-contrast","base16/windows-nt","base16/woodland","base16/xcode-dusk","base16/zenburn","codepen-embed","dark","devibeans","far","felipec","github-dark","github-dark-dimmed","gml","gradient-dark","hybrid","ir-black","isbl-editor-dark","kimbie-dark","lioshi","monokai","monokai-sublime","night-owl","nnfx-dark","nord","obsidian","panda-syntax-dark","paraiso-dark","pojoaque","qtcreator-dark","rainbow","shades-of-purple","srcery","stackoverflow-dark","sunburst","tomorrow-night-blue","tomorrow-night-bright","tokyo-night-dark","vs2015","xt256","ant-design","a11y-light","arduino-light","ascetic","atom-one-light","base16/atelier-cave-light","base16/atelier-dune-light","base16/atelier-estuary-light","base16/atelier-forest-light","base16/atelier-heath-light","base16/atelier-lakeside-light","base16/atelier-plateau-light","base16/atelier-savanna-light","base16/atelier-seaside-light","base16/atelier-sulphurpool-light","base16/brush-trees","base16/classic-light","base16/cupcake","base16/cupertino","base16/default-light","base16/dirtysea","base16/edge-light","base16/equilibrium-gray-light","base16/equilibrium-light","base16/fruit-soda","base16/github","base16/google-light","base16/grayscale-light","base16/gruvbox-light-hard","base16/gruvbox-light-medium","base16/gruvbox-light-soft","base16/harmonic16-light","base16/heetch-light","base16/humanoid-light","base16/horizon-light","base16/ia-light","base16/material-lighter","base16/mexico-light","base16/one-light","base16/papercolor-light","base16/ros-pine-dawn","base16/sagelight","base16/shapeshifter","base16/silk-light","base16/solar-flare-light","base16/solarized-light","base16/summerfruit-light","base16/synth-midnight-terminal-light","base16/tomorrow","base16/unikitty-light","base16/windows-10-light","base16/windows-95-light","base16/windows-high-contrast-light","brown-paper","base16/windows-nt-light","color-brewer","docco","foundation","github","googlecode","gradient-light","grayscale","idea","intellij-light","isbl-editor-light","kimbie-light","lightfair","magula","mono-blue","nnfx-light","panda-syntax-light","paraiso-light","purebasic","qtcreator-light","routeros","school-book","stackoverflow-light","tokyo-night-light","vs","xcode","default"],f.ALIAS_CODE_LANGUAGES=["abc","plantuml","mermaid","flowchart","echarts","mindmap","graphviz","math","markmap","smiles","js","ts","html","toml","c#","bat"],f.CDN="https://unpkg.com/vditor@".concat("3.10.9"),f.MARKDOWN_OPTIONS={autoSpace:!1,gfmAutoLink:!0,codeBlockPreview:!0,fixTermTypo:!1,footnotes:!0,linkBase:"",linkPrefix:"",listStyle:!1,mark:!1,mathBlockPreview:!0,paragraphBeginningSpace:!1,sanitize:!0,toc:!1},f.HLJS_OPTIONS={enable:!0,lineNumber:!1,defaultLang:"",style:"github"},f.MATH_OPTIONS={engine:"KaTeX",inlineDigit:!1,macros:{}},f.THEME_OPTIONS={current:"light",list:{"ant-design":"Ant Design",dark:"Dark",light:"Light",wechat:"WeChat"},path:"".concat(f.CDN,"/dist/css/content-theme")},f}()},931:(g,d,y)=>{y.d(d,{Y:()=>p});var T=y(913),C=y(161),f=y(59),u=y(933),p=function(v,E,b){v===void 0&&(v=document),E===void 0&&(E=T.Y.CDN);var k=f.SMILESRenderAdapter.getElements(v);k.length>0&&(0,C.Z)("".concat(E,"/dist/js/smiles-drawer/smiles-drawer.min.js?v=2.1.7"),"vditorAbcjsScript").then(function(){var M=new SmiDrawer({},{});k.forEach(function(x){var A=f.SMILESRenderAdapter.getCode(x).trim();if(!(x.getAttribute("data-processed")==="true"||A.trim()==="")){var m="smiles"+(0,u.Ee)();x.innerHTML='<svg id="'.concat(m,'"></svg>'),M.draw(A,"#"+m,b==="dark"?"dark":void 0),x.setAttribute("data-processed","true")}})})}},288:(g,d,y)=>{y.d(d,{$:()=>u});var T=y(913),C=y(161),f=y(59),u=function(p,v){p===void 0&&(p=document),v===void 0&&(v=T.Y.CDN);var E=f.abcRenderAdapter.getElements(p);E.length>0&&(0,C.Z)("".concat(v,"/dist/js/abcjs/abcjs_basic.min.js"),"vditorAbcjsScript").then(function(){E.forEach(function(b){b.parentElement.classList.contains("vditor-wysiwyg__pre")||b.parentElement.classList.contains("vditor-ir__marker--pre")||b.getAttribute("data-processed")!=="true"&&(ABCJS.renderAbc(b,f.abcRenderAdapter.getCode(b).trim()),b.style.overflowX="auto",b.setAttribute("data-processed","true"))})})}},59:(g,d,y)=>{y.r(d),y.d(d,{SMILESRenderAdapter:()=>C,abcRenderAdapter:()=>E,chartRenderAdapter:()=>v,flowchartRenderAdapter:()=>k,graphvizRenderAdapter:()=>b,markmapRenderAdapter:()=>u,mathRenderAdapter:()=>T,mermaidRenderAdapter:()=>f,mindmapRenderAdapter:()=>p,plantumlRenderAdapter:()=>M});var T={getCode:function(x){return x.textContent},getElements:function(x){return x.querySelectorAll(".language-math")}},C={getCode:function(x){return x.textContent},getElements:function(x){return x.querySelectorAll(".language-smiles")}},f={getCode:function(x){return x.textContent},getElements:function(x){return x.querySelectorAll(".language-mermaid")}},u={getCode:function(x){return x.textContent},getElements:function(x){return x.querySelectorAll(".language-markmap")}},p={getCode:function(x){return x.getAttribute("data-code")},getElements:function(x){return x.querySelectorAll(".language-mindmap")}},v={getCode:function(x){return x.innerText},getElements:function(x){return x.querySelectorAll(".language-echarts")}},E={getCode:function(x){return x.textContent},getElements:function(x){return x.querySelectorAll(".language-abc")}},b={getCode:function(x){return x.textContent},getElements:function(x){return x.querySelectorAll(".language-graphviz")}},k={getCode:function(x){return x.textContent},getElements:function(x){return x.querySelectorAll(".language-flowchart")}},M={getCode:function(x){return x.textContent},getElements:function(x){return x.querySelectorAll(".language-plantuml")}}},784:(g,d,y)=>{y.d(d,{v:()=>E});var T=y(913),C=y(161),f=y(59),u=y(933),p=function(b,k,M,x){function A(m){return m instanceof M?m:new M(function(O){O(m)})}return new(M||(M=Promise))(function(m,O){function N(z){try{R(x.next(z))}catch(Y){O(Y)}}function H(z){try{R(x.throw(z))}catch(Y){O(Y)}}function R(z){z.done?m(z.value):A(z.value).then(N,H)}R((x=x.apply(b,k||[])).next())})},v=function(b,k){var M={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},x,A,m,O;return O={next:N(0),throw:N(1),return:N(2)},typeof Symbol=="function"&&(O[Symbol.iterator]=function(){return this}),O;function N(R){return function(z){return H([R,z])}}function H(R){if(x)throw new TypeError("Generator is already executing.");for(;O&&(O=0,R[0]&&(M=0)),M;)try{if(x=1,A&&(m=R[0]&2?A.return:R[0]?A.throw||((m=A.return)&&m.call(A),0):A.next)&&!(m=m.call(A,R[1])).done)return m;switch(A=0,m&&(R=[R[0]&2,m.value]),R[0]){case 0:case 1:m=R;break;case 4:return M.label++,{value:R[1],done:!1};case 5:M.label++,A=R[1],R=[0];continue;case 7:R=M.ops.pop(),M.trys.pop();continue;default:if(m=M.trys,!(m=m.length>0&&m[m.length-1])&&(R[0]===6||R[0]===2)){M=0;continue}if(R[0]===3&&(!m||R[1]>m[0]&&R[1]<m[3])){M.label=R[1];break}if(R[0]===6&&M.label<m[1]){M.label=m[1],m=R;break}if(m&&M.label<m[2]){M.label=m[2],M.ops.push(R);break}m[2]&&M.ops.pop(),M.trys.pop();continue}R=k.call(b,M)}catch(z){R=[6,z],A=0}finally{x=m=0}if(R[0]&5)throw R[1];return{value:R[0]?R[1]:void 0,done:!0}}},E=function(b,k,M){b===void 0&&(b=document),k===void 0&&(k=T.Y.CDN);var x=f.chartRenderAdapter.getElements(b);x.length>0&&(0,C.Z)("".concat(k,"/dist/js/echarts/echarts.min.js?v=5.5.1"),"vditorEchartsScript").then(function(){x.forEach(function(A){return p(void 0,void 0,void 0,function(){var m,O,N;return v(this,function(H){switch(H.label){case 0:if(A.parentElement.classList.contains("vditor-wysiwyg__pre")||A.parentElement.classList.contains("vditor-ir__marker--pre"))return[2];if(m=f.chartRenderAdapter.getCode(A).trim(),!m)return[2];H.label=1;case 1:return H.trys.push([1,3,,4]),A.getAttribute("data-processed")==="true"?[2]:[4,(0,u.kY)(m)];case 2:return O=H.sent(),echarts.init(A,M==="dark"?"dark":void 0).setOption(O),A.setAttribute("data-processed","true"),[3,4];case 3:return N=H.sent(),A.className="vditor-reset--error",A.innerHTML="echarts render error: <br>".concat(N),[3,4];case 4:return[2]}})})})})}},51:(g,d,y)=>{y.d(d,{o:()=>f});var T=y(695),C=y(913),f=function(u,p){Array.from(u.querySelectorAll("pre > code")).filter(function(v,E){return!(v.parentElement.classList.contains("vditor-wysiwyg__pre")||v.parentElement.classList.contains("vditor-ir__marker--pre")||v.classList.contains("language-mermaid")||v.classList.contains("language-flowchart")||v.classList.contains("language-echarts")||v.classList.contains("language-mindmap")||v.classList.contains("language-plantuml")||v.classList.contains("language-markmap")||v.classList.contains("language-abc")||v.classList.contains("language-graphviz")||v.classList.contains("language-math")||v.classList.contains("language-smiles")||v.style.maxHeight.indexOf("px")>-1||u.classList.contains("vditor-preview")&&E>5)}).forEach(function(v){var E,b,k,M=v.innerText;if(v.classList.contains("highlight-chroma")){var x=v.cloneNode(!0);x.querySelectorAll(".highlight-ln").forEach(function(N){N.remove()}),M=x.innerText}else M.endsWith(`
`)&&(M=M.substr(0,M.length-1));var A='<svg><use xlink:href="#vditor-icon-copy"></use></svg>';document.getElementById("vditorIconScript")||(A='<svg viewBox="0 0 32 32"><path d="M22.545-0h-17.455c-1.6 0-2.909 1.309-2.909 2.909v20.364h2.909v-20.364h17.455v-2.909zM26.909 5.818h-16c-1.6 0-2.909 1.309-2.909 2.909v20.364c0 1.6 1.309 2.909 2.909 2.909h16c1.6 0 2.909-1.309 2.909-2.909v-20.364c0-1.6-1.309-2.909-2.909-2.909zM26.909 29.091h-16v-20.364h16v20.364z"></path></svg>');var m=document.createElement("div");m.className="vditor-copy",m.innerHTML='<span aria-label="'.concat(((E=window.VditorI18n)===null||E===void 0?void 0:E.copy)||"复制",`"
onmouseover="this.setAttribute('aria-label', '`).concat(((b=window.VditorI18n)===null||b===void 0?void 0:b.copy)||"复制",`')"
class="vditor-tooltipped vditor-tooltipped__w"
onclick="this.previousElementSibling.select();document.execCommand('copy');this.setAttribute('aria-label', '`).concat(((k=window.VditorI18n)===null||k===void 0?void 0:k.copied)||"已复制",`');this.previousElementSibling.blur()">`).concat(A,"</span>");var O=document.createElement("textarea");O.value=(0,T.p)(M),m.insertAdjacentElement("afterbegin",O),p&&p.renderMenu&&p.renderMenu(v,m),v.before(m),v.style.maxHeight=window.outerHeight-40+"px",v.insertAdjacentHTML("afterend",'<span style="position: absolute">'.concat(C.Y.ZWSP,"</span>"))})}},500:(g,d,y)=>{y.d(d,{D:()=>u});var T=y(913),C=y(161),f=y(59),u=function(p,v){v===void 0&&(v=T.Y.CDN);var E=f.flowchartRenderAdapter.getElements(p);E.length!==0&&(0,C.Z)("".concat(v,"/dist/js/flowchart.js/flowchart.min.js"),"vditorFlowchartScript").then(function(){E.forEach(function(b){if(b.getAttribute("data-processed")!=="true"){var k=flowchart.parse(f.flowchartRenderAdapter.getCode(b));b.innerHTML="",k.drawSVG(b),b.setAttribute("data-processed","true")}})})}},339:(g,d,y)=>{y.d(d,{m:()=>u});var T=y(913),C=y(161),f=y(59),u=function(p,v){v===void 0&&(v=T.Y.CDN);var E=f.graphvizRenderAdapter.getElements(p);E.length!==0&&(0,C.Z)("".concat(v,"/dist/js/graphviz/viz.js"),"vditorGraphVizScript").then(function(){E.forEach(function(b){var k=f.graphvizRenderAdapter.getCode(b);if(!(b.parentElement.classList.contains("vditor-wysiwyg__pre")||b.parentElement.classList.contains("vditor-ir__marker--pre"))&&!(b.getAttribute("data-processed")==="true"||k.trim()==="")){try{var M=new Blob(["importScripts('".concat(document.getElementById("vditorGraphVizScript").src.replace("viz.js","full.render.js"),"');")],{type:"application/javascript"}),x=window.URL||window.webkitURL,A=x.createObjectURL(M),m=new Worker(A);new Viz({worker:m}).renderSVGElement(k).then(function(O){b.innerHTML=O.outerHTML}).catch(function(O){b.innerHTML="graphviz render error: <br>".concat(O),b.className="vditor-reset--error"})}catch(O){console.error("graphviz error",O)}b.setAttribute("data-processed","true")}})})}},108:(g,d,y)=>{y.d(d,{$:()=>u});var T=y(913),C=y(161),f=y(505),u=function(p,v,E){v===void 0&&(v=document),E===void 0&&(E=T.Y.CDN);var b=p.style;T.Y.CODE_THEME.includes(b)||(b="github");var k=document.getElementById("vditorHljsStyle"),M="".concat(E,"/dist/js/highlight.js/styles/").concat(b,".min.css");if(k&&k.getAttribute("href")!==M&&k.remove(),(0,f.T)("".concat(E,"/dist/js/highlight.js/styles/").concat(b,".min.css"),"vditorHljsStyle"),p.enable!==!1){var x=v.querySelectorAll("pre > code");x.length!==0&&(0,C.Z)("".concat(E,"/dist/js/highlight.js/highlight.min.js?v=11.7.0"),"vditorHljsScript").then(function(){(0,C.Z)("".concat(E,"/dist/js/highlight.js/third-languages.js?v=1.0.1"),"vditorHljsThirdScript").then(function(){v.querySelectorAll("pre > code").forEach(function(A){if(!(A.parentElement.classList.contains("vditor-ir__marker--pre")||A.parentElement.classList.contains("vditor-wysiwyg__pre"))&&!(A.classList.contains("language-mermaid")||A.classList.contains("language-flowchart")||A.classList.contains("language-echarts")||A.classList.contains("language-mindmap")||A.classList.contains("language-plantuml")||A.classList.contains("language-smiles")||A.classList.contains("language-abc")||A.classList.contains("language-graphviz")||A.classList.contains("language-math"))){p.defaultLang!==""&&A.className.indexOf("language-")===-1&&A.classList.add("language-"+p.defaultLang);var m=A.className.replace("language-","");if(window.hljs.getLanguage(m)||(m="plaintext"),A.innerHTML=window.hljs.highlight(A.textContent,{language:m,ignoreIllegals:!0}).value,A.classList.add("hljs"),!!p.lineNumber){A.classList.add("vditor-linenumber");var O=A.querySelector(".vditor-linenumber__temp");O||(O=document.createElement("div"),O.className="vditor-linenumber__temp",A.insertAdjacentElement("beforeend",O));var N=getComputedStyle(A).whiteSpace,H=!1;(N==="pre-wrap"||N==="pre-line")&&(H=!0);var R="",z=A.textContent.split(/\r\n|\r|\n/g);z.pop(),z.map(function(Y){var K="";H&&(O.textContent=Y||`
`,K=' style="height:'.concat(O.getBoundingClientRect().height,'px"')),R+="<span".concat(K,"></span>")}),O.style.display="none",R='<span class="vditor-linenumber__rows">'.concat(R,"</span>"),A.insertAdjacentHTML("beforeend",R)}}})})})}}},597:(g,d,y)=>{y.d(d,{K:()=>E});var T=y(913),C=y(161),f=y(59),u={},p=function(b,k){var M=b.transform(k),x=Object.keys(M.features).filter(function(H){return!u[H]});x.forEach(function(H){u[H]=!0});var A=b.getAssets(x),m=A.styles,O=A.scripts,N=window.markmap;return m&&N.loadCSS(m),O&&N.loadJS(O),M},v=function(b,k){var M=window.markmap,x=M.Transformer,A=M.Markmap,m=M.deriveOptions;M.globalCSS;var O=new x;b.innerHTML='<svg style="width:100%"></svg>';var N=b.firstChild,H=A.create(N,null),R=p(O,k),z=R.root,Y=R.frontmatter,K=Y==null?void 0:Y.markmap,re=m(K);H.setData(z,re),H.fit()},E=function(b,k){b===void 0&&(b=document),k===void 0&&(k=T.Y.CDN);var M=f.markmapRenderAdapter.getElements(b);M.length!==0&&(0,C.Z)("".concat(k,"/dist/js/markmap/markmap.min.js"),"vditorMarkerScript").then(function(){M.forEach(function(x){var A=f.markmapRenderAdapter.getCode(x);if(!(x.getAttribute("data-processed")==="true"||A.trim()==="")){var m=document.createElement("div");m.className="language-markmap",x.parentNode.appendChild(m),v(m,A),x.parentNode.childNodes[0].nodeName=="CODE"&&x.parentNode.removeChild(x.parentNode.childNodes[0])}})})}},960:(g,d,y)=>{y.d(d,{T:()=>v});var T=y(913),C=y(161),f=y(505),u=y(695),p=y(59),v=function(E,b){E===void 0&&(E=document);var k=p.mathRenderAdapter.getElements(E);if(k.length!==0){var M={cdn:T.Y.CDN,math:{engine:"KaTeX",inlineDigit:!1,macros:{}}};if(b&&b.math&&(b.math=Object.assign({},M.math,b.math)),b=Object.assign({},M,b),b.math.engine==="KaTeX")(0,f.T)("".concat(b.cdn,"/dist/js/katex/katex.min.css?v=0.16.9"),"vditorKatexStyle"),(0,C.Z)("".concat(b.cdn,"/dist/js/katex/katex.min.js?v=0.16.9"),"vditorKatexScript").then(function(){(0,C.Z)("".concat(b.cdn,"/dist/js/katex/mhchem.min.js?v=0.16.9"),"vditorKatexChemScript").then(function(){k.forEach(function(m){if(!(m.parentElement.classList.contains("vditor-wysiwyg__pre")||m.parentElement.classList.contains("vditor-ir__marker--pre"))&&!m.getAttribute("data-math")){var O=(0,u.p)(p.mathRenderAdapter.getCode(m));m.setAttribute("data-math",O);try{m.innerHTML=katex.renderToString(O,{displayMode:m.tagName==="DIV",output:"html",macros:b.math.macros})}catch(N){m.innerHTML=N.message,m.className="language-math vditor-reset--error"}m.addEventListener("copy",function(N){N.stopPropagation(),N.preventDefault();var H=N.currentTarget.closest(".language-math");N.clipboardData.setData("text/html",H.innerHTML),N.clipboardData.setData("text/plain",H.getAttribute("data-math"))})}})})});else if(b.math.engine==="MathJax"){var x=function(m){if(m.length!==0){var O=0,N=m[m.length-1],H=function(){var R=m[O++];R===N?R():R(H)};H()}};window.MathJax||(window.MathJax={loader:{paths:{mathjax:"".concat(b.cdn,"/dist/js/mathjax")}},startup:{typeset:!1},tex:{macros:b.math.macros}},Object.assign(window.MathJax,b.math.mathJaxOptions)),(0,C.U)("".concat(b.cdn,"/dist/js/mathjax/tex-svg-full.js"),"protyleMathJaxScript");var A=function(m,O){var N=(0,u.p)(m.textContent).trim(),H=window.MathJax.getMetricsFor(m);H.display=m.tagName==="DIV",window.MathJax.tex2svgPromise(N,H).then(function(R){m.innerHTML="",m.setAttribute("data-math",N),m.append(R),window.MathJax.startup.document.clear(),window.MathJax.startup.document.updateDocument();var z=R.querySelector('[data-mml-node="merror"]');z&&z.textContent.trim()!==""&&(m.innerHTML=z.textContent.trim(),m.className="vditor-reset--error"),O&&O()})};window.MathJax.startup.promise.then(function(){for(var m=[],O=function(H){var R=k[H];!R.parentElement.classList.contains("vditor-wysiwyg__pre")&&!R.parentElement.classList.contains("vditor-ir__marker--pre")&&!R.getAttribute("data-math")&&(0,u.p)(R.textContent).trim()&&m.push(function(z){H===k.length-1?A(R):A(R,z)})},N=0;N<k.length;N++)O(N);x(m)})}}}},0:(g,d,y)=>{y.d(d,{l:()=>p});var T=y(933),C=function(v,E){v.insertAdjacentHTML("afterend",'<video controls="controls" src="'.concat(E,'"></video>')),v.remove()},f=function(v,E){v.insertAdjacentHTML("afterend",'<audio controls="controls" src="'.concat(E,'"></audio>')),v.remove()},u=function(v,E){var b=E.match(/\/\/(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))([\w|-]{11})(?:(?:[\?&]t=)(\S+))?/),k=E.match(/\/\/v\.youku\.com\/v_show\/id_(\w+)=*\.html/),M=E.match(/\/\/v\.qq\.com\/x\/cover\/.*\/([^\/]+)\.html\??.*/),x=E.match(/(?:www\.|\/\/)coub\.com\/view\/(\w+)/),A=E.match(/(?:www\.|\/\/)facebook\.com\/([^\/]+)\/videos\/([0-9]+)/),m=E.match(/.+dailymotion.com\/(video|hub)\/(\w+)\?/),O=E.match(/(?:www\.|\/\/)bilibili\.com\/video\/(\w+)/),N=E.match(/(?:www\.|\/\/)ted\.com\/talks\/(\w+)/);if(b&&b[1].length===11)v.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//www.youtube.com/embed/'.concat(b[1]+(b[2]?"?start="+b[2]:""),'"></iframe>')),v.remove();else if(k&&k[1])v.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//player.youku.com/embed/'.concat(k[1],'"></iframe>')),v.remove();else if(M&&M[1])v.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="https://v.qq.com/txp/iframe/player.html?vid='.concat(M[1],'"></iframe>')),v.remove();else if(x&&x[1])v.insertAdjacentHTML("afterend",`<iframe class="iframe__video"
 src="//coub.com/embed/`.concat(x[1],'?muted=false&autostart=false&originalSize=true&startWithHD=true"></iframe>')),v.remove();else if(A&&A[0])v.insertAdjacentHTML("afterend",`<iframe class="iframe__video"
 src="https://www.facebook.com/plugins/video.php?href=`.concat(encodeURIComponent(A[0]),'"></iframe>')),v.remove();else if(m&&m[2])v.insertAdjacentHTML("afterend",`<iframe class="iframe__video"
 src="https://www.dailymotion.com/embed/video/`.concat(m[2],'"></iframe>')),v.remove();else if(E.indexOf("bilibili.com")>-1&&(E.indexOf("bvid=")>-1||O&&O[1])){var H={bvid:(0,T.TK)("bvid",E)||O&&O[1],page:"1",high_quality:"1",as_wide:"1",allowfullscreen:"true",autoplay:"0"};new URL(E.startsWith("http")?E:"https:"+E).search.split("&").forEach(function(Y,K){if(Y){K===0&&(Y=Y.substr(1));var re=Y.split("=");H[re[0]]=re[1]}});var R="https://player.bilibili.com/player.html?",z=Object.keys(H);z.forEach(function(Y,K){R+="".concat(Y,"=").concat(H[Y]),K<z.length-1&&(R+="&")}),v.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="'.concat(R,'"></iframe>')),v.remove()}else N&&N[1]&&(v.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//embed.ted.com/talks/'.concat(N[1],'"></iframe>')),v.remove())},p=function(v){v&&v.querySelectorAll("a").forEach(function(E){var b=E.getAttribute("href");b&&(b.match(/^.+.(mp4|m4v|ogg|ogv|webm)$/)?C(E,b):b.match(/^.+.(mp3|wav|flac)$/)?f(E,b):u(E,b))})}},975:(g,d,y)=>{y.d(d,{e:()=>E});var T=y(913),C=y(161),f=y(59),u=y(933),p=function(b,k,M,x){function A(m){return m instanceof M?m:new M(function(O){O(m)})}return new(M||(M=Promise))(function(m,O){function N(z){try{R(x.next(z))}catch(Y){O(Y)}}function H(z){try{R(x.throw(z))}catch(Y){O(Y)}}function R(z){z.done?m(z.value):A(z.value).then(N,H)}R((x=x.apply(b,k||[])).next())})},v=function(b,k){var M={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},x,A,m,O;return O={next:N(0),throw:N(1),return:N(2)},typeof Symbol=="function"&&(O[Symbol.iterator]=function(){return this}),O;function N(R){return function(z){return H([R,z])}}function H(R){if(x)throw new TypeError("Generator is already executing.");for(;O&&(O=0,R[0]&&(M=0)),M;)try{if(x=1,A&&(m=R[0]&2?A.return:R[0]?A.throw||((m=A.return)&&m.call(A),0):A.next)&&!(m=m.call(A,R[1])).done)return m;switch(A=0,m&&(R=[R[0]&2,m.value]),R[0]){case 0:case 1:m=R;break;case 4:return M.label++,{value:R[1],done:!1};case 5:M.label++,A=R[1],R=[0];continue;case 7:R=M.ops.pop(),M.trys.pop();continue;default:if(m=M.trys,!(m=m.length>0&&m[m.length-1])&&(R[0]===6||R[0]===2)){M=0;continue}if(R[0]===3&&(!m||R[1]>m[0]&&R[1]<m[3])){M.label=R[1];break}if(R[0]===6&&M.label<m[1]){M.label=m[1],m=R;break}if(m&&M.label<m[2]){M.label=m[2],M.ops.push(R);break}m[2]&&M.ops.pop(),M.trys.pop();continue}R=k.call(b,M)}catch(z){R=[6,z],A=0}finally{x=m=0}if(R[0]&5)throw R[1];return{value:R[0]?R[1]:void 0,done:!0}}},E=function(b,k,M){b===void 0&&(b=document),k===void 0&&(k=T.Y.CDN);var x=f.mermaidRenderAdapter.getElements(b);x.length!==0&&(0,C.Z)("".concat(k,"/dist/js/mermaid/mermaid.min.js"),"vditorMermaidScript").then(function(){var A={securityLevel:"loose",altFontFamily:"sans-serif",fontFamily:"sans-serif",startOnLoad:!1,flowchart:{htmlLabels:!0,useMaxWidth:!0},sequence:{useMaxWidth:!0,diagramMarginX:8,diagramMarginY:8,boxMargin:8,showSequenceNumbers:!0},gantt:{leftPadding:75,rightPadding:20}};M==="dark"&&(A.theme="dark"),mermaid.initialize(A),x.forEach(function(m){return p(void 0,void 0,void 0,function(){var O,N,H,R,z;return v(this,function(Y){switch(Y.label){case 0:if(O=f.mermaidRenderAdapter.getCode(m),m.getAttribute("data-processed")==="true"||O.trim()==="")return[2];N="mermaid"+(0,u.Ee)(),Y.label=1;case 1:return Y.trys.push([1,3,,4]),[4,mermaid.render(N,m.textContent)];case 2:return H=Y.sent(),m.innerHTML=H.svg,[3,4];case 3:return R=Y.sent(),z=document.querySelector("#"+N),m.innerHTML="".concat(z.outerHTML,`<br>
<div style="text-align: left"><small>`).concat(R.message.replace(/\n/,"<br>"),"</small></div>"),z.parentElement.remove(),[3,4];case 4:return m.setAttribute("data-processed","true"),[2]}})})})})}},162:(g,d,y)=>{y.d(d,{l:()=>u});var T=y(913),C=y(161),f=y(59),u=function(p,v,E){p===void 0&&(p=document),v===void 0&&(v=T.Y.CDN);var b=f.mindmapRenderAdapter.getElements(p);b.length>0&&(0,C.Z)("".concat(v,"/dist/js/echarts/echarts.min.js?v=5.5.1"),"vditorEchartsScript").then(function(){b.forEach(function(k){if(!(k.parentElement.classList.contains("vditor-wysiwyg__pre")||k.parentElement.classList.contains("vditor-ir__marker--pre"))){var M=f.mindmapRenderAdapter.getCode(k);if(M)try{if(k.getAttribute("data-processed")==="true")return;echarts.init(k,E==="dark"?"dark":void 0).setOption({series:[{data:[JSON.parse(decodeURIComponent(M))],initialTreeDepth:-1,itemStyle:{borderWidth:0,color:"#4285f4"},label:{backgroundColor:"#f6f8fa",borderColor:"#d1d5da",borderRadius:5,borderWidth:.5,color:"#586069",lineHeight:20,offset:[-5,0],padding:[0,5],position:"insideRight"},lineStyle:{color:"#d1d5da",width:1},roam:!0,symbol:function(x,A){var m;return!((m=A==null?void 0:A.data)===null||m===void 0)&&m.children?"circle":"path://"},type:"tree"}],tooltip:{trigger:"item",triggerOn:"mousemove"}}),k.setAttribute("data-processed","true")}catch(x){k.className="vditor-reset--error",k.innerHTML="mindmap render error: <br>".concat(x)}}})})}},70:(g,d,y)=>{y.d(d,{N:()=>f});var T=y(164),C=y(960),f=function(u,p,v){var E="",b=[];if(Array.from(u.children).forEach(function(A,m){if((0,T.c)(A)){if(v){var O=A.id.lastIndexOf("_");A.id=A.id.substring(0,O===-1?void 0:O)+"_"+m}b.push(A.id),E+=A.outerHTML.replace("<wbr>","")}}),E==="")return p.innerHTML="","";var k=document.createElement("div");if(v)v.lute.SetToC(!0),v.currentMode==="wysiwyg"&&!v.preview.element.contains(u)?k.innerHTML=v.lute.SpinVditorDOM("<p>[ToC]</p>"+E):v.currentMode==="ir"&&!v.preview.element.contains(u)?k.innerHTML=v.lute.SpinVditorIRDOM("<p>[ToC]</p>"+E):k.innerHTML=v.lute.HTML2VditorDOM("<p>[ToC]</p>"+E),v.lute.SetToC(v.options.preview.markdown.toc);else{p.classList.add("vditor-outline");var M=Lute.New();M.SetToC(!0),k.innerHTML=M.HTML2VditorDOM("<p>[ToC]</p>"+E)}var x=k.firstElementChild.querySelectorAll("li > span[data-target-id]");return x.forEach(function(A,m){if(A.nextElementSibling&&A.nextElementSibling.tagName==="UL"){var O="<svg class='vditor-outline__action'><use xlink:href='#vditor-icon-down'></use></svg>";document.getElementById("vditorIconScript")||(O='<svg class="vditor-outline__action" viewBox="0 0 32 32"><path d="M3.76 6.12l12.24 12.213 12.24-12.213 3.76 3.76-16 16-16-16 3.76-3.76z"></path></svg>'),A.innerHTML="".concat(O,"<span>").concat(A.innerHTML,"</span>")}else A.innerHTML="<svg></svg><span>".concat(A.innerHTML,"</span>");A.setAttribute("data-target-id",b[m])}),E=k.firstElementChild.innerHTML,x.length===0?(p.innerHTML="",E):(p.innerHTML=E,v&&(0,C.T)(p,{cdn:v.options.cdn,math:v.options.preview.math}),p.firstElementChild.addEventListener("click",function(A){for(var m=A.target;m&&!m.isEqualNode(p);){if(m.classList.contains("vditor-outline__action")){m.classList.contains("vditor-outline__action--close")?(m.classList.remove("vditor-outline__action--close"),m.parentElement.nextElementSibling.setAttribute("style","display:block")):(m.classList.add("vditor-outline__action--close"),m.parentElement.nextElementSibling.setAttribute("style","display:none")),A.preventDefault(),A.stopPropagation();break}else if(m.getAttribute("data-target-id")){A.preventDefault(),A.stopPropagation();var O=document.getElementById(m.getAttribute("data-target-id"));if(!O)return;if(v)if(v.options.height==="auto"){var N=O.offsetTop+v.element.offsetTop;v.options.toolbarConfig.pin||(N+=v.toolbar.element.offsetHeight),window.scrollTo(window.scrollX,N)}else v.element.offsetTop<window.scrollY&&window.scrollTo(window.scrollX,v.element.offsetTop),v.preview.element.contains(u)?u.parentElement.scrollTop=O.offsetTop:u.scrollTop=O.offsetTop;else window.scrollTo(window.scrollX,O.offsetTop);break}m=m.parentElement}}),E)}},591:(g,d,y)=>{y.d(d,{M:()=>u});var T=y(913),C=y(161),f=y(59),u=function(p,v){p===void 0&&(p=document),v===void 0&&(v=T.Y.CDN);var E=f.plantumlRenderAdapter.getElements(p);E.length!==0&&(0,C.Z)("".concat(v,"/dist/js/plantuml/plantuml-encoder.min.js"),"vditorPlantumlScript").then(function(){E.forEach(function(b){if(!(b.parentElement.classList.contains("vditor-wysiwyg__pre")||b.parentElement.classList.contains("vditor-ir__marker--pre"))){var k=f.plantumlRenderAdapter.getCode(b).trim();if(k)try{b.innerHTML='<object type="image/svg+xml" data="https://www.plantuml.com/plantuml/svg/~1'.concat(plantumlEncoder.encode(k),'"/>')}catch(M){b.className="vditor-reset--error",b.innerHTML="plantuml render error: <br>".concat(M)}}})})}},796:(g,d,y)=>{y.d(d,{X:()=>T});var T=function(C){var f=Lute.New();return f.PutEmojis(C.emojis),f.SetEmojiSite(C.emojiSite),f.SetHeadingAnchor(C.headingAnchor),f.SetInlineMathAllowDigitAfterOpenMarker(C.inlineMathDigit),f.SetAutoSpace(C.autoSpace),f.SetToC(C.toc),f.SetFootnotes(C.footnotes),f.SetFixTermTypo(C.fixTermTypo),f.SetVditorCodeBlockPreview(C.codeBlockPreview),f.SetVditorMathBlockPreview(C.mathBlockPreview),f.SetSanitize(C.sanitize),f.SetChineseParagraphBeginningSpace(C.paragraphBeginningSpace),f.SetRenderListStyle(C.listStyle),f.SetLinkBase(C.linkBase),f.SetLinkPrefix(C.linkPrefix),f.SetMark(C.mark),f.SetGFMAutoLink(C.gfmAutoLink),C.lazyLoadImage&&f.SetImageLazyLoading(C.lazyLoadImage),f}},726:(g,d,y)=>{y.d(d,{o:()=>T});var T=function(C,f,u){u===void 0&&(u="classic");var p=C.getBoundingClientRect(),v=36;document.body.insertAdjacentHTML("beforeend",'<div class="vditor vditor-img'.concat(u==="dark"?" vditor--dark":"",`">
    <div class="vditor-img__bar">
      <span class="vditor-img__btn" data-deg="0">
        <svg><use xlink:href="#vditor-icon-redo"></use></svg>
        `).concat(window.VditorI18n.spin,`
      </span>
      <span class="vditor-img__btn"  onclick="this.parentElement.parentElement.outerHTML = '';document.body.style.overflow = ''">
        X &nbsp;`).concat(window.VditorI18n.close,`
      </span>
    </div>
    <div class="vditor-img__img" onclick="this.parentElement.outerHTML = '';document.body.style.overflow = ''">
      <img style="width: `).concat(C.width,"px;height:").concat(C.height,"px;transform: translate3d(").concat(p.left,"px, ").concat(p.top-v,'px, 0)" src="').concat(C.getAttribute("src"),`">
    </div>
</div>`)),document.body.style.overflow="hidden";var E=document.querySelector(".vditor-img img"),b="translate3d(".concat(Math.max(0,window.innerWidth-C.naturalWidth)/2,"px, ").concat(Math.max(0,window.innerHeight-v-C.naturalHeight)/2,"px, 0)");setTimeout(function(){E.setAttribute("style","transition: transform .3s ease-in-out;transform: ".concat(b)),setTimeout(function(){E.parentElement.scrollTo((E.parentElement.scrollWidth-E.parentElement.clientWidth)/2,(E.parentElement.scrollHeight-E.parentElement.clientHeight)/2)},400)});var k=document.querySelector(".vditor-img__btn");k.addEventListener("click",function(){var M=parseInt(k.getAttribute("data-deg"),10)+90;M/90%2===1&&C.naturalWidth>E.parentElement.clientHeight?E.style.transform="translate3d(".concat(Math.max(0,window.innerWidth-C.naturalWidth)/2,"px, ").concat(C.naturalWidth/2-C.naturalHeight/2,"px, 0) rotateZ(").concat(M,"deg)"):E.style.transform="".concat(b," rotateZ(").concat(M,"deg)"),k.setAttribute("data-deg",M.toString()),setTimeout(function(){E.parentElement.scrollTo((E.parentElement.scrollWidth-E.parentElement.clientWidth)/2,(E.parentElement.scrollHeight-E.parentElement.clientHeight)/2)},400)})}},13:(g,d,y)=>{y.d(d,{h:()=>f});var T=y(913),C=y(505),f=function(u,p){p===void 0&&(p=T.Y.CDN),T.Y.CODE_THEME.includes(u)||(u="github");var v=document.getElementById("vditorHljsStyle"),E="".concat(p,"/dist/js/highlight.js/styles/").concat(u,".min.css");v?v.getAttribute("href")!==E&&(v.remove(),(0,C.T)(E,"vditorHljsStyle")):(0,C.T)(E,"vditorHljsStyle")}},873:(g,d,y)=>{y.d(d,{H:()=>C});var T=y(505),C=function(f,u){if(!(!f||!u)){var p=document.getElementById("vditorContentTheme"),v="".concat(u,"/").concat(f,".css");p?p.getAttribute("href")!==v&&(p.remove(),(0,T.T)(v,"vditorContentTheme")):(0,T.T)(v,"vditorContentTheme")}}},161:(g,d,y)=>{y.d(d,{U:()=>T,Z:()=>C});var T=function(f,u){if(document.getElementById(u))return!1;var p=new XMLHttpRequest;p.open("GET",f,!1),p.setRequestHeader("Accept","text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01"),p.send("");var v=document.createElement("script");v.type="text/javascript",v.text=p.responseText,v.id=u,document.head.appendChild(v)},C=function(f,u){return new Promise(function(p,v){if(document.getElementById(u))return p(!0),!1;var E=document.createElement("script");E.src=f,E.async=!0,document.head.appendChild(E),E.onerror=function(b){v(b)},E.onload=function(){if(document.getElementById(u))return E.remove(),p(!0),!1;E.id=u,p(!0)}})}},505:(g,d,y)=>{y.d(d,{T:()=>T});var T=function(C,f){if(!document.getElementById(f)){var u=document.createElement("link");u.id=f,u.rel="stylesheet",u.type="text/css",u.href=C,document.getElementsByTagName("head")[0].appendChild(u)}}},695:(g,d,y)=>{y.d(d,{p:()=>T});var T=function(C){return C.replace(/\u00a0/g," ")}},629:(g,d,y)=>{y.d(d,{D:()=>f,H8:()=>E,_0:()=>p,fG:()=>v,gm:()=>C,nr:()=>T,y3:()=>u});var T=function(){return navigator.userAgent.indexOf("Safari")>-1&&navigator.userAgent.indexOf("Chrome")===-1},C=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},f=function(){try{return typeof localStorage<"u"}catch{return!1}},u=function(){return navigator.userAgent.indexOf("iPhone")>-1?"touchstart":"click"},p=function(b){return navigator.platform.toUpperCase().indexOf("MAC")>=0?!!(b.metaKey&&!b.ctrlKey):!!(!b.metaKey&&b.ctrlKey)},v=function(b){return/Mac/.test(navigator.platform)||navigator.platform==="iPhone"?b.indexOf("⇧")>-1&&C()&&(b=b.replace(";",":").replace("=","+").replace("-","_")):(b.startsWith("⌘")?b=b.replace("⌘","⌘+"):b.startsWith("⌥")&&b.substr(1,1)!=="⌘"?b=b.replace("⌥","⌥+"):b=b.replace("⇧⌘","⌘+⇧+").replace("⌥⌘","⌥+⌘+"),b=b.replace("⌘","Ctrl").replace("⇧","Shift").replace("⌥","Alt"),b.indexOf("Shift")>-1&&(b=b.replace(";",":").replace("=","+").replace("-","_"))),b},E=function(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}},933:(g,d,y)=>{y.d(d,{Ee:()=>T,TK:()=>C,kY:()=>f});var T=function(){return([1e7].toString()+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(u){return(parseInt(u,10)^window.crypto.getRandomValues(new Uint32Array(1))[0]&15>>parseInt(u,10)/4).toString(16)})},C=function(u,p){p===void 0&&(p=window.location.search);var v=p.substring(p.indexOf("?")),E=v.indexOf("#"),b=new URLSearchParams(v.substring(0,E>=0?E:void 0));return b.get(u)},f=function(u){return Function('"use strict";return ('.concat(u,")"))()}},598:(g,d,y)=>{y.d(d,{Ab:()=>f,KJ:()=>b,KR:()=>u,Rp:()=>k,Th:()=>p,XW:()=>C,_Y:()=>E,pt:()=>v});var T=y(164),C=function(M,x){for(var A=b(M,x),m=!1,O=!1;A&&!A.classList.contains("vditor-reset")&&!O;)m=b(A.parentElement,x),m?A=m:O=!0;return A||!1},f=function(M,x){for(var A=(0,T.f)(M,x),m=!1,O=!1;A&&!A.classList.contains("vditor-reset")&&!O;)m=(0,T.f)(A.parentElement,x),m?A=m:O=!0;return A||!1},u=function(M){var x=f(M,"UL"),A=f(M,"OL"),m=x;return A&&(!x||x&&A.contains(x))&&(m=A),m},p=function(M,x,A){if(!M)return!1;M.nodeType===3&&(M=M.parentElement);for(var m=M,O=!1;m&&!O&&!m.classList.contains("vditor-reset");)m.getAttribute(x)===A?O=!0:m=m.parentElement;return O&&m},v=function(M){if(!M)return!1;M.nodeType===3&&(M=M.parentElement);var x=M,A=!1,m=p(M,"data-block","0");if(m)return m;for(;x&&!A&&!x.classList.contains("vditor-reset");)x.tagName==="H1"||x.tagName==="H2"||x.tagName==="H3"||x.tagName==="H4"||x.tagName==="H5"||x.tagName==="H6"||x.tagName==="P"||x.tagName==="BLOCKQUOTE"||x.tagName==="OL"||x.tagName==="UL"?A=!0:x=x.parentElement;return A&&x},E=function(M,x){if(!M)return!1;M.nodeType===3&&(M=M.parentElement);for(var A=M,m=!1;A&&!m&&!A.classList.contains("vditor-reset");)A.nodeName===x?m=!0:A=A.parentElement;return m&&A},b=function(M,x){if(!M)return!1;M.nodeType===3&&(M=M.parentElement);for(var A=M,m=!1;A&&!m&&!A.classList.contains("vditor-reset");)A.classList.contains(x)?m=!0:A=A.parentElement;return m&&A},k=function(M){for(;M&&M.lastChild;)M=M.lastChild;return M}},164:(g,d,y)=>{y.d(d,{c:()=>C,f:()=>T});var T=function(f,u){if(!f)return!1;f.nodeType===3&&(f=f.parentElement);for(var p=f,v=!1;p&&!v&&!p.classList.contains("vditor-reset");)p.nodeName.indexOf(u)===0?v=!0:p=p.parentElement;return v&&p},C=function(f){var u=T(f,"H");return u&&u.tagName.length===2&&u.tagName!=="HR"?u:!1}},905:(g,d,y)=>{y.d(d,{h:()=>T});var T=function(){for(var C=[],f=0;f<arguments.length;f++)C[f]=arguments[f];for(var u={},p=function(E){for(var b in E)E.hasOwnProperty(b)&&(Object.prototype.toString.call(E[b])==="[object Object]"?u[b]=T(u[b],E[b]):u[b]=E[b])},v=0;v<C.length;v++)p(C[v]);return u}},827:(g,d,y)=>{y.d(d,{Co:()=>v,ED:()=>b,Ey:()=>p,Fm:()=>k,RN:()=>u,Z2:()=>x,ir:()=>M,jl:()=>E});var T=y(913),C=y(629),f=y(598),u=function(A){var m,O=A[A.currentMode].element;return getSelection().rangeCount>0&&(m=getSelection().getRangeAt(0),O.isEqualNode(m.startContainer)||O.contains(m.startContainer))?m:A[A.currentMode].range?A[A.currentMode].range:(O.focus(),m=O.ownerDocument.createRange(),m.setStart(O,0),m.collapse(!0),m)},p=function(A){var m=window.getSelection().getRangeAt(0);if(!A.contains(m.startContainer)&&!(0,f.KJ)(m.startContainer,"vditor-panel--none"))return{left:0,top:0};var O=A.parentElement.getBoundingClientRect(),N;if(m.getClientRects().length===0)if(m.startContainer.nodeType===3){var H=m.startContainer.parentElement;if(H&&H.getClientRects().length>0)N=H.getClientRects()[0];else return{left:0,top:0}}else{var R=m.startContainer.children;if(R[m.startOffset]&&R[m.startOffset].getClientRects().length>0)N=R[m.startOffset].getClientRects()[0];else if(m.startContainer.childNodes.length>0){var z=m.cloneRange();m.selectNode(m.startContainer.childNodes[Math.max(0,m.startOffset-1)]),N=m.getClientRects()[0],m.setEnd(z.endContainer,z.endOffset),m.setStart(z.startContainer,z.startOffset)}else N=m.startContainer.getClientRects()[0];if(!N){for(var Y=m.startContainer.childNodes[m.startOffset];!Y.getClientRects||Y.getClientRects&&Y.getClientRects().length===0;)Y=Y.parentElement;N=Y.getClientRects()[0]}}else N=m.getClientRects()[0];return{left:N.left-O.left,top:N.top-O.top}},v=function(A,m){if(!m){if(getSelection().rangeCount===0)return!1;m=getSelection().getRangeAt(0)}var O=m.commonAncestorContainer;return A.isEqualNode(O)||A.contains(O)},E=function(A){var m=window.getSelection();m.removeAllRanges(),m.addRange(A)},b=function(A,m,O){var N={end:0,start:0};if(!O){if(getSelection().rangeCount===0)return N;O=window.getSelection().getRangeAt(0)}if(v(m,O)){var H=O.cloneRange();A.childNodes[0]&&A.childNodes[0].childNodes[0]?H.setStart(A.childNodes[0].childNodes[0],0):H.selectNodeContents(A),H.setEnd(O.startContainer,O.startOffset),N.start=H.toString().length,N.end=N.start+O.toString().length}return N},k=function(A,m,O){var N=0,H=0,R=O.childNodes[H],z=!1,Y=!1;A=Math.max(0,A),m=Math.max(0,m);var K=O.ownerDocument.createRange();for(K.setStart(R||O,0),K.collapse(!0);!Y&&R;){var re=N+R.textContent.length;if(!z&&A>=N&&A<=re&&(A===0?K.setStart(R,0):R.childNodes[0].nodeType===3?K.setStart(R.childNodes[0],A-N):R.nextSibling?K.setStartBefore(R.nextSibling):K.setStartAfter(R),z=!0,A===m)){Y=!0;break}z&&m>=N&&m<=re&&(m===0?K.setEnd(R,0):R.childNodes[0].nodeType===3?K.setEnd(R.childNodes[0],m-N):R.nextSibling?K.setEndBefore(R.nextSibling):K.setEndAfter(R),Y=!0),N=re,R=O.childNodes[++H]}return!Y&&O.childNodes[H-1]&&K.setStartBefore(O.childNodes[H-1]),E(K),K},M=function(A,m){var O=A.querySelector("wbr");if(O){if(!O.previousElementSibling)O.previousSibling?m.setStart(O.previousSibling,O.previousSibling.textContent.length):O.nextSibling?O.nextSibling.nodeType===3?m.setStart(O.nextSibling,0):m.setStartBefore(O.nextSibling):m.setStart(O.parentElement,0);else if(O.previousElementSibling.isSameNode(O.previousSibling))if(O.previousElementSibling.lastChild){m.setStartBefore(O),m.collapse(!0),E(m),(0,C.H8)()&&(O.previousElementSibling.tagName==="EM"||O.previousElementSibling.tagName==="STRONG"||O.previousElementSibling.tagName==="S")&&(m.insertNode(document.createTextNode(T.Y.ZWSP)),m.collapse(!1)),O.remove();return}else m.setStartAfter(O.previousElementSibling);else m.setStart(O.previousSibling,O.previousSibling.textContent.length);m.collapse(!0),O.remove(),E(m)}},x=function(A,m){var O=document.createElement("div");O.innerHTML=A;var N=O.querySelectorAll("p");N.length===1&&!N[0].previousSibling&&!N[0].nextSibling&&m[m.currentMode].element.children.length>0&&O.firstElementChild.tagName==="P"&&(A=N[0].innerHTML.trim());var H=document.createElement("div");H.innerHTML=A;var R=u(m);if(R.toString()!==""&&(m[m.currentMode].preventInput=!0,document.execCommand("delete",!1,"")),H.firstElementChild&&H.firstElementChild.getAttribute("data-block")==="0"){H.lastElementChild.insertAdjacentHTML("beforeend","<wbr>");var z=(0,f.pt)(R.startContainer);z?z.insertAdjacentHTML("afterend",H.innerHTML):m[m.currentMode].element.insertAdjacentHTML("beforeend",H.innerHTML),M(m[m.currentMode].element,R)}else{var Y=document.createElement("template");Y.innerHTML=A,R.insertNode(Y.content.cloneNode(!0)),R.collapse(!1),E(R)}}}},s={};function c(g){var d=s[g];if(d!==void 0)return d.exports;var y=s[g]={exports:{}};return r[g](y,y.exports,c),y.exports}c.d=(g,d)=>{for(var y in d)c.o(d,y)&&!c.o(g,y)&&Object.defineProperty(g,y,{enumerable:!0,get:d[y]})},c.o=(g,d)=>Object.prototype.hasOwnProperty.call(g,d),c.r=g=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(g,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(g,"__esModule",{value:!0})};var h={};return(()=>{c.d(h,{default:()=>Ks});var g=c(923),d=c(913),y=c(695),T=function(e){return e.currentMode==="sv"?(0,y.p)("".concat(e.sv.element.textContent,`
`).replace(/\n\n$/,`
`)):e.currentMode==="wysiwyg"?e.lute.VditorDOM2Md(e.wysiwyg.element.innerHTML):e.currentMode==="ir"?e.lute.VditorIRDOM2Md(e.ir.element.innerHTML):""},C=c(161),f=function(){function e(){this.element=document.createElement("div"),this.element.className="vditor-devtools",this.element.innerHTML='<div class="vditor-reset--error"></div><div style="height: 100%;"></div>'}return e.prototype.renderEchart=function(t){var i=this;t.devtools.element.style.display==="block"&&(0,C.Z)("".concat(t.options.cdn,"/dist/js/echarts/echarts.min.js?v=5.5.1"),"vditorEchartsScript").then(function(){i.ASTChart||(i.ASTChart=echarts.init(t.devtools.element.lastElementChild));try{i.element.lastElementChild.style.display="block",i.element.firstElementChild.innerHTML="",i.ASTChart.setOption({series:[{data:JSON.parse(t.lute.RenderEChartsJSON(T(t))),initialTreeDepth:-1,label:{align:"left",backgroundColor:"rgba(68, 77, 86, .68)",borderRadius:3,color:"#d1d5da",fontSize:12,lineHeight:12,offset:[9,12],padding:[2,4,2,4],position:"top",verticalAlign:"middle"},lineStyle:{color:"#4285f4",type:"curve",width:1},orient:"vertical",roam:!0,type:"tree"}],toolbox:{bottom:25,emphasis:{iconStyle:{color:"#4285f4"}},feature:{restore:{show:!0},saveAsImage:{show:!0}},right:15,show:!0}}),i.ASTChart.resize()}catch(a){i.element.lastElementChild.style.display="none",i.element.firstElementChild.innerHTML=a}})},e}(),u=c(629),p=function(e,t){t.forEach(function(i){if(e[i]){var a=e[i].children[0];a&&a.classList.contains("vditor-menu--current")&&a.classList.remove("vditor-menu--current")}})},v=function(e,t){t.forEach(function(i){if(e[i]){var a=e[i].children[0];a&&!a.classList.contains("vditor-menu--current")&&a.classList.add("vditor-menu--current")}})},E=function(e,t){t.forEach(function(i){if(e[i]){var a=e[i].children[0];a&&a.classList.contains(d.Y.CLASS_MENU_DISABLED)&&a.classList.remove(d.Y.CLASS_MENU_DISABLED)}})},b=function(e,t){t.forEach(function(i){if(e[i]){var a=e[i].children[0];a&&!a.classList.contains(d.Y.CLASS_MENU_DISABLED)&&a.classList.add(d.Y.CLASS_MENU_DISABLED)}})},k=function(e,t){t.forEach(function(i){e[i]&&e[i]&&(e[i].style.display="none")})},M=function(e,t){t.forEach(function(i){e[i]&&e[i]&&(e[i].style.display="block")})},x=function(e,t,i){t.includes("subToolbar")&&(e.toolbar.element.querySelectorAll(".vditor-hint").forEach(function(a){i&&a.isEqualNode(i)||(a.style.display="none")}),e.toolbar.elements.emoji&&(e.toolbar.elements.emoji.lastElementChild.style.display="none")),t.includes("hint")&&(e.hint.element.style.display="none"),e.wysiwyg.popover&&t.includes("popover")&&(e.wysiwyg.popover.style.display="none")},A=function(e,t,i,a){i.addEventListener((0,u.y3)(),function(o){o.preventDefault(),o.stopPropagation(),!i.classList.contains(d.Y.CLASS_MENU_DISABLED)&&(e.toolbar.element.querySelectorAll(".vditor-hint--current").forEach(function(l){l.classList.remove("vditor-hint--current")}),t.style.display==="block"?t.style.display="none":(x(e,["subToolbar","hint","popover"],i.parentElement.parentElement),i.classList.contains("vditor-tooltipped")||i.classList.add("vditor-hint--current"),t.style.display="block",e.toolbar.element.getBoundingClientRect().right-i.getBoundingClientRect().right<250?t.classList.add("vditor-panel--left"):t.classList.remove("vditor-panel--left")))})},m=c(598),O=c(164),N=function(e,t,i,a){a&&console.log("".concat(e," - ").concat(i,": ").concat(t))},H=c(288),R=c(784),z=c(51),Y=c(500),K=c(339),re=c(108),pe=c(960),we=c(975),ge=c(597),ie=c(162),fe=c(591),Ae=c(931),Fe=function(e,t,i){i===void 0&&(i="sv");var a=document.createElement("div");a.innerHTML=e;var o=!1;a.childElementCount===1&&a.lastElementChild.style.fontFamily.indexOf("monospace")>-1&&(o=!0);var l=a.querySelectorAll("pre");if(a.childElementCount===1&&l.length===1&&l[0].className!=="vditor-wysiwyg"&&l[0].className!=="vditor-sv"&&(o=!0),e.indexOf(`
<p class="p1">`)===0&&(o=!0),a.childElementCount===1&&a.firstElementChild.tagName==="TABLE"&&a.querySelector(".line-number")&&a.querySelector(".line-content")&&(o=!0),o){var S=t||e;return/\n/.test(S)||l.length===1?i==="wysiwyg"?'<div class="vditor-wysiwyg__block" data-block="0" data-type="code-block"><pre><code>'.concat(S.replace(/&/g,"&amp;").replace(/</g,"&lt;"),"<wbr></code></pre></div>"):"\n```\n"+S.replace(/&/g,"&amp;").replace(/</g,"&lt;")+"\n```":i==="wysiwyg"?"<code>".concat(S.replace(/&/g,"&amp;").replace(/</g,"&lt;"),"</code><wbr>"):"`".concat(S,"`")}return!1},Pe=function(e,t){if(e){if(e.parentElement.getAttribute("data-type")==="html-block"){e.setAttribute("data-render","1");return}var i=e.firstElementChild.className.replace("language-","");if(i==="abc")(0,H.$)(e,t.options.cdn);else if(i==="mermaid")(0,we.e)(e,t.options.cdn,t.options.theme);else if(i==="smiles")(0,Ae.Y)(e,t.options.cdn,t.options.theme);else if(i==="markmap")(0,ge.K)(e,t.options.cdn);else if(i==="flowchart")(0,Y.D)(e,t.options.cdn);else if(i==="echarts")(0,R.v)(e,t.options.cdn,t.options.theme);else if(i==="mindmap")(0,ie.l)(e,t.options.cdn,t.options.theme);else if(i==="plantuml")(0,fe.M)(e,t.options.cdn);else if(i==="graphviz")(0,K.m)(e,t.options.cdn);else if(i==="math")(0,pe.T)(e,{cdn:t.options.cdn,math:t.options.preview.math});else{var a=t.options.customRenders.find(function(o){if(o.language===i)return o.render(e,t),!0});a||((0,re.$)(Object.assign({},t.options.preview.hljs),e,t.options.cdn),(0,z.o)(e,t.options.preview.hljs))}e.setAttribute("data-render","1")}},P=c(827),j=function(e){if(e.currentMode!=="sv"){var t=e[e.currentMode].element,i=e.outline.render(e);i===""&&(i="[ToC]"),t.querySelectorAll('[data-type="toc-block"]').forEach(function(a){a.innerHTML=i,(0,pe.T)(a,{cdn:e.options.cdn,math:e.options.preview.math})})}},U=function(e,t){var i=(0,m._Y)(e.target,"SPAN");if(i&&(0,m.KJ)(i,"vditor-toc")){var a=t[t.currentMode].element.querySelector("#"+i.getAttribute("data-target-id"));if(a)if(t.options.height==="auto"){var o=a.offsetTop+t.element.offsetTop;t.options.toolbarConfig.pin||(o+=t.toolbar.element.offsetHeight),window.scrollTo(window.scrollX,o)}else t.element.offsetTop<window.scrollY&&window.scrollTo(window.scrollX,t.element.offsetTop),t[t.currentMode].element.scrollTop=a.offsetTop;return}},X=function(e,t,i,a){if(e.previousElementSibling&&e.previousElementSibling.classList.contains("vditor-toc")){if(i.key==="Backspace"&&(0,P.ED)(e,t[t.currentMode].element,a).start===0)return e.previousElementSibling.remove(),Ce(t),!0;if(fn(t,i,a,e,e.previousElementSibling))return!0}if(e.nextElementSibling&&e.nextElementSibling.classList.contains("vditor-toc")){if(i.key==="Delete"&&(0,P.ED)(e,t[t.currentMode].element,a).start>=e.textContent.trimRight().length)return e.nextElementSibling.remove(),Ce(t),!0;if(Dn(t,i,a,e,e.nextElementSibling))return!0}if(i.key==="Backspace"||i.key==="Delete"){var o=(0,m.KJ)(a.startContainer,"vditor-toc");if(o)return o.remove(),Ce(t),!0}},ue=function(e,t,i,a){i===void 0&&(i=!1);var o=(0,m.pt)(t.startContainer);if(o&&!i&&o.getAttribute("data-type")!=="code-block"){if(Di(o.innerHTML)&&o.previousElementSibling||Oi(o.innerHTML))return;for(var l=(0,P.ED)(o,e.ir.element,t).start,S=!0,_=l-1;_>o.textContent.substr(0,l).lastIndexOf(`
`);_--)if(o.textContent.charAt(_)!==" "&&o.textContent.charAt(_)!=="	"){S=!1;break}l===0&&(S=!1);for(var D=!0,_=l-1;_<o.textContent.length;_++)if(o.textContent.charAt(_)!==" "&&o.textContent.charAt(_)!==`
`){D=!1;break}if(S){typeof e.options.input=="function"&&e.options.input(T(e));return}if(D&&/^#{1,6} $/.test(o.textContent)&&(D=!1),D){var L=(0,m.KJ)(t.startContainer,"vditor-ir__marker");if(!L){var I=t.startContainer.previousSibling;I&&I.nodeType!==3&&I.classList.contains("vditor-ir__node--expand")&&I.classList.remove("vditor-ir__node--expand"),typeof e.options.input=="function"&&e.options.input(T(e));return}}}if(e.ir.element.querySelectorAll(".vditor-ir__node--expand").forEach(function(Ee){Ee.classList.remove("vditor-ir__node--expand")}),o||(o=e.ir.element),!o.querySelector("wbr")){var B=(0,m.KJ)(t.startContainer,"vditor-ir__preview");B?B.previousElementSibling.insertAdjacentHTML("beforeend","<wbr>"):t.insertNode(document.createElement("wbr"))}o.querySelectorAll("[style]").forEach(function(Ee){Ee.removeAttribute("style")}),o.getAttribute("data-type")==="link-ref-defs-block"&&(o=e.ir.element);var Z=o.isEqualNode(e.ir.element),G=(0,m.Th)(o,"data-type","footnotes-block"),W="";if(Z)W=o.innerHTML;else{var se=(0,O.f)(t.startContainer,"BLOCKQUOTE"),Q=(0,m.KR)(t.startContainer);if(Q&&(o=Q),se&&(!Q||Q&&!se.contains(Q))&&(o=se),G&&(o=G),W=o.outerHTML,o.tagName==="UL"||o.tagName==="OL"){var q=o.previousElementSibling,ve=o.nextElementSibling;q&&(q.tagName==="UL"||q.tagName==="OL")&&(W=q.outerHTML+W,q.remove()),ve&&(ve.tagName==="UL"||ve.tagName==="OL")&&(W=W+ve.outerHTML,ve.remove()),W=W.replace("<div><wbr><br></div>","<li><p><wbr><br></p></li>")}else o.previousElementSibling&&o.previousElementSibling.textContent.replace(d.Y.ZWSP,"")!==""&&a&&a.inputType==="insertParagraph"&&(W=o.previousElementSibling.outerHTML+W,o.previousElementSibling.remove());o.innerText.startsWith("```")||(e.ir.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(Ee){Ee&&!o.isEqualNode(Ee)&&(W+=Ee.outerHTML,Ee.remove())}),e.ir.element.querySelectorAll("[data-type='footnotes-block']").forEach(function(Ee){Ee&&!o.isEqualNode(Ee)&&(W+=Ee.outerHTML,Ee.remove())}))}if(N("SpinVditorIRDOM",W,"argument",e.options.debugger),W=e.lute.SpinVditorIRDOM(W),N("SpinVditorIRDOM",W,"result",e.options.debugger),Z)o.innerHTML=W;else if(o.outerHTML=W,G){var ae=(0,m.Th)(e.ir.element.querySelector("wbr"),"data-type","footnotes-def");if(ae){var be=ae.textContent,je=be.substring(1,be.indexOf("]:")),Re=e.ir.element.querySelector('sup[data-type="footnotes-ref"][data-footnotes-label="'.concat(je,'"]'));Re&&Re.setAttribute("aria-label",be.substr(je.length+3).trim().substr(0,24))}}var ze,ut=e.ir.element.querySelectorAll("[data-type='link-ref-defs-block']");ut.forEach(function(Ee,We){We===0?ze=Ee:(ze.insertAdjacentHTML("beforeend",Ee.innerHTML),Ee.remove())}),ut.length>0&&e.ir.element.insertAdjacentElement("beforeend",ut[0]);var tt,dt=e.ir.element.querySelectorAll("[data-type='footnotes-block']");dt.forEach(function(Ee,We){We===0?tt=Ee:(tt.insertAdjacentHTML("beforeend",Ee.innerHTML),Ee.remove())}),dt.length>0&&e.ir.element.insertAdjacentElement("beforeend",dt[0]),(0,P.ir)(e.ir.element,t),e.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach(function(Ee){Pe(Ee,e)}),j(e),Rt(e,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},$=function(e,t){if(e==="")return!1;if(e.indexOf("⇧")===-1&&e.indexOf("⌘")===-1&&e.indexOf("⌥")===-1)return!(0,u._0)(t)&&!t.altKey&&!t.shiftKey&&t.code===e;if(e==="⇧Tab")return!!(!(0,u._0)(t)&&!t.altKey&&t.shiftKey&&t.code==="Tab");var i=e.split("");if(e.startsWith("⌥")){var a=i.length===3?i[2]:i[1];return!!((i.length===3?(0,u._0)(t):!(0,u._0)(t))&&t.altKey&&!t.shiftKey&&t.code===(/^[0-9]$/.test(a)?"Digit":"Key")+a)}e==="⌘Enter"&&(i=["⌘","Enter"]);var o=i.length>2&&i[0]==="⇧",l=o?i[2]:i[1];return o&&((0,u.gm)()||!/Mac/.test(navigator.platform))&&(l==="-"?l="_":l==="="&&(l="+")),!!((0,u._0)(t)&&t.key.toLowerCase()===l.toLowerCase()&&!t.altKey&&(!o&&!t.shiftKey||o&&t.shiftKey))},he=function(e){var t=e.startContainer;if(t.nodeType===3&&t.nodeValue.length!==e.startOffset)return!1;for(var i=t.nextSibling;i&&i.textContent==="";)i=i.nextSibling;if(i){if(i&&i.nodeType!==3&&i.classList.contains("vditor-ir__node")&&!i.getAttribute("data-block"))return i}else{var a=(0,m.KJ)(t,"vditor-ir__marker");if(a&&!a.nextSibling){var o=t.parentElement.parentElement.nextSibling;if(o&&o.nodeType!==3&&o.classList.contains("vditor-ir__node"))return o}return!1}return!1},J=function(e){var t=e.startContainer,i=t.previousSibling;return t.nodeType===3&&e.startOffset===0&&i&&i.nodeType!==3&&i.classList.contains("vditor-ir__node")&&!i.getAttribute("data-block")?i:!1},F=function(e,t){t.ir.element.querySelectorAll(".vditor-ir__node--expand").forEach(function(S){S.classList.remove("vditor-ir__node--expand")});var i=(0,m.XW)(e.startContainer,"vditor-ir__node"),a=!e.collapsed&&(0,m.XW)(e.endContainer,"vditor-ir__node");if(!(!e.collapsed&&(!i||i!==a))){i&&(i.classList.add("vditor-ir__node--expand"),i.classList.remove("vditor-ir__node--hidden"),(0,P.jl)(e));var o=he(e);if(o){o.classList.add("vditor-ir__node--expand"),o.classList.remove("vditor-ir__node--hidden");return}var l=J(e);if(l){l.classList.add("vditor-ir__node--expand"),l.classList.remove("vditor-ir__node--hidden");return}}},Le=function(e,t){if(e.ir.composingLock=t.isComposing,t.isComposing)return!1;t.key.indexOf("Arrow")===-1&&t.key!=="Meta"&&t.key!=="Control"&&t.key!=="Alt"&&t.key!=="Shift"&&t.key!=="CapsLock"&&t.key!=="Escape"&&!/^F\d{1,2}$/.test(t.key)&&e.undo.recordFirstPosition(e,t);var i=(0,P.RN)(e),a=i.startContainer;if(!Er(t,e,a)||(Sr(i,e,t),Nr(i),t.key!=="Enter"&&t.key!=="Tab"&&t.key!=="Backspace"&&t.key.indexOf("Arrow")===-1&&!(0,u._0)(t)&&t.key!=="Escape"&&t.key!=="Delete"))return!1;var o=(0,m.Th)(a,"data-newline","1");if(!(0,u._0)(t)&&!t.altKey&&!t.shiftKey&&t.key==="Enter"&&o&&i.startOffset<o.textContent.length){var l=o.previousElementSibling;l&&(i.insertNode(document.createTextNode(l.textContent)),i.collapse(!1));var S=o.nextSibling;S&&(i.insertNode(document.createTextNode(S.textContent)),i.collapse(!0))}var _=(0,m._Y)(a,"P");if(xr(t,e,_,i)||Mr(i,e,_,t)||Rr(e,i,t,_))return!0;var D=(0,m.KJ)(a,"vditor-ir__marker--pre");if(D&&D.tagName==="PRE"){var L=D.firstChild;if(Pr(e,t,D,i)||(L.getAttribute("data-type")==="math-block"||L.getAttribute("data-type")==="html-block")&&fn(e,t,i,L,D.parentElement)||Dn(e,t,i,L,D.parentElement))return!0}var I=(0,m.Th)(a,"data-type","code-block-info");if(I){if(t.key==="Enter"||t.key==="Tab")return i.selectNodeContents(I.nextElementSibling.firstChild),i.collapse(!0),t.preventDefault(),x(e,["hint"]),!0;if(t.key==="Backspace"){var B=(0,P.ED)(I,e.ir.element).start;B===1&&i.setStart(a,0),B===2&&(e.hint.recentLanguage="")}if(fn(e,t,i,I,I.parentElement))return x(e,["hint"]),!0}var Z=(0,m._Y)(a,"TD")||(0,m._Y)(a,"TH");if(t.key.indexOf("Arrow")>-1&&Z){var G=Oo(Z);if(G&&fn(e,t,i,Z,G))return!0;var W=Po(Z);if(W&&Dn(e,t,i,Z,W))return!0}if(Or(e,t,i)||Hr(e,i,t)||Pi(e,i,t))return!0;var se=(0,O.c)(a);if(se){if($("⌘=",t)){var Q=se.querySelector(".vditor-ir__marker--heading");return Q&&Q.textContent.trim().length>1&&On(e,Q.textContent.substr(1)),t.preventDefault(),!0}if($("⌘-",t)){var Q=se.querySelector(".vditor-ir__marker--heading");return Q&&Q.textContent.trim().length<6&&On(e,Q.textContent.trim()+"# "),t.preventDefault(),!0}}var q=(0,m.pt)(a);if(t.key==="Backspace"&&!(0,u._0)(t)&&!t.shiftKey&&!t.altKey&&i.toString()===""){if(Ir(e,i,t,_))return!0;if(q&&q.previousElementSibling&&q.tagName!=="UL"&&q.tagName!=="OL"&&(q.previousElementSibling.getAttribute("data-type")==="code-block"||q.previousElementSibling.getAttribute("data-type")==="math-block")){var ve=(0,P.ED)(q,e.ir.element,i).start;if(ve===0||ve===1&&q.innerText.startsWith(d.Y.ZWSP))return i.selectNodeContents(q.previousElementSibling.querySelector(".vditor-ir__marker--pre code")),i.collapse(!1),F(i,e),q.textContent.trim().replace(d.Y.ZWSP,"")===""&&(q.remove(),Rt(e)),t.preventDefault(),!0}if(se){var ae=se.firstElementChild.textContent.length;(0,P.ED)(se,e.ir.element).start===ae&&ae!==0&&(i.setStart(se.firstElementChild.firstChild,ae-1),i.collapse(!0),(0,P.jl)(i))}}return(t.key==="ArrowUp"||t.key==="ArrowDown")&&q&&(q.querySelectorAll(".vditor-ir__node").forEach(function(be){be.contains(a)||be.classList.add("vditor-ir__node--hidden")}),jr(t,q,i))?!0:(Cr(i,t.key),q&&X(q,e,t,i)?(t.preventDefault(),!0):!1)},ne=c(726),Ne=function(e,t){e.querySelectorAll("[data-type=footnotes-link]").forEach(function(i){for(var a=i.parentElement,o=a.nextSibling;o&&o.textContent.startsWith("    ");){var l=o;l.childNodes.forEach(function(S){a.append(S.cloneNode(!0))}),o=o.nextSibling,l.remove()}t&&t(a)})},Me=function(e,t){var i,a=getSelection().getRangeAt(0).cloneRange(),o=a.startContainer;a.startContainer.nodeType!==3&&a.startContainer.tagName==="DIV"&&(o=a.startContainer.childNodes[a.startOffset-1]);var l=(0,m.Th)(o,"data-block","0");if(l&&t&&(t.inputType==="deleteContentBackward"||t.data===" ")){for(var S=(0,P.ED)(l,e.sv.element,a).start,_=!0,D=S-1;D>l.textContent.substr(0,S).lastIndexOf(`
`);D--)if(l.textContent.charAt(D)!==" "&&l.textContent.charAt(D)!=="	"){_=!1;break}if(S===0&&(_=!1),_){Ge(e);return}if(t.inputType==="deleteContentBackward"){var L=(0,m.Th)(o,"data-type","code-block-open-marker")||(0,m.Th)(o,"data-type","code-block-close-marker");if(L){if(L.getAttribute("data-type")==="code-block-close-marker"){var I=Fn(o,"code-block-open-marker");if(I){I.textContent=L.textContent,Ge(e);return}}if(L.getAttribute("data-type")==="code-block-open-marker"){var I=Fn(o,"code-block-close-marker",!1);if(I){I.textContent=L.textContent,Ge(e);return}}}var B=(0,m.Th)(o,"data-type","math-block-open-marker");if(B){var Z=B.nextElementSibling.nextElementSibling;Z&&Z.getAttribute("data-type")==="math-block-close-marker"&&(Z.remove(),Ge(e));return}l.querySelectorAll('[data-type="code-block-open-marker"]').forEach(function(q){q.textContent.length===1&&q.remove()}),l.querySelectorAll('[data-type="code-block-close-marker"]').forEach(function(q){q.textContent.length===1&&q.remove()});var G=(0,m.Th)(o,"data-type","heading-marker");if(G&&G.textContent.indexOf("#")===-1){Ge(e);return}}if((t.data===" "||t.inputType==="deleteContentBackward")&&((0,m.Th)(o,"data-type","padding")||(0,m.Th)(o,"data-type","li-marker")||(0,m.Th)(o,"data-type","task-marker")||(0,m.Th)(o,"data-type","blockquote-marker"))){Ge(e);return}}if(l&&l.textContent.trimRight()==="$$"){Ge(e);return}l||(l=e.sv.element),((i=l.firstElementChild)===null||i===void 0?void 0:i.getAttribute("data-type"))==="link-ref-defs-block"&&(l=e.sv.element),(0,m.Th)(o,"data-type","footnotes-link")&&(l=e.sv.element),l.textContent.indexOf(Lute.Caret)===-1&&a.insertNode(document.createTextNode(Lute.Caret)),l.querySelectorAll("[style]").forEach(function(q){q.removeAttribute("style")}),l.querySelectorAll("font").forEach(function(q){q.outerHTML=q.innerHTML});var W=l.textContent,se=l.isEqualNode(e.sv.element);if(se)W=l.textContent;else{l.previousElementSibling&&(W=l.previousElementSibling.textContent+W,l.previousElementSibling.remove()),l.previousElementSibling&&W.indexOf(`---
`)===0&&(W=l.previousElementSibling.textContent+W,l.previousElementSibling.remove());var Q="";e.sv.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(q,ve){q&&!l.isEqualNode(q.parentElement)&&(Q+=q.parentElement.textContent+`
`,q.parentElement.remove())}),e.sv.element.querySelectorAll("[data-type='footnotes-link']").forEach(function(q,ve){q&&!l.isEqualNode(q.parentElement)&&(Q+=q.parentElement.textContent+`
`,q.parentElement.remove())}),W=Q+W}W=vr(W,e),se?l.innerHTML=W:l.outerHTML=W,e.sv.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(q){e.sv.element.insertAdjacentElement("beforeend",q.parentElement)}),Ne(e.sv.element,function(q){e.sv.element.insertAdjacentElement("beforeend",q)}),(0,P.ir)(e.sv.element,a),qe(e),Ge(e,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},Xe=function(e,t){var i,a,o,l,S;if(e.sv.composingLock=t.isComposing,t.isComposing||(t.key.indexOf("Arrow")===-1&&t.key!=="Meta"&&t.key!=="Control"&&t.key!=="Alt"&&t.key!=="Shift"&&t.key!=="CapsLock"&&t.key!=="Escape"&&!/^F\d{1,2}$/.test(t.key)&&e.undo.recordFirstPosition(e,t),t.key!=="Enter"&&t.key!=="Tab"&&t.key!=="Backspace"&&t.key.indexOf("Arrow")===-1&&!(0,u._0)(t)&&t.key!=="Escape"))return!1;var _=(0,P.RN)(e),D=_.startContainer;_.startContainer.nodeType!==3&&_.startContainer.tagName==="DIV"&&(D=_.startContainer.childNodes[_.startOffset-1]);var L=(0,m.Th)(D,"data-type","text"),I=(0,m.Th)(D,"data-type","blockquote-marker");if(!I&&_.startOffset===0&&L&&L.previousElementSibling&&L.previousElementSibling.getAttribute("data-type")==="blockquote-marker"&&(I=L.previousElementSibling),I&&t.key==="Enter"&&!(0,u._0)(t)&&!t.altKey&&I.nextElementSibling.textContent.trim()===""&&(0,P.ED)(I,e.sv.element,_).start===I.textContent.length)return((i=I.previousElementSibling)===null||i===void 0?void 0:i.getAttribute("data-type"))==="padding"&&I.previousElementSibling.setAttribute("data-action","enter-remove"),I.remove(),Ge(e),t.preventDefault(),!0;var B=(0,m.Th)(D,"data-type","li-marker"),Z=(0,m.Th)(D,"data-type","task-marker"),G=B;if(G||Z&&Z.nextElementSibling.getAttribute("data-type")!=="task-marker"&&(G=Z),!G&&_.startOffset===0&&L&&L.previousElementSibling&&(L.previousElementSibling.getAttribute("data-type")==="li-marker"||L.previousElementSibling.getAttribute("data-type")==="task-marker")&&(G=L.previousElementSibling),G){var W=(0,P.ED)(G,e.sv.element,_).start,se=G.getAttribute("data-type")==="task-marker",Q=G;if(se&&(Q=G.previousElementSibling.previousElementSibling.previousElementSibling),W===G.textContent.length){if(t.key==="Enter"&&!(0,u._0)(t)&&!t.altKey&&!t.shiftKey&&G.nextElementSibling.textContent.trim()==="")return((a=Q.previousElementSibling)===null||a===void 0?void 0:a.getAttribute("data-type"))==="padding"?(Q.previousElementSibling.remove(),Me(e)):(se&&(Q.remove(),G.previousElementSibling.previousElementSibling.remove(),G.previousElementSibling.remove()),G.nextElementSibling.remove(),G.remove(),Ge(e)),t.preventDefault(),!0;if(t.key==="Tab")return t.shiftKey?Q.previousElementSibling.getAttribute("data-type")==="padding"&&Q.previousElementSibling.remove():Q.insertAdjacentHTML("beforebegin",'<span data-type="padding">'.concat(Q.textContent.replace(/\S/g," "),"</span>")),/^\d/.test(Q.textContent)&&(Q.textContent=Q.textContent.replace(/^\d{1,}/,"1"),_.selectNodeContents(G.firstChild),_.collapse(!1)),Me(e),t.preventDefault(),!0}}if(Pi(e,_,t))return!0;var q=(0,m.Th)(D,"data-block","0"),ve=(0,O.f)(D,"SPAN");if(t.key==="Enter"&&!(0,u._0)(t)&&!t.altKey&&!t.shiftKey&&q){var ae=!1,be=q.textContent.match(/^\n+/);(0,P.ED)(q,e.sv.element).start<=(be?be[0].length:0)&&(ae=!0);var je=`
`;if(ve){if(((o=ve.previousElementSibling)===null||o===void 0?void 0:o.getAttribute("data-action"))==="enter-remove")return ve.previousElementSibling.remove(),Ge(e),t.preventDefault(),!0;je+=So(ve)}return _.insertNode(document.createTextNode(je)),_.collapse(!1),q&&q.textContent.trim()!==""&&!ae?Me(e):Ge(e),t.preventDefault(),!0}if(t.key==="Backspace"&&!(0,u._0)(t)&&!t.altKey&&!t.shiftKey){if(ve&&((l=ve.previousElementSibling)===null||l===void 0?void 0:l.getAttribute("data-type"))==="newline"&&(0,P.ED)(ve,e.sv.element,_).start===1&&ve.getAttribute("data-type").indexOf("code-block-")===-1)return _.setStart(ve,0),_.extractContents(),ve.textContent.trim()!==""?Me(e):Ge(e),t.preventDefault(),!0;if(q&&(0,P.ED)(q,e.sv.element,_).start===0&&q.previousElementSibling){_.extractContents();var Re=q.previousElementSibling.lastElementChild;return Re.getAttribute("data-type")==="newline"&&(Re.remove(),Re=q.previousElementSibling.lastElementChild),Re.getAttribute("data-type")!=="newline"&&(Re.insertAdjacentHTML("afterend",q.innerHTML),q.remove()),q.textContent.trim()!==""&&!(!((S=q.previousElementSibling)===null||S===void 0)&&S.querySelector('[data-type="code-block-open-marker"]'))?Me(e):(Re.getAttribute("data-type")!=="newline"&&(_.selectNodeContents(Re.lastChild),_.collapse(!1)),Ge(e)),t.preventDefault(),!0}}return!1},ye=c(873),He=function(e){e.options.theme==="dark"?e.element.classList.add("vditor--dark"):e.element.classList.remove("vditor--dark")},ot=function(e){e.element.innerHTML="",e.element.classList.add("vditor"),e.options.rtl&&e.element.setAttribute("dir","rtl"),He(e),(0,ye.H)(e.options.preview.theme.current,e.options.preview.theme.path),typeof e.options.height=="number"?e.element.style.height=e.options.height+"px":e.element.style.height=e.options.height,typeof e.options.minHeight=="number"&&(e.element.style.minHeight=e.options.minHeight+"px"),typeof e.options.width=="number"?e.element.style.width=e.options.width+"px":e.element.style.width=e.options.width,e.element.appendChild(e.toolbar.element);var t=document.createElement("div");if(t.className="vditor-content",e.options.outline.position==="left"&&t.appendChild(e.outline.element),t.appendChild(e.wysiwyg.element.parentElement),t.appendChild(e.sv.element),t.appendChild(e.ir.element.parentElement),t.appendChild(e.preview.element),e.toolbar.elements.devtools&&t.appendChild(e.devtools.element),e.options.outline.position==="right"&&(e.outline.element.classList.add("vditor-outline--right"),t.appendChild(e.outline.element)),e.upload&&t.appendChild(e.upload.element),e.options.resize.enable&&t.appendChild(e.resize.element),t.appendChild(e.hint.element),t.appendChild(e.tip.element),e.element.appendChild(t),t.addEventListener("click",function(){x(e,["subToolbar"])}),e.toolbar.elements.export&&e.element.insertAdjacentHTML("beforeend",'<iframe id="vditorExportIframe" style="width: 100%;height: 0;border: 0"></iframe>'),Wt(e,e.options.mode,ln(e)),document.execCommand("DefaultParagraphSeparator",!1,"p"),navigator.userAgent.indexOf("iPhone")>-1&&typeof window.visualViewport<"u"){var i=!1,a=function(o){i||(i=!0,requestAnimationFrame(function(){i=!1;var l=e.toolbar.element;l.style.transform="none",l.getBoundingClientRect().top<0&&(l.style.transform="translate(0, ".concat(-l.getBoundingClientRect().top,"px)"))}))};window.visualViewport.addEventListener("scroll",a),window.visualViewport.addEventListener("resize",a)}},it=function(e){var t=window.innerWidth<=d.Y.MOBILE_WIDTH?10:35;if(e.wysiwyg.element.parentElement.style.display!=="none"){var i=(e.wysiwyg.element.parentElement.clientWidth-e.options.preview.maxWidth)/2;e.wysiwyg.element.style.padding="10px ".concat(Math.max(t,i),"px")}if(e.ir.element.parentElement.style.display!=="none"){var i=(e.ir.element.parentElement.clientWidth-e.options.preview.maxWidth)/2;e.ir.element.style.padding="10px ".concat(Math.max(t,i),"px")}e.preview.element.style.display!=="block"?e.toolbar.element.style.paddingLeft=Math.max(5,parseInt(e[e.currentMode].element.style.paddingLeft||"0",10)+(e.options.outline.position==="left"?e.outline.element.offsetWidth:0))+"px":e.toolbar.element.style.paddingLeft=5+(e.options.outline.position==="left"?e.outline.element.offsetWidth:0)+"px"},Ke=function(e){if(e.options.typewriterMode){var t=window.innerHeight;typeof e.options.height=="number"?(t=e.options.height,typeof e.options.minHeight=="number"&&(t=Math.max(t,e.options.minHeight)),t=Math.min(window.innerHeight,t)):t=e.element.clientHeight,e.element.classList.contains("vditor--fullscreen")&&(t=window.innerHeight),e[e.currentMode].element.style.setProperty("--editor-bottom",(t-e.toolbar.element.offsetHeight)/2+"px")}},Ue;function Ct(){window.removeEventListener("resize",Ue)}var ln=function(e){Ke(e),Ct(),window.addEventListener("resize",Ue=function(){it(e),Ke(e)});var t=(0,u.D)()&&localStorage.getItem(e.options.cache.id);return(!e.options.cache.enable||!t)&&(e.options.value?t=e.options.value:e.originalInnerHTML?t=e.lute.HTML2Md(e.originalInnerHTML):e.options.cache.enable||(t="")),t||""},st=function(e){clearTimeout(e[e.currentMode].hlToolbarTimeoutId),e[e.currentMode].hlToolbarTimeoutId=window.setTimeout(function(){if(e[e.currentMode].element.getAttribute("contenteditable")!=="false"&&(0,P.Co)(e[e.currentMode].element)){p(e.toolbar.elements,d.Y.EDIT_TOOLBARS),E(e.toolbar.elements,d.Y.EDIT_TOOLBARS);var t=(0,P.RN)(e),i=t.startContainer;t.startContainer.nodeType===3&&(i=t.startContainer.parentElement),i.classList.contains("vditor-reset")&&(i=i.childNodes[t.startOffset]);var a=e.currentMode==="sv"?(0,m.Th)(i,"data-type","heading"):(0,O.c)(i);a&&v(e.toolbar.elements,["headings"]);var o=e.currentMode==="sv"?(0,m.Th)(i,"data-type","blockquote"):(0,m._Y)(i,"BLOCKQUOTE");o&&v(e.toolbar.elements,["quote"]);var l=(0,m.Th)(i,"data-type","strong");l&&v(e.toolbar.elements,["bold"]);var S=(0,m.Th)(i,"data-type","em");S&&v(e.toolbar.elements,["italic"]);var _=(0,m.Th)(i,"data-type","s");_&&v(e.toolbar.elements,["strike"]);var D=(0,m.Th)(i,"data-type","a");D&&v(e.toolbar.elements,["link"]);var L=(0,m._Y)(i,"LI");L?(L.classList.contains("vditor-task")?v(e.toolbar.elements,["check"]):L.parentElement.tagName==="OL"?v(e.toolbar.elements,["ordered-list"]):L.parentElement.tagName==="UL"&&v(e.toolbar.elements,["list"]),E(e.toolbar.elements,["outdent","indent"])):b(e.toolbar.elements,["outdent","indent"]);var I=(0,m.Th)(i,"data-type","code-block");I&&(b(e.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","inline-code","upload","link","table","record"]),v(e.toolbar.elements,["code"]));var B=(0,m.Th)(i,"data-type","code");B&&(b(e.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","upload","link","table","record"]),v(e.toolbar.elements,["inline-code"]));var Z=(0,m.Th)(i,"data-type","table");Z&&b(e.toolbar.elements,["headings","list","ordered-list","check","line","quote","code","table"])}},200)},Be=function(e,t){t===void 0&&(t={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),t.enableHint&&e.hint.render(e),clearTimeout(e.wysiwyg.afterRenderTimeoutId),e.wysiwyg.afterRenderTimeoutId=window.setTimeout(function(){if(!e.wysiwyg.composingLock){var i=T(e);typeof e.options.input=="function"&&t.enableInput&&e.options.input(i),e.options.counter.enable&&e.counter.render(e,i),e.options.cache.enable&&(0,u.D)()&&(localStorage.setItem(e.options.cache.id,i),e.options.cache.after&&e.options.cache.after(i)),e.devtools&&e.devtools.renderEchart(e),t.enableAddUndoStack&&e.undo.addToUndoStack(e)}},e.options.undoDelay)},fo=function(e){for(var t=e.previousSibling;t;){if(t.nodeType!==3&&t.tagName==="A"&&!t.previousSibling&&t.innerHTML.replace(d.Y.ZWSP,"")===""&&t.nextSibling)return t;t=t.previousSibling}return!1},ho=function(e){for(var t=e.startContainer.nextSibling;t&&t.textContent==="";)t=t.nextSibling;return!!(t&&t.nodeType!==3&&(t.tagName==="CODE"||t.getAttribute("data-type")==="math-inline"||t.getAttribute("data-type")==="html-entity"||t.getAttribute("data-type")==="html-inline"))},fr=function(e){for(var t="",i=e.nextSibling;i;)i.nodeType===3?t+=i.textContent:t+=i.outerHTML,i=i.nextSibling;return t},hr=function(e){for(var t="",i=e.previousSibling;i;)i.nodeType===3?t=i.textContent+t:t=i.outerHTML+t,i=i.previousSibling;return t},po=function(e){for(var t=e;t&&!t.nextSibling;)t=t.parentElement;return t.nextSibling},mo=function(e){var t=hr(e.startContainer),i=fr(e.startContainer),a=e.startContainer.textContent,o=e.startOffset,l="",S="";return(a.substr(0,o)!==""&&a.substr(0,o)!==d.Y.ZWSP||t)&&(l="".concat(t).concat(a.substr(0,o))),(a.substr(o)!==""&&a.substr(o)!==d.Y.ZWSP||i)&&(S="".concat(a.substr(o)).concat(i)),{afterHTML:S,beforeHTML:l}},yi=function(e,t){Array.from(e.wysiwyg.element.childNodes).find(function(i){if(i.nodeType===3){var a=document.createElement("p");a.setAttribute("data-block","0"),a.textContent=i.textContent;var o=t.startContainer.nodeType===3?t.startOffset:i.textContent.length;return i.parentNode.insertBefore(a,i),i.remove(),t.setStart(a.firstChild,Math.min(a.firstChild.textContent.length,o)),t.collapse(!0),(0,P.jl)(t),!0}else if(!i.getAttribute("data-block"))return i.tagName==="P"?i.remove():(i.tagName==="DIV"?(t.insertNode(document.createElement("wbr")),i.outerHTML='<p data-block="0">'.concat(i.innerHTML,"</p>")):i.tagName==="BR"?i.outerHTML='<p data-block="0">'.concat(i.outerHTML,"<wbr></p>"):(t.insertNode(document.createElement("wbr")),i.outerHTML='<p data-block="0">'.concat(i.outerHTML,"</p>")),(0,P.ir)(e.wysiwyg.element,t),t=getSelection().getRangeAt(0)),!0})},zn=function(e,t){var i=(0,P.RN)(e),a=(0,m.pt)(i.startContainer);a||(a=i.startContainer.childNodes[i.startOffset]),!a&&e.wysiwyg.element.children.length===0&&(a=e.wysiwyg.element),a&&!a.classList.contains("vditor-wysiwyg__block")&&(i.insertNode(document.createElement("wbr")),a.innerHTML.trim()==="<wbr>"&&(a.innerHTML="<wbr><br>"),a.tagName==="BLOCKQUOTE"||a.classList.contains("vditor-reset")?a.innerHTML="<".concat(t,' data-block="0">').concat(a.innerHTML.trim(),"</").concat(t,">"):a.outerHTML="<".concat(t,' data-block="0">').concat(a.innerHTML.trim(),"</").concat(t,">"),(0,P.ir)(e.wysiwyg.element,i),j(e))},bi=function(e){var t=getSelection().getRangeAt(0),i=(0,m.pt)(t.startContainer);i||(i=t.startContainer.childNodes[t.startOffset]),i&&(t.insertNode(document.createElement("wbr")),i.outerHTML='<p data-block="0">'.concat(i.innerHTML,"</p>"),(0,P.ir)(e.wysiwyg.element,t)),e.wysiwyg.popover.style.display="none"},xn=function(e,t,i){i===void 0&&(i=!0);var a=e.previousElementSibling,o=a.ownerDocument.createRange();a.tagName==="CODE"?(a.style.display="inline-block",i?o.setStart(a.firstChild,1):o.selectNodeContents(a)):(a.style.display="block",a.firstChild.firstChild||a.firstChild.appendChild(document.createTextNode("")),o.selectNodeContents(a.firstChild)),i?o.collapse(!0):o.collapse(!1),(0,P.jl)(o),!e.firstElementChild.classList.contains("language-mindmap")&&qe(t)},go=function(e,t){if(e.wysiwyg.composingLock=t.isComposing,t.isComposing)return!1;t.key.indexOf("Arrow")===-1&&t.key!=="Meta"&&t.key!=="Control"&&t.key!=="Alt"&&t.key!=="Shift"&&t.key!=="CapsLock"&&t.key!=="Escape"&&!/^F\d{1,2}$/.test(t.key)&&e.undo.recordFirstPosition(e,t);var i=(0,P.RN)(e),a=i.startContainer;if(!Er(t,e,a)||(Sr(i,e,t),Nr(i),t.key!=="Enter"&&t.key!=="Tab"&&t.key!=="Backspace"&&t.key.indexOf("Arrow")===-1&&!(0,u._0)(t)&&t.key!=="Escape"&&t.key!=="Delete"))return!1;var o=(0,m.pt)(a),l=(0,m._Y)(a,"P");if(xr(t,e,l,i)||Mr(i,e,l,t)||Or(e,t,i))return!0;var S=(0,m.KJ)(a,"vditor-wysiwyg__block");if(S){if(t.key==="Escape"&&S.children.length===2)return e.wysiwyg.popover.style.display="none",S.firstElementChild.style.display="none",e.wysiwyg.element.blur(),t.preventDefault(),!0;if(!(0,u._0)(t)&&!t.shiftKey&&t.altKey&&t.key==="Enter"&&S.getAttribute("data-type")==="code-block"){var _=e.wysiwyg.popover.querySelector(".vditor-input");return _.focus(),_.select(),t.preventDefault(),!0}if(S.getAttribute("data-block")==="0"&&(Pr(e,t,S.firstElementChild,i)||Dn(e,t,i,S.firstElementChild,S)||S.getAttribute("data-type")!=="yaml-front-matter"&&fn(e,t,i,S.firstElementChild,S)))return!0}if(Rr(e,i,t,l))return!0;var D=(0,m.Ab)(a,"BLOCKQUOTE");if(D&&!t.shiftKey&&t.altKey&&t.key==="Enter"){(0,u._0)(t)?i.setStartBefore(D):i.setStartAfter(D),(0,P.jl)(i);var L=document.createElement("p");return L.setAttribute("data-block","0"),L.innerHTML=`
`,i.insertNode(L),i.collapse(!0),(0,P.jl)(i),Be(e),qe(e),t.preventDefault(),!0}var I=(0,O.c)(a);if(I){if(I.tagName==="H6"&&a.textContent.length===i.startOffset&&!(0,u._0)(t)&&!t.shiftKey&&!t.altKey&&t.key==="Enter"){var B=document.createElement("p");return B.textContent=`
`,B.setAttribute("data-block","0"),a.parentElement.insertAdjacentElement("afterend",B),i.setStart(B,0),(0,P.jl)(i),Be(e),qe(e),t.preventDefault(),!0}if($("⌘=",t)){var Z=parseInt(I.tagName.substr(1),10)-1;return Z>0&&(zn(e,"h".concat(Z)),Be(e)),t.preventDefault(),!0}if($("⌘-",t)){var Z=parseInt(I.tagName.substr(1),10)+1;return Z<7&&(zn(e,"h".concat(Z)),Be(e)),t.preventDefault(),!0}t.key==="Backspace"&&!(0,u._0)(t)&&!t.shiftKey&&!t.altKey&&I.textContent.length===1&&bi(e)}if(Hr(e,i,t))return!0;if(t.altKey&&t.key==="Enter"&&!(0,u._0)(t)&&!t.shiftKey){var G=(0,m._Y)(a,"A"),W=(0,m.Th)(a,"data-type","link-ref"),se=(0,m.Th)(a,"data-type","footnotes-ref");if(G||W||se||I&&I.tagName.length===2){var Q=e.wysiwyg.popover.querySelector("input");Q.focus(),Q.select()}}if(ct(e,t))return!0;if($("⇧⌘U",t)){var q=e.wysiwyg.popover.querySelector('[data-type="up"]');if(q)return q.click(),t.preventDefault(),!0}if($("⇧⌘D",t)){var q=e.wysiwyg.popover.querySelector('[data-type="down"]');if(q)return q.click(),t.preventDefault(),!0}if(Pi(e,i,t))return!0;if(!(0,u._0)(t)&&t.shiftKey&&!t.altKey&&t.key==="Enter"&&a.parentElement.tagName!=="LI"&&a.parentElement.tagName!=="P")return["STRONG","STRIKE","S","I","EM","B"].includes(a.parentElement.tagName)?i.insertNode(document.createTextNode(`
`+d.Y.ZWSP)):i.insertNode(document.createTextNode(`
`)),i.collapse(!1),(0,P.jl)(i),Be(e),qe(e),t.preventDefault(),!0;if(t.key==="Backspace"&&!(0,u._0)(t)&&!t.shiftKey&&!t.altKey&&i.toString()===""){if(Ir(e,i,t,l))return!0;if(o){if(o.previousElementSibling&&o.previousElementSibling.classList.contains("vditor-wysiwyg__block")&&o.previousElementSibling.getAttribute("data-block")==="0"&&o.tagName!=="UL"&&o.tagName!=="OL"){var ve=(0,P.ED)(o,e.wysiwyg.element,i).start;if(ve===0&&i.startOffset===0||ve===1&&o.innerText.startsWith(d.Y.ZWSP))return xn(o.previousElementSibling.lastElementChild,e,!1),o.innerHTML.trim().replace(d.Y.ZWSP,"")===""&&(o.remove(),Be(e)),t.preventDefault(),!0}var ae=i.startOffset;if(i.toString()===""&&a.nodeType===3&&a.textContent.charAt(ae-2)===`
`&&a.textContent.charAt(ae-1)!==d.Y.ZWSP&&["STRONG","STRIKE","S","I","EM","B"].includes(a.parentElement.tagName))return a.textContent=a.textContent.substring(0,ae-1)+d.Y.ZWSP,i.setStart(a,ae),i.collapse(!0),Be(e),t.preventDefault(),!0;a.textContent===d.Y.ZWSP&&i.startOffset===1&&!a.previousSibling&&ho(i)&&(a.textContent=""),o.querySelectorAll("span.vditor-wysiwyg__block[data-type='math-inline']").forEach(function(je){je.firstElementChild.style.display="inline",je.lastElementChild.style.display="none"}),o.querySelectorAll("span.vditor-wysiwyg__block[data-type='html-entity']").forEach(function(je){je.firstElementChild.style.display="inline",je.lastElementChild.style.display="none"})}}if((0,u.gm)()&&i.startOffset===1&&a.textContent.indexOf(d.Y.ZWSP)>-1&&a.previousSibling&&a.previousSibling.nodeType!==3&&a.previousSibling.tagName==="CODE"&&(t.key==="Backspace"||t.key==="ArrowLeft"))return i.selectNodeContents(a.previousSibling),i.collapse(!1),t.preventDefault(),!0;if(jr(t,o,i))return t.preventDefault(),!0;if(Cr(i,t.key),t.key==="ArrowDown"){var be=a.nextSibling;be&&be.nodeType!==3&&be.getAttribute("data-type")==="math-inline"&&i.setStartAfter(be)}return o&&X(o,e,t,i)?(t.preventDefault(),!0):!1},ct=function(e,t){if($("⇧⌘X",t)){var i=e.wysiwyg.popover.querySelector('[data-type="remove"]');return i&&i.click(),t.preventDefault(),!0}},qt=function(e){clearTimeout(e.wysiwyg.hlToolbarTimeoutId),e.wysiwyg.hlToolbarTimeoutId=window.setTimeout(function(){if(e.wysiwyg.element.getAttribute("contenteditable")!=="false"&&(0,P.Co)(e.wysiwyg.element)){p(e.toolbar.elements,d.Y.EDIT_TOOLBARS),E(e.toolbar.elements,d.Y.EDIT_TOOLBARS);var t=getSelection().getRangeAt(0),i=t.startContainer;t.startContainer.nodeType===3?i=t.startContainer.parentElement:i=i.childNodes[t.startOffset>=i.childNodes.length?i.childNodes.length-1:t.startOffset];var a=(0,m.Th)(i,"data-type","footnotes-block");if(a){e.wysiwyg.popover.innerHTML="",vt(a,e),gt(e,a);return}var o=(0,m._Y)(i,"LI");o?(o.classList.contains("vditor-task")?v(e.toolbar.elements,["check"]):o.parentElement.tagName==="OL"?v(e.toolbar.elements,["ordered-list"]):o.parentElement.tagName==="UL"&&v(e.toolbar.elements,["list"]),E(e.toolbar.elements,["outdent","indent"])):b(e.toolbar.elements,["outdent","indent"]),(0,m._Y)(i,"BLOCKQUOTE")&&v(e.toolbar.elements,["quote"]),((0,m._Y)(i,"B")||(0,m._Y)(i,"STRONG"))&&v(e.toolbar.elements,["bold"]),((0,m._Y)(i,"I")||(0,m._Y)(i,"EM"))&&v(e.toolbar.elements,["italic"]),((0,m._Y)(i,"STRIKE")||(0,m._Y)(i,"S"))&&v(e.toolbar.elements,["strike"]),e.wysiwyg.element.querySelectorAll(".vditor-comment--focus").forEach(function(oe){oe.classList.remove("vditor-comment--focus")});var l=(0,m.KJ)(i,"vditor-comment");if(l){var S=l.getAttribute("data-cmtids").split(" ");if(S.length>1&&l.nextSibling.isSameNode(l.nextElementSibling)){var _=l.nextElementSibling.getAttribute("data-cmtids").split(" ");S.find(function(oe){if(_.includes(oe))return S=[oe],!0})}e.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(oe){oe.getAttribute("data-cmtids").indexOf(S[0])>-1&&oe.classList.add("vditor-comment--focus")})}var D=(0,m._Y)(i,"A");D&&v(e.toolbar.elements,["link"]);var L=(0,m._Y)(i,"TABLE"),I=(0,O.c)(i);(0,m._Y)(i,"CODE")?(0,m._Y)(i,"PRE")?(b(e.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","inline-code","upload","link","table","record"]),v(e.toolbar.elements,["code"])):(b(e.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","upload","link","table","record"]),v(e.toolbar.elements,["inline-code"])):I?(b(e.toolbar.elements,["bold"]),v(e.toolbar.elements,["headings"])):L&&b(e.toolbar.elements,["table"]);var B=(0,m.KJ)(i,"vditor-toc");if(B){e.wysiwyg.popover.innerHTML="",vt(B,e),gt(e,B);return}var Z=(0,O.f)(i,"BLOCKQUOTE");if(Z&&(e.wysiwyg.popover.innerHTML="",cn(t,Z,e),un(t,Z,e),vt(Z,e),gt(e,Z)),o&&(e.wysiwyg.popover.innerHTML="",cn(t,o,e),un(t,o,e),vt(o,e),gt(e,o)),L){e.options.lang,e.options,e.wysiwyg.popover.innerHTML="";var G=function(){var oe=L.rows.length,ke=L.rows[0].cells.length,Ft=parseInt(We.value,10)||oe,Ut=parseInt(pt.value,10)||ke;if(!(Ft===oe&&ke===Ut)){if(ke!==Ut)for(var Rn=Ut-ke,_t=0;_t<L.rows.length;_t++)if(Rn>0)for(var Kr=0;Kr<Rn;Kr++)_t===0?L.rows[_t].lastElementChild.insertAdjacentHTML("afterend","<th> </th>"):L.rows[_t].lastElementChild.insertAdjacentHTML("afterend","<td> </td>");else for(var Ii=ke-1;Ii>=Ut;Ii--)L.rows[_t].cells[Ii].remove();if(oe!==Ft){var Gr=Ft-oe;if(Gr>0){for(var Ni="<tr>",mn=0;mn<Ut;mn++)Ni+="<td> </td>";for(var Zr=0;Zr<Gr;Zr++)L.querySelector("tbody")?L.querySelector("tbody").insertAdjacentHTML("beforeend",Ni):L.querySelector("thead").insertAdjacentHTML("afterend",Ni+"</tr>")}else for(var mn=oe-1;mn>=Ft;mn--)L.rows[mn].remove(),L.rows.length===1&&L.querySelector("tbody").remove()}typeof e.options.input=="function"&&e.options.input(T(e))}},W=function(oe){Vn(L,oe),oe==="right"?(ve.classList.remove("vditor-icon--current"),ae.classList.remove("vditor-icon--current"),be.classList.add("vditor-icon--current")):oe==="center"?(ve.classList.remove("vditor-icon--current"),be.classList.remove("vditor-icon--current"),ae.classList.add("vditor-icon--current")):(ae.classList.remove("vditor-icon--current"),be.classList.remove("vditor-icon--current"),ve.classList.add("vditor-icon--current")),(0,P.jl)(t),Be(e)},se=(0,m._Y)(i,"TD"),Q=(0,m._Y)(i,"TH"),q="left";se?q=se.getAttribute("align")||"left":Q&&(q=Q.getAttribute("align")||"center");var ve=document.createElement("button");ve.setAttribute("type","button"),ve.setAttribute("aria-label",window.VditorI18n.alignLeft+"<"+(0,u.fG)("⇧⌘L")+">"),ve.setAttribute("data-type","left"),ve.innerHTML='<svg><use xlink:href="#vditor-icon-align-left"></use></svg>',ve.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+(q==="left"?" vditor-icon--current":""),ve.onclick=function(){W("left")};var ae=document.createElement("button");ae.setAttribute("type","button"),ae.setAttribute("aria-label",window.VditorI18n.alignCenter+"<"+(0,u.fG)("⇧⌘C")+">"),ae.setAttribute("data-type","center"),ae.innerHTML='<svg><use xlink:href="#vditor-icon-align-center"></use></svg>',ae.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+(q==="center"?" vditor-icon--current":""),ae.onclick=function(){W("center")};var be=document.createElement("button");be.setAttribute("type","button"),be.setAttribute("aria-label",window.VditorI18n.alignRight+"<"+(0,u.fG)("⇧⌘R")+">"),be.setAttribute("data-type","right"),be.innerHTML='<svg><use xlink:href="#vditor-icon-align-right"></use></svg>',be.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+(q==="right"?" vditor-icon--current":""),be.onclick=function(){W("right")};var je=document.createElement("button");je.setAttribute("type","button"),je.setAttribute("aria-label",window.VditorI18n.insertRowBelow+"<"+(0,u.fG)("⌘=")+">"),je.setAttribute("data-type","insertRow"),je.innerHTML='<svg><use xlink:href="#vditor-icon-insert-row"></use></svg>',je.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",je.onclick=function(){var oe=getSelection().getRangeAt(0).startContainer,ke=(0,m._Y)(oe,"TD")||(0,m._Y)(oe,"TH");ke&&_r(e,t,ke)};var Re=document.createElement("button");Re.setAttribute("type","button"),Re.setAttribute("aria-label",window.VditorI18n.insertRowAbove+"<"+(0,u.fG)("⇧⌘F")+">"),Re.setAttribute("data-type","insertRow"),Re.innerHTML='<svg><use xlink:href="#vditor-icon-insert-rowb"></use></svg>',Re.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",Re.onclick=function(){var oe=getSelection().getRangeAt(0).startContainer,ke=(0,m._Y)(oe,"TD")||(0,m._Y)(oe,"TH");ke&&Lr(e,t,ke)};var ze=document.createElement("button");ze.setAttribute("type","button"),ze.setAttribute("aria-label",window.VditorI18n.insertColumnRight+"<"+(0,u.fG)("⇧⌘=")+">"),ze.setAttribute("data-type","insertColumn"),ze.innerHTML='<svg><use xlink:href="#vditor-icon-insert-column"></use></svg>',ze.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",ze.onclick=function(){var oe=getSelection().getRangeAt(0).startContainer,ke=(0,m._Y)(oe,"TD")||(0,m._Y)(oe,"TH");ke&&qn(e,L,ke)};var ut=document.createElement("button");ut.setAttribute("type","button"),ut.setAttribute("aria-label",window.VditorI18n.insertColumnLeft+"<"+(0,u.fG)("⇧⌘G")+">"),ut.setAttribute("data-type","insertColumn"),ut.innerHTML='<svg><use xlink:href="#vditor-icon-insert-columnb"></use></svg>',ut.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",ut.onclick=function(){var oe=getSelection().getRangeAt(0).startContainer,ke=(0,m._Y)(oe,"TD")||(0,m._Y)(oe,"TH");ke&&qn(e,L,ke,"beforebegin")};var tt=document.createElement("button");tt.setAttribute("type","button"),tt.setAttribute("aria-label",window.VditorI18n["delete-row"]+"<"+(0,u.fG)("⌘-")+">"),tt.setAttribute("data-type","deleteRow"),tt.innerHTML='<svg><use xlink:href="#vditor-icon-delete-row"></use></svg>',tt.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",tt.onclick=function(){var oe=getSelection().getRangeAt(0).startContainer,ke=(0,m._Y)(oe,"TD")||(0,m._Y)(oe,"TH");ke&&Ar(e,t,ke)};var dt=document.createElement("button");dt.setAttribute("type","button"),dt.setAttribute("aria-label",window.VditorI18n["delete-column"]+"<"+(0,u.fG)("⇧⌘-")+">"),dt.setAttribute("data-type","deleteColumn"),dt.innerHTML='<svg><use xlink:href="#vditor-icon-delete-column"></use></svg>',dt.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",dt.onclick=function(){var oe=getSelection().getRangeAt(0).startContainer,ke=(0,m._Y)(oe,"TD")||(0,m._Y)(oe,"TH");ke&&Dr(e,t,L,ke)};var Ee=document.createElement("span");Ee.setAttribute("aria-label",window.VditorI18n.row),Ee.className="vditor-tooltipped vditor-tooltipped__n";var We=document.createElement("input");Ee.appendChild(We),We.type="number",We.min="1",We.className="vditor-input",We.style.width="42px",We.style.textAlign="center",We.setAttribute("placeholder",window.VditorI18n.row),We.value=L.rows.length.toString(),We.oninput=function(){G()},We.onkeydown=function(oe){if(!oe.isComposing){if(oe.key==="Tab"){pt.focus(),pt.select(),oe.preventDefault();return}ct(e,oe)||xt(oe,t)}};var Kn=document.createElement("span");Kn.setAttribute("aria-label",window.VditorI18n.column),Kn.className="vditor-tooltipped vditor-tooltipped__n";var pt=document.createElement("input");Kn.appendChild(pt),pt.type="number",pt.min="1",pt.className="vditor-input",pt.style.width="42px",pt.style.textAlign="center",pt.setAttribute("placeholder",window.VditorI18n.column),pt.value=L.rows[0].cells.length.toString(),pt.oninput=function(){G()},pt.onkeydown=function(oe){if(!oe.isComposing){if(oe.key==="Tab"){We.focus(),We.select(),oe.preventDefault();return}ct(e,oe)||xt(oe,t)}},cn(t,L,e),un(t,L,e),vt(L,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",ve),e.wysiwyg.popover.insertAdjacentElement("beforeend",ae),e.wysiwyg.popover.insertAdjacentElement("beforeend",be),e.wysiwyg.popover.insertAdjacentElement("beforeend",Re),e.wysiwyg.popover.insertAdjacentElement("beforeend",je),e.wysiwyg.popover.insertAdjacentElement("beforeend",ut),e.wysiwyg.popover.insertAdjacentElement("beforeend",ze),e.wysiwyg.popover.insertAdjacentElement("beforeend",tt),e.wysiwyg.popover.insertAdjacentElement("beforeend",dt),e.wysiwyg.popover.insertAdjacentElement("beforeend",Ee),e.wysiwyg.popover.insertAdjacentHTML("beforeend"," x "),e.wysiwyg.popover.insertAdjacentElement("beforeend",Kn),gt(e,L)}var Hi=(0,m.Th)(i,"data-type","link-ref");Hi&&pr(e,Hi,t);var hn=(0,m.Th)(i,"data-type","footnotes-ref");if(hn){e.options.lang,e.options,e.wysiwyg.popover.innerHTML="";var Ee=document.createElement("span");Ee.setAttribute("aria-label",window.VditorI18n.footnoteRef+"<"+(0,u.fG)("⌥Enter")+">"),Ee.className="vditor-tooltipped vditor-tooltipped__n";var Ht=document.createElement("input");Ee.appendChild(Ht),Ht.className="vditor-input",Ht.setAttribute("placeholder",window.VditorI18n.footnoteRef+"<"+(0,u.fG)("⌥Enter")+">"),Ht.style.width="120px",Ht.value=hn.getAttribute("data-footnotes-label"),Ht.oninput=function(){Ht.value.trim()!==""&&hn.setAttribute("data-footnotes-label",Ht.value),typeof e.options.input=="function"&&e.options.input(T(e))},Ht.onkeydown=function(ke){ke.isComposing||ct(e,ke)||xt(ke,t)},vt(hn,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",Ee),gt(e,hn)}var Je=(0,m.KJ)(i,"vditor-wysiwyg__block"),Wr=Je?Je.getAttribute("data-type").indexOf("block")>-1:!1;if(e.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview").forEach(function(oe){if(!Je||Je&&Wr&&!Je.contains(oe)){var ke=oe.previousElementSibling;ke.style.display="none"}}),Je&&Wr){if(e.wysiwyg.popover.innerHTML="",cn(t,Je,e),un(t,Je,e),vt(Je,e),Je.getAttribute("data-type")==="code-block"){var Gn=document.createElement("span");Gn.setAttribute("aria-label",window.VditorI18n.language+"<"+(0,u.fG)("⌥Enter")+">"),Gn.className="vditor-tooltipped vditor-tooltipped__n";var Tt=document.createElement("input");Gn.appendChild(Tt);var Pn=Je.firstElementChild.firstElementChild;Tt.className="vditor-input",Tt.setAttribute("placeholder",window.VditorI18n.language+"<"+(0,u.fG)("⌥Enter")+">"),Tt.value=Pn.className.indexOf("language-")>-1?Pn.className.split("-")[1].split(" ")[0]:"",Tt.oninput=function(oe){Tt.value.trim()!==""?Pn.className="language-".concat(Tt.value):(Pn.className="",e.hint.recentLanguage=""),Je.lastElementChild.classList.contains("vditor-wysiwyg__preview")&&(Je.lastElementChild.innerHTML=Je.firstElementChild.innerHTML,Pe(Je.lastElementChild,e)),Be(e),oe.detail===1&&(t.setStart(Pn.firstChild,0),t.collapse(!0),(0,P.jl)(t))},Tt.onkeydown=function(oe){if(!oe.isComposing&&!ct(e,oe)){if(oe.key==="Escape"&&e.hint.element.style.display==="block"){e.hint.element.style.display="none",oe.preventDefault();return}e.hint.select(oe,e),xt(oe,t)}},Tt.onkeyup=function(oe){var ke,Ft;if(!(oe.isComposing||oe.key==="Enter"||oe.key==="ArrowUp"||oe.key==="Escape"||oe.key==="ArrowDown")){var Ut=[],Rn=Tt.value.substring(0,Tt.selectionStart);(e.options.preview.hljs.langs||d.Y.ALIAS_CODE_LANGUAGES.concat(((Ft=(ke=window.hljs)===null||ke===void 0?void 0:ke.listLanguages())!==null&&Ft!==void 0?Ft:[]).sort())).forEach(function(_t){_t.indexOf(Rn.toLowerCase())>-1&&Ut.push({html:_t,value:_t})}),e.hint.genHTML(Ut,Rn,e),oe.preventDefault()}},e.wysiwyg.popover.insertAdjacentElement("beforeend",Gn)}gt(e,Je)}else Je=void 0;if(I){e.wysiwyg.popover.innerHTML="";var Ee=document.createElement("span");Ee.setAttribute("aria-label","ID<"+(0,u.fG)("⌥Enter")+">"),Ee.className="vditor-tooltipped vditor-tooltipped__n";var zt=document.createElement("input");Ee.appendChild(zt),zt.className="vditor-input",zt.setAttribute("placeholder","ID<"+(0,u.fG)("⌥Enter")+">"),zt.style.width="120px",zt.value=I.getAttribute("data-id")||"",zt.oninput=function(){I.setAttribute("data-id",zt.value),typeof e.options.input=="function"&&e.options.input(T(e))},zt.onkeydown=function(ke){ke.isComposing||ct(e,ke)||xt(ke,t)},cn(t,I,e),un(t,I,e),vt(I,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",Ee),gt(e,I)}if(D&&wi(e,D,t),!Z&&!o&&!L&&!Je&&!D&&!Hi&&!hn&&!I&&!B){var pn=(0,m.Th)(i,"data-block","0");pn&&pn.parentElement.isEqualNode(e.wysiwyg.element)?(e.wysiwyg.popover.innerHTML="",cn(t,pn,e),un(t,pn,e),vt(pn,e),gt(e,pn)):e.wysiwyg.popover.style.display="none"}e.wysiwyg.element.querySelectorAll('span[data-type="backslash"] > span').forEach(function(oe){oe.style.display="none"});var Yr=(0,m.Th)(t.startContainer,"data-type","backslash");Yr&&(Yr.querySelector("span").style.display="inline")}},200)},gt=function(e,t){var i=t,a=(0,m._Y)(t,"TABLE");a&&(i=a),e.wysiwyg.popover.style.left="0",e.wysiwyg.popover.style.display="block",e.wysiwyg.popover.style.top=Math.max(-8,i.offsetTop-21-e.wysiwyg.element.scrollTop)+"px",e.wysiwyg.popover.style.left=Math.min(i.offsetLeft,e.wysiwyg.element.clientWidth-e.wysiwyg.popover.clientWidth)+"px",e.wysiwyg.popover.setAttribute("data-top",(i.offsetTop-21).toString())},pr=function(e,t,i){i===void 0&&(i=getSelection().getRangeAt(0)),e.wysiwyg.popover.innerHTML="";var a=function(){l.value.trim()!==""&&(t.tagName==="IMG"?t.setAttribute("alt",l.value):t.textContent=l.value),_.value.trim()!==""&&t.setAttribute("data-link-label",_.value),typeof e.options.input=="function"&&e.options.input(T(e))},o=document.createElement("span");o.setAttribute("aria-label",window.VditorI18n.textIsNotEmpty),o.className="vditor-tooltipped vditor-tooltipped__n";var l=document.createElement("input");o.appendChild(l),l.className="vditor-input",l.setAttribute("placeholder",window.VditorI18n.textIsNotEmpty),l.style.width="120px",l.value=t.getAttribute("alt")||t.textContent,l.oninput=function(){a()},l.onkeydown=function(D){ct(e,D)||xt(D,i)||_n(e,t,D,_)};var S=document.createElement("span");S.setAttribute("aria-label",window.VditorI18n.linkRef),S.className="vditor-tooltipped vditor-tooltipped__n";var _=document.createElement("input");S.appendChild(_),_.className="vditor-input",_.setAttribute("placeholder",window.VditorI18n.linkRef),_.value=t.getAttribute("data-link-label"),_.oninput=function(){a()},_.onkeydown=function(D){ct(e,D)||xt(D,i)||_n(e,t,D,l)},vt(t,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",o),e.wysiwyg.popover.insertAdjacentElement("beforeend",S),gt(e,t)},cn=function(e,t,i){var a=t.previousElementSibling;if(!(!a||!t.parentElement.isEqualNode(i.wysiwyg.element)&&t.tagName!=="LI")){var o=document.createElement("button");o.setAttribute("type","button"),o.setAttribute("data-type","up"),o.setAttribute("aria-label",window.VditorI18n.up+"<"+(0,u.fG)("⇧⌘U")+">"),o.innerHTML='<svg><use xlink:href="#vditor-icon-up"></use></svg>',o.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",o.onclick=function(){e.insertNode(document.createElement("wbr")),a.insertAdjacentElement("beforebegin",t),(0,P.ir)(i.wysiwyg.element,e),Be(i),qt(i),qe(i)},i.wysiwyg.popover.insertAdjacentElement("beforeend",o)}},un=function(e,t,i){var a=t.nextElementSibling;if(!(!a||!t.parentElement.isEqualNode(i.wysiwyg.element)&&t.tagName!=="LI")){var o=document.createElement("button");o.setAttribute("type","button"),o.setAttribute("data-type","down"),o.setAttribute("aria-label",window.VditorI18n.down+"<"+(0,u.fG)("⇧⌘D")+">"),o.innerHTML='<svg><use xlink:href="#vditor-icon-down"></use></svg>',o.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",o.onclick=function(){e.insertNode(document.createElement("wbr")),a.insertAdjacentElement("afterend",t),(0,P.ir)(i.wysiwyg.element,e),Be(i),qt(i),qe(i)},i.wysiwyg.popover.insertAdjacentElement("beforeend",o)}},vt=function(e,t){var i=document.createElement("button");i.setAttribute("type","button"),i.setAttribute("data-type","remove"),i.setAttribute("aria-label",window.VditorI18n.remove+"<"+(0,u.fG)("⇧⌘X")+">"),i.innerHTML='<svg><use xlink:href="#vditor-icon-trashcan"></use></svg>',i.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",i.onclick=function(){var a=(0,P.RN)(t);a.setStartAfter(e),(0,P.jl)(a),e.remove(),Be(t),qt(t),["H1","H2","H3","H4","H5","H6"].includes(e.tagName)&&j(t)},t.wysiwyg.popover.insertAdjacentElement("beforeend",i)},_n=function(e,t,i,a){if(!i.isComposing){if(i.key==="Tab"){a.focus(),a.select(),i.preventDefault();return}if(!(0,u._0)(i)&&!i.shiftKey&&i.altKey&&i.key==="Enter"){var o=(0,P.RN)(e);t.insertAdjacentHTML("afterend",d.Y.ZWSP),o.setStartAfter(t.nextSibling),o.collapse(!0),(0,P.jl)(o),i.preventDefault()}}},wi=function(e,t,i){e.wysiwyg.popover.innerHTML="";var a=function(){l.value.trim()!==""&&(t.innerHTML=l.value),t.setAttribute("href",_.value),t.setAttribute("title",L.value),Be(e)};t.querySelectorAll("[data-marker]").forEach(function(I){I.removeAttribute("data-marker")});var o=document.createElement("span");o.setAttribute("aria-label",window.VditorI18n.textIsNotEmpty),o.className="vditor-tooltipped vditor-tooltipped__n";var l=document.createElement("input");o.appendChild(l),l.className="vditor-input",l.setAttribute("placeholder",window.VditorI18n.textIsNotEmpty),l.style.width="120px",l.value=t.innerHTML||"",l.oninput=function(){a()},l.onkeydown=function(I){ct(e,I)||xt(I,i)||_n(e,t,I,_)};var S=document.createElement("span");S.setAttribute("aria-label",window.VditorI18n.link),S.className="vditor-tooltipped vditor-tooltipped__n";var _=document.createElement("input");S.appendChild(_),_.className="vditor-input",_.setAttribute("placeholder",window.VditorI18n.link),_.value=t.getAttribute("href")||"",_.oninput=function(){a()},_.onkeydown=function(I){ct(e,I)||xt(I,i)||_n(e,t,I,L)};var D=document.createElement("span");D.setAttribute("aria-label",window.VditorI18n.tooltipText),D.className="vditor-tooltipped vditor-tooltipped__n";var L=document.createElement("input");D.appendChild(L),L.className="vditor-input",L.setAttribute("placeholder",window.VditorI18n.tooltipText),L.style.width="60px",L.value=t.getAttribute("title")||"",L.oninput=function(){a()},L.onkeydown=function(I){ct(e,I)||xt(I,i)||_n(e,t,I,l)},vt(t,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",o),e.wysiwyg.popover.insertAdjacentElement("beforeend",S),e.wysiwyg.popover.insertAdjacentElement("beforeend",D),gt(e,t)},vo=function(e,t){var i=e.target;t.wysiwyg.popover.innerHTML="";var a=function(){i.setAttribute("src",l.value),i.setAttribute("alt",_.value),i.setAttribute("title",L.value),typeof t.options.input=="function"&&t.options.input(T(t))},o=document.createElement("span");o.setAttribute("aria-label",window.VditorI18n.imageURL),o.className="vditor-tooltipped vditor-tooltipped__n";var l=document.createElement("input");o.appendChild(l),l.className="vditor-input",l.setAttribute("placeholder",window.VditorI18n.imageURL),l.value=i.getAttribute("src")||"",l.oninput=function(){a()},l.onkeydown=function(I){ct(t,I)};var S=document.createElement("span");S.setAttribute("aria-label",window.VditorI18n.alternateText),S.className="vditor-tooltipped vditor-tooltipped__n";var _=document.createElement("input");S.appendChild(_),_.className="vditor-input",_.setAttribute("placeholder",window.VditorI18n.alternateText),_.style.width="52px",_.value=i.getAttribute("alt")||"",_.oninput=function(){a()},_.onkeydown=function(I){ct(t,I)};var D=document.createElement("span");D.setAttribute("aria-label",window.VditorI18n.title),D.className="vditor-tooltipped vditor-tooltipped__n";var L=document.createElement("input");D.appendChild(L),L.className="vditor-input",L.setAttribute("placeholder",window.VditorI18n.title),L.value=i.getAttribute("title")||"",L.oninput=function(){a()},L.onkeydown=function(I){ct(t,I)},vt(i,t),t.wysiwyg.popover.insertAdjacentElement("beforeend",o),t.wysiwyg.popover.insertAdjacentElement("beforeend",S),t.wysiwyg.popover.insertAdjacentElement("beforeend",D),gt(t,i)},xt=function(e,t){if(!(0,u._0)(e)&&!e.shiftKey&&e.key==="Enter"||e.key==="Escape")return t&&(0,P.jl)(t),e.preventDefault(),e.stopPropagation(),!0},dn=function(e){e.currentMode==="wysiwyg"?qt(e):e.currentMode==="ir"&&st(e)},mr=function(e,t,i){i===void 0&&(i={enableAddUndoStack:!0,enableHint:!1,enableInput:!0});var a=e.wysiwyg.element;a.innerHTML=e.lute.Md2VditorDOM(t),a.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach(function(o){Pe(o,e),o.previousElementSibling.setAttribute("style","display:none")}),Be(e,i)},yo=function(e,t,i){for(var a=e.startContainer.parentElement,o=!1,l="",S="",_=mo(e),D=_.beforeHTML,L=_.afterHTML;a&&!o;){var I=a.tagName;if(I==="STRIKE"&&(I="S"),I==="I"&&(I="EM"),I==="B"&&(I="STRONG"),I==="S"||I==="STRONG"||I==="EM"){var B="",Z="",G="";a.parentElement.getAttribute("data-block")!=="0"&&(Z=hr(a),G=fr(a)),(D||Z)&&(B="".concat(Z,"<").concat(I,">").concat(D,"</").concat(I,">"),D=B),(i==="bold"&&I==="STRONG"||i==="italic"&&I==="EM"||i==="strikeThrough"&&I==="S")&&(B+="".concat(l).concat(d.Y.ZWSP,"<wbr>").concat(S),o=!0),(L||G)&&(L="<".concat(I,">").concat(L,"</").concat(I,">").concat(G),B+=L),a.parentElement.getAttribute("data-block")!=="0"?(a=a.parentElement,a.innerHTML=B):(a.outerHTML=B,a=a.parentElement),l="<".concat(I,">")+l,S="</".concat(I,">")+S}else o=!0}(0,P.ir)(t.wysiwyg.element,e)},bo=function(e,t,i){if(!(e.wysiwyg.composingLock&&i instanceof CustomEvent)){var a=!0,o=!0;e.wysiwyg.element.querySelector("wbr")&&e.wysiwyg.element.querySelector("wbr").remove();var l=(0,P.RN)(e),S=t.getAttribute("data-type");if(t.classList.contains("vditor-menu--current"))if(S==="strike"&&(S="strikeThrough"),S==="quote"){var _=(0,m._Y)(l.startContainer,"BLOCKQUOTE");_||(_=l.startContainer.childNodes[l.startOffset]),_&&(a=!1,t.classList.remove("vditor-menu--current"),l.insertNode(document.createElement("wbr")),_.outerHTML=_.innerHTML.trim()===""?'<p data-block="0">'.concat(_.innerHTML,"</p>"):_.innerHTML,(0,P.ir)(e.wysiwyg.element,l))}else if(S==="inline-code"){var D=(0,m._Y)(l.startContainer,"CODE");D||(D=l.startContainer.childNodes[l.startOffset]),D&&(D.outerHTML=D.innerHTML.replace(d.Y.ZWSP,"")+"<wbr>",(0,P.ir)(e.wysiwyg.element,l))}else S==="link"?(l.collapsed&&l.selectNode(l.startContainer.parentElement),document.execCommand("unlink",!1,"")):S==="check"||S==="list"||S==="ordered-list"?($n(e,l,S),(0,P.ir)(e.wysiwyg.element,l),a=!1,t.classList.remove("vditor-menu--current")):(a=!1,t.classList.remove("vditor-menu--current"),l.toString()===""?yo(l,e,S):document.execCommand(S,!1,""));else{e.wysiwyg.element.childNodes.length===0&&(e.wysiwyg.element.innerHTML='<p data-block="0"><wbr></p>',(0,P.ir)(e.wysiwyg.element,l));var L=(0,m.pt)(l.startContainer);if(S==="quote"){if(L||(L=l.startContainer.childNodes[l.startOffset]),L){a=!1,t.classList.add("vditor-menu--current"),l.insertNode(document.createElement("wbr"));var I=(0,m._Y)(l.startContainer,"LI");I&&L.contains(I)?I.innerHTML='<blockquote data-block="0">'.concat(I.innerHTML,"</blockquote>"):L.outerHTML='<blockquote data-block="0">'.concat(L.outerHTML,"</blockquote>"),(0,P.ir)(e.wysiwyg.element,l)}}else if(S==="check"||S==="list"||S==="ordered-list")$n(e,l,S,!1),(0,P.ir)(e.wysiwyg.element,l),a=!1,p(e.toolbar.elements,["check","list","ordered-list"]),t.classList.add("vditor-menu--current");else if(S==="inline-code"){if(l.toString()===""){var B=document.createElement("code");B.textContent=d.Y.ZWSP,l.insertNode(B),l.setStart(B.firstChild,1),l.collapse(!0),(0,P.jl)(l)}else if(l.startContainer.nodeType===3){var B=document.createElement("code");l.surroundContents(B),l.insertNode(B),(0,P.jl)(l)}t.classList.add("vditor-menu--current")}else if(S==="code"){var B=document.createElement("div");B.className="vditor-wysiwyg__block",B.setAttribute("data-type","code-block"),B.setAttribute("data-block","0"),B.setAttribute("data-marker","```"),l.toString()===""?B.innerHTML=`<pre><code><wbr>
</code></pre>`:(B.innerHTML="<pre><code>".concat(l.toString(),"<wbr></code></pre>"),l.deleteContents()),l.insertNode(B),L&&(L.outerHTML=e.lute.SpinVditorDOM(L.outerHTML)),(0,P.ir)(e.wysiwyg.element,l),e.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach(function(je){Pe(je,e)}),t.classList.add("vditor-menu--disabled")}else if(S==="link"){if(l.toString()===""){var Z=document.createElement("a");Z.innerText=d.Y.ZWSP,l.insertNode(Z),l.setStart(Z.firstChild,1),l.collapse(!0),wi(e,Z,l);var G=e.wysiwyg.popover.querySelector("input");G.value="",G.focus(),o=!1}else{var B=document.createElement("a");B.setAttribute("href",""),B.innerHTML=l.toString(),l.surroundContents(B),l.insertNode(B),(0,P.jl)(l),wi(e,B,l);var W=e.wysiwyg.popover.querySelectorAll("input");W[0].value=B.innerText,W[1].focus()}a=!1,t.classList.add("vditor-menu--current")}else if(S==="table"){var se='<table data-block="0"><thead><tr><th>col1<wbr></th><th>col2</th><th>col3</th></tr></thead><tbody><tr><td> </td><td> </td><td> </td></tr><tr><td> </td><td> </td><td> </td></tr></tbody></table>';if(l.toString().trim()==="")L&&L.innerHTML.trim().replace(d.Y.ZWSP,"")===""?L.outerHTML=se:document.execCommand("insertHTML",!1,se),l.selectNode(e.wysiwyg.element.querySelector("wbr").previousSibling),e.wysiwyg.element.querySelector("wbr").remove(),(0,P.jl)(l);else{se='<table data-block="0"><thead><tr>';var Q=l.toString().split(`
`),q=Q[0].split(",").length>Q[0].split("	").length?",":"	";Q.forEach(function(be,je){je===0?(be.split(q).forEach(function(Re,ze){ze===0?se+="<th>".concat(Re,"<wbr></th>"):se+="<th>".concat(Re,"</th>")}),se+="</tr></thead>"):(je===1?se+="<tbody><tr>":se+="<tr>",be.split(q).forEach(function(Re){se+="<td>".concat(Re,"</td>")}),se+="</tr>")}),se+="</tbody></table>",document.execCommand("insertHTML",!1,se),(0,P.ir)(e.wysiwyg.element,l)}a=!1,t.classList.add("vditor-menu--disabled")}else if(S==="line"){if(L){var ve=`<hr data-block="0"><p data-block="0"><wbr>
</p>`;L.innerHTML.trim()===""?L.outerHTML=ve:L.insertAdjacentHTML("afterend",ve),(0,P.ir)(e.wysiwyg.element,l)}}else if(a=!1,t.classList.add("vditor-menu--current"),S==="strike"&&(S="strikeThrough"),l.toString()===""&&(S==="bold"||S==="italic"||S==="strikeThrough")){var ae="strong";S==="italic"?ae="em":S==="strikeThrough"&&(ae="s");var B=document.createElement(ae);B.textContent=d.Y.ZWSP,l.insertNode(B),B.previousSibling&&B.previousSibling.textContent===d.Y.ZWSP&&(B.previousSibling.textContent=""),l.setStart(B.firstChild,1),l.collapse(!0),(0,P.jl)(l)}else document.execCommand(S,!1,"")}a&&qt(e),o&&Be(e)}},$e=function(){function e(t,i){var a,o=this;this.element=document.createElement("div"),i.className&&(a=this.element.classList).add.apply(a,i.className.split(" "));var l=i.hotkey?" <".concat((0,u.fG)(i.hotkey),">"):"";i.level===2&&(l=i.hotkey?" &lt;".concat((0,u.fG)(i.hotkey),"&gt;"):"");var S=i.tip?i.tip+l:"".concat(window.VditorI18n[i.name]).concat(l),_=i.name==="upload"?"div":"button";if(i.level===2)this.element.innerHTML="<".concat(_,' data-type="').concat(i.name,'">').concat(S,"</").concat(_,">");else{this.element.classList.add("vditor-toolbar__item");var D=document.createElement(_);D.setAttribute("data-type",i.name),D.className="vditor-tooltipped vditor-tooltipped__".concat(i.tipPosition),D.setAttribute("aria-label",S),D.innerHTML=i.icon,this.element.appendChild(D)}i.prefix&&this.element.children[0].addEventListener((0,u.y3)(),function(L){L.preventDefault(),!o.element.firstElementChild.classList.contains(d.Y.CLASS_MENU_DISABLED)&&(t.currentMode==="wysiwyg"?bo(t,o.element.children[0],L):t.currentMode==="ir"?Ro(t,o.element.children[0],i.prefix||"",i.suffix||""):Co(t,o.element.children[0],i.prefix||"",i.suffix||""))})}return e}(),wo=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Wt=function(e,t,i){var a;if(typeof i!="string"?(x(e,["subToolbar","hint"]),i.preventDefault(),a=T(e)):a=i,!(e.currentMode===t&&typeof i!="string")){if(e.devtools&&e.devtools.renderEchart(e),e.options.preview.mode==="both"&&t==="sv"?e.preview.element.style.display="block":e.preview.element.style.display="none",E(e.toolbar.elements,d.Y.EDIT_TOOLBARS),p(e.toolbar.elements,d.Y.EDIT_TOOLBARS),b(e.toolbar.elements,["outdent","indent"]),t==="ir")k(e.toolbar.elements,["both"]),M(e.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),e.sv.element.style.display="none",e.wysiwyg.element.parentElement.style.display="none",e.ir.element.parentElement.style.display="block",e.lute.SetVditorIR(!0),e.lute.SetVditorWYSIWYG(!1),e.lute.SetVditorSV(!1),e.currentMode="ir",e.ir.element.innerHTML=e.lute.Md2VditorIRDOM(a),Rt(e,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),it(e),e.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach(function(l){Pe(l,e)}),e.ir.element.querySelectorAll(".vditor-toc").forEach(function(l){(0,pe.T)(l,{cdn:e.options.cdn,math:e.options.preview.math})});else if(t==="wysiwyg")k(e.toolbar.elements,["both"]),M(e.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),e.sv.element.style.display="none",e.wysiwyg.element.parentElement.style.display="block",e.ir.element.parentElement.style.display="none",e.lute.SetVditorIR(!1),e.lute.SetVditorWYSIWYG(!0),e.lute.SetVditorSV(!1),e.currentMode="wysiwyg",it(e),mr(e,a,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),e.wysiwyg.element.querySelectorAll(".vditor-toc").forEach(function(l){(0,pe.T)(l,{cdn:e.options.cdn,math:e.options.preview.math})}),e.wysiwyg.popover.style.display="none";else if(t==="sv"){M(e.toolbar.elements,["both"]),k(e.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),e.wysiwyg.element.parentElement.style.display="none",e.ir.element.parentElement.style.display="none",(e.options.preview.mode==="both"||e.options.preview.mode==="editor")&&(e.sv.element.style.display="block"),e.lute.SetVditorIR(!1),e.lute.SetVditorWYSIWYG(!1),e.lute.SetVditorSV(!0),e.currentMode="sv";var o=vr(a,e);o==="<div data-block='0'></div>"&&(o=""),e.sv.element.innerHTML=o,Ne(e.sv.element),Ge(e,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),it(e)}e.undo.resetIcon(e),typeof i!="string"&&(e[e.currentMode].element.focus(),dn(e)),j(e),Ke(e),e.toolbar.elements["edit-mode"]&&(e.toolbar.elements["edit-mode"].querySelectorAll("button").forEach(function(l){l.classList.remove("vditor-menu--current")}),e.toolbar.elements["edit-mode"].querySelector('button[data-mode="'.concat(e.currentMode,'"]')).classList.add("vditor-menu--current")),e.outline.toggle(e,e.currentMode!=="sv"&&e.options.outline.enable,typeof i!="string")}},Eo=function(e){wo(t,e);function t(i,a){var o=e.call(this,i,a)||this,l=document.createElement("div");return l.className="vditor-hint".concat(a.level===2?"":" vditor-panel--arrow"),l.innerHTML='<button data-mode="wysiwyg">'.concat(window.VditorI18n.wysiwyg," &lt;").concat((0,u.fG)("⌥⌘7"),`></button>
<button data-mode="ir">`).concat(window.VditorI18n.instantRendering," &lt;").concat((0,u.fG)("⌥⌘8"),`></button>
<button data-mode="sv">`).concat(window.VditorI18n.splitView," &lt;").concat((0,u.fG)("⌥⌘9"),"></button>"),o.element.appendChild(l),o._bindEvent(i,l,a),o}return t.prototype._bindEvent=function(i,a,o){var l=this.element.children[0];A(i,a,l,o.level),a.children.item(0).addEventListener((0,u.y3)(),function(S){Wt(i,"wysiwyg",S),S.preventDefault(),S.stopPropagation()}),a.children.item(1).addEventListener((0,u.y3)(),function(S){Wt(i,"ir",S),S.preventDefault(),S.stopPropagation()}),a.children.item(2).addEventListener((0,u.y3)(),function(S){Wt(i,"sv",S),S.preventDefault(),S.stopPropagation()})},t}($e),Ln=function(e,t){return(0,P.Co)(e,t)?getSelection().toString():""},Ei=function(e,t){t.addEventListener("focus",function(){e.options.focus&&e.options.focus(T(e)),x(e,["subToolbar","hint"])})},gr=function(e,t){t.addEventListener("dblclick",function(i){i.target.tagName==="IMG"&&(e.options.image.preview?e.options.image.preview(i.target):e.options.image.isPreview&&(0,ne.o)(i.target,e.options.lang,e.options.theme))})},Si=function(e,t){t.addEventListener("blur",function(i){if(e.currentMode==="ir"){var a=e.ir.element.querySelector(".vditor-ir__node--expand");a&&a.classList.remove("vditor-ir__node--expand")}else e.currentMode==="wysiwyg"&&!e.wysiwyg.selectPopover.contains(i.relatedTarget)&&e.wysiwyg.hideComment();e[e.currentMode].range=(0,P.RN)(e),e.options.blur&&e.options.blur(T(e))})},Ci=function(e,t){t.addEventListener("dragstart",function(i){i.dataTransfer.setData(d.Y.DROP_EDITOR,d.Y.DROP_EDITOR)}),t.addEventListener("drop",function(i){i.dataTransfer.getData(d.Y.DROP_EDITOR)?Ce(e):(i.dataTransfer.types.includes("Files")||i.dataTransfer.types.includes("text/html"))&&Wn(e,i,{pasteCode:function(a){document.execCommand("insertHTML",!1,a)}})})},Ti=function(e,t,i){t.addEventListener("copy",function(a){return i(a,e)})},ki=function(e,t,i){t.addEventListener("cut",function(a){i(a,e),e.options.comment.enable&&e.currentMode==="wysiwyg"&&e.wysiwyg.getComments(e),document.execCommand("delete")})},qe=function(e){if(e.currentMode==="wysiwyg"&&e.options.comment.enable&&e.options.comment.adjustTop(e.wysiwyg.getComments(e,!0)),!!e.options.typewriterMode){var t=e[e.currentMode].element,i=(0,P.Ey)(t).top;e.options.height==="auto"&&!e.element.classList.contains("vditor--fullscreen")&&window.scrollTo(window.scrollX,i+e.element.offsetTop+e.toolbar.element.offsetHeight-window.innerHeight/2+10),(e.options.height!=="auto"||e.element.classList.contains("vditor--fullscreen"))&&(t.scrollTop=i+t.scrollTop-t.clientHeight/2+10)}},Mi=function(e,t){t.addEventListener("keydown",function(i){if(!i.isComposing&&e.options.keydown&&e.options.keydown(i),!((e.options.hint.extend.length>1||e.toolbar.elements.emoji)&&e.hint.select(i,e))){if(e.options.comment.enable&&e.currentMode==="wysiwyg"&&(i.key==="Backspace"||$("⌘X",i))&&e.wysiwyg.getComments(e),e.currentMode==="sv"){if(Xe(e,i))return}else if(e.currentMode==="wysiwyg"){if(go(e,i))return}else if(e.currentMode==="ir"&&Le(e,i))return;if(e.options.ctrlEnter&&$("⌘Enter",i)){e.options.ctrlEnter(T(e)),i.preventDefault();return}if($("⌘Z",i)&&!e.toolbar.elements.undo){e.undo.undo(e),i.preventDefault();return}if($("⌘Y",i)&&!e.toolbar.elements.redo){e.undo.redo(e),i.preventDefault();return}if(i.key==="Escape"){e.hint.element.style.display==="block"?e.hint.element.style.display="none":e.options.esc&&!i.isComposing&&e.options.esc(T(e)),i.preventDefault();return}if((0,u._0)(i)&&i.altKey&&!i.shiftKey&&/^Digit[1-6]$/.test(i.code)){if(e.currentMode==="wysiwyg"){var a=i.code.replace("Digit","H");(0,m._Y)(getSelection().getRangeAt(0).startContainer,a)?bi(e):zn(e,a),Be(e)}else e.currentMode==="sv"?yr(e,"#".repeat(parseInt(i.code.replace("Digit",""),10))+" "):e.currentMode==="ir"&&On(e,"#".repeat(parseInt(i.code.replace("Digit",""),10))+" ");return i.preventDefault(),!0}if((0,u._0)(i)&&i.altKey&&!i.shiftKey&&/^Digit[7-9]$/.test(i.code))return i.code==="Digit7"?Wt(e,"wysiwyg",i):i.code==="Digit8"?Wt(e,"ir",i):i.code==="Digit9"&&Wt(e,"sv",i),!0;e.options.toolbar.find(function(o){if(!o.hotkey||o.toolbar){if(o.toolbar){var l=o.toolbar.find(function(S){if(!S.hotkey)return!1;if($(S.hotkey,i))return e.toolbar.elements[S.name].children[0].dispatchEvent(new CustomEvent((0,u.y3)())),i.preventDefault(),!0});return!!l}return!1}if($(o.hotkey,i))return e.toolbar.elements[o.name].children[0].dispatchEvent(new CustomEvent((0,u.y3)())),i.preventDefault(),!0})}})},xi=function(e,t){t.addEventListener("selectstart",function(i){t.onmouseup=function(){setTimeout(function(){var a=Ln(e[e.currentMode].element);a.trim()?(e.currentMode==="wysiwyg"&&e.options.comment.enable&&(!(0,m.Th)(i.target,"data-type","footnotes-block")&&!(0,m.Th)(i.target,"data-type","link-ref-defs-block")?e.wysiwyg.showComment():e.wysiwyg.hideComment()),e.options.select&&e.options.select(a)):e.currentMode==="wysiwyg"&&e.options.comment.enable&&e.wysiwyg.hideComment()})}})},_i=function(e,t){var i=(0,P.RN)(e);i.extractContents(),i.insertNode(document.createTextNode(Lute.Caret)),i.insertNode(document.createTextNode(t));var a=(0,m.Th)(i.startContainer,"data-block","0");a||(a=e.sv.element);var o=e.lute.SpinVditorSVDOM(a.textContent);o="<div data-block='0'>"+o.replace(/<span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span><span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span></g,`<span data-type="newline"><br /><span style="display: none">
</span></span><span data-type="newline"><br /><span style="display: none">
</span></span></div><div data-block="0"><`)+"</div>",a.isEqualNode(e.sv.element)?a.innerHTML=o:a.outerHTML=o,Ne(e.sv.element),(0,P.ir)(e.sv.element,i),qe(e)},Fn=function(e,t,i){i===void 0&&(i=!0);var a=e;for(a.nodeType===3&&(a=a.parentElement);a;){if(a.getAttribute("data-type")===t)return a;i?a=a.previousElementSibling:a=a.nextElementSibling}return!1},vr=function(e,t){N("SpinVditorSVDOM",e,"argument",t.options.debugger);var i=t.lute.SpinVditorSVDOM(e);return e="<div data-block='0'>"+i.replace(/<span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span><span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span></g,`<span data-type="newline"><br /><span style="display: none">
</span></span><span data-type="newline"><br /><span style="display: none">
</span></span></div><div data-block="0"><`)+"</div>",N("SpinVditorSVDOM",e,"result",t.options.debugger),e},So=function(e){var t=e.getAttribute("data-type"),i=e.previousElementSibling,a=t&&t!=="text"&&t!=="table"&&t!=="heading-marker"&&t!=="newline"&&t!=="yaml-front-matter-open-marker"&&t!=="yaml-front-matter-close-marker"&&t!=="code-block-info"&&t!=="code-block-close-marker"&&t!=="code-block-open-marker"?e.textContent:"",o=!1;for(t==="newline"&&(o=!0);i&&!o;){var l=i.getAttribute("data-type");if(l==="li-marker"||l==="blockquote-marker"||l==="task-marker"||l==="padding"){var S=i.textContent;if(l==="li-marker"&&(t==="code-block-open-marker"||t==="code-block-info"))a=S.replace(/\S/g," ")+a;else if(t==="code-block-close-marker"&&i.nextElementSibling.isSameNode(e)){var _=Fn(e,"code-block-open-marker");_&&_.previousElementSibling&&(i=_.previousElementSibling,a=S+a)}else a=S+a}else l==="newline"&&(o=!0);i=i.previousElementSibling}return a},Ge=function(e,t){t===void 0&&(t={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),t.enableHint&&e.hint.render(e),e.preview.render(e);var i=T(e);typeof e.options.input=="function"&&t.enableInput&&e.options.input(i),e.options.counter.enable&&e.counter.render(e,i),e.options.cache.enable&&(0,u.D)()&&(localStorage.setItem(e.options.cache.id,i),e.options.cache.after&&e.options.cache.after(i)),e.devtools&&e.devtools.renderEchart(e),clearTimeout(e.sv.processTimeoutId),e.sv.processTimeoutId=window.setTimeout(function(){t.enableAddUndoStack&&!e.sv.composingLock&&e.undo.addToUndoStack(e)},e.options.undoDelay)},yr=function(e,t){var i=(0,P.RN)(e),a=(0,O.f)(i.startContainer,"SPAN");a&&a.textContent.trim()!==""&&(t=`
`+t),i.collapse(!0),document.execCommand("insertHTML",!1,t)},Co=function(e,t,i,a){var o=(0,P.RN)(e),l=t.getAttribute("data-type");e.sv.element.childNodes.length===0&&(e.sv.element.innerHTML=`<span data-type="p" data-block="0"><span data-type="text"><wbr></span></span><span data-type="newline"><br><span style="display: none">
</span></span>`,(0,P.ir)(e.sv.element,o));var S=(0,m.pt)(o.startContainer),_=(0,O.f)(o.startContainer,"SPAN");if(S){if(l==="link"){var D=void 0;o.toString()===""?D="".concat(i).concat(Lute.Caret).concat(a):D="".concat(i).concat(o.toString()).concat(a.replace(")",Lute.Caret+")")),document.execCommand("insertHTML",!1,D);return}else if(l==="italic"||l==="bold"||l==="strike"||l==="inline-code"||l==="code"||l==="table"||l==="line"){var D=void 0;o.toString()===""?D="".concat(i).concat(Lute.Caret).concat(l==="code"?"":a):D="".concat(i).concat(o.toString()).concat(Lute.Caret).concat(l==="code"?"":a),l==="table"||l==="code"&&_&&_.textContent!==""?D=`

`+D:l==="line"&&(D=`

`.concat(i,`
`).concat(Lute.Caret)),document.execCommand("insertHTML",!1,D);return}else if((l==="check"||l==="list"||l==="ordered-list"||l==="quote")&&_){var L="* ";l==="check"?L="* [ ] ":l==="ordered-list"?L="1. ":l==="quote"&&(L="> ");var I=Fn(_,"newline");I?I.insertAdjacentText("afterend",L):S.insertAdjacentText("afterbegin",L),Me(e);return}(0,P.ir)(e.sv.element,o),Ge(e)}},br=function(e){switch(e.currentMode){case"ir":return e.ir.element;case"wysiwyg":return e.wysiwyg.element;case"sv":return e.sv.element}},wr=function(e,t){e.options.upload.setHeaders&&(e.options.upload.headers=e.options.upload.setHeaders()),e.options.upload.headers&&Object.keys(e.options.upload.headers).forEach(function(i){t.setRequestHeader(i,e.options.upload.headers[i])})},To=function(e,t,i,a){function o(l){return l instanceof i?l:new i(function(S){S(l)})}return new(i||(i=Promise))(function(l,S){function _(I){try{L(a.next(I))}catch(B){S(B)}}function D(I){try{L(a.throw(I))}catch(B){S(B)}}function L(I){I.done?l(I.value):o(I.value).then(_,D)}L((a=a.apply(e,t||[])).next())})},ko=function(e,t){var i={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,o,l,S;return S={next:_(0),throw:_(1),return:_(2)},typeof Symbol=="function"&&(S[Symbol.iterator]=function(){return this}),S;function _(L){return function(I){return D([L,I])}}function D(L){if(a)throw new TypeError("Generator is already executing.");for(;S&&(S=0,L[0]&&(i=0)),i;)try{if(a=1,o&&(l=L[0]&2?o.return:L[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,L[1])).done)return l;switch(o=0,l&&(L=[L[0]&2,l.value]),L[0]){case 0:case 1:l=L;break;case 4:return i.label++,{value:L[1],done:!1};case 5:i.label++,o=L[1],L=[0];continue;case 7:L=i.ops.pop(),i.trys.pop();continue;default:if(l=i.trys,!(l=l.length>0&&l[l.length-1])&&(L[0]===6||L[0]===2)){i=0;continue}if(L[0]===3&&(!l||L[1]>l[0]&&L[1]<l[3])){i.label=L[1];break}if(L[0]===6&&i.label<l[1]){i.label=l[1],l=L;break}if(l&&i.label<l[2]){i.label=l[2],i.ops.push(L);break}l[2]&&i.ops.pop(),i.trys.pop();continue}L=t.call(e,i)}catch(I){L=[6,I],o=0}finally{a=l=0}if(L[0]&5)throw L[1];return{value:L[0]?L[1]:void 0,done:!0}}},Mo=function(){function e(){this.isUploading=!1,this.element=document.createElement("div"),this.element.className="vditor-upload"}return e}(),xo=function(e,t){e.tip.hide();var i=[],a="",o="";e.options.lang,e.options;for(var l=function(D,L){var I=t[L],B=!0;I.name||(a+="<li>".concat(window.VditorI18n.nameEmpty,"</li>"),B=!1),I.size>e.options.upload.max&&(a+="<li>".concat(I.name," ").concat(window.VditorI18n.over," ").concat(e.options.upload.max/1024/1024,"M</li>"),B=!1);var Z=I.name.lastIndexOf("."),G=I.name.substr(Z),W=e.options.upload.filename(I.name.substr(0,Z))+G;if(e.options.upload.accept){var se=e.options.upload.accept.split(",").some(function(Q){var q=Q.trim();if(q.indexOf(".")===0){if(G.toLowerCase()===q.toLowerCase())return!0}else if(I.type.split("/")[0]===q.split("/")[0])return!0;return!1});se||(a+="<li>".concat(I.name," ").concat(window.VditorI18n.fileTypeError,"</li>"),B=!1)}B&&(i.push(I),o+="<li>".concat(W," ").concat(window.VditorI18n.uploading,"</li>"))},S=t.length,_=0;_<S;_++)l(S,_);return e.tip.show("<ul>".concat(a).concat(o,"</ul>")),i},_o=function(e,t){var i=br(t);i.focus();var a=JSON.parse(e),o="";a.code===1&&(o="".concat(a.msg)),a.data.errFiles&&a.data.errFiles.length>0&&(o="<ul><li>".concat(o,"</li>"),a.data.errFiles.forEach(function(S){var _=S.lastIndexOf("."),D=t.options.upload.filename(S.substr(0,_))+S.substr(_);o+="<li>".concat(D," ").concat(window.VditorI18n.uploadError,"</li>")}),o+="</ul>"),o?t.tip.show(o):t.tip.hide();var l="";Object.keys(a.data.succMap).forEach(function(S){var _=a.data.succMap[S],D=S.lastIndexOf("."),L=S.substr(D),I=t.options.upload.filename(S.substr(0,D))+L;L=L.toLowerCase(),L.indexOf(".wav")===0||L.indexOf(".mp3")===0||L.indexOf(".ogg")===0?t.currentMode==="wysiwyg"?l+=`<div class="vditor-wysiwyg__block" data-type="html-block"
 data-block="0"><pre><code>&lt;audio controls="controls" src="`.concat(_,'"&gt;&lt;/audio&gt;</code></pre><pre class="vditor-wysiwyg__preview" data-render="1"><audio controls="controls" src="').concat(_,`"></audio></pre></div>
`):t.currentMode==="ir"?l+='<audio controls="controls" src="'.concat(_,`"></audio>
`):l+="[".concat(I,"](").concat(_,`)
`):L.indexOf(".apng")===0||L.indexOf(".bmp")===0||L.indexOf(".gif")===0||L.indexOf(".ico")===0||L.indexOf(".cur")===0||L.indexOf(".jpg")===0||L.indexOf(".jpeg")===0||L.indexOf(".jfif")===0||L.indexOf(".pjp")===0||L.indexOf(".pjpeg")===0||L.indexOf(".png")===0||L.indexOf(".svg")===0||L.indexOf(".webp")===0?t.currentMode==="wysiwyg"?l+='<img alt="'.concat(I,'" src="').concat(_,`">
`):l+="![".concat(I,"](").concat(_,`)
`):t.currentMode==="wysiwyg"?l+='<a href="'.concat(_,'">').concat(I,`</a>
`):l+="[".concat(I,"](").concat(_,`)
`)}),(0,P.jl)(t.upload.range),document.execCommand("insertHTML",!1,l),t.upload.range=getSelection().getRangeAt(0).cloneRange()},Li=function(e,t,i){return To(void 0,void 0,void 0,function(){var a,o,W,l,S,S,_,D,L,I,B,Z,G,W,se,Q;return ko(this,function(q){switch(q.label){case 0:for(a=[],o=e.options.upload.multiple===!0?t.length:1,W=0;W<o;W++)l=t[W],l instanceof DataTransferItem&&(l=l.getAsFile()),a.push(l);return e.options.upload.handler?[4,e.options.upload.handler(a)]:[3,2];case 1:return S=q.sent(),i&&(i.value=""),typeof S=="string"?(e.tip.show(S),[2]):[2];case 2:return!e.options.upload.url||!e.upload?(i&&(i.value=""),e.tip.show("please config: options.upload.url"),[2]):e.options.upload.file?[4,e.options.upload.file(a)]:[3,4];case 3:a=q.sent(),q.label=4;case 4:if(e.options.upload.validate&&(S=e.options.upload.validate(a),typeof S=="string"))return e.tip.show(S),[2];if(_=br(e),e.upload.range=(0,P.RN)(e),D=xo(e,a),D.length===0)return i&&(i.value=""),[2];for(L=new FormData,I=e.options.upload.extraData,B=0,Z=Object.keys(I);B<Z.length;B++)G=Z[B],L.append(G,I[G]);for(W=0,se=D.length;W<se;W++)L.append(e.options.upload.fieldName,D[W]);return Q=new XMLHttpRequest,Q.open("POST",e.options.upload.url),e.options.upload.token&&Q.setRequestHeader("X-Upload-Token",e.options.upload.token),e.options.upload.withCredentials&&(Q.withCredentials=!0),wr(e,Q),e.upload.isUploading=!0,_.setAttribute("contenteditable","false"),Q.onreadystatechange=function(){if(Q.readyState===XMLHttpRequest.DONE){if(e.upload.isUploading=!1,_.setAttribute("contenteditable","true"),Q.status>=200&&Q.status<300)if(e.options.upload.success)e.options.upload.success(_,Q.responseText);else{var ve=Q.responseText;e.options.upload.format&&(ve=e.options.upload.format(t,Q.responseText)),_o(ve,e)}else e.options.upload.error?e.options.upload.error(Q.responseText):e.tip.show(Q.responseText);i&&(i.value=""),e.upload.element.style.display="none"}},Q.upload.onprogress=function(ve){if(ve.lengthComputable){var ae=ve.loaded/ve.total*100;e.upload.element.style.display="block";var be=e.upload.element;be.style.width=ae+"%"}},Q.send(L),[2]}})})},Un=function(e,t,i){var a,o=(0,m.pt)(t.startContainer);if(o||(o=e.wysiwyg.element),i&&i.inputType!=="formatItalic"&&i.inputType!=="deleteByDrag"&&i.inputType!=="insertFromDrop"&&i.inputType!=="formatBold"&&i.inputType!=="formatRemove"&&i.inputType!=="formatStrikeThrough"&&i.inputType!=="insertUnorderedList"&&i.inputType!=="insertOrderedList"&&i.inputType!=="formatOutdent"&&i.inputType!=="formatIndent"&&i.inputType!==""||!i){var l=fo(t.startContainer);l&&l.remove(),e.wysiwyg.element.querySelectorAll("wbr").forEach(function(ae){ae.remove()}),t.insertNode(document.createElement("wbr")),o.querySelectorAll("[style]").forEach(function(ae){ae.removeAttribute("style")}),o.querySelectorAll(".vditor-comment").forEach(function(ae){ae.textContent.trim()===""&&(ae.classList.remove("vditor-comment","vditor-comment--focus"),ae.removeAttribute("data-cmtids"))}),(a=o.previousElementSibling)===null||a===void 0||a.querySelectorAll(".vditor-comment").forEach(function(ae){ae.textContent.trim()===""&&(ae.classList.remove("vditor-comment","vditor-comment--focus"),ae.removeAttribute("data-cmtids"))});var S="";o.getAttribute("data-type")==="link-ref-defs-block"&&(o=e.wysiwyg.element);var _=o.isEqualNode(e.wysiwyg.element),D=(0,m.Th)(o,"data-type","footnotes-block");if(_)S=o.innerHTML;else{var L=(0,m.KR)(t.startContainer);if(L&&!D){var I=(0,O.f)(t.startContainer,"BLOCKQUOTE");I?o=(0,m.pt)(t.startContainer)||o:o=L}if(D&&(o=D),S=o.outerHTML,o.tagName==="UL"||o.tagName==="OL"){var B=o.previousElementSibling,Z=o.nextElementSibling;B&&(B.tagName==="UL"||B.tagName==="OL")&&(S=B.outerHTML+S,B.remove()),Z&&(Z.tagName==="UL"||Z.tagName==="OL")&&(S=S+Z.outerHTML,Z.remove()),S=S.replace("<div><wbr><br></div>","<li><p><wbr><br></p></li>")}o.innerText.startsWith("```")||(e.wysiwyg.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(ae){ae&&!o.isEqualNode(ae)&&(S+=ae.outerHTML,ae.remove())}),e.wysiwyg.element.querySelectorAll("[data-type='footnotes-block']").forEach(function(ae){ae&&!o.isEqualNode(ae)&&(S+=ae.outerHTML,ae.remove())}))}if(S=S.replace(/<\/(strong|b)><strong data-marker="\W{2}">/g,"").replace(/<\/(em|i)><em data-marker="\W{1}">/g,"").replace(/<\/(s|strike)><s data-marker="~{1,2}">/g,""),S==='<p data-block="0">```<wbr></p>'&&e.hint.recentLanguage&&(S='<p data-block="0">```<wbr></p>'.replace("```","```"+e.hint.recentLanguage)),N("SpinVditorDOM",S,"argument",e.options.debugger),S=e.lute.SpinVditorDOM(S),N("SpinVditorDOM",S,"result",e.options.debugger),_)o.innerHTML=S;else if(o.outerHTML=S,D){var G=(0,m.Ab)(e.wysiwyg.element.querySelector("wbr"),"LI");if(G){var W=e.wysiwyg.element.querySelector('sup[data-type="footnotes-ref"][data-footnotes-label="'.concat(G.getAttribute("data-marker"),'"]'));W&&W.setAttribute("aria-label",G.textContent.trim().substr(0,24))}}var se,Q=e.wysiwyg.element.querySelectorAll("[data-type='link-ref-defs-block']");Q.forEach(function(ae,be){be===0?se=ae:(se.insertAdjacentHTML("beforeend",ae.innerHTML),ae.remove())}),Q.length>0&&e.wysiwyg.element.insertAdjacentElement("beforeend",Q[0]);var q,ve=e.wysiwyg.element.querySelectorAll("[data-type='footnotes-block']");ve.forEach(function(ae,be){be===0?q=ae:(q.insertAdjacentHTML("beforeend",ae.innerHTML),ae.remove())}),ve.length>0&&e.wysiwyg.element.insertAdjacentElement("beforeend",ve[0]),(0,P.ir)(e.wysiwyg.element,t),e.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach(function(ae){Pe(ae,e)}),i&&(i.inputType==="deleteContentBackward"||i.inputType==="deleteContentForward")&&e.options.comment.enable&&(e.wysiwyg.triggerRemoveComment(e),e.options.comment.adjustTop(e.wysiwyg.getComments(e,!0)))}j(e),Be(e,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},Lo=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},Ao=function(e,t,i,a){function o(l){return l instanceof i?l:new i(function(S){S(l)})}return new(i||(i=Promise))(function(l,S){function _(I){try{L(a.next(I))}catch(B){S(B)}}function D(I){try{L(a.throw(I))}catch(B){S(B)}}function L(I){I.done?l(I.value):o(I.value).then(_,D)}L((a=a.apply(e,t||[])).next())})},Do=function(e,t){var i={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,o,l,S;return S={next:_(0),throw:_(1),return:_(2)},typeof Symbol=="function"&&(S[Symbol.iterator]=function(){return this}),S;function _(L){return function(I){return D([L,I])}}function D(L){if(a)throw new TypeError("Generator is already executing.");for(;S&&(S=0,L[0]&&(i=0)),i;)try{if(a=1,o&&(l=L[0]&2?o.return:L[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,L[1])).done)return l;switch(o=0,l&&(L=[L[0]&2,l.value]),L[0]){case 0:case 1:l=L;break;case 4:return i.label++,{value:L[1],done:!1};case 5:i.label++,o=L[1],L=[0];continue;case 7:L=i.ops.pop(),i.trys.pop();continue;default:if(l=i.trys,!(l=l.length>0&&l[l.length-1])&&(L[0]===6||L[0]===2)){i=0;continue}if(L[0]===3&&(!l||L[1]>l[0]&&L[1]<l[3])){i.label=L[1];break}if(L[0]===6&&i.label<l[1]){i.label=l[1],l=L;break}if(l&&i.label<l[2]){i.label=l[2],i.ops.push(L);break}l[2]&&i.ops.pop(),i.trys.pop();continue}L=t.call(e,i)}catch(I){L=[6,I],o=0}finally{a=l=0}if(L[0]&5)throw L[1];return{value:L[0]?L[1]:void 0,done:!0}}},Er=function(e,t,i){if(e.keyCode===229&&e.code===""&&e.key==="Unidentified"&&t.currentMode!=="sv"){var a=(0,m.pt)(i);if(a&&a.textContent.trim()==="")return t[t.currentMode].composingLock=!0,!1}return!0},Sr=function(e,t,i){if(!(i.key==="Enter"||i.key==="Tab"||i.key==="Backspace"||i.key.indexOf("Arrow")>-1||(0,u._0)(i)||i.key==="Escape"||i.shiftKey||i.altKey)){var a=(0,m._Y)(e.startContainer,"P")||(0,m._Y)(e.startContainer,"LI");if(a&&(0,P.ED)(a,t[t.currentMode].element,e).start===0){a.nodeValue&&(a.nodeValue=a.nodeValue.replace(/\u2006/g,""));var o=document.createTextNode(d.Y.ZWSP);e.insertNode(o),e.setStartAfter(o)}}},Cr=function(e,t){if(t==="ArrowDown"||t==="ArrowUp"){var i=(0,m.Th)(e.startContainer,"data-type","math-inline")||(0,m.Th)(e.startContainer,"data-type","html-entity")||(0,m.Th)(e.startContainer,"data-type","html-inline");i&&(t==="ArrowDown"&&e.setStartAfter(i.parentElement),t==="ArrowUp"&&e.setStartBefore(i.parentElement))}},An=function(e,t){var i=(0,P.RN)(e),a=(0,m.pt)(i.startContainer);a&&(a.insertAdjacentHTML(t,'<p data-block="0">'.concat(d.Y.ZWSP,`<wbr>
</p>`)),(0,P.ir)(e[e.currentMode].element,i),dn(e),Ce(e))},Oo=function(e){var t=(0,m._Y)(e,"TABLE");return t&&t.rows[0].cells[0].isSameNode(e)?t:!1},Po=function(e){var t=(0,m._Y)(e,"TABLE");return t&&t.lastElementChild.lastElementChild.lastElementChild.isSameNode(e)?t:!1},Tr=function(e,t,i){i===void 0&&(i=!0);var a=e.previousElementSibling;return a||(e.parentElement.previousElementSibling?a=e.parentElement.previousElementSibling.lastElementChild:e.parentElement.parentElement.tagName==="TBODY"&&e.parentElement.parentElement.previousElementSibling?a=e.parentElement.parentElement.previousElementSibling.lastElementChild.lastElementChild:a=null),a&&(t.selectNodeContents(a),i||t.collapse(!1),(0,P.jl)(t)),a},Dn=function(e,t,i,a,o){var l=(0,P.ED)(a,e[e.currentMode].element,i);if(t.key==="ArrowDown"&&a.textContent.trimRight().substr(l.start).indexOf(`
`)===-1||t.key==="ArrowRight"&&l.start>=a.textContent.trimRight().length){var S=o.nextElementSibling;return!S||S&&(S.tagName==="TABLE"||S.getAttribute("data-type"))?(o.insertAdjacentHTML("afterend",'<p data-block="0">'.concat(d.Y.ZWSP,"<wbr></p>")),(0,P.ir)(e[e.currentMode].element,i)):(i.selectNodeContents(S),i.collapse(!0),(0,P.jl)(i)),t.preventDefault(),!0}return!1},fn=function(e,t,i,a,o){var l=(0,P.ED)(a,e[e.currentMode].element,i);if(t.key==="ArrowUp"&&a.textContent.substr(0,l.start).indexOf(`
`)===-1||(t.key==="ArrowLeft"||t.key==="Backspace"&&i.toString()==="")&&l.start===0){var S=o.previousElementSibling;return!S||S&&(S.tagName==="TABLE"||S.getAttribute("data-type"))?(o.insertAdjacentHTML("beforebegin",'<p data-block="0">'.concat(d.Y.ZWSP,"<wbr></p>")),(0,P.ir)(e[e.currentMode].element,i)):(i.selectNodeContents(S),i.collapse(!1),(0,P.jl)(i)),t.preventDefault(),!0}return!1},$n=function(e,t,i,a){a===void 0&&(a=!0);var o=(0,m._Y)(t.startContainer,"LI");if(e[e.currentMode].element.querySelectorAll("wbr").forEach(function(I){I.remove()}),t.insertNode(document.createElement("wbr")),a&&o){for(var l="",S=0;S<o.parentElement.childElementCount;S++){var _=o.parentElement.children[S].querySelector("input");_&&_.remove(),l+='<p data-block="0">'.concat(o.parentElement.children[S].innerHTML.trimLeft(),"</p>")}o.parentElement.insertAdjacentHTML("beforebegin",l),o.parentElement.remove()}else if(o)if(i==="check")o.parentElement.querySelectorAll("li").forEach(function(I){I.insertAdjacentHTML("afterbegin",'<input type="checkbox" />'.concat(I.textContent.indexOf(" ")===0?"":" ")),I.classList.add("vditor-task")});else{o.querySelector("input")&&o.parentElement.querySelectorAll("li").forEach(function(I){I.querySelector("input").remove(),I.classList.remove("vditor-task")});var L=void 0;i==="list"?(L=document.createElement("ul"),L.setAttribute("data-marker","*")):(L=document.createElement("ol"),L.setAttribute("data-marker","1.")),L.setAttribute("data-block","0"),L.setAttribute("data-tight",o.parentElement.getAttribute("data-tight")),L.innerHTML=o.parentElement.innerHTML,o.parentElement.parentNode.replaceChild(L,o.parentElement)}else{var D=(0,m.Th)(t.startContainer,"data-block","0");D||(e[e.currentMode].element.querySelector("wbr").remove(),D=e[e.currentMode].element.querySelector("p"),D.innerHTML="<wbr>"),i==="check"?(D.insertAdjacentHTML("beforebegin",'<ul data-block="0"><li class="vditor-task"><input type="checkbox" /> '.concat(D.innerHTML,"</li></ul>")),D.remove()):i==="list"?(D.insertAdjacentHTML("beforebegin",'<ul data-block="0"><li>'.concat(D.innerHTML,"</li></ul>")),D.remove()):i==="ordered-list"&&(D.insertAdjacentHTML("beforebegin",'<ol data-block="0"><li>'.concat(D.innerHTML,"</li></ol>")),D.remove())}},kr=function(e,t,i){var a=t.previousElementSibling;if(t&&a){var o=[t];Array.from(i.cloneContents().children).forEach(function(D,L){D.nodeType!==3&&t&&D.textContent.trim()!==""&&t.getAttribute("data-node-id")===D.getAttribute("data-node-id")&&(L!==0&&o.push(t),t=t.nextElementSibling)}),e[e.currentMode].element.querySelectorAll("wbr").forEach(function(D){D.remove()}),i.insertNode(document.createElement("wbr"));var l=a.parentElement,S="";o.forEach(function(D){var L=D.getAttribute("data-marker");L.length!==1&&(L="1".concat(L.slice(-1))),S+='<li data-node-id="'.concat(D.getAttribute("data-node-id"),'" data-marker="').concat(L,'">').concat(D.innerHTML,"</li>"),D.remove()}),a.insertAdjacentHTML("beforeend","<".concat(l.tagName,' data-block="0">').concat(S,"</").concat(l.tagName,">")),e.currentMode==="wysiwyg"?l.outerHTML=e.lute.SpinVditorDOM(l.outerHTML):l.outerHTML=e.lute.SpinVditorIRDOM(l.outerHTML),(0,P.ir)(e[e.currentMode].element,i);var _=(0,m.KR)(i.startContainer);_&&_.querySelectorAll(".vditor-".concat(e.currentMode,"__preview[data-render='2']")).forEach(function(D){Pe(D,e),e.currentMode==="wysiwyg"&&D.previousElementSibling.setAttribute("style","display:none")}),Ce(e),dn(e)}else e[e.currentMode].element.focus()},Ai=function(e,t,i,a){var o=(0,m._Y)(t.parentElement,"LI");if(o){e[e.currentMode].element.querySelectorAll("wbr").forEach(function(B){B.remove()}),i.insertNode(document.createElement("wbr"));var l=t.parentElement,S=l.cloneNode(),_=[t];Array.from(i.cloneContents().children).forEach(function(B,Z){B.nodeType!==3&&t&&B.textContent.trim()!==""&&t.getAttribute("data-node-id")===B.getAttribute("data-node-id")&&(Z!==0&&_.push(t),t=t.nextElementSibling)});var D=!1,L="";l.querySelectorAll("li").forEach(function(B){D&&(L+=B.outerHTML,!B.nextElementSibling&&!B.previousElementSibling?B.parentElement.remove():B.remove()),B.isSameNode(_[_.length-1])&&(D=!0)}),_.reverse().forEach(function(B){o.insertAdjacentElement("afterend",B)}),L&&(S.innerHTML=L,_[0].insertAdjacentElement("beforeend",S)),e.currentMode==="wysiwyg"?a.outerHTML=e.lute.SpinVditorDOM(a.outerHTML):a.outerHTML=e.lute.SpinVditorIRDOM(a.outerHTML),(0,P.ir)(e[e.currentMode].element,i);var I=(0,m.KR)(i.startContainer);I&&I.querySelectorAll(".vditor-".concat(e.currentMode,"__preview[data-render='2']")).forEach(function(B){Pe(B,e),e.currentMode==="wysiwyg"&&B.previousElementSibling.setAttribute("style","display:none")}),Ce(e),dn(e)}else e[e.currentMode].element.focus()},Vn=function(e,t){for(var i=getSelection().getRangeAt(0).startContainer.parentElement,a=e.rows[0].cells.length,o=e.rows.length,l=0,S=0;S<o;S++)for(var _=0;_<a;_++)if(e.rows[S].cells[_].isSameNode(i)){l=_;break}for(var D=0;D<o;D++)e.rows[D].cells[l].setAttribute("align",t)},Di=function(e){var t=e.trimRight().split(`
`).pop();return t===""?!1:(t.replace(/ |-/g,"")===""||t.replace(/ |_/g,"")===""||t.replace(/ |\*/g,"")==="")&&t.replace(/ /g,"").length>2?!(t.indexOf("-")>-1&&t.trimLeft().indexOf(" ")===-1&&e.trimRight().split(`
`).length>1||t.indexOf("    ")===0||t.indexOf("	")===0):!1},Oi=function(e){var t=e.trimRight().split(`
`);return e=t.pop(),e.indexOf("    ")===0||e.indexOf("	")===0||(e=e.trimLeft(),e===""||t.length===0)?!1:e.replace(/-/g,"")===""||e.replace(/=/g,"")===""},Ce=function(e,t){t===void 0&&(t={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),e.currentMode==="wysiwyg"?Be(e,t):e.currentMode==="ir"?Rt(e,t):e.currentMode==="sv"&&Ge(e,t)},Mr=function(e,t,i,a){var o,l=e.startContainer,S=(0,m._Y)(l,"LI");if(S){if(!(0,u._0)(a)&&!a.altKey&&a.key==="Enter"&&!a.shiftKey&&i&&S.contains(i)&&i.nextElementSibling)return S&&!S.textContent.endsWith(`
`)&&S.insertAdjacentText("beforeend",`
`),e.insertNode(document.createTextNode(`

`)),e.collapse(!1),Ce(t),a.preventDefault(),!0;if(!(0,u._0)(a)&&!a.shiftKey&&!a.altKey&&a.key==="Backspace"&&!S.previousElementSibling&&e.toString()===""&&(0,P.ED)(S,t[t.currentMode].element,e).start===0)return S.nextElementSibling?(S.parentElement.insertAdjacentHTML("beforebegin",'<p data-block="0"><wbr>'.concat(S.innerHTML,"</p>")),S.remove()):S.parentElement.outerHTML='<p data-block="0"><wbr>'.concat(S.innerHTML,"</p>"),(0,P.ir)(t[t.currentMode].element,e),Ce(t),a.preventDefault(),!0;if(!(0,u._0)(a)&&!a.shiftKey&&!a.altKey&&a.key==="Backspace"&&S.textContent.trim().replace(d.Y.ZWSP,"")===""&&e.toString()===""&&((o=S.previousElementSibling)===null||o===void 0?void 0:o.tagName)==="LI")return S.previousElementSibling.insertAdjacentText("beforeend",`

`),e.selectNodeContents(S.previousElementSibling),e.collapse(!1),S.remove(),(0,P.ir)(t[t.currentMode].element,e),Ce(t),a.preventDefault(),!0;if(!(0,u._0)(a)&&!a.altKey&&a.key==="Tab"){var _=!1;if((e.startOffset===0&&(l.nodeType===3&&!l.previousSibling||l.nodeType!==3&&l.nodeName==="LI")||S.classList.contains("vditor-task")&&e.startOffset===1&&l.previousSibling.nodeType!==3&&l.previousSibling.tagName==="INPUT")&&(_=!0),_||e.toString()!=="")return a.shiftKey?Ai(t,S,e,S.parentElement):kr(t,S,e),a.preventDefault(),!0}}return!1},Pi=function(e,t,i){if(e.options.tab&&i.key==="Tab")return i.shiftKey||(t.toString()===""?(t.insertNode(document.createTextNode(e.options.tab)),t.collapse(!1)):(t.extractContents(),t.insertNode(document.createTextNode(e.options.tab)),t.collapse(!1))),(0,P.jl)(t),Ce(e),i.preventDefault(),!0},xr=function(e,t,i,a){if(i){if(!(0,u._0)(e)&&!e.altKey&&e.key==="Enter"){var o=String.raw(Br||(Br=Lo(["",""],["",""])),i.textContent).replace(/\\\|/g,"").trim(),l=o.split("|");if(o.startsWith("|")&&o.endsWith("|")&&l.length>3){var S=l.map(function(){return"---"}).join("|");return S=i.textContent+`
`+S.substring(3,S.length-3)+`
|<wbr>`,i.outerHTML=t.lute.SpinVditorDOM(S),(0,P.ir)(t[t.currentMode].element,a),Ce(t),qe(t),e.preventDefault(),!0}if(Di(i.innerHTML)&&i.previousElementSibling){var _="",D=i.innerHTML.trimRight().split(`
`);return D.length>1&&(D.pop(),_='<p data-block="0">'.concat(D.join(`
`),"</p>")),i.insertAdjacentHTML("afterend","".concat(_,`<hr data-block="0"><p data-block="0"><wbr>
</p>`)),i.remove(),(0,P.ir)(t[t.currentMode].element,a),Ce(t),qe(t),e.preventDefault(),!0}if(Oi(i.innerHTML))return t.currentMode==="wysiwyg"?i.outerHTML=t.lute.SpinVditorDOM(i.innerHTML+`<p data-block="0"><wbr>
</p>`):i.outerHTML=t.lute.SpinVditorIRDOM(i.innerHTML+`<p data-block="0"><wbr>
</p>`),(0,P.ir)(t[t.currentMode].element,a),Ce(t),qe(t),e.preventDefault(),!0}if(a.collapsed&&i.previousElementSibling&&e.key==="Backspace"&&!(0,u._0)(e)&&!e.altKey&&!e.shiftKey&&i.textContent.trimRight().split(`
`).length>1&&(0,P.ED)(i,t[t.currentMode].element,a).start===0){var L=(0,m.Rp)(i.previousElementSibling);return L.textContent.endsWith(`
`)||(L.textContent=L.textContent+`
`),L.parentElement.insertAdjacentHTML("beforeend","<wbr>".concat(i.innerHTML)),i.remove(),(0,P.ir)(t[t.currentMode].element,a),!1}return!1}},_r=function(e,t,i){for(var a="",o=0;o<i.parentElement.childElementCount;o++)a+='<td align="'.concat(i.parentElement.children[o].getAttribute("align"),'"> </td>');i.tagName==="TH"?i.parentElement.parentElement.insertAdjacentHTML("afterend","<tbody><tr>".concat(a,"</tr></tbody>")):i.parentElement.insertAdjacentHTML("afterend","<tr>".concat(a,"</tr>")),Ce(e)},Lr=function(e,t,i){for(var a="",o=0;o<i.parentElement.childElementCount;o++)i.tagName==="TH"?a+='<th align="'.concat(i.parentElement.children[o].getAttribute("align"),'"> </th>'):a+='<td align="'.concat(i.parentElement.children[o].getAttribute("align"),'"> </td>');if(i.tagName==="TH"){i.parentElement.parentElement.insertAdjacentHTML("beforebegin","<thead><tr>".concat(a,"</tr></thead>")),t.insertNode(document.createElement("wbr"));var l=i.parentElement.innerHTML.replace(/<th>/g,"<td>").replace(/<\/th>/g,"</td>");i.parentElement.parentElement.nextElementSibling.insertAdjacentHTML("afterbegin",l),i.parentElement.parentElement.remove(),(0,P.ir)(e.ir.element,t)}else i.parentElement.insertAdjacentHTML("beforebegin","<tr>".concat(a,"</tr>"));Ce(e)},qn=function(e,t,i,a){a===void 0&&(a="afterend");for(var o=0,l=i.previousElementSibling;l;)o++,l=l.previousElementSibling;for(var S=0;S<t.rows.length;S++)S===0?t.rows[S].cells[o].insertAdjacentHTML(a,"<th> </th>"):t.rows[S].cells[o].insertAdjacentHTML(a,"<td> </td>");Ce(e)},Ar=function(e,t,i){if(i.tagName==="TD"){var a=i.parentElement.parentElement;i.parentElement.previousElementSibling?t.selectNodeContents(i.parentElement.previousElementSibling.lastElementChild):t.selectNodeContents(a.previousElementSibling.lastElementChild.lastElementChild),a.childElementCount===1?a.remove():i.parentElement.remove(),t.collapse(!1),(0,P.jl)(t),Ce(e)}},Dr=function(e,t,i,a){for(var o=0,l=a.previousElementSibling;l;)o++,l=l.previousElementSibling;(a.previousElementSibling||a.nextElementSibling)&&(t.selectNodeContents(a.previousElementSibling||a.nextElementSibling),t.collapse(!0));for(var S=0;S<i.rows.length;S++){var _=i.rows[S].cells;if(_.length===1){i.remove(),dn(e);break}_[o].remove()}(0,P.jl)(t),Ce(e)},Or=function(e,t,i){var a=i.startContainer,o=(0,m._Y)(a,"TD")||(0,m._Y)(a,"TH");if(o){if(!(0,u._0)(t)&&!t.altKey&&t.key==="Enter"){(!o.lastElementChild||o.lastElementChild&&(!o.lastElementChild.isSameNode(o.lastChild)||o.lastElementChild.tagName!=="BR"))&&o.insertAdjacentHTML("beforeend","<br>");var l=document.createElement("br");return i.insertNode(l),i.setStartAfter(l),Ce(e),qe(e),t.preventDefault(),!0}if(t.key==="Tab"){if(t.shiftKey)return Tr(o,i),t.preventDefault(),!0;var S=o.nextElementSibling;return S||(o.parentElement.nextElementSibling?S=o.parentElement.nextElementSibling.firstElementChild:o.parentElement.parentElement.tagName==="THEAD"&&o.parentElement.parentElement.nextElementSibling?S=o.parentElement.parentElement.nextElementSibling.firstElementChild.firstElementChild:S=null),S&&(i.selectNodeContents(S),(0,P.jl)(i)),t.preventDefault(),!0}var _=o.parentElement.parentElement.parentElement;if(t.key==="ArrowUp"){if(t.preventDefault(),o.tagName==="TH")return _.previousElementSibling?(i.selectNodeContents(_.previousElementSibling),i.collapse(!1),(0,P.jl)(i)):An(e,"beforebegin"),!0;for(var D=0,L=o.parentElement;D<L.cells.length&&!L.cells[D].isSameNode(o);D++);var I=L.previousElementSibling;return I||(I=L.parentElement.previousElementSibling.firstChild),i.selectNodeContents(I.cells[D]),i.collapse(!1),(0,P.jl)(i),!0}if(t.key==="ArrowDown"){t.preventDefault();var L=o.parentElement;if(!L.nextElementSibling&&o.tagName==="TD")return _.nextElementSibling?(i.selectNodeContents(_.nextElementSibling),i.collapse(!0),(0,P.jl)(i)):An(e,"afterend"),!0;for(var D=0;D<L.cells.length&&!L.cells[D].isSameNode(o);D++);var S=L.nextElementSibling;return S||(S=L.parentElement.nextElementSibling.firstChild),i.selectNodeContents(S.cells[D]),i.collapse(!0),(0,P.jl)(i),!0}if(e.currentMode==="wysiwyg"&&!(0,u._0)(t)&&t.key==="Enter"&&!t.shiftKey&&t.altKey){var B=e.wysiwyg.popover.querySelector(".vditor-input");return B.focus(),B.select(),t.preventDefault(),!0}if(!(0,u._0)(t)&&!t.shiftKey&&!t.altKey&&t.key==="Backspace"&&i.startOffset===0&&i.toString()===""){var Z=Tr(o,i,!1);return!Z&&_&&(_.textContent.trim()===""?(_.outerHTML=`<p data-block="0"><wbr>
</p>`,(0,P.ir)(e[e.currentMode].element,i)):(i.setStartBefore(_),i.collapse(!0)),Ce(e)),t.preventDefault(),!0}if($("⇧⌘F",t))return Lr(e,i,o),t.preventDefault(),!0;if($("⌘=",t))return _r(e,i,o),t.preventDefault(),!0;if($("⇧⌘G",t))return qn(e,_,o,"beforebegin"),t.preventDefault(),!0;if($("⇧⌘=",t))return qn(e,_,o),t.preventDefault(),!0;if($("⌘-",t))return Ar(e,i,o),t.preventDefault(),!0;if($("⇧⌘-",t))return Dr(e,i,_,o),t.preventDefault(),!0;if($("⇧⌘L",t)){if(e.currentMode==="ir")return Vn(_,"left"),Ce(e),t.preventDefault(),!0;var G=e.wysiwyg.popover.querySelector('[data-type="left"]');if(G)return G.click(),t.preventDefault(),!0}if($("⇧⌘C",t)){if(e.currentMode==="ir")return Vn(_,"center"),Ce(e),t.preventDefault(),!0;var G=e.wysiwyg.popover.querySelector('[data-type="center"]');if(G)return G.click(),t.preventDefault(),!0}if($("⇧⌘R",t)){if(e.currentMode==="ir")return Vn(_,"right"),Ce(e),t.preventDefault(),!0;var G=e.wysiwyg.popover.querySelector('[data-type="right"]');if(G)return G.click(),t.preventDefault(),!0}}return!1},Pr=function(e,t,i,a){if(i.tagName==="PRE"&&$("⌘A",t))return a.selectNodeContents(i.firstElementChild),t.preventDefault(),!0;if(e.options.tab&&t.key==="Tab"&&!t.shiftKey&&a.toString()==="")return a.insertNode(document.createTextNode(e.options.tab)),a.collapse(!1),Ce(e),t.preventDefault(),!0;if(t.key==="Backspace"&&!(0,u._0)(t)&&!t.shiftKey&&!t.altKey){var o=(0,P.ED)(i,e[e.currentMode].element,a);if((o.start===0||o.start===1&&i.innerText===`
`)&&a.toString()==="")return i.parentElement.outerHTML='<p data-block="0"><wbr>'.concat(i.firstElementChild.innerHTML,"</p>"),(0,P.ir)(e[e.currentMode].element,a),Ce(e),t.preventDefault(),!0}return!(0,u._0)(t)&&!t.altKey&&t.key==="Enter"?(i.firstElementChild.textContent.endsWith(`
`)||i.firstElementChild.insertAdjacentText("beforeend",`
`),a.extractContents(),a.insertNode(document.createTextNode(`
`)),a.collapse(!1),(0,P.jl)(a),(0,u.gm)()||(e.currentMode==="wysiwyg"?Un(e,a):ue(e,a)),qe(e),t.preventDefault(),!0):!1},Rr=function(e,t,i,a){var o=t.startContainer,l=(0,m._Y)(o,"BLOCKQUOTE");if(l&&t.toString()===""){if(i.key==="Backspace"&&!(0,u._0)(i)&&!i.shiftKey&&!i.altKey&&(0,P.ED)(l,e[e.currentMode].element,t).start===0)return t.insertNode(document.createElement("wbr")),l.outerHTML=l.innerHTML,(0,P.ir)(e[e.currentMode].element,t),Ce(e),i.preventDefault(),!0;if(a&&i.key==="Enter"&&!(0,u._0)(i)&&!i.shiftKey&&!i.altKey&&a.parentElement.tagName==="BLOCKQUOTE"){var S=!1;if(a.innerHTML.replace(d.Y.ZWSP,"")===`
`||a.innerHTML.replace(d.Y.ZWSP,"")===""?(S=!0,a.remove()):a.innerHTML.endsWith(`

`)&&(0,P.ED)(a,e[e.currentMode].element,t).start===a.textContent.length-1&&(a.innerHTML=a.innerHTML.substr(0,a.innerHTML.length-2),S=!0),S)return l.insertAdjacentHTML("afterend",'<p data-block="0">'.concat(d.Y.ZWSP,`<wbr>
</p>`)),(0,P.ir)(e[e.currentMode].element,t),Ce(e),i.preventDefault(),!0}var _=(0,m.pt)(o);if(e.currentMode==="wysiwyg"&&_&&$("⇧⌘;",i))return t.insertNode(document.createElement("wbr")),_.outerHTML='<blockquote data-block="0">'.concat(_.outerHTML,"</blockquote>"),(0,P.ir)(e.wysiwyg.element,t),Be(e),i.preventDefault(),!0;if(Dn(e,i,t,l,l)||fn(e,i,t,l,l))return!0}return!1},Hr=function(e,t,i){var a=t.startContainer,o=(0,m._Y)(a,"li");if(o&&o.classList.contains("vditor-task")){if($("⇧⌘J",i)){var l=o.firstElementChild;return l.checked?l.removeAttribute("checked"):l.setAttribute("checked","checked"),Ce(e),i.preventDefault(),!0}if(i.key==="Backspace"&&!(0,u._0)(i)&&!i.shiftKey&&!i.altKey&&t.toString()===""&&t.startOffset===1&&(a.nodeType===3&&a.previousSibling&&a.previousSibling.tagName==="INPUT"||a.nodeType!==3)){var S=o.previousElementSibling;if(o.querySelector("input").remove(),S){var _=(0,m.Rp)(S);_.parentElement.insertAdjacentHTML("beforeend","<wbr>"+o.innerHTML.trim()),o.remove()}else o.parentElement.insertAdjacentHTML("beforebegin",'<p data-block="0"><wbr>'.concat(o.innerHTML.trim()||`
`,"</p>")),o.nextElementSibling?o.remove():o.parentElement.remove();return(0,P.ir)(e[e.currentMode].element,t),Ce(e),i.preventDefault(),!0}if(i.key==="Enter"&&!(0,u._0)(i)&&!i.shiftKey&&!i.altKey){if(o.textContent.trim()==="")if((0,m.KJ)(o.parentElement,"vditor-task")){var D=(0,m.KR)(a);D&&Ai(e,o,t,D)}else if(o.nextElementSibling){var L="",I="",B=!1;Array.from(o.parentElement.children).forEach(function(se){o.isSameNode(se)?B=!0:B?L+=se.outerHTML:I+=se.outerHTML});var Z=o.parentElement.tagName,G=o.parentElement.tagName==="OL"?"":' data-marker="'.concat(o.parentElement.getAttribute("data-marker"),'"'),W="";I&&(W=o.parentElement.tagName==="UL"?"":' start="1"',I="<".concat(Z,' data-tight="true"').concat(G,' data-block="0">').concat(I,"</").concat(Z,">")),o.parentElement.outerHTML="".concat(I,`<p data-block="0"><wbr>
</p><`).concat(Z,`
 data-tight="true"`).concat(G,' data-block="0"').concat(W,">").concat(L,"</").concat(Z,">")}else o.parentElement.insertAdjacentHTML("afterend",`<p data-block="0"><wbr>
</p>`),o.parentElement.querySelectorAll("li").length===1?o.parentElement.remove():o.remove();else a.nodeType!==3&&t.startOffset===0&&a.firstChild.tagName==="INPUT"?t.setStart(a.childNodes[1],1):(t.setEndAfter(o.lastChild),o.insertAdjacentHTML("afterend",'<li class="vditor-task" data-marker="'.concat(o.getAttribute("data-marker"),'"><input type="checkbox"> <wbr></li>')),document.querySelector("wbr").after(t.extractContents()));return(0,P.ir)(e[e.currentMode].element,t),Ce(e),qe(e),i.preventDefault(),!0}}return!1},Ir=function(e,t,i,a){if(t.startContainer.nodeType!==3){var o=t.startContainer.children[t.startOffset];if(o&&o.tagName==="HR")return t.selectNodeContents(o.previousElementSibling),t.collapse(!1),i.preventDefault(),!0}if(a){var l=a.previousElementSibling;if(l&&(0,P.ED)(a,e[e.currentMode].element,t).start===0&&((0,u.gm)()&&l.tagName==="HR"||l.tagName==="TABLE")){if(l.tagName==="TABLE"){var S=l.lastElementChild.lastElementChild.lastElementChild;S.innerHTML=S.innerHTML.trimLeft()+"<wbr>"+a.textContent.trim(),a.remove()}else l.remove();return(0,P.ir)(e[e.currentMode].element,t),Ce(e),i.preventDefault(),!0}}return!1},Nr=function(e){(0,u.gm)()&&e.startContainer.nodeType!==3&&e.startContainer.tagName==="HR"&&e.setStartBefore(e.startContainer)},jr=function(e,t,i){var a,o;if(!(0,u.gm)())return!1;if(e.key==="ArrowUp"&&t&&((a=t.previousElementSibling)===null||a===void 0?void 0:a.tagName)==="TABLE"){var l=t.previousElementSibling;return i.selectNodeContents(l.rows[l.rows.length-1].lastElementChild),i.collapse(!1),e.preventDefault(),!0}return e.key==="ArrowDown"&&t&&((o=t.nextElementSibling)===null||o===void 0?void 0:o.tagName)==="TABLE"?(i.selectNodeContents(t.nextElementSibling.rows[0].cells[0]),i.collapse(!0),e.preventDefault(),!0):!1},Wn=function(e,t,i){return Ao(void 0,void 0,void 0,function(){var a,o,l,S,_,D,L,I,B,Z,G,W,se,q,Q,q,ve;return Do(this,function(ae){switch(ae.label){case 0:return e[e.currentMode].element.getAttribute("contenteditable")!=="true"?[2]:(t.stopPropagation(),t.preventDefault(),"clipboardData"in t?(a=t.clipboardData.getData("text/html"),o=t.clipboardData.getData("text/plain"),l=t.clipboardData.files):(a=t.dataTransfer.getData("text/html"),o=t.dataTransfer.getData("text/plain"),t.dataTransfer.types.includes("Files")&&(l=t.dataTransfer.items)),S={},_=function(be,je){if(!je)return["",Lute.WalkContinue];if(e.options.upload.renderLinkDest)return e.options.upload.renderLinkDest(e,be,je);var Re=be.TokensStr();if(be.__internal_object__.Parent.Type===34&&Re&&Re.indexOf("file://")===-1&&e.options.upload.linkToImgUrl){var ze=new XMLHttpRequest;ze.open("POST",e.options.upload.linkToImgUrl),e.options.upload.token&&ze.setRequestHeader("X-Upload-Token",e.options.upload.token),e.options.upload.withCredentials&&(ze.withCredentials=!0),wr(e,ze),ze.setRequestHeader("Content-Type","application/json; charset=utf-8"),ze.onreadystatechange=function(){if(ze.readyState===XMLHttpRequest.DONE){if(ze.status===200){var ut=ze.responseText;e.options.upload.linkToImgFormat&&(ut=e.options.upload.linkToImgFormat(ze.responseText));var tt=JSON.parse(ut);if(tt.code!==0){e.tip.show(tt.msg);return}var dt=tt.data.originalURL;if(e.currentMode==="sv")e.sv.element.querySelectorAll(".vditor-sv__marker--link").forEach(function(We){We.textContent===dt&&(We.textContent=tt.data.url)});else{var Ee=e[e.currentMode].element.querySelector('img[src="'.concat(dt,'"]'));Ee.src=tt.data.url,e.currentMode==="ir"&&(Ee.previousElementSibling.previousElementSibling.innerHTML=tt.data.url)}Ce(e)}else e.tip.show(ze.responseText);e.options.upload.linkToImgCallback&&e.options.upload.linkToImgCallback(ze.responseText)}},ze.send(JSON.stringify({url:Re}))}return e.currentMode==="ir"?['<span class="vditor-ir__marker vditor-ir__marker--link">'.concat(Lute.EscapeHTMLStr(Re),"</span>"),Lute.WalkContinue]:e.currentMode==="wysiwyg"?["",Lute.WalkContinue]:['<span class="vditor-sv__marker--link">'.concat(Lute.EscapeHTMLStr(Re),"</span>"),Lute.WalkContinue]},(a.replace(/&amp;/g,"&").replace(/<(|\/)(html|body|meta)[^>]*?>/ig,"").trim()==='<a href="'.concat(o,'">').concat(o,"</a>")||a.replace(/&amp;/g,"&").replace(/<(|\/)(html|body|meta)[^>]*?>/ig,"").trim()==='<!--StartFragment--><a href="'.concat(o,'">').concat(o,"</a><!--EndFragment-->"))&&(a=""),D=new DOMParser().parseFromString(a,"text/html"),D.body&&(a=D.body.innerHTML),a=Lute.Sanitize(a),e.wysiwyg.getComments(e),L=e[e.currentMode].element.scrollHeight,I=Fe(a,o,e.currentMode),B=e.currentMode==="sv"?(0,m.Th)(t.target,"data-type","code-block"):(0,m._Y)(t.target,"CODE"),B?(e.currentMode==="sv"?document.execCommand("insertHTML",!1,o.replace(/&/g,"&amp;").replace(/</g,"&lt;")):(Z=(0,P.ED)(t.target,e[e.currentMode].element),B.parentElement.tagName!=="PRE"&&(o+=d.Y.ZWSP),B.textContent=B.textContent.substring(0,Z.start)+o+B.textContent.substring(Z.end),(0,P.Fm)(Z.start+o.length,Z.start+o.length,B.parentElement),!((ve=B.parentElement)===null||ve===void 0)&&ve.nextElementSibling.classList.contains("vditor-".concat(e.currentMode,"__preview"))&&(B.parentElement.nextElementSibling.innerHTML=B.outerHTML,Pe(B.parentElement.nextElementSibling,e))),[3,8]):[3,1]);case 1:return I?(i.pasteCode(I),[3,8]):[3,2];case 2:return a.trim()===""?[3,3]:(G=document.createElement("div"),G.innerHTML=a,G.querySelectorAll("[style]").forEach(function(be){be.removeAttribute("style")}),G.querySelectorAll(".vditor-copy").forEach(function(be){be.remove()}),e.currentMode==="ir"?(S.HTML2VditorIRDOM={renderLinkDest:_},e.lute.SetJSRenderers({renderers:S}),(0,P.Z2)(e.lute.HTML2VditorIRDOM(G.innerHTML),e)):e.currentMode==="wysiwyg"?(S.HTML2VditorDOM={renderLinkDest:_},e.lute.SetJSRenderers({renderers:S}),(0,P.Z2)(e.lute.HTML2VditorDOM(G.innerHTML),e)):(S.Md2VditorSVDOM={renderLinkDest:_},e.lute.SetJSRenderers({renderers:S}),_i(e,e.lute.HTML2Md(G.innerHTML).trimRight())),e.outline.render(e),[3,8]);case 3:return l.length>0?e.options.upload.url||e.options.upload.handler?[4,Li(e,l)]:[3,5]:[3,7];case 4:return ae.sent(),[3,6];case 5:W=new FileReader,"clipboardData"in t?(l=t.clipboardData.files,se=l[0]):t.dataTransfer.types.includes("Files")&&(l=t.dataTransfer.items,se=l[0].getAsFile()),se&&se.type.startsWith("image")&&(W.readAsDataURL(se),W.onload=function(){var be="";e.currentMode==="wysiwyg"?be+='<img alt="'.concat(se.name,'" src="').concat(W.result.toString(),`">
`):be+="![".concat(se.name,"](").concat(W.result.toString(),`)
`),document.execCommand("insertHTML",!1,be)}),ae.label=6;case 6:return[3,8];case 7:o.trim()!==""&&l.length===0&&(q=(0,P.RN)(e),q.toString()!==""&&e.lute.IsValidLinkDest(o)&&(o="[".concat(q.toString(),"](").concat(o,")")),e.currentMode==="ir"?(S.Md2VditorIRDOM={renderLinkDest:_},e.lute.SetJSRenderers({renderers:S}),(0,P.Z2)(e.lute.Md2VditorIRDOM(o),e)):e.currentMode==="wysiwyg"?(S.Md2VditorDOM={renderLinkDest:_},e.lute.SetJSRenderers({renderers:S}),(0,P.Z2)(e.lute.Md2VditorDOM(o),e)):(S.Md2VditorSVDOM={renderLinkDest:_},e.lute.SetJSRenderers({renderers:S}),_i(e,o)),e.outline.render(e)),ae.label=8;case 8:return e.currentMode!=="sv"&&(Q=(0,m.pt)((0,P.RN)(e).startContainer),Q&&(q=(0,P.RN)(e),e[e.currentMode].element.querySelectorAll("wbr").forEach(function(be){be.remove()}),q.insertNode(document.createElement("wbr")),e.currentMode==="wysiwyg"?Q.outerHTML=e.lute.SpinVditorDOM(Q.outerHTML):Q.outerHTML=e.lute.SpinVditorIRDOM(Q.outerHTML),(0,P.ir)(e[e.currentMode].element,q)),e[e.currentMode].element.querySelectorAll(".vditor-".concat(e.currentMode,"__preview[data-render='2']")).forEach(function(be){Pe(be,e)})),e.wysiwyg.triggerRemoveComment(e),Ce(e),e[e.currentMode].element.scrollHeight-L>Math.min(e[e.currentMode].element.clientHeight,window.innerHeight)/2&&qe(e),[2]}})})},Br,zr=function(e){var t,i;e.hint.render(e);var a=(0,P.RN)(e).startContainer,o=(0,m.Th)(a,"data-type","code-block-info");if(o)if(o.textContent.replace(d.Y.ZWSP,"")===""&&e.hint.recentLanguage){o.textContent=d.Y.ZWSP+e.hint.recentLanguage;var l=(0,P.RN)(e);l.selectNodeContents(o)}else{var S=[],_=o.textContent.substring(0,(0,P.ED)(o,e.ir.element).start).replace(d.Y.ZWSP,"");(e.options.preview.hljs.langs||d.Y.ALIAS_CODE_LANGUAGES.concat(((i=(t=window.hljs)===null||t===void 0?void 0:t.listLanguages())!==null&&i!==void 0?i:[]).sort())).forEach(function(D){D.indexOf(_.toLowerCase())>-1&&S.push({html:D,value:D})}),e.hint.genHTML(S,_,e)}},Rt=function(e,t){t===void 0&&(t={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),t.enableHint&&zr(e),clearTimeout(e.ir.processTimeoutId),e.ir.processTimeoutId=window.setTimeout(function(){if(!e.ir.composingLock){var i=T(e);typeof e.options.input=="function"&&t.enableInput&&e.options.input(i),e.options.counter.enable&&e.counter.render(e,i),e.options.cache.enable&&(0,u.D)()&&(localStorage.setItem(e.options.cache.id,i),e.options.cache.after&&e.options.cache.after(i)),e.devtools&&e.devtools.renderEchart(e),t.enableAddUndoStack&&e.undo.addToUndoStack(e)}},e.options.undoDelay)},On=function(e,t){var i=(0,P.RN)(e),a=(0,m.pt)(i.startContainer)||i.startContainer;if(a){var o=a.querySelector(".vditor-ir__marker--heading");o?o.innerHTML=t:(a.insertAdjacentText("afterbegin",t),i.selectNodeContents(a),i.collapse(!1)),ue(e,i.cloneRange()),st(e)}},Yn=function(e,t,i){var a=(0,m.Th)(e.startContainer,"data-type",i);if(a){a.firstElementChild.remove(),a.lastElementChild.remove(),e.insertNode(document.createElement("wbr"));var o=document.createElement("div");o.innerHTML=t.lute.SpinVditorIRDOM(a.outerHTML),a.outerHTML=o.firstElementChild.innerHTML.trim()}},Ro=function(e,t,i,a){var o=(0,P.RN)(e),l=t.getAttribute("data-type"),S=o.startContainer;S.nodeType===3&&(S=S.parentElement);var _=!0;if(t.classList.contains("vditor-menu--current"))if(l==="quote"){var D=(0,m._Y)(S,"BLOCKQUOTE");D&&(o.insertNode(document.createElement("wbr")),D.outerHTML=D.innerHTML.trim()===""?'<p data-block="0">'.concat(D.innerHTML,"</p>"):D.innerHTML)}else if(l==="link"){var L=(0,m.Th)(o.startContainer,"data-type","a");if(L){var I=(0,m.KJ)(o.startContainer,"vditor-ir__link");I?(o.insertNode(document.createElement("wbr")),L.outerHTML=I.innerHTML):L.outerHTML=L.querySelector(".vditor-ir__link").innerHTML+"<wbr>"}}else l==="italic"?Yn(o,e,"em"):l==="bold"?Yn(o,e,"strong"):l==="strike"?Yn(o,e,"s"):l==="inline-code"?Yn(o,e,"code"):(l==="check"||l==="list"||l==="ordered-list")&&($n(e,o,l),_=!1,t.classList.remove("vditor-menu--current"));else{e.ir.element.childNodes.length===0&&(e.ir.element.innerHTML='<p data-block="0"><wbr></p>',(0,P.ir)(e.ir.element,o));var B=(0,m.pt)(o.startContainer);if(l==="line"){if(B){var Z=`<hr data-block="0"><p data-block="0"><wbr>
</p>`;B.innerHTML.trim()===""?B.outerHTML=Z:B.insertAdjacentHTML("afterend",Z)}}else if(l==="quote")B&&(o.insertNode(document.createElement("wbr")),B.outerHTML='<blockquote data-block="0">'.concat(B.outerHTML,"</blockquote>"),_=!1,t.classList.add("vditor-menu--current"));else if(l==="link"){var G=void 0;o.toString()===""?G="".concat(i,"<wbr>").concat(a):G="".concat(i).concat(o.toString()).concat(a.replace(")","<wbr>)")),document.execCommand("insertHTML",!1,G),_=!1,t.classList.add("vditor-menu--current")}else if(l==="italic"||l==="bold"||l==="strike"||l==="inline-code"||l==="code"||l==="table"){var G=void 0;o.toString()===""?G="".concat(i,"<wbr>").concat(a):(l==="code"?G="".concat(i,`
`).concat(o.toString(),"<wbr>").concat(a):l==="table"?G="".concat(i).concat(o.toString(),"<wbr>").concat(a):G="".concat(i).concat(o.toString()).concat(a,"<wbr>"),o.deleteContents()),(l==="table"||l==="code")&&(G=`
`+G+`

`);var W=document.createElement("span");W.innerHTML=G,o.insertNode(W),ue(e,o),l==="table"&&(o.selectNodeContents(getSelection().getRangeAt(0).startContainer.parentElement),(0,P.jl)(o))}else(l==="check"||l==="list"||l==="ordered-list")&&($n(e,o,l,!1),_=!1,p(e.toolbar.elements,["check","list","ordered-list"]),t.classList.add("vditor-menu--current"))}(0,P.ir)(e.ir.element,o),Rt(e),_&&st(e)},Ho=function(e,t,i,a){function o(l){return l instanceof i?l:new i(function(S){S(l)})}return new(i||(i=Promise))(function(l,S){function _(I){try{L(a.next(I))}catch(B){S(B)}}function D(I){try{L(a.throw(I))}catch(B){S(B)}}function L(I){I.done?l(I.value):o(I.value).then(_,D)}L((a=a.apply(e,t||[])).next())})},Io=function(e,t){var i={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,o,l,S;return S={next:_(0),throw:_(1),return:_(2)},typeof Symbol=="function"&&(S[Symbol.iterator]=function(){return this}),S;function _(L){return function(I){return D([L,I])}}function D(L){if(a)throw new TypeError("Generator is already executing.");for(;S&&(S=0,L[0]&&(i=0)),i;)try{if(a=1,o&&(l=L[0]&2?o.return:L[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,L[1])).done)return l;switch(o=0,l&&(L=[L[0]&2,l.value]),L[0]){case 0:case 1:l=L;break;case 4:return i.label++,{value:L[1],done:!1};case 5:i.label++,o=L[1],L=[0];continue;case 7:L=i.ops.pop(),i.trys.pop();continue;default:if(l=i.trys,!(l=l.length>0&&l[l.length-1])&&(L[0]===6||L[0]===2)){i=0;continue}if(L[0]===3&&(!l||L[1]>l[0]&&L[1]<l[3])){i.label=L[1];break}if(L[0]===6&&i.label<l[1]){i.label=l[1],l=L;break}if(l&&i.label<l[2]){i.label=l[2],i.ops.push(L);break}l[2]&&i.ops.pop(),i.trys.pop();continue}L=t.call(e,i)}catch(I){L=[6,I],o=0}finally{a=l=0}if(L[0]&5)throw L[1];return{value:L[0]?L[1]:void 0,done:!0}}},No=function(){function e(t){var i=this;this.splitChar="",this.lastIndex=-1,this.fillEmoji=function(a,o){i.element.style.display="none";var l=decodeURIComponent(a.getAttribute("data-value")),S=window.getSelection().getRangeAt(0);if(o.currentMode==="ir"){var _=(0,m.Th)(S.startContainer,"data-type","code-block-info");if(_){_.textContent=d.Y.ZWSP+l.trimRight(),S.selectNodeContents(_),S.collapse(!1),Rt(o),_.parentElement.querySelectorAll("code").forEach(function(B){B.className="language-"+l.trimRight()}),Pe(_.parentElement.querySelector(".vditor-ir__preview"),o),i.recentLanguage=l.trimRight();return}}if(o.currentMode==="wysiwyg"&&S.startContainer.nodeType!==3){var D=S.startContainer,L=void 0;if(D.classList.contains("vditor-input")?L=D:L=D.firstElementChild,L&&L.classList.contains("vditor-input")){L.value=l.trimRight(),S.selectNodeContents(L),S.collapse(!1),L.dispatchEvent(new CustomEvent("input",{detail:1})),i.recentLanguage=l.trimRight();return}}if(S.setStart(S.startContainer,i.lastIndex),S.deleteContents(),o.options.hint.parse?o.currentMode==="sv"?(0,P.Z2)(o.lute.SpinVditorSVDOM(l),o):o.currentMode==="wysiwyg"?(0,P.Z2)(o.lute.SpinVditorDOM(l),o):(0,P.Z2)(o.lute.SpinVditorIRDOM(l),o):(0,P.Z2)(l,o),i.splitChar===":"&&l.indexOf(":")>-1&&o.currentMode!=="sv"&&S.insertNode(document.createTextNode(" ")),S.collapse(!1),(0,P.jl)(S),o.currentMode==="wysiwyg"){var I=(0,m.KJ)(S.startContainer,"vditor-wysiwyg__block");I&&I.lastElementChild.classList.contains("vditor-wysiwyg__preview")&&(I.lastElementChild.innerHTML=I.firstElementChild.innerHTML,Pe(I.lastElementChild,o))}else if(o.currentMode==="ir"){var I=(0,m.KJ)(S.startContainer,"vditor-ir__marker--pre");I&&I.nextElementSibling.classList.contains("vditor-ir__preview")&&(I.nextElementSibling.innerHTML=I.innerHTML,Pe(I.nextElementSibling,o))}Ce(o)},this.timeId=-1,this.element=document.createElement("div"),this.element.className="vditor-hint",this.recentLanguage="",t.push({key:":"})}return e.prototype.render=function(t){var i=this;if(window.getSelection().focusNode){var a,o=getSelection().getRangeAt(0);a=o.startContainer.textContent.substring(0,o.startOffset)||"";var l=this.getKey(a,t.options.hint.extend);if(typeof l>"u")this.element.style.display="none",clearTimeout(this.timeId);else if(this.splitChar===":"){var S=l===""?t.options.hint.emoji:t.lute.GetEmojis(),_=[];Object.keys(S).forEach(function(D){D.indexOf(l.toLowerCase())===0&&(S[D].indexOf(".")>-1?_.push({html:'<img src="'.concat(S[D],'" title=":').concat(D,':"/> :').concat(D,":"),value:":".concat(D,":")}):_.push({html:'<span class="vditor-hint__emoji">'.concat(S[D],"</span>").concat(D),value:S[D]}))}),this.genHTML(_,l,t)}else t.options.hint.extend.forEach(function(D){D.key===i.splitChar&&(clearTimeout(i.timeId),i.timeId=window.setTimeout(function(){return Ho(i,void 0,void 0,function(){var L;return Io(this,function(I){switch(I.label){case 0:return L=this.genHTML,[4,D.hint(l)];case 1:return L.apply(this,[I.sent(),l,t]),[2]}})})},t.options.hint.delay))})}},e.prototype.genHTML=function(t,i,a){var o=this;if(t.length===0){this.element.style.display="none";return}var l=a[a.currentMode].element,S=(0,P.Ey)(l),_=S.left+(a.options.outline.position==="left"?a.outline.element.offsetWidth:0),D=S.top,L="";t.forEach(function(B,Z){if(!(Z>7)){var G=B.html;if(i!==""){var W=G.lastIndexOf(">")+1,se=G.substr(W),Q=se.toLowerCase().indexOf(i.toLowerCase());Q>-1&&(se=se.substring(0,Q)+"<b>"+se.substring(Q,Q+i.length)+"</b>"+se.substring(Q+i.length),G=G.substr(0,W)+se)}L+='<button type="button" data-value="'.concat(encodeURIComponent(B.value),` "
`).concat(Z===0?"class='vditor-hint--current'":"","> ").concat(G,"</button>")}}),this.element.innerHTML=L;var I=parseInt(document.defaultView.getComputedStyle(l,null).getPropertyValue("line-height"),10);this.element.style.top="".concat(D+(I||22),"px"),this.element.style.left="".concat(_,"px"),this.element.style.display="block",this.element.style.right="auto",this.element.querySelectorAll("button").forEach(function(B){B.addEventListener("click",function(Z){o.fillEmoji(B,a),Z.preventDefault()})}),this.element.getBoundingClientRect().bottom>window.innerHeight&&(this.element.style.top="".concat(D-this.element.offsetHeight,"px")),this.element.getBoundingClientRect().right>window.innerWidth&&(this.element.style.left="auto",this.element.style.right="0")},e.prototype.select=function(t,i){if(this.element.querySelectorAll("button").length===0||this.element.style.display==="none")return!1;var a=this.element.querySelector(".vditor-hint--current");if(t.key==="ArrowDown")return t.preventDefault(),t.stopPropagation(),a.removeAttribute("class"),a.nextElementSibling?a.nextElementSibling.className="vditor-hint--current":this.element.children[0].className="vditor-hint--current",!0;if(t.key==="ArrowUp"){if(t.preventDefault(),t.stopPropagation(),a.removeAttribute("class"),a.previousElementSibling)a.previousElementSibling.className="vditor-hint--current";else{var o=this.element.children.length;this.element.children[o-1].className="vditor-hint--current"}return!0}else if(!(0,u._0)(t)&&!t.shiftKey&&!t.altKey&&t.key==="Enter"&&!t.isComposing)return t.preventDefault(),t.stopPropagation(),this.fillEmoji(a,i),!0;return!1},e.prototype.getKey=function(t,i){var a=this;this.lastIndex=-1,this.splitChar="",i.forEach(function(L){var I=t.lastIndexOf(L.key);a.lastIndex<I&&(a.splitChar=L.key,a.lastIndex=I)});var o;if(this.lastIndex===-1)return o;var l=t.split(this.splitChar),S=l[l.length-1],_=32;if(l.length>1&&S.trim()===S)if(l.length===2&&l[0]===""&&l[1].length<_)o=l[1];else{var D=l[l.length-2].slice(-1);(0,y.p)(D)===" "&&S.length<_&&(o=S)}return o},e}(),jo=function(){function e(t){this.composingLock=!1;var i=document.createElement("div");i.className="vditor-ir",i.innerHTML='<pre class="vditor-reset" placeholder="'.concat(t.options.placeholder,`"
 contenteditable="true" spellcheck="false"></pre>`),this.element=i.firstElementChild,this.bindEvent(t),Ei(t,this.element),gr(t,this.element),Si(t,this.element),Mi(t,this.element),xi(t,this.element),Ci(t,this.element),Ti(t,this.element,this.copy),ki(t,this.element,this.copy)}return e.prototype.copy=function(t,i){var a=getSelection().getRangeAt(0);if(a.toString()!==""){t.stopPropagation(),t.preventDefault();var o=document.createElement("div");o.appendChild(a.cloneContents()),t.clipboardData.setData("text/plain",i.lute.VditorIRDOM2Md(o.innerHTML).trim()),t.clipboardData.setData("text/html","")}},e.prototype.bindEvent=function(t){var i=this;this.element.addEventListener("paste",function(a){Wn(t,a,{pasteCode:function(o){document.execCommand("insertHTML",!1,o)}})}),this.element.addEventListener("scroll",function(){x(t,["hint"])}),this.element.addEventListener("compositionstart",function(a){i.composingLock=!0}),this.element.addEventListener("compositionend",function(a){(0,u.gm)()||ue(t,getSelection().getRangeAt(0).cloneRange()),i.composingLock=!1}),this.element.addEventListener("input",function(a){if(!(a.inputType==="deleteByDrag"||a.inputType==="insertFromDrop")){if(i.preventInput){i.preventInput=!1,Rt(t,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0});return}i.composingLock||a.data==="‘"||a.data==="“"||a.data==="《"||ue(t,getSelection().getRangeAt(0).cloneRange(),!1,a)}}),this.element.addEventListener("click",function(a){if(a.target.tagName==="INPUT"){a.target.checked?a.target.setAttribute("checked","checked"):a.target.removeAttribute("checked"),i.preventInput=!0,Rt(t);return}var o=(0,P.RN)(t),l=(0,m.KJ)(a.target,"vditor-ir__preview");if(l||(l=(0,m.KJ)(o.startContainer,"vditor-ir__preview")),l&&(l.previousElementSibling.firstElementChild?o.selectNodeContents(l.previousElementSibling.firstElementChild):o.selectNodeContents(l.previousElementSibling),o.collapse(!0),(0,P.jl)(o),qe(t)),a.target.tagName==="IMG"){var S=a.target.parentElement.querySelector(".vditor-ir__marker--link");S&&(o.selectNode(S),(0,P.jl)(o))}var _=(0,m.Th)(a.target,"data-type","a");if(_&&!_.classList.contains("vditor-ir__node--expand")){t.options.link.click?t.options.link.click(_.querySelector(":scope > .vditor-ir__marker--link")):t.options.link.isOpen&&window.open(_.querySelector(":scope > .vditor-ir__marker--link").textContent);return}if(a.target.isEqualNode(i.element)&&i.element.lastElementChild&&o.collapsed){var D=i.element.lastElementChild.getBoundingClientRect();a.y>D.top+D.height&&(i.element.lastElementChild.tagName==="P"&&i.element.lastElementChild.textContent.trim().replace(d.Y.ZWSP,"")===""?(o.selectNodeContents(i.element.lastElementChild),o.collapse(!1)):(i.element.insertAdjacentHTML("beforeend",'<p data-block="0">'.concat(d.Y.ZWSP,"<wbr></p>")),(0,P.ir)(i.element,o)))}o.toString()===""?F(o,t):setTimeout(function(){F((0,P.RN)(t),t)}),U(a,t),st(t)}),this.element.addEventListener("keyup",function(a){if(!(a.isComposing||(0,u._0)(a))){if(a.key==="Enter"&&qe(t),st(t),(a.key==="Backspace"||a.key==="Delete")&&t.ir.element.innerHTML!==""&&t.ir.element.childNodes.length===1&&t.ir.element.firstElementChild&&t.ir.element.firstElementChild.tagName==="P"&&t.ir.element.firstElementChild.childElementCount===0&&(t.ir.element.textContent===""||t.ir.element.textContent===`
`)){t.ir.element.innerHTML="";return}var o=(0,P.RN)(t);a.key==="Backspace"?((0,u.gm)()&&o.startContainer.textContent===`
`&&o.startOffset===1&&(o.startContainer.textContent="",F(o,t)),i.element.querySelectorAll(".language-math").forEach(function(S){var _=S.querySelector("br");_&&_.remove()})):a.key.indexOf("Arrow")>-1?((a.key==="ArrowLeft"||a.key==="ArrowRight")&&zr(t),F(o,t)):a.keyCode===229&&a.code===""&&a.key==="Unidentified"&&F(o,t);var l=(0,m.KJ)(o.startContainer,"vditor-ir__preview");if(l){if(a.key==="ArrowUp"||a.key==="ArrowLeft")return l.previousElementSibling.firstElementChild?o.selectNodeContents(l.previousElementSibling.firstElementChild):o.selectNodeContents(l.previousElementSibling),o.collapse(!1),a.preventDefault(),!0;if(l.tagName==="SPAN"&&(a.key==="ArrowDown"||a.key==="ArrowRight"))return l.parentElement.getAttribute("data-type")==="html-entity"?(l.parentElement.insertAdjacentText("afterend",d.Y.ZWSP),o.setStart(l.parentElement.nextSibling,1)):o.selectNodeContents(l.parentElement.lastElementChild),o.collapse(!1),a.preventDefault(),!0}}})},e}(),Fr=function(e){if(e.currentMode==="sv")return e.lute.Md2HTML(T(e));if(e.currentMode==="wysiwyg")return e.lute.VditorDOM2HTML(e.wysiwyg.element.innerHTML);if(e.currentMode==="ir")return e.lute.VditorIRDOM2HTML(e.ir.element.innerHTML)},Bo=c(796),Ur=c(70),zo=function(){function e(t){this.element=document.createElement("div"),this.element.className="vditor-outline",this.element.innerHTML='<div class="vditor-outline__title">'.concat(t,`</div>
<div class="vditor-outline__content"></div>`)}return e.prototype.render=function(t){var i="";return t.preview.element.style.display==="block"?i=(0,Ur.N)(t.preview.previewElement,this.element.lastElementChild,t):i=(0,Ur.N)(t[t.currentMode].element,this.element.lastElementChild,t),i},e.prototype.toggle=function(t,i,a){var o;i===void 0&&(i=!0),a===void 0&&(a=!0);var l=(o=t.toolbar.elements.outline)===null||o===void 0?void 0:o.firstElementChild;if(i&&window.innerWidth>=d.Y.MOBILE_WIDTH?(this.element.style.display="block",this.render(t),l==null||l.classList.add("vditor-menu--current")):(this.element.style.display="none",l==null||l.classList.remove("vditor-menu--current")),a&&getSelection().rangeCount>0){var S=getSelection().getRangeAt(0);t[t.currentMode].element.contains(S.startContainer)&&(0,P.jl)(S)}it(t)},e}(),Fo=c(0),Uo=function(){function e(t){var i=this;this.element=document.createElement("div"),this.element.className="vditor-preview",this.previewElement=document.createElement("div"),this.previewElement.className="vditor-reset",t.options.classes.preview&&this.previewElement.classList.add(t.options.classes.preview),this.previewElement.style.maxWidth=t.options.preview.maxWidth+"px",this.previewElement.addEventListener("copy",function(D){if(D.target.tagName!=="TEXTAREA"){var L=document.createElement("div");L.className="vditor-reset",L.appendChild(getSelection().getRangeAt(0).cloneContents()),i.copyToX(t,L,"default"),D.preventDefault()}}),this.previewElement.addEventListener("click",function(D){var L=(0,m._Y)(D.target,"SPAN");if(L&&(0,m.KJ)(L,"vditor-toc")){var I=i.previewElement.querySelector("#"+L.getAttribute("data-target-id"));I&&(i.element.scrollTop=I.offsetTop);return}if(D.target.tagName==="A"){t.options.link.click?t.options.link.click(D.target):t.options.link.isOpen&&window.open(D.target.getAttribute("href")),D.preventDefault();return}D.target.tagName==="IMG"&&(t.options.image.preview?t.options.image.preview(D.target):t.options.image.isPreview&&(0,ne.o)(D.target,t.options.lang,t.options.theme))}),this.element.appendChild(this.previewElement);var a=t.options.preview.actions;if(a.length!==0){var o=document.createElement("div");o.className="vditor-preview__action";for(var l=[],S=0;S<a.length;S++){var _=a[S];if(typeof _=="object"){l.push('<button type="button" data-type="'.concat(_.key,'" class="').concat(_.className,'"').concat(_.tooltip?' aria-label="'.concat(_.tooltip,'"'):"",'">').concat(_.text,"</button>"));continue}switch(_){case"desktop":l.push('<button type="button" class="vditor-preview__action--current" data-type="desktop">Desktop</button>');break;case"tablet":l.push('<button type="button" data-type="tablet">Tablet</button>');break;case"mobile":l.push('<button type="button" data-type="mobile">Mobile/Wechat</button>');break;case"mp-wechat":l.push('<button type="button" data-type="mp-wechat" class="vditor-tooltipped vditor-tooltipped__w" aria-label="复制到公众号"><svg><use xlink:href="#vditor-icon-mp-wechat"></use></svg></button>');break;case"zhihu":l.push('<button type="button" data-type="zhihu" class="vditor-tooltipped vditor-tooltipped__w" aria-label="复制到知乎"><svg><use xlink:href="#vditor-icon-zhihu"></use></svg></button>');break}}o.innerHTML=l.join(""),o.addEventListener((0,u.y3)(),function(D){var L=(0,O.f)(D.target,"BUTTON");if(L){var I=L.getAttribute("data-type"),B=a.find(function(Z){return(Z==null?void 0:Z.key)===I});if(B){B.click(I);return}if(I==="mp-wechat"||I==="zhihu"){i.copyToX(t,i.previewElement.cloneNode(!0),I);return}I==="desktop"?i.previewElement.style.width="auto":I==="tablet"?i.previewElement.style.width="780px":i.previewElement.style.width="360px",i.previewElement.scrollWidth>i.previewElement.parentElement.clientWidth&&(i.previewElement.style.width="auto"),i.render(t),o.querySelectorAll("button").forEach(function(Z){Z.classList.remove("vditor-preview__action--current")}),L.classList.add("vditor-preview__action--current")}}),this.element.insertBefore(o,this.previewElement)}}return e.prototype.render=function(t,i){var a=this;if(clearTimeout(this.mdTimeoutId),this.element.style.display==="none"){this.element.getAttribute("data-type")==="renderPerformance"&&t.tip.hide();return}if(i){this.previewElement.innerHTML=i;return}if(T(t).replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")===""){this.previewElement.innerHTML="";return}var o=new Date().getTime(),l=T(t);this.mdTimeoutId=window.setTimeout(function(){if(t.options.preview.url){var S=new XMLHttpRequest;S.open("POST",t.options.preview.url),S.setRequestHeader("Content-Type","application/json;charset=UTF-8"),S.onreadystatechange=function(){if(S.readyState===XMLHttpRequest.DONE)if(S.status===200){var D=JSON.parse(S.responseText);if(D.code!==0){t.tip.show(D.msg);return}t.options.preview.transform&&(D.data=t.options.preview.transform(D.data)),a.previewElement.innerHTML=D.data,a.afterRender(t,o)}else{var L=t.lute.Md2HTML(l);t.options.preview.transform&&(L=t.options.preview.transform(L)),a.previewElement.innerHTML=L,a.afterRender(t,o)}},S.send(JSON.stringify({markdownText:l}))}else{var _=t.lute.Md2HTML(l);t.options.preview.transform&&(_=t.options.preview.transform(_)),a.previewElement.innerHTML=_,a.afterRender(t,o)}},t.options.preview.delay)},e.prototype.afterRender=function(t,i){t.options.preview.parse&&t.options.preview.parse(this.element);var a=new Date().getTime()-i;new Date().getTime()-i>2600?(t.tip.show(window.VditorI18n.performanceTip.replace("${x}",a.toString())),t.preview.element.setAttribute("data-type","renderPerformance")):t.preview.element.getAttribute("data-type")==="renderPerformance"&&(t.tip.hide(),t.preview.element.removeAttribute("data-type"));var o=t.preview.element.querySelector(".vditor-comment--focus");o&&o.classList.remove("vditor-comment--focus"),(0,z.o)(t.preview.previewElement,t.options.preview.hljs),(0,re.$)(t.options.preview.hljs,t.preview.previewElement,t.options.cdn),(0,we.e)(t.preview.previewElement,t.options.cdn,t.options.theme),(0,ge.K)(t.preview.previewElement,t.options.cdn),(0,Ae.Y)(t.preview.previewElement,t.options.cdn,t.options.theme),(0,Y.D)(t.preview.previewElement,t.options.cdn),(0,K.m)(t.preview.previewElement,t.options.cdn),(0,R.v)(t.preview.previewElement,t.options.cdn,t.options.theme),(0,ie.l)(t.preview.previewElement,t.options.cdn,t.options.theme),(0,fe.M)(t.preview.previewElement,t.options.cdn),(0,H.$)(t.preview.previewElement,t.options.cdn),t.options.preview.render.media.enable&&(0,Fo.l)(t.preview.previewElement),t.options.customRenders.forEach(function(_){_.render(t.preview.previewElement,t)});var l=t.preview.element,S=t.outline.render(t);S===""&&(S="[ToC]"),l.querySelectorAll('[data-type="toc-block"]').forEach(function(_){_.innerHTML=S,(0,pe.T)(_,{cdn:t.options.cdn,math:t.options.preview.math})}),(0,pe.T)(t.preview.previewElement,{cdn:t.options.cdn,math:t.options.preview.math})},e.prototype.copyToX=function(t,i,a){a===void 0&&(a="mp-wechat"),a!=="zhihu"?i.querySelectorAll(".katex-html .base").forEach(function(l){l.style.display="initial"}):i.querySelectorAll(".language-math").forEach(function(l){l.outerHTML='<img class="Formula-image" data-eeimg="true" src="//www.zhihu.com/equation?tex=" alt="'.concat(l.getAttribute("data-math"),'\\" style="display: block; margin: 0 auto; max-width: 100%;">')}),i.style.backgroundColor="#fff",i.querySelectorAll("code").forEach(function(l){l.style.backgroundImage="none"}),this.element.append(i);var o=i.ownerDocument.createRange();o.selectNode(i),(0,P.jl)(o),document.execCommand("copy"),i.remove(),t.tip.show(["zhihu","mp-wechat"].includes(a)?"已复制，可到".concat(a==="zhihu"?"知乎":"微信公众号平台","进行粘贴"):"已复制到剪切板")},e}(),$o=function(){function e(t){this.element=document.createElement("div"),this.element.className="vditor-resize vditor-resize--".concat(t.options.resize.position),this.element.innerHTML='<div><svg><use xlink:href="#vditor-icon-resize"></use></svg></div>',this.bindEvent(t)}return e.prototype.bindEvent=function(t){var i=this;this.element.addEventListener("mousedown",function(a){var o=document,l=a.clientY,S=t.element.offsetHeight,_=63+t.element.querySelector(".vditor-toolbar").clientHeight;o.ondragstart=function(){return!1},window.captureEvents&&window.captureEvents(),i.element.classList.add("vditor-resize--selected"),o.onmousemove=function(D){t.options.resize.position==="top"?t.element.style.height=Math.max(_,S+(l-D.clientY))+"px":t.element.style.height=Math.max(_,S+(D.clientY-l))+"px",t.options.typewriterMode&&(t.sv.element.style.paddingBottom=t.sv.element.parentElement.offsetHeight/2+"px")},o.onmouseup=function(){t.options.resize.after&&t.options.resize.after(t.element.offsetHeight-S),window.captureEvents&&window.captureEvents(),o.onmousemove=null,o.onmouseup=null,o.ondragstart=null,o.onselectstart=null,o.onselect=null,i.element.classList.remove("vditor-resize--selected")}})},e}(),Vo=function(){function e(t){this.composingLock=!1,this.element=document.createElement("pre"),this.element.className="vditor-sv vditor-reset",this.element.setAttribute("placeholder",t.options.placeholder),this.element.setAttribute("contenteditable","true"),this.element.setAttribute("spellcheck","false"),this.bindEvent(t),Ei(t,this.element),Si(t,this.element),Mi(t,this.element),xi(t,this.element),Ci(t,this.element),Ti(t,this.element,this.copy),ki(t,this.element,this.copy)}return e.prototype.copy=function(t,i){t.stopPropagation(),t.preventDefault(),t.clipboardData.setData("text/plain",Ln(i[i.currentMode].element))},e.prototype.bindEvent=function(t){var i=this;this.element.addEventListener("paste",function(a){Wn(t,a,{pasteCode:function(o){document.execCommand("insertHTML",!1,o)}})}),this.element.addEventListener("scroll",function(){if(t.preview.element.style.display==="block"){var a=i.element.scrollTop,o=i.element.clientHeight,l=i.element.scrollHeight-parseFloat(i.element.style.paddingBottom||"0"),S=t.preview.element;a/o>.5?S.scrollTop=(a+o)*S.scrollHeight/l-o:S.scrollTop=a*S.scrollHeight/l}}),this.element.addEventListener("compositionstart",function(a){i.composingLock=!0}),this.element.addEventListener("compositionend",function(a){(0,u.gm)()||Me(t,a),i.composingLock=!1}),this.element.addEventListener("input",function(a){if(!(a.inputType==="deleteByDrag"||a.inputType==="insertFromDrop")&&!(i.composingLock||a.data==="‘"||a.data==="“"||a.data==="《")){if(i.preventInput){i.preventInput=!1,Ge(t,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0});return}Me(t,a)}}),this.element.addEventListener("keyup",function(a){if(!(a.isComposing||(0,u._0)(a))){if((a.key==="Backspace"||a.key==="Delete")&&t.sv.element.innerHTML!==""&&t.sv.element.childNodes.length===1&&t.sv.element.firstElementChild&&t.sv.element.firstElementChild.tagName==="DIV"&&t.sv.element.firstElementChild.childElementCount===2&&(t.sv.element.firstElementChild.textContent===""||t.sv.element.textContent===`
`)){t.sv.element.innerHTML="";return}a.key==="Enter"&&qe(t)}})},e}(),$r=function(){function e(){this.element=document.createElement("div"),this.element.className="vditor-tip"}return e.prototype.show=function(t,i){var a=this;i===void 0&&(i=6e3),this.element.className="vditor-tip vditor-tip--show",i===0?(this.element.innerHTML='<div class="vditor-tip__content">'.concat(t,`
<div class="vditor-tip__close">X</div></div>`),this.element.querySelector(".vditor-tip__close").addEventListener("click",function(){a.hide()})):(this.element.innerHTML='<div class="vditor-tip__content">'.concat(t,"</div>"),setTimeout(function(){a.hide()},i)),this.element.removeAttribute("style"),setTimeout(function(){var o=a.element.getBoundingClientRect();o.top<46&&(a.element.style.position="fixed",a.element.style.top="46px")},150)},e.prototype.hide=function(){this.element.className="vditor-messageElementtip",this.element.innerHTML=""},e}(),Ri=function(e,t){if(t.options.preview.mode!==e){switch(t.options.preview.mode=e,e){case"both":t.sv.element.style.display="block",t.preview.element.style.display="block",t.preview.render(t),v(t.toolbar.elements,["both"]);break;case"editor":t.sv.element.style.display="block",t.preview.element.style.display="none",p(t.toolbar.elements,["both"]);break}t.devtools&&t.devtools.renderEchart(t)}},qo=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Wo=function(e){qo(t,e);function t(i,a){var o=e.call(this,i,a)||this;return i.options.preview.mode==="both"&&o.element.children[0].classList.add("vditor-menu--current"),o.element.children[0].addEventListener((0,u.y3)(),function(l){var S=o.element.firstElementChild;S.classList.contains(d.Y.CLASS_MENU_DISABLED)||(l.preventDefault(),i.currentMode==="sv"&&(i.options.preview.mode==="both"?Ri("editor",i):Ri("both",i)))}),o}return t}($e),Yo=function(){function e(){this.element=document.createElement("div"),this.element.className="vditor-toolbar__br"}return e}(),Vr=c(13),Ko=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Go=function(e){Ko(t,e);function t(i,a){var o=e.call(this,i,a)||this,l=o.element.children[0],S=document.createElement("div");S.className="vditor-hint".concat(a.level===2?"":" vditor-panel--arrow");var _="";return d.Y.CODE_THEME.forEach(function(D){_+="<button>".concat(D,"</button>")}),S.innerHTML='<div style="overflow: auto;max-height:'.concat(window.innerHeight/2,'px">').concat(_,"</div>"),S.addEventListener((0,u.y3)(),function(D){D.target.tagName==="BUTTON"&&(x(i,["subToolbar"]),i.options.preview.hljs.style=D.target.textContent,(0,Vr.h)(D.target.textContent,i.options.cdn),D.preventDefault(),D.stopPropagation())}),o.element.appendChild(S),A(i,S,l,a.level),o}return t}($e),Zo=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Xo=function(e){Zo(t,e);function t(i,a){var o=e.call(this,i,a)||this,l=o.element.children[0],S=document.createElement("div");S.className="vditor-hint".concat(a.level===2?"":" vditor-panel--arrow");var _="";return Object.keys(i.options.preview.theme.list).forEach(function(D){_+='<button data-type="'.concat(D,'">').concat(i.options.preview.theme.list[D],"</button>")}),S.innerHTML='<div style="overflow: auto;max-height:'.concat(window.innerHeight/2,'px">').concat(_,"</div>"),S.addEventListener((0,u.y3)(),function(D){D.target.tagName==="BUTTON"&&(x(i,["subToolbar"]),i.options.preview.theme.current=D.target.getAttribute("data-type"),(0,ye.H)(i.options.preview.theme.current,i.options.preview.theme.path),D.preventDefault(),D.stopPropagation())}),o.element.appendChild(S),A(i,S,l,a.level),o}return t}($e),Jo=function(){function e(t){this.element=document.createElement("span"),this.element.className="vditor-counter vditor-tooltipped vditor-tooltipped__nw",this.render(t,"")}return e.prototype.render=function(t,i){var a=i.endsWith(`
`)?i.length-1:i.length;if(t.options.counter.type==="text"&&t[t.currentMode]){var o=t[t.currentMode].element.cloneNode(!0);o.querySelectorAll(".vditor-wysiwyg__preview").forEach(function(l){l.remove()}),a=o.textContent.length}typeof t.options.counter.max=="number"?(a>t.options.counter.max?this.element.className="vditor-counter vditor-counter--error":this.element.className="vditor-counter",this.element.innerHTML="".concat(a,"/").concat(t.options.counter.max)):this.element.innerHTML="".concat(a),this.element.setAttribute("aria-label",t.options.counter.type),t.options.counter.after&&t.options.counter.after(a,{enable:t.options.counter.enable,max:t.options.counter.max,type:t.options.counter.type})},e}(),Qo=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),es=function(e){Qo(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o.element.children[0].innerHTML=a.icon,o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),!l.currentTarget.classList.contains(d.Y.CLASS_MENU_DISABLED)&&a.click(l,i)}),o}return t}($e),ts=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),ns=function(e){ts(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o.element.firstElementChild.addEventListener((0,u.y3)(),function(l){var S=o.element.firstElementChild;S.classList.contains(d.Y.CLASS_MENU_DISABLED)||(l.preventDefault(),S.classList.contains("vditor-menu--current")?(S.classList.remove("vditor-menu--current"),i.devtools.element.style.display="none",it(i)):(S.classList.add("vditor-menu--current"),i.devtools.element.style.display="block",it(i),i.devtools.renderEchart(i)))}),o}return t}($e),is=function(){function e(){this.element=document.createElement("div"),this.element.className="vditor-toolbar__divider"}return e}(),rs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),as=function(e){rs(t,e);function t(i,a){var o=e.call(this,i,a)||this,l=document.createElement("div");l.className="vditor-panel vditor-panel--arrow";var S="";return Object.keys(i.options.hint.emoji).forEach(function(_){var D=i.options.hint.emoji[_];D.indexOf(".")>-1?S+='<button data-value=":'.concat(_,': " data-key=":').concat(_,`:"><img
data-value=":`).concat(_,': " data-key=":').concat(_,':" class="vditor-emojis__icon" src="').concat(D,'"/></button>'):S+='<button data-value="'.concat(D,` "
 data-key="`).concat(_,'"><span class="vditor-emojis__icon">').concat(D,"</span></button>")}),l.innerHTML='<div class="vditor-emojis" style="max-height: '.concat(i.options.height==="auto"?"auto":i.options.height-80,'px">').concat(S,`</div><div class="vditor-emojis__tail">
    <span class="vditor-emojis__tip"></span><span>`).concat(i.options.hint.emojiTail||"",`</span>
</div>`),o.element.appendChild(l),A(i,l,o.element.firstElementChild,a.level),o.bindEvent(i),o}return t.prototype.bindEvent=function(i){var a=this;this.element.lastElementChild.addEventListener((0,u.y3)(),function(o){var l=(0,O.f)(o.target,"BUTTON");if(l){o.preventDefault();var S=l.getAttribute("data-value"),_=(0,P.RN)(i),D=S;if(i.currentMode==="wysiwyg"?D=i.lute.SpinVditorDOM(S):i.currentMode==="ir"&&(D=i.lute.SpinVditorIRDOM(S)),S.indexOf(":")>-1&&i.currentMode!=="sv"){var L=document.createElement("div");L.innerHTML=D,D=L.firstElementChild.firstElementChild.outerHTML+" ",(0,P.Z2)(D,i)}else _.extractContents(),_.insertNode(document.createTextNode(S)),(0,m.pt)(_.startContainer)||yi(i,_);_.collapse(!1),(0,P.jl)(_),a.element.lastElementChild.style.display="none",Ce(i)}}),this.element.lastElementChild.addEventListener("mouseover",function(o){var l=(0,O.f)(o.target,"BUTTON");l&&(a.element.querySelector(".vditor-emojis__tip").innerHTML=l.getAttribute("data-key"))})},t}($e),qr=function(e,t,i){var a=document.createElement("a");"download"in a?(a.download=i,a.style.display="none",a.href=URL.createObjectURL(new Blob([t])),document.body.appendChild(a),a.click(),a.remove()):e.tip.show(window.VditorI18n.downloadTip,0)},os=function(e){var t=T(e);qr(e,t,t.substr(0,10)+".md")},ss=function(e){e.tip.show(window.VditorI18n.generate,3800);var t=document.querySelector("#vditorExportIframe");t.contentDocument.open(),t.contentDocument.write('<link rel="stylesheet" href="'.concat(e.options.cdn,`/dist/index.css"/>
<script src="`).concat(e.options.cdn,`/dist/method.min.js"><\/script>
<div id="preview" style="width: 800px"></div>
<script>
window.addEventListener("message", (e) => {
  if(!e.data) {
    return;
  }
  Vditor.preview(document.getElementById('preview'), e.data, {
    cdn: "`).concat(e.options.cdn,`",
    markdown: {
      theme: `).concat(JSON.stringify(e.options.preview.theme),`
    },
    hljs: {
      style: "`).concat(e.options.preview.hljs.style,`"
    }
  });
  setTimeout(() => {
        window.print();
    }, 3600);
}, false);
<\/script>`)),t.contentDocument.close(),setTimeout(function(){t.contentWindow.postMessage(T(e),"*")},200)},ls=function(e){var t=Fr(e),i='<html><head><link rel="stylesheet" type="text/css" href="'.concat(e.options.cdn,`/dist/index.css"/>
<script src="`).concat(e.options.cdn,"/dist/js/i18n/").concat(e.options.lang,`.js"><\/script>
<script src="`).concat(e.options.cdn,`/dist/method.min.js"><\/script></head>
<body><div class="vditor-reset" id="preview">`).concat(t,`</div>
<script>
    const previewElement = document.getElementById('preview')
    Vditor.setContentTheme('`).concat(e.options.preview.theme.current,"', '").concat(e.options.preview.theme.path,`');
    Vditor.codeRender(previewElement);
    Vditor.highlightRender(`).concat(JSON.stringify(e.options.preview.hljs),", previewElement, '").concat(e.options.cdn,`');
    Vditor.mathRender(previewElement, {
        cdn: '`).concat(e.options.cdn,`',
        math: `).concat(JSON.stringify(e.options.preview.math),`,
    });
    Vditor.mermaidRender(previewElement, '`).concat(e.options.cdn,"', '").concat(e.options.theme,`');
    Vditor.SMILESRender(previewElement, '`).concat(e.options.cdn,"', '").concat(e.options.theme,`');
    Vditor.markmapRender(previewElement, '`).concat(e.options.cdn,`');
    Vditor.flowchartRender(previewElement, '`).concat(e.options.cdn,`');
    Vditor.graphvizRender(previewElement, '`).concat(e.options.cdn,`');
    Vditor.chartRender(previewElement, '`).concat(e.options.cdn,"', '").concat(e.options.theme,`');
    Vditor.mindmapRender(previewElement, '`).concat(e.options.cdn,"', '").concat(e.options.theme,`');
    Vditor.abcRender(previewElement, '`).concat(e.options.cdn,`');
    `).concat(e.options.preview.render.media.enable?"Vditor.mediaRender(previewElement);":"",`
    Vditor.speechRender(previewElement);
<\/script>
<script src="`).concat(e.options.cdn,"/dist/js/icons/").concat(e.options.icon,'.js"><\/script></body></html>');qr(e,i,t.substr(0,10)+".html")},cs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),us=function(e){cs(t,e);function t(i,a){var o=e.call(this,i,a)||this,l=o.element.children[0],S=document.createElement("div");return S.className="vditor-hint".concat(a.level===2?"":" vditor-panel--arrow"),S.innerHTML=`<button data-type="markdown">Markdown</button>
<button data-type="pdf">PDF</button>
<button data-type="html">HTML</button>`,S.addEventListener((0,u.y3)(),function(_){var D=_.target;if(D.tagName==="BUTTON"){switch(D.getAttribute("data-type")){case"markdown":os(i);break;case"pdf":ss(i);break;case"html":ls(i);break}x(i,["subToolbar"]),_.preventDefault(),_.stopPropagation()}}),o.element.appendChild(S),A(i,S,l,a.level),o}return t}($e),ds=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),fs=function(e){ds(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o._bindEvent(i,a),o}return t.prototype._bindEvent=function(i,a){this.element.children[0].addEventListener((0,u.y3)(),function(o){o.preventDefault(),i.element.className.includes("vditor--fullscreen")?(a.level||(this.innerHTML=a.icon),i.element.style.zIndex="",document.body.style.overflow="",i.element.classList.remove("vditor--fullscreen"),Object.keys(i.toolbar.elements).forEach(function(l){var S=i.toolbar.elements[l].firstChild;S&&(S.className=S.className.replace("__s","__n"),i.options.toolbar.forEach(function(_){typeof _!="string"&&_.tipPosition&&_.name===S.dataset.type&&(S.className="vditor-tooltipped vditor-tooltipped__".concat(_.tipPosition))}))}),i.counter&&(i.counter.element.className=i.counter.element.className.replace("__s","__n"))):(a.level||(this.innerHTML='<svg><use xlink:href="#vditor-icon-contract"></use></svg>'),i.element.style.zIndex=i.options.fullscreen.index.toString(),document.body.style.overflow="hidden",i.element.classList.add("vditor--fullscreen"),Object.keys(i.toolbar.elements).forEach(function(l){var S=i.toolbar.elements[l].firstChild;S&&(S.className=S.className.replace("__n","__s"))}),i.counter&&(i.counter.element.className=i.counter.element.className.replace("__n","__s"))),i.devtools&&i.devtools.renderEchart(i),a.click&&a.click(o,i),it(i),Ke(i)})},t}($e),hs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),ps=function(e){hs(t,e);function t(i,a){var o=e.call(this,i,a)||this,l=document.createElement("div");return l.className="vditor-hint vditor-panel--arrow",l.innerHTML='<button data-tag="h1" data-value="# ">'.concat(window.VditorI18n.heading1," ").concat((0,u.fG)("&lt;⌥⌘1>"),`</button>
<button data-tag="h2" data-value="## ">`).concat(window.VditorI18n.heading2," &lt;").concat((0,u.fG)("⌥⌘2"),`></button>
<button data-tag="h3" data-value="### ">`).concat(window.VditorI18n.heading3," &lt;").concat((0,u.fG)("⌥⌘3"),`></button>
<button data-tag="h4" data-value="#### ">`).concat(window.VditorI18n.heading4," &lt;").concat((0,u.fG)("⌥⌘4"),`></button>
<button data-tag="h5" data-value="##### ">`).concat(window.VditorI18n.heading5," &lt;").concat((0,u.fG)("⌥⌘5"),`></button>
<button data-tag="h6" data-value="###### ">`).concat(window.VditorI18n.heading6," &lt;").concat((0,u.fG)("⌥⌘6"),"></button>"),o.element.appendChild(l),o._bindEvent(i,l),o}return t.prototype._bindEvent=function(i,a){var o=this.element.children[0];o.addEventListener((0,u.y3)(),function(S){S.preventDefault(),clearTimeout(i.wysiwyg.afterRenderTimeoutId),clearTimeout(i.ir.processTimeoutId),clearTimeout(i.sv.processTimeoutId),!o.classList.contains(d.Y.CLASS_MENU_DISABLED)&&(o.blur(),o.classList.contains("vditor-menu--current")?(i.currentMode==="wysiwyg"?(bi(i),Be(i)):i.currentMode==="ir"&&On(i,""),o.classList.remove("vditor-menu--current")):(x(i,["subToolbar"]),a.style.display="block"))});for(var l=0;l<6;l++)a.children.item(l).addEventListener((0,u.y3)(),function(S){S.preventDefault(),i.currentMode==="wysiwyg"?(zn(i,S.target.getAttribute("data-tag")),Be(i),o.classList.add("vditor-menu--current")):i.currentMode==="ir"?(On(i,S.target.getAttribute("data-value")),o.classList.add("vditor-menu--current")):yr(i,S.target.getAttribute("data-value")),a.style.display="none"})},t}($e),ms=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),gs=function(e){ms(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),i.tip.show(`<div style="margin-bottom:14px;font-size: 14px;line-height: 22px;min-width:300px;max-width: 360px;display: flex;">
<div style="margin-top: 14px;flex: 1">
    <div>Markdown 使用指南</div>
    <ul style="list-style: none">
        <li><a href="https://ld246.com/article/1583308420519" target="_blank">语法速查手册</a></li>
        <li><a href="https://ld246.com/article/1583129520165" target="_blank">基础语法</a></li>
        <li><a href="https://ld246.com/article/1583305480675" target="_blank">扩展语法</a></li>
        <li><a href="https://ld246.com/article/1582778815353" target="_blank">键盘快捷键</a></li>
    </ul>
</div>
<div style="margin-top: 14px;flex: 1">
    <div>Vditor 支持</div>
    <ul style="list-style: none">
        <li><a href="https://github.com/Vanessa219/vditor/issues" target="_blank">Issues</a></li>
        <li><a href="https://ld246.com/tag/vditor" target="_blank">官方讨论区</a></li>
        <li><a href="https://ld246.com/article/1549638745630" target="_blank">开发手册</a></li>
        <li><a href="https://ld246.com/guide/markdown" target="_blank">演示地址</a></li>
    </ul>
</div></div>`,0)}),o}return t}($e),vs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),ys=function(e){vs(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o.element.children[0].addEventListener((0,u.y3)(),function(l){if(l.preventDefault(),!(o.element.firstElementChild.classList.contains(d.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")){var S=(0,P.RN)(i),_=(0,m._Y)(S.startContainer,"LI");_&&kr(i,_,S)}}),o}return t}($e),bs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),ws=function(e){bs(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),i.tip.show(`<div style="max-width: 520px; font-size: 14px;line-height: 22px;margin-bottom: 14px;">
<p style="text-align: center;margin: 14px 0">
    <em>下一代的 Markdown 编辑器，为未来而构建</em>
</p>
<div style="display: flex;margin-bottom: 14px;flex-wrap: wrap;align-items: center">
    <img src="https://unpkg.com/vditor/dist/images/logo.png" style="margin: 0 auto;height: 68px"/>
    <div>&nbsp;&nbsp;</div>
    <div style="flex: 1;min-width: 250px">
        Vditor 是一款浏览器端的 Markdown 编辑器，支持所见即所得、即时渲染（类似 Typora）和分屏预览模式。
        它使用 TypeScript 实现，支持原生 JavaScript 以及 Vue、React、Angular 和 Svelte 等框架。
    </div>
</div>
<div style="display: flex;flex-wrap: wrap;">
    <ul style="list-style: none;flex: 1;min-width:148px">
        <li>
        项目地址：<a href="https://b3log.org/vditor" target="_blank">b3log.org/vditor</a>
        </li>
        <li>
        开源协议：MIT
        </li>
    </ul>
    <ul style="list-style: none;margin-right: 18px">
        <li>
        组件版本：Vditor v`.concat(d.g," / Lute v").concat(Lute.Version,`
        </li>
        <li>
        赞助捐赠：<a href="https://ld246.com/sponsor" target="_blank">https://ld246.com/sponsor</a>
        </li>
    </ul>
</div>
</div>`),0)}),o}return t}($e),Es=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Ss=function(e){Es(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),!(o.element.firstElementChild.classList.contains(d.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")&&An(i,"afterend")}),o}return t}($e),Cs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Ts=function(e){Cs(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),!(o.element.firstElementChild.classList.contains(d.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")&&An(i,"beforebegin")}),o}return t}($e),ks=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Ms=function(e){ks(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o.element.children[0].addEventListener((0,u.y3)(),function(l){if(l.preventDefault(),!(o.element.firstElementChild.classList.contains(d.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")){var S=(0,P.RN)(i),_=(0,m._Y)(S.startContainer,"LI");_&&Ai(i,_,S,_.parentElement)}}),o}return t}($e),xs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),_s=function(e){xs(t,e);function t(i,a){var o=e.call(this,i,a)||this;return i.options.outline&&o.element.firstElementChild.classList.add("vditor-menu--current"),o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault();var S=i.toolbar.elements.outline.firstElementChild;S.classList.contains(d.Y.CLASS_MENU_DISABLED)||(i.options.outline.enable=!o.element.firstElementChild.classList.contains("vditor-menu--current"),i.outline.toggle(i,i.options.outline.enable))}),o}return t}($e),Ls=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),As=function(e){Ls(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o._bindEvent(i),o}return t.prototype._bindEvent=function(i){var a=this;this.element.children[0].addEventListener((0,u.y3)(),function(o){o.preventDefault();var l=a.element.firstElementChild;if(!l.classList.contains(d.Y.CLASS_MENU_DISABLED)){var S=d.Y.EDIT_TOOLBARS.concat(["both","edit-mode","devtools"]);l.classList.contains("vditor-menu--current")?(l.classList.remove("vditor-menu--current"),i.currentMode==="sv"?(i.sv.element.style.display="block",i.options.preview.mode==="both"?i.preview.element.style.display="block":i.preview.element.style.display="none"):(i[i.currentMode].element.parentElement.style.display="block",i.preview.element.style.display="none"),E(i.toolbar.elements,S),i.outline.render(i)):(b(i.toolbar.elements,S),i.preview.element.style.display="block",i.currentMode==="sv"?i.sv.element.style.display="none":i[i.currentMode].element.parentElement.style.display="none",i.preview.render(i),l.classList.add("vditor-menu--current"),x(i,["subToolbar","hint","popover"]),setTimeout(function(){i.outline.render(i)},i.options.preview.delay+10)),it(i)}})},t}($e),Ds=function(){function e(t){this.SAMPLE_RATE=5e3,this.isRecording=!1,this.readyFlag=!1,this.leftChannel=[],this.rightChannel=[],this.recordingLength=0;var i;if(typeof AudioContext<"u")i=new AudioContext;else if(webkitAudioContext)i=new webkitAudioContext;else return;this.DEFAULT_SAMPLE_RATE=i.sampleRate;var a=i.createGain(),o=i.createMediaStreamSource(t);o.connect(a),this.recorder=i.createScriptProcessor(2048,2,1),this.recorder.onaudioprocess=null,a.connect(this.recorder),this.recorder.connect(i.destination),this.readyFlag=!0}return e.prototype.cloneChannelData=function(t,i){this.leftChannel.push(new Float32Array(t)),this.rightChannel.push(new Float32Array(i)),this.recordingLength+=2048},e.prototype.startRecordingNewWavFile=function(){this.readyFlag&&(this.isRecording=!0,this.leftChannel.length=this.rightChannel.length=0,this.recordingLength=0)},e.prototype.stopRecording=function(){this.isRecording=!1},e.prototype.buildWavFileBlob=function(){for(var t=this.mergeBuffers(this.leftChannel),i=this.mergeBuffers(this.rightChannel),a=new Float32Array(t.length),o=0;o<t.length;++o)a[o]=.5*(t[o]+i[o]);this.DEFAULT_SAMPLE_RATE>this.SAMPLE_RATE&&(a=this.downSampleBuffer(a,this.SAMPLE_RATE));var l=44+a.length*2,S=new ArrayBuffer(l),_=new DataView(S);this.writeUTFBytes(_,0,"RIFF"),_.setUint32(4,l,!0),this.writeUTFBytes(_,8,"WAVE"),this.writeUTFBytes(_,12,"fmt "),_.setUint32(16,16,!0),_.setUint16(20,1,!0),_.setUint16(22,1,!0),_.setUint32(24,this.SAMPLE_RATE,!0),_.setUint32(28,this.SAMPLE_RATE*2,!0),_.setUint16(32,2,!0),_.setUint16(34,16,!0);var D=a.length*2;this.writeUTFBytes(_,36,"data"),_.setUint32(40,D,!0);for(var L=a.length,I=44,B=1,Z=0;Z<L;Z++)_.setInt16(I,a[Z]*(32767*B),!0),I+=2;return new Blob([_],{type:"audio/wav"})},e.prototype.downSampleBuffer=function(t,i){if(i===this.DEFAULT_SAMPLE_RATE||i>this.DEFAULT_SAMPLE_RATE)return t;for(var a=this.DEFAULT_SAMPLE_RATE/i,o=Math.round(t.length/a),l=new Float32Array(o),S=0,_=0;S<l.length;){for(var D=Math.round((S+1)*a),L=0,I=0,B=_;B<D&&B<t.length;B++)L+=t[B],I++;l[S]=L/I,S++,_=D}return l},e.prototype.mergeBuffers=function(t){for(var i=new Float32Array(this.recordingLength),a=0,o=t.length,l=0;l<o;++l){var S=t[l];i.set(S,a),a+=S.length}return i},e.prototype.writeUTFBytes=function(t,i,a){for(var o=a.length,l=0;l<o;l++)t.setUint8(i+l,a.charCodeAt(l))},e}(),Os=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Ps=function(e){Os(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o._bindEvent(i),o}return t.prototype._bindEvent=function(i){var a=this,o;this.element.children[0].addEventListener((0,u.y3)(),function(l){if(l.preventDefault(),!a.element.firstElementChild.classList.contains(d.Y.CLASS_MENU_DISABLED)){var S=i[i.currentMode].element;if(!o){navigator.mediaDevices.getUserMedia({audio:!0}).then(function(D){o=new Ds(D),o.recorder.onaudioprocess=function(L){if(o.isRecording){var I=L.inputBuffer.getChannelData(0),B=L.inputBuffer.getChannelData(1);o.cloneChannelData(I,B)}},o.startRecordingNewWavFile(),i.tip.show(window.VditorI18n.recording),S.setAttribute("contenteditable","false"),a.element.children[0].classList.add("vditor-menu--current")}).catch(function(){i.tip.show(window.VditorI18n["record-tip"])});return}if(o.isRecording){o.stopRecording(),i.tip.hide();var _=new File([o.buildWavFileBlob()],"record".concat(new Date().getTime(),".wav"),{type:"video/webm"});Li(i,[_]),a.element.children[0].classList.remove("vditor-menu--current")}else i.tip.show(window.VditorI18n.recording),S.setAttribute("contenteditable","false"),o.startRecordingNewWavFile(),a.element.children[0].classList.add("vditor-menu--current")}})},t}($e),Rs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Hs=function(e){Rs(t,e);function t(i,a){var o=e.call(this,i,a)||this;return b({redo:o.element},["redo"]),o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),!o.element.firstElementChild.classList.contains(d.Y.CLASS_MENU_DISABLED)&&i.undo.redo(i)}),o}return t}($e),Is=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Ns=function(e){Is(t,e);function t(i,a){var o=e.call(this,i,a)||this;return b({undo:o.element},["undo"]),o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),!o.element.firstElementChild.classList.contains(d.Y.CLASS_MENU_DISABLED)&&i.undo.undo(i)}),o}return t}($e),js=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Bs=function(e){js(t,e);function t(i,a){var o=e.call(this,i,a)||this,l='<input type="file"';return i.options.upload.multiple&&(l+=' multiple="multiple"'),i.options.upload.accept&&(l+=' accept="'.concat(i.options.upload.accept,'"')),o.element.children[0].innerHTML="".concat(a.icon||'<svg><use xlink:href="#vditor-icon-upload"></use></svg>').concat(l,">"),o._bindEvent(i),o}return t.prototype._bindEvent=function(i){var a=this;this.element.children[0].addEventListener((0,u.y3)(),function(o){if(a.element.firstElementChild.classList.contains(d.Y.CLASS_MENU_DISABLED)){o.stopPropagation(),o.preventDefault();return}}),this.element.querySelector("input").addEventListener("change",function(o){if(a.element.firstElementChild.classList.contains(d.Y.CLASS_MENU_DISABLED)){o.stopPropagation(),o.preventDefault();return}o.target.files.length!==0&&Li(i,o.target.files,o.target)})},t}($e),zs=function(){function e(t){var i=this,a=t.options;this.elements={},this.element=document.createElement("div"),this.element.className="vditor-toolbar",a.toolbar.forEach(function(o,l){var S=i.genItem(t,o,l);if(i.element.appendChild(S),o.toolbar){var _=document.createElement("div");_.className="vditor-hint vditor-panel--arrow",_.addEventListener((0,u.y3)(),function(D){_.style.display="none"}),o.toolbar.forEach(function(D,L){D.level=2,_.appendChild(i.genItem(t,D,l+L))}),S.appendChild(_),A(t,_,S.children[0])}}),t.options.toolbarConfig.hide&&this.element.classList.add("vditor-toolbar--hide"),t.options.toolbarConfig.pin&&this.element.classList.add("vditor-toolbar--pin"),t.options.counter.enable&&(t.counter=new Jo(t),this.element.appendChild(t.counter.element))}return e.prototype.updateConfig=function(t,i){t.options.toolbarConfig=Object.assign({hide:!1,pin:!1},i),t.options.toolbarConfig.hide?this.element.classList.add("vditor-toolbar--hide"):this.element.classList.remove("vditor-toolbar--hide"),t.options.toolbarConfig.pin?this.element.classList.add("vditor-toolbar--pin"):this.element.classList.remove("vditor-toolbar--pin")},e.prototype.genItem=function(t,i,a){var o;switch(i.name){case"bold":case"italic":case"more":case"strike":case"line":case"quote":case"list":case"ordered-list":case"check":case"code":case"inline-code":case"link":case"table":o=new $e(t,i);break;case"emoji":o=new as(t,i);break;case"headings":o=new ps(t,i);break;case"|":o=new is;break;case"br":o=new Yo;break;case"undo":o=new Ns(t,i);break;case"redo":o=new Hs(t,i);break;case"help":o=new gs(t,i);break;case"both":o=new Wo(t,i);break;case"preview":o=new As(t,i);break;case"fullscreen":o=new fs(t,i);break;case"upload":o=new Bs(t,i);break;case"record":o=new Ps(t,i);break;case"info":o=new ws(t,i);break;case"edit-mode":o=new Eo(t,i);break;case"devtools":o=new ns(t,i);break;case"outdent":o=new Ms(t,i);break;case"indent":o=new ys(t,i);break;case"outline":o=new _s(t,i);break;case"insert-after":o=new Ss(t,i);break;case"insert-before":o=new Ts(t,i);break;case"code-theme":o=new Go(t,i);break;case"content-theme":o=new Xo(t,i);break;case"export":o=new us(t,i);break;default:o=new es(t,i);break}if(o){var l=i.name;return(l==="br"||l==="|")&&(l=l+a),this.elements[l]=o.element,o.element}},e}(),Fs=c(192),Us=function(){function e(){this.stackSize=50,this.resetStack(),this.dmp=new Fs}return e.prototype.clearStack=function(t){this.resetStack(),this.resetIcon(t)},e.prototype.resetIcon=function(t){t.toolbar&&(this[t.currentMode].undoStack.length>1?E(t.toolbar.elements,["undo"]):b(t.toolbar.elements,["undo"]),this[t.currentMode].redoStack.length!==0?E(t.toolbar.elements,["redo"]):b(t.toolbar.elements,["redo"]))},e.prototype.undo=function(t){if(t[t.currentMode].element.getAttribute("contenteditable")!=="false"&&!(this[t.currentMode].undoStack.length<2)){var i=this[t.currentMode].undoStack.pop();i&&(this[t.currentMode].redoStack.push(i),this.renderDiff(i,t),this[t.currentMode].hasUndo=!0,x(t,["hint"]))}},e.prototype.redo=function(t){if(t[t.currentMode].element.getAttribute("contenteditable")!=="false"){var i=this[t.currentMode].redoStack.pop();i&&(this[t.currentMode].undoStack.push(i),this.renderDiff(i,t,!0))}},e.prototype.recordFirstPosition=function(t,i){if(getSelection().rangeCount!==0&&!(this[t.currentMode].undoStack.length!==1||this[t.currentMode].undoStack[0].length===0||this[t.currentMode].redoStack.length>0)&&!((0,u.gm)()&&i.key==="Backspace")&&!(0,u.nr)()){var a=this.addCaret(t);a.replace("<wbr>","").replace(" vditor-ir__node--expand","")===this[t.currentMode].undoStack[0][0].diffs[0][1].replace("<wbr>","")&&(this[t.currentMode].undoStack[0][0].diffs[0][1]=a,this[t.currentMode].lastText=a)}},e.prototype.addToUndoStack=function(t){var i=this.addCaret(t,!0),a=this.dmp.diff_main(i,this[t.currentMode].lastText,!0),o=this.dmp.patch_make(i,this[t.currentMode].lastText,a);o.length===0&&this[t.currentMode].undoStack.length>0||(this[t.currentMode].lastText=i,this[t.currentMode].undoStack.push(o),this[t.currentMode].undoStack.length>this.stackSize&&this[t.currentMode].undoStack.shift(),this[t.currentMode].hasUndo&&(this[t.currentMode].redoStack=[],this[t.currentMode].hasUndo=!1,b(t.toolbar.elements,["redo"])),this[t.currentMode].undoStack.length>1&&E(t.toolbar.elements,["undo"]))},e.prototype.renderDiff=function(t,i,a){a===void 0&&(a=!1);var o;if(a){var l=this.dmp.patch_deepCopy(t).reverse();l.forEach(function(_){_.diffs.forEach(function(D){D[0]=-D[0]})}),o=this.dmp.patch_apply(l,this[i.currentMode].lastText)[0]}else o=this.dmp.patch_apply(t,this[i.currentMode].lastText)[0];if(this[i.currentMode].lastText=o,i[i.currentMode].element.innerHTML=o,i.currentMode!=="sv"&&(i[i.currentMode].element.querySelectorAll(".vditor-".concat(i.currentMode,"__preview")).forEach(function(_){_.parentElement.querySelector(".language-echarts")&&(i.currentMode==="ir"?_.parentElement.outerHTML=i.lute.SpinVditorIRDOM(_.parentElement.outerHTML):_.parentElement.outerHTML=i.lute.SpinVditorDOM(_.parentElement.outerHTML))}),i[i.currentMode].element.querySelectorAll(".vditor-".concat(i.currentMode,"__preview[data-render='2']")).forEach(function(_){Pe(_,i)})),i[i.currentMode].element.querySelector("wbr"))(0,P.ir)(i[i.currentMode].element,i[i.currentMode].element.ownerDocument.createRange()),qe(i);else{var S=getSelection().getRangeAt(0);S.setEndBefore(i[i.currentMode].element),S.collapse(!1)}j(i),Ce(i,{enableAddUndoStack:!1,enableHint:!1,enableInput:!0}),dn(i),i[i.currentMode].element.querySelectorAll(".vditor-".concat(i.currentMode,"__preview[data-render='2']")).forEach(function(_){Pe(_,i)}),this[i.currentMode].undoStack.length>1?E(i.toolbar.elements,["undo"]):b(i.toolbar.elements,["undo"]),this[i.currentMode].redoStack.length!==0?E(i.toolbar.elements,["redo"]):b(i.toolbar.elements,["redo"])},e.prototype.resetStack=function(){this.ir={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]},this.sv={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]},this.wysiwyg={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]}},e.prototype.addCaret=function(t,i){i===void 0&&(i=!1);var a;if(getSelection().rangeCount!==0&&!t[t.currentMode].element.querySelector("wbr")){var o=getSelection().getRangeAt(0);if(t[t.currentMode].element.contains(o.startContainer)){a=o.cloneRange();var l=document.createElement("span");l.className="vditor-wbr",o.insertNode(l)}}var S=t[t.currentMode].element.cloneNode(!0);S.querySelectorAll(".vditor-".concat(t.currentMode,"__preview[data-render='1']")).forEach(function(D){D.firstElementChild&&(D.firstElementChild.classList.contains("language-echarts")||D.firstElementChild.classList.contains("language-plantuml")||D.firstElementChild.classList.contains("language-mindmap")?(D.firstElementChild.removeAttribute("_echarts_instance_"),D.firstElementChild.removeAttribute("data-processed"),D.firstElementChild.innerHTML=D.previousElementSibling.firstElementChild.innerHTML,D.setAttribute("data-render","2")):D.firstElementChild.classList.contains("language-math")&&(D.setAttribute("data-render","2"),D.firstElementChild.textContent=D.firstElementChild.getAttribute("data-math"),D.firstElementChild.removeAttribute("data-math")))});var _=S.innerHTML;return t[t.currentMode].element.querySelectorAll(".vditor-wbr").forEach(function(D){D.remove()}),i&&a&&(0,P.jl)(a),_.replace('<span class="vditor-wbr"></span>',"<wbr>")},e}(),$s=c(905),Vs=function(){function e(t){this.defaultOptions={rtl:!1,after:void 0,cache:{enable:!0},cdn:d.Y.CDN,classes:{preview:""},comment:{enable:!1},counter:{enable:!1,type:"markdown"},customRenders:[],debugger:!1,fullscreen:{index:90},height:"auto",hint:{delay:200,emoji:{"+1":"👍","-1":"👎",confused:"😕",eyes:"👀️",heart:"❤️",rocket:"🚀️",smile:"😄",tada:"🎉️"},emojiPath:"".concat(d.Y.CDN,"/dist/images/emoji"),extend:[],parse:!0},icon:"ant",lang:"zh_CN",mode:"ir",outline:{enable:!1,position:"left"},placeholder:"",preview:{actions:["desktop","tablet","mobile","mp-wechat","zhihu"],delay:1e3,hljs:d.Y.HLJS_OPTIONS,markdown:d.Y.MARKDOWN_OPTIONS,math:d.Y.MATH_OPTIONS,maxWidth:800,mode:"both",theme:d.Y.THEME_OPTIONS,render:{media:{enable:!0}}},link:{isOpen:!0},image:{isPreview:!0},resize:{enable:!1,position:"bottom"},theme:"classic",toolbar:["emoji","headings","bold","italic","strike","link","|","list","ordered-list","check","outdent","indent","|","quote","line","code","inline-code","insert-before","insert-after","|","upload","record","table","|","undo","redo","|","fullscreen","edit-mode",{name:"more",toolbar:["both","code-theme","content-theme","export","outline","preview","devtools","info","help"]}],toolbarConfig:{hide:!1,pin:!1},typewriterMode:!1,undoDelay:800,upload:{extraData:{},fieldName:"file[]",filename:function(i){return i.replace(/\W/g,"")},linkToImgUrl:"",max:10*1024*1024,multiple:!0,url:"",withCredentials:!1},value:"",width:"auto"},this.options=t}return e.prototype.merge=function(){var t,i,a,o,l,S,_,D,L;this.options&&(this.options.toolbar?this.options.toolbar=this.mergeToolbar(this.options.toolbar):this.options.toolbar=this.mergeToolbar(this.defaultOptions.toolbar),!((i=(t=this.options.preview)===null||t===void 0?void 0:t.theme)===null||i===void 0)&&i.list&&(this.defaultOptions.preview.theme.list=this.options.preview.theme.list),!((l=(o=(a=this.options.preview)===null||a===void 0?void 0:a.render)===null||o===void 0?void 0:o.media)===null||l===void 0)&&l.enable&&(this.defaultOptions.preview.render.media.enable=this.options.preview.render.media.enable),!((S=this.options.hint)===null||S===void 0)&&S.emoji&&(this.defaultOptions.hint.emoji=this.options.hint.emoji),this.options.comment&&(this.defaultOptions.comment=this.options.comment),this.options.cdn&&(!((D=(_=this.options.preview)===null||_===void 0?void 0:_.theme)===null||D===void 0)&&D.path||(this.defaultOptions.preview.theme.path="".concat(this.options.cdn,"/dist/css/content-theme")),!((L=this.options.hint)===null||L===void 0)&&L.emojiPath||(this.defaultOptions.hint.emojiPath="".concat(this.options.cdn,"/dist/images/emoji"))));var I=(0,$s.h)(this.defaultOptions,this.options);if(I.cache.enable&&!I.cache.id)throw new Error("need options.cache.id, see https://ld246.com/article/1549638745630#options");return I},e.prototype.mergeToolbar=function(t){var i=this,a=[{icon:'<svg><use xlink:href="#vditor-icon-export"></use></svg>',name:"export",tipPosition:"ne"},{hotkey:"⌘E",icon:'<svg><use xlink:href="#vditor-icon-emoji"></use></svg>',name:"emoji",tipPosition:"ne"},{hotkey:"⌘H",icon:'<svg><use xlink:href="#vditor-icon-headings"></use></svg>',name:"headings",tipPosition:"ne"},{hotkey:"⌘B",icon:'<svg><use xlink:href="#vditor-icon-bold"></use></svg>',name:"bold",prefix:"**",suffix:"**",tipPosition:"ne"},{hotkey:"⌘I",icon:'<svg><use xlink:href="#vditor-icon-italic"></use></svg>',name:"italic",prefix:"*",suffix:"*",tipPosition:"ne"},{hotkey:"⌘D",icon:'<svg><use xlink:href="#vditor-icon-strike"></use></svg>',name:"strike",prefix:"~~",suffix:"~~",tipPosition:"ne"},{hotkey:"⌘K",icon:'<svg><use xlink:href="#vditor-icon-link"></use></svg>',name:"link",prefix:"[",suffix:"](https://)",tipPosition:"n"},{name:"|"},{hotkey:"⌘L",icon:'<svg><use xlink:href="#vditor-icon-list"></use></svg>',name:"list",prefix:"* ",tipPosition:"n"},{hotkey:"⌘O",icon:'<svg><use xlink:href="#vditor-icon-ordered-list"></use></svg>',name:"ordered-list",prefix:"1. ",tipPosition:"n"},{hotkey:"⌘J",icon:'<svg><use xlink:href="#vditor-icon-check"></use></svg>',name:"check",prefix:"* [ ] ",tipPosition:"n"},{hotkey:"⇧⌘I",icon:'<svg><use xlink:href="#vditor-icon-outdent"></use></svg>',name:"outdent",tipPosition:"n"},{hotkey:"⇧⌘O",icon:'<svg><use xlink:href="#vditor-icon-indent"></use></svg>',name:"indent",tipPosition:"n"},{name:"|"},{hotkey:"⌘;",icon:'<svg><use xlink:href="#vditor-icon-quote"></use></svg>',name:"quote",prefix:"> ",tipPosition:"n"},{hotkey:"⇧⌘H",icon:'<svg><use xlink:href="#vditor-icon-line"></use></svg>',name:"line",prefix:"---",tipPosition:"n"},{hotkey:"⌘U",icon:'<svg><use xlink:href="#vditor-icon-code"></use></svg>',name:"code",prefix:"```",suffix:"\n```",tipPosition:"n"},{hotkey:"⌘G",icon:'<svg><use xlink:href="#vditor-icon-inline-code"></use></svg>',name:"inline-code",prefix:"`",suffix:"`",tipPosition:"n"},{hotkey:"⇧⌘B",icon:'<svg><use xlink:href="#vditor-icon-before"></use></svg>',name:"insert-before",tipPosition:"n"},{hotkey:"⇧⌘E",icon:'<svg><use xlink:href="#vditor-icon-after"></use></svg>',name:"insert-after",tipPosition:"n"},{name:"|"},{icon:'<svg><use xlink:href="#vditor-icon-upload"></use></svg>',name:"upload",tipPosition:"n"},{icon:'<svg><use xlink:href="#vditor-icon-record"></use></svg>',name:"record",tipPosition:"n"},{hotkey:"⌘M",icon:'<svg><use xlink:href="#vditor-icon-table"></use></svg>',name:"table",prefix:"| col1",suffix:` | col2 | col3 |
| --- | --- | --- |
|  |  |  |
|  |  |  |`,tipPosition:"n"},{name:"|"},{hotkey:"⌘Z",icon:'<svg><use xlink:href="#vditor-icon-undo"></use></svg>',name:"undo",tipPosition:"nw"},{hotkey:"⌘Y",icon:'<svg><use xlink:href="#vditor-icon-redo"></use></svg>',name:"redo",tipPosition:"nw"},{name:"|"},{icon:'<svg><use xlink:href="#vditor-icon-more"></use></svg>',name:"more",tipPosition:"e"},{hotkey:"⌘'",icon:'<svg><use xlink:href="#vditor-icon-fullscreen"></use></svg>',name:"fullscreen",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-edit"></use></svg>',name:"edit-mode",tipPosition:"nw"},{hotkey:"⌘P",icon:'<svg><use xlink:href="#vditor-icon-both"></use></svg>',name:"both",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-preview"></use></svg>',name:"preview",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-align-center"></use></svg>',name:"outline",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-theme"></use></svg>',name:"content-theme",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-code-theme"></use></svg>',name:"code-theme",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-bug"></use></svg>',name:"devtools",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-info"></use></svg>',name:"info",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-help"></use></svg>',name:"help",tipPosition:"nw"},{name:"br"}],o=[];return t.forEach(function(l){var S=l;a.forEach(function(_){typeof l=="string"&&_.name===l&&(S=_),typeof l=="object"&&_.name===l.name&&(S=Object.assign({},_,l))}),l.toolbar&&(S.toolbar=i.mergeToolbar(l.toolbar)),o.push(S)}),o},e}(),qs=function(){function e(t){var i=this;this.composingLock=!1,this.commentIds=[];var a=document.createElement("div");a.className="vditor-wysiwyg",a.innerHTML='<pre class="vditor-reset" placeholder="'.concat(t.options.placeholder,`"
 contenteditable="true" spellcheck="false"></pre>
<div class="vditor-panel vditor-panel--none"></div>
<div class="vditor-panel vditor-panel--none">
    <button type="button" aria-label="`).concat(window.VditorI18n.comment,`" class="vditor-icon vditor-tooltipped vditor-tooltipped__n">
        <svg><use xlink:href="#vditor-icon-comment"></use></svg>
    </button>
</div>`),this.element=a.firstElementChild,this.popover=a.firstElementChild.nextElementSibling,this.selectPopover=a.lastElementChild,this.bindEvent(t),Ei(t,this.element),gr(t,this.element),Si(t,this.element),Mi(t,this.element),xi(t,this.element),Ci(t,this.element),Ti(t,this.element,this.copy),ki(t,this.element,this.copy),t.options.comment.enable&&(this.selectPopover.querySelector("button").onclick=function(){var o=Lute.NewNodeID(),l=getSelection().getRangeAt(0),S=l.cloneRange(),_=l.extractContents(),D,L,I=!1,B=!1;_.childNodes.forEach(function(W,se){var Q=!1;if(W.nodeType===3?Q=!0:W.classList.contains("vditor-comment")?W.classList.contains("vditor-comment")&&W.setAttribute("data-cmtids",W.getAttribute("data-cmtids")+" "+o):Q=!0,Q)if(W.nodeType!==3&&W.getAttribute("data-block")==="0"&&se===0&&S.startOffset>0)W.innerHTML='<span class="vditor-comment" data-cmtids="'.concat(o,'">').concat(W.innerHTML,"</span>"),D=W;else if(W.nodeType!==3&&W.getAttribute("data-block")==="0"&&se===_.childNodes.length-1&&S.endOffset<S.endContainer.textContent.length)W.innerHTML='<span class="vditor-comment" data-cmtids="'.concat(o,'">').concat(W.innerHTML,"</span>"),L=W;else if(W.nodeType!==3&&W.getAttribute("data-block")==="0")se===0?I=!0:se===_.childNodes.length-1&&(B=!0),W.innerHTML='<span class="vditor-comment" data-cmtids="'.concat(o,'">').concat(W.innerHTML,"</span>");else{var q=document.createElement("span");q.classList.add("vditor-comment"),q.setAttribute("data-cmtids",o),W.parentNode.insertBefore(q,W),q.appendChild(W)}});var Z=(0,m.pt)(S.startContainer);Z&&(D?(Z.insertAdjacentHTML("beforeend",D.innerHTML),D.remove()):Z.textContent.trim().replace(d.Y.ZWSP,"")===""&&I&&Z.remove());var G=(0,m.pt)(S.endContainer);G&&(L?(G.insertAdjacentHTML("afterbegin",L.innerHTML),L.remove()):G.textContent.trim().replace(d.Y.ZWSP,"")===""&&B&&G.remove()),l.insertNode(_),t.options.comment.add(o,l.toString(),i.getComments(t,!0)),Be(t,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),i.hideComment()})}return e.prototype.getComments=function(t,i){var a=this;if(i===void 0&&(i=!1),t.currentMode==="wysiwyg"&&t.options.comment.enable){this.commentIds=[],this.element.querySelectorAll(".vditor-comment").forEach(function(l){a.commentIds=a.commentIds.concat(l.getAttribute("data-cmtids").split(" "))}),this.commentIds=Array.from(new Set(this.commentIds));var o=[];if(i)return this.commentIds.forEach(function(l){o.push({id:l,top:a.element.querySelector('.vditor-comment[data-cmtids="'.concat(l,'"]')).offsetTop})}),o}else return[]},e.prototype.triggerRemoveComment=function(t){var i=function(l,S){var _=new Set(S);return l.filter(function(D){return!_.has(D)})};if(t.currentMode==="wysiwyg"&&t.options.comment.enable&&t.wysiwyg.commentIds.length>0){var a=JSON.parse(JSON.stringify(this.commentIds));this.getComments(t);var o=i(a,this.commentIds);o.length>0&&t.options.comment.remove(o)}},e.prototype.showComment=function(){var t=(0,P.Ey)(this.element);this.selectPopover.setAttribute("style","left:".concat(t.left,"px;display:block;top:").concat(Math.max(-8,t.top-21),"px"))},e.prototype.hideComment=function(){this.selectPopover.setAttribute("style","display:none")},e.prototype.unbindListener=function(){window.removeEventListener("scroll",this.scrollListener)},e.prototype.copy=function(t,i){var a=getSelection().getRangeAt(0);if(a.toString()!==""){t.stopPropagation(),t.preventDefault();var o=(0,m._Y)(a.startContainer,"CODE"),l=(0,m._Y)(a.endContainer,"CODE");if(o&&l&&l.isSameNode(o)){var S="";o.parentElement.tagName==="PRE"?S=a.toString():S="`"+a.toString()+"`",t.clipboardData.setData("text/plain",S),t.clipboardData.setData("text/html","");return}var _=(0,m._Y)(a.startContainer,"A"),D=(0,m._Y)(a.endContainer,"A");if(_&&D&&D.isSameNode(_)){var L=_.getAttribute("title")||"";L&&(L=' "'.concat(L,'"')),t.clipboardData.setData("text/plain","[".concat(a.toString(),"](").concat(_.getAttribute("href")).concat(L,")")),t.clipboardData.setData("text/html","");return}var I=document.createElement("div");I.appendChild(a.cloneContents()),t.clipboardData.setData("text/plain",i.lute.VditorDOM2Md(I.innerHTML).trim()),t.clipboardData.setData("text/html","")}},e.prototype.bindEvent=function(t){var i=this;this.unbindListener(),window.addEventListener("scroll",this.scrollListener=function(){if(x(t,["hint"]),!(i.popover.style.display!=="block"||i.selectPopover.style.display!=="block")){var a=parseInt(i.popover.getAttribute("data-top"),10);if(t.options.height!=="auto"){if(t.options.toolbarConfig.pin&&t.toolbar.element.getBoundingClientRect().top===0){var o=Math.max(window.scrollY-t.element.offsetTop-8,Math.min(a-t.wysiwyg.element.scrollTop,i.element.clientHeight-21))+"px";i.popover.style.display==="block"&&(i.popover.style.top=o),i.selectPopover.style.display==="block"&&(i.selectPopover.style.top=o)}return}else if(!t.options.toolbarConfig.pin)return;var l=Math.max(a,window.scrollY-t.element.offsetTop-8)+"px";i.popover.style.display==="block"&&(i.popover.style.top=l),i.selectPopover.style.display==="block"&&(i.selectPopover.style.top=l)}}),this.element.addEventListener("scroll",function(){if(x(t,["hint"]),t.options.comment&&t.options.comment.enable&&t.options.comment.scroll&&t.options.comment.scroll(t.wysiwyg.element.scrollTop),i.popover.style.display==="block"){var a=parseInt(i.popover.getAttribute("data-top"),10)-t.wysiwyg.element.scrollTop,o=-8;t.options.toolbarConfig.pin&&t.toolbar.element.getBoundingClientRect().top===0&&(o=window.scrollY-t.element.offsetTop+o);var l=Math.max(o,Math.min(a,i.element.clientHeight-21))+"px";i.popover.style.top=l,i.selectPopover.style.top=l}}),this.element.addEventListener("paste",function(a){Wn(t,a,{pasteCode:function(o){var l=(0,P.RN)(t),S=document.createElement("template");S.innerHTML=o,l.insertNode(S.content.cloneNode(!0));var _=(0,m.Th)(l.startContainer,"data-block","0");_?_.outerHTML=t.lute.SpinVditorDOM(_.outerHTML):t.wysiwyg.element.innerHTML=t.lute.SpinVditorDOM(t.wysiwyg.element.innerHTML),(0,P.ir)(t.wysiwyg.element,l)}})}),this.element.addEventListener("compositionstart",function(){i.composingLock=!0}),this.element.addEventListener("compositionend",function(a){var o=(0,O.c)(getSelection().getRangeAt(0).startContainer);if(o&&o.textContent===""){j(t);return}(0,u.gm)()||Un(t,getSelection().getRangeAt(0).cloneRange(),a),i.composingLock=!1}),this.element.addEventListener("input",function(a){if(!(a.inputType==="deleteByDrag"||a.inputType==="insertFromDrop")){if(i.preventInput){i.preventInput=!1,Be(t);return}if(i.composingLock||a.data==="‘"||a.data==="“"||a.data==="《"){Be(t);return}var o=getSelection().getRangeAt(0),l=(0,m.pt)(o.startContainer);if(l||(yi(t,o),l=(0,m.pt)(o.startContainer)),!!l){for(var S=(0,P.ED)(l,t.wysiwyg.element,o).start,_=!0,D=S-1;D>l.textContent.substr(0,S).lastIndexOf(`
`);D--)if(l.textContent.charAt(D)!==" "&&l.textContent.charAt(D)!=="	"){_=!1;break}S===0&&(_=!1);for(var L=!0,D=S-1;D<l.textContent.length;D++)if(l.textContent.charAt(D)!==" "&&l.textContent.charAt(D)!==`
`){L=!1;break}L&&/^#{1,6} $/.test(l.textContent)&&(L=!1);var I=(0,O.c)(getSelection().getRangeAt(0).startContainer);if(I&&I.textContent===""&&(j(t),I.remove()),_&&l.getAttribute("data-type")!=="code-block"||L||Oi(l.innerHTML)||Di(l.innerHTML)&&l.previousElementSibling){typeof t.options.input=="function"&&t.options.input(T(t));return}a.inputType==="insertParagraph"&&i.element.innerHTML==="<p><br></p><p><br></p>"&&l.previousElementSibling.remove(),Un(t,o,a)}}}),this.element.addEventListener("click",function(a){if(a.target.tagName==="INPUT"){var o=a.target;o.checked?o.setAttribute("checked","checked"):o.removeAttribute("checked"),i.preventInput=!0,getSelection().rangeCount>0&&(0,P.jl)(getSelection().getRangeAt(0)),Be(t);return}if(a.target.tagName==="IMG"&&!a.target.parentElement.classList.contains("vditor-wysiwyg__preview")){a.target.getAttribute("data-type")==="link-ref"?pr(t,a.target):vo(a,t);return}var l=(0,m._Y)(a.target,"A");if(l){t.options.link.click?t.options.link.click(l):t.options.link.isOpen&&window.open(l.getAttribute("href")),a.preventDefault();return}var S=(0,P.RN)(t);if(a.target.isEqualNode(i.element)&&i.element.lastElementChild&&S.collapsed){var _=i.element.lastElementChild.getBoundingClientRect();a.y>_.top+_.height&&(i.element.lastElementChild.tagName==="P"&&i.element.lastElementChild.textContent.trim().replace(d.Y.ZWSP,"")===""?(S.selectNodeContents(i.element.lastElementChild),S.collapse(!1)):(i.element.insertAdjacentHTML("beforeend",'<p data-block="0">'.concat(d.Y.ZWSP,"<wbr></p>")),(0,P.ir)(i.element,S)))}qt(t);var D=(0,m.KJ)(a.target,"vditor-wysiwyg__preview");D||(D=(0,m.KJ)((0,P.RN)(t).startContainer,"vditor-wysiwyg__preview")),D&&xn(D,t),U(a,t)}),this.element.addEventListener("keyup",function(a){if(!(a.isComposing||(0,u._0)(a))){a.key==="Enter"&&qe(t),(a.key==="Backspace"||a.key==="Delete")&&t.wysiwyg.element.innerHTML!==""&&t.wysiwyg.element.childNodes.length===1&&t.wysiwyg.element.firstElementChild&&t.wysiwyg.element.firstElementChild.tagName==="P"&&t.wysiwyg.element.firstElementChild.childElementCount===0&&(t.wysiwyg.element.textContent===""||t.wysiwyg.element.textContent===`
`)&&(t.wysiwyg.element.innerHTML="");var o=(0,P.RN)(t);if(a.key==="Backspace"&&(0,u.gm)()&&o.startContainer.textContent===`
`&&o.startOffset===1&&(o.startContainer.textContent=""),yi(t,o),qt(t),!(a.key!=="ArrowDown"&&a.key!=="ArrowRight"&&a.key!=="Backspace"&&a.key!=="ArrowLeft"&&a.key!=="ArrowUp")){(a.key==="ArrowLeft"||a.key==="ArrowRight")&&t.hint.render(t);var l=(0,m.KJ)(o.startContainer,"vditor-wysiwyg__preview");if(!l&&o.startContainer.nodeType!==3&&o.startOffset>0){var S=o.startContainer;S.classList.contains("vditor-wysiwyg__block")&&(l=S.lastElementChild)}if(l){var _=l.previousElementSibling;if(_.style.display==="none"){a.key==="ArrowDown"||a.key==="ArrowRight"?xn(l,t):xn(l,t,!1);return}var D=l.previousElementSibling;if(D.tagName==="PRE"&&(D=D.firstElementChild),a.key==="ArrowDown"||a.key==="ArrowRight"){var S=l.parentElement,L=po(S);if(L&&L.nodeType!==3){var I=L.querySelector(".vditor-wysiwyg__preview");if(I){xn(I,t);return}}if(L.nodeType===3){for(;L.textContent.length===0&&L.nextSibling;)L=L.nextSibling;o.setStart(L,1)}else o.setStart(L.firstChild,0)}else o.selectNodeContents(D),o.collapse(!1)}}}})},e}(),Ws=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Ys=function(e){Ws(t,e);function t(i,a){var o=e.call(this)||this;if(o.version=d.g,typeof i=="string"){if(a?a.cache?a.cache.id||(a.cache.id="vditor".concat(i)):a.cache={id:"vditor".concat(i)}:a={cache:{id:"vditor".concat(i)}},!document.getElementById(i))return o.showErrorTip("Failed to get element by id: ".concat(i)),o;i=document.getElementById(i)}var l=new Vs(a),S=l.merge();if(S.i18n)window.VditorI18n=S.i18n,o.init(i,S);else if(["en_US","fr_FR","pt_BR","ja_JP","ko_KR","ru_RU","sv_SE","zh_CN","zh_TW"].includes(S.lang)){var _="vditorI18nScript",D=_+S.lang;document.querySelectorAll('head script[id^="'.concat(_,'"]')).forEach(function(L){L.id!==D&&document.head.removeChild(L)}),(0,C.Z)("".concat(S.cdn,"/dist/js/i18n/").concat(S.lang,".js"),D).then(function(){o.init(i,S)}).catch(function(L){o.showErrorTip("GET ".concat(S.cdn,"/dist/js/i18n/").concat(S.lang,".js net::ERR_ABORTED 404 (Not Found)"))})}else throw new Error("options.lang error, see https://ld246.com/article/1549638745630#options");return o}return t.prototype.showErrorTip=function(i){var a=new $r;document.body.appendChild(a.element),a.show(i,0)},t.prototype.updateToolbarConfig=function(i){this.vditor.toolbar.updateConfig(this.vditor,i)},t.prototype.setTheme=function(i,a,o,l){this.vditor.options.theme=i,He(this.vditor),a&&(this.vditor.options.preview.theme.current=a,(0,ye.H)(a,l||this.vditor.options.preview.theme.path)),o&&(this.vditor.options.preview.hljs.style=o,(0,Vr.h)(o,this.vditor.options.cdn))},t.prototype.getValue=function(){return T(this.vditor)},t.prototype.getCurrentMode=function(){return this.vditor.currentMode},t.prototype.focus=function(){this.vditor.currentMode==="sv"?this.vditor.sv.element.focus():this.vditor.currentMode==="wysiwyg"?this.vditor.wysiwyg.element.focus():this.vditor.currentMode==="ir"&&this.vditor.ir.element.focus()},t.prototype.blur=function(){this.vditor.currentMode==="sv"?this.vditor.sv.element.blur():this.vditor.currentMode==="wysiwyg"?this.vditor.wysiwyg.element.blur():this.vditor.currentMode==="ir"&&this.vditor.ir.element.blur()},t.prototype.disabled=function(){x(this.vditor,["subToolbar","hint","popover"]),b(this.vditor.toolbar.elements,d.Y.EDIT_TOOLBARS.concat(["undo","redo","fullscreen","edit-mode"])),this.vditor[this.vditor.currentMode].element.setAttribute("contenteditable","false")},t.prototype.enable=function(){E(this.vditor.toolbar.elements,d.Y.EDIT_TOOLBARS.concat(["undo","redo","fullscreen","edit-mode"])),this.vditor.undo.resetIcon(this.vditor),this.vditor[this.vditor.currentMode].element.setAttribute("contenteditable","true")},t.prototype.getSelection=function(){if(this.vditor.currentMode==="wysiwyg")return Ln(this.vditor.wysiwyg.element);if(this.vditor.currentMode==="sv")return Ln(this.vditor.sv.element);if(this.vditor.currentMode==="ir")return Ln(this.vditor.ir.element)},t.prototype.renderPreview=function(i){this.vditor.preview.render(this.vditor,i)},t.prototype.getCursorPosition=function(){return(0,P.Ey)(this.vditor[this.vditor.currentMode].element)},t.prototype.isUploading=function(){return this.vditor.upload.isUploading},t.prototype.clearCache=function(){this.vditor.options.cache.enable&&(0,u.D)()&&localStorage.removeItem(this.vditor.options.cache.id)},t.prototype.disabledCache=function(){this.vditor.options.cache.enable=!1},t.prototype.enableCache=function(){if(!this.vditor.options.cache.id)throw new Error("need options.cache.id, see https://ld246.com/article/1549638745630#options");this.vditor.options.cache.enable=!0},t.prototype.html2md=function(i){return this.vditor.lute.HTML2Md(i)},t.prototype.exportJSON=function(i){return this.vditor.lute.RenderJSON(i)},t.prototype.getHTML=function(){return Fr(this.vditor)},t.prototype.tip=function(i,a){this.vditor.tip.show(i,a)},t.prototype.setPreviewMode=function(i){Ri(i,this.vditor)},t.prototype.deleteValue=function(){window.getSelection().isCollapsed||document.execCommand("delete",!1)},t.prototype.updateValue=function(i){document.execCommand("insertHTML",!1,i)},t.prototype.insertValue=function(i,a){a===void 0&&(a=!0);var o=(0,P.RN)(this.vditor);o.collapse(!0);var l=document.createElement("template");l.innerHTML=i,o.insertNode(l.content.cloneNode(!0)),o.collapse(!1),this.vditor.currentMode==="sv"?(this.vditor.sv.preventInput=!0,a&&Me(this.vditor)):this.vditor.currentMode==="wysiwyg"?a&&Un(this.vditor,getSelection().getRangeAt(0)):this.vditor.currentMode==="ir"&&(this.vditor.ir.preventInput=!0,a&&ue(this.vditor,getSelection().getRangeAt(0),!0))},t.prototype.insertMD=function(i){this.vditor.currentMode==="ir"?(0,P.Z2)(this.vditor.lute.Md2VditorIRDOM(i),this.vditor):this.vditor.currentMode==="wysiwyg"?(0,P.Z2)(this.vditor.lute.Md2VditorDOM(i),this.vditor):_i(this.vditor,i),this.vditor.outline.render(this.vditor),Ce(this.vditor)},t.prototype.setValue=function(i,a){var o=this;a===void 0&&(a=!1),this.vditor.currentMode==="sv"?(this.vditor.sv.element.innerHTML="<div data-block='0'>".concat(this.vditor.lute.SpinVditorSVDOM(i),"</div>"),Ge(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})):this.vditor.currentMode==="wysiwyg"?mr(this.vditor,i,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}):(this.vditor.ir.element.innerHTML=this.vditor.lute.Md2VditorIRDOM(i),this.vditor.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach(function(l){Pe(l,o.vditor)}),Rt(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})),this.vditor.outline.render(this.vditor),i||(x(this.vditor,["emoji","headings","submenu","hint"]),this.vditor.wysiwyg.popover&&(this.vditor.wysiwyg.popover.style.display="none"),this.clearCache()),a&&this.clearStack()},t.prototype.insertEmptyBlock=function(i){An(this.vditor,i)},t.prototype.clearStack=function(){this.vditor.undo.clearStack(this.vditor),this.vditor.undo.addToUndoStack(this.vditor)},t.prototype.destroy=function(){this.vditor.element.innerHTML=this.vditor.originalInnerHTML,this.vditor.element.classList.remove("vditor"),this.vditor.element.removeAttribute("style");var i=document.getElementById("vditorIconScript");i&&i.remove(),this.clearCache(),Ct(),this.vditor.wysiwyg.unbindListener()},t.prototype.getCommentIds=function(){return this.vditor.currentMode!=="wysiwyg"?[]:this.vditor.wysiwyg.getComments(this.vditor,!0)},t.prototype.hlCommentIds=function(i){if(this.vditor.currentMode==="wysiwyg"){var a=function(o){o.classList.remove("vditor-comment--hover"),i.forEach(function(l){o.getAttribute("data-cmtids").indexOf(l)>-1&&o.classList.add("vditor-comment--hover")})};this.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(o){a(o)}),this.vditor.preview.element.style.display!=="none"&&this.vditor.preview.element.querySelectorAll(".vditor-comment").forEach(function(o){a(o)})}},t.prototype.unHlCommentIds=function(i){if(this.vditor.currentMode==="wysiwyg"){var a=function(o){i.forEach(function(l){o.getAttribute("data-cmtids").indexOf(l)>-1&&o.classList.remove("vditor-comment--hover")})};this.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(o){a(o)}),this.vditor.preview.element.style.display!=="none"&&this.vditor.preview.element.querySelectorAll(".vditor-comment").forEach(function(o){a(o)})}},t.prototype.removeCommentIds=function(i){var a=this;if(this.vditor.currentMode==="wysiwyg"){var o=function(l,S){var _=l.getAttribute("data-cmtids").split(" ");_.find(function(D,L){if(D===S)return _.splice(L,1),!0}),_.length===0?(l.outerHTML=l.innerHTML,(0,P.RN)(a.vditor).collapse(!0)):l.setAttribute("data-cmtids",_.join(" "))};i.forEach(function(l){a.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(S){o(S,l)}),a.vditor.preview.element.style.display!=="none"&&a.vditor.preview.element.querySelectorAll(".vditor-comment").forEach(function(S){o(S,l)})}),Be(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})}},t.prototype.init=function(i,a){var o=this;this.vditor={currentMode:a.mode,element:i,hint:new No(a.hint.extend),lute:void 0,options:a,originalInnerHTML:i.innerHTML,outline:new zo(window.VditorI18n.outline),tip:new $r},this.vditor.sv=new Vo(this.vditor),this.vditor.undo=new Us,this.vditor.wysiwyg=new qs(this.vditor),this.vditor.ir=new jo(this.vditor),this.vditor.toolbar=new zs(this.vditor),a.resize.enable&&(this.vditor.resize=new $o(this.vditor)),this.vditor.toolbar.elements.devtools&&(this.vditor.devtools=new f),(a.upload.url||a.upload.handler)&&(this.vditor.upload=new Mo),(0,C.Z)(a._lutePath||"".concat(a.cdn,"/dist/js/lute/lute.min.js"),"vditorLuteScript").then(function(){o.vditor.lute=(0,Bo.X)({autoSpace:o.vditor.options.preview.markdown.autoSpace,gfmAutoLink:o.vditor.options.preview.markdown.gfmAutoLink,codeBlockPreview:o.vditor.options.preview.markdown.codeBlockPreview,emojiSite:o.vditor.options.hint.emojiPath,emojis:o.vditor.options.hint.emoji,fixTermTypo:o.vditor.options.preview.markdown.fixTermTypo,footnotes:o.vditor.options.preview.markdown.footnotes,headingAnchor:!1,inlineMathDigit:o.vditor.options.preview.math.inlineDigit,linkBase:o.vditor.options.preview.markdown.linkBase,linkPrefix:o.vditor.options.preview.markdown.linkPrefix,listStyle:o.vditor.options.preview.markdown.listStyle,mark:o.vditor.options.preview.markdown.mark,mathBlockPreview:o.vditor.options.preview.markdown.mathBlockPreview,paragraphBeginningSpace:o.vditor.options.preview.markdown.paragraphBeginningSpace,sanitize:o.vditor.options.preview.markdown.sanitize,toc:o.vditor.options.preview.markdown.toc}),o.vditor.preview=new Uo(o.vditor),ot(o.vditor),a.after&&a.after(),a.icon&&(0,C.U)("".concat(a.cdn,"/dist/js/icons/").concat(a.icon,".js"),"vditorIconScript")})},t}(g.default);const Ks=Ys})(),h=h.default,h})())}(di)),di.exports}var ac=rc();const gi=nc(ac),oc=mt({__name:"VditorEditor",props:{modelValue:{type:String,default:""}},emits:["update:modelValue"],setup(w,{expose:n,emit:r}){const s=w,c=r,h=te();let g=null;const d={mode:"ir",height:"auto",minHeight:140,resize:{enable:!0,position:"bottom"},icon:"ant",lang:"zh_CN",theme:"classic",toolbar:["emoji","headings","bold","italic","strike","link","|","list","ordered-list","check","|","quote","line","code","inline-code","|","preview","fullscreen"],toolbarConfig:{pin:!0,hideTooltip:!0},counter:{enable:!1},cache:{enable:!0,id:"vue-vditor"},input:y=>{c("update:modelValue",y)},preview:{hljs:{style:"native"},markdown:{listStyle:!0,mark:!0},actions:[]},placeholder:"灵感记录~"};return Pt(async()=>{h.value&&(g=new gi(h.value,{...d,after:()=>{g==null||g.setValue(s.modelValue)}}))}),vi(()=>{g==null||g.destroy()}),n({clear:()=>{g&&(g.setValue(""),c("update:modelValue",""))},insertValue:y=>{g&&(g.insertValue(y),c("update:modelValue",g.getValue()))}}),(y,T)=>(le(),me("div",{ref_key:"editorContainer",ref:h,class:"vditor-container"},null,512))}});function sc(w,n,r){let s=te(r==null?void 0:r.value),c=_e(()=>w.value!==void 0);return[_e(()=>c.value?w.value:s.value),function(h){return c.value||(s.value=h),n==null?void 0:n(h)}]}function Pa(w,n){if(w)return w;let r=n??"button";if(typeof r=="string"&&r.toLowerCase()==="button")return"button"}function lc(w,n){let r=te(Pa(w.value.type,w.value.as));return Pt(()=>{r.value=Pa(w.value.type,w.value.as)}),sl(()=>{var s;r.value||ui(n)&&ui(n)instanceof HTMLButtonElement&&!((s=ui(n))!=null&&s.hasAttribute("type"))&&(r.value="button")}),r}function cc(w){var n,r;let s=(n=w==null?void 0:w.form)!=null?n:w.closest("form");if(s){for(let c of s.elements)if(c!==w&&(c.tagName==="INPUT"&&c.type==="submit"||c.tagName==="BUTTON"&&c.type==="submit"||c.nodeName==="INPUT"&&c.type==="image")){c.click();return}(r=s.requestSubmit)==null||r.call(s)}}let uc=Symbol("GroupContext"),dc=mt({name:"Switch",emits:{"update:modelValue":w=>!0},props:{as:{type:[Object,String],default:"button"},modelValue:{type:Boolean,default:void 0},defaultChecked:{type:Boolean,optional:!0},form:{type:String,optional:!0},name:{type:String,optional:!0},value:{type:String,optional:!0},id:{type:String,default:null},disabled:{type:Boolean,default:!1},tabIndex:{type:Number,default:0}},inheritAttrs:!1,setup(w,{emit:n,attrs:r,slots:s,expose:c}){var h;let g=(h=w.id)!=null?h:`headlessui-switch-${vl()}`,d=Ia(uc,null),[y,T]=sc(_e(()=>w.modelValue),M=>n("update:modelValue",M),_e(()=>w.defaultChecked));function C(){T(!y.value)}let f=te(null),u=d===null?f:d.switchRef,p=lc(_e(()=>({as:w.as,type:r.type})),u);c({el:u,$el:u});function v(M){M.preventDefault(),C()}function E(M){M.key===na.Space?(M.preventDefault(),C()):M.key===na.Enter&&cc(M.currentTarget)}function b(M){M.preventDefault()}let k=_e(()=>{var M,x;return(x=(M=ui(u))==null?void 0:M.closest)==null?void 0:x.call(M,"form")});return Pt(()=>{lt([k],()=>{if(!k.value||w.defaultChecked===void 0)return;function M(){T(w.defaultChecked)}return k.value.addEventListener("reset",M),()=>{var x;(x=k.value)==null||x.removeEventListener("reset",M)}},{immediate:!0})}),()=>{let{name:M,value:x,form:A,tabIndex:m,...O}=w,N={checked:y.value},H={id:g,ref:u,role:"switch",type:p.value,tabIndex:m===-1?0:m,"aria-checked":y.value,"aria-labelledby":d==null?void 0:d.labelledby.value,"aria-describedby":d==null?void 0:d.describedby.value,onClick:v,onKeyup:E,onKeypress:b};return Jr(kt,[M!=null&&y.value!=null?Jr(bl,wl({features:El.Hidden,as:"input",type:"checkbox",hidden:!0,readOnly:!0,checked:y.value,form:A,disabled:O.disabled,name:M,value:x})):null,yl({ourProps:H,theirProps:{...r,...Sl(O,["modelValue","defaultChecked"])},slot:N,attrs:r,slots:s,name:"Switch"})])}}});const fc={class:"bg-gray-800 p-6 rounded-lg"},hc={class:"space-y-4"},pc={class:"flex justify-end gap-2"},mc=mt({__name:"Searchmode",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","search-result"],setup(w,{expose:n,emit:r}){const s=Ie(),h=rn().public.baseApi,g=w,d=r,y=_e({get:()=>g.modelValue,set:u=>d("update:modelValue",u)}),T=()=>{d("update:modelValue",!1)},C=te(""),f=async()=>{var u,p;if(!C.value.trim()){s.add({title:"提示",description:"请输入搜索关键词",color:"yellow"});return}try{const{data:v,error:E}=await jl("/messages/search",{method:"GET",baseURL:h,params:{keyword:C.value,page:1,pageSize:10}},"$4cD5OWGgav");if(E.value)throw new Error(((u=E.value)==null?void 0:u.message)||"网络请求失败");if(!v.value)throw new Error("未收到服务器响应");if(v.value.code===1)d("search-result",v.value),d("update:modelValue",!1),C.value="",s.add({title:"成功",description:"搜索完成",color:"green"});else throw new Error(((p=v.value)==null?void 0:p.msg)||"搜索失败")}catch(v){console.error("Search error:",v),s.add({title:"错误",description:v instanceof Error?v.message:"搜索失败，请稍后重试",color:"red"})}};return n({handleSearch:f}),(u,p)=>{const v=lr,E=jt,b=Ua;return le(),Ot(b,{modelValue:y.value,"onUpdate:modelValue":p[1]||(p[1]=k=>y.value=k)},{default:Ve(()=>[V("div",fc,[p[4]||(p[4]=V("h3",{class:"text-xl font-semibold text-white mb-4"},"搜索内容",-1)),V("div",hc,[ce(v,{modelValue:C.value,"onUpdate:modelValue":p[0]||(p[0]=k=>C.value=k),placeholder:"输入搜索关键词",class:"w-full",onKeyup:Na(f,["enter"])},null,8,["modelValue"]),V("div",pc,[ce(E,{variant:"ghost",color:"gray",onClick:T,class:"text-white hover:text-white"},{default:Ve(()=>p[2]||(p[2]=[et(" 取消 ")])),_:1}),ce(E,{color:"primary",onClick:f,class:"text-white hover:text-white"},{default:Ve(()=>p[3]||(p[3]=[et(" 搜索 ")])),_:1})])])])]),_:1},8,["modelValue"])}}}),uo=sn(mc,[["__scopeId","data-v-91c9a787"]]),gc=Ha("notify",{state:()=>({config:{webhookEnabled:!1,webhookURL:"",telegramEnabled:!1,telegramToken:"",telegramChatID:"",weworkEnabled:!1,weworkKey:"",feishuEnabled:!1,feishuWebhook:"",feishuSecret:"",twitterEnabled:!1,twitterApiKey:"",twitterApiSecret:"",twitterAccessToken:"",twitterAccessTokenSecret:"",customHttpEnabled:!1,customHttpUrl:"",customHttpMethod:"POST",customHttpHeaders:"",customHttpBody:'{"content":"{{content}}"}'}}),actions:{async fetchConfig(){try{const n=await(await fetch("/api/notify/config",{credentials:"include"})).json();n.code===1&&(this.config=n.data)}catch(w){console.error("获取推送配置失败:",w)}},async saveConfig(w){try{const r=await(await fetch("/api/notify/config",{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)})).json();if(r.code===1){const s=r.data||w;return Object.keys(this.config).forEach(c=>{c.endsWith("Enabled")?this.config[c]=!!s[c]&&s[c]!=="false":s[c]!==void 0&&(this.config[c]=s[c])}),!0}return!1}catch(n){return console.error("保存推送配置失败:",n),!1}},async testNotify(w){try{return(await(await fetch("/api/notify/test",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:w})})).json()).code===1}catch(n){return console.error("测试推送失败:",n),!1}},async sendNotify(w){try{let n=w.content;return w.images&&w.images.length>0&&(n+=`

`,w.images.forEach(c=>{n+=`![](${c})
`})),(await(await fetch("/api/notify/send",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:n,format:w.format||"markdown",config:this.config})})).json()).code===1}catch(n){return console.error("发送推送失败:",n),!1}}}}),vc=mt({__name:"VideoUpload",emits:["video-uploaded","upload-progress"],setup(w,{emit:n}){const r=n,s=te(null),c=Ie(),h=rn().public.baseApi,g=()=>{var y;(y=s.value)==null||y.click()},d=async y=>{const T=y.target,C=T.files?T.files[0]:null;if(!C){c.add({title:"错误",description:"未选择视频",color:"red"});return}const f=200*1024*1024;if(C.size>f){c.add({title:"错误",description:"视频不能超过200MB",color:"red"});return}const u=new FormData;u.append("video",C);const p=new XMLHttpRequest;p.open("POST",`${h}/videos/upload`,!0),p.withCredentials=!0,p.upload.onprogress=v=>{if(v.lengthComputable){const E=Math.round(v.loaded/v.total*100);r("upload-progress",E)}},p.onload=()=>{if(p.status===200)try{const v=JSON.parse(p.responseText);if(v.code===1&&v.data)r("video-uploaded",v.data),c.add({title:"成功",description:"视频上传成功",color:"green"});else throw new Error(v.msg||"视频上传失败")}catch(v){c.add({title:"错误",description:v.message||"视频上传失败",color:"red"})}else c.add({title:"错误",description:"视频上传失败",color:"red"});r("upload-progress",0),s.value&&(s.value.value="")},p.onerror=()=>{c.add({title:"错误",description:"视频上传失败",color:"red"}),r("upload-progress",0),s.value&&(s.value.value="")},p.send(u)};return(y,T)=>{const C=jt;return le(),me("div",null,[V("input",{ref_key:"videoInput",ref:s,type:"file",accept:"video/*",class:"hidden",onChange:d},null,544),ce(C,{color:"gray",variant:"solid",size:"sm",icon:"i-mdi-video",class:"cursor-pointer",onClick:g,title:"上传视频"})])}}}),Jt=ja(kn.ui.strategy,kn.ui.toggle,Fl),yc=mt({components:{HSwitch:dc,UIcon:Mn},inheritAttrs:!1,props:{id:{type:String,default:null},name:{type:String,default:null},modelValue:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},onIcon:{type:String,default:()=>Jt.default.onIcon},offIcon:{type:String,default:()=>Jt.default.offIcon},loadingIcon:{type:String,default:()=>Jt.default.loadingIcon},color:{type:String,default:()=>Jt.default.color,validator(w){return kn.ui.colors.includes(w)}},size:{type:String,default:()=>Jt.default.size,validator(w){return Object.keys(Jt.size).includes(w)}},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue","change"],setup(w,{emit:n}){const{ui:r,attrs:s}=Ba("toggle",fi(w,"ui"),Jt),{emitFormChange:c,color:h,inputId:g,name:d}=Cl(w),y=_e({get(){return w.modelValue},set(v){n("update:modelValue",v),n("change",v),c()}}),T=_e(()=>ll(St(r.value.base,r.value.size[w.size],r.value.rounded,h.value&&r.value.ring.replaceAll("{color}",h.value),h.value&&(y.value?r.value.active:r.value.inactive).replaceAll("{color}",h.value)),w.class)),C=_e(()=>St(r.value.container.base,r.value.container.size[w.size],y.value?r.value.container.active[w.size]:r.value.container.inactive)),f=_e(()=>St(r.value.icon.size[w.size],h.value&&r.value.icon.on.replaceAll("{color}",h.value))),u=_e(()=>St(r.value.icon.size[w.size],h.value&&r.value.icon.off.replaceAll("{color}",h.value))),p=_e(()=>St(r.value.icon.size[w.size],h.value&&r.value.icon.loading.replaceAll("{color}",h.value)));return Tl(()=>ul()),{ui:r,attrs:s,name:d,inputId:g,active:y,switchClass:T,containerClass:C,onIconClass:f,offIconClass:u,loadingIconClass:p}}});function bc(w,n,r,s,c,h){const g=Mn,d=cl("HSwitch");return le(),Ot(d,ci({id:w.inputId,modelValue:w.active,"onUpdate:modelValue":n[0]||(n[0]=y=>w.active=y),name:w.name,disabled:w.disabled||w.loading,class:w.switchClass},w.attrs),{default:Ve(()=>[V("span",{class:at(w.containerClass)},[w.loading?(le(),me("span",{key:0,class:at([w.ui.icon.active,w.ui.icon.base]),"aria-hidden":"true"},[ce(g,{name:w.loadingIcon,class:at(w.loadingIconClass)},null,8,["name","class"])],2)):Se("",!0),!w.loading&&w.onIcon?(le(),me("span",{key:1,class:at([w.active?w.ui.icon.active:w.ui.icon.inactive,w.ui.icon.base]),"aria-hidden":"true"},[ce(g,{name:w.onIcon,class:at(w.onIconClass)},null,8,["name","class"])],2)):Se("",!0),!w.loading&&w.offIcon?(le(),me("span",{key:2,class:at([w.active?w.ui.icon.inactive:w.ui.icon.active,w.ui.icon.base]),"aria-hidden":"true"},[ce(g,{name:w.offIcon,class:at(w.offIconClass)},null,8,["name","class"])],2)):Se("",!0)],2)]),_:1},16,["id","modelValue","name","disabled","class"])}const wc=sn(yc,[["render",bc]]),Sn=ja(kn.ui.strategy,kn.ui.progress,zl),Ec=mt({inheritAttrs:!1,props:{value:{type:Number,default:null},max:{type:[Number,Array],default:100},indicator:{type:Boolean,default:!1},animation:{type:String,default:()=>Sn.default.animation,validator(w){return Object.keys(Sn.animation).includes(w)}},size:{type:String,default:()=>Sn.default.size,validator(w){return Object.keys(Sn.progress.size).includes(w)}},color:{type:String,default:()=>Sn.default.color,validator(w){return kn.ui.colors.includes(w)}},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(w){const{ui:n,attrs:r}=Ba("progress",fi(w,"ui"),Sn,fi(w,"class")),s=_e(()=>St(n.value.indicator.container.base,n.value.indicator.container.width,n.value.indicator.container.transition)),c=_e(()=>St(n.value.indicator.align,n.value.indicator.width,n.value.indicator.color,n.value.indicator.size[w.size])),h=_e(()=>{var M;const k=[n.value.progress.base,n.value.progress.width,n.value.progress.size[w.size],n.value.progress.rounded,n.value.progress.track,n.value.progress.bar,(M=n.value.progress.color)==null?void 0:M.replaceAll("{color}",w.color),n.value.progress.background,n.value.progress.indeterminate.base,n.value.progress.indeterminate.rounded];return p.value&&k.push(n.value.animation[w.animation]),St(...k)}),g=_e(()=>{var k;return St(n.value.steps.base,(k=n.value.steps.color)==null?void 0:k.replaceAll("{color}",w.color),n.value.steps.size[w.size])}),d=_e(()=>St(n.value.step.base,n.value.step.align)),y=_e(()=>St(n.value.step.active)),T=_e(()=>St(n.value.step.first));function C(k){return k===Number(w.value)}function f(k){return k===0}function u(k){k=Number(k);const M=[d.value];return f(k)&&M.push(T.value),C(k)&&M.push(y.value),M.join(" ")}const p=_e(()=>w.value===void 0||w.value===null),v=_e(()=>Array.isArray(w.max)),E=_e(()=>p.value?null:Array.isArray(w.max)?w.max.length-1:Number(w.max)),b=_e(()=>{if(!p.value)switch(!0){case w.value<0:return 0;case w.value>E.value:return 100;default:return w.value/E.value*100}});return{ui:n,attrs:r,indicatorContainerClass:s,indicatorClass:c,progressClass:h,stepsClass:g,stepClasses:u,isIndeterminate:p,isSteps:v,realMax:E,percent:b}}}),Sc=["aria-valuemax","aria-valuenow"];function Cc(w,n,r,s,c,h){return le(),me("div",{class:at(w.ui.wrapper),role:"progressbar"},[w.indicator||w.$slots.indicator?Qr(w.$slots,"indicator",dl(ci({key:0},{percent:w.percent})),()=>[w.isSteps?Se("",!0):(le(),me("div",{key:0,class:at(w.indicatorContainerClass),style:an({width:`${w.percent}%`})},[V("div",{class:at(w.indicatorClass)},Ze(Math.round(w.percent))+"% ",3)],6))],!0):Se("",!0),V("progress",ci({"aria-valuemax":w.realMax,"aria-valuenow":w.value,class:w.progressClass},{value:w.value,max:w.realMax,...w.attrs}),Ze(w.percent!==void 0?`${Math.round(w.percent)}%`:void 0),17,Sc),w.isSteps?(le(),me("div",{key:1,class:at(w.stepsClass)},[(le(!0),me(kt,null,Vt(w.max,(g,d)=>(le(),me("div",{key:d,class:at(w.stepClasses(d))},[Qr(w.$slots,`step-${d}`,ci({ref_for:!0},{step:g}),()=>[et(Ze(g),1)],!0)],2))),128))],2)):Se("",!0)],2)}const Tc=sn(Ec,[["render",Cc],["__scopeId","data-v-157fbd8e"]]),kc={class:"flex justify-between items-center mb-3"},Mc={class:"mb-4"},xc={class:"flex gap-2 mb-3"},_c={key:0,class:"space-y-2 mb-3"},Lc={class:"flex items-center gap-2"},Ac={class:"flex justify-end mt-2 mb-3"},Dc=["src"],Oc={key:3,class:"text-sm text-gray-300"},Pc={key:4,class:"text-sm text-gray-300"},Rc={key:1,class:"flex justify-end mt-2"},Hc={key:2,class:"mt-2 text-red-400 text-sm"},Ic={key:3,class:"mt-2"},Nc={class:"flex items-center gap-2 bg-gray-800 p-2 rounded"},jc=["value"],Bc={class:"flex justify-end mt-2"},zc=mt({__name:"ImageHostingUploader",props:{position:{type:Object,required:!0,default:()=>({x:0,y:0})},editorRef:{type:Object,required:!1,default:null}},emits:["close","upload-success"],setup(w,{emit:n}){const r=w,s=_e(()=>{if(typeof window>"u")return{};const j=window.innerWidth,U=window.innerHeight,X=400,ue=500;let $=r.position.x,he=r.position.y;return $+X>j&&($=j-X-20),$<0&&($=20),he+ue>U&&(he=U-ue-20),he<0&&(he=20),j<768&&($=(j-X)/2,he=60),{position:"fixed",top:`${he}px`,left:`${$}px`,maxWidth:`${Math.min(X,j-40)}px`,width:"100%",cursor:"move",userSelect:"none",touchAction:"none"}}),c=te(!1),h=te({x:0,y:0}),g=j=>{c.value=!0;const U="touches"in j?j.touches[0].clientX:j.clientX,X="touches"in j?j.touches[0].clientY:j.clientY;h.value={x:U-r.position.x,y:X-r.position.y},document.addEventListener("mousemove",d),document.addEventListener("touchmove",d),document.addEventListener("mouseup",y),document.addEventListener("touchend",y)},d=j=>{if(!c.value)return;const U="touches"in j?j.touches[0].clientX:j.clientX,X="touches"in j?j.touches[0].clientY:j.clientY;T("update:position",{x:U-h.value.x,y:X-h.value.y})},y=()=>{c.value=!1,document.removeEventListener("mousemove",d),document.removeEventListener("touchmove",d),document.removeEventListener("mouseup",y),document.removeEventListener("touchend",y)},T=n,C=Ie(),f=te("smms"),u=te(null),p=te(!1),v=te(!1),E=te(0),b=te(""),k=te(""),M=te(""),x=te(""),A=te(""),m=te("main"),O=te("images/"),N=te(!1),H=te(""),R=te(""),z=te(""),Y=()=>{var j;(j=u.value)==null||j.click()},K=j=>{var X;p.value=!1;const U=(X=j.dataTransfer)==null?void 0:X.files;U&&U.length>0&&we(U[0])},re=j=>{const X=j.target.files;X&&X.length>0&&we(X[0])},pe=te(null),we=async j=>{if(!j.type.startsWith("image/")){M.value="请选择图片文件";return}const U=5*1024*1024;if(j.size>U){M.value="图片大小不能超过 5MB";return}M.value="",pe.value=j;const X=new FileReader;X.onload=ue=>{var $;b.value=($=ue.target)==null?void 0:$.result},X.readAsDataURL(j)},ge=()=>{if(!k.value){M.value="请先上传图片";return}const j=`![](${k.value})`;T("upload-success",j),T("close"),pe.value=null,b.value="",k.value="",E.value=0,v.value=!1,M.value=""},ie=async j=>{try{await navigator.clipboard.writeText(j),C.add({title:"成功",description:"已复制到剪贴板",color:"green",timeout:2e3})}catch{C.add({title:"错误",description:"复制失败",color:"red",timeout:2e3})}},fe=async()=>{if(!pe.value){M.value="请先选择图片";return}v.value=!0,E.value=0,M.value="";try{switch(f.value){case"github":await Ae(pe.value);break;default:throw new Error("未知的图床类型")}}catch(j){console.error("上传错误:",j),M.value=j.message||"上传失败",v.value=!1,j.name==="AbortError"?M.value="请求超时，请检查网络连接":j.message.includes("Failed to fetch")&&(M.value="网络请求失败，可能是跨域问题或API不可用")}},Ae=async j=>{if(!x.value||!A.value){M.value="请先配置 GitHub Token 和仓库名";return}try{E.value=30;const U=Date.now(),X=j.name.split(".").pop(),ue=`${U}.${X}`,$=`${O.value}${ue}`.replace(/\/\//g,"/"),he=await Fe(j),J={message:`Upload image ${ue}`,content:he,branch:m.value||"main"};E.value=50;const F=await fetch(`https://api.github.com/repos/${A.value}/contents/${$}`,{method:"PUT",headers:{Authorization:`token ${x.value}`,"Content-Type":"application/json"},body:JSON.stringify(J)});if(E.value=80,!F.ok)throw new Error(`GitHub 上传失败: ${F.status}`);const Le=await F.json();k.value=N.value&&H.value?`https://${H.value}/gh/${A.value}@${m.value||"main"}/${$}`:Le.content.download_url,E.value=100,v.value=!1,C.add({title:"成功",description:`图片已上传到 GitHub${N.value&&H.value?" (CDN加速)":""}`,color:"green",timeout:2e3})}catch(U){console.error("GitHub 上传错误:",U),M.value=U.message||"GitHub 上传失败",v.value=!1}},Fe=j=>new Promise((U,X)=>{const ue=new FileReader;ue.onload=()=>U(ue.result.split(",")[1]),ue.onerror=X,ue.readAsDataURL(j)}),Pe=()=>{try{const j={selectedHost:f.value,github:{token:x.value,repo:A.value,branch:m.value,path:O.value,enableCDN:N.value,cdnDomain:H.value},smms:{token:R.value},freeimage:{token:z.value}};localStorage.setItem("imageHostingConfig",JSON.stringify(j)),C.add({title:"成功",description:"配置已保存",color:"green",timeout:2e3})}catch(j){console.error("保存配置失败:",j),C.add({title:"错误",description:"保存配置失败",color:"red",timeout:2e3})}},P=()=>{const j=localStorage.getItem("imageHostingConfig");if(j)try{const U=JSON.parse(j);f.value=U.selectedHost||"smms",U.github&&(x.value=U.github.token||"",A.value=U.github.repo||"",m.value=U.github.branch||"main",O.value=U.github.path||"images/",N.value=U.github.enableCDN||!1,H.value=U.github.cdnDomain||""),U.smms&&(R.value=U.smms.token||""),U.imgtp&&(imgtpToken.value=U.imgtp.token||""),U.freeimage&&(z.value=U.freeimage.token||"")}catch(U){console.error("加载配置失败:",U)}};return lt([f,x,A,m,O,R],()=>{Pe()},{deep:!0}),Pt(()=>{P()}),(j,U)=>{const X=jt,ue=lr,$=wc,he=Mn,J=Tc;return le(),me("div",{class:"fixed z-50 bg-black/80 backdrop-blur-sm rounded-lg shadow-lg p-4 text-white",style:an(s.value),onMousedown:g,onTouchstart:g},[V("div",kc,[U[11]||(U[11]=V("h3",{class:"text-lg font-medium"},"图床上传",-1)),ce(X,{icon:"i-heroicons-x-mark",color:"gray",variant:"ghost",size:"xs",onClick:U[0]||(U[0]=F=>j.$emit("close"))})]),V("div",Mc,[V("div",xc,[ce(X,{color:f.value==="github"?"blue":"gray",variant:"solid",size:"sm",onClick:U[1]||(U[1]=F=>f.value="github")},{default:Ve(()=>U[12]||(U[12]=[et(" GitHub ")])),_:1},8,["color"])]),f.value==="github"?(le(),me("div",_c,[ce(ue,{modelValue:x.value,"onUpdate:modelValue":U[2]||(U[2]=F=>x.value=F),placeholder:"GitHub Token",size:"sm",type:"password"},null,8,["modelValue"]),ce(ue,{modelValue:A.value,"onUpdate:modelValue":U[3]||(U[3]=F=>A.value=F),placeholder:"仓库名 (用户名/仓库)",size:"sm"},null,8,["modelValue"]),ce(ue,{modelValue:m.value,"onUpdate:modelValue":U[4]||(U[4]=F=>m.value=F),placeholder:"分支名 (默认: main)",size:"sm"},null,8,["modelValue"]),ce(ue,{modelValue:O.value,"onUpdate:modelValue":U[5]||(U[5]=F=>O.value=F),placeholder:"存储路径 (默认: images/)",size:"sm"},null,8,["modelValue"]),V("div",Lc,[ce($,{modelValue:N.value,"onUpdate:modelValue":U[6]||(U[6]=F=>N.value=F)},null,8,["modelValue"]),U[13]||(U[13]=V("span",{class:"text-sm"},"启用CDN加速",-1))]),N.value?(le(),Ot(ue,{key:0,modelValue:H.value,"onUpdate:modelValue":U[7]||(U[7]=F=>H.value=F),placeholder:"输入CDN域名 (如: jsd.cdn.noisework.cn)",size:"sm"},null,8,["modelValue"])):Se("",!0)])):Se("",!0),V("div",Ac,[ce(X,{color:"green",variant:"solid",size:"sm",icon:"i-heroicons-check",onClick:Pe},{default:Ve(()=>U[14]||(U[14]=[et(" 保存配置 ")])),_:1})]),V("div",{class:at(["flex flex-col items-center justify-center border-2 border-dashed border-gray-500 rounded-lg p-4 cursor-pointer hover:border-blue-400 transition-colors",{"border-blue-400":p.value}]),onClick:Y,onDragover:U[8]||(U[8]=Bi(F=>p.value=!0,["prevent"])),onDragleave:U[9]||(U[9]=Bi(F=>p.value=!1,["prevent"])),onDrop:Bi(K,["prevent"])},[V("input",{ref_key:"fileInput",ref:u,type:"file",accept:"image/*",onChange:re,class:"hidden"},null,544),!v.value&&!b.value?(le(),Ot(he,{key:0,name:"i-heroicons-cloud-arrow-up",class:"w-10 h-10 text-gray-400 mb-2"})):Se("",!0),b.value&&!v.value?(le(),me("img",{key:1,src:b.value,class:"max-h-32 max-w-full mb-2 rounded"},null,8,Dc)):Se("",!0),v.value?(le(),Ot(J,{key:2,value:E.value,color:"blue",class:"w-full mb-2"},null,8,["value"])):Se("",!0),!v.value&&!b.value?(le(),me("p",Oc," 点击或拖拽图片到此处上传 ")):Se("",!0),v.value?(le(),me("p",Pc," 上传中... "+Ze(E.value)+"% ",1)):Se("",!0)],34),b.value&&!v.value&&!k.value?(le(),me("div",Rc,[ce(X,{color:"blue",variant:"solid",size:"sm",icon:"i-heroicons-cloud-arrow-up",onClick:fe},{default:Ve(()=>U[15]||(U[15]=[et(" 开始上传 ")])),_:1})])):Se("",!0),M.value?(le(),me("div",Hc,Ze(M.value),1)):Se("",!0),k.value?(le(),me("div",Ic,[V("div",Nc,[V("input",{type:"text",value:k.value,readonly:"",class:"bg-transparent flex-1 text-sm outline-none"},null,8,jc),ce(X,{icon:"i-heroicons-clipboard",color:"gray",variant:"ghost",size:"xs",onClick:U[10]||(U[10]=F=>ie(k.value))})]),V("div",Bc,[ce(X,{color:"blue",variant:"solid",size:"sm",onClick:ge},{default:Ve(()=>U[16]||(U[16]=[et(" 插入图片 ")])),_:1})])])):Se("",!0)])],36)}}}),Fc=sn(zc,[["__scopeId","data-v-a97867d7"]]),Uc={class:"flex justify-between mb-3"},$c={class:"flex justify-start items-center gap-2"},Vc={class:"flex gap-2"},qc={href:"/rss",target:"_blank"},Wc={class:"flex justify-between items-center"},Yc={class:"flex items-center justify-start gap-2"},Kc={key:0,class:"w-full mt-2"},Gc={class:"bg-gray-700 rounded h-2"},Zc={class:"text-xs text-gray-300 mt-1 text-right"},Xc={class:"flex gap-2"},Jc={key:0,class:"mx-auto sm:max-w-2xl mt-5 backdrop-blur-sm bg-black/40 p-4 rounded-md"},Qc={class:"prose prose-invert max-w-none"},eu=["innerHTML"],tu={key:0,class:"prose prose-invert max-w-none"},nu=["innerHTML"],iu=mt({__name:"AddForm",emits:["search-result","video-uploaded","before-upload","upload-progress"],setup(w,{emit:n}){const r=te(!1),s=te({x:400,y:320}),c=ge=>{var ie;(ie=m.value)!=null&&ie.insertValue&&m.value.insertValue(ge),r.value=!1},h=ge=>{s.value=ge},g=te(0),d=ge=>{g.value=ge},y=te(!1),T=n,C=ge=>{T("search-result",ge)},f=Ie(),u=rn().public.baseApi,{save:p}=qa(),v=Ia("showHeatmap");Fa("showHeatmap",v);const E=()=>{v.value=!v.value},b=te(""),k=te(""),M=te(""),x=te(!1),A=te(null),m=te(null);_e(()=>x.value?"i-mdi-eye-off-outline":"i-mdi-eye-outline"),gc();const O=te(localStorage.getItem("enableNotify")==="true"),N=()=>{b.value="",k.value="",M.value="",x.value=!1,m.value&&m.value.clear()},H=za(),R=()=>H.isLogin?!0:(f.add({title:"提示",description:"请先登录",color:"orange",timeout:2e3}),!1),z=()=>{const ge=document.getElementById("file-input");ge&&ge.click()},Y=async ge=>{var j;if(!R())return;const ie=ge.target,fe=ie.files?ie.files[0]:null;if(!fe){f.add({title:"错误",description:"没有选择文件",color:"red",timeout:2e3});return}const Ae=["image/jpeg","image/png","image/gif","image/webp"],Fe=[".jpg",".jpeg",".png",".gif",".webp"],Pe=fe.name.toLowerCase().substring(fe.name.lastIndexOf("."));if(!Ae.includes(fe.type)||!Fe.includes(Pe)){f.add({title:"错误",description:"仅支持 JPG、PNG、GIF、WEBP 格式的图片",color:"red",timeout:2e3});return}const P=5*1024*1024;if(fe.size>P){f.add({title:"错误",description:"图片大小不能超过 5MB",color:"red",timeout:2e3});return}try{const U=new FormData;U.append("image",fe);const X=await fetch(`${u}/images/upload`,{method:"POST",body:U,credentials:"include"});if(!X.ok){const $=await X.json();throw new Error($.msg||"图片上传失败")}const ue=await X.json();if(ue.code===1&&ue.data){if((j=m.value)!=null&&j.insertValue){const he=`
![](${typeof window<"u"?window.location.origin:""}${u}${ue.data})
`;m.value.insertValue(he)}f.add({title:"成功",description:"图片上传成功",color:"green",timeout:2e3})}else throw new Error(ue.msg||"图片上传失败")}catch(U){console.error("上传错误:",U),f.add({title:"错误",description:U.message||"图片上传失败",color:"red",timeout:2e3})}finally{A.value&&(A.value.value="")}},K=ge=>{var Fe;const ie=typeof window<"u"?window.location.origin:"",fe=ge.startsWith("/")?ge:`/${ge}`,Ae=`<video width="100%" height="100%" src="${ie}${fe}" controls loop></video>
`;(Fe=m.value)!=null&&Fe.insertValue&&m.value.insertValue(Ae)};lt(k,ge=>{M.value=gi.md2html(ge||"")}),lt(()=>H.isLogin,ge=>{ge&&(O.value=localStorage.getItem("enableNotify")==="true")},{immediate:!0}),Pt(async()=>{xe.bind("[data-fancybox]",{}),H.isLogin||localStorage.getItem("token")&&H.fetchUserInfo&&await H.fetchUserInfo()}),vi(()=>{xe.destroy()});const re=()=>{O.value=!O.value,localStorage.setItem("enableNotify",O.value.toString())},pe=ge=>H.isLogin?!0:(f.add({title:"提示",description:"请登录后操作",color:"orange",timeout:2e3}),ge.preventDefault&&ge.preventDefault(),!1),we=async()=>{if(!R())return;if(!k.value.trim()){f.add({title:"错误",description:"请输入内容或上传图片/视频",color:"red",timeout:2e3});return}const ge={username:b.value,content:k.value,private:x.value,notify:x.value?!1:O.value};try{await p(ge)&&N()}catch(ie){console.error("发布错误:",ie),f.add({title:"错误",description:ie.message||"发布失败",color:"red",timeout:2e3})}};return(ge,ie)=>{const fe=Mn,Ae=kl,Fe=fl,Pe=sr;return le(),me(kt,null,[ce(Pe,{class:"mx-auto sm:max-w-2xl hover:shadow-md backdrop-blur-sm bg-black/40 shadow-lg text-white"},{default:Ve(()=>[V("div",Uc,[V("div",$c,[ce(fe,{name:"i-heroicons-pencil-square",class:"w-6 h-6 transition-all duration-300 hover:scale-110 hover:text-blue-400 animate-pulse"}),ie[5]||(ie[5]=V("h2",{class:"text-lg font-bold italic text-white"},"说说·笔记~",-1))]),V("div",Vc,[ce(Ae,null,{default:Ve(()=>[V("div",{onClick:ie[0]||(ie[0]=P=>y.value=!0),class:"cursor-pointer flex"},[ce(fe,{name:"i-heroicons-magnifying-glass",class:"w-5 h-5 text-gray-200"})]),V("button",{onClick:E},[ce(fe,{name:"i-mdi-calendar-month",class:"w-5 h-5 text-gray-200"})]),V("a",qc,[ce(fe,{name:"i-mdi-rss",class:"w-5 h-5 text-gray-200"})])]),_:1}),ce(Fe,{to:"/status"},{default:Ve(()=>[ce(fe,{name:"i-mdi-server-outline",class:"w-5 h-5 text-gray-200"})]),_:1})])]),V("div",null,[ce(oc,{ref_key:"vditorEditor",ref:m,modelValue:k.value,"onUpdate:modelValue":ie[1]||(ie[1]=P=>k.value=P)},null,8,["modelValue"]),V("div",Wc,[V("div",Yc,[V("input",{id:"file-input",ref_key:"fileInput",ref:A,type:"file",accept:"image/*",onChange:Y,class:"hidden",placeholder:"选择图片"},null,544),ce(vc,{onVideoUploaded:K,onBeforeUpload:pe,onUploadProgress:d}),g.value>0&&g.value<100?(le(),me("div",Kc,[V("div",Gc,[V("div",{class:"bg-blue-500 h-2 rounded",style:an({width:g.value+"%"})},null,4)]),V("div",Zc,Ze(g.value)+"%",1)])):Se("",!0),ce(Te(jt),{color:"gray",variant:"solid",class:"cursor-pointer",size:"sm",icon:"i-fluent-image-20-regular",onClick:z}),ce(Te(jt),{color:"gray",variant:"solid",class:"cursor-pointer",size:"sm",icon:"i-mdi-cloud-upload-outline",onClick:ie[2]||(ie[2]=P=>r.value=!0),title:"图床上传"}),ce(Te(jt),{color:"gray",variant:"solid",size:"sm",onClick:re,icon:O.value?"i-mdi-bell":"i-mdi-bell-off",title:O.value?"关闭推送":"开启推送",ui:{tooltip:{text:O.value?"关闭推送":"开启推送"}},class:"text-gray-600"},null,8,["icon","title","ui"])]),V("div",Xc,[ce(Te(jt),{icon:"i-fluent-broom-16-regular",variant:"solid",color:"gray",size:"sm",onClick:N}),ce(Te(jt),{icon:"i-fluent-add-12-filled",variant:"solid",color:"gray",size:"sm",onClick:we})])])])]),_:1}),M.value?(le(),me("div",Jc,[V("div",Qc,[V("div",{innerHTML:M.value},null,8,eu)]),ie[6]||(ie[6]=V("hr",{class:"border-gray-600 my-4"},null,-1)),M.value?(le(),me("div",tu,[V("div",{innerHTML:M.value},null,8,nu)])):Se("",!0)])):Se("",!0),ce(uo,{modelValue:y.value,"onUpdate:modelValue":ie[3]||(ie[3]=P=>y.value=P),onSearchResult:C},null,8,["modelValue"]),r.value?(le(),Ot(Fc,{key:1,position:s.value,onClose:ie[4]||(ie[4]=P=>r.value=!1),onUploadSuccess:c,"onUpdate:position":h},null,8,["position"])):Se("",!0)],64)}}}),Ra=mt({__name:"MarkdownRenderer",props:{content:{type:String,required:!0}},emits:["tagClick"],setup(w,{emit:n}){const r=/https:\/\/www\.bilibili\.com\/video\/(BV[\w]+)\/?$/,s=/https:\/\/(?:www\.)?youtube\.com\/watch\?v=([\w-]+)|https:\/\/youtu\.be\/([\w-]+)/,c=/https:\/\/music\.163\.com(?:\/#)?\/song\?id=(\d+)/,h=/https:\/\/y\.qq\.com\/n\/yqq\/song(\w+)\.html/,g=/https:\/\/v\.qq\.com\/x\/cover\/\w+\/(\w+)\.html/,d=/https:\/\/open\.spotify\.com\/(track|album|playlist)\/([a-zA-Z0-9]+)/,y=/https:\/\/v\.youku\.com\/v_show\/id_([a-zA-Z0-9]+)\.html/,T=n,C=te(null);let f=null;const u=w,p=()=>{var x;if(window.mediumZoom){f&&f.detach();const A=(x=C.value)==null?void 0:x.getElementsByTagName("img");A&&A.length>0&&(f=window.mediumZoom(A,{background:"rgba(0, 0, 0, 0.9)",margin:24,scrollOffset:0}))}},v=new RegExp("(?<!!)\\[([^\\]]+)\\]\\((https:\\/\\/github\\.com\\/([\\w-]+)\\/([\\w.-]+)(?:\\/[^\\s)]*)?)\\)","g"),E=new RegExp(`(?<!["'\\(])\\bhttps:\\/\\/github\\.com\\/([\\w-]+)\\/([\\w.-]+)(?:\\/[^\\s<\\)]*)?\\b`,"g"),b=x=>(x=x.replace(v,(A,m,O,N,H)=>`<div class="github-card" id="${`github-card-${N}-${H}`}" data-owner="${N}" data-repo="${H}">
      <div class="github-card-loading">Loading GitHub Repo...</div>
    </div>`),x=x.replace(E,(A,m,O)=>`<div class="github-card" id="${`github-card-${m}-${O}`}" data-owner="${m}" data-repo="${O}">
      <div class="github-card-loading">Loading GitHub Repo...</div>
    </div>`),x.replace(r,"<div class='video-wrapper'><iframe src='https://www.bilibili.com/blackboard/html5mobileplayer.html?bvid=$1&as_wide=1&high_quality=1&danmaku=0' scrolling='no' border='0' frameborder='no' framespacing='0' allowfullscreen='true' style='position:absolute;height:100%;width:100%'></iframe></div>").replace(s,"<div class='video-wrapper'><iframe src='https://www.youtube.com/embed/$1$2' title='YouTube video player' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen></iframe></div>").replace(c,"<div class='music-wrapper'><meting-js auto='https://music.163.com/#/song?id=$1'></meting-js></div>").replace(h,"<meting-js auto='https://y.qq.com/n/yqq/song$1.html'></meting-js>").replace(g,"<div class='video-wrapper'><iframe src='//v.qq.com/iframe/player.html?vid=$1' allowFullScreen='true' frameborder='no'></iframe></div>").replace(d,"<div class='spotify-wrapper'><iframe style='border-radius:12px' src='https://open.spotify.com/embed/$1/$2?utm_source=generator&theme=0' width='100%' frameBorder='0' allowfullscreen='' allow='autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture' loading='lazy'></iframe></div>").replace(y,"<div class='video-wrapper'><iframe src='https://player.youku.com/embed/$1' frameborder=0 'allowfullscreen'></iframe></div>")),k=async(x,A,m)=>{try{const O=await fetch(`https://api.github.com/repos/${x}/${A}`);if(!O.ok)return;const N=await O.json(),H=document.getElementById(m);H&&(H.innerHTML=`
        <div class="github-card-header">
          <img src="${N.owner.avatar_url}" class="github-card-avatar" />
          <div>
            <a href="${N.html_url}" target="_blank" class="github-card-title">${N.full_name}</a>
            <div class="github-card-desc">${N.description||""}</div>
          </div>
        </div>
        <div class="github-card-footer">
          <span>⭐ ${N.stargazers_count}</span>
          <span>🍴 ${N.forks_count}</span>
          <span>🛠️ ${N.language||""}</span>
        </div>
      `)}catch{}},M=async x=>{if(C.value)try{if(typeof gi>"u"){console.error("Vditor is not loaded.");return}const m=b(x).replace(/<a /g,'<a target="_blank" ').replace(new RegExp("(?<!<[^>]*)#([^\\s#<>]+)(?![^<]*>)","g"),`<span class="clickable-tag" onclick="window.handleTagClick('$1')" style="cursor: pointer; color: #fb923c;">#$1</span>`);gi.preview(C.value,m,{mode:"light",lang:"zh_CN",theme:{current:"dark"},hljs:{style:"github-dark",lineNumber:!0,enable:!0},after:()=>{var R,z,Y;const O=(R=C.value)==null?void 0:R.querySelectorAll("a");O==null||O.forEach(K=>{K.hasAttribute("target")||(K.setAttribute("target","_blank"),K.setAttribute("rel","noopener noreferrer"))}),p(),console.log("Rendering complete.");const N=(z=C.value)==null?void 0:z.querySelectorAll(".clickable-tag");N==null||N.forEach(K=>{K.addEventListener("click",re=>{var we;re.preventDefault();const pe=(we=K.textContent)==null?void 0:we.substring(1);pe&&T("tagClick",pe)})});const H=(Y=C.value)==null?void 0:Y.querySelectorAll(".github-card");H==null||H.forEach(K=>{const re=K.getAttribute("data-owner"),pe=K.getAttribute("data-repo"),we=K.id;re&&pe&&we&&k(re,pe,we)})}})}catch(A){console.error("Error rendering markdown:",A),C.value.innerHTML=""}};return lt(()=>u.content,async x=>{await M(x)},{immediate:!0}),Pt(()=>{M(u.content),window.APlayer&&window.MetingJSElement?console.log("MetingJS is ready"):console.error("MetingJS or APlayer is not loaded properly")}),vi(()=>{f&&(f.detach(),f=null)}),(x,A)=>(le(),me("div",{ref_key:"previewElement",ref:C,class:"markdown-preview"},null,512))}}),ru={class:"min-h-screen flex flex-col"},au={key:0,class:"text-center text-gray-500 py-8"},ou={class:"flex-grow mx-auto w-full sm:max-w-2xl px-2"},su={key:0,class:"flex justify-between items-center mb-4 p-4 rounded-lg"},lu={class:"text-gray-400"},cu={class:"my-4"},uu={key:0,class:"text-center text-gray-500 py-8"},du={class:"flex justify-between items-center"},fu={class:"flex justify-start items-center h-auto overflow-x-auto whitespace-nowrap hide-scrollbar"},hu={class:"flex justify-start text-sm"},pu={class:"text-orange-500"},mu={class:"text-orange-500"},gu={class:"message-actions flex justify-end items-center space-x-2 flex-shrink-0 px-3 py-1.5 mr-[9px] -mb-[1px]"},vu={key:0,class:"w-5 h-5 flex-shrink-0 transition-transform duration-200 hover:scale-110"},yu=["onClick"],bu=["onClick"],wu=["onClick"],Eu=["onClick"],Su=["onClick"],Cu={class:"border-l-2 border-gray-300 p-4 ml-1"},Tu=["data-msg-id"],ku=["src","fetchpriority"],Mu={key:1,class:"border-t border-gray-600 my-4"},xu={key:0,class:"absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t from-[rgba(36,43,50,1)] via-[rgba(36,43,50,0.8)] to-transparent"},_u={key:2,class:"text-center mt-2 relative",style:{"z-index":"9999"}},Lu=["onClick"],Au={class:"mt-4"},Du=["id"],Ou={key:1,class:"flex justify-center items-center space-x-4 w-full my-4 flex-wrap md:flex-nowrap"},Pu={class:"flex justify-center items-center space-x-4 w-full md:w-auto"},Ru={key:2,class:"ml-2 text-orange-400"},Hu={class:"flex items-center justify-center space-x-2 w-full md:w-auto mt-3 md:mt-0"},Iu={class:"text-gray-500 text-shadow-sm text-sm"},Nu={key:2,class:"text-center text-gray-500 mt-4"},ju={key:1,class:"text-center text-xs text-gray-400 py-4"},Bu=["innerHTML"],zu={class:"flex justify-between items-center"},Fu={class:"flex flex-col space-y-4"},Uu={class:"border-t border-gray-200 my-2 pt-2"},$u={class:"p-4 rounded-lg overflow-auto max-h-[300px] bg-[rgba(36,43,50,0.95)]"},Vu={class:"text-white"},qu={class:"flex justify-end space-x-2"},Wu=mt({__name:"MessageList",props:{siteConfig:{type:Object,required:!0},targetMessageId:{type:String,default:null}},setup(w,{expose:n}){const r=te(""),s=_e(()=>Math.ceil(d.total/15)),c=async()=>{const P=parseInt(r.value);if(!P||P<1||P>s.value||d.loading){Ie().add({title:"页码无效",description:`请输入 1-${s.value} 之间的数字`,color:"orange",timeout:2e3});return}try{const j=await d.getMessages({page:P,pageSize:15});if(!j)throw new Error("跳转页面失败");d.messages=j.items,window.scrollTo({top:0,behavior:"instant"}),r.value=""}catch(j){console.error("跳转页面失败:",j),Ie().add({title:"跳转失败",color:"red",timeout:2e3})}},h=w;lt(()=>h.targetMessageId,async P=>{if(!P)return;await nt();const j=document.querySelector(`.content-container[data-msg-id="${P}"]`);j&&(j.scrollIntoView({behavior:"smooth",block:"center"}),j.classList.add("highlight-message"),setTimeout(()=>{j.classList.remove("highlight-message")},2e3))},{immediate:!0});const g=rn().public.baseApi;qa();const d=Va(),y=te(null),T=za(),C=_e(()=>T.isLogin),f=async P=>{try{const j=encodeURIComponent(P.trim()),U=await fetch(`${g}/messages/tags/${j}`,{credentials:"include",headers:{Accept:"application/json"}});if(!U.ok)throw new Error(`HTTP error! status: ${U.status}`);const X=await U.json();if(X.code===1&&Array.isArray(X.data))ie.value=!0,fe.value=X.data,await nt(),A(),v();else throw new Error(X.msg||"获取标签内容失败")}catch(j){console.error("获取标签消息失败:",j),Ie().add({title:"获取标签消息失败",description:j.message||"服务器错误，请稍后重试",color:"red",timeout:3e3})}},u=async()=>{fe.value=[],ie.value=!1,await d.getMessages({page:1,pageSize:15}),await nt(),A(),v()},p=async P=>{if(confirm("确定要删除这条消息吗？"))try{await d.deleteMessage(P),d.messages=d.messages.filter(U=>U.id!==P),Ie().add({title:"删除成功",color:"green",timeout:2e3})}catch(U){console.error("删除失败:",U),Ie().add({title:"删除失败",color:"red",timeout:2e3})}},v=()=>{if(window.Fancybox){window.Fancybox.destroy();const P={Carousel:{infinite:!1},Toolbar:{display:[{id:"prev",position:"center"},{id:"counter",position:"center"},{id:"next",position:"center"},"zoom","slideshow","fullscreen","close"]},Image:{zoom:!0,click:!0,wheel:"slide"}};document.querySelectorAll(".markdown-preview img").forEach(U=>{const X=U.getAttribute("src")||"",ue=/^https?:\/\//i.test(X),$=U.parentElement;if($&&$.tagName==="A"&&$.hasAttribute("data-fancybox")){ue||$.replaceWith(U);return}if(ue){const he=document.createElement("a");he.href=X,he.setAttribute("data-fancybox","uploaded-image"),he.style.display="block",U.parentNode.insertBefore(he,U),he.appendChild(U)}else $&&$.tagName==="A"&&$.hasAttribute("data-fancybox")&&$.replaceWith(U)}),window.Fancybox.bind("[data-fancybox]",P)}},E=async P=>{y.value===P?y.value=null:(y.value=P,await nt(),window.Waline?document.querySelector(`#waline-${P}`)?window.Waline.init({el:`#waline-${P}`,serverURL:h.siteConfig.walineServerURL,path:"messages/${msgId}",reaction:!1,meta:["nick","mail","link"],requiredMeta:["mail","nick"],pageview:!0,search:!1,wordLimit:200,pageSize:5,avatar:"monsterid",emoji:["https://unpkg.com/@waline/emojis@1.2.0/tieba"],imageUploader:!1,copyright:!1,dark:'html[class="dark"]'}):console.error(`评论容器 #waline-${P} 未找到`):console.error("Waline 未加载"))},b=P=>{const j=new Date(P),X=new Date().getTime()-j.getTime(),ue=Math.floor(X/(1e3*60*60*24)),$=Math.floor(X/(1e3*60*60)),he=Math.floor(X/(1e3*60));return Math.floor(X/1e3)<60?"刚刚":he<60?`${he}分钟前`:$<24?`${$}小时前`:ue<3?`${ue}天前`:j.toLocaleString()},k=te({}),M=te({}),x=P=>{k.value[P]=!k.value[P]},A=()=>{nt(()=>{(ie.value?fe.value:d.messages).forEach(j=>{const U=document.querySelector(`.content-container[data-msg-id="${j.id}"] .overflow-y-hidden`);U&&U.scrollHeight>700&&(M.value[j.id]=!0,k.value[j.id]===void 0&&(k.value[j.id]=!1))})})};lt(()=>d.messages,()=>{m.hash.includes("/messages/")||nt(()=>{requestAnimationFrame(()=>{A(),v()})})},{deep:!0});const m=hl();Pt(async()=>{try{const P=m.hash.split("/messages/").pop();if(!window.Waline){const j=document.createElement("link");j.rel="stylesheet",j.href="https://unpkg.com/@waline/client@v2/dist/waline.css",document.head.appendChild(j),await new Promise((U,X)=>{const ue=document.createElement("script");ue.src="https://unpkg.com/@waline/client@v2/dist/waline.js",ue.crossOrigin="anonymous",ue.onload=U,ue.onerror=X,document.head.appendChild(ue)})}if(P){const j=await fetch(`${g}/messages/${P}`,{credentials:"include",headers:{Accept:"application/json"}});if(!j.ok)throw new Error("消息加载失败");const U=await j.json();if(U.code===1&&U.data){d.messages=[U.data],d.hasMore=!1,d.page=1,await nt();const X=document.querySelector(`.content-container[data-msg-id="${P}"]`);X&&X.scrollIntoView({behavior:"instant",block:"start"})}else throw new Error("消息不存在")}else m.hash.includes("/messages/")||await d.getMessages({page:1,pageSize:15});await nt(),A(),v()}catch(P){console.error("初始化失败:",P),P instanceof Error&&Ie().add({title:"加载失败",description:P.message||"请刷新重试",color:"red",timeout:2e3})}}),lt(()=>m.hash,async P=>{const j=P.split("/messages/").pop();if(!j){m.hash.includes("/messages/")||await d.getMessages({page:1,pageSize:15});return}try{const U=await fetch(`${g}/messages/${j}`,{credentials:"include",headers:{Accept:"application/json"}});if(!U.ok)throw new Error("消息加载失败");const X=await U.json();if(X.code===1&&X.data){d.messages=[X.data],d.hasMore=!1,d.page=1,await nt();const ue=document.querySelector(`.content-container[data-msg-id="${j}"]`);ue&&ue.scrollIntoView({behavior:"instant",block:"start"})}}catch(U){console.error("加载消息失败:",U),Ie().add({title:"加载失败",color:"red",timeout:2e3})}},{immediate:!0});const O=te(!1),N=async()=>{if(!(O.value||d.page<=1)){O.value=!0;try{const P=d.page-1,j=await d.getMessages({page:P,pageSize:15});j&&Array.isArray(j.items)?(d.messages=j.items,d.page=j.page||P):d.page=P,window.scrollTo({top:0,behavior:"instant"})}catch{Ie().add({title:"加载失败",color:"red",timeout:2e3})}finally{O.value=!1}}},H=async()=>{if(!(O.value||!d.hasMore)){O.value=!0;try{const P=d.page+1,j=await d.getMessages({page:P,pageSize:15});j&&Array.isArray(j.items)?(d.messages=j.items,d.page=j.page||P):d.page=P,window.scrollTo({top:0,behavior:"instant"})}catch{Ie().add({title:"加载失败",color:"red",timeout:2e3})}finally{O.value=!1}}};lt(()=>T.isLogin,P=>{P&&d.getMessages({page:1,pageSize:15})}),lt(()=>d.messages,async()=>{try{await nt(),A(),v()}catch(P){console.error("更新视图失败:",P)}},{deep:!0}),vi(()=>{window.Fancybox&&window.Fancybox.destroy()});const R=async P=>{try{await navigator.clipboard.writeText(P),Ie().add({title:"复制成功",color:"green",timeout:2e3})}catch(j){console.error("复制失败:",j),Ie().add({title:"复制失败",color:"red",timeout:2e3})}},z=te(!1),Y=te(""),K=te(null),re=te(!1),pe=P=>{if(K.value=P.id,Y.value=P.content,P.image_url){const j=`

<!-- 附件图片(编辑时可删除) -->
![附件图片](${g}${P.image_url})
<!-- 附件图片结束 -->`;Y.value+=j}z.value=!0},we=async()=>{if(K.value){re.value=!0;try{const P=d.messages.find(ue=>ue.id===K.value);if(!P)return;let j=Y.value;if(j=j.replace(/\n*<!-- 附件图片\(编辑时可删除\) -->\n!\[附件图片\]\(.*?\)\n<!-- 附件图片结束 -->\n*/g,""),j===P.content){Ie().add({title:"内容未修改",description:"请修改内容后再保存",color:"orange",timeout:2e3}),re.value=!1;return}const U=await fetch(`${g}/messages/${K.value}`,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({content:j,image_url:P.image_url})});if(!U.ok)throw new Error(`HTTP error! status: ${U.status}`);const X=await U.json();if(X.code===1){const ue=d.messages.findIndex($=>$.id===K.value);ue!==-1&&(d.messages[ue]={...d.messages[ue],content:Y.value,image_url:P.image_url}),z.value=!1,Ie().add({title:"更新成功",color:"green",timeout:2e3})}else throw new Error(X.msg||"保存失败")}catch(P){console.error("更新消息失败:",P),Ie().add({title:"更新失败",color:"red",timeout:2e3})}finally{re.value=!1}}},ge=async P=>{var j,U;try{const X=document.querySelector(`.content-container[data-msg-id="${P}"]`);if(!X)return;const ue=(U=(j=X.querySelector(".markdown-preview"))==null?void 0:j.textContent)==null?void 0:U.trim(),$=X.querySelector("img"),he=X.querySelector("video"),J=X.querySelector("audio");if(!ue&&!$&&he||!ue&&!$&&J){Ie().add({title:"此内容不可生成卡片",color:"orange",timeout:2e3});return}const F=setTimeout(()=>{Ie().add({title:"生成超时",description:"卡片生成时间过长，请稍后重试",color:"red",timeout:3e3})},1e4),Le=k.value[P];k.value[P]=!0,await nt();const ne=document.createElement("div");ne.style.cssText=`
  padding: 16px;
  background: transparent;
  border-radius: 12px;
  width: ${$?"640px":"480px"};
  position: absolute;
  left: -9999px;
  top: 0;
  z-index: -1;
  overflow: visible;
  min-height: fit-content;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
  border: none;
`,document.body.appendChild(ne);const Ne=X.cloneNode(!0);Ne.querySelectorAll(".text-center.mt-2, .bg-gradient-to-t").forEach(Ke=>Ke.remove()),Ne.style.cssText=`
      max-height: none;
      overflow: visible;
      padding: 0;
      margin: 0;
      background: transparent;
    `;const Me=Ne.querySelector(".overflow-y-hidden");Me&&(Me.className="",Me.style.cssText=`
    overflow: visible;
    max-height: none !important;
    height: auto !important;
    padding: 12px;
    line-height: 1.6;
    margin-bottom: 0;
    white-space: pre-wrap;
    background: transparent;
    border-radius: 12px;
    font-size: 14px;
    color: #333;
  `),Ne.querySelectorAll("video, audio, iframe").forEach(Ke=>{var Ct;const Ue=document.createElement("div");Ue.style.cssText=`
        padding: 15px;
        background: rgba(251, 146, 60, 0.1);
        border: 1px solid rgba(251, 146, 60, 0.3);
        border-radius: 8px;
        color: #fb923c;
        margin: 15px 0;
        word-break: break-all;
      `,Ke instanceof HTMLVideoElement?Ue.innerHTML=`🎬 视频链接：${Ke.src||"未知链接"}`:Ke instanceof HTMLAudioElement?Ue.innerHTML=`🎵 音频链接：${Ke.src||"未知链接"}`:Ke instanceof HTMLIFrameElement&&(Ue.innerHTML=`🔗 嵌入内容链接：${Ke.src||"未知链接"}`),(Ct=Ke.parentNode)==null||Ct.replaceChild(Ue,Ke)}),await(async()=>{const Ke=Ne.querySelectorAll("img");await Promise.all(Array.from(Ke).map(async Ue=>new Promise(Ct=>{const ln=Ue.src;Ue.crossOrigin="anonymous",ln.startsWith("/")?(Ue.src=`${g}${ln}`,fetch(Ue.src,{credentials:"include"}).then(st=>st.blob()).then(st=>{Ue.src=URL.createObjectURL(st),Ct()}).catch(()=>{var st;console.error("图片加载失败:",ln),(st=Ue.parentElement)==null||st.removeChild(Ue),Ct()})):Ue.complete?Ct():(Ue.onload=()=>Ct(),Ue.onerror=()=>{var st;console.error("图片加载失败:",ln),(st=Ue.parentElement)==null||st.removeChild(Ue),Ct()})})))})(),ne.appendChild(Ne);const He=document.createElement("div");He.style.cssText=`
    margin-top: 12px;
    padding-top: 12px;
    text-align: center;
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    background: transparent;
  `,He.innerHTML=`
    <div style="color: #fb923c; font-size: 13px; margin-bottom: 4px; font-weight: 500;">
      ${h.siteConfig.cardFooterTitle}
    </div>
    <a href="https://note.noisework.cn" 
       target="_blank" 
       rel="noopener noreferrer" 
       style="color: rgba(255,255,255,0.5); text-decoration: none;">
      ${h.siteConfig.cardFooterSubtitle}
    </a>
  `,ne.appendChild(He),await nt();const ot=await html2canvas(ne,{backgroundColor:null,scale:2,useCORS:!0,allowTaint:!0,logging:!1,width:ne.offsetWidth,height:ne.scrollHeight,borderRadius:"16px",onclone:Ke=>{const Ue=Ke.querySelector(".content-container");Ue&&(Ue.style.cssText=`
            overflow: visible !important;
            max-height: none !important;
            height: auto !important;
            padding: 0;
            min-height: ${(Me==null?void 0:Me.scrollHeight)||0}px;
            background: transparent;
          `)}});clearTimeout(F);const it=document.createElement("a");it.download=`message-${P}.png`,it.href=ot.toDataURL("image/png"),it.click(),document.body.removeChild(ne),k.value[P]=Le,Ie().add({title:"下载成功",color:"green",timeout:2e3})}catch(X){console.error("下载失败:",X),Ie().add({title:"下载失败",color:"red",timeout:2e3})}},ie=te(!1),fe=te([]),Ae=async P=>{var j;try{const U=ie.value?null:window.scrollY;if(console.debug("API返回的原始数据:",P),!P)throw new Error("API返回数据为空");let X=[],ue=0;if(P.code===1?Array.isArray(P.data)?X=P.data:(j=P.data)!=null&&j.items&&(X=P.data.items):Array.isArray(P)&&(X=P),!Array.isArray(X))throw new Error("无效的数据格式");ue=X.length,ie.value=!0,fe.value=X,ue===0?Ie().add({title:"未找到相关内容",color:"orange",timeout:2e3}):Ie().add({title:`找到 ${ue} 条结果`,color:"green",timeout:2e3}),U!==null&&window.scrollTo({top:0,behavior:"smooth"}),await nt(),A(),v()}catch(U){console.error("处理搜索结果时出错:",U),Ie().add({title:"搜索失败",description:U.message||"处理搜索结果时发生错误",color:"red",timeout:2e3}),Fe()}},Fe=()=>{fe.value=[],ie.value=!1,console.log("重置搜索 - searchResults:",fe.value),console.log("重置搜索 - isSearchMode:",ie.value),nt(()=>{A(),v()})},Pe=_e(()=>ie.value&&Array.isArray(fe.value)?fe.value:d.messages||[]);return n({handleSearchResult:Ae}),lt(fe,P=>{console.log("searchResults变化:",P),nt(()=>{A(),v()})},{deep:!0,immediate:!0}),lt(ie,P=>{console.log("isSearchMode变化:",P),nt(()=>{A(),v()})}),_e(()=>({cardFooterTitle:h.siteConfig.cardFooterTitle,cardFooterSubtitle:h.siteConfig.cardFooterSubtitle,pageFooterHTML:h.siteConfig.pageFooterHTML,walineServerURL:h.siteConfig.walineServerURL})),(P,j)=>{const U=Mn,X=jt,ue=lr,$=Ml,he=sr,J=Ua;return le(),me(kt,null,[V("div",ru,[Te(Pe).length?Se("",!0):(le(),me("div",au,[ce(U,{name:"i-heroicons-inbox",class:"w-12 h-12 mx-auto mb-4"}),j[5]||(j[5]=V("p",null,"暂无消息内容",-1))])),V("div",ou,[Te(ie)?(le(),me("div",su,[V("p",lu,"搜索结果 ("+Ze(Te(fe).length)+" 条)",1),ce(X,{size:"sm",variant:"ghost",class:"text-gray-400 hover:text-orange-500",icon:"i-heroicons-arrow-left",onClick:u},{default:Ve(()=>j[6]||(j[6]=[et(" 返回完整列表 ")])),_:1})])):Se("",!0),V("div",cu,[Te(ie)&&Te(fe).length===0?(le(),me("div",uu,[ce(U,{name:"i-heroicons-magnifying-glass",class:"w-12 h-12 mx-auto mb-4"}),j[7]||(j[7]=V("p",null,"未找到相关内容",-1))])):Se("",!0),(le(!0),me(kt,null,Vt(Te(Pe),F=>(le(),me("div",{key:F.id,class:"w-full h-auto overflow-hidden flex flex-col justify-between"},[V("div",du,[V("div",fu,[j[9]||(j[9]=V("div",{class:"w-2 h-2 rounded-full bg-orange-600 mr-2 flex-shrink-0"},null,-1)),V("div",hu,[V("span",pu,Ze(b(F.created_at)),1),j[8]||(j[8]=V("span",{class:"gradient-dot mx-2 flex-shrink-0"},"@",-1)),V("span",mu,Ze(F.username||"匿名用户"),1)])]),V("div",gu,[F.private?(le(),me("div",vu,[ce(U,{name:"i-mdi-lock-outline",class:"text-gray-400"})])):Se("",!0),Te(C)?(le(),me("div",{key:1,class:"w-5 h-5 cursor-pointer flex-shrink-0 transition-all duration-200 hover:scale-110",onClick:Le=>pe(F),title:"编辑内容"},[ce(U,{name:"i-mdi-pencil-outline",class:"text-gray-400 hover:text-orange-500"})],8,yu)):Se("",!0),V("div",{class:"w-5 h-5 cursor-pointer flex-shrink-0 transition-all duration-200 hover:scale-110",onClick:Le=>R(F.content),title:"复制内容"},[ce(U,{name:"i-mdi-content-copy",class:"text-gray-400 hover:text-orange-500"})],8,bu),V("div",{class:"w-5 h-5 cursor-pointer flex-shrink-0 transition-all duration-200 hover:scale-110",onClick:Le=>ge(F.id),title:"下载为图片"},[ce(U,{name:"i-mdi-image-outline",class:"text-gray-400 hover:text-orange-500"})],8,wu),V("div",{class:"w-5 h-5 cursor-pointer flex-shrink-0 transition-all duration-200 hover:scale-110",onClick:Le=>E(F.id),title:"评论"},[ce(U,{name:"i-mdi-comment-outline",class:"text-gray-400 hover:text-orange-500"})],8,Eu),Te(C)?(le(),me("div",{key:2,class:"w-5 h-5 cursor-pointer flex-shrink-0 transition-all duration-200 hover:scale-110",onClick:Le=>p(F.id),title:"删除"},[ce(U,{name:"i-mdi-paper-roll-outline",class:"text-gray-400 hover:text-orange-500"})],8,Su)):Se("",!0)])]),V("div",Cu,[F.image_url||F.content?(le(),me("div",{key:0,class:"content-container","data-msg-id":F.id},[F.image_url?(le(),me("img",{key:0,src:`${Te(g)}${F.image_url}`,alt:"Image",class:"max-w-full object-cover rounded-lg mb-4",loading:"lazy",fetchpriority:P.index<3?"high":"low"},null,8,ku)):Se("",!0),F.image_url&&F.content?(le(),me("div",Mu)):Se("",!0),V("div",{class:at(["overflow-y-hidden relative",{"max-h-[700px]":!Te(k)[F.id]}])},[ce(Ra,{content:F.content,onTagClick:f,"link-target":"_blank"},null,8,["content"]),Te(M)[F.id]&&!Te(k)[F.id]?(le(),me("div",xu)):Se("",!0)],2),Te(M)[F.id]?(le(),me("div",_u,[V("button",{onClick:Le=>x(F.id),class:"flex items-center justify-center space-x-1 mx-auto px-4 py-2 text-orange-500 hover:text-orange-600 focus:outline-none transition-colors duration-200"},[V("span",null,Ze(Te(k)[F.id]?"收起内容":"展开全文"),1),ce(U,{name:Te(k)[F.id]?"i-mdi-chevron-up":"i-mdi-chevron-down",class:"w-5 h-5"},null,8,["name"])],8,Lu)])):Se("",!0)],8,Tu)):Se("",!0),pl(V("div",Au,[V("div",{id:`waline-${F.id}`},null,8,Du)],512),[[ml,Te(y)===F.id]])])]))),128))]),Te(ie)?Se("",!0):(le(),me("div",Ou,[V("div",Pu,[Te(d).page>1?(le(),Ot(X,{key:0,color:"gray",variant:"outline",size:"xs",class:"rounded-full px-4 py-1.5 bg-[rgba(36,43,50,0.95)] text-white hover:text-white border-none shadow-lg hover:shadow-xl transition-all duration-300 backdrop-blur-sm",onClick:N,disabled:Te(O)},{default:Ve(()=>[ce(U,{name:"i-heroicons-arrow-left",class:"mr-1 w-4 h-4"}),j[10]||(j[10]=et(" 上一页 "))]),_:1},8,["disabled"])):Se("",!0),Te(d).hasMore?(le(),Ot(X,{key:1,color:"gray",variant:"outline",size:"xs",class:"rounded-full px-4 py-1.5 bg-[rgba(36,43,50,0.95)] text-white hover:text-white border-none shadow-lg hover:shadow-xl transition-all duration-300 backdrop-blur-sm",onClick:H,disabled:Te(O)},{default:Ve(()=>[j[11]||(j[11]=et(" 下一页 ")),ce(U,{name:"i-heroicons-arrow-right",class:"ml-1 w-4 h-4"})]),_:1},8,["disabled"])):Se("",!0),Te(O)?(le(),me("span",Ru,"加载中...")):Se("",!0)]),V("div",Hu,[V("span",Iu,"第 "+Ze(Te(d).page)+" 页",1),ce(ue,{modelValue:Te(r),"onUpdate:modelValue":j[0]||(j[0]=F=>zi(r)?r.value=F:null),type:"number",min:"1",max:Te(s),class:"w-12 text-center text-sm",placeholder:"#",onKeyup:Na(c,["enter"])},null,8,["modelValue","max"]),ce(X,{size:"xs",color:"gray",variant:"ghost",class:"text-gray-400 hover:text-orange-500 text-sm",onClick:c},{default:Ve(()=>j[12]||(j[12]=[et(" 跳转 ")])),_:1})])])),!Te(ie)&&Te(d).messages.length>0&&!Te(d).hasMore?(le(),me("div",Nu,[ce(U,{name:"i-fluent-emoji-flat-confetti-ball",size:"lg"}),j[13]||(j[13]=et(" 加载完毕~ "))])):Se("",!0)]),w.siteConfig.pageFooterHTML?(le(),me("div",{key:2,innerHTML:w.siteConfig.pageFooterHTML},null,8,Bu)):(le(),me("div",ju,j[14]||(j[14]=[et(" 来自"),V("a",{href:"https://www.noisework.cn",target:"_blank",rel:"noopener noreferrer",class:"text-orange-400 hover:text-orange-500"},"Noise",-1),et(" 使用"),V("a",{href:"https://github.com/lin-snow/Ech0",target:"_blank",rel:"noopener noreferrer",class:"text-orange-400 hover:text-orange-500"},"Ech0",-1),et("发布 ")])))]),ce(J,{modelValue:Te(z),"onUpdate:modelValue":j[4]||(j[4]=F=>zi(z)?z.value=F:null),ui:{width:"sm:max-w-2xl"}},{default:Ve(()=>[ce(he,null,{header:Ve(()=>[V("div",zu,[j[15]||(j[15]=V("h3",{class:"text-lg font-medium"},"编辑内容",-1)),ce(X,{color:"gray",variant:"ghost",icon:"i-mdi-close",class:"-my-1",onClick:j[1]||(j[1]=F=>z.value=!1)})])]),footer:Ve(()=>[V("div",qu,[ce(X,{color:"gray",variant:"outline",onClick:j[3]||(j[3]=F=>z.value=!1),class:"text-white"},{default:Ve(()=>j[17]||(j[17]=[et(" 取消 ")])),_:1}),ce(X,{color:"orange",onClick:we,loading:Te(re),class:"text-white"},{default:Ve(()=>j[18]||(j[18]=[et(" 保存 ")])),_:1},8,["loading"])])]),default:Ve(()=>[V("div",Fu,[ce($,{modelValue:Te(Y),"onUpdate:modelValue":j[2]||(j[2]=F=>zi(Y)?Y.value=F:null),placeholder:"编辑内容...",rows:"10",class:"font-mono text-sm"},null,8,["modelValue"]),V("div",Uu,[j[16]||(j[16]=V("div",{class:"text-sm text-gray-500 mb-2"},"预览：",-1)),V("div",$u,[V("div",Vu,[ce(Ra,{content:Te(Y)},null,8,["content"])])])])])]),_:1})]),_:1},8,["modelValue"])],64)}}}),Yu=sn(Wu,[["__scopeId","data-v-8d21729a"]]),Ku={class:"heatmap-header"},Gu={class:"heatmap-legend"},Zu={class:"legend-colors"},Xu={class:"calendar-wrapper"},Ju={class:"month-labels"},Qu={class:"weekday-labels"},ed={class:"heatmap-grid"},td=["title"],nd=mt({__name:"heatmap",setup(w){const n=te([]),r=te([]),s=te(null),c=_e(()=>{if(!n.value.length)return Array(12).fill("").map((k,M)=>`${M+1}月`);const u=n.value.map(k=>new Date(k.date)),p=new Date(Math.min(...u)),v=[];let E=new Date(p);E.setDate(1);let b=E.getFullYear();for(let k=0;k<12;k++){const M=E.getMonth(),x=E.getFullYear();x!==b||k===0?(v.push(`${x}年${M+1}月`),b=x):v.push(`${M+1}月`),E.setMonth(M+1)}return v}),h=["日","一","二","三","四","五","六"],g=u=>["#9be9a8","#40c463","#30a14e","#216e39","#0e4429"][Math.min(u-1,4)]||"#ebedf0",d=u=>u.count?g(u.level):"rgba(235, 237, 240, 0.4)",y=async()=>{try{const p=await(await fetch("/api/messages/calendar")).json();p&&p.code===1&&p.data&&p.data.length>0?(n.value=p.data,f()):T()}catch(u){console.error("获取热力图数据失败:",u),T()}},T=()=>{const u=new Date,p=new Date(u);p.setMonth(u.getMonth()-11),p.setDate(1);const v=[];let E=new Date(p);for(;E<=u;){const b=Math.random()>.7?Math.floor(Math.random()*10)+1:0;v.push({date:C(E),count:b}),E.setDate(E.getDate()+1)}n.value=v,f()},C=u=>{const p=u.getFullYear(),v=String(u.getMonth()+1).padStart(2,"0"),E=String(u.getDate()).padStart(2,"0");return`${p}-${v}-${E}`},f=()=>{if(!n.value.length)return;const u=n.value.map(x=>new Date(x.date)),p=new Date(Math.min(...u));new Date(Math.max(...u));const v=new Date(p);v.setDate(1);const E=new Date(v);E.setMonth(v.getMonth()+11),E.setDate(E.getDate()+(6-E.getDay()));const b=new Map;n.value.forEach(x=>{x&&x.date&&x.count!==void 0&&b.set(x.date,x.count)});const k=[];let M=new Date(v);for(M.setDate(M.getDate()-M.getDay());M<=E;){const x=[];for(let A=0;A<7;A++){const m=C(M),O=b.get(m)||0;x.push({date:m,count:O,level:O?Math.min(Math.ceil(O/2),5):0}),M.setDate(M.getDate()+1)}k.push(x)}r.value=k};return Pt(()=>{y()}),(u,p)=>{const v=sr;return le(),Ot(v,{class:"mx-auto sm:max-w-2xl hover:shadow-md backdrop-blur-sm bg-black/40 shadow-lg text-white"},{default:Ve(()=>[V("div",Ku,[p[2]||(p[2]=V("h3",null,"内容发布日历",-1)),V("div",Gu,[p[0]||(p[0]=V("span",null,"少",-1)),V("div",Zu,[(le(),me(kt,null,Vt(5,E=>V("div",{key:E,style:an({backgroundColor:g(E)})},null,4)),64))]),p[1]||(p[1]=V("span",null,"多",-1))])]),V("div",Xu,[V("div",{class:"calendar-container",ref_key:"calendarContainer",ref:s},[V("div",Ju,[(le(!0),me(kt,null,Vt(c.value,(E,b)=>(le(),me("div",{class:"month-label",key:b},Ze(E),1))),128))]),V("div",Qu,[(le(),me(kt,null,Vt(h,E=>V("div",{class:"weekday-label",key:E},Ze(E),1)),64))]),V("div",ed,[(le(!0),me(kt,null,Vt(r.value,(E,b)=>(le(),me("div",{key:b,class:"heatmap-week"},[(le(!0),me(kt,null,Vt(E,(k,M)=>(le(),me("div",{key:M,class:"heatmap-day",style:an({backgroundColor:d(k)}),title:`${k.date}: ${k.count||0} 条内容`},null,12,td))),128))]))),128))])],512)])]),_:1})}}}),id=sn(nd,[["__scopeId","data-v-4da783b8"]]),rd={class:"tags-container mx-auto w-full sm:max-w-2xl"},ad={class:"relative"},od={class:"tags-wrapper"},sd={class:"tags-scroll"},ld=["onClick"],cd={class:"tag-count"},ud=mt({__name:"TagList",props:{tags:{type:Array,default:()=>[]}},emits:["tagClick","updateTags"],setup(w,{emit:n}){const r=n,s=te(!1),c=te(Date.now()),h=w,g=_e(()=>{const T=/[/?=&]/,C=/^(song|video|playlist)\?id=\d+$/,f=new Map;return h.tags.reduce((u,p)=>(f.has(p.name)||!T.test(p.name)&&!C.test(p.name)&&(f.set(p.name,!0),u.push(p)),u),[])},{}),d=T=>{r("tagClick",T)},y=async()=>{s.value||(s.value=!0,c.value=Date.now(),r("updateTags"),setTimeout(()=>{s.value=!1},1e3))};return(T,C)=>{const f=Mn;return le(),me("div",rd,[V("div",ad,[V("div",od,[V("div",sd,[(le(!0),me(kt,null,Vt(g.value,u=>(le(),me("span",{key:u.name+c.value,class:"tag-item",onClick:p=>d(u.name)},[et(" #"+Ze(u.name)+" ",1),V("span",cd,"("+Ze(u.count)+")",1)],8,ld))),128))])]),V("div",{class:"absolute -right-1 top-1/2 -translate-y-1/2 p-2 cursor-pointer transition-all duration-200 hover:scale-110 z-10",onClick:y,title:"刷新标签"},[ce(f,{name:"i-mdi-refresh",class:at(["w-5 h-5 text-gray-400 hover:text-orange-500",{"animate-spin":s.value}])},null,8,["class"])]),C[0]||(C[0]=V("div",{class:"scroll-fade"},null,-1))])])}}}),dd=sn(ud,[["__scopeId","data-v-a469a53f"]]),fd=window.setInterval,hd={key:0,class:"loading"},pd={class:"moments-header"},md={class:"header-title"},gd={class:"profile-info"},vd=["src","alt"],yd={class:"profile-text"},bd={class:"title"},wd={class:"description"},Ed={key:0,class:"mx-auto sm:max-w-2xl mb-4"},Md=mt({__name:"index",setup(w){const n=te(null),r=m=>{console.log("接收到搜索结果:",m),n.value&&n.value.handleSearchResult(m)},s=te(!1);Fa("showHeatmap",s),lt(s,m=>{console.log("index.vue 中热力图状态变化:",m)}),ea({meta:[{name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"}]});const c=te({siteTitle:"",subtitleText:"",avatarURL:"",username:"",description:"",backgrounds:[],cardFooterTitle:"",cardFooterSubtitle:"",pageFooterHTML:"",rssTitle:"",rssDescription:"",rssAuthorName:"",rssFaviconURL:""}),h=_e(()=>({"--bg-image":`url(${T.value||c.value.backgrounds[0]})`})),g=_e(()=>({"background-image":`url(${T.value||c.value.backgrounds[0]})`,"background-size":"cover","background-position":"center"})),d={siteTitle:"Noise的说说笔记",subtitleText:"欢迎访问，点击头像可更换封面背景！",avatarURL:"https://s2.loli.net/2025/03/24/HnSXKvibAQlosIW.png",username:"Noise",description:"执迷不悟",backgrounds:["https://s2.loli.net/2025/03/27/KJ1trnU2ksbFEYM.jpg","https://s2.loli.net/2025/03/27/MZqaLczCvwjSmW7.jpg","https://s2.loli.net/2025/03/27/UMijKXwJ9yTqSeE.jpg","https://s2.loli.net/2025/03/27/WJQIlkXvBg2afcR.jpg","https://s2.loli.net/2025/03/27/oHNQtf4spkq2iln.jpg","https://s2.loli.net/2025/03/27/PMRuX5loc6Uaimw.jpg","https://s2.loli.net/2025/03/27/U2WIslbNyTLt4rD.jpg","https://s2.loli.net/2025/03/27/xu1jZL5Og4pqT9d.jpg","https://s2.loli.net/2025/03/27/OXqwzZ6v3PVIns9.jpg","https://s2.loli.net/2025/03/27/HGuqlE6apgNywbh.jpg","https://s2.loli.net/2025/03/26/d7iyuPYA8cRqD1K.jpg","https://s2.loli.net/2025/03/27/wYy12qDMH6bGJOI.jpg","https://s2.loli.net/2025/03/27/y67m2k5xcSdTsHN.jpg"],cardFooterTitle:"Noise·说说·笔记~",cardFooterSubtitle:"note.noisework.cn",pageFooterHTML:'<div class="text-center text-xs text-gray-400 py-4">来自<a href="https://www.noisework.cn" target="_blank" rel="noopener noreferrer" class="text-orange-400 hover:text-orange-500">Noise</a> 使用<a href="https://github.com/lin-snow/Ech0" target="_blank" rel="noopener noreferrer" class="text-orange-400 hover:text-orange-500">Ech0</a>发布</div>',rssTitle:"Noise的说说笔记",rssDescription:"一个说说笔记~",rssAuthorName:"Noise",rssFaviconURL:"/favicon.ico",walineServerURL:"https://s9cewscb.lc-cn-n1-shared.com"},y=async()=>{var m,O;try{c.value={...d};const N=await fetch("/api/frontend/config",{credentials:"include",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});if(!N.ok)throw new Error("Network response was not ok");const H=await N.json();if(console.log("获取到的配置数据:",H),(m=H==null?void 0:H.data)!=null&&m.frontendSettings){const R=H.data.frontendSettings;Object.keys(c.value).forEach(z=>{R[z]!==null&&R[z]!==void 0&&(z==="backgrounds"&&Array.isArray(R[z])?c.value.backgrounds=[...R[z]]:c.value[z]=R[z])})}if((O=c.value.backgrounds)!=null&&O.length||(c.value.backgrounds=[...d.backgrounds]),c.value.backgrounds.length>0){const R=Math.floor(Math.random()*c.value.backgrounds.length);T.value=c.value.backgrounds[R]}C.value=!0}catch(N){console.error("获取配置失败:",N),c.value={...d},C.value=!0}},T=te(""),C=te(!1),f=te(!1),u=async m=>{const O=N=>new Promise(H=>{const R=new Image;R.src=N,R.onload=()=>H(N),R.onerror=()=>H(null)});await Promise.all(m.map(N=>O(N)))};Pt(()=>{window.addEventListener("frontend-config-updated",async m=>{var O;if(await y(),((O=c.value.backgrounds)==null?void 0:O.length)>0){const N=Math.floor(Math.random()*c.value.backgrounds.length),H=c.value.backgrounds[N];T.value=H}})}),ir(()=>{window.removeEventListener("frontend-config-updated",y)});const p=async()=>{if(f.value)return;f.value=!0;const m=Math.floor(Math.random()*c.value.backgrounds.length),O=c.value.backgrounds[m];if(O===T.value){f.value=!1;return}const N=`${O}?imageView2/2/w/10/blur/1/q/10`;T.value=N,requestAnimationFrame(()=>{const H=new Image;H.src=O,H.onload=()=>{requestAnimationFrame(()=>{T.value=O,f.value=!1})},H.onerror=()=>{f.value=!1}})},v=()=>{ea({title:c.value.siteTitle||"说说笔记"})};lt(()=>c.value.siteTitle,()=>{v()},{immediate:!0});const E=te(null),b=te([]),k=async()=>{await M()},M=async()=>{try{const O=await(await fetch(`${rn().public.baseApi}/messages/tags`,{headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}})).json();O.code===1&&(b.value=O.data||[])}catch(m){console.error("获取标签失败:",m),b.value=[]}},x=async m=>{try{const O=encodeURIComponent(m.trim()),N=await fetch(`${rn().public.baseApi}/messages/tags/${O}`,{credentials:"include",headers:{Accept:"application/json"}});if(!N.ok)throw new Error(`HTTP error! status: ${N.status}`);const H=await N.json();if(H.code===1&&Array.isArray(H.data))n.value&&n.value.handleSearchResult(H.data);else throw new Error(H.msg||"获取标签内容失败")}catch(O){console.error("获取标签消息失败:",O),Ie().add({title:"获取标签消息失败",description:O.message||"服务器错误，请稍后重试",color:"red",timeout:3e3})}},A=()=>{if(!E.value)return;let m=0,O=!1,N=!1;return fd(()=>{N||(O?(m--,E.value.textContent=c.value.subtitleText.slice(0,m),m<=0&&(N=!0,E.value.textContent="",setTimeout(()=>{O=!1,N=!1,m=0},1e3))):(E.value.textContent=c.value.subtitleText.slice(0,m+1),m++,m>=c.value.subtitleText.length&&(N=!0,setTimeout(()=>{O=!0,N=!1},2e3))))},100)};return Pt(async()=>{try{if(C.value=!1,window.requestIdleCallback=window.requestIdleCallback||(O=>setTimeout(O,1)),await y(),ta(async()=>{await M(),await u(c.value.backgrounds)}),c.value.backgrounds.length>0){const O=c.value.backgrounds[Math.floor(Math.random()*c.value.backgrounds.length)],N=`${O}?imageView2/2/w/100/q/30`;T.value=N,ta(async()=>{await u(c.value.backgrounds)});const H=new Image;H.src=O,H.onload=()=>{requestAnimationFrame(()=>{T.value=O,C.value=!0})}}const m=A();ir(()=>{m&&clearInterval(m)}),window.addEventListener("frontend-config-updated",async O=>{var N;if(await y(),((N=c.value.backgrounds)==null?void 0:N.length)>0){const H=Math.floor(Math.random()*c.value.backgrounds.length),R=c.value.backgrounds[H];T.value=R}})}catch(m){console.error("初始化失败:",m),C.value=!0}}),(m,O)=>{const N=gl;return le(),me("div",{class:"background-container",style:an(h.value)},[C.value?Se("",!0):(le(),me("div",hd,O[1]||(O[1]=[V("div",{class:"rainbow-spinner"},null,-1),V("div",{class:"loading-text"},"加载中...",-1)]))),V("div",{class:at(["content-wrapper",{"gpu-accelerated":!0}])},[ce(N,{class:"container-fixed py-2 pb-4 my-4"},{default:Ve(()=>[V("div",pd,[V("div",{class:"header-image",style:an(g.value)},[V("h1",md,Ze(c.value.siteTitle),1),V("div",{ref_key:"subtitleEl",ref:E,class:"header-subtitle"},Ze(c.value.subtitleText),513),V("div",gd,[V("img",{class:"avatar",onClick:p,src:c.value.avatarURL,alt:c.value.username},null,8,vd),V("div",yd,[V("div",bd,Ze(c.value.username),1),V("div",wd,Ze(c.value.description),1)])])],4)]),s.value?(le(),me("div",Ed,[ce(id)])):Se("",!0),ce(iu,{onSearchResult:r}),b.value&&b.value.length>0?(le(),Ot(dd,{key:1,tags:b.value,onTagClick:x,onUpdateTags:k},null,8,["tags"])):Se("",!0),ce(Yu,{ref_key:"messageList",ref:n,class:"message-list-container","site-config":c.value,"target-message-id":m.targetMessageId},null,8,["site-config","target-message-id"])]),_:1}),ce(xl),ce(uo,{modelValue:m.showSearchModal,"onUpdate:modelValue":O[0]||(O[0]=H=>m.showSearchModal=H),onSearchResult:r},null,8,["modelValue"])])],4)}}});export{Md as default};
