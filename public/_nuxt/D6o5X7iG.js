var Xs=Object.defineProperty;var Js=(C,n,r)=>n in C?Xs(C,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):C[n]=r;var nn=(C,n,r)=>Js(C,typeof n!="symbol"?n+"":n,r);import{s as Qs,u as el,a as Ln,r as ae,b as tl,t as Mi,g as nl,o as il,c as Vn,w as ot,d as la,e as rl,f as al,h as Le,i as Ae,j as ln,k as ol,l as sl,m as Fa,n as Kn,_ as Kt,p as wt,q as bt,v as ue,x as Ue,y as pr,z as Ti,A as ll,B as $a,C as cl,D as en,E as Ua,F as He,G as Nt,H as Qe,I as li,J as un,K as Va,L as Gn,M as Ot,N as Zn,O as ge,P as G,Q as fe,R as qa,S as _t,T as Xe,U as Pe,V as hn,W as $e,X as Ze,Y as ul,Z as Ct,$ as jt,a0 as Zi,a1 as Dn,a2 as An,a3 as br,a4 as wr,a5 as dl,a6 as ki,a7 as Wa,a8 as Xi,a9 as Ya,aa as Ka,ab as ca,ac as ua}from"./Cqtbhlpx.js";import{_ as fl,a as hl,b as Ga,N as pl}from"./DDLgJrAu.js";import{_ as Di,a as ml}from"./ERbK3GVq.js";import{_ as Er}from"./qFO9sS9B.js";import{s as gl}from"./x_rD_Ya3.js";const vl=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],yl=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],bl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",rn=[];let wl=class{constructor(){nn(this,"_data",new ci);nn(this,"_hash",new ci([...vl]));nn(this,"_nDataBytes",0);nn(this,"_minBufferSize",0)}finalize(n){n&&this._append(n);const r=this._nDataBytes*8,s=this._data.sigBytes*8;return this._data.words[s>>>5]|=128<<24-s%32,this._data.words[(s+64>>>9<<4)+14]=Math.floor(r/4294967296),this._data.words[(s+64>>>9<<4)+15]=r,this._data.sigBytes=this._data.words.length*4,this._process(),this._hash}_doProcessBlock(n,r){const s=this._hash.words;let c=s[0],h=s[1],m=s[2],f=s[3],w=s[4],T=s[5],S=s[6],d=s[7];for(let u=0;u<64;u++){if(u<16)rn[u]=n[r+u]|0;else{const _=rn[u-15],x=(_<<25|_>>>7)^(_<<14|_>>>18)^_>>>3,y=rn[u-2],O=(y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10;rn[u]=x+rn[u-7]+O+rn[u-16]}const p=w&T^~w&S,g=c&h^c&m^h&m,v=(c<<30|c>>>2)^(c<<19|c>>>13)^(c<<10|c>>>22),b=(w<<26|w>>>6)^(w<<21|w>>>11)^(w<<7|w>>>25),k=d+b+p+yl[u]+rn[u],M=v+g;d=S,S=T,T=w,w=f+k|0,f=m,m=h,h=c,c=k+M|0}s[0]=s[0]+c|0,s[1]=s[1]+h|0,s[2]=s[2]+m|0,s[3]=s[3]+f|0,s[4]=s[4]+w|0,s[5]=s[5]+T|0,s[6]=s[6]+S|0,s[7]=s[7]+d|0}_append(n){typeof n=="string"&&(n=ci.fromUtf8(n)),this._data.concat(n),this._nDataBytes+=n.sigBytes}_process(n){let r,s=this._data.sigBytes/64;n?s=Math.ceil(s):s=Math.max((s|0)-this._minBufferSize,0);const c=s*16,h=Math.min(c*4,this._data.sigBytes);if(c){for(let m=0;m<c;m+=16)this._doProcessBlock(this._data.words,m);r=this._data.words.splice(0,c),this._data.sigBytes-=h}return new ci(r,h)}},ci=class Za{constructor(n,r){nn(this,"words");nn(this,"sigBytes");n=this.words=n||[],this.sigBytes=r===void 0?n.length*4:r}static fromUtf8(n){const r=unescape(encodeURIComponent(n)),s=r.length,c=[];for(let h=0;h<s;h++)c[h>>>2]|=(r.charCodeAt(h)&255)<<24-h%4*8;return new Za(c,s)}toBase64(){const n=[];for(let r=0;r<this.sigBytes;r+=3){const s=this.words[r>>>2]>>>24-r%4*8&255,c=this.words[r+1>>>2]>>>24-(r+1)%4*8&255,h=this.words[r+2>>>2]>>>24-(r+2)%4*8&255,m=s<<16|c<<8|h;for(let f=0;f<4&&r*8+f*6<this.sigBytes*8;f++)n.push(bl.charAt(m>>>6*(3-f)&63))}return n.join("")}concat(n){if(this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4),this.sigBytes%4)for(let r=0;r<n.sigBytes;r++){const s=n.words[r>>>2]>>>24-r%4*8&255;this.words[this.sigBytes+r>>>2]|=s<<24-(this.sigBytes+r)%4*8}else for(let r=0;r<n.sigBytes;r+=4)this.words[this.sigBytes+r>>>2]=n.words[r>>>2];this.sigBytes+=n.sigBytes}};function El(C){return new wl().finalize(C).toBase64()}function Sl(C){return El(Qs(C))}const Cl=C=>C==="defer"||C===!1;function Tl(...C){var v;const n=typeof C[C.length-1]=="string"?C.pop():void 0;typeof C[0]!="string"&&C.unshift(n);let[r,s,c={}]=C;if(typeof r!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof s!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");const h=el(),m=s,f=()=>Ln.value,w=()=>h.isHydrating?h.payload.data[r]:h.static.data[r];c.server??(c.server=!0),c.default??(c.default=f),c.getCachedData??(c.getCachedData=w),c.lazy??(c.lazy=!1),c.immediate??(c.immediate=!0),c.deep??(c.deep=Ln.deep),c.dedupe??(c.dedupe="cancel");const T=c.getCachedData(r,h),S=T!=null;if(!h._asyncData[r]||!c.immediate){(v=h.payload._errors)[r]??(v[r]=Ln.errorValue);const b=c.deep?ae:tl;h._asyncData[r]={data:b(S?T:c.default()),pending:ae(!S),error:Mi(h.payload._errors,r),status:ae("idle"),_default:c.default}}const d={...h._asyncData[r]};delete d._default,d.refresh=d.execute=(b={})=>{if(h._asyncDataPromises[r]){if(Cl(b.dedupe??c.dedupe))return h._asyncDataPromises[r];h._asyncDataPromises[r].cancelled=!0}if(b._initial||h.isHydrating&&b._initial!==!1){const M=b._initial?T:c.getCachedData(r,h);if(M!=null)return Promise.resolve(M)}d.pending.value=!0,d.status.value="pending";const k=new Promise((M,_)=>{try{M(m(h))}catch(x){_(x)}}).then(async M=>{if(k.cancelled)return h._asyncDataPromises[r];let _=M;c.transform&&(_=await c.transform(M)),c.pick&&(_=xl(_,c.pick)),h.payload.data[r]=_,d.data.value=_,d.error.value=Ln.errorValue,d.status.value="success"}).catch(M=>{if(k.cancelled)return h._asyncDataPromises[r];d.error.value=al(M),d.data.value=Le(c.default()),d.status.value="error"}).finally(()=>{k.cancelled||(d.pending.value=!1,delete h._asyncDataPromises[r])});return h._asyncDataPromises[r]=k,h._asyncDataPromises[r]},d.clear=()=>kl(h,r);const u=()=>d.refresh({_initial:!0}),p=c.server!==!1&&h.payload.serverRendered;{const b=nl();if(b&&p&&c.immediate&&!b.sp&&(b.sp=[]),b&&!b._nuxtOnBeforeMountCbs){b._nuxtOnBeforeMountCbs=[];const _=b._nuxtOnBeforeMountCbs;il(()=>{_.forEach(x=>{x()}),_.splice(0,_.length)}),Vn(()=>_.splice(0,_.length))}p&&h.isHydrating&&(d.error.value||T!=null)?(d.pending.value=!1,d.status.value=d.error.value?"error":"success"):b&&(h.payload.serverRendered&&h.isHydrating||c.lazy)&&c.immediate?b._nuxtOnBeforeMountCbs.push(u):c.immediate&&u();const k=rl();if(c.watch){const _=ot(c.watch,()=>d.refresh());k&&la(_)}const M=h.hook("app:data:refresh",async _=>{(!_||_.includes(r))&&await d.refresh()});k&&la(M)}const g=Promise.resolve(h._asyncDataPromises[r]).then(()=>d);return Object.assign(g,d),g}function kl(C,n){n in C.payload.data&&(C.payload.data[n]=void 0),n in C.payload._errors&&(C.payload._errors[n]=Ln.errorValue),C._asyncData[n]&&(C._asyncData[n].data.value=void 0,C._asyncData[n].error.value=Ln.errorValue,C._asyncData[n].pending.value=!1,C._asyncData[n].status.value="idle"),n in C._asyncDataPromises&&(C._asyncDataPromises[n]&&(C._asyncDataPromises[n].cancelled=!0),C._asyncDataPromises[n]=void 0)}function xl(C,n){const r={};for(const s of n)r[s]=C[s];return r}function Ml(C,n,r){const[s={},c]=typeof n=="string"?[{},n]:[n,r],h=Ae(()=>ln(C)),m=s.key||Sl([c,typeof h.value=="string"?h.value:"",..._l(s)]);if(!m||typeof m!="string")throw new TypeError("[nuxt] [useFetch] key must be a string: "+m);const f=m===c?"$f"+m:m;if(!s.baseURL&&typeof h.value=="string"&&h.value[0]==="/"&&h.value[1]==="/")throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:w,lazy:T,default:S,transform:d,pick:u,watch:p,immediate:g,getCachedData:v,deep:b,dedupe:k,...M}=s,_=ol({...sl,...M,cache:typeof s.cache=="boolean"?void 0:s.cache}),x={server:w,lazy:T,default:S,transform:d,pick:u,immediate:g,getCachedData:v,deep:b,dedupe:k,watch:p===!1?[]:[_,h,...p||[]]};let y;return Tl(f,()=>{var I;(I=y==null?void 0:y.abort)==null||I.call(y,new DOMException("Request aborted as another request to the same endpoint was initiated.","AbortError")),y=typeof AbortController<"u"?new AbortController:{};const N=ln(s.timeout);let F;return N&&(F=setTimeout(()=>y.abort(new DOMException("Request aborted due to timeout.","AbortError")),N),y.signal.onabort=()=>clearTimeout(F)),(s.$fetch||globalThis.$fetch)(h.value,{signal:y.signal,..._}).finally(()=>{clearTimeout(F)})},x)}function _l(C){var r;const n=[((r=ln(C.method))==null?void 0:r.toUpperCase())||"GET",ln(C.baseURL)];for(const s of[C.params||C.query]){const c=ln(s);if(!c)continue;const h={};for(const[m,f]of Object.entries(c))h[ln(m)]=ln(f);n.push(h)}return n}const Ll={wrapper:"w-full flex flex-col gap-2",indicator:{container:{base:"flex flex-row justify-end",width:"min-w-fit",transition:"transition-all"},align:"text-end",width:"w-fit",color:"text-gray-400 dark:text-gray-500",size:{"2xs":"text-xs",xs:"text-xs",sm:"text-sm",md:"text-sm",lg:"text-sm",xl:"text-base","2xl":"text-base"}},progress:{base:"block appearance-none border-none overflow-hidden",width:"w-full [&::-webkit-progress-bar]:w-full",size:{"2xs":"h-px",xs:"h-0.5",sm:"h-1",md:"h-2",lg:"h-3",xl:"h-4","2xl":"h-5"},rounded:"rounded-full [&::-webkit-progress-bar]:rounded-full",track:"[&::-webkit-progress-bar]:bg-gray-200 [&::-webkit-progress-bar]:dark:bg-gray-700 [@supports(selector(&::-moz-progress-bar))]:bg-gray-200 [@supports(selector(&::-moz-progress-bar))]:dark:bg-gray-700",bar:"[&::-webkit-progress-value]:rounded-full [&::-webkit-progress-value]:transition-all [&::-webkit-progress-value]:ease-in-out [&::-moz-progress-bar]:rounded-full",color:"text-{color}-500 dark:text-{color}-400",background:"[&::-webkit-progress-value]:bg-current [&::-moz-progress-bar]:bg-current",indeterminate:{base:"indeterminate:relative",rounded:"indeterminate:after:rounded-full [&:indeterminate::-webkit-progress-value]:rounded-full [&:indeterminate::-moz-progress-bar]:rounded-full"}},steps:{base:"grid grid-cols-1",color:"text-{color}-500 dark:text-{color}-400",size:{"2xs":"text-xs",xs:"text-xs",sm:"text-sm",md:"text-sm",lg:"text-sm",xl:"text-base","2xl":"text-base"}},step:{base:"transition-all opacity-0 truncate row-start-1 col-start-1",align:"text-end",active:"opacity-100",first:"text-gray-500 dark:text-gray-400"},animation:{carousel:"bar-animation-carousel","carousel-inverse":"bar-animation-carousel-inverse",swing:"bar-animation-swing",elastic:"bar-animation-elastic"},default:{color:"primary",size:"md",animation:"carousel"}},Al={base:"mx-auto",padding:"px-4 sm:px-6 lg:px-8",constrained:"max-w-7xl"},Dl=Fa(Kn.ui.strategy,Kn.ui.container,Al),Ol=wt({inheritAttrs:!1,props:{as:{type:String,default:"div"},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(C){const{ui:n,attrs:r}=$a("container",Mi(C,"ui"),Dl),s=Ae(()=>cl(en(n.value.base,n.value.padding,n.value.constrained),C.class));return{ui:n,attrs:r,containerClass:s}}});function Pl(C,n,r,s,c,h){return ue(),bt(ll(C.as),Ti({class:C.containerClass},C.attrs),{default:Ue(()=>[pr(C.$slots,"default")]),_:3},16,["class"])}const Rl=Kt(Ol,[["render",Pl]]),Xa=Ua("messageStore",()=>{const C=ae([]),n=ae(0),r=ae(!0),s=ae(1),c=ae(15),h=He(),m=ae(!1),f=ae(null),w=ae([]),T=ae([]),S=ae(null);return{messages:C,total:n,hasMore:r,page:s,pageSize:c,loading:m,siteConfig:f,reset:()=>{C.value=[],n.value=0,r.value=!0,s.value=1,m.value=!1},getMessages:async I=>{if(!m.value){m.value=!0;try{const j=await un("messages/page",I,{credentials:"include"});if(!j)return h.add({title:"获取笔记列表失败",description:"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const q=j.data.items.filter(ne=>!C.value.some(ce=>ce.id===ne.id));return I.page===1?C.value=j.data.items:C.value=[...C.value,...q],n.value=j.data.total,s.value=I.page,c.value=I.pageSize,r.value=C.value.length<n.value,j.data}catch(j){console.error("获取笔记列表失败:",j),h.add({title:"获取笔记列表失败",description:"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3})}finally{m.value=!1}}},deleteMessage:async I=>{try{const j=await Va(`messages/${I}`,void 0,{credentials:"include"});return!j||j.code!==1?(h.add({title:"删除笔记失败",description:j==null?void 0:j.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):(C.value=C.value.filter(q=>q.id!==I),n.value-=1,j)}catch(j){throw console.error("删除笔记失败:",j),j}},updateMessage:async(I,j)=>{try{const q=await li(`messages/${I}`,{content:j},{credentials:"include"});if(!q||q.code!==1)return h.add({title:"更新笔记失败",description:q==null?void 0:q.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const ne=C.value.findIndex(ce=>ce.id===I);return ne!==-1&&(C.value[ne]=q.data),q}catch(q){throw console.error("更新笔记失败:",q),q}},setPinned:async(I,j)=>{try{const q=await li(`messages/${I}/pin`,{pinned:j},{credentials:"include"});if(!q||q.code!==1)return h.add({title:"更新置顶状态失败",description:q==null?void 0:q.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const ne=C.value.findIndex(ce=>ce.id===I);return ne!==-1&&(C.value[ne]={...C.value[ne],pinned:j},C.value=[...C.value].sort((ce,ke)=>{const Se=ce.pinned?1:0,Ee=ke.pinned?1:0;return Se!==Ee?Ee-Se:new Date(ke.created_at).getTime()-new Date(ce.created_at).getTime()})),q}catch(q){throw console.error("更新置顶状态失败:",q),q}},getMessageById:async I=>{try{const j=await Nt(`messages/${I}`,void 0,{credentials:"include"});return!j||j.code!==1?(h.add({title:"获取消息失败",description:(j==null?void 0:j.msg)||"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):j.data}catch(j){throw console.error("获取消息失败:",j),j}},getSiteConfig:async()=>{try{const I=await Nt("site/config",void 0,{credentials:"include"});return!I||I.code!==1?(h.add({title:"获取网站配置失败",description:(I==null?void 0:I.msg)||"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):(f.value=I.data,Qe(),I.data)}catch(I){throw console.error("获取网站配置失败:",I),I}},updateSiteConfig:async(I,j)=>{try{const q=await li("site/config",{[I]:j},{credentials:"include"});return!q||q.code!==1?(h.add({title:"更新配置失败",description:q==null?void 0:q.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):(f.value={...f.value,[I]:j},q.data)}catch(q){throw console.error("更新配置失败:",q),q}},tags:w,images:T,getAllTags:async()=>{try{const I=await Nt("messages/tags",void 0,{credentials:"include"});return!I||I.code!==1?(h.add({title:"获取标签列表失败",description:(I==null?void 0:I.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(w.value=I.data,I.data)}catch(I){throw console.error("获取标签列表失败:",I),I}},getMessagesByTag:async I=>{try{const j=await Nt(`messages/tags/${encodeURIComponent(I)}`,void 0,{credentials:"include"});return!j||j.code!==1?(h.add({title:"获取标签消息失败",description:(j==null?void 0:j.msg)||"请稍后重试",color:"red",timeout:2e3}),null):j.data}catch(j){throw console.error("获取标签消息失败:",j),j}},getAllImages:async()=>{try{const I=await Nt("messages/images",void 0,{credentials:"include"});return!I||I.code!==1?(h.add({title:"获取图片列表失败",description:(I==null?void 0:I.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(T.value=I.data,I.data)}catch(I){throw console.error("获取图片列表失败:",I),I}},notifyConfig:S,getNotifyConfig:async()=>{try{const I=await Nt("notify/config",void 0,{credentials:"include"});return!I||I.code!==1?(h.add({title:"获取推送配置失败",description:(I==null?void 0:I.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(S.value=I.data,I.data)}catch(I){throw console.error("获取推送配置失败:",I),I}},updateNotifyConfig:async I=>{try{const j=await li("notify/config",I,{credentials:"include"});return!j||j.code!==1?(h.add({title:"更新推送配置失败",description:(j==null?void 0:j.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(S.value=j.data,j.data)}catch(j){throw console.error("更新推送配置失败:",j),j}},testNotify:async I=>{try{const j=await un(`notify/test?type=${I}`,{},{credentials:"include"});if(!j||j.code!==1)throw new Error((j==null?void 0:j.msg)||"测试失败");return j.data}catch(j){throw console.error("推送测试失败:",j),j}},createMessage:async I=>{try{const j=await un("messages",I,{credentials:"include"});if(!j||j.code!==1)throw new Error((j==null?void 0:j.msg)||"创建消息失败");if(I.notify)try{const q=Gn().public.baseApi,ne={content:I.content,images:I.image_url?[`${q}${I.image_url}`].filter(Boolean):[],format:"markdown"},ce=await un("notify/send",ne,{credentials:"include"});(!ce||ce.code!==1)&&console.warn("推送失败:",ce==null?void 0:ce.msg)}catch(q){console.error("消息推送失败:",q)}return h.add({title:"成功",description:"发布成功",color:"green",timeout:2e3}),j.data}catch(j){throw console.error("创建消息失败:",j),j}}}}),Ja=()=>{const C=Xa(),n=He();return{save:async h=>{try{const m=await un("messages",h);if(!m||m.code!==1)return console.log(m==null?void 0:m.code),n.add({title:"添加失败",description:String(m==null?void 0:m.msg),icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const f=m.data;return C.messages.unshift(f),n.add({title:"保存成功",description:"消息已保存",icon:"i-fluent-checkmark-starburst-16-filled",color:"green",timeout:1e3}),m.data}catch(m){console.error(m)}},uploadImage:async h=>{try{const m=new FormData;m.append("image",h);const f=await un("images/upload",m);return!f||f.code!==1?(console.log(f==null?void 0:f.code),n.add({title:"上传失败",description:String(f==null?void 0:f.msg),icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):f.data}catch(m){return console.error("上传图片错误:",m),null}},deleteMessage:async h=>{try{const m=await C.deleteMessage(h);if(m&&m.code===1)return n.add({title:"删除成功",description:"笔记已删除",icon:"i-fluent-checkmark-starburst-16-filled",color:"green",timeout:1e3}),!0}catch(m){console.error(m)}}}},pe=(C,n=1e4)=>(C=parseFloat(C+"")||0,Math.round((C+Number.EPSILON)*n)/n),mr=function(C){if(!(C&&C instanceof Element&&C.offsetParent))return!1;const n=C.scrollHeight>C.clientHeight,r=window.getComputedStyle(C).overflowY,s=r.indexOf("hidden")!==-1,c=r.indexOf("visible")!==-1;return n&&!s&&!c},_i=function(C,n=void 0){return!(!C||C===document.body||n&&C===n)&&(mr(C)?C:_i(C.parentElement,n))},Bt=function(C){var n=new DOMParser().parseFromString(C,"text/html").body;if(n.childElementCount>1){for(var r=document.createElement("div");n.firstChild;)r.appendChild(n.firstChild);return r}return n.firstChild},Sr=C=>`${C||""}`.split(" ").filter(n=>!!n),zt=(C,n,r)=>{C&&Sr(n).forEach(s=>{C.classList.toggle(s,r||!1)})};class Sn{constructor(n){Object.defineProperty(this,"pageX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pageY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"nativePointer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.nativePointer=n,this.pageX=n.pageX,this.pageY=n.pageY,this.clientX=n.clientX,this.clientY=n.clientY,this.id=self.Touch&&n instanceof Touch?n.identifier:-1,this.time=Date.now()}}const Cn={passive:!1};class Il{constructor(n,{start:r=()=>!0,move:s=()=>{},end:c=()=>{}}){Object.defineProperty(this,"element",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"startCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"moveCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"endCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"currentPointers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"startPointers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.element=n,this.startCallback=r,this.moveCallback=s,this.endCallback=c;for(const h of["onPointerStart","onTouchStart","onMove","onTouchEnd","onPointerEnd","onWindowBlur"])this[h]=this[h].bind(this);this.element.addEventListener("mousedown",this.onPointerStart,Cn),this.element.addEventListener("touchstart",this.onTouchStart,Cn),this.element.addEventListener("touchmove",this.onMove,Cn),this.element.addEventListener("touchend",this.onTouchEnd),this.element.addEventListener("touchcancel",this.onTouchEnd)}onPointerStart(n){if(!n.buttons||n.button!==0)return;const r=new Sn(n);this.currentPointers.some(s=>s.id===r.id)||this.triggerPointerStart(r,n)&&(window.addEventListener("mousemove",this.onMove),window.addEventListener("mouseup",this.onPointerEnd),window.addEventListener("blur",this.onWindowBlur))}onTouchStart(n){for(const r of Array.from(n.changedTouches||[]))this.triggerPointerStart(new Sn(r),n);window.addEventListener("blur",this.onWindowBlur)}onMove(n){const r=this.currentPointers.slice(),s="changedTouches"in n?Array.from(n.changedTouches||[]).map(h=>new Sn(h)):[new Sn(n)],c=[];for(const h of s){const m=this.currentPointers.findIndex(f=>f.id===h.id);m<0||(c.push(h),this.currentPointers[m]=h)}c.length&&this.moveCallback(n,this.currentPointers.slice(),r)}onPointerEnd(n){n.buttons>0&&n.button!==0||(this.triggerPointerEnd(n,new Sn(n)),window.removeEventListener("mousemove",this.onMove),window.removeEventListener("mouseup",this.onPointerEnd),window.removeEventListener("blur",this.onWindowBlur))}onTouchEnd(n){for(const r of Array.from(n.changedTouches||[]))this.triggerPointerEnd(n,new Sn(r))}triggerPointerStart(n,r){return!!this.startCallback(r,n,this.currentPointers.slice())&&(this.currentPointers.push(n),this.startPointers.push(n),!0)}triggerPointerEnd(n,r){const s=this.currentPointers.findIndex(c=>c.id===r.id);s<0||(this.currentPointers.splice(s,1),this.startPointers.splice(s,1),this.endCallback(n,r,this.currentPointers.slice()))}onWindowBlur(){this.clear()}clear(){for(;this.currentPointers.length;){const n=this.currentPointers[this.currentPointers.length-1];this.currentPointers.splice(this.currentPointers.length-1,1),this.startPointers.splice(this.currentPointers.length-1,1),this.endCallback(new Event("touchend",{bubbles:!0,cancelable:!0,clientX:n.clientX,clientY:n.clientY}),n,this.currentPointers.slice())}}stop(){this.element.removeEventListener("mousedown",this.onPointerStart,Cn),this.element.removeEventListener("touchstart",this.onTouchStart,Cn),this.element.removeEventListener("touchmove",this.onMove,Cn),this.element.removeEventListener("touchend",this.onTouchEnd),this.element.removeEventListener("touchcancel",this.onTouchEnd),window.removeEventListener("mousemove",this.onMove),window.removeEventListener("mouseup",this.onPointerEnd),window.removeEventListener("blur",this.onWindowBlur)}}function da(C,n){return n?Math.sqrt(Math.pow(n.clientX-C.clientX,2)+Math.pow(n.clientY-C.clientY,2)):0}function fa(C,n){return n?{clientX:(C.clientX+n.clientX)/2,clientY:(C.clientY+n.clientY)/2}:C}const gr=C=>typeof C=="object"&&C!==null&&C.constructor===Object&&Object.prototype.toString.call(C)==="[object Object]",yt=(C,...n)=>{const r=n.length;for(let s=0;s<r;s++){const c=n[s]||{};Object.entries(c).forEach(([h,m])=>{const f=Array.isArray(m)?[]:{};C[h]||Object.assign(C,{[h]:f}),gr(m)?Object.assign(C[h],yt(f,m)):Array.isArray(m)?Object.assign(C,{[h]:[...m]}):Object.assign(C,{[h]:m})})}return C},Ji=function(C,n){return C.split(".").reduce((r,s)=>typeof r=="object"?r[s]:void 0,n)};class Li{constructor(n={}){Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),this.setOptions(n);for(const r of Object.getOwnPropertyNames(Object.getPrototypeOf(this)))r.startsWith("on")&&typeof this[r]=="function"&&(this[r]=this[r].bind(this))}setOptions(n){this.options=n?yt({},this.constructor.defaults,n):{};for(const[r,s]of Object.entries(this.option("on")||{}))this.on(r,s)}option(n,...r){let s=Ji(n,this.options);return s&&typeof s=="function"&&(s=s.call(this,this,...r)),s}optionFor(n,r,s,...c){let h=Ji(r,n);var m;typeof(m=h)!="string"||isNaN(m)||isNaN(parseFloat(m))||(h=parseFloat(h)),h==="true"&&(h=!0),h==="false"&&(h=!1),h&&typeof h=="function"&&(h=h.call(this,this,n,...c));let f=Ji(r,this.options);return f&&typeof f=="function"?h=f.call(this,this,n,...c,h):h===void 0&&(h=f),h===void 0?s:h}cn(n){const r=this.options.classes;return r&&r[n]||""}localize(n,r=[]){n=String(n).replace(/\{\{(\w+).?(\w+)?\}\}/g,(s,c,h)=>{let m="";return h?m=this.option(`${c[0]+c.toLowerCase().substring(1)}.l10n.${h}`):c&&(m=this.option(`l10n.${c}`)),m||(m=s),m});for(let s=0;s<r.length;s++)n=n.split(r[s][0]).join(r[s][1]);return n=n.replace(/\{\{(.*?)\}\}/g,(s,c)=>c)}on(n,r){let s=[];typeof n=="string"?s=n.split(" "):Array.isArray(n)&&(s=n),this.events||(this.events=new Map),s.forEach(c=>{let h=this.events.get(c);h||(this.events.set(c,[]),h=[]),h.includes(r)||h.push(r),this.events.set(c,h)})}off(n,r){let s=[];typeof n=="string"?s=n.split(" "):Array.isArray(n)&&(s=n),s.forEach(c=>{const h=this.events.get(c);if(Array.isArray(h)){const m=h.indexOf(r);m>-1&&h.splice(m,1)}})}emit(n,...r){[...this.events.get(n)||[]].forEach(s=>s(this,...r)),n!=="*"&&this.emit("*",n,...r)}}Object.defineProperty(Li,"version",{enumerable:!0,configurable:!0,writable:!0,value:"5.0.36"}),Object.defineProperty(Li,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{}});class Cr extends Li{constructor(n={}){super(n),Object.defineProperty(this,"plugins",{enumerable:!0,configurable:!0,writable:!0,value:{}})}attachPlugins(n={}){const r=new Map;for(const[s,c]of Object.entries(n)){const h=this.option(s),m=this.plugins[s];m||h===!1?m&&h===!1&&(m.detach(),delete this.plugins[s]):r.set(s,new c(this,h||{}))}for(const[s,c]of r)this.plugins[s]=c,c.attach()}detachPlugins(n){n=n||Object.keys(this.plugins);for(const r of n){const s=this.plugins[r];s&&s.detach(),delete this.plugins[r]}return this.emit("detachPlugins"),this}}var qe;(function(C){C[C.Init=0]="Init",C[C.Error=1]="Error",C[C.Ready=2]="Ready",C[C.Panning=3]="Panning",C[C.Mousemove=4]="Mousemove",C[C.Destroy=5]="Destroy"})(qe||(qe={}));const qt=["a","b","c","d","e","f"],Qa={PANUP:"Move up",PANDOWN:"Move down",PANLEFT:"Move left",PANRIGHT:"Move right",ZOOMIN:"Zoom in",ZOOMOUT:"Zoom out",TOGGLEZOOM:"Toggle zoom level",TOGGLE1TO1:"Toggle zoom level",ITERATEZOOM:"Toggle zoom level",ROTATECCW:"Rotate counterclockwise",ROTATECW:"Rotate clockwise",FLIPX:"Flip horizontally",FLIPY:"Flip vertically",FITX:"Fit horizontally",FITY:"Fit vertically",RESET:"Reset",TOGGLEFS:"Toggle fullscreen"},Hl={content:null,width:"auto",height:"auto",panMode:"drag",touch:!0,dragMinThreshold:3,lockAxis:!1,mouseMoveFactor:1,mouseMoveFriction:.12,zoom:!0,pinchToZoom:!0,panOnlyZoomed:"auto",minScale:1,maxScale:2,friction:.25,dragFriction:.35,decelFriction:.05,click:"toggleZoom",dblClick:!1,wheel:"zoom",wheelLimit:7,spinner:!0,bounds:"auto",infinite:!1,rubberband:!0,bounce:!0,maxVelocity:75,transformParent:!1,classes:{content:"f-panzoom__content",isLoading:"is-loading",canZoomIn:"can-zoom_in",canZoomOut:"can-zoom_out",isDraggable:"is-draggable",isDragging:"is-dragging",inFullscreen:"in-fullscreen",htmlHasFullscreen:"with-panzoom-in-fullscreen"},l10n:Qa},ha='<circle cx="25" cy="25" r="20"></circle>',Tr='<div class="f-spinner"><svg viewBox="0 0 50 50">'+ha+ha+"</svg></div>",vt=C=>C&&C!==null&&C instanceof Element&&"nodeType"in C,Ve=(C,n)=>{C&&Sr(n).forEach(r=>{C.classList.remove(r)})},Ce=(C,n)=>{C&&Sr(n).forEach(r=>{C.classList.add(r)})},ui={a:1,b:0,c:0,d:1,e:0,f:0},Nl=1e5,di=1e4,Tt="mousemove",pa="drag",ma="content",kt="auto";let Qi=null,er=null;class pn extends Cr{get fits(){return this.contentRect.width-this.contentRect.fitWidth<1&&this.contentRect.height-this.contentRect.fitHeight<1}get isTouchDevice(){return er===null&&(er=window.matchMedia("(hover: none)").matches),er}get isMobile(){return Qi===null&&(Qi=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)),Qi}get panMode(){return this.options.panMode!==Tt||this.isTouchDevice?pa:Tt}get panOnlyZoomed(){const n=this.options.panOnlyZoomed;return n===kt?this.isTouchDevice:n}get isInfinite(){return this.option("infinite")}get angle(){return 180*Math.atan2(this.current.b,this.current.a)/Math.PI||0}get targetAngle(){return 180*Math.atan2(this.target.b,this.target.a)/Math.PI||0}get scale(){const{a:n,b:r}=this.current;return Math.sqrt(n*n+r*r)||1}get targetScale(){const{a:n,b:r}=this.target;return Math.sqrt(n*n+r*r)||1}get minScale(){return this.option("minScale")||1}get fullScale(){const{contentRect:n}=this;return n.fullWidth/n.fitWidth||1}get maxScale(){return this.fullScale*(this.option("maxScale")||1)||1}get coverScale(){const{containerRect:n,contentRect:r}=this,s=Math.max(n.height/r.fitHeight,n.width/r.fitWidth)||1;return Math.min(this.fullScale,s)}get isScaling(){return Math.abs(this.targetScale-this.scale)>1e-5&&!this.isResting}get isContentLoading(){const n=this.content;return!!(n&&n instanceof HTMLImageElement)&&!n.complete}get isResting(){if(this.isBouncingX||this.isBouncingY)return!1;for(const n of qt){const r=n=="e"||n==="f"?1e-4:1e-5;if(Math.abs(this.target[n]-this.current[n])>r)return!1}return!(!this.ignoreBounds&&!this.checkBounds().inBounds)}constructor(n,r={},s={}){var c;if(super(r),Object.defineProperty(this,"pointerTracker",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"resizeObserver",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"updateTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"clickTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"rAF",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"isTicking",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreBounds",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isBouncingX",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isBouncingY",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"clicks",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"trackingPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"pwt",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"cwd",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"pmme",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"friction",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:qe.Init}),Object.defineProperty(this,"isDragging",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"spinner",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"containerRect",{enumerable:!0,configurable:!0,writable:!0,value:{width:0,height:0,innerWidth:0,innerHeight:0}}),Object.defineProperty(this,"contentRect",{enumerable:!0,configurable:!0,writable:!0,value:{top:0,right:0,bottom:0,left:0,fullWidth:0,fullHeight:0,fitWidth:0,fitHeight:0,width:0,height:0}}),Object.defineProperty(this,"dragStart",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0,top:0,left:0,time:0}}),Object.defineProperty(this,"dragOffset",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0,time:0}}),Object.defineProperty(this,"current",{enumerable:!0,configurable:!0,writable:!0,value:Object.assign({},ui)}),Object.defineProperty(this,"target",{enumerable:!0,configurable:!0,writable:!0,value:Object.assign({},ui)}),Object.defineProperty(this,"velocity",{enumerable:!0,configurable:!0,writable:!0,value:{a:0,b:0,c:0,d:0,e:0,f:0}}),Object.defineProperty(this,"lockedAxis",{enumerable:!0,configurable:!0,writable:!0,value:!1}),!n)throw new Error("Container Element Not Found");this.container=n,this.initContent(),this.attachPlugins(Object.assign(Object.assign({},pn.Plugins),s)),this.emit("attachPlugins"),this.emit("init");const h=this.content;if(h.addEventListener("load",this.onLoad),h.addEventListener("error",this.onError),this.isContentLoading){if(this.option("spinner")){n.classList.add(this.cn("isLoading"));const m=Bt(Tr);!n.contains(h)||h.parentElement instanceof HTMLPictureElement?this.spinner=n.appendChild(m):this.spinner=((c=h.parentElement)===null||c===void 0?void 0:c.insertBefore(m,h))||null}this.emit("beforeLoad")}else queueMicrotask(()=>{this.enable()})}initContent(){const{container:n}=this,r=this.cn(ma);let s=this.option(ma)||n.querySelector(`.${r}`);if(s||(s=n.querySelector("img,picture")||n.firstElementChild,s&&Ce(s,r)),s instanceof HTMLPictureElement&&(s=s.querySelector("img")),!s)throw new Error("No content found");this.content=s}onLoad(){const{spinner:n,container:r,state:s}=this;n&&(n.remove(),this.spinner=null),this.option("spinner")&&r.classList.remove(this.cn("isLoading")),this.emit("afterLoad"),s===qe.Init?this.enable():this.updateMetrics()}onError(){this.state!==qe.Destroy&&(this.spinner&&(this.spinner.remove(),this.spinner=null),this.stop(),this.detachEvents(),this.state=qe.Error,this.emit("error"))}getNextScale(n){const{fullScale:r,targetScale:s,coverScale:c,maxScale:h,minScale:m}=this;let f=m;switch(n){case"toggleMax":f=s-m<.5*(h-m)?h:m;break;case"toggleCover":f=s-m<.5*(c-m)?c:m;break;case"toggleZoom":f=s-m<.5*(r-m)?r:m;break;case"iterateZoom":let w=[1,r,h].sort((S,d)=>S-d),T=w.findIndex(S=>S>s+1e-5);f=w[T]||1}return f}attachObserver(){var n;const r=()=>{const{container:s,containerRect:c}=this;return Math.abs(c.width-s.getBoundingClientRect().width)>.1||Math.abs(c.height-s.getBoundingClientRect().height)>.1};this.resizeObserver||window.ResizeObserver===void 0||(this.resizeObserver=new ResizeObserver(()=>{this.updateTimer||(r()?(this.onResize(),this.isMobile&&(this.updateTimer=setTimeout(()=>{r()&&this.onResize(),this.updateTimer=null},500))):this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null))})),(n=this.resizeObserver)===null||n===void 0||n.observe(this.container)}detachObserver(){var n;(n=this.resizeObserver)===null||n===void 0||n.disconnect()}attachEvents(){const{container:n}=this;n.addEventListener("click",this.onClick,{passive:!1,capture:!1}),n.addEventListener("wheel",this.onWheel,{passive:!1}),this.pointerTracker=new Il(n,{start:this.onPointerDown,move:this.onPointerMove,end:this.onPointerUp}),document.addEventListener(Tt,this.onMouseMove)}detachEvents(){var n;const{container:r}=this;r.removeEventListener("click",this.onClick,{passive:!1,capture:!1}),r.removeEventListener("wheel",this.onWheel,{passive:!1}),(n=this.pointerTracker)===null||n===void 0||n.stop(),this.pointerTracker=null,document.removeEventListener(Tt,this.onMouseMove),document.removeEventListener("keydown",this.onKeydown,!0),this.clickTimer&&(clearTimeout(this.clickTimer),this.clickTimer=null),this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null)}animate(){this.setTargetForce();const n=this.friction,r=this.option("maxVelocity");for(const s of qt)n?(this.velocity[s]*=1-n,r&&!this.isScaling&&(this.velocity[s]=Math.max(Math.min(this.velocity[s],r),-1*r)),this.current[s]+=this.velocity[s]):this.current[s]=this.target[s];this.setTransform(),this.setEdgeForce(),!this.isResting||this.isDragging?this.rAF=requestAnimationFrame(()=>this.animate()):this.stop("current")}setTargetForce(){for(const n of qt)n==="e"&&this.isBouncingX||n==="f"&&this.isBouncingY||(this.velocity[n]=(1/(1-this.friction)-1)*(this.target[n]-this.current[n]))}checkBounds(n=0,r=0){const{current:s}=this,c=s.e+n,h=s.f+r,m=this.getBounds(),{x:f,y:w}=m,T=f.min,S=f.max,d=w.min,u=w.max;let p=0,g=0;return T!==1/0&&c<T?p=T-c:S!==1/0&&c>S&&(p=S-c),d!==1/0&&h<d?g=d-h:u!==1/0&&h>u&&(g=u-h),Math.abs(p)<1e-4&&(p=0),Math.abs(g)<1e-4&&(g=0),Object.assign(Object.assign({},m),{xDiff:p,yDiff:g,inBounds:!p&&!g})}clampTargetBounds(){const{target:n}=this,{x:r,y:s}=this.getBounds();r.min!==1/0&&(n.e=Math.max(n.e,r.min)),r.max!==1/0&&(n.e=Math.min(n.e,r.max)),s.min!==1/0&&(n.f=Math.max(n.f,s.min)),s.max!==1/0&&(n.f=Math.min(n.f,s.max))}calculateContentDim(n=this.current){const{content:r,contentRect:s}=this,{fitWidth:c,fitHeight:h,fullWidth:m,fullHeight:f}=s;let w=m,T=f;if(this.option("zoom")||this.angle!==0){const S=!(r instanceof HTMLImageElement)&&(window.getComputedStyle(r).maxWidth==="none"||window.getComputedStyle(r).maxHeight==="none"),d=S?m:c,u=S?f:h,p=this.getMatrix(n),g=new DOMPoint(0,0).matrixTransform(p),v=new DOMPoint(0+d,0).matrixTransform(p),b=new DOMPoint(0+d,0+u).matrixTransform(p),k=new DOMPoint(0,0+u).matrixTransform(p),M=Math.abs(b.x-g.x),_=Math.abs(b.y-g.y),x=Math.abs(k.x-v.x),y=Math.abs(k.y-v.y);w=Math.max(M,x),T=Math.max(_,y)}return{contentWidth:w,contentHeight:T}}setEdgeForce(){if(this.ignoreBounds||this.isDragging||this.panMode===Tt||this.targetScale<this.scale)return this.isBouncingX=!1,void(this.isBouncingY=!1);const{target:n}=this,{x:r,y:s,xDiff:c,yDiff:h}=this.checkBounds(),m=this.option("maxVelocity");let f=this.velocity.e,w=this.velocity.f;c!==0?(this.isBouncingX=!0,c*f<=0?f+=.14*c:(f=.14*c,r.min!==1/0&&(this.target.e=Math.max(n.e,r.min)),r.max!==1/0&&(this.target.e=Math.min(n.e,r.max))),m&&(f=Math.max(Math.min(f,m),-1*m))):this.isBouncingX=!1,h!==0?(this.isBouncingY=!0,h*w<=0?w+=.14*h:(w=.14*h,s.min!==1/0&&(this.target.f=Math.max(n.f,s.min)),s.max!==1/0&&(this.target.f=Math.min(n.f,s.max))),m&&(w=Math.max(Math.min(w,m),-1*m))):this.isBouncingY=!1,this.isBouncingX&&(this.velocity.e=f),this.isBouncingY&&(this.velocity.f=w)}enable(){const{content:n}=this,r=new DOMMatrixReadOnly(window.getComputedStyle(n).transform);for(const s of qt)this.current[s]=this.target[s]=r[s];this.updateMetrics(),this.attachObserver(),this.attachEvents(),this.state=qe.Ready,this.emit("ready")}onClick(n){var r;n.type==="click"&&n.detail===0&&(this.dragOffset.x=0,this.dragOffset.y=0),this.isDragging&&((r=this.pointerTracker)===null||r===void 0||r.clear(),this.trackingPoints=[],this.startDecelAnim());const s=n.target;if(!s||n.defaultPrevented)return;if(s.hasAttribute("disabled"))return n.preventDefault(),void n.stopPropagation();if((()=>{const p=window.getSelection();return p&&p.type==="Range"})()&&!s.closest("button"))return;const c=s.closest("[data-panzoom-action]"),h=s.closest("[data-panzoom-change]"),m=c||h,f=m&&vt(m)?m.dataset:null;if(f){const p=f.panzoomChange,g=f.panzoomAction;if((p||g)&&n.preventDefault(),p){let v={};try{v=JSON.parse(p)}catch{console&&console.warn("The given data was not valid JSON")}return void this.applyChange(v)}if(g)return void(this[g]&&this[g]())}if(Math.abs(this.dragOffset.x)>3||Math.abs(this.dragOffset.y)>3)return n.preventDefault(),void n.stopPropagation();if(s.closest("[data-fancybox]"))return;const w=this.content.getBoundingClientRect(),T=this.dragStart;if(T.time&&!this.canZoomOut()&&(Math.abs(w.x-T.x)>2||Math.abs(w.y-T.y)>2))return;this.dragStart.time=0;const S=p=>{this.option("zoom",n)&&p&&typeof p=="string"&&/(iterateZoom)|(toggle(Zoom|Full|Cover|Max)|(zoomTo(Fit|Cover|Max)))/.test(p)&&typeof this[p]=="function"&&(n.preventDefault(),this[p]({event:n}))},d=this.option("click",n),u=this.option("dblClick",n);u?(this.clicks++,this.clicks==1&&(this.clickTimer=setTimeout(()=>{this.clicks===1?(this.emit("click",n),!n.defaultPrevented&&d&&S(d)):(this.emit("dblClick",n),n.defaultPrevented||S(u)),this.clicks=0,this.clickTimer=null},350))):(this.emit("click",n),!n.defaultPrevented&&d&&S(d))}addTrackingPoint(n){const r=this.trackingPoints.filter(s=>s.time>Date.now()-100);r.push(n),this.trackingPoints=r}onPointerDown(n,r,s){var c;if(this.option("touch",n)===!1)return!1;this.pwt=0,this.dragOffset={x:0,y:0,time:0},this.trackingPoints=[];const h=this.content.getBoundingClientRect();if(this.dragStart={x:h.x,y:h.y,top:h.top,left:h.left,time:Date.now()},this.clickTimer)return!1;if(this.panMode===Tt&&this.targetScale>1)return n.preventDefault(),n.stopPropagation(),!1;const m=n.composedPath()[0];if(!s.length){if(["TEXTAREA","OPTION","INPUT","SELECT","VIDEO","IFRAME"].includes(m.nodeName)||m.closest("[contenteditable],[data-selectable],[data-draggable],[data-clickable],[data-panzoom-change],[data-panzoom-action]"))return!1;(c=window.getSelection())===null||c===void 0||c.removeAllRanges()}if(n.type==="mousedown")["A","BUTTON"].includes(m.nodeName)||n.preventDefault();else if(Math.abs(this.velocity.a)>.3)return!1;return this.target.e=this.current.e,this.target.f=this.current.f,this.stop(),this.isDragging||(this.isDragging=!0,this.addTrackingPoint(r),this.emit("touchStart",n)),!0}onPointerMove(n,r,s){if(this.option("touch",n)===!1||!this.isDragging||r.length<2&&this.panOnlyZoomed&&pe(this.targetScale)<=pe(this.minScale)||(this.emit("touchMove",n),n.defaultPrevented))return;this.addTrackingPoint(r[0]);const{content:c}=this,h=fa(s[0],s[1]),m=fa(r[0],r[1]);let f=0,w=0;if(r.length>1){const _=c.getBoundingClientRect();f=h.clientX-_.left-.5*_.width,w=h.clientY-_.top-.5*_.height}const T=da(s[0],s[1]),S=da(r[0],r[1]);let d=T?S/T:1,u=m.clientX-h.clientX,p=m.clientY-h.clientY;this.dragOffset.x+=u,this.dragOffset.y+=p,this.dragOffset.time=Date.now()-this.dragStart.time;let g=pe(this.targetScale)===pe(this.minScale)&&this.option("lockAxis");if(g&&!this.lockedAxis)if(g==="xy"||g==="y"||n.type==="touchmove"){if(Math.abs(this.dragOffset.x)<6&&Math.abs(this.dragOffset.y)<6)return void n.preventDefault();const _=Math.abs(180*Math.atan2(this.dragOffset.y,this.dragOffset.x)/Math.PI);this.lockedAxis=_>45&&_<135?"y":"x",this.dragOffset.x=0,this.dragOffset.y=0,u=0,p=0}else this.lockedAxis=g;if(_i(n.target,this.content)&&(g="x",this.dragOffset.y=0),g&&g!=="xy"&&this.lockedAxis!==g&&pe(this.targetScale)===pe(this.minScale))return;n.cancelable&&n.preventDefault(),this.container.classList.add(this.cn("isDragging"));const v=this.checkBounds(u,p);this.option("rubberband")?(this.isInfinite!=="x"&&(v.xDiff>0&&u<0||v.xDiff<0&&u>0)&&(u*=Math.max(0,.5-Math.abs(.75/this.contentRect.fitWidth*v.xDiff))),this.isInfinite!=="y"&&(v.yDiff>0&&p<0||v.yDiff<0&&p>0)&&(p*=Math.max(0,.5-Math.abs(.75/this.contentRect.fitHeight*v.yDiff)))):(v.xDiff&&(u=0),v.yDiff&&(p=0));const b=this.targetScale,k=this.minScale,M=this.maxScale;b<.5*k&&(d=Math.max(d,k)),b>1.5*M&&(d=Math.min(d,M)),this.lockedAxis==="y"&&pe(b)===pe(k)&&(u=0),this.lockedAxis==="x"&&pe(b)===pe(k)&&(p=0),this.applyChange({originX:f,originY:w,panX:u,panY:p,scale:d,friction:this.option("dragFriction"),ignoreBounds:!0})}onPointerUp(n,r,s){if(s.length)return this.dragOffset.x=0,this.dragOffset.y=0,void(this.trackingPoints=[]);this.container.classList.remove(this.cn("isDragging")),this.isDragging&&(this.addTrackingPoint(r),this.panOnlyZoomed&&this.contentRect.width-this.contentRect.fitWidth<1&&this.contentRect.height-this.contentRect.fitHeight<1&&(this.trackingPoints=[]),_i(n.target,this.content)&&this.lockedAxis==="y"&&(this.trackingPoints=[]),this.emit("touchEnd",n),this.isDragging=!1,this.lockedAxis=!1,this.state!==qe.Destroy&&(n.defaultPrevented||this.startDecelAnim()))}startDecelAnim(){var n;const r=this.isScaling;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.isBouncingX=!1,this.isBouncingY=!1;for(const _ of qt)this.velocity[_]=0;this.target.e=this.current.e,this.target.f=this.current.f,Ve(this.container,"is-scaling"),Ve(this.container,"is-animating"),this.isTicking=!1;const{trackingPoints:s}=this,c=s[0],h=s[s.length-1];let m=0,f=0,w=0;h&&c&&(m=h.clientX-c.clientX,f=h.clientY-c.clientY,w=h.time-c.time);const T=((n=window.visualViewport)===null||n===void 0?void 0:n.scale)||1;T!==1&&(m*=T,f*=T);let S=0,d=0,u=0,p=0,g=this.option("decelFriction");const v=this.targetScale;if(w>0){u=Math.abs(m)>3?m/(w/30):0,p=Math.abs(f)>3?f/(w/30):0;const _=this.option("maxVelocity");_&&(u=Math.max(Math.min(u,_),-1*_),p=Math.max(Math.min(p,_),-1*_))}u&&(S=u/(1/(1-g)-1)),p&&(d=p/(1/(1-g)-1)),(this.option("lockAxis")==="y"||this.option("lockAxis")==="xy"&&this.lockedAxis==="y"&&pe(v)===this.minScale)&&(S=u=0),(this.option("lockAxis")==="x"||this.option("lockAxis")==="xy"&&this.lockedAxis==="x"&&pe(v)===this.minScale)&&(d=p=0);const b=this.dragOffset.x,k=this.dragOffset.y,M=this.option("dragMinThreshold")||0;Math.abs(b)<M&&Math.abs(k)<M&&(S=d=0,u=p=0),(this.option("zoom")&&(v<this.minScale-1e-5||v>this.maxScale+1e-5)||r&&!S&&!d)&&(g=.35),this.applyChange({panX:S,panY:d,friction:g}),this.emit("decel",u,p,b,k)}onWheel(n){var r=[-n.deltaX||0,-n.deltaY||0,-n.detail||0].reduce(function(h,m){return Math.abs(m)>Math.abs(h)?m:h});const s=Math.max(-1,Math.min(1,r));if(this.emit("wheel",n,s),this.panMode===Tt||n.defaultPrevented)return;const c=this.option("wheel");c==="pan"?(n.preventDefault(),this.panOnlyZoomed&&!this.canZoomOut()||this.applyChange({panX:2*-n.deltaX,panY:2*-n.deltaY,bounce:!1})):c==="zoom"&&this.option("zoom")!==!1&&this.zoomWithWheel(n)}onMouseMove(n){this.panWithMouse(n)}onKeydown(n){n.key==="Escape"&&this.toggleFS()}onResize(){this.updateMetrics(),this.checkBounds().inBounds||this.requestTick()}setTransform(){this.emit("beforeTransform");const{current:n,target:r,content:s,contentRect:c}=this,h=Object.assign({},ui);for(const b of qt){const k=b=="e"||b==="f"?di:Nl;h[b]=pe(n[b],k),Math.abs(r[b]-n[b])<(b=="e"||b==="f"?.51:.001)&&(n[b]=r[b])}let{a:m,b:f,c:w,d:T,e:S,f:d}=h,u=`matrix(${m}, ${f}, ${w}, ${T}, ${S}, ${d})`,p=s.parentElement instanceof HTMLPictureElement?s.parentElement:s;if(this.option("transformParent")&&(p=p.parentElement||p),p.style.transform===u)return;p.style.transform=u;const{contentWidth:g,contentHeight:v}=this.calculateContentDim();c.width=g,c.height=v,this.emit("afterTransform")}updateMetrics(n=!1){var r;if(!this||this.state===qe.Destroy||this.isContentLoading)return;const s=Math.max(1,((r=window.visualViewport)===null||r===void 0?void 0:r.scale)||1),{container:c,content:h}=this,m=h instanceof HTMLImageElement,f=c.getBoundingClientRect(),w=getComputedStyle(this.container);let T=f.width*s,S=f.height*s;const d=parseFloat(w.paddingTop)+parseFloat(w.paddingBottom),u=T-(parseFloat(w.paddingLeft)+parseFloat(w.paddingRight)),p=S-d;this.containerRect={width:T,height:S,innerWidth:u,innerHeight:p};const g=parseFloat(h.dataset.width||"")||(ne=>{let ce=0;return ce=ne instanceof HTMLImageElement?ne.naturalWidth:ne instanceof SVGElement?ne.width.baseVal.value:Math.max(ne.offsetWidth,ne.scrollWidth),ce||0})(h),v=parseFloat(h.dataset.height||"")||(ne=>{let ce=0;return ce=ne instanceof HTMLImageElement?ne.naturalHeight:ne instanceof SVGElement?ne.height.baseVal.value:Math.max(ne.offsetHeight,ne.scrollHeight),ce||0})(h);let b=this.option("width",g)||kt,k=this.option("height",v)||kt;const M=b===kt,_=k===kt;typeof b!="number"&&(b=g),typeof k!="number"&&(k=v),M&&(b=g*(k/v)),_&&(k=v/(g/b));let x=h.parentElement instanceof HTMLPictureElement?h.parentElement:h;this.option("transformParent")&&(x=x.parentElement||x);const y=x.getAttribute("style")||"";x.style.setProperty("transform","none","important"),m&&(x.style.width="",x.style.height=""),x.offsetHeight;const O=h.getBoundingClientRect();let N=O.width*s,F=O.height*s,R=N,I=F;N=Math.min(N,b),F=Math.min(F,k),m?{width:N,height:F}=((ne,ce,ke,Se)=>{const Ee=ke/ne,me=Se/ce,Me=Math.min(Ee,me);return{width:ne*=Me,height:ce*=Me}})(b,k,N,F):(N=Math.min(N,b),F=Math.min(F,k));let j=.5*(I-F),q=.5*(R-N);this.contentRect=Object.assign(Object.assign({},this.contentRect),{top:O.top-f.top+j,bottom:f.bottom-O.bottom+j,left:O.left-f.left+q,right:f.right-O.right+q,fitWidth:N,fitHeight:F,width:N,height:F,fullWidth:b,fullHeight:k}),x.style.cssText=y,m&&(x.style.width=`${N}px`,x.style.height=`${F}px`),this.setTransform(),n!==!0&&this.emit("refresh"),this.ignoreBounds||(pe(this.targetScale)<pe(this.minScale)?this.zoomTo(this.minScale,{friction:0}):this.targetScale>this.maxScale?this.zoomTo(this.maxScale,{friction:0}):this.state===qe.Init||this.checkBounds().inBounds||this.requestTick()),this.updateControls()}calculateBounds(){const{contentWidth:n,contentHeight:r}=this.calculateContentDim(this.target),{targetScale:s,lockedAxis:c}=this,{fitWidth:h,fitHeight:m}=this.contentRect;let f=0,w=0,T=0,S=0;const d=this.option("infinite");if(d===!0||c&&d===c)f=-1/0,T=1/0,w=-1/0,S=1/0;else{let{containerRect:u,contentRect:p}=this,g=pe(h*s,di),v=pe(m*s,di),{innerWidth:b,innerHeight:k}=u;if(u.width===g&&(b=u.width),u.width===v&&(k=u.height),n>b){T=.5*(n-b),f=-1*T;let M=.5*(p.right-p.left);f+=M,T+=M}if(h>b&&n<b&&(f-=.5*(h-b),T-=.5*(h-b)),r>k){S=.5*(r-k),w=-1*S;let M=.5*(p.bottom-p.top);w+=M,S+=M}m>k&&r<k&&(f-=.5*(m-k),T-=.5*(m-k))}return{x:{min:f,max:T},y:{min:w,max:S}}}getBounds(){const n=this.option("bounds");return n!==kt?n:this.calculateBounds()}updateControls(){const n=this,r=n.container,{panMode:s,contentRect:c,targetScale:h,minScale:m}=n;let f=m,w=n.option("click")||!1;w&&(f=n.getNextScale(w));let T=n.canZoomIn(),S=n.canZoomOut(),d=s===pa&&!!this.option("touch"),u=S&&d;if(d&&(pe(h)<pe(m)&&!this.panOnlyZoomed&&(u=!0),(pe(c.width,1)>pe(c.fitWidth,1)||pe(c.height,1)>pe(c.fitHeight,1))&&(u=!0)),pe(c.width*h,1)<pe(c.fitWidth,1)&&(u=!1),s===Tt&&(u=!1),zt(r,this.cn("isDraggable"),u),!this.option("zoom"))return;let p=T&&pe(f)>pe(h),g=!p&&!u&&S&&pe(f)<pe(h);zt(r,this.cn("canZoomIn"),p),zt(r,this.cn("canZoomOut"),g);for(const v of r.querySelectorAll("[data-panzoom-action]")){let b=!1,k=!1;switch(v.dataset.panzoomAction){case"zoomIn":T?b=!0:k=!0;break;case"zoomOut":S?b=!0:k=!0;break;case"toggleZoom":case"iterateZoom":T||S?b=!0:k=!0;const M=v.querySelector("g");M&&(M.style.display=T?"":"none")}b?(v.removeAttribute("disabled"),v.removeAttribute("tabindex")):k&&(v.setAttribute("disabled",""),v.setAttribute("tabindex","-1"))}}panTo({x:n=this.target.e,y:r=this.target.f,scale:s=this.targetScale,friction:c=this.option("friction"),angle:h=0,originX:m=0,originY:f=0,flipX:w=!1,flipY:T=!1,ignoreBounds:S=!1}){this.state!==qe.Destroy&&this.applyChange({panX:n-this.target.e,panY:r-this.target.f,scale:s/this.targetScale,angle:h,originX:m,originY:f,friction:c,flipX:w,flipY:T,ignoreBounds:S})}applyChange({panX:n=0,panY:r=0,scale:s=1,angle:c=0,originX:h=-this.current.e,originY:m=-this.current.f,friction:f=this.option("friction"),flipX:w=!1,flipY:T=!1,ignoreBounds:S=!1,bounce:d=this.option("bounce")}){const u=this.state;if(u===qe.Destroy)return;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.friction=f||0,this.ignoreBounds=S;const{current:p}=this,g=p.e,v=p.f,b=this.getMatrix(this.target);let k=new DOMMatrix().translate(g,v).translate(h,m).translate(n,r);if(this.option("zoom")){if(!S){const M=this.targetScale,_=this.minScale,x=this.maxScale;M*s<_&&(s=_/M),M*s>x&&(s=x/M)}k=k.scale(s)}k=k.translate(-h,-m).translate(-g,-v).multiply(b),c&&(k=k.rotate(c)),w&&(k=k.scale(-1,1)),T&&(k=k.scale(1,-1));for(const M of qt)M!=="e"&&M!=="f"&&(k[M]>this.minScale+1e-5||k[M]<this.minScale-1e-5)?this.target[M]=k[M]:this.target[M]=pe(k[M],di);(this.targetScale<this.scale||Math.abs(s-1)>.1||this.panMode===Tt||d===!1)&&!S&&this.clampTargetBounds(),u===qe.Init?this.animate():this.isResting||(this.state=qe.Panning,this.requestTick())}stop(n=!1){if(this.state===qe.Init||this.state===qe.Destroy)return;const r=this.isTicking;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.isBouncingX=!1,this.isBouncingY=!1;for(const s of qt)this.velocity[s]=0,n==="current"?this.current[s]=this.target[s]:n==="target"&&(this.target[s]=this.current[s]);this.setTransform(),Ve(this.container,"is-scaling"),Ve(this.container,"is-animating"),this.isTicking=!1,this.state=qe.Ready,r&&(this.emit("endAnimation"),this.updateControls())}requestTick(){this.isTicking||(this.emit("startAnimation"),this.updateControls(),Ce(this.container,"is-animating"),this.isScaling&&Ce(this.container,"is-scaling")),this.isTicking=!0,this.rAF||(this.rAF=requestAnimationFrame(()=>this.animate()))}panWithMouse(n,r=this.option("mouseMoveFriction")){if(this.pmme=n,this.panMode!==Tt||!n||pe(this.targetScale)<=pe(this.minScale))return;this.emit("mouseMove",n);const{container:s,containerRect:c,contentRect:h}=this,m=c.width,f=c.height,w=s.getBoundingClientRect(),T=(n.clientX||0)-w.left,S=(n.clientY||0)-w.top;let{contentWidth:d,contentHeight:u}=this.calculateContentDim(this.target);const p=this.option("mouseMoveFactor");p>1&&(d!==m&&(d*=p),u!==f&&(u*=p));let g=.5*(d-m)-T/m*100/100*(d-m);g+=.5*(h.right-h.left);let v=.5*(u-f)-S/f*100/100*(u-f);v+=.5*(h.bottom-h.top),this.applyChange({panX:g-this.target.e,panY:v-this.target.f,friction:r})}zoomWithWheel(n){if(this.state===qe.Destroy||this.state===qe.Init)return;const r=Date.now();if(r-this.pwt<45)return void n.preventDefault();this.pwt=r;var s=[-n.deltaX||0,-n.deltaY||0,-n.detail||0].reduce(function(T,S){return Math.abs(S)>Math.abs(T)?S:T});const c=Math.max(-1,Math.min(1,s)),{targetScale:h,maxScale:m,minScale:f}=this;let w=h*(100+45*c)/100;pe(w)<pe(f)&&pe(h)<=pe(f)?(this.cwd+=Math.abs(c),w=f):pe(w)>pe(m)&&pe(h)>=pe(m)?(this.cwd+=Math.abs(c),w=m):(this.cwd=0,w=Math.max(Math.min(w,m),f)),this.cwd>this.option("wheelLimit")||(n.preventDefault(),pe(w)!==pe(h)&&this.zoomTo(w,{event:n}))}canZoomIn(){return this.option("zoom")&&(pe(this.contentRect.width,1)<pe(this.contentRect.fitWidth,1)||pe(this.targetScale)<pe(this.maxScale))}canZoomOut(){return this.option("zoom")&&pe(this.targetScale)>pe(this.minScale)}zoomIn(n=1.25,r){this.zoomTo(this.targetScale*n,r)}zoomOut(n=.8,r){this.zoomTo(this.targetScale*n,r)}zoomToFit(n){this.zoomTo("fit",n)}zoomToCover(n){this.zoomTo("cover",n)}zoomToFull(n){this.zoomTo("full",n)}zoomToMax(n){this.zoomTo("max",n)}toggleZoom(n){this.zoomTo(this.getNextScale("toggleZoom"),n)}toggleMax(n){this.zoomTo(this.getNextScale("toggleMax"),n)}toggleCover(n){this.zoomTo(this.getNextScale("toggleCover"),n)}iterateZoom(n){this.zoomTo("next",n)}zoomTo(n=1,{friction:r=kt,originX:s=kt,originY:c=kt,event:h}={}){if(this.isContentLoading||this.state===qe.Destroy)return;const{targetScale:m,fullScale:f,maxScale:w,coverScale:T}=this;if(this.stop(),this.panMode===Tt&&(h=this.pmme||h),h||s===kt||c===kt){const d=this.content.getBoundingClientRect(),u=this.container.getBoundingClientRect(),p=h?h.clientX:u.left+.5*u.width,g=h?h.clientY:u.top+.5*u.height;s=p-d.left-.5*d.width,c=g-d.top-.5*d.height}let S=1;typeof n=="number"?S=n:n==="full"?S=f:n==="cover"?S=T:n==="max"?S=w:n==="fit"?S=1:n==="next"&&(S=this.getNextScale("iterateZoom")),S=S/m||1,r=r===kt?S>1?.15:.25:r,this.applyChange({scale:S,originX:s,originY:c,friction:r}),h&&this.panMode===Tt&&this.panWithMouse(h,r)}rotateCCW(){this.applyChange({angle:-90})}rotateCW(){this.applyChange({angle:90})}flipX(){this.applyChange({flipX:!0})}flipY(){this.applyChange({flipY:!0})}fitX(){this.stop("target");const{containerRect:n,contentRect:r,target:s}=this;this.applyChange({panX:.5*n.width-(r.left+.5*r.fitWidth)-s.e,panY:.5*n.height-(r.top+.5*r.fitHeight)-s.f,scale:n.width/r.fitWidth/this.targetScale,originX:0,originY:0,ignoreBounds:!0})}fitY(){this.stop("target");const{containerRect:n,contentRect:r,target:s}=this;this.applyChange({panX:.5*n.width-(r.left+.5*r.fitWidth)-s.e,panY:.5*n.innerHeight-(r.top+.5*r.fitHeight)-s.f,scale:n.height/r.fitHeight/this.targetScale,originX:0,originY:0,ignoreBounds:!0})}toggleFS(){const{container:n}=this,r=this.cn("inFullscreen"),s=this.cn("htmlHasFullscreen");n.classList.toggle(r);const c=n.classList.contains(r);c?(document.documentElement.classList.add(s),document.addEventListener("keydown",this.onKeydown,!0)):(document.documentElement.classList.remove(s),document.removeEventListener("keydown",this.onKeydown,!0)),this.updateMetrics(),this.emit(c?"enterFS":"exitFS")}getMatrix(n=this.current){const{a:r,b:s,c,d:h,e:m,f}=n;return new DOMMatrix([r,s,c,h,m,f])}reset(n){if(this.state!==qe.Init&&this.state!==qe.Destroy){this.stop("current");for(const r of qt)this.target[r]=ui[r];this.target.a=this.minScale,this.target.d=this.minScale,this.clampTargetBounds(),this.isResting||(this.friction=n===void 0?this.option("friction"):n,this.state=qe.Panning,this.requestTick())}}destroy(){this.stop(),this.state=qe.Destroy,this.detachEvents(),this.detachObserver();const{container:n,content:r}=this,s=this.option("classes")||{};for(const c of Object.values(s))n.classList.remove(c+"");r&&(r.removeEventListener("load",this.onLoad),r.removeEventListener("error",this.onError)),this.detachPlugins()}}Object.defineProperty(pn,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:Hl}),Object.defineProperty(pn,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:{}});const ga=function(C,n){let r=!0;return(...s)=>{r&&(r=!1,C(...s),setTimeout(()=>{r=!0},n))}},va=(C,n)=>{let r=[];return C.childNodes.forEach(s=>{s.nodeType!==Node.ELEMENT_NODE||n&&!s.matches(n)||r.push(s)}),r},jl={viewport:null,track:null,enabled:!0,slides:[],axis:"x",transition:"fade",preload:1,slidesPerPage:"auto",initialPage:0,friction:.12,Panzoom:{decelFriction:.12},center:!0,infinite:!0,fill:!0,dragFree:!1,adaptiveHeight:!1,direction:"ltr",classes:{container:"f-carousel",viewport:"f-carousel__viewport",track:"f-carousel__track",slide:"f-carousel__slide",isLTR:"is-ltr",isRTL:"is-rtl",isHorizontal:"is-horizontal",isVertical:"is-vertical",inTransition:"in-transition",isSelected:"is-selected"},l10n:{NEXT:"Next slide",PREV:"Previous slide",GOTO:"Go to slide #%d"}};var rt;(function(C){C[C.Init=0]="Init",C[C.Ready=1]="Ready",C[C.Destroy=2]="Destroy"})(rt||(rt={}));const tr=C=>{if(typeof C=="string"||C instanceof HTMLElement)C={html:C};else{const n=C.thumb;n!==void 0&&(typeof n=="string"&&(C.thumbSrc=n),n instanceof HTMLImageElement&&(C.thumbEl=n,C.thumbElSrc=n.src,C.thumbSrc=n.src),delete C.thumb)}return Object.assign({html:"",el:null,isDom:!1,class:"",customClass:"",index:-1,dim:0,gap:0,pos:0,transition:!1},C)},Bl=(C={})=>Object.assign({index:-1,slides:[],dim:0,pos:-1},C);class Pt extends Li{constructor(n,r){super(r),Object.defineProperty(this,"instance",{enumerable:!0,configurable:!0,writable:!0,value:n})}attach(){}detach(){}}const zl={classes:{list:"f-carousel__dots",isDynamic:"is-dynamic",hasDots:"has-dots",dot:"f-carousel__dot",isBeforePrev:"is-before-prev",isPrev:"is-prev",isCurrent:"is-current",isNext:"is-next",isAfterNext:"is-after-next"},dotTpl:'<button type="button" data-carousel-page="%i" aria-label="{{GOTO}}"><span class="f-carousel__dot" aria-hidden="true"></span></button>',dynamicFrom:11,maxCount:1/0,minCount:2};class eo extends Pt{constructor(){super(...arguments),Object.defineProperty(this,"isDynamic",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"list",{enumerable:!0,configurable:!0,writable:!0,value:null})}onRefresh(){this.refresh()}build(){let n=this.list;if(!n){n=document.createElement("ul"),Ce(n,this.cn("list")),n.setAttribute("role","tablist");const r=this.instance.container;r.appendChild(n),Ce(r,this.cn("hasDots")),this.list=n}return n}refresh(){var n;const r=this.instance.pages.length,s=Math.min(2,this.option("minCount")),c=Math.max(2e3,this.option("maxCount")),h=this.option("dynamicFrom");if(r<s||r>c)return void this.cleanup();const m=typeof h=="number"&&r>5&&r>=h,f=!this.list||this.isDynamic!==m||this.list.children.length!==r;f&&this.cleanup();const w=this.build();if(zt(w,this.cn("isDynamic"),!!m),f)for(let d=0;d<r;d++)w.append(this.createItem(d));let T,S=0;for(const d of[...w.children]){const u=S===this.instance.page;u&&(T=d),zt(d,this.cn("isCurrent"),u),(n=d.children[0])===null||n===void 0||n.setAttribute("aria-selected",u?"true":"false");for(const p of["isBeforePrev","isPrev","isNext","isAfterNext"])Ve(d,this.cn(p));S++}if(T=T||w.firstChild,m&&T){const d=T.previousElementSibling,u=d&&d.previousElementSibling;Ce(d,this.cn("isPrev")),Ce(u,this.cn("isBeforePrev"));const p=T.nextElementSibling,g=p&&p.nextElementSibling;Ce(p,this.cn("isNext")),Ce(g,this.cn("isAfterNext"))}this.isDynamic=m}createItem(n=0){var r;const s=document.createElement("li");s.setAttribute("role","presentation");const c=Bt(this.instance.localize(this.option("dotTpl"),[["%d",n+1]]).replace(/\%i/g,n+""));return s.appendChild(c),(r=s.children[0])===null||r===void 0||r.setAttribute("role","tab"),s}cleanup(){this.list&&(this.list.remove(),this.list=null),this.isDynamic=!1,Ve(this.instance.container,this.cn("hasDots"))}attach(){this.instance.on(["refresh","change"],this.onRefresh)}detach(){this.instance.off(["refresh","change"],this.onRefresh),this.cleanup()}}Object.defineProperty(eo,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:zl});const fi="disabled",hi="next",ya="prev";class to extends Pt{constructor(){super(...arguments),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"prev",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"next",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"isDom",{enumerable:!0,configurable:!0,writable:!0,value:!1})}onRefresh(){const n=this.instance,r=n.pages.length,s=n.page;if(r<2)return void this.cleanup();this.build();let c=this.prev,h=this.next;c&&h&&(c.removeAttribute(fi),h.removeAttribute(fi),n.isInfinite||(s<=0&&c.setAttribute(fi,""),s>=r-1&&h.setAttribute(fi,"")))}addBtn(n){var r;const s=this.instance,c=document.createElement("button");c.setAttribute("tabindex","0"),c.setAttribute("title",s.localize(`{{${n.toUpperCase()}}}`)),Ce(c,this.cn("button")+" "+this.cn(n===hi?"isNext":"isPrev"));const h=s.isRTL?n===hi?ya:hi:n;var m;return c.innerHTML=s.localize(this.option(`${h}Tpl`)),c.dataset[`carousel${m=n,m?m.match("^[a-z]")?m.charAt(0).toUpperCase()+m.substring(1):m:""}`]="true",(r=this.container)===null||r===void 0||r.appendChild(c),c}build(){const n=this.instance.container,r=this.cn("container");let{container:s,prev:c,next:h}=this;s||(s=n.querySelector("."+r),this.isDom=!!s),s||(s=document.createElement("div"),Ce(s,r),n.appendChild(s)),this.container=s,h||(h=s.querySelector("[data-carousel-next]")),h||(h=this.addBtn(hi)),this.next=h,c||(c=s.querySelector("[data-carousel-prev]")),c||(c=this.addBtn(ya)),this.prev=c}cleanup(){this.isDom||(this.prev&&this.prev.remove(),this.next&&this.next.remove(),this.container&&this.container.remove()),this.prev=null,this.next=null,this.container=null,this.isDom=!1}attach(){this.instance.on(["refresh","change"],this.onRefresh)}detach(){this.instance.off(["refresh","change"],this.onRefresh),this.cleanup()}}Object.defineProperty(to,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{classes:{container:"f-carousel__nav",button:"f-button",isNext:"is-next",isPrev:"is-prev"},nextTpl:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M9 3l9 9-9 9"/></svg>',prevTpl:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M15 3l-9 9 9 9"/></svg>'}});class no extends Pt{constructor(){super(...arguments),Object.defineProperty(this,"selectedIndex",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"target",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"nav",{enumerable:!0,configurable:!0,writable:!0,value:null})}addAsTargetFor(n){this.target=this.instance,this.nav=n,this.attachEvents()}addAsNavFor(n){this.nav=this.instance,this.target=n,this.attachEvents()}attachEvents(){const{nav:n,target:r}=this;n&&r&&(n.options.initialSlide=r.options.initialPage,n.state===rt.Ready?this.onNavReady(n):n.on("ready",this.onNavReady),r.state===rt.Ready?this.onTargetReady(r):r.on("ready",this.onTargetReady))}onNavReady(n){n.on("createSlide",this.onNavCreateSlide),n.on("Panzoom.click",this.onNavClick),n.on("Panzoom.touchEnd",this.onNavTouch),this.onTargetChange()}onTargetReady(n){n.on("change",this.onTargetChange),n.on("Panzoom.refresh",this.onTargetChange),this.onTargetChange()}onNavClick(n,r,s){this.onNavTouch(n,n.panzoom,s)}onNavTouch(n,r,s){var c,h;if(Math.abs(r.dragOffset.x)>3||Math.abs(r.dragOffset.y)>3)return;const m=s.target,{nav:f,target:w}=this;if(!f||!w||!m)return;const T=m.closest("[data-index]");if(s.stopPropagation(),s.preventDefault(),!T)return;const S=parseInt(T.dataset.index||"",10)||0,d=w.getPageForSlide(S),u=f.getPageForSlide(S);f.slideTo(u),w.slideTo(d,{friction:((h=(c=this.nav)===null||c===void 0?void 0:c.plugins)===null||h===void 0?void 0:h.Sync.option("friction"))||0}),this.markSelectedSlide(S)}onNavCreateSlide(n,r){r.index===this.selectedIndex&&this.markSelectedSlide(r.index)}onTargetChange(){var n,r;const{target:s,nav:c}=this;if(!s||!c||c.state!==rt.Ready||s.state!==rt.Ready)return;const h=(r=(n=s.pages[s.page])===null||n===void 0?void 0:n.slides[0])===null||r===void 0?void 0:r.index,m=c.getPageForSlide(h);this.markSelectedSlide(h),c.slideTo(m,c.prevPage===null&&s.prevPage===null?{friction:0}:void 0)}markSelectedSlide(n){const r=this.nav;r&&r.state===rt.Ready&&(this.selectedIndex=n,[...r.slides].map(s=>{s.el&&s.el.classList[s.index===n?"add":"remove"]("is-nav-selected")}))}attach(){const n=this;let r=n.options.target,s=n.options.nav;r?n.addAsNavFor(r):s&&n.addAsTargetFor(s)}detach(){const n=this,r=n.nav,s=n.target;r&&(r.off("ready",n.onNavReady),r.off("createSlide",n.onNavCreateSlide),r.off("Panzoom.click",n.onNavClick),r.off("Panzoom.touchEnd",n.onNavTouch)),n.nav=null,s&&(s.off("ready",n.onTargetReady),s.off("refresh",n.onTargetChange),s.off("change",n.onTargetChange)),n.target=null}}Object.defineProperty(no,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{friction:.35}});const Fl={Navigation:to,Dots:eo,Sync:no},pi="animationend",ba="isSelected",mi="slide";class fn extends Cr{get axis(){return this.isHorizontal?"e":"f"}get isEnabled(){return this.state===rt.Ready}get isInfinite(){let n=!1;const{contentDim:r,viewportDim:s,pages:c,slides:h}=this,m=h[0];return c.length>=2&&m&&r+m.dim>=s&&(n=this.option("infinite")),n}get isRTL(){return this.option("direction")==="rtl"}get isHorizontal(){return this.option("axis")==="x"}constructor(n,r={},s={}){if(super(),Object.defineProperty(this,"bp",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"lp",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"userOptions",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"userPlugins",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:rt.Init}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"prevPage",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"viewport",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"track",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"slides",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"pages",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"panzoom",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"inTransition",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"contentDim",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"viewportDim",{enumerable:!0,configurable:!0,writable:!0,value:0}),typeof n=="string"&&(n=document.querySelector(n)),!n||!vt(n))throw new Error("No Element found");this.container=n,this.slideNext=ga(this.slideNext.bind(this),150),this.slidePrev=ga(this.slidePrev.bind(this),150),this.userOptions=r,this.userPlugins=s,queueMicrotask(()=>{this.processOptions()})}processOptions(){var n,r;const s=yt({},fn.defaults,this.userOptions);let c="";const h=s.breakpoints;if(h&&gr(h))for(const[m,f]of Object.entries(h))window.matchMedia(m).matches&&gr(f)&&(c+=m,yt(s,f));c===this.bp&&this.state!==rt.Init||(this.bp=c,this.state===rt.Ready&&(s.initialSlide=((r=(n=this.pages[this.page])===null||n===void 0?void 0:n.slides[0])===null||r===void 0?void 0:r.index)||0),this.state!==rt.Init&&this.destroy(),super.setOptions(s),this.option("enabled")===!1?this.attachEvents():setTimeout(()=>{this.init()},0))}init(){this.state=rt.Init,this.emit("init"),this.attachPlugins(Object.assign(Object.assign({},fn.Plugins),this.userPlugins)),this.emit("attachPlugins"),this.initLayout(),this.initSlides(),this.updateMetrics(),this.setInitialPosition(),this.initPanzoom(),this.attachEvents(),this.state=rt.Ready,this.emit("ready")}initLayout(){const{container:n}=this,r=this.option("classes");Ce(n,this.cn("container")),zt(n,r.isLTR,!this.isRTL),zt(n,r.isRTL,this.isRTL),zt(n,r.isVertical,!this.isHorizontal),zt(n,r.isHorizontal,this.isHorizontal);let s=this.option("viewport")||n.querySelector(`.${r.viewport}`);s||(s=document.createElement("div"),Ce(s,r.viewport),s.append(...va(n,`.${r.slide}`)),n.prepend(s)),s.addEventListener("scroll",this.onScroll);let c=this.option("track")||n.querySelector(`.${r.track}`);c||(c=document.createElement("div"),Ce(c,r.track),c.append(...Array.from(s.childNodes))),c.setAttribute("aria-live","polite"),s.contains(c)||s.prepend(c),this.viewport=s,this.track=c,this.emit("initLayout")}initSlides(){const{track:n}=this;if(!n)return;const r=[...this.slides],s=[];[...va(n,`.${this.cn(mi)}`)].forEach(c=>{if(vt(c)){const h=tr({el:c,isDom:!0,index:this.slides.length});s.push(h)}});for(let c of[...this.option("slides",[])||[],...r])s.push(tr(c));this.slides=s;for(let c=0;c<this.slides.length;c++)this.slides[c].index=c;for(const c of s)this.emit("beforeInitSlide",c,c.index),this.emit("initSlide",c,c.index);this.emit("initSlides")}setInitialPage(){const n=this.option("initialSlide");this.page=typeof n=="number"?this.getPageForSlide(n):parseInt(this.option("initialPage",0)+"",10)||0}setInitialPosition(){const{track:n,pages:r,isHorizontal:s}=this;if(!n||!r.length)return;let c=this.page;r[c]||(this.page=c=0);const h=(r[c].pos||0)*(this.isRTL&&s?1:-1),m=s?`${h}px`:"0",f=s?"0":`${h}px`;n.style.transform=`translate3d(${m}, ${f}, 0) scale(1)`,this.option("adaptiveHeight")&&this.setViewportHeight()}initPanzoom(){this.panzoom&&(this.panzoom.destroy(),this.panzoom=null);const n=this.option("Panzoom")||{};this.panzoom=new pn(this.viewport,yt({},{content:this.track,zoom:!1,panOnlyZoomed:!1,lockAxis:this.isHorizontal?"x":"y",infinite:this.isInfinite,click:!1,dblClick:!1,touch:r=>!(this.pages.length<2&&!r.options.infinite),bounds:()=>this.getBounds(),maxVelocity:r=>Math.abs(r.target[this.axis]-r.current[this.axis])<2*this.viewportDim?100:0},n)),this.panzoom.on("*",(r,s,...c)=>{this.emit(`Panzoom.${s}`,r,...c)}),this.panzoom.on("decel",this.onDecel),this.panzoom.on("refresh",this.onRefresh),this.panzoom.on("beforeTransform",this.onBeforeTransform),this.panzoom.on("endAnimation",this.onEndAnimation)}attachEvents(){const n=this.container;n&&(n.addEventListener("click",this.onClick,{passive:!1,capture:!1}),n.addEventListener("slideTo",this.onSlideTo)),window.addEventListener("resize",this.onResize)}createPages(){let n=[];const{contentDim:r,viewportDim:s}=this;let c=this.option("slidesPerPage");c=(c==="auto"||r<=s)&&this.option("fill")!==!1?1/0:parseFloat(c+"");let h=0,m=0,f=0;for(const w of this.slides)(!n.length||m+w.dim-s>.05||f>=c)&&(n.push(Bl()),h=n.length-1,m=0,f=0),n[h].slides.push(w),m+=w.dim+w.gap,f++;return n}processPages(){const n=this.pages,{contentDim:r,viewportDim:s,isInfinite:c}=this,h=this.option("center"),m=this.option("fill"),f=m&&h&&r>s&&!c;if(n.forEach((S,d)=>{var u;S.index=d,S.pos=((u=S.slides[0])===null||u===void 0?void 0:u.pos)||0,S.dim=0;for(const[p,g]of S.slides.entries())S.dim+=g.dim,p<S.slides.length-1&&(S.dim+=g.gap);f&&S.pos+.5*S.dim<.5*s?S.pos=0:f&&S.pos+.5*S.dim>=r-.5*s?S.pos=r-s:h&&(S.pos+=-.5*(s-S.dim))}),n.forEach(S=>{m&&!c&&r>s&&(S.pos=Math.max(S.pos,0),S.pos=Math.min(S.pos,r-s)),S.pos=pe(S.pos,1e3),S.dim=pe(S.dim,1e3),Math.abs(S.pos)<=.1&&(S.pos=0)}),c)return n;const w=[];let T;return n.forEach(S=>{const d=Object.assign({},S);T&&d.pos===T.pos?(T.dim+=d.dim,T.slides=[...T.slides,...d.slides]):(d.index=w.length,T=d,w.push(d))}),w}getPageFromIndex(n=0){const r=this.pages.length;let s;return n=parseInt((n||0).toString())||0,s=this.isInfinite?(n%r+r)%r:Math.max(Math.min(n,r-1),0),s}getSlideMetrics(n){var r,s;const c=this.isHorizontal?"width":"height";let h=0,m=0,f=n.el;const w=!(!f||f.parentNode);if(f?h=parseFloat(f.dataset[c]||"")||0:(f=document.createElement("div"),f.style.visibility="hidden",(this.track||document.body).prepend(f)),Ce(f,this.cn(mi)+" "+n.class+" "+n.customClass),h)f.style[c]=`${h}px`,f.style[c==="width"?"height":"width"]="";else{w&&(this.track||document.body).prepend(f),h=f.getBoundingClientRect()[c]*Math.max(1,((r=window.visualViewport)===null||r===void 0?void 0:r.scale)||1);let S=f[this.isHorizontal?"offsetWidth":"offsetHeight"];S-1>h&&(h=S)}const T=getComputedStyle(f);return T.boxSizing==="content-box"&&(this.isHorizontal?(h+=parseFloat(T.paddingLeft)||0,h+=parseFloat(T.paddingRight)||0):(h+=parseFloat(T.paddingTop)||0,h+=parseFloat(T.paddingBottom)||0)),m=parseFloat(T[this.isHorizontal?"marginRight":"marginBottom"])||0,w?(s=f.parentElement)===null||s===void 0||s.removeChild(f):n.el||f.remove(),{dim:pe(h,1e3),gap:pe(m,1e3)}}getBounds(){const{isInfinite:n,isRTL:r,isHorizontal:s,pages:c}=this;let h={min:0,max:0};if(n)h={min:-1/0,max:1/0};else if(c.length){const m=c[0].pos,f=c[c.length-1].pos;h=r&&s?{min:m,max:f}:{min:-1*f,max:-1*m}}return{x:s?h:{min:0,max:0},y:s?{min:0,max:0}:h}}repositionSlides(){let n,{isHorizontal:r,isRTL:s,isInfinite:c,viewport:h,viewportDim:m,contentDim:f,page:w,pages:T,slides:S,panzoom:d}=this,u=0,p=0,g=0,v=0;d?v=-1*d.current[this.axis]:T[w]&&(v=T[w].pos||0),n=r?s?"right":"left":"top",s&&r&&(v*=-1);for(const _ of S){const x=_.el;x?(n==="top"?(x.style.right="",x.style.left=""):x.style.top="",_.index!==u?x.style[n]=p===0?"":`${pe(p,1e3)}px`:x.style[n]="",g+=_.dim+_.gap,u++):p+=_.dim+_.gap}if(c&&g&&h){let _=getComputedStyle(h),x="padding",y=r?"Right":"Bottom",O=parseFloat(_[x+(r?"Left":"Top")]);v-=O,m+=O,m+=parseFloat(_[x+y]);for(const N of S)N.el&&(pe(N.pos)<pe(m)&&pe(N.pos+N.dim+N.gap)<pe(v)&&pe(v)>pe(f-m)&&(N.el.style[n]=`${pe(p+g,1e3)}px`),pe(N.pos+N.gap)>=pe(f-m)&&pe(N.pos)>pe(v+m)&&pe(v)<pe(m)&&(N.el.style[n]=`-${pe(g,1e3)}px`))}let b,k,M=[...this.inTransition];if(M.length>1&&(b=T[M[0]],k=T[M[1]]),b&&k){let _=0;for(const x of S)x.el?this.inTransition.has(x.index)&&b.slides.indexOf(x)<0&&(x.el.style[n]=`${pe(_+(b.pos-k.pos),1e3)}px`):_+=x.dim+x.gap}}createSlideEl(n){const{track:r,slides:s}=this;if(!r||!n||n.el&&n.el.parentNode)return;const c=n.el||document.createElement("div");Ce(c,this.cn(mi)),Ce(c,n.class),Ce(c,n.customClass);const h=n.html;h&&(h instanceof HTMLElement?c.appendChild(h):c.innerHTML=n.html+"");const m=[];s.forEach((S,d)=>{S.el&&m.push(d)});const f=n.index;let w=null;m.length&&(w=s[m.reduce((S,d)=>Math.abs(d-f)<Math.abs(S-f)?d:S)]);const T=w&&w.el&&w.el.parentNode?w.index<n.index?w.el.nextSibling:w.el:null;r.insertBefore(c,r.contains(T)?T:null),n.el=c,this.emit("createSlide",n)}removeSlideEl(n,r=!1){const s=n==null?void 0:n.el;if(!s||!s.parentNode)return;const c=this.cn(ba);if(s.classList.contains(c)&&(Ve(s,c),this.emit("unselectSlide",n)),n.isDom&&!r)return s.removeAttribute("aria-hidden"),s.removeAttribute("data-index"),void(s.style.left="");this.emit("removeSlide",n);const h=new CustomEvent(pi);s.dispatchEvent(h),n.el&&(n.el.remove(),n.el=null)}transitionTo(n=0,r=this.option("transition")){var s,c,h,m;if(!r)return!1;const f=this.page,{pages:w,panzoom:T}=this;n=parseInt((n||0).toString())||0;const S=this.getPageFromIndex(n);if(!T||!w[S]||w.length<2||Math.abs((((c=(s=w[f])===null||s===void 0?void 0:s.slides[0])===null||c===void 0?void 0:c.dim)||0)-this.viewportDim)>1)return!1;let d=n>f?1:-1;this.isInfinite&&(f===0&&n===w.length-1&&(d=-1),f===w.length-1&&n===0&&(d=1));const u=w[S].pos*(this.isRTL?1:-1);if(f===S&&Math.abs(u-T.target[this.axis])<1)return!1;this.clearTransitions();const p=T.isResting;Ce(this.container,this.cn("inTransition"));const g=((h=w[f])===null||h===void 0?void 0:h.slides[0])||null,v=((m=w[S])===null||m===void 0?void 0:m.slides[0])||null;this.inTransition.add(v.index),this.createSlideEl(v);let b=g.el,k=v.el;p||r===mi||(r="fadeFast",b=null);const M=this.isRTL?"next":"prev",_=this.isRTL?"prev":"next";return b&&(this.inTransition.add(g.index),g.transition=r,b.addEventListener(pi,this.onAnimationEnd),b.classList.add(`f-${r}Out`,`to-${d>0?_:M}`)),k&&(v.transition=r,k.addEventListener(pi,this.onAnimationEnd),k.classList.add(`f-${r}In`,`from-${d>0?M:_}`)),T.current[this.axis]=u,T.target[this.axis]=u,T.requestTick(),this.onChange(S),!0}manageSlideVisiblity(){const n=new Set,r=new Set,s=this.getVisibleSlides(parseFloat(this.option("preload",0)+"")||0);for(const c of this.slides)s.has(c)?n.add(c):r.add(c);for(const c of this.inTransition)n.add(this.slides[c]);for(const c of n)this.createSlideEl(c),this.lazyLoadSlide(c);for(const c of r)n.has(c)||this.removeSlideEl(c);this.markSelectedSlides(),this.repositionSlides()}markSelectedSlides(){if(!this.pages[this.page]||!this.pages[this.page].slides)return;const n="aria-hidden";let r=this.cn(ba);if(r)for(const s of this.slides){const c=s.el;c&&(c.dataset.index=`${s.index}`,c.classList.contains("f-thumbs__slide")?this.getVisibleSlides(0).has(s)?c.removeAttribute(n):c.setAttribute(n,"true"):this.pages[this.page].slides.includes(s)?(c.classList.contains(r)||(Ce(c,r),this.emit("selectSlide",s)),c.removeAttribute(n)):(c.classList.contains(r)&&(Ve(c,r),this.emit("unselectSlide",s)),c.setAttribute(n,"true")))}}flipInfiniteTrack(){const{axis:n,isHorizontal:r,isInfinite:s,isRTL:c,viewportDim:h,contentDim:m}=this,f=this.panzoom;if(!f||!s)return;let w=f.current[n],T=f.target[n]-w,S=0,d=.5*h;c&&r?(w<-d&&(S=-1,w+=m),w>m-d&&(S=1,w-=m)):(w>d&&(S=1,w-=m),w<-m+d&&(S=-1,w+=m)),S&&(f.current[n]=w,f.target[n]=w+T)}lazyLoadImg(n,r){const s=this,c="f-fadeIn",h="is-preloading";let m=!1,f=null;const w=()=>{m||(m=!0,f&&(f.remove(),f=null),Ve(r,h),r.complete&&(Ce(r,c),setTimeout(()=>{Ve(r,c)},350)),this.option("adaptiveHeight")&&n.el&&this.pages[this.page].slides.indexOf(n)>-1&&(s.updateMetrics(),s.setViewportHeight()),this.emit("load",n))};Ce(r,h),r.src=r.dataset.lazySrcset||r.dataset.lazySrc||"",delete r.dataset.lazySrc,delete r.dataset.lazySrcset,r.addEventListener("error",()=>{w()}),r.addEventListener("load",()=>{w()}),setTimeout(()=>{const T=r.parentNode;T&&n.el&&(r.complete?w():m||(f=Bt(Tr),T.insertBefore(f,r)))},300)}lazyLoadSlide(n){const r=n&&n.el;if(!r)return;const s=new Set;let c=Array.from(r.querySelectorAll("[data-lazy-src],[data-lazy-srcset]"));r.dataset.lazySrc&&c.push(r),c.map(h=>{h instanceof HTMLImageElement?s.add(h):h instanceof HTMLElement&&h.dataset.lazySrc&&(h.style.backgroundImage=`url('${h.dataset.lazySrc}')`,delete h.dataset.lazySrc)});for(const h of s)this.lazyLoadImg(n,h)}onAnimationEnd(n){var r;const s=n.target,c=s?parseInt(s.dataset.index||"",10)||0:-1,h=this.slides[c],m=n.animationName;if(!s||!h||!m)return;const f=!!this.inTransition.has(c)&&h.transition;f&&m.substring(0,f.length+2)===`f-${f}`&&this.inTransition.delete(c),this.inTransition.size||this.clearTransitions(),c===this.page&&(!((r=this.panzoom)===null||r===void 0)&&r.isResting)&&this.emit("settle")}onDecel(n,r=0,s=0,c=0,h=0){if(this.option("dragFree"))return void this.setPageFromPosition();const{isRTL:m,isHorizontal:f,axis:w,pages:T}=this,S=T.length,d=Math.abs(Math.atan2(s,r)/(Math.PI/180));let u=0;if(u=d>45&&d<135?f?0:s:f?r:0,!S)return;let p=this.page,g=m&&f?1:-1;const v=n.current[w]*g;let{pageIndex:b}=this.getPageFromPosition(v);Math.abs(u)>5?(T[p].dim<document.documentElement["client"+(this.isHorizontal?"Width":"Height")]-1&&(p=b),p=m&&f?u<0?p-1:p+1:u<0?p+1:p-1):p=c===0&&h===0?p:b,this.slideTo(p,{transition:!1,friction:n.option("decelFriction")})}onClick(n){const r=n.target,s=r&&vt(r)?r.dataset:null;let c,h;s&&(s.carouselPage!==void 0?(h="slideTo",c=s.carouselPage):s.carouselNext!==void 0?h="slideNext":s.carouselPrev!==void 0&&(h="slidePrev")),h?(n.preventDefault(),n.stopPropagation(),r&&!r.hasAttribute("disabled")&&this[h](c)):this.emit("click",n)}onSlideTo(n){const r=n.detail||0;this.slideTo(this.getPageForSlide(r),{friction:0})}onChange(n,r=0){const s=this.page;this.prevPage=s,this.page=n,this.option("adaptiveHeight")&&this.setViewportHeight(),n!==s&&(this.markSelectedSlides(),this.emit("change",n,s,r))}onRefresh(){let n=this.contentDim,r=this.viewportDim;this.updateMetrics(),this.contentDim===n&&this.viewportDim===r||this.slideTo(this.page,{friction:0,transition:!1})}onScroll(){var n;(n=this.viewport)===null||n===void 0||n.scroll(0,0)}onResize(){this.option("breakpoints")&&this.processOptions()}onBeforeTransform(n){this.lp!==n.current[this.axis]&&(this.flipInfiniteTrack(),this.manageSlideVisiblity()),this.lp=n.current.e}onEndAnimation(){this.inTransition.size||this.emit("settle")}reInit(n=null,r=null){this.destroy(),this.state=rt.Init,this.prevPage=null,this.userOptions=n||this.userOptions,this.userPlugins=r||this.userPlugins,this.processOptions()}slideTo(n=0,{friction:r=this.option("friction"),transition:s=this.option("transition")}={}){if(this.state===rt.Destroy)return;n=parseInt((n||0).toString())||0;const c=this.getPageFromIndex(n),{axis:h,isHorizontal:m,isRTL:f,pages:w,panzoom:T}=this,S=w.length,d=f&&m?1:-1;if(!T||!S)return;if(this.page!==c){const p=new Event("beforeChange",{bubbles:!0,cancelable:!0});if(this.emit("beforeChange",p,n),p.defaultPrevented)return}if(this.transitionTo(n,s))return;let u=w[c].pos;if(this.isInfinite){const p=this.contentDim,g=T.target[h]*d;S===2?u+=p*Math.floor(parseFloat(n+"")/2):u=[u,u-p,u+p].reduce(function(v,b){return Math.abs(b-g)<Math.abs(v-g)?b:v})}u*=d,Math.abs(T.target[h]-u)<1||(T.panTo({x:m?u:0,y:m?0:u,friction:r}),this.onChange(c))}slideToClosest(n){if(this.panzoom){const{pageIndex:r}=this.getPageFromPosition();this.slideTo(r,n)}}slideNext(){this.slideTo(this.page+1)}slidePrev(){this.slideTo(this.page-1)}clearTransitions(){this.inTransition.clear(),Ve(this.container,this.cn("inTransition"));const n=["to-prev","to-next","from-prev","from-next"];for(const r of this.slides){const s=r.el;if(s){s.removeEventListener(pi,this.onAnimationEnd),s.classList.remove(...n);const c=r.transition;c&&s.classList.remove(`f-${c}Out`,`f-${c}In`)}}this.manageSlideVisiblity()}addSlide(n,r){var s,c,h,m;const f=this.panzoom,w=((s=this.pages[this.page])===null||s===void 0?void 0:s.pos)||0,T=((c=this.pages[this.page])===null||c===void 0?void 0:c.dim)||0,S=this.contentDim<this.viewportDim;let d=Array.isArray(r)?r:[r];const u=[];for(const p of d)u.push(tr(p));this.slides.splice(n,0,...u);for(let p=0;p<this.slides.length;p++)this.slides[p].index=p;for(const p of u)this.emit("beforeInitSlide",p,p.index);if(this.page>=n&&(this.page+=u.length),this.updateMetrics(),f){const p=((h=this.pages[this.page])===null||h===void 0?void 0:h.pos)||0,g=((m=this.pages[this.page])===null||m===void 0?void 0:m.dim)||0,v=this.pages.length||1,b=this.isRTL?T-g:g-T,k=this.isRTL?w-p:p-w;S&&v===1?(n<=this.page&&(f.current[this.axis]-=b,f.target[this.axis]-=b),f.panTo({[this.isHorizontal?"x":"y"]:-1*p})):k&&n<=this.page&&(f.target[this.axis]-=k,f.current[this.axis]-=k,f.requestTick())}for(const p of u)this.emit("initSlide",p,p.index)}prependSlide(n){this.addSlide(0,n)}appendSlide(n){this.addSlide(this.slides.length,n)}removeSlide(n){const r=this.slides.length;n=(n%r+r)%r;const s=this.slides[n];if(s){this.removeSlideEl(s,!0),this.slides.splice(n,1);for(let c=0;c<this.slides.length;c++)this.slides[c].index=c;this.updateMetrics(),this.slideTo(this.page,{friction:0,transition:!1}),this.emit("destroySlide",s)}}updateMetrics(){const{panzoom:n,viewport:r,track:s,slides:c,isHorizontal:h,isInfinite:m}=this;if(!s)return;const f=h?"width":"height",w=h?"offsetWidth":"offsetHeight";if(r){let d=Math.max(r[w],pe(r.getBoundingClientRect()[f],1e3)),u=getComputedStyle(r),p="padding",g=h?"Right":"Bottom";d-=parseFloat(u[p+(h?"Left":"Top")])+parseFloat(u[p+g]),this.viewportDim=d}let T,S=0;for(const[d,u]of c.entries()){let p=0,g=0;!u.el&&T?(p=T.dim,g=T.gap):({dim:p,gap:g}=this.getSlideMetrics(u),T=u),p=pe(p,1e3),g=pe(g,1e3),u.dim=p,u.gap=g,u.pos=S,S+=p,(m||d<c.length-1)&&(S+=g)}S=pe(S,1e3),this.contentDim=S,n&&(n.contentRect[f]=S,n.contentRect[h?"fullWidth":"fullHeight"]=S),this.pages=this.createPages(),this.pages=this.processPages(),this.state===rt.Init&&this.setInitialPage(),this.page=Math.max(0,Math.min(this.page,this.pages.length-1)),this.manageSlideVisiblity(),this.emit("refresh")}getProgress(n,r=!1,s=!1){n===void 0&&(n=this.page);const c=this,h=c.panzoom,m=c.contentDim,f=c.pages[n]||0;if(!f||!h)return n>this.page?-1:1;let w=-1*h.current.e,T=pe((w-f.pos)/(1*f.dim),1e3),S=T,d=T;this.isInfinite&&s!==!0&&(S=pe((w-f.pos+m)/(1*f.dim),1e3),d=pe((w-f.pos-m)/(1*f.dim),1e3));let u=[T,S,d].reduce(function(p,g){return Math.abs(g)<Math.abs(p)?g:p});return r?u:u>1?1:u<-1?-1:u}setViewportHeight(){const{page:n,pages:r,viewport:s,isHorizontal:c}=this;if(!s||!r[n])return;let h=0;c&&this.track&&(this.track.style.height="auto",r[n].slides.forEach(m=>{m.el&&(h=Math.max(h,m.el.offsetHeight))})),s.style.height=h?`${h}px`:""}getPageForSlide(n){for(const r of this.pages)for(const s of r.slides)if(s.index===n)return r.index;return-1}getVisibleSlides(n=0){var r;const s=new Set;let{panzoom:c,contentDim:h,viewportDim:m,pages:f,page:w}=this;if(m){h=h+((r=this.slides[this.slides.length-1])===null||r===void 0?void 0:r.gap)||0;let T=0;T=c&&c.state!==qe.Init&&c.state!==qe.Destroy?-1*c.current[this.axis]:f[w]&&f[w].pos||0,this.isInfinite&&(T-=Math.floor(T/h)*h),this.isRTL&&this.isHorizontal&&(T*=-1);const S=T-m*n,d=T+m*(n+1),u=this.isInfinite?[-1,0,1]:[0];for(const p of this.slides)for(const g of u){const v=p.pos+g*h,b=v+p.dim+p.gap;v<d&&b>S&&s.add(p)}}return s}getPageFromPosition(n){const{viewportDim:r,contentDim:s,slides:c,pages:h,panzoom:m}=this,f=h.length,w=c.length,T=c[0],S=c[w-1],d=this.option("center");let u=0,p=0,g=0,v=n===void 0?-1*((m==null?void 0:m.target[this.axis])||0):n;d&&(v+=.5*r),this.isInfinite?(v<T.pos-.5*S.gap&&(v-=s,g=-1),v>S.pos+S.dim+.5*S.gap&&(v-=s,g=1)):v=Math.max(T.pos||0,Math.min(v,S.pos));let b=S,k=c.find(M=>{const _=M.pos-.5*b.gap,x=M.pos+M.dim+.5*M.gap;return b=M,v>=_&&v<x});return k||(k=S),p=this.getPageForSlide(k.index),u=p+g*f,{page:u,pageIndex:p}}setPageFromPosition(){const{pageIndex:n}=this.getPageFromPosition();this.onChange(n)}destroy(){if([rt.Destroy].includes(this.state))return;this.state=rt.Destroy;const{container:n,viewport:r,track:s,slides:c,panzoom:h}=this,m=this.option("classes");n.removeEventListener("click",this.onClick,{passive:!1,capture:!1}),n.removeEventListener("slideTo",this.onSlideTo),window.removeEventListener("resize",this.onResize),h&&(h.destroy(),this.panzoom=null),c&&c.forEach(w=>{this.removeSlideEl(w)}),this.detachPlugins(),r&&(r.removeEventListener("scroll",this.onScroll),r.offsetParent&&s&&s.offsetParent&&r.replaceWith(...s.childNodes));for(const[w,T]of Object.entries(m))w!=="container"&&T&&n.classList.remove(T);this.track=null,this.viewport=null,this.page=0,this.slides=[];const f=this.events.get("ready");this.events=new Map,f&&this.events.set("ready",f)}}Object.defineProperty(fn,"Panzoom",{enumerable:!0,configurable:!0,writable:!0,value:pn}),Object.defineProperty(fn,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:jl}),Object.defineProperty(fn,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:Fl});const io=function(C){if(!vt(C))return 0;const n=window.scrollY,r=window.innerHeight,s=n+r,c=C.getBoundingClientRect(),h=c.y+n,m=c.height,f=h+m;if(n>f||s<h)return 0;if(n<h&&s>f||h<n&&f>s)return 100;let w=m;h<n&&(w-=n-h),f>s&&(w-=f-s);const T=w/r*100;return Math.round(T)},Wn=!(typeof window>"u"||!window.document||!window.document.createElement);let nr;const ir=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden]):not(.fancybox-focus-guard)","iframe","object","embed","video","audio","[contenteditable]",'[tabindex]:not([tabindex^="-"]):not([disabled]):not([aria-hidden])'].join(","),wa=C=>{if(C&&Wn){nr===void 0&&document.createElement("div").focus({get preventScroll(){return nr=!0,!1}});try{if(nr)C.focus({preventScroll:!0});else{const n=window.scrollY||document.body.scrollTop,r=window.scrollX||document.body.scrollLeft;C.focus(),document.body.scrollTo({top:n,left:r,behavior:"auto"})}}catch{}}},ro=()=>{const C=document;let n,r="",s="",c="";return C.fullscreenEnabled?(r="requestFullscreen",s="exitFullscreen",c="fullscreenElement"):C.webkitFullscreenEnabled&&(r="webkitRequestFullscreen",s="webkitExitFullscreen",c="webkitFullscreenElement"),r&&(n={request:function(h=C.documentElement){return r==="webkitRequestFullscreen"?h[r](Element.ALLOW_KEYBOARD_INPUT):h[r]()},exit:function(){return C[c]&&C[s]()},isFullscreen:function(){return C[c]}}),n},vr={animated:!0,autoFocus:!0,backdropClick:"close",Carousel:{classes:{container:"fancybox__carousel",viewport:"fancybox__viewport",track:"fancybox__track",slide:"fancybox__slide"}},closeButton:"auto",closeExisting:!1,commonCaption:!1,compact:()=>window.matchMedia("(max-width: 578px), (max-height: 578px)").matches,contentClick:"toggleZoom",contentDblClick:!1,defaultType:"image",defaultDisplay:"flex",dragToClose:!0,Fullscreen:{autoStart:!1},groupAll:!1,groupAttr:"data-fancybox",hideClass:"f-fadeOut",hideScrollbar:!0,idle:3500,keyboard:{Escape:"close",Delete:"close",Backspace:"close",PageUp:"next",PageDown:"prev",ArrowUp:"prev",ArrowDown:"next",ArrowRight:"next",ArrowLeft:"prev"},l10n:Object.assign(Object.assign({},Qa),{CLOSE:"Close",NEXT:"Next",PREV:"Previous",MODAL:"You can close this modal content with the ESC key",ERROR:"Something Went Wrong, Please Try Again Later",IMAGE_ERROR:"Image Not Found",ELEMENT_NOT_FOUND:"HTML Element Not Found",AJAX_NOT_FOUND:"Error Loading AJAX : Not Found",AJAX_FORBIDDEN:"Error Loading AJAX : Forbidden",IFRAME_ERROR:"Error Loading Page",TOGGLE_ZOOM:"Toggle zoom level",TOGGLE_THUMBS:"Toggle thumbnails",TOGGLE_SLIDESHOW:"Toggle slideshow",TOGGLE_FULLSCREEN:"Toggle full-screen mode",DOWNLOAD:"Download"}),parentEl:null,placeFocusBack:!0,showClass:"f-zoomInUp",startIndex:0,tpl:{closeButton:'<button data-fancybox-close class="f-button is-close-btn" title="{{CLOSE}}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M20 20L4 4m16 0L4 20"/></svg></button>',main:`<div class="fancybox__container" role="dialog" aria-modal="true" aria-label="{{MODAL}}" tabindex="-1">
    <div class="fancybox__backdrop"></div>
    <div class="fancybox__carousel"></div>
    <div class="fancybox__footer"></div>
  </div>`},trapFocus:!0,wheel:"zoom"};var lt,ht;(function(C){C[C.Init=0]="Init",C[C.Ready=1]="Ready",C[C.Closing=2]="Closing",C[C.CustomClosing=3]="CustomClosing",C[C.Destroy=4]="Destroy"})(lt||(lt={})),function(C){C[C.Loading=0]="Loading",C[C.Opening=1]="Opening",C[C.Ready=2]="Ready",C[C.Closing=3]="Closing"}(ht||(ht={}));let Ea="",qn=!1,gi=!1,cn=null;const ao=()=>{let C="",n="";const r=Fe.getInstance();if(r){const s=r.carousel,c=r.getSlide();if(s&&c){let h=c.slug||void 0,m=c.triggerEl||void 0;n=h||r.option("slug")||"",!n&&m&&m.dataset&&(n=m.dataset.fancybox||""),n&&n!=="true"&&(C="#"+n+(!h&&s.slides.length>1?"-"+(c.index+1):""))}}return{hash:C,slug:n,index:1}},Ai=()=>{const C=new URL(document.URL).hash,n=C.slice(1).split("-"),r=n[n.length-1],s=r&&/^\+?\d+$/.test(r)&&parseInt(n.pop()||"1",10)||1;return{hash:C,slug:n.join("-"),index:s}},oo=()=>{const{slug:C,index:n}=Ai();if(!C)return;let r=document.querySelector(`[data-slug="${C}"]`);if(r&&r.dispatchEvent(new CustomEvent("click",{bubbles:!0,cancelable:!0})),Fe.getInstance())return;const s=document.querySelectorAll(`[data-fancybox="${C}"]`);s.length&&(r=s[n-1],r&&r.dispatchEvent(new CustomEvent("click",{bubbles:!0,cancelable:!0})))},so=()=>{if(Fe.defaults.Hash===!1)return;const C=Fe.getInstance();if((C==null?void 0:C.options.Hash)===!1)return;const{slug:n,index:r}=Ai(),{slug:s}=ao();C&&(n===s?C.jumpTo(r-1):(qn=!0,C.close())),oo()},lo=()=>{cn&&clearTimeout(cn),queueMicrotask(()=>{so()})},Sa=()=>{window.addEventListener("hashchange",lo,!1),setTimeout(()=>{so()},500)};Wn&&(/complete|interactive|loaded/.test(document.readyState)?Sa():document.addEventListener("DOMContentLoaded",Sa));const vi="is-zooming-in";class co extends Pt{onCreateSlide(n,r,s){const c=this.instance.optionFor(s,"src")||"";s.el&&s.type==="image"&&typeof c=="string"&&this.setImage(s,c)}onRemoveSlide(n,r,s){s.panzoom&&s.panzoom.destroy(),s.panzoom=void 0,s.imageEl=void 0}onChange(n,r,s,c){Ve(this.instance.container,vi);for(const h of r.slides){const m=h.panzoom;m&&h.index!==s&&m.reset(.35)}}onClose(){var n;const r=this.instance,s=r.container,c=r.getSlide();if(!s||!s.parentElement||!c)return;const{el:h,contentEl:m,panzoom:f,thumbElSrc:w}=c;if(!h||!w||!m||!f||f.isContentLoading||f.state===qe.Init||f.state===qe.Destroy)return;f.updateMetrics();let T=this.getZoomInfo(c);if(!T)return;this.instance.state=lt.CustomClosing,s.classList.remove(vi),s.classList.add("is-zooming-out"),m.style.backgroundImage=`url('${w}')`;const S=s.getBoundingClientRect();(((n=window.visualViewport)===null||n===void 0?void 0:n.scale)||1)===1&&Object.assign(s.style,{position:"absolute",top:`${s.offsetTop+window.scrollY}px`,left:`${s.offsetLeft+window.scrollX}px`,bottom:"auto",right:"auto",width:`${S.width}px`,height:`${S.height}px`,overflow:"hidden"});const{x:d,y:u,scale:p,opacity:g}=T;if(g){const v=((b,k,M,_)=>{const x=k-b,y=_-M;return O=>M+((O-b)/x*y||0)})(f.scale,p,1,0);f.on("afterTransform",()=>{m.style.opacity=v(f.scale)+""})}f.on("endAnimation",()=>{r.destroy()}),f.target.a=p,f.target.b=0,f.target.c=0,f.target.d=p,f.panTo({x:d,y:u,scale:p,friction:g?.2:.33,ignoreBounds:!0}),f.isResting&&r.destroy()}setImage(n,r){const s=this.instance;n.src=r,this.process(n,r).then(c=>{const{contentEl:h,imageEl:m,thumbElSrc:f,el:w}=n;if(s.isClosing()||!h||!m)return;h.offsetHeight;const T=!!s.isOpeningSlide(n)&&this.getZoomInfo(n);if(this.option("protected")&&w){w.addEventListener("contextmenu",u=>{u.preventDefault()});const d=document.createElement("div");Ce(d,"fancybox-protected"),h.appendChild(d)}if(f&&T){const d=c.contentRect,u=Math.max(d.fullWidth,d.fullHeight);let p=null;!T.opacity&&u>1200&&(p=document.createElement("img"),Ce(p,"fancybox-ghost"),p.src=f,h.appendChild(p));const g=()=>{p&&(Ce(p,"f-fadeFastOut"),setTimeout(()=>{p&&(p.remove(),p=null)},200))};(S=f,new Promise((v,b)=>{const k=new Image;k.onload=v,k.onerror=b,k.src=S})).then(()=>{s.hideLoading(n),n.state=ht.Opening,this.instance.emit("reveal",n),this.zoomIn(n).then(()=>{g(),this.instance.done(n)},()=>{}),p&&setTimeout(()=>{g()},u>2500?800:200)},()=>{s.hideLoading(n),s.revealContent(n)})}else{const d=this.optionFor(n,"initialSize"),u=this.optionFor(n,"zoom"),p={event:s.prevMouseMoveEvent||s.options.event,friction:u?.12:0};let g=s.optionFor(n,"showClass")||void 0,v=!0;s.isOpeningSlide(n)&&(d==="full"?c.zoomToFull(p):d==="cover"?c.zoomToCover(p):d==="max"?c.zoomToMax(p):v=!1,c.stop("current")),v&&g&&(g=c.isDragging?"f-fadeIn":""),s.hideLoading(n),s.revealContent(n,g)}var S},()=>{s.setError(n,"{{IMAGE_ERROR}}")})}process(n,r){return new Promise((s,c)=>{var h;const m=this.instance,f=n.el;m.clearContent(n),m.showLoading(n);let w=this.optionFor(n,"content");if(typeof w=="string"&&(w=Bt(w)),!w||!vt(w)){if(w=document.createElement("img"),w instanceof HTMLImageElement){let T="",S=n.caption;T=typeof S=="string"&&S?S.replace(/<[^>]+>/gi,"").substring(0,1e3):`Image ${n.index+1} of ${((h=m.carousel)===null||h===void 0?void 0:h.pages.length)||1}`,w.src=r||"",w.alt=T,w.draggable=!1,n.srcset&&w.setAttribute("srcset",n.srcset),this.instance.isOpeningSlide(n)&&(w.fetchPriority="high")}n.sizes&&w.setAttribute("sizes",n.sizes)}Ce(w,"fancybox-image"),n.imageEl=w,m.setContent(n,w,!1),n.panzoom=new pn(f,yt({transformParent:!0},this.option("Panzoom")||{},{content:w,width:(T,S)=>m.optionFor(n,"width","auto",S)||"auto",height:(T,S)=>m.optionFor(n,"height","auto",S)||"auto",wheel:()=>{const T=m.option("wheel");return(T==="zoom"||T=="pan")&&T},click:(T,S)=>{var d,u;if(m.isCompact||m.isClosing()||n.index!==((d=m.getSlide())===null||d===void 0?void 0:d.index))return!1;if(S){const g=S.composedPath()[0];if(["A","BUTTON","TEXTAREA","OPTION","INPUT","SELECT","VIDEO"].includes(g.nodeName))return!1}let p=!S||S.target&&((u=n.contentEl)===null||u===void 0?void 0:u.contains(S.target));return m.option(p?"contentClick":"backdropClick")||!1},dblClick:()=>m.isCompact?"toggleZoom":m.option("contentDblClick")||!1,spinner:!1,panOnlyZoomed:!0,wheelLimit:1/0,on:{ready:T=>{s(T)},error:()=>{c()},destroy:()=>{c()}}}))})}zoomIn(n){return new Promise((r,s)=>{const c=this.instance,h=c.container,{panzoom:m,contentEl:f,el:w}=n;m&&m.updateMetrics();const T=this.getZoomInfo(n);if(!(T&&w&&f&&m&&h))return void s();const{x:S,y:d,scale:u,opacity:p}=T,g=()=>{n.state!==ht.Closing&&(p&&(f.style.opacity=Math.max(Math.min(1,1-(1-m.scale)/(1-u)),0)+""),m.scale>=1&&m.scale>m.targetScale-.1&&r(m))},v=M=>{(M.scale<.99||M.scale>1.01)&&!M.isDragging||(Ve(h,vi),f.style.opacity="",M.off("endAnimation",v),M.off("touchStart",v),M.off("afterTransform",g),r(M))};m.on("endAnimation",v),m.on("touchStart",v),m.on("afterTransform",g),m.on(["error","destroy"],()=>{s()}),m.panTo({x:S,y:d,scale:u,friction:0,ignoreBounds:!0}),m.stop("current");const b={event:m.panMode==="mousemove"?c.prevMouseMoveEvent||c.options.event:void 0},k=this.optionFor(n,"initialSize");Ce(h,vi),c.hideLoading(n),k==="full"?m.zoomToFull(b):k==="cover"?m.zoomToCover(b):k==="max"?m.zoomToMax(b):m.reset(.172)})}getZoomInfo(n){const{el:r,imageEl:s,thumbEl:c,panzoom:h}=n,m=this.instance,f=m.container;if(!r||!s||!c||!h||io(c)<3||!this.optionFor(n,"zoom")||!f||m.state===lt.Destroy||getComputedStyle(f).getPropertyValue("--f-images-zoom")==="0")return!1;const w=window.visualViewport||null;if((w?w.scale:1)!==1)return!1;let{top:T,left:S,width:d,height:u}=c.getBoundingClientRect(),{top:p,left:g,fitWidth:v,fitHeight:b}=h.contentRect;if(!(d&&u&&v&&b))return!1;const k=h.container.getBoundingClientRect();g+=k.left,p+=k.top;const M=-1*(g+.5*v-(S+.5*d)),_=-1*(p+.5*b-(T+.5*u)),x=d/v;let y=this.option("zoomOpacity")||!1;return y==="auto"&&(y=Math.abs(d/u-v/b)>.1),{x:M,y:_,scale:x,opacity:y}}attach(){const n=this,r=n.instance;r.on("Carousel.change",n.onChange),r.on("Carousel.createSlide",n.onCreateSlide),r.on("Carousel.removeSlide",n.onRemoveSlide),r.on("close",n.onClose)}detach(){const n=this,r=n.instance;r.off("Carousel.change",n.onChange),r.off("Carousel.createSlide",n.onCreateSlide),r.off("Carousel.removeSlide",n.onRemoveSlide),r.off("close",n.onClose)}}Object.defineProperty(co,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{initialSize:"fit",Panzoom:{maxScale:1},protected:!1,zoom:!0,zoomOpacity:"auto"}}),typeof SuppressedError=="function"&&SuppressedError;const rr="html",Ca="image",ar="map",Wt="youtube",an="vimeo",$n="html5video",Ta=(C,n={})=>{const r=new URL(C),s=new URLSearchParams(r.search),c=new URLSearchParams;for(const[f,w]of[...s,...Object.entries(n)]){let T=w+"";if(f==="t"){let S=T.match(/((\d*)m)?(\d*)s?/);S&&c.set("start",60*parseInt(S[2]||"0")+parseInt(S[3]||"0")+"")}else c.set(f,T)}let h=c+"",m=C.match(/#t=((.*)?\d+s)/);return m&&(h+=`#t=${m[1]}`),h},$l={ajax:null,autoSize:!0,iframeAttr:{allow:"autoplay; fullscreen",scrolling:"auto"},preload:!0,videoAutoplay:!0,videoRatio:16/9,videoTpl:`<video class="fancybox__html5video" playsinline controls controlsList="nodownload" poster="{{poster}}">
  <source src="{{src}}" type="{{format}}" />Sorry, your browser doesn't support embedded videos.</video>`,videoFormat:"",vimeo:{byline:1,color:"00adef",controls:1,dnt:1,muted:0},youtube:{controls:1,enablejsapi:1,nocookie:1,rel:0,fs:1}},Ul=["image","html","ajax","inline","clone","iframe","map","pdf","html5video","youtube","vimeo"];class uo extends Pt{onBeforeInitSlide(n,r,s){this.processType(s)}onCreateSlide(n,r,s){this.setContent(s)}onClearContent(n,r){r.xhr&&(r.xhr.abort(),r.xhr=null);const s=r.iframeEl;s&&(s.onload=s.onerror=null,s.src="//about:blank",r.iframeEl=null);const c=r.contentEl,h=r.placeholderEl;if(r.type==="inline"&&c&&h)c.classList.remove("fancybox__content"),getComputedStyle(c).getPropertyValue("display")!=="none"&&(c.style.display="none"),setTimeout(()=>{h&&(c&&h.parentNode&&h.parentNode.insertBefore(c,h),h.remove())},0),r.contentEl=void 0,r.placeholderEl=void 0;else for(;r.el&&r.el.firstChild;)r.el.removeChild(r.el.firstChild)}onSelectSlide(n,r,s){s.state===ht.Ready&&this.playVideo()}onUnselectSlide(n,r,s){var c,h;if(s.type===$n){try{(h=(c=s.el)===null||c===void 0?void 0:c.querySelector("video"))===null||h===void 0||h.pause()}catch{}return}let m;s.type===an?m={method:"pause",value:"true"}:s.type===Wt&&(m={event:"command",func:"pauseVideo"}),m&&s.iframeEl&&s.iframeEl.contentWindow&&s.iframeEl.contentWindow.postMessage(JSON.stringify(m),"*"),s.poller&&clearTimeout(s.poller)}onDone(n,r){n.isCurrentSlide(r)&&!n.isClosing()&&this.playVideo()}onRefresh(n,r){r.slides.forEach(s=>{s.el&&(this.resizeIframe(s),this.setAspectRatio(s))})}onMessage(n){try{let r=JSON.parse(n.data);if(n.origin==="https://player.vimeo.com"){if(r.event==="ready")for(let s of Array.from(document.getElementsByClassName("fancybox__iframe")))s instanceof HTMLIFrameElement&&s.contentWindow===n.source&&(s.dataset.ready="true")}else if(n.origin.match(/^https:\/\/(www.)?youtube(-nocookie)?.com$/)&&r.event==="onReady"){const s=document.getElementById(r.id);s&&(s.dataset.ready="true")}}catch{}}loadAjaxContent(n){const r=this.instance.optionFor(n,"src")||"";this.instance.showLoading(n);const s=this.instance,c=new XMLHttpRequest;s.showLoading(n),c.onreadystatechange=function(){c.readyState===XMLHttpRequest.DONE&&s.state===lt.Ready&&(s.hideLoading(n),c.status===200?s.setContent(n,c.responseText):s.setError(n,c.status===404?"{{AJAX_NOT_FOUND}}":"{{AJAX_FORBIDDEN}}"))};const h=n.ajax||null;c.open(h?"POST":"GET",r+""),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.send(h),n.xhr=c}setInlineContent(n){let r=null;if(vt(n.src))r=n.src;else if(typeof n.src=="string"){const s=n.src.split("#",2).pop();r=s?document.getElementById(s):null}if(r){if(n.type==="clone"||r.closest(".fancybox__slide")){r=r.cloneNode(!0);const s=r.dataset.animationName;s&&(r.classList.remove(s),delete r.dataset.animationName);let c=r.getAttribute("id");c=c?`${c}--clone`:`clone-${this.instance.id}-${n.index}`,r.setAttribute("id",c)}else if(r.parentNode){const s=document.createElement("div");s.classList.add("fancybox-placeholder"),r.parentNode.insertBefore(s,r),n.placeholderEl=s}this.instance.setContent(n,r)}else this.instance.setError(n,"{{ELEMENT_NOT_FOUND}}")}setIframeContent(n){const{src:r,el:s}=n;if(!r||typeof r!="string"||!s)return;s.classList.add("is-loading");const c=this.instance,h=document.createElement("iframe");h.className="fancybox__iframe",h.setAttribute("id",`fancybox__iframe_${c.id}_${n.index}`);for(const[f,w]of Object.entries(this.optionFor(n,"iframeAttr")||{}))h.setAttribute(f,w);h.onerror=()=>{c.setError(n,"{{IFRAME_ERROR}}")},n.iframeEl=h;const m=this.optionFor(n,"preload");if(n.type!=="iframe"||m===!1)return h.setAttribute("src",n.src+""),c.setContent(n,h,!1),this.resizeIframe(n),void c.revealContent(n);c.showLoading(n),h.onload=()=>{if(!h.src.length)return;const f=h.dataset.ready!=="true";h.dataset.ready="true",this.resizeIframe(n),f?c.revealContent(n):c.hideLoading(n)},h.setAttribute("src",r),c.setContent(n,h,!1)}resizeIframe(n){const{type:r,iframeEl:s}=n;if(r===Wt||r===an)return;const c=s==null?void 0:s.parentElement;if(!s||!c)return;let h=n.autoSize;h===void 0&&(h=this.optionFor(n,"autoSize"));let m=n.width||0,f=n.height||0;m&&f&&(h=!1);const w=c&&c.style;if(n.preload!==!1&&h!==!1&&w)try{const T=window.getComputedStyle(c),S=parseFloat(T.paddingLeft)+parseFloat(T.paddingRight),d=parseFloat(T.paddingTop)+parseFloat(T.paddingBottom),u=s.contentWindow;if(u){const p=u.document,g=p.getElementsByTagName(rr)[0],v=p.body;w.width="",v.style.overflow="hidden",m=m||g.scrollWidth+S,w.width=`${m}px`,v.style.overflow="",w.flex="0 0 auto",w.height=`${v.scrollHeight}px`,f=g.scrollHeight+d}}catch{}if(m||f){const T={flex:"0 1 auto",width:"",height:""};m&&m!=="auto"&&(T.width=`${m}px`),f&&f!=="auto"&&(T.height=`${f}px`),Object.assign(w,T)}}playVideo(){const n=this.instance.getSlide();if(!n)return;const{el:r}=n;if(!r||!r.offsetParent||!this.optionFor(n,"videoAutoplay"))return;if(n.type===$n)try{const c=r.querySelector("video");if(c){const h=c.play();h!==void 0&&h.then(()=>{}).catch(m=>{c.muted=!0,c.play()})}}catch{}if(n.type!==Wt&&n.type!==an)return;const s=()=>{if(n.iframeEl&&n.iframeEl.contentWindow){let c;if(n.iframeEl.dataset.ready==="true")return c=n.type===Wt?{event:"command",func:"playVideo"}:{method:"play",value:"true"},c&&n.iframeEl.contentWindow.postMessage(JSON.stringify(c),"*"),void(n.poller=void 0);n.type===Wt&&(c={event:"listening",id:n.iframeEl.getAttribute("id")},n.iframeEl.contentWindow.postMessage(JSON.stringify(c),"*"))}n.poller=setTimeout(s,250)};s()}processType(n){if(n.html)return n.type=rr,n.src=n.html,void(n.html="");const r=this.instance.optionFor(n,"src","");if(!r||typeof r!="string")return;let s=n.type,c=null;if(c=r.match(/(youtube\.com|youtu\.be|youtube\-nocookie\.com)\/(?:watch\?(?:.*&)?v=|v\/|u\/|shorts\/|embed\/?)?(videoseries\?list=(?:.*)|[\w-]{11}|\?listType=(?:.*)&list=(?:.*))(?:.*)/i)){const h=this.optionFor(n,Wt),{nocookie:m}=h,f=function(d,u){var p={};for(var g in d)Object.prototype.hasOwnProperty.call(d,g)&&u.indexOf(g)<0&&(p[g]=d[g]);if(d!=null&&typeof Object.getOwnPropertySymbols=="function"){var v=0;for(g=Object.getOwnPropertySymbols(d);v<g.length;v++)u.indexOf(g[v])<0&&Object.prototype.propertyIsEnumerable.call(d,g[v])&&(p[g[v]]=d[g[v]])}return p}(h,["nocookie"]),w=`www.youtube${m?"-nocookie":""}.com`,T=Ta(r,f),S=encodeURIComponent(c[2]);n.videoId=S,n.src=`https://${w}/embed/${S}?${T}`,n.thumbSrc=n.thumbSrc||`https://i.ytimg.com/vi/${S}/mqdefault.jpg`,s=Wt}else if(c=r.match(/^.+vimeo.com\/(?:\/)?([\d]+)((\/|\?h=)([a-z0-9]+))?(.*)?/)){const h=Ta(r,this.optionFor(n,an)),m=encodeURIComponent(c[1]),f=c[4]||"";n.videoId=m,n.src=`https://player.vimeo.com/video/${m}?${f?`h=${f}${h?"&":""}`:""}${h}`,s=an}if(!s&&n.triggerEl){const h=n.triggerEl.dataset.type;Ul.includes(h)&&(s=h)}s||typeof r=="string"&&(r.charAt(0)==="#"?s="inline":(c=r.match(/\.(mp4|mov|ogv|webm)((\?|#).*)?$/i))?(s=$n,n.videoFormat=n.videoFormat||"video/"+(c[1]==="ogv"?"ogg":c[1])):r.match(/(^data:image\/[a-z0-9+\/=]*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg|ico)((\?|#).*)?$)/i)?s=Ca:r.match(/\.(pdf)((\?|#).*)?$/i)&&(s="pdf")),(c=r.match(/(?:maps\.)?google\.([a-z]{2,3}(?:\.[a-z]{2})?)\/(?:(?:(?:maps\/(?:place\/(?:.*)\/)?\@(.*),(\d+.?\d+?)z))|(?:\?ll=))(.*)?/i))?(n.src=`https://maps.google.${c[1]}/?ll=${(c[2]?c[2]+"&z="+Math.floor(parseFloat(c[3]))+(c[4]?c[4].replace(/^\//,"&"):""):c[4]+"").replace(/\?/,"&")}&output=${c[4]&&c[4].indexOf("layer=c")>0?"svembed":"embed"}`,s=ar):(c=r.match(/(?:maps\.)?google\.([a-z]{2,3}(?:\.[a-z]{2})?)\/(?:maps\/search\/)(.*)/i))&&(n.src=`https://maps.google.${c[1]}/maps?q=${c[2].replace("query=","q=").replace("api=1","")}&output=embed`,s=ar),s=s||this.instance.option("defaultType"),n.type=s,s===Ca&&(n.thumbSrc=n.thumbSrc||n.src)}setContent(n){const r=this.instance.optionFor(n,"src")||"";if(n&&n.type&&r){switch(n.type){case rr:this.instance.setContent(n,r);break;case $n:const s=this.option("videoTpl");s&&this.instance.setContent(n,s.replace(/\{\{src\}\}/gi,r+"").replace(/\{\{format\}\}/gi,this.optionFor(n,"videoFormat")||"").replace(/\{\{poster\}\}/gi,n.poster||n.thumbSrc||""));break;case"inline":case"clone":this.setInlineContent(n);break;case"ajax":this.loadAjaxContent(n);break;case"pdf":case ar:case Wt:case an:n.preload=!1;case"iframe":this.setIframeContent(n)}this.setAspectRatio(n)}}setAspectRatio(n){const r=n.contentEl;if(!(n.el&&r&&n.type&&[Wt,an,$n].includes(n.type)))return;let s,c=n.width||"auto",h=n.height||"auto";if(c==="auto"||h==="auto"){s=this.optionFor(n,"videoRatio");const T=(s+"").match(/(\d+)\s*\/\s?(\d+)/);s=T&&T.length>2?parseFloat(T[1])/parseFloat(T[2]):parseFloat(s+"")}else c&&h&&(s=c/h);if(!s)return;r.style.aspectRatio="",r.style.width="",r.style.height="",r.offsetHeight;const m=r.getBoundingClientRect(),f=m.width||1,w=m.height||1;r.style.aspectRatio=s+"",s<f/w?(h=h==="auto"?w:Math.min(w,h),r.style.width="auto",r.style.height=`${h}px`):(c=c==="auto"?f:Math.min(f,c),r.style.width=`${c}px`,r.style.height="auto")}attach(){const n=this,r=n.instance;r.on("Carousel.beforeInitSlide",n.onBeforeInitSlide),r.on("Carousel.createSlide",n.onCreateSlide),r.on("Carousel.selectSlide",n.onSelectSlide),r.on("Carousel.unselectSlide",n.onUnselectSlide),r.on("Carousel.Panzoom.refresh",n.onRefresh),r.on("done",n.onDone),r.on("clearContent",n.onClearContent),window.addEventListener("message",n.onMessage)}detach(){const n=this,r=n.instance;r.off("Carousel.beforeInitSlide",n.onBeforeInitSlide),r.off("Carousel.createSlide",n.onCreateSlide),r.off("Carousel.selectSlide",n.onSelectSlide),r.off("Carousel.unselectSlide",n.onUnselectSlide),r.off("Carousel.Panzoom.refresh",n.onRefresh),r.off("done",n.onDone),r.off("clearContent",n.onClearContent),window.removeEventListener("message",n.onMessage)}}Object.defineProperty(uo,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:$l});const yi="play",bi="pause",Un="ready";class fo extends Pt{constructor(){super(...arguments),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:Un}),Object.defineProperty(this,"inHover",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"timer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"progressBar",{enumerable:!0,configurable:!0,writable:!0,value:null})}get isActive(){return this.state!==Un}onReady(n){this.option("autoStart")&&(n.isInfinite||n.page<n.pages.length-1)&&this.start()}onChange(){this.removeProgressBar(),this.pause()}onSettle(){this.resume()}onVisibilityChange(){document.visibilityState==="visible"?this.resume():this.pause()}onMouseEnter(){this.inHover=!0,this.pause()}onMouseLeave(){var n;this.inHover=!1,!((n=this.instance.panzoom)===null||n===void 0)&&n.isResting&&this.resume()}onTimerEnd(){const n=this.instance;this.state==="play"&&(n.isInfinite||n.page!==n.pages.length-1?n.slideNext():n.slideTo(0))}removeProgressBar(){this.progressBar&&(this.progressBar.remove(),this.progressBar=null)}createProgressBar(){var n;if(!this.option("showProgress"))return null;this.removeProgressBar();const r=this.instance,s=((n=r.pages[r.page])===null||n===void 0?void 0:n.slides)||[];let c=this.option("progressParentEl");if(c||(c=(s.length===1?s[0].el:null)||r.viewport),!c)return null;const h=document.createElement("div");return Ce(h,"f-progress"),c.prepend(h),this.progressBar=h,h.offsetHeight,h}set(){const n=this,r=n.instance;if(r.pages.length<2||n.timer)return;const s=n.option("timeout");n.state=yi,Ce(r.container,"has-autoplay");let c=n.createProgressBar();c&&(c.style.transitionDuration=`${s}ms`,c.style.transform="scaleX(1)"),n.timer=setTimeout(()=>{n.timer=null,n.inHover||n.onTimerEnd()},s),n.emit("set")}clear(){const n=this;n.timer&&(clearTimeout(n.timer),n.timer=null),n.removeProgressBar()}start(){const n=this;if(n.set(),n.state!==Un){if(n.option("pauseOnHover")){const r=n.instance.container;r.addEventListener("mouseenter",n.onMouseEnter,!1),r.addEventListener("mouseleave",n.onMouseLeave,!1)}document.addEventListener("visibilitychange",n.onVisibilityChange,!1),n.emit("start")}}stop(){const n=this,r=n.state,s=n.instance.container;n.clear(),n.state=Un,s.removeEventListener("mouseenter",n.onMouseEnter,!1),s.removeEventListener("mouseleave",n.onMouseLeave,!1),document.removeEventListener("visibilitychange",n.onVisibilityChange,!1),Ve(s,"has-autoplay"),r!==Un&&n.emit("stop")}pause(){const n=this;n.state===yi&&(n.state=bi,n.clear(),n.emit(bi))}resume(){const n=this,r=n.instance;if(r.isInfinite||r.page!==r.pages.length-1)if(n.state!==yi){if(n.state===bi&&!n.inHover){const s=new Event("resume",{bubbles:!0,cancelable:!0});n.emit("resume",s),s.defaultPrevented||n.set()}}else n.set();else n.stop()}toggle(){this.state===yi||this.state===bi?this.stop():this.start()}attach(){const n=this,r=n.instance;r.on("ready",n.onReady),r.on("Panzoom.startAnimation",n.onChange),r.on("Panzoom.endAnimation",n.onSettle),r.on("Panzoom.touchMove",n.onChange)}detach(){const n=this,r=n.instance;r.off("ready",n.onReady),r.off("Panzoom.startAnimation",n.onChange),r.off("Panzoom.endAnimation",n.onSettle),r.off("Panzoom.touchMove",n.onChange),n.stop()}}Object.defineProperty(fo,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{autoStart:!0,pauseOnHover:!0,progressParentEl:null,showProgress:!0,timeout:3e3}});class ho extends Pt{constructor(){super(...arguments),Object.defineProperty(this,"ref",{enumerable:!0,configurable:!0,writable:!0,value:null})}onPrepare(n){const r=n.carousel;if(!r)return;const s=n.container;s&&(r.options.Autoplay=yt({autoStart:!1},this.option("Autoplay")||{},{pauseOnHover:!1,timeout:this.option("timeout"),progressParentEl:()=>this.option("progressParentEl")||null,on:{start:()=>{n.emit("startSlideshow")},set:c=>{var h;s.classList.add("has-slideshow"),((h=n.getSlide())===null||h===void 0?void 0:h.state)!==ht.Ready&&c.pause()},stop:()=>{s.classList.remove("has-slideshow"),n.isCompact||n.endIdle(),n.emit("endSlideshow")},resume:(c,h)=>{var m,f,w;!h||!h.cancelable||((m=n.getSlide())===null||m===void 0?void 0:m.state)===ht.Ready&&(!((w=(f=n.carousel)===null||f===void 0?void 0:f.panzoom)===null||w===void 0)&&w.isResting)||h.preventDefault()}}}),r.attachPlugins({Autoplay:fo}),this.ref=r.plugins.Autoplay)}onReady(n){const r=n.carousel,s=this.ref;s&&r&&this.option("playOnStart")&&(r.isInfinite||r.page<r.pages.length-1)&&s.start()}onDone(n,r){const s=this.ref,c=n.carousel;if(!s||!c)return;const h=r.panzoom;h&&h.on("startAnimation",()=>{n.isCurrentSlide(r)&&s.stop()}),n.isCurrentSlide(r)&&s.resume()}onKeydown(n,r){var s;const c=this.ref;c&&r===this.option("key")&&((s=document.activeElement)===null||s===void 0?void 0:s.nodeName)!=="BUTTON"&&c.toggle()}attach(){const n=this,r=n.instance;r.on("Carousel.init",n.onPrepare),r.on("Carousel.ready",n.onReady),r.on("done",n.onDone),r.on("keydown",n.onKeydown)}detach(){const n=this,r=n.instance;r.off("Carousel.init",n.onPrepare),r.off("Carousel.ready",n.onReady),r.off("done",n.onDone),r.off("keydown",n.onKeydown)}}Object.defineProperty(ho,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{key:" ",playOnStart:!1,progressParentEl:C=>{var n;return((n=C.instance.container)===null||n===void 0?void 0:n.querySelector(".fancybox__toolbar [data-fancybox-toggle-slideshow]"))||C.instance.container},timeout:3e3}});const po={classes:{container:"f-thumbs f-carousel__thumbs",viewport:"f-thumbs__viewport",track:"f-thumbs__track",slide:"f-thumbs__slide",isResting:"is-resting",isSelected:"is-selected",isLoading:"is-loading",hasThumbs:"has-thumbs"},minCount:2,parentEl:null,thumbTpl:'<button class="f-thumbs__slide__button" tabindex="0" type="button" aria-label="{{GOTO}}" data-carousel-index="%i"><img class="f-thumbs__slide__img" data-lazy-src="{{%s}}" alt="" /></button>',type:"modern"};var Yt;(function(C){C[C.Init=0]="Init",C[C.Ready=1]="Ready",C[C.Hidden=2]="Hidden"})(Yt||(Yt={}));const ka="isResting",wi="thumbWidth",Tn="thumbHeight",Ht="thumbClipWidth";let mo=class extends Pt{constructor(){super(...arguments),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:"modern"}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"track",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"carousel",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"thumbWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbClipWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbGap",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbExtraGap",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:Yt.Init})}get isModern(){return this.type==="modern"}onInitSlide(C,n){const r=n.el?n.el.dataset:void 0;r&&(n.thumbSrc=r.thumbSrc||n.thumbSrc||"",n[Ht]=parseFloat(r[Ht]||"")||n[Ht]||0,n[Tn]=parseFloat(r.thumbHeight||"")||n[Tn]||0),this.addSlide(n)}onInitSlides(){this.build()}onChange(){var C;if(!this.isModern)return;const n=this.container,r=this.instance,s=r.panzoom,c=this.carousel,h=c?c.panzoom:null,m=r.page;if(s&&c&&h){if(s.isDragging){Ve(n,this.cn(ka));let f=((C=c.pages[m])===null||C===void 0?void 0:C.pos)||0;f+=r.getProgress(m)*(this[Ht]+this.thumbGap);let w=h.getBounds();-1*f>w.x.min&&-1*f<w.x.max&&h.panTo({x:-1*f,friction:.12})}else zt(n,this.cn(ka),s.isResting);this.shiftModern()}}onRefresh(){this.updateProps();for(const C of this.instance.slides||[])this.resizeModernSlide(C);this.shiftModern()}isDisabled(){const C=this.option("minCount")||0;if(C){const r=this.instance;let s=0;for(const c of r.slides||[])c.thumbSrc&&s++;if(s<C)return!0}const n=this.option("type");return["modern","classic"].indexOf(n)<0}getThumb(C){const n=this.option("thumbTpl")||"";return{html:this.instance.localize(n,[["%i",C.index],["%d",C.index+1],["%s",C.thumbSrc||"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"]])}}addSlide(C){const n=this.carousel;n&&n.addSlide(C.index,this.getThumb(C))}getSlides(){const C=[];for(const n of this.instance.slides||[])C.push(this.getThumb(n));return C}resizeModernSlide(C){this.isModern&&(C[wi]=C[Ht]&&C[Tn]?Math.round(this[Tn]*(C[Ht]/C[Tn])):this[wi])}updateProps(){const C=this.container;if(!C)return;const n=r=>parseFloat(getComputedStyle(C).getPropertyValue("--f-thumb-"+r))||0;this.thumbGap=n("gap"),this.thumbExtraGap=n("extra-gap"),this[wi]=n("width")||40,this[Ht]=n("clip-width")||40,this[Tn]=n("height")||40}build(){const C=this;if(C.state!==Yt.Init)return;if(C.isDisabled())return void C.emit("disabled");const n=C.instance,r=n.container,s=C.getSlides(),c=C.option("type");C.type=c;const h=C.option("parentEl"),m=C.cn("container"),f=C.cn("track");let w=h==null?void 0:h.querySelector("."+m);w||(w=document.createElement("div"),Ce(w,m),h?h.appendChild(w):r.after(w)),Ce(w,`is-${c}`),Ce(r,C.cn("hasThumbs")),C.container=w,C.updateProps();let T=w.querySelector("."+f);T||(T=document.createElement("div"),Ce(T,C.cn("track")),w.appendChild(T)),C.track=T;const S=yt({},{track:T,infinite:!1,center:!0,fill:c==="classic",dragFree:!0,slidesPerPage:1,transition:!1,preload:.25,friction:.12,Panzoom:{maxVelocity:0},Dots:!1,Navigation:!1,classes:{container:"f-thumbs",viewport:"f-thumbs__viewport",track:"f-thumbs__track",slide:"f-thumbs__slide"}},C.option("Carousel")||{},{Sync:{target:n},slides:s}),d=new n.constructor(w,S);d.on("createSlide",(u,p)=>{C.setProps(p.index),C.emit("createSlide",p,p.el)}),d.on("ready",()=>{C.shiftModern(),C.emit("ready")}),d.on("refresh",()=>{C.shiftModern()}),d.on("Panzoom.click",(u,p,g)=>{C.onClick(g)}),C.carousel=d,C.state=Yt.Ready}onClick(C){C.preventDefault(),C.stopPropagation();const n=this.instance,{pages:r,page:s}=n,c=v=>{if(v){const b=v.closest("[data-carousel-index]");if(b)return[parseInt(b.dataset.carouselIndex||"",10)||0,b]}return[-1,void 0]},h=(v,b)=>{const k=document.elementFromPoint(v,b);return k?c(k):[-1,void 0]};let[m,f]=c(C.target);if(m>-1)return;const w=this[Ht],T=C.clientX,S=C.clientY;let[d,u]=h(T-w,S),[p,g]=h(T+w,S);u&&g?(m=Math.abs(T-u.getBoundingClientRect().right)<Math.abs(T-g.getBoundingClientRect().left)?d:p,m===s&&(m=m===d?p:d)):u?m=d:g&&(m=p),m>-1&&r[m]&&n.slideTo(m)}getShift(C){var n;const r=this,{instance:s}=r,c=r.carousel;if(!s||!c)return 0;const h=r[wi],m=r[Ht],f=r.thumbGap,w=r.thumbExtraGap;if(!(!((n=c.slides[C])===null||n===void 0)&&n.el))return 0;const T=.5*(h-m),S=s.pages.length-1;let d=s.getProgress(0),u=s.getProgress(S),p=s.getProgress(C,!1,!0),g=0,v=T+w+f;const b=d<0&&d>-1,k=u>0&&u<1;return C===0?(g=v*Math.abs(d),k&&d===1&&(g-=v*Math.abs(u))):C===S?(g=v*Math.abs(u)*-1,b&&u===-1&&(g+=v*Math.abs(d))):b||k?(g=-1*v,g+=v*Math.abs(d),g+=v*(1-Math.abs(u))):g=v*p,g}setProps(C){var n;const r=this;if(!r.isModern)return;const{instance:s}=r,c=r.carousel;if(s&&c){const h=(n=c.slides[C])===null||n===void 0?void 0:n.el;if(h&&h.childNodes.length){let m=pe(1-Math.abs(s.getProgress(C))),f=pe(r.getShift(C));h.style.setProperty("--progress",m?m+"":""),h.style.setProperty("--shift",f+"")}}}shiftModern(){const C=this;if(!C.isModern)return;const{instance:n,track:r}=C,s=n.panzoom,c=C.carousel;if(!(n&&r&&s&&c)||s.state===qe.Init||s.state===qe.Destroy)return;for(const m of n.slides)C.setProps(m.index);let h=(C[Ht]+C.thumbGap)*(c.slides.length||0);r.style.setProperty("--width",h+"")}cleanup(){const C=this;C.carousel&&C.carousel.destroy(),C.carousel=null,C.container&&C.container.remove(),C.container=null,C.track&&C.track.remove(),C.track=null,C.state=Yt.Init,Ve(C.instance.container,C.cn("hasThumbs"))}attach(){const C=this,n=C.instance;n.on("initSlide",C.onInitSlide),n.state===rt.Init?n.on("initSlides",C.onInitSlides):C.onInitSlides(),n.on(["change","Panzoom.afterTransform"],C.onChange),n.on("Panzoom.refresh",C.onRefresh)}detach(){const C=this,n=C.instance;n.off("initSlide",C.onInitSlide),n.off("initSlides",C.onInitSlides),n.off(["change","Panzoom.afterTransform"],C.onChange),n.off("Panzoom.refresh",C.onRefresh),C.cleanup()}};Object.defineProperty(mo,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:po});const Vl=Object.assign(Object.assign({},po),{key:"t",showOnStart:!0,parentEl:null}),xa="is-masked",Ma="aria-hidden";class go extends Pt{constructor(){super(...arguments),Object.defineProperty(this,"ref",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hidden",{enumerable:!0,configurable:!0,writable:!0,value:!1})}get isEnabled(){const n=this.ref;return n&&!n.isDisabled()}get isHidden(){return this.hidden}onClick(n,r){r.stopPropagation()}onCreateSlide(n,r){var s,c,h;const m=((h=(c=(s=this.instance)===null||s===void 0?void 0:s.carousel)===null||c===void 0?void 0:c.slides[r.index])===null||h===void 0?void 0:h.type)||"",f=r.el;if(f&&m){let w=`for-${m}`;["video","youtube","vimeo","html5video"].includes(m)&&(w+=" for-video"),Ce(f,w)}}onInit(){var n;const r=this,s=r.instance,c=s.carousel;if(r.ref||!c)return;const h=r.option("parentEl")||s.footer||s.container;if(!h)return;const m=yt({},r.options,{parentEl:h,classes:{container:"f-thumbs fancybox__thumbs"},Carousel:{Sync:{friction:s.option("Carousel.friction")||0}},on:{ready:f=>{const w=f.container;w&&this.hidden&&(r.refresh(),w.style.transition="none",r.hide(),w.offsetHeight,queueMicrotask(()=>{w.style.transition="",r.show()}))}}});m.Carousel=m.Carousel||{},m.Carousel.on=yt(((n=r.options.Carousel)===null||n===void 0?void 0:n.on)||{},{click:this.onClick,createSlide:this.onCreateSlide}),c.options.Thumbs=m,c.attachPlugins({Thumbs:mo}),r.ref=c.plugins.Thumbs,r.option("showOnStart")||(r.ref.state=Yt.Hidden,r.hidden=!0)}onResize(){var n;const r=(n=this.ref)===null||n===void 0?void 0:n.container;r&&(r.style.maxHeight="")}onKeydown(n,r){const s=this.option("key");s&&s===r&&this.toggle()}toggle(){const n=this.ref;if(n&&!n.isDisabled())return n.state===Yt.Hidden?(n.state=Yt.Init,void n.build()):void(this.hidden?this.show():this.hide())}show(){const n=this.ref;if(!n||n.isDisabled())return;const r=n.container;r&&(this.refresh(),r.offsetHeight,r.removeAttribute(Ma),r.classList.remove(xa),this.hidden=!1)}hide(){const n=this.ref,r=n&&n.container;r&&(this.refresh(),r.offsetHeight,r.classList.add(xa),r.setAttribute(Ma,"true")),this.hidden=!0}refresh(){const n=this.ref;if(!n||!n.state)return;const r=n.container,s=(r==null?void 0:r.firstChild)||null;r&&s&&s.childNodes.length&&(r.style.maxHeight=`${s.getBoundingClientRect().height}px`)}attach(){const n=this,r=n.instance;r.state===lt.Init?r.on("Carousel.init",n.onInit):n.onInit(),r.on("resize",n.onResize),r.on("keydown",n.onKeydown)}detach(){var n;const r=this,s=r.instance;s.off("Carousel.init",r.onInit),s.off("resize",r.onResize),s.off("keydown",r.onKeydown),(n=s.carousel)===null||n===void 0||n.detachPlugins(["Thumbs"]),r.ref=null}}Object.defineProperty(go,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:Vl});const or={panLeft:{icon:'<svg><path d="M5 12h14M5 12l6 6M5 12l6-6"/></svg>',change:{panX:-100}},panRight:{icon:'<svg><path d="M5 12h14M13 18l6-6M13 6l6 6"/></svg>',change:{panX:100}},panUp:{icon:'<svg><path d="M12 5v14M18 11l-6-6M6 11l6-6"/></svg>',change:{panY:-100}},panDown:{icon:'<svg><path d="M12 5v14M18 13l-6 6M6 13l6 6"/></svg>',change:{panY:100}},zoomIn:{icon:'<svg><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M11 8v6M8 11h6"/></svg>',action:"zoomIn"},zoomOut:{icon:'<svg><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M8 11h6"/></svg>',action:"zoomOut"},toggle1to1:{icon:'<svg><path d="M3.51 3.07c5.74.02 11.48-.02 17.22.02 1.37.1 2.34 1.64 2.18 3.13 0 4.08.02 8.16 0 12.23-.1 1.54-1.47 2.64-2.79 2.46-5.61-.01-11.24.02-16.86-.01-1.36-.12-2.33-1.65-2.17-3.14 0-4.07-.02-8.16 0-12.23.1-1.36 1.22-2.48 2.42-2.46Z"/><path d="M5.65 8.54h1.49v6.92m8.94-6.92h1.49v6.92M11.5 9.4v.02m0 5.18v0"/></svg>',action:"toggleZoom"},toggleZoom:{icon:'<svg><g><line x1="11" y1="8" x2="11" y2="14"></line></g><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M8 11h6"/></svg>',action:"toggleZoom"},iterateZoom:{icon:'<svg><g><line x1="11" y1="8" x2="11" y2="14"></line></g><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M8 11h6"/></svg>',action:"iterateZoom"},rotateCCW:{icon:'<svg><path d="M15 4.55a8 8 0 0 0-6 14.9M9 15v5H4M18.37 7.16v.01M13 19.94v.01M16.84 18.37v.01M19.37 15.1v.01M19.94 11v.01"/></svg>',action:"rotateCCW"},rotateCW:{icon:'<svg><path d="M9 4.55a8 8 0 0 1 6 14.9M15 15v5h5M5.63 7.16v.01M4.06 11v.01M4.63 15.1v.01M7.16 18.37v.01M11 19.94v.01"/></svg>',action:"rotateCW"},flipX:{icon:'<svg style="stroke-width: 1.3"><path d="M12 3v18M16 7v10h5L16 7M8 7v10H3L8 7"/></svg>',action:"flipX"},flipY:{icon:'<svg style="stroke-width: 1.3"><path d="M3 12h18M7 16h10L7 21v-5M7 8h10L7 3v5"/></svg>',action:"flipY"},fitX:{icon:'<svg><path d="M4 12V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v6M10 18H3M21 18h-7M6 15l-3 3 3 3M18 15l3 3-3 3"/></svg>',action:"fitX"},fitY:{icon:'<svg><path d="M12 20H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h6M18 14v7M18 3v7M15 18l3 3 3-3M15 6l3-3 3 3"/></svg>',action:"fitY"},reset:{icon:'<svg><path d="M20 11A8.1 8.1 0 0 0 4.5 9M4 5v4h4M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4"/></svg>',action:"reset"},toggleFS:{icon:'<svg><g><path d="M14.5 9.5 21 3m0 0h-6m6 0v6M3 21l6.5-6.5M3 21v-6m0 6h6"/></g><g><path d="m14 10 7-7m-7 7h6m-6 0V4M3 21l7-7m0 0v6m0-6H4"/></g></svg>',action:"toggleFS"}};var dn;(function(C){C[C.Init=0]="Init",C[C.Ready=1]="Ready",C[C.Disabled=2]="Disabled"})(dn||(dn={}));const ql={absolute:"auto",display:{left:["infobar"],middle:[],right:["iterateZoom","slideshow","fullscreen","thumbs","close"]},enabled:"auto",items:{infobar:{tpl:'<div class="fancybox__infobar" tabindex="-1"><span data-fancybox-current-index></span>/<span data-fancybox-count></span></div>'},download:{tpl:'<a class="f-button" title="{{DOWNLOAD}}" data-fancybox-download href="javasript:;"><svg><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2M7 11l5 5 5-5M12 4v12"/></svg></a>'},prev:{tpl:'<button class="f-button" title="{{PREV}}" data-fancybox-prev><svg><path d="m15 6-6 6 6 6"/></svg></button>'},next:{tpl:'<button class="f-button" title="{{NEXT}}" data-fancybox-next><svg><path d="m9 6 6 6-6 6"/></svg></button>'},slideshow:{tpl:'<button class="f-button" title="{{TOGGLE_SLIDESHOW}}" data-fancybox-toggle-slideshow><svg><g><path d="M8 4v16l13 -8z"></path></g><g><path d="M8 4v15M17 4v15"/></g></svg></button>'},fullscreen:{tpl:'<button class="f-button" title="{{TOGGLE_FULLSCREEN}}" data-fancybox-toggle-fullscreen><svg><g><path d="M4 8V6a2 2 0 0 1 2-2h2M4 16v2a2 2 0 0 0 2 2h2M16 4h2a2 2 0 0 1 2 2v2M16 20h2a2 2 0 0 0 2-2v-2"/></g><g><path d="M15 19v-2a2 2 0 0 1 2-2h2M15 5v2a2 2 0 0 0 2 2h2M5 15h2a2 2 0 0 1 2 2v2M5 9h2a2 2 0 0 0 2-2V5"/></g></svg></button>'},thumbs:{tpl:'<button class="f-button" title="{{TOGGLE_THUMBS}}" data-fancybox-toggle-thumbs><svg><circle cx="5.5" cy="5.5" r="1"/><circle cx="12" cy="5.5" r="1"/><circle cx="18.5" cy="5.5" r="1"/><circle cx="5.5" cy="12" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="18.5" cy="12" r="1"/><circle cx="5.5" cy="18.5" r="1"/><circle cx="12" cy="18.5" r="1"/><circle cx="18.5" cy="18.5" r="1"/></svg></button>'},close:{tpl:'<button class="f-button" title="{{CLOSE}}" data-fancybox-close><svg><path d="m19.5 4.5-15 15M4.5 4.5l15 15"/></svg></button>'}},parentEl:null},Wl={tabindex:"-1",width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},_a="has-toolbar",sr="fancybox__toolbar";class vo extends Pt{constructor(){super(...arguments),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:dn.Init}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null})}onReady(n){var r;if(!n.carousel)return;let s=this.option("display"),c=this.option("absolute"),h=this.option("enabled");if(h==="auto"){const T=this.instance.carousel;let S=0;if(T)for(const d of T.slides)(d.panzoom||d.type==="image")&&S++;S||(h=!1)}h||(s=void 0);let m=0;const f={left:[],middle:[],right:[]};if(s)for(const T of["left","middle","right"])for(const S of s[T]){const d=this.createEl(S);d&&((r=f[T])===null||r===void 0||r.push(d),m++)}let w=null;if(m&&(w=this.createContainer()),w){for(const[T,S]of Object.entries(f)){const d=document.createElement("div");Ce(d,sr+"__column is-"+T);for(const u of S)d.appendChild(u);c!=="auto"||T!=="middle"||S.length||(c=!0),w.appendChild(d)}c===!0&&Ce(w,"is-absolute"),this.state=dn.Ready,this.onRefresh()}else this.state=dn.Disabled}onClick(n){var r,s;const c=this.instance,h=c.getSlide(),m=h==null?void 0:h.panzoom,f=n.target,w=f&&vt(f)?f.dataset:null;if(!w)return;if(w.fancyboxToggleThumbs!==void 0)return n.preventDefault(),n.stopPropagation(),void((r=c.plugins.Thumbs)===null||r===void 0||r.toggle());if(w.fancyboxToggleFullscreen!==void 0)return n.preventDefault(),n.stopPropagation(),void this.instance.toggleFullscreen();if(w.fancyboxToggleSlideshow!==void 0){n.preventDefault(),n.stopPropagation();const d=(s=c.carousel)===null||s===void 0?void 0:s.plugins.Autoplay;let u=d.isActive;return m&&m.panMode==="mousemove"&&!u&&m.reset(),void(u?d.stop():d.start())}const T=w.panzoomAction,S=w.panzoomChange;if((S||T)&&(n.preventDefault(),n.stopPropagation()),S){let d={};try{d=JSON.parse(S)}catch{}m&&m.applyChange(d)}else T&&m&&m[T]&&m[T]()}onChange(){this.onRefresh()}onRefresh(){if(this.instance.isClosing())return;const n=this.container;if(!n)return;const r=this.instance.getSlide();if(!r||r.state!==ht.Ready)return;const s=r&&!r.error&&r.panzoom;for(const m of n.querySelectorAll("[data-panzoom-action]"))s?(m.removeAttribute("disabled"),m.removeAttribute("tabindex")):(m.setAttribute("disabled",""),m.setAttribute("tabindex","-1"));let c=s&&s.canZoomIn(),h=s&&s.canZoomOut();for(const m of n.querySelectorAll('[data-panzoom-action="zoomIn"]'))c?(m.removeAttribute("disabled"),m.removeAttribute("tabindex")):(m.setAttribute("disabled",""),m.setAttribute("tabindex","-1"));for(const m of n.querySelectorAll('[data-panzoom-action="zoomOut"]'))h?(m.removeAttribute("disabled"),m.removeAttribute("tabindex")):(m.setAttribute("disabled",""),m.setAttribute("tabindex","-1"));for(const m of n.querySelectorAll('[data-panzoom-action="toggleZoom"],[data-panzoom-action="iterateZoom"]')){h||c?(m.removeAttribute("disabled"),m.removeAttribute("tabindex")):(m.setAttribute("disabled",""),m.setAttribute("tabindex","-1"));const f=m.querySelector("g");f&&(f.style.display=c?"":"none")}}onDone(n,r){var s;(s=r.panzoom)===null||s===void 0||s.on("afterTransform",()=>{this.instance.isCurrentSlide(r)&&this.onRefresh()}),this.instance.isCurrentSlide(r)&&this.onRefresh()}createContainer(){const n=this.instance.container;if(!n)return null;const r=this.option("parentEl")||n;let s=r.querySelector("."+sr);return s||(s=document.createElement("div"),Ce(s,sr),r.prepend(s)),s.addEventListener("click",this.onClick,{passive:!1,capture:!0}),n&&Ce(n,_a),this.container=s,s}createEl(n){const r=this.instance,s=r.carousel;if(!s||n==="toggleFS"||n==="fullscreen"&&!ro())return null;let c=null;const h=s.slides.length||0;let m=0,f=0;for(const T of s.slides)(T.panzoom||T.type==="image")&&m++,(T.type==="image"||T.downloadSrc)&&f++;if(h<2&&["infobar","prev","next"].includes(n))return c;if(or[n]!==void 0&&!m||n==="download"&&!f)return null;if(n==="thumbs"){const T=r.plugins.Thumbs;if(!T||!T.isEnabled)return null}if(n==="slideshow"&&(!s.plugins.Autoplay||h<2))return null;if(or[n]!==void 0){const T=or[n];c=document.createElement("button"),c.setAttribute("title",this.instance.localize(`{{${n.toUpperCase()}}}`)),Ce(c,"f-button"),T.action&&(c.dataset.panzoomAction=T.action),T.change&&(c.dataset.panzoomChange=JSON.stringify(T.change)),c.appendChild(Bt(this.instance.localize(T.icon)))}else{const T=(this.option("items")||[])[n];T&&(c=Bt(this.instance.localize(T.tpl)),typeof T.click=="function"&&c.addEventListener("click",S=>{S.preventDefault(),S.stopPropagation(),typeof T.click=="function"&&T.click.call(this,this,S)}))}const w=c==null?void 0:c.querySelector("svg");if(w)for(const[T,S]of Object.entries(Wl))w.getAttribute(T)||w.setAttribute(T,String(S));return c}removeContainer(){const n=this.container;n&&n.remove(),this.container=null,this.state=dn.Disabled;const r=this.instance.container;r&&Ve(r,_a)}attach(){const n=this,r=n.instance;r.on("Carousel.initSlides",n.onReady),r.on("done",n.onDone),r.on(["reveal","Carousel.change"],n.onChange),n.onReady(n.instance)}detach(){const n=this,r=n.instance;r.off("Carousel.initSlides",n.onReady),r.off("done",n.onDone),r.off(["reveal","Carousel.change"],n.onChange),n.removeContainer()}}Object.defineProperty(vo,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:ql});const Yl={Hash:class extends Pt{onReady(){qn=!1}onChange(C){cn&&clearTimeout(cn);const{hash:n}=ao(),{hash:r}=Ai(),s=C.isOpeningSlide(C.getSlide());s&&(Ea=r===n?"":r),n&&n!==r&&(cn=setTimeout(()=>{try{if(C.state===lt.Ready){let c="replaceState";s&&!gi&&(c="pushState",gi=!0),window.history[c]({},document.title,window.location.pathname+window.location.search+n)}}catch{}},300))}onClose(C){if(cn&&clearTimeout(cn),!qn&&gi)return gi=!1,qn=!1,void window.history.back();if(!qn)try{window.history.replaceState({},document.title,window.location.pathname+window.location.search+(Ea||""))}catch{}}attach(){const C=this.instance;C.on("ready",this.onReady),C.on(["Carousel.ready","Carousel.change"],this.onChange),C.on("close",this.onClose)}detach(){const C=this.instance;C.off("ready",this.onReady),C.off(["Carousel.ready","Carousel.change"],this.onChange),C.off("close",this.onClose)}static parseURL(){return Ai()}static startFromUrl(){oo()}static destroy(){window.removeEventListener("hashchange",lo,!1)}},Html:uo,Images:co,Slideshow:ho,Thumbs:go,Toolbar:vo},La="with-fancybox",lr="hide-scrollbar",Aa="--fancybox-scrollbar-compensate",Da="--fancybox-body-margin",cr="aria-hidden",ur="is-using-tab",dr="is-animated",Oa="is-compact",Pa="is-loading",fr="is-opening",Ei="has-caption",kn="disabled",on="tabindex",Ra="download",hr="href",xn="src",Qt=C=>typeof C=="string",Ia=function(){var C=window.getSelection();return!!C&&C.type==="Range"};let xt,Mt=null,sn=null,Ha=0,Na=0,ja=0,Ba=0;const Mn=new Map;let Kl=0;class Fe extends Cr{get isIdle(){return this.idle}get isCompact(){return this.option("compact")}constructor(n=[],r={},s={}){super(r),Object.defineProperty(this,"userSlides",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"userPlugins",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"idle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"idleTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"clickTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"pwt",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"ignoreFocusChange",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"startedFs",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:lt.Init}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"footer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"carousel",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"lastFocus",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"prevMouseMoveEvent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),xt||(xt=ro()),this.id=r.id||++Kl,Mn.set(this.id,this),this.userSlides=n,this.userPlugins=s,queueMicrotask(()=>{this.init()})}init(){if(this.state===lt.Destroy)return;this.state=lt.Init,this.attachPlugins(Object.assign(Object.assign({},Fe.Plugins),this.userPlugins)),this.emit("init"),this.emit("attachPlugins"),this.option("hideScrollbar")===!0&&(()=>{if(!Wn)return;const r=document,s=r.body,c=r.documentElement;if(s.classList.contains(lr))return;let h=window.innerWidth-c.getBoundingClientRect().width;const m=parseFloat(window.getComputedStyle(s).marginRight);h<0&&(h=0),c.style.setProperty(Aa,`${h}px`),m&&s.style.setProperty(Da,`${m}px`),s.classList.add(lr)})(),this.initLayout(),this.scale();const n=()=>{this.initCarousel(this.userSlides),this.state=lt.Ready,this.attachEvents(),this.emit("ready"),setTimeout(()=>{this.container&&this.container.setAttribute(cr,"false")},16)};this.option("Fullscreen.autoStart")&&xt&&!xt.isFullscreen()?xt.request().then(()=>{this.startedFs=!0,n()}).catch(()=>n()):n()}initLayout(){var n,r;const s=this.option("parentEl")||document.body,c=Bt(this.localize(this.option("tpl.main")||""));if(c){if(c.setAttribute("id",`fancybox-${this.id}`),c.setAttribute("aria-label",this.localize("{{MODAL}}")),c.classList.toggle(Oa,this.isCompact),Ce(c,this.option("mainClass")||""),Ce(c,fr),this.container=c,this.footer=c.querySelector(".fancybox__footer"),s.appendChild(c),Ce(document.documentElement,La),Mt&&sn||(Mt=document.createElement("span"),Ce(Mt,"fancybox-focus-guard"),Mt.setAttribute(on,"0"),Mt.setAttribute(cr,"true"),Mt.setAttribute("aria-label","Focus guard"),sn=Mt.cloneNode(),(n=c.parentElement)===null||n===void 0||n.insertBefore(Mt,c),(r=c.parentElement)===null||r===void 0||r.append(sn)),c.addEventListener("mousedown",h=>{Ha=h.pageX,Na=h.pageY,Ve(c,ur)}),this.option("closeExisting"))for(const h of Mn.values())h.id!==this.id&&h.close();else this.option("animated")&&(Ce(c,dr),setTimeout(()=>{this.isClosing()||Ve(c,dr)},350));this.emit("initLayout")}}initCarousel(n){const r=this.container;if(!r)return;const s=r.querySelector(".fancybox__carousel");if(!s)return;const c=this.carousel=new fn(s,yt({},{slides:n,transition:"fade",Panzoom:{lockAxis:this.option("dragToClose")?"xy":"x",infinite:!!this.option("dragToClose")&&"y"},Dots:!1,Navigation:{classes:{container:"fancybox__nav",button:"f-button",isNext:"is-next",isPrev:"is-prev"}},initialPage:this.option("startIndex"),l10n:this.option("l10n")},this.option("Carousel")||{}));c.on("*",(h,m,...f)=>{this.emit(`Carousel.${m}`,h,...f)}),c.on(["ready","change"],()=>{this.manageCaption()}),this.on("Carousel.removeSlide",(h,m,f)=>{this.clearContent(f),f.state=void 0}),c.on("Panzoom.touchStart",()=>{var h,m;this.isCompact||this.endIdle(),!((h=document.activeElement)===null||h===void 0)&&h.closest(".f-thumbs")&&((m=this.container)===null||m===void 0||m.focus())}),c.on("settle",()=>{this.idleTimer||this.isCompact||!this.option("idle")||this.setIdle(),this.option("autoFocus")&&!this.isClosing&&this.checkFocus()}),this.option("dragToClose")&&(c.on("Panzoom.afterTransform",(h,m)=>{const f=this.getSlide();if(f&&mr(f.el))return;const w=this.container;if(w){const T=Math.abs(m.current.f),S=T<1?"":Math.max(.5,Math.min(1,1-T/m.contentRect.fitHeight*1.5));w.style.setProperty("--fancybox-ts",S?"0s":""),w.style.setProperty("--fancybox-opacity",S+"")}}),c.on("Panzoom.touchEnd",(h,m,f)=>{var w;const T=this.getSlide();if(T&&mr(T.el)||m.isMobile&&document.activeElement&&["TEXTAREA","INPUT"].indexOf((w=document.activeElement)===null||w===void 0?void 0:w.nodeName)!==-1)return;const S=Math.abs(m.dragOffset.y);m.lockedAxis==="y"&&(S>=200||S>=50&&m.dragOffset.time<300)&&(f&&f.cancelable&&f.preventDefault(),this.close(f,"f-throwOut"+(m.current.f<0?"Up":"Down")))})),c.on("change",h=>{var m;let f=(m=this.getSlide())===null||m===void 0?void 0:m.triggerEl;if(f){const w=new CustomEvent("slideTo",{bubbles:!0,cancelable:!0,detail:h.page});f.dispatchEvent(w)}}),c.on(["refresh","change"],h=>{const m=this.container;if(!m)return;for(const T of m.querySelectorAll("[data-fancybox-current-index]"))T.innerHTML=h.page+1;for(const T of m.querySelectorAll("[data-fancybox-count]"))T.innerHTML=h.pages.length;if(!h.isInfinite){for(const T of m.querySelectorAll("[data-fancybox-next]"))h.page<h.pages.length-1?(T.removeAttribute(kn),T.removeAttribute(on)):(T.setAttribute(kn,""),T.setAttribute(on,"-1"));for(const T of m.querySelectorAll("[data-fancybox-prev]"))h.page>0?(T.removeAttribute(kn),T.removeAttribute(on)):(T.setAttribute(kn,""),T.setAttribute(on,"-1"))}const f=this.getSlide();if(!f)return;let w=f.downloadSrc||"";w||f.type!=="image"||f.error||!Qt(f[xn])||(w=f[xn]);for(const T of m.querySelectorAll("[data-fancybox-download]")){const S=f.downloadFilename;w?(T.removeAttribute(kn),T.removeAttribute(on),T.setAttribute(hr,w),T.setAttribute(Ra,S||w),T.setAttribute("target","_blank")):(T.setAttribute(kn,""),T.setAttribute(on,"-1"),T.removeAttribute(hr),T.removeAttribute(Ra))}}),this.emit("initCarousel")}attachEvents(){const n=this,r=n.container;if(!r)return;r.addEventListener("click",n.onClick,{passive:!1,capture:!1}),r.addEventListener("wheel",n.onWheel,{passive:!1,capture:!1}),document.addEventListener("keydown",n.onKeydown,{passive:!1,capture:!0}),document.addEventListener("visibilitychange",n.onVisibilityChange,!1),document.addEventListener("mousemove",n.onMousemove),n.option("trapFocus")&&document.addEventListener("focus",n.onFocus,!0),window.addEventListener("resize",n.onResize);const s=window.visualViewport;s&&(s.addEventListener("scroll",n.onResize),s.addEventListener("resize",n.onResize))}detachEvents(){const n=this,r=n.container;if(!r)return;document.removeEventListener("keydown",n.onKeydown,{passive:!1,capture:!0}),r.removeEventListener("wheel",n.onWheel,{passive:!1,capture:!1}),r.removeEventListener("click",n.onClick,{passive:!1,capture:!1}),document.removeEventListener("mousemove",n.onMousemove),window.removeEventListener("resize",n.onResize);const s=window.visualViewport;s&&(s.removeEventListener("resize",n.onResize),s.removeEventListener("scroll",n.onResize)),document.removeEventListener("visibilitychange",n.onVisibilityChange,!1),document.removeEventListener("focus",n.onFocus,!0)}scale(){const n=this.container;if(!n)return;const r=window.visualViewport,s=Math.max(1,(r==null?void 0:r.scale)||1);let c="",h="",m="";if(r&&s>1){let f=`${r.offsetLeft}px`,w=`${r.offsetTop}px`;c=r.width*s+"px",h=r.height*s+"px",m=`translate3d(${f}, ${w}, 0) scale(${1/s})`}n.style.transform=m,n.style.width=c,n.style.height=h}onClick(n){var r;const{container:s,isCompact:c}=this;if(!s||this.isClosing())return;!c&&this.option("idle")&&this.resetIdle();const h=n.composedPath()[0];if(h.closest(".fancybox-spinner")||h.closest("[data-fancybox-close]"))return n.preventDefault(),void this.close(n);if(h.closest("[data-fancybox-prev]"))return n.preventDefault(),void this.prev();if(h.closest("[data-fancybox-next]"))return n.preventDefault(),void this.next();if(n.type==="click"&&n.detail===0||Math.abs(n.pageX-Ha)>30||Math.abs(n.pageY-Na)>30)return;const m=document.activeElement;if(Ia()&&m&&s.contains(m))return;if(c&&((r=this.getSlide())===null||r===void 0?void 0:r.type)==="image")return void(this.clickTimer?(clearTimeout(this.clickTimer),this.clickTimer=null):this.clickTimer=setTimeout(()=>{this.toggleIdle(),this.clickTimer=null},350));if(this.emit("click",n),n.defaultPrevented)return;let f=!1;if(h.closest(".fancybox__content")){if(m){if(m.closest("[contenteditable]"))return;h.matches(ir)||m.blur()}if(Ia())return;f=this.option("contentClick")}else h.closest(".fancybox__carousel")&&!h.matches(ir)&&(f=this.option("backdropClick"));f==="close"?(n.preventDefault(),this.close(n)):f==="next"?(n.preventDefault(),this.next()):f==="prev"&&(n.preventDefault(),this.prev())}onWheel(n){const r=n.target;let s=this.option("wheel",n);r.closest(".fancybox__thumbs")&&(s="slide");const c=s==="slide",h=[-n.deltaX||0,-n.deltaY||0,-n.detail||0].reduce(function(w,T){return Math.abs(T)>Math.abs(w)?T:w}),m=Math.max(-1,Math.min(1,h)),f=Date.now();this.pwt&&f-this.pwt<300?c&&n.preventDefault():(this.pwt=f,this.emit("wheel",n,m),n.defaultPrevented||(s==="close"?(n.preventDefault(),this.close(n)):s==="slide"&&(_i(r)||(n.preventDefault(),this[m>0?"prev":"next"]()))))}onScroll(){window.scrollTo(ja,Ba)}onKeydown(n){if(!this.isTopmost())return;this.isCompact||!this.option("idle")||this.isClosing()||this.resetIdle();const r=n.key,s=this.option("keyboard");if(!s)return;const c=n.composedPath()[0],h=document.activeElement&&document.activeElement.classList,m=h&&h.contains("f-button")||c.dataset.carouselPage||c.dataset.carouselIndex;if(r!=="Escape"&&!m&&vt(c)&&(c.isContentEditable||["TEXTAREA","OPTION","INPUT","SELECT","VIDEO"].indexOf(c.nodeName)!==-1)||(n.key==="Tab"?Ce(this.container,ur):Ve(this.container,ur),n.ctrlKey||n.altKey||n.shiftKey))return;this.emit("keydown",r,n);const f=s[r];f&&typeof this[f]=="function"&&(n.preventDefault(),this[f]())}onResize(){const n=this.container;if(!n)return;const r=this.isCompact;n.classList.toggle(Oa,r),this.manageCaption(this.getSlide()),this.isCompact?this.clearIdle():this.endIdle(),this.scale(),this.emit("resize")}onFocus(n){this.isTopmost()&&this.checkFocus(n)}onMousemove(n){this.prevMouseMoveEvent=n,!this.isCompact&&this.option("idle")&&this.resetIdle()}onVisibilityChange(){document.visibilityState==="visible"?this.checkFocus():this.endIdle()}manageCloseBtn(n){const r=this.optionFor(n,"closeButton")||!1;if(r==="auto"){const c=this.plugins.Toolbar;if(c&&c.state===dn.Ready)return}if(!r||!n.contentEl||n.closeBtnEl)return;const s=this.option("tpl.closeButton");if(s){const c=Bt(this.localize(s));n.closeBtnEl=n.contentEl.appendChild(c),n.el&&Ce(n.el,"has-close-btn")}}manageCaption(n=void 0){var r,s;const c="fancybox__caption",h=this.container;if(!h)return;Ve(h,Ei);const m=this.isCompact||this.option("commonCaption"),f=!m;if(this.caption&&this.stop(this.caption),f&&this.caption&&(this.caption.remove(),this.caption=null),m&&!this.caption)for(const d of((r=this.carousel)===null||r===void 0?void 0:r.slides)||[])d.captionEl&&(d.captionEl.remove(),d.captionEl=void 0,Ve(d.el,Ei),(s=d.el)===null||s===void 0||s.removeAttribute("aria-labelledby"));if(n||(n=this.getSlide()),!n||m&&!this.isCurrentSlide(n))return;const w=n.el;let T=this.optionFor(n,"caption","");if(!T)return void(m&&this.caption&&this.animate(this.caption,"f-fadeOut",()=>{this.caption&&(this.caption.innerHTML="")}));let S=null;if(f){if(S=n.captionEl||null,w&&!S){const d=c+`_${this.id}_${n.index}`;S=document.createElement("div"),Ce(S,c),S.setAttribute("id",d),n.captionEl=w.appendChild(S),Ce(w,Ei),w.setAttribute("aria-labelledby",d)}}else S=this.caption,S||(S=h.querySelector("."+c)),!S&&(S=document.createElement("div"),S.dataset.fancyboxCaption="",Ce(S,c),(this.footer||h).prepend(S)),Ce(h,Ei),this.caption=S;S&&(S.innerHTML="",Qt(T)||typeof T=="number"?S.innerHTML=T+"":T instanceof HTMLElement&&S.appendChild(T))}checkFocus(n){this.focus(n)}focus(n){var r;if(this.ignoreFocusChange)return;const s=document.activeElement||null,c=(n==null?void 0:n.target)||null,h=this.container,m=(r=this.carousel)===null||r===void 0?void 0:r.viewport;if(!h||!m||!n&&s&&h.contains(s))return;const f=this.getSlide(),w=f&&f.state===ht.Ready?f.el:null;if(!w||w.contains(s)||h===s)return;n&&n.cancelable&&n.preventDefault(),this.ignoreFocusChange=!0;const T=Array.from(h.querySelectorAll(ir));let S=[],d=null;for(let p of T){const g=!p.offsetParent||!!p.closest('[aria-hidden="true"]'),v=w&&w.contains(p),b=!m.contains(p);if(p===h||(v||b)&&!g){S.push(p);const k=p.dataset.origTabindex;k!==void 0&&k&&(p.tabIndex=parseFloat(k)),p.removeAttribute("data-orig-tabindex"),!p.hasAttribute("autoFocus")&&d||(d=p)}else{const k=p.dataset.origTabindex===void 0?p.getAttribute("tabindex")||"":p.dataset.origTabindex;k&&(p.dataset.origTabindex=k),p.tabIndex=-1}}let u=null;n?(!c||S.indexOf(c)<0)&&(u=d||h,S.length&&(s===sn?u=S[0]:this.lastFocus!==h&&s!==Mt||(u=S[S.length-1]))):u=f&&f.type==="image"?h:d||h,u&&wa(u),this.lastFocus=document.activeElement,this.ignoreFocusChange=!1}next(){const n=this.carousel;n&&n.pages.length>1&&n.slideNext()}prev(){const n=this.carousel;n&&n.pages.length>1&&n.slidePrev()}jumpTo(...n){this.carousel&&this.carousel.slideTo(...n)}isTopmost(){var n;return((n=Fe.getInstance())===null||n===void 0?void 0:n.id)==this.id}animate(n=null,r="",s){if(!n||!r)return void(s&&s());this.stop(n);const c=h=>{h.target===n&&n.dataset.animationName&&(n.removeEventListener("animationend",c),delete n.dataset.animationName,s&&s(),Ve(n,r))};n.dataset.animationName=r,n.addEventListener("animationend",c),Ce(n,r)}stop(n){n&&n.dispatchEvent(new CustomEvent("animationend",{bubbles:!1,cancelable:!0,currentTarget:n}))}setContent(n,r="",s=!0){if(this.isClosing())return;const c=n.el;if(!c)return;let h=null;if(vt(r)?h=r:(h=Bt(r+""),vt(h)||(h=document.createElement("div"),h.innerHTML=r+"")),["img","picture","iframe","video","audio"].includes(h.nodeName.toLowerCase())){const m=document.createElement("div");m.appendChild(h),h=m}vt(h)&&n.filter&&!n.error&&(h=h.querySelector(n.filter)),h&&vt(h)?(Ce(h,"fancybox__content"),n.id&&h.setAttribute("id",n.id),c.classList.add(`has-${n.error?"error":n.type||"unknown"}`),c.prepend(h),h.style.display==="none"&&(h.style.display=""),getComputedStyle(h).getPropertyValue("display")==="none"&&(h.style.display=n.display||this.option("defaultDisplay")||"flex"),n.contentEl=h,s&&this.revealContent(n),this.manageCloseBtn(n),this.manageCaption(n)):this.setError(n,"{{ELEMENT_NOT_FOUND}}")}revealContent(n,r){const s=n.el,c=n.contentEl;s&&c&&(this.emit("reveal",n),this.hideLoading(n),n.state=ht.Opening,(r=this.isOpeningSlide(n)?r===void 0?this.optionFor(n,"showClass"):r:"f-fadeIn")?this.animate(c,r,()=>{this.done(n)}):this.done(n))}done(n){this.isClosing()||(n.state=ht.Ready,this.emit("done",n),Ce(n.el,"is-done"),this.isCurrentSlide(n)&&this.option("autoFocus")&&queueMicrotask(()=>{var r;(r=n.panzoom)===null||r===void 0||r.updateControls(),this.option("autoFocus")&&this.focus()}),this.isOpeningSlide(n)&&(Ve(this.container,fr),!this.isCompact&&this.option("idle")&&this.setIdle()))}isCurrentSlide(n){const r=this.getSlide();return!(!n||!r)&&r.index===n.index}isOpeningSlide(n){var r,s;return((r=this.carousel)===null||r===void 0?void 0:r.prevPage)===null&&n&&n.index===((s=this.getSlide())===null||s===void 0?void 0:s.index)}showLoading(n){n.state=ht.Loading;const r=n.el;r&&(Ce(r,Pa),this.emit("loading",n),n.spinnerEl||setTimeout(()=>{if(!this.isClosing()&&!n.spinnerEl&&n.state===ht.Loading){let s=Bt(Tr);Ce(s,"fancybox-spinner"),n.spinnerEl=s,r.prepend(s),this.animate(s,"f-fadeIn")}},250))}hideLoading(n){const r=n.el;if(!r)return;const s=n.spinnerEl;this.isClosing()?s==null||s.remove():(Ve(r,Pa),s&&this.animate(s,"f-fadeOut",()=>{s.remove()}),n.state===ht.Loading&&(this.emit("loaded",n),n.state=ht.Ready))}setError(n,r){if(this.isClosing())return;const s=new Event("error",{bubbles:!0,cancelable:!0});if(this.emit("error",s,n),s.defaultPrevented)return;n.error=r,this.hideLoading(n),this.clearContent(n);const c=document.createElement("div");c.classList.add("fancybox-error"),c.innerHTML=this.localize(r||"<p>{{ERROR}}</p>"),this.setContent(n,c)}clearContent(n){if(n.state===void 0)return;this.emit("clearContent",n),n.contentEl&&(n.contentEl.remove(),n.contentEl=void 0);const r=n.el;r&&(Ve(r,"has-error"),Ve(r,"has-unknown"),Ve(r,`has-${n.type||"unknown"}`)),n.closeBtnEl&&n.closeBtnEl.remove(),n.closeBtnEl=void 0,n.captionEl&&n.captionEl.remove(),n.captionEl=void 0,n.spinnerEl&&n.spinnerEl.remove(),n.spinnerEl=void 0}getSlide(){var n;const r=this.carousel;return((n=r==null?void 0:r.pages[r==null?void 0:r.page])===null||n===void 0?void 0:n.slides[0])||void 0}close(n,r){if(this.isClosing())return;const s=new Event("shouldClose",{bubbles:!0,cancelable:!0});if(this.emit("shouldClose",s,n),s.defaultPrevented)return;n&&n.cancelable&&(n.preventDefault(),n.stopPropagation());const c=()=>{this.proceedClose(n,r)};this.startedFs&&xt&&xt.isFullscreen()?Promise.resolve(xt.exit()).then(()=>c()):c()}clearIdle(){this.idleTimer&&clearTimeout(this.idleTimer),this.idleTimer=null}setIdle(n=!1){const r=()=>{this.clearIdle(),this.idle=!0,Ce(this.container,"is-idle"),this.emit("setIdle")};if(this.clearIdle(),!this.isClosing())if(n)r();else{const s=this.option("idle");s&&(this.idleTimer=setTimeout(r,s))}}endIdle(){this.clearIdle(),this.idle&&!this.isClosing()&&(this.idle=!1,Ve(this.container,"is-idle"),this.emit("endIdle"))}resetIdle(){this.endIdle(),this.setIdle()}toggleIdle(){this.idle?this.endIdle():this.setIdle(!0)}toggleFullscreen(){xt&&(xt.isFullscreen()?xt.exit():xt.request().then(()=>{this.startedFs=!0}))}isClosing(){return[lt.Closing,lt.CustomClosing,lt.Destroy].includes(this.state)}proceedClose(n,r){var s,c;this.state=lt.Closing,this.clearIdle(),this.detachEvents();const h=this.container,m=this.carousel,f=this.getSlide(),w=f&&this.option("placeFocusBack")?f.triggerEl||this.option("triggerEl"):null;if(w&&(io(w)?wa(w):w.focus()),h&&(Ve(h,fr),Ce(h,"is-closing"),h.setAttribute(cr,"true"),this.option("animated")&&Ce(h,dr),h.style.pointerEvents="none"),m){m.clearTransitions(),(s=m.panzoom)===null||s===void 0||s.destroy(),(c=m.plugins.Navigation)===null||c===void 0||c.detach();for(const T of m.slides){T.state=ht.Closing,this.hideLoading(T);const S=T.contentEl;S&&this.stop(S);const d=T==null?void 0:T.panzoom;d&&(d.stop(),d.detachEvents(),d.detachObserver()),this.isCurrentSlide(T)||m.emit("removeSlide",T)}}ja=window.scrollX,Ba=window.scrollY,window.addEventListener("scroll",this.onScroll),this.emit("close",n),this.state!==lt.CustomClosing?(r===void 0&&f&&(r=this.optionFor(f,"hideClass")),r&&f?(this.animate(f.contentEl,r,()=>{m&&m.emit("removeSlide",f)}),setTimeout(()=>{this.destroy()},500)):this.destroy()):setTimeout(()=>{this.destroy()},500)}destroy(){var n;if(this.state===lt.Destroy)return;window.removeEventListener("scroll",this.onScroll),this.state=lt.Destroy,(n=this.carousel)===null||n===void 0||n.destroy();const r=this.container;r&&r.remove(),Mn.delete(this.id);const s=Fe.getInstance();s?s.focus():(Mt&&(Mt.remove(),Mt=null),sn&&(sn.remove(),sn=null),Ve(document.documentElement,La),(()=>{if(!Wn)return;const c=document,h=c.body;h.classList.remove(lr),h.style.setProperty(Da,""),c.documentElement.style.setProperty(Aa,"")})(),this.emit("destroy"))}static bind(n,r,s){if(!Wn)return;let c,h="",m={};if(n===void 0?c=document.body:Qt(n)?(c=document.body,h=n,typeof r=="object"&&(m=r||{})):(c=n,Qt(r)&&(h=r),typeof s=="object"&&(m=s||{})),!c||!vt(c))return;h=h||"[data-fancybox]";const f=Fe.openers.get(c)||new Map;f.set(h,m),Fe.openers.set(c,f),f.size===1&&c.addEventListener("click",Fe.fromEvent)}static unbind(n,r){let s,c="";if(Qt(n)?(s=document.body,c=n):(s=n,Qt(r)&&(c=r)),!s)return;const h=Fe.openers.get(s);h&&c&&h.delete(c),c&&h||(Fe.openers.delete(s),s.removeEventListener("click",Fe.fromEvent))}static destroy(){let n;for(;n=Fe.getInstance();)n.destroy();for(const r of Fe.openers.keys())r.removeEventListener("click",Fe.fromEvent);Fe.openers=new Map}static fromEvent(n){if(n.defaultPrevented||n.button&&n.button!==0||n.ctrlKey||n.metaKey||n.shiftKey)return;let r=n.composedPath()[0];const s=r.closest("[data-fancybox-trigger]");if(s){const g=s.dataset.fancyboxTrigger||"",v=document.querySelectorAll(`[data-fancybox="${g}"]`),b=parseInt(s.dataset.fancyboxIndex||"",10)||0;r=v[b]||r}if(!(r&&r instanceof Element))return;let c,h,m,f;if([...Fe.openers].reverse().find(([g,v])=>!(!g.contains(r)||![...v].reverse().find(([b,k])=>{let M=r.closest(b);return!!M&&(c=g,h=b,m=M,f=k,!0)}))),!c||!h||!m)return;f=f||{},n.preventDefault(),r=m;let w=[],T=yt({},vr,f);T.event=n,T.triggerEl=r,T.delegate=s;const S=T.groupAll,d=T.groupAttr,u=d&&r?r.getAttribute(`${d}`):"";if((!r||u||S)&&(w=[].slice.call(c.querySelectorAll(h))),r&&!S&&(w=u?w.filter(g=>g.getAttribute(`${d}`)===u):[r]),!w.length)return;const p=Fe.getInstance();return p&&p.options.triggerEl&&w.indexOf(p.options.triggerEl)>-1?void 0:(r&&(T.startIndex=w.indexOf(r)),Fe.fromNodes(w,T))}static fromSelector(n,r,s){let c=null,h="",m={};if(Qt(n)?(c=document.body,h=n,typeof r=="object"&&(m=r||{})):n instanceof HTMLElement&&Qt(r)&&(c=n,h=r,typeof s=="object"&&(m=s||{})),!c||!h)return!1;const f=Fe.openers.get(c);return!!f&&(m=yt({},f.get(h)||{},m),!!m&&Fe.fromNodes(Array.from(c.querySelectorAll(h)),m))}static fromNodes(n,r){r=yt({},vr,r||{});const s=[];for(const c of n){const h=c.dataset||{},m=h[xn]||c.getAttribute(hr)||c.getAttribute("currentSrc")||c.getAttribute(xn)||void 0;let f;const w=r.delegate;let T;w&&s.length===r.startIndex&&(f=w instanceof HTMLImageElement?w:w.querySelector("img:not([aria-hidden])")),f||(f=c instanceof HTMLImageElement?c:c.querySelector("img:not([aria-hidden])")),f&&(T=f.currentSrc||f[xn]||void 0,!T&&f.dataset&&(T=f.dataset.lazySrc||f.dataset[xn]||void 0));const S={src:m,triggerEl:c,thumbEl:f,thumbElSrc:T,thumbSrc:T};for(const d in h){let u=h[d]+"";u=u!=="false"&&(u==="true"||u),S[d]=u}s.push(S)}return new Fe(s,r)}static getInstance(n){return n?Mn.get(n):Array.from(Mn.values()).reverse().find(r=>!r.isClosing()&&r)||null}static getSlide(){var n;return((n=Fe.getInstance())===null||n===void 0?void 0:n.getSlide())||null}static show(n=[],r={}){return new Fe(n,r)}static next(){const n=Fe.getInstance();n&&n.next()}static prev(){const n=Fe.getInstance();n&&n.prev()}static close(n=!0,...r){if(n)for(const s of Mn.values())s.close(...r);else{const s=Fe.getInstance();s&&s.close(...r)}}}Object.defineProperty(Fe,"version",{enumerable:!0,configurable:!0,writable:!0,value:"5.0.36"}),Object.defineProperty(Fe,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:vr}),Object.defineProperty(Fe,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:Yl}),Object.defineProperty(Fe,"openers",{enumerable:!0,configurable:!0,writable:!0,value:new Map});function Gl(C){return C&&C.__esModule&&Object.prototype.hasOwnProperty.call(C,"default")?C.default:C}var xi={exports:{}};/*!
 * Vditor v3.10.9 - A markdown editor written in TypeScript.
 *
 * MIT License
 *
 * Copyright (c) 2018-present B3log 开源, b3log.org
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */var Zl=xi.exports,za;function Xl(){return za||(za=1,function(C,n){(function(s,c){C.exports=c()})(Zl,()=>(()=>{var r={192:m=>{var f=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},w=-1,T=1,S=0;f.Diff=function(d,u){return[d,u]},f.prototype.diff_main=function(d,u,p,g){typeof g>"u"&&(this.Diff_Timeout<=0?g=Number.MAX_VALUE:g=new Date().getTime()+this.Diff_Timeout*1e3);var v=g;if(d==null||u==null)throw new Error("Null input. (diff_main)");if(d==u)return d?[new f.Diff(S,d)]:[];typeof p>"u"&&(p=!0);var b=p,k=this.diff_commonPrefix(d,u),M=d.substring(0,k);d=d.substring(k),u=u.substring(k),k=this.diff_commonSuffix(d,u);var _=d.substring(d.length-k);d=d.substring(0,d.length-k),u=u.substring(0,u.length-k);var x=this.diff_compute_(d,u,b,v);return M&&x.unshift(new f.Diff(S,M)),_&&x.push(new f.Diff(S,_)),this.diff_cleanupMerge(x),x},f.prototype.diff_compute_=function(d,u,p,g){var v;if(!d)return[new f.Diff(T,u)];if(!u)return[new f.Diff(w,d)];var b=d.length>u.length?d:u,k=d.length>u.length?u:d,M=b.indexOf(k);if(M!=-1)return v=[new f.Diff(T,b.substring(0,M)),new f.Diff(S,k),new f.Diff(T,b.substring(M+k.length))],d.length>u.length&&(v[0][0]=v[2][0]=w),v;if(k.length==1)return[new f.Diff(w,d),new f.Diff(T,u)];var _=this.diff_halfMatch_(d,u);if(_){var x=_[0],y=_[1],O=_[2],N=_[3],F=_[4],R=this.diff_main(x,O,p,g),I=this.diff_main(y,N,p,g);return R.concat([new f.Diff(S,F)],I)}return p&&d.length>100&&u.length>100?this.diff_lineMode_(d,u,g):this.diff_bisect_(d,u,g)},f.prototype.diff_lineMode_=function(d,u,p){var g=this.diff_linesToChars_(d,u);d=g.chars1,u=g.chars2;var v=g.lineArray,b=this.diff_main(d,u,!1,p);this.diff_charsToLines_(b,v),this.diff_cleanupSemantic(b),b.push(new f.Diff(S,""));for(var k=0,M=0,_=0,x="",y="";k<b.length;){switch(b[k][0]){case T:_++,y+=b[k][1];break;case w:M++,x+=b[k][1];break;case S:if(M>=1&&_>=1){b.splice(k-M-_,M+_),k=k-M-_;for(var O=this.diff_main(x,y,!1,p),N=O.length-1;N>=0;N--)b.splice(k,0,O[N]);k=k+O.length}_=0,M=0,x="",y="";break}k++}return b.pop(),b},f.prototype.diff_bisect_=function(d,u,p){for(var g=d.length,v=u.length,b=Math.ceil((g+v)/2),k=b,M=2*b,_=new Array(M),x=new Array(M),y=0;y<M;y++)_[y]=-1,x[y]=-1;_[k+1]=0,x[k+1]=0;for(var O=g-v,N=O%2!=0,F=0,R=0,I=0,j=0,q=0;q<b&&!(new Date().getTime()>p);q++){for(var ne=-q+F;ne<=q-R;ne+=2){var ce=k+ne,ke;ne==-q||ne!=q&&_[ce-1]<_[ce+1]?ke=_[ce+1]:ke=_[ce-1]+1;for(var Se=ke-ne;ke<g&&Se<v&&d.charAt(ke)==u.charAt(Se);)ke++,Se++;if(_[ce]=ke,ke>g)R+=2;else if(Se>v)F+=2;else if(N){var Ee=k+O-ne;if(Ee>=0&&Ee<M&&x[Ee]!=-1){var me=g-x[Ee];if(ke>=me)return this.diff_bisectSplit_(d,u,ke,Se,p)}}}for(var Me=-q+I;Me<=q-j;Me+=2){var Ee=k+Me,me;Me==-q||Me!=q&&x[Ee-1]<x[Ee+1]?me=x[Ee+1]:me=x[Ee-1]+1;for(var oe=me-Me;me<g&&oe<v&&d.charAt(g-me-1)==u.charAt(v-oe-1);)me++,oe++;if(x[Ee]=me,me>g)j+=2;else if(oe>v)I+=2;else if(!N){var ce=k+O-Me;if(ce>=0&&ce<M&&_[ce]!=-1){var ke=_[ce],Se=k+ke-ce;if(me=g-me,ke>=me)return this.diff_bisectSplit_(d,u,ke,Se,p)}}}}return[new f.Diff(w,d),new f.Diff(T,u)]},f.prototype.diff_bisectSplit_=function(d,u,p,g,v){var b=d.substring(0,p),k=u.substring(0,g),M=d.substring(p),_=u.substring(g),x=this.diff_main(b,k,!1,v),y=this.diff_main(M,_,!1,v);return x.concat(y)},f.prototype.diff_linesToChars_=function(d,u){var p=[],g={};p[0]="";function v(_){for(var x="",y=0,O=-1,N=p.length;O<_.length-1;){O=_.indexOf(`
`,y),O==-1&&(O=_.length-1);var F=_.substring(y,O+1);(g.hasOwnProperty?g.hasOwnProperty(F):g[F]!==void 0)?x+=String.fromCharCode(g[F]):(N==b&&(F=_.substring(y),O=_.length),x+=String.fromCharCode(N),g[F]=N,p[N++]=F),y=O+1}return x}var b=4e4,k=v(d);b=65535;var M=v(u);return{chars1:k,chars2:M,lineArray:p}},f.prototype.diff_charsToLines_=function(d,u){for(var p=0;p<d.length;p++){for(var g=d[p][1],v=[],b=0;b<g.length;b++)v[b]=u[g.charCodeAt(b)];d[p][1]=v.join("")}},f.prototype.diff_commonPrefix=function(d,u){if(!d||!u||d.charAt(0)!=u.charAt(0))return 0;for(var p=0,g=Math.min(d.length,u.length),v=g,b=0;p<v;)d.substring(b,v)==u.substring(b,v)?(p=v,b=p):g=v,v=Math.floor((g-p)/2+p);return v},f.prototype.diff_commonSuffix=function(d,u){if(!d||!u||d.charAt(d.length-1)!=u.charAt(u.length-1))return 0;for(var p=0,g=Math.min(d.length,u.length),v=g,b=0;p<v;)d.substring(d.length-v,d.length-b)==u.substring(u.length-v,u.length-b)?(p=v,b=p):g=v,v=Math.floor((g-p)/2+p);return v},f.prototype.diff_commonOverlap_=function(d,u){var p=d.length,g=u.length;if(p==0||g==0)return 0;p>g?d=d.substring(p-g):p<g&&(u=u.substring(0,p));var v=Math.min(p,g);if(d==u)return v;for(var b=0,k=1;;){var M=d.substring(v-k),_=u.indexOf(M);if(_==-1)return b;k+=_,(_==0||d.substring(v-k)==u.substring(0,k))&&(b=k,k++)}},f.prototype.diff_halfMatch_=function(d,u){if(this.Diff_Timeout<=0)return null;var p=d.length>u.length?d:u,g=d.length>u.length?u:d;if(p.length<4||g.length*2<p.length)return null;var v=this;function b(R,I,j){for(var q=R.substring(j,j+Math.floor(R.length/4)),ne=-1,ce="",ke,Se,Ee,me;(ne=I.indexOf(q,ne+1))!=-1;){var Me=v.diff_commonPrefix(R.substring(j),I.substring(ne)),oe=v.diff_commonSuffix(R.substring(0,j),I.substring(0,ne));ce.length<oe+Me&&(ce=I.substring(ne-oe,ne)+I.substring(ne,ne+Me),ke=R.substring(0,j-oe),Se=R.substring(j+Me),Ee=I.substring(0,ne-oe),me=I.substring(ne+Me))}return ce.length*2>=R.length?[ke,Se,Ee,me,ce]:null}var k=b(p,g,Math.ceil(p.length/4)),M=b(p,g,Math.ceil(p.length/2)),_;if(!k&&!M)return null;M?k?_=k[4].length>M[4].length?k:M:_=M:_=k;var x,y,O,N;d.length>u.length?(x=_[0],y=_[1],O=_[2],N=_[3]):(O=_[0],N=_[1],x=_[2],y=_[3]);var F=_[4];return[x,y,O,N,F]},f.prototype.diff_cleanupSemantic=function(d){for(var u=!1,p=[],g=0,v=null,b=0,k=0,M=0,_=0,x=0;b<d.length;)d[b][0]==S?(p[g++]=b,k=_,M=x,_=0,x=0,v=d[b][1]):(d[b][0]==T?_+=d[b][1].length:x+=d[b][1].length,v&&v.length<=Math.max(k,M)&&v.length<=Math.max(_,x)&&(d.splice(p[g-1],0,new f.Diff(w,v)),d[p[g-1]+1][0]=T,g--,g--,b=g>0?p[g-1]:-1,k=0,M=0,_=0,x=0,v=null,u=!0)),b++;for(u&&this.diff_cleanupMerge(d),this.diff_cleanupSemanticLossless(d),b=1;b<d.length;){if(d[b-1][0]==w&&d[b][0]==T){var y=d[b-1][1],O=d[b][1],N=this.diff_commonOverlap_(y,O),F=this.diff_commonOverlap_(O,y);N>=F?(N>=y.length/2||N>=O.length/2)&&(d.splice(b,0,new f.Diff(S,O.substring(0,N))),d[b-1][1]=y.substring(0,y.length-N),d[b+1][1]=O.substring(N),b++):(F>=y.length/2||F>=O.length/2)&&(d.splice(b,0,new f.Diff(S,y.substring(0,F))),d[b-1][0]=T,d[b-1][1]=O.substring(0,O.length-F),d[b+1][0]=w,d[b+1][1]=y.substring(F),b++),b++}b++}},f.prototype.diff_cleanupSemanticLossless=function(d){function u(F,R){if(!F||!R)return 6;var I=F.charAt(F.length-1),j=R.charAt(0),q=I.match(f.nonAlphaNumericRegex_),ne=j.match(f.nonAlphaNumericRegex_),ce=q&&I.match(f.whitespaceRegex_),ke=ne&&j.match(f.whitespaceRegex_),Se=ce&&I.match(f.linebreakRegex_),Ee=ke&&j.match(f.linebreakRegex_),me=Se&&F.match(f.blanklineEndRegex_),Me=Ee&&R.match(f.blanklineStartRegex_);return me||Me?5:Se||Ee?4:q&&!ce&&ke?3:ce||ke?2:q||ne?1:0}for(var p=1;p<d.length-1;){if(d[p-1][0]==S&&d[p+1][0]==S){var g=d[p-1][1],v=d[p][1],b=d[p+1][1],k=this.diff_commonSuffix(g,v);if(k){var M=v.substring(v.length-k);g=g.substring(0,g.length-k),v=M+v.substring(0,v.length-k),b=M+b}for(var _=g,x=v,y=b,O=u(g,v)+u(v,b);v.charAt(0)===b.charAt(0);){g+=v.charAt(0),v=v.substring(1)+b.charAt(0),b=b.substring(1);var N=u(g,v)+u(v,b);N>=O&&(O=N,_=g,x=v,y=b)}d[p-1][1]!=_&&(_?d[p-1][1]=_:(d.splice(p-1,1),p--),d[p][1]=x,y?d[p+1][1]=y:(d.splice(p+1,1),p--))}p++}},f.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,f.whitespaceRegex_=/\s/,f.linebreakRegex_=/[\r\n]/,f.blanklineEndRegex_=/\n\r?\n$/,f.blanklineStartRegex_=/^\r?\n\r?\n/,f.prototype.diff_cleanupEfficiency=function(d){for(var u=!1,p=[],g=0,v=null,b=0,k=!1,M=!1,_=!1,x=!1;b<d.length;)d[b][0]==S?(d[b][1].length<this.Diff_EditCost&&(_||x)?(p[g++]=b,k=_,M=x,v=d[b][1]):(g=0,v=null),_=x=!1):(d[b][0]==w?x=!0:_=!0,v&&(k&&M&&_&&x||v.length<this.Diff_EditCost/2&&k+M+_+x==3)&&(d.splice(p[g-1],0,new f.Diff(w,v)),d[p[g-1]+1][0]=T,g--,v=null,k&&M?(_=x=!0,g=0):(g--,b=g>0?p[g-1]:-1,_=x=!1),u=!0)),b++;u&&this.diff_cleanupMerge(d)},f.prototype.diff_cleanupMerge=function(d){d.push(new f.Diff(S,""));for(var u=0,p=0,g=0,v="",b="",k;u<d.length;)switch(d[u][0]){case T:g++,b+=d[u][1],u++;break;case w:p++,v+=d[u][1],u++;break;case S:p+g>1?(p!==0&&g!==0&&(k=this.diff_commonPrefix(b,v),k!==0&&(u-p-g>0&&d[u-p-g-1][0]==S?d[u-p-g-1][1]+=b.substring(0,k):(d.splice(0,0,new f.Diff(S,b.substring(0,k))),u++),b=b.substring(k),v=v.substring(k)),k=this.diff_commonSuffix(b,v),k!==0&&(d[u][1]=b.substring(b.length-k)+d[u][1],b=b.substring(0,b.length-k),v=v.substring(0,v.length-k))),u-=p+g,d.splice(u,p+g),v.length&&(d.splice(u,0,new f.Diff(w,v)),u++),b.length&&(d.splice(u,0,new f.Diff(T,b)),u++),u++):u!==0&&d[u-1][0]==S?(d[u-1][1]+=d[u][1],d.splice(u,1)):u++,g=0,p=0,v="",b="";break}d[d.length-1][1]===""&&d.pop();var M=!1;for(u=1;u<d.length-1;)d[u-1][0]==S&&d[u+1][0]==S&&(d[u][1].substring(d[u][1].length-d[u-1][1].length)==d[u-1][1]?(d[u][1]=d[u-1][1]+d[u][1].substring(0,d[u][1].length-d[u-1][1].length),d[u+1][1]=d[u-1][1]+d[u+1][1],d.splice(u-1,1),M=!0):d[u][1].substring(0,d[u+1][1].length)==d[u+1][1]&&(d[u-1][1]+=d[u+1][1],d[u][1]=d[u][1].substring(d[u+1][1].length)+d[u+1][1],d.splice(u+1,1),M=!0)),u++;M&&this.diff_cleanupMerge(d)},f.prototype.diff_xIndex=function(d,u){var p=0,g=0,v=0,b=0,k;for(k=0;k<d.length&&(d[k][0]!==T&&(p+=d[k][1].length),d[k][0]!==w&&(g+=d[k][1].length),!(p>u));k++)v=p,b=g;return d.length!=k&&d[k][0]===w?b:b+(u-v)},f.prototype.diff_prettyHtml=function(d){for(var u=[],p=/&/g,g=/</g,v=/>/g,b=/\n/g,k=0;k<d.length;k++){var M=d[k][0],_=d[k][1],x=_.replace(p,"&amp;").replace(g,"&lt;").replace(v,"&gt;").replace(b,"&para;<br>");switch(M){case T:u[k]='<ins style="background:#e6ffe6;">'+x+"</ins>";break;case w:u[k]='<del style="background:#ffe6e6;">'+x+"</del>";break;case S:u[k]="<span>"+x+"</span>";break}}return u.join("")},f.prototype.diff_text1=function(d){for(var u=[],p=0;p<d.length;p++)d[p][0]!==T&&(u[p]=d[p][1]);return u.join("")},f.prototype.diff_text2=function(d){for(var u=[],p=0;p<d.length;p++)d[p][0]!==w&&(u[p]=d[p][1]);return u.join("")},f.prototype.diff_levenshtein=function(d){for(var u=0,p=0,g=0,v=0;v<d.length;v++){var b=d[v][0],k=d[v][1];switch(b){case T:p+=k.length;break;case w:g+=k.length;break;case S:u+=Math.max(p,g),p=0,g=0;break}}return u+=Math.max(p,g),u},f.prototype.diff_toDelta=function(d){for(var u=[],p=0;p<d.length;p++)switch(d[p][0]){case T:u[p]="+"+encodeURI(d[p][1]);break;case w:u[p]="-"+d[p][1].length;break;case S:u[p]="="+d[p][1].length;break}return u.join("	").replace(/%20/g," ")},f.prototype.diff_fromDelta=function(d,u){for(var p=[],g=0,v=0,b=u.split(/\t/g),k=0;k<b.length;k++){var M=b[k].substring(1);switch(b[k].charAt(0)){case"+":try{p[g++]=new f.Diff(T,decodeURI(M))}catch{throw new Error("Illegal escape in diff_fromDelta: "+M)}break;case"-":case"=":var _=parseInt(M,10);if(isNaN(_)||_<0)throw new Error("Invalid number in diff_fromDelta: "+M);var x=d.substring(v,v+=_);b[k].charAt(0)=="="?p[g++]=new f.Diff(S,x):p[g++]=new f.Diff(w,x);break;default:if(b[k])throw new Error("Invalid diff operation in diff_fromDelta: "+b[k])}}if(v!=d.length)throw new Error("Delta length ("+v+") does not equal source text length ("+d.length+").");return p},f.prototype.match_main=function(d,u,p){if(d==null||u==null||p==null)throw new Error("Null input. (match_main)");return p=Math.max(0,Math.min(p,d.length)),d==u?0:d.length?d.substring(p,p+u.length)==u?p:this.match_bitap_(d,u,p):-1},f.prototype.match_bitap_=function(d,u,p){if(u.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var g=this.match_alphabet_(u),v=this;function b(ke,Se){var Ee=ke/u.length,me=Math.abs(p-Se);return v.Match_Distance?Ee+me/v.Match_Distance:me?1:Ee}var k=this.Match_Threshold,M=d.indexOf(u,p);M!=-1&&(k=Math.min(b(0,M),k),M=d.lastIndexOf(u,p+u.length),M!=-1&&(k=Math.min(b(0,M),k)));var _=1<<u.length-1;M=-1;for(var x,y,O=u.length+d.length,N,F=0;F<u.length;F++){for(x=0,y=O;x<y;)b(F,p+y)<=k?x=y:O=y,y=Math.floor((O-x)/2+x);O=y;var R=Math.max(1,p-y+1),I=Math.min(p+y,d.length)+u.length,j=Array(I+2);j[I+1]=(1<<F)-1;for(var q=I;q>=R;q--){var ne=g[d.charAt(q-1)];if(F===0?j[q]=(j[q+1]<<1|1)&ne:j[q]=(j[q+1]<<1|1)&ne|((N[q+1]|N[q])<<1|1)|N[q+1],j[q]&_){var ce=b(F,q-1);if(ce<=k)if(k=ce,M=q-1,M>p)R=Math.max(1,2*p-M);else break}}if(b(F+1,p)>k)break;N=j}return M},f.prototype.match_alphabet_=function(d){for(var u={},p=0;p<d.length;p++)u[d.charAt(p)]=0;for(var p=0;p<d.length;p++)u[d.charAt(p)]|=1<<d.length-p-1;return u},f.prototype.patch_addContext_=function(d,u){if(u.length!=0){if(d.start2===null)throw Error("patch not initialized");for(var p=u.substring(d.start2,d.start2+d.length1),g=0;u.indexOf(p)!=u.lastIndexOf(p)&&p.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)g+=this.Patch_Margin,p=u.substring(d.start2-g,d.start2+d.length1+g);g+=this.Patch_Margin;var v=u.substring(d.start2-g,d.start2);v&&d.diffs.unshift(new f.Diff(S,v));var b=u.substring(d.start2+d.length1,d.start2+d.length1+g);b&&d.diffs.push(new f.Diff(S,b)),d.start1-=v.length,d.start2-=v.length,d.length1+=v.length+b.length,d.length2+=v.length+b.length}},f.prototype.patch_make=function(d,u,p){var g,v;if(typeof d=="string"&&typeof u=="string"&&typeof p>"u")g=d,v=this.diff_main(g,u,!0),v.length>2&&(this.diff_cleanupSemantic(v),this.diff_cleanupEfficiency(v));else if(d&&typeof d=="object"&&typeof u>"u"&&typeof p>"u")v=d,g=this.diff_text1(v);else if(typeof d=="string"&&u&&typeof u=="object"&&typeof p>"u")g=d,v=u;else if(typeof d=="string"&&typeof u=="string"&&p&&typeof p=="object")g=d,v=p;else throw new Error("Unknown call format to patch_make.");if(v.length===0)return[];for(var b=[],k=new f.patch_obj,M=0,_=0,x=0,y=g,O=g,N=0;N<v.length;N++){var F=v[N][0],R=v[N][1];switch(!M&&F!==S&&(k.start1=_,k.start2=x),F){case T:k.diffs[M++]=v[N],k.length2+=R.length,O=O.substring(0,x)+R+O.substring(x);break;case w:k.length1+=R.length,k.diffs[M++]=v[N],O=O.substring(0,x)+O.substring(x+R.length);break;case S:R.length<=2*this.Patch_Margin&&M&&v.length!=N+1?(k.diffs[M++]=v[N],k.length1+=R.length,k.length2+=R.length):R.length>=2*this.Patch_Margin&&M&&(this.patch_addContext_(k,y),b.push(k),k=new f.patch_obj,M=0,y=O,_=x);break}F!==T&&(_+=R.length),F!==w&&(x+=R.length)}return M&&(this.patch_addContext_(k,y),b.push(k)),b},f.prototype.patch_deepCopy=function(d){for(var u=[],p=0;p<d.length;p++){var g=d[p],v=new f.patch_obj;v.diffs=[];for(var b=0;b<g.diffs.length;b++)v.diffs[b]=new f.Diff(g.diffs[b][0],g.diffs[b][1]);v.start1=g.start1,v.start2=g.start2,v.length1=g.length1,v.length2=g.length2,u[p]=v}return u},f.prototype.patch_apply=function(d,u){if(d.length==0)return[u,[]];d=this.patch_deepCopy(d);var p=this.patch_addPadding(d);u=p+u+p,this.patch_splitMax(d);for(var g=0,v=[],b=0;b<d.length;b++){var k=d[b].start2+g,M=this.diff_text1(d[b].diffs),_,x=-1;if(M.length>this.Match_MaxBits?(_=this.match_main(u,M.substring(0,this.Match_MaxBits),k),_!=-1&&(x=this.match_main(u,M.substring(M.length-this.Match_MaxBits),k+M.length-this.Match_MaxBits),(x==-1||_>=x)&&(_=-1))):_=this.match_main(u,M,k),_==-1)v[b]=!1,g-=d[b].length2-d[b].length1;else{v[b]=!0,g=_-k;var y;if(x==-1?y=u.substring(_,_+M.length):y=u.substring(_,x+this.Match_MaxBits),M==y)u=u.substring(0,_)+this.diff_text2(d[b].diffs)+u.substring(_+M.length);else{var O=this.diff_main(M,y,!1);if(M.length>this.Match_MaxBits&&this.diff_levenshtein(O)/M.length>this.Patch_DeleteThreshold)v[b]=!1;else{this.diff_cleanupSemanticLossless(O);for(var N=0,F,R=0;R<d[b].diffs.length;R++){var I=d[b].diffs[R];I[0]!==S&&(F=this.diff_xIndex(O,N)),I[0]===T?u=u.substring(0,_+F)+I[1]+u.substring(_+F):I[0]===w&&(u=u.substring(0,_+F)+u.substring(_+this.diff_xIndex(O,N+I[1].length))),I[0]!==w&&(N+=I[1].length)}}}}}return u=u.substring(p.length,u.length-p.length),[u,v]},f.prototype.patch_addPadding=function(d){for(var u=this.Patch_Margin,p="",g=1;g<=u;g++)p+=String.fromCharCode(g);for(var g=0;g<d.length;g++)d[g].start1+=u,d[g].start2+=u;var v=d[0],b=v.diffs;if(b.length==0||b[0][0]!=S)b.unshift(new f.Diff(S,p)),v.start1-=u,v.start2-=u,v.length1+=u,v.length2+=u;else if(u>b[0][1].length){var k=u-b[0][1].length;b[0][1]=p.substring(b[0][1].length)+b[0][1],v.start1-=k,v.start2-=k,v.length1+=k,v.length2+=k}if(v=d[d.length-1],b=v.diffs,b.length==0||b[b.length-1][0]!=S)b.push(new f.Diff(S,p)),v.length1+=u,v.length2+=u;else if(u>b[b.length-1][1].length){var k=u-b[b.length-1][1].length;b[b.length-1][1]+=p.substring(0,k),v.length1+=k,v.length2+=k}return p},f.prototype.patch_splitMax=function(d){for(var u=this.Match_MaxBits,p=0;p<d.length;p++)if(!(d[p].length1<=u)){var g=d[p];d.splice(p--,1);for(var v=g.start1,b=g.start2,k="";g.diffs.length!==0;){var M=new f.patch_obj,_=!0;for(M.start1=v-k.length,M.start2=b-k.length,k!==""&&(M.length1=M.length2=k.length,M.diffs.push(new f.Diff(S,k)));g.diffs.length!==0&&M.length1<u-this.Patch_Margin;){var x=g.diffs[0][0],y=g.diffs[0][1];x===T?(M.length2+=y.length,b+=y.length,M.diffs.push(g.diffs.shift()),_=!1):x===w&&M.diffs.length==1&&M.diffs[0][0]==S&&y.length>2*u?(M.length1+=y.length,v+=y.length,_=!1,M.diffs.push(new f.Diff(x,y)),g.diffs.shift()):(y=y.substring(0,u-M.length1-this.Patch_Margin),M.length1+=y.length,v+=y.length,x===S?(M.length2+=y.length,b+=y.length):_=!1,M.diffs.push(new f.Diff(x,y)),y==g.diffs[0][1]?g.diffs.shift():g.diffs[0][1]=g.diffs[0][1].substring(y.length))}k=this.diff_text2(M.diffs),k=k.substring(k.length-this.Patch_Margin);var O=this.diff_text1(g.diffs).substring(0,this.Patch_Margin);O!==""&&(M.length1+=O.length,M.length2+=O.length,M.diffs.length!==0&&M.diffs[M.diffs.length-1][0]===S?M.diffs[M.diffs.length-1][1]+=O:M.diffs.push(new f.Diff(S,O))),_||d.splice(++p,0,M)}}},f.prototype.patch_toText=function(d){for(var u=[],p=0;p<d.length;p++)u[p]=d[p];return u.join("")},f.prototype.patch_fromText=function(d){var u=[];if(!d)return u;for(var p=d.split(`
`),g=0,v=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;g<p.length;){var b=p[g].match(v);if(!b)throw new Error("Invalid patch string: "+p[g]);var k=new f.patch_obj;for(u.push(k),k.start1=parseInt(b[1],10),b[2]===""?(k.start1--,k.length1=1):b[2]=="0"?k.length1=0:(k.start1--,k.length1=parseInt(b[2],10)),k.start2=parseInt(b[3],10),b[4]===""?(k.start2--,k.length2=1):b[4]=="0"?k.length2=0:(k.start2--,k.length2=parseInt(b[4],10)),g++;g<p.length;){var M=p[g].charAt(0);try{var _=decodeURI(p[g].substring(1))}catch{throw new Error("Illegal escape in patch_fromText: "+_)}if(M=="-")k.diffs.push(new f.Diff(w,_));else if(M=="+")k.diffs.push(new f.Diff(T,_));else if(M==" ")k.diffs.push(new f.Diff(S,_));else{if(M=="@")break;if(M!=="")throw new Error('Invalid patch mode "'+M+'" in: '+_)}g++}}return u},f.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},f.patch_obj.prototype.toString=function(){var d,u;this.length1===0?d=this.start1+",0":this.length1==1?d=this.start1+1:d=this.start1+1+","+this.length1,this.length2===0?u=this.start2+",0":this.length2==1?u=this.start2+1:u=this.start2+1+","+this.length2;for(var p=["@@ -"+d+" +"+u+` @@
`],g,v=0;v<this.diffs.length;v++){switch(this.diffs[v][0]){case T:g="+";break;case w:g="-";break;case S:g=" ";break}p[v+1]=g+encodeURI(this.diffs[v][1])+`
`}return p.join("").replace(/%20/g," ")},m.exports=f,m.exports.diff_match_patch=f,m.exports.DIFF_DELETE=w,m.exports.DIFF_INSERT=T,m.exports.DIFF_EQUAL=S},923:(m,f,w)=>{w.d(f,{default:()=>J});var T=w(288),S=w(59),d=w(784),u=w(51),p=w(500),g=w(339),v=w(108),b=function(z){z===void 0&&(z=document);var Q=function(K){var B=document.createElement("img");B.src=K.getAttribute("data-src"),B.addEventListener("load",function(){!K.getAttribute("style")&&!K.getAttribute("class")&&!K.getAttribute("width")&&!K.getAttribute("height")&&B.naturalHeight>B.naturalWidth&&B.naturalWidth/B.naturalHeight<document.querySelector(".vditor-reset").clientWidth/(window.innerHeight-40)&&B.naturalHeight>window.innerHeight-40&&(K.style.height=window.innerHeight-40+"px"),K.src=B.src}),K.removeAttribute("data-src")};if(!("IntersectionObserver"in window))return z.querySelectorAll("img").forEach(function(K){K.getAttribute("data-src")&&Q(K)}),!1;window.vditorImageIntersectionObserver?(window.vditorImageIntersectionObserver.disconnect(),z.querySelectorAll("img").forEach(function(K){window.vditorImageIntersectionObserver.observe(K)})):(window.vditorImageIntersectionObserver=new IntersectionObserver(function(K){K.forEach(function(B){(typeof B.isIntersecting>"u"?B.intersectionRatio!==0:B.isIntersecting)&&B.target.getAttribute("data-src")&&Q(B.target)})}),z.querySelectorAll("img").forEach(function(K){window.vditorImageIntersectionObserver.observe(K)}))},k=w(960),M=w(0),_=w(975),x=w(931),y=w(597),O=w(162),N=w(70),F=w(591),R=w(913),I=w(873),j=w(161),q=w(598),ne=w(905),ce=function(z){document.querySelectorAll(".vditor-anchor").forEach(function(Q){z===1&&Q.classList.add("vditor-anchor--left"),Q.onclick=function(){var K=Q.getAttribute("href").substr(1),B=document.getElementById("vditorAnchor-"+K).offsetTop;document.querySelector("html").scrollTop=B}}),window.onhashchange=function(){var Q=document.getElementById("vditorAnchor-"+decodeURIComponent(window.location.hash.substr(1)));Q&&(document.querySelector("html").scrollTop=Q.offsetTop)}},ke=w(796),Se=w(827),Ee=function(z,Q){if(Q===void 0&&(Q="zh_CN"),!(typeof speechSynthesis>"u"||typeof SpeechSynthesisUtterance>"u")){var K=function(){var $=speechSynthesis.getVoices(),W,X;return $.forEach(function(we){we.lang===Q.replace("_","-")&&(W=we),we.default&&(X=we)}),W||(W=X),W},B='<svg><use xlink:href="#vditor-icon-play"></use></svg>',Te='<svg><use xlink:href="#vditor-icon-pause"></use></svg>';document.getElementById("vditorIconScript")||(B='<svg viewBox="0 0 32 32"><path d="M3.436 0l25.128 16-25.128 16v-32z"></path></svg>',Te='<svg viewBox="0 0 32 32"><path d="M20.617 0h9.128v32h-9.128v-32zM2.255 32v-32h9.128v32h-9.128z"></path></svg>');var se=document.querySelector(".vditor-speech");se||(se=document.createElement("button"),se.className="vditor-speech",z.insertAdjacentElement("beforeend",se),speechSynthesis.onvoiceschanged!==void 0&&(speechSynthesis.onvoiceschanged=K));var je=K(),V=new SpeechSynthesisUtterance;V.voice=je,V.onend=V.onerror=function(){se.style.display="none",speechSynthesis.cancel(),se.classList.remove("vditor-speech--current"),se.innerHTML=B},z.addEventListener(window.ontouchstart!==void 0?"touchend":"click",function($){var W=$.target;if(W.classList.contains("vditor-speech")||W.parentElement.classList.contains("vditor-speech")){se.classList.contains("vditor-speech--current")?speechSynthesis.speaking&&(speechSynthesis.paused?(speechSynthesis.resume(),se.innerHTML=Te):(speechSynthesis.pause(),se.innerHTML=B)):(V.text=se.getAttribute("data-text"),speechSynthesis.speak(V),se.classList.add("vditor-speech--current"),se.innerHTML=Te),(0,Se.jl)(window.vditorSpeechRange),z.focus();return}if(se.style.display="none",speechSynthesis.cancel(),se.classList.remove("vditor-speech--current"),se.innerHTML=B,getSelection().rangeCount!==0){var X=getSelection().getRangeAt(0),we=X.toString().trim();if(we){window.vditorSpeechRange=X.cloneRange();var Oe=X.getBoundingClientRect();se.innerHTML=B,se.style.display="block",se.style.top=Oe.top+Oe.height+document.querySelector("html").scrollTop-20+"px",window.ontouchstart!==void 0?se.style.left=$.changedTouches[$.changedTouches.length-1].pageX+2+"px":se.style.left=$.clientX+2+"px",se.setAttribute("data-text",we)}}})}},me=function(z,Q,K,B){function Te(se){return se instanceof K?se:new K(function(je){je(se)})}return new(K||(K=Promise))(function(se,je){function V(X){try{W(B.next(X))}catch(we){je(we)}}function $(X){try{W(B.throw(X))}catch(we){je(we)}}function W(X){X.done?se(X.value):Te(X.value).then(V,$)}W((B=B.apply(z,Q||[])).next())})},Me=function(z,Q){var K={label:0,sent:function(){if(se[0]&1)throw se[1];return se[1]},trys:[],ops:[]},B,Te,se,je;return je={next:V(0),throw:V(1),return:V(2)},typeof Symbol=="function"&&(je[Symbol.iterator]=function(){return this}),je;function V(W){return function(X){return $([W,X])}}function $(W){if(B)throw new TypeError("Generator is already executing.");for(;je&&(je=0,W[0]&&(K=0)),K;)try{if(B=1,Te&&(se=W[0]&2?Te.return:W[0]?Te.throw||((se=Te.return)&&se.call(Te),0):Te.next)&&!(se=se.call(Te,W[1])).done)return se;switch(Te=0,se&&(W=[W[0]&2,se.value]),W[0]){case 0:case 1:se=W;break;case 4:return K.label++,{value:W[1],done:!1};case 5:K.label++,Te=W[1],W=[0];continue;case 7:W=K.ops.pop(),K.trys.pop();continue;default:if(se=K.trys,!(se=se.length>0&&se[se.length-1])&&(W[0]===6||W[0]===2)){K=0;continue}if(W[0]===3&&(!se||W[1]>se[0]&&W[1]<se[3])){K.label=W[1];break}if(W[0]===6&&K.label<se[1]){K.label=se[1],se=W;break}if(se&&K.label<se[2]){K.label=se[2],K.ops.push(W);break}se[2]&&K.ops.pop(),K.trys.pop();continue}W=Q.call(z,K)}catch(X){W=[6,X],Te=0}finally{B=se=0}if(W[0]&5)throw W[1];return{value:W[0]?W[1]:void 0,done:!0}}},oe=function(z){var Q,K={anchor:0,cdn:R.Y.CDN,customEmoji:{},emojiPath:"".concat(R.Y.CDN,"/dist/images/emoji"),hljs:R.Y.HLJS_OPTIONS,icon:"ant",lang:"zh_CN",markdown:R.Y.MARKDOWN_OPTIONS,math:R.Y.MATH_OPTIONS,mode:"light",speech:{enable:!1},render:{media:{enable:!0}},theme:R.Y.THEME_OPTIONS};return z.cdn&&(!((Q=z.theme)===null||Q===void 0)&&Q.path||(K.theme.path="".concat(z.cdn,"/dist/css/content-theme")),z.emojiPath||(K.emojiPath="".concat(z.cdn,"/dist/images/emoji"))),(0,ne.h)(K,z)},le=function(z,Q){var K=oe(Q);return(0,j.Z)("".concat(K.cdn,"/dist/js/lute/lute.min.js"),"vditorLuteScript").then(function(){var B=(0,ke.X)({autoSpace:K.markdown.autoSpace,gfmAutoLink:K.markdown.gfmAutoLink,codeBlockPreview:K.markdown.codeBlockPreview,emojiSite:K.emojiPath,emojis:K.customEmoji,fixTermTypo:K.markdown.fixTermTypo,footnotes:K.markdown.footnotes,headingAnchor:K.anchor!==0,inlineMathDigit:K.math.inlineDigit,lazyLoadImage:K.lazyLoadImage,linkBase:K.markdown.linkBase,linkPrefix:K.markdown.linkPrefix,listStyle:K.markdown.listStyle,mark:K.markdown.mark,mathBlockPreview:K.markdown.mathBlockPreview,paragraphBeginningSpace:K.markdown.paragraphBeginningSpace,sanitize:K.markdown.sanitize,toc:K.markdown.toc});return Q!=null&&Q.renderers&&B.SetJSRenderers({renderers:{Md2HTML:Q.renderers}}),B.SetHeadingID(!0),B.Md2HTML(z)})},H=function(z,Q,K){return me(void 0,void 0,void 0,function(){var B,Te,se,je;return Me(this,function(V){switch(V.label){case 0:return B=oe(K),[4,le(Q,B)];case 1:if(Te=V.sent(),B.transform&&(Te=B.transform(Te)),z.innerHTML=Te,z.classList.add("vditor-reset"),B.i18n)return[3,5];if(["en_US","fr_FR","pt_BR","ja_JP","ko_KR","ru_RU","sv_SE","zh_CN","zh_TW"].includes(B.lang))return[3,2];throw new Error("options.lang error, see https://ld246.com/article/1549638745630#options");case 2:return se="vditorI18nScript",je=se+B.lang,document.querySelectorAll('head script[id^="'.concat(se,'"]')).forEach(function($){$.id!==je&&document.head.removeChild($)}),[4,(0,j.Z)("".concat(B.cdn,"/dist/js/i18n/").concat(B.lang,".js"),je)];case 3:V.sent(),V.label=4;case 4:return[3,6];case 5:window.VditorI18n=B.i18n,V.label=6;case 6:return B.icon?[4,(0,j.Z)("".concat(B.cdn,"/dist/js/icons/").concat(B.icon,".js"),"vditorIconScript")]:[3,8];case 7:V.sent(),V.label=8;case 8:return(0,I.H)(B.theme.current,B.theme.path),B.anchor===1&&z.classList.add("vditor-reset--anchor"),(0,u.o)(z,B.hljs),(0,v.$)(B.hljs,z,B.cdn),(0,k.T)(z,{cdn:B.cdn,math:B.math}),(0,_.e)(z,B.cdn,B.mode),(0,x.Y)(z,B.cdn,B.mode),(0,y.K)(z,B.cdn),(0,p.D)(z,B.cdn),(0,g.m)(z,B.cdn),(0,d.v)(z,B.cdn,B.mode),(0,O.l)(z,B.cdn,B.mode),(0,F.M)(z,B.cdn),(0,T.$)(z,B.cdn),B.render.media.enable&&(0,M.l)(z),B.speech.enable&&Ee(z),B.anchor!==0&&ce(B.anchor),B.after&&B.after(),B.lazyLoadImage&&b(z),z.addEventListener("click",function($){var W=(0,q._Y)($.target,"SPAN");if(W&&(0,q.KJ)(W,"vditor-toc")){var X=z.querySelector("#"+W.getAttribute("data-target-id"));X&&window.scrollTo(window.scrollX,X.offsetTop);return}}),[2]}})})},de=w(726),Z=w(13),Y=function(){function z(){}return z.adapterRender=S,z.previewImage=de.o,z.codeRender=u.o,z.graphvizRender=g.m,z.highlightRender=v.$,z.mathRender=k.T,z.mermaidRender=_.e,z.SMILESRender=x.Y,z.markmapRender=y.K,z.flowchartRender=p.D,z.chartRender=d.v,z.abcRender=T.$,z.mindmapRender=O.l,z.plantumlRender=F.M,z.outlineRender=N.N,z.mediaRender=M.l,z.speechRender=Ee,z.lazyLoadImageRender=b,z.md2html=le,z.preview=H,z.setCodeTheme=Z.h,z.setContentTheme=I.H,z}();const J=Y},913:(m,f,w)=>{w.d(f,{Y:()=>S,g:()=>T});var T="3.10.9",S=function(){function d(){}return d.ZWSP="​",d.DROP_EDITOR="application/editor",d.MOBILE_WIDTH=520,d.CLASS_MENU_DISABLED="vditor-menu--disabled",d.EDIT_TOOLBARS=["emoji","headings","bold","italic","strike","link","list","ordered-list","outdent","indent","check","line","quote","code","inline-code","insert-after","insert-before","upload","record","table"],d.CODE_THEME=["a11y-dark","agate","an-old-hope","androidstudio","arta","atom-one-dark","atom-one-dark-reasonable","base16/3024","base16/apathy","base16/apprentice","base16/ashes","base16/atelier-cave","base16/atelier-dune","base16/atelier-estuary","base16/atelier-forest","base16/atelier-heath","base16/atelier-lakeside","base16/atelier-plateau","base16/atelier-savanna","base16/atelier-seaside","base16/atelier-sulphurpool","base16/atlas","base16/bespin","base16/black-metal","base16/black-metal-bathory","base16/black-metal-burzum","base16/black-metal-dark-funeral","base16/black-metal-gorgoroth","base16/black-metal-immortal","base16/black-metal-khold","base16/black-metal-marduk","base16/black-metal-mayhem","base16/black-metal-nile","base16/black-metal-venom","base16/brewer","base16/bright","base16/brogrammer","base16/brush-trees-dark","base16/chalk","base16/circus","base16/classic-dark","base16/codeschool","base16/colors","base16/danqing","base16/darcula","base16/dark-violet","base16/darkmoss","base16/darktooth","base16/decaf","base16/default-dark","base16/dracula","base16/edge-dark","base16/eighties","base16/embers","base16/equilibrium-dark","base16/equilibrium-gray-dark","base16/espresso","base16/eva","base16/eva-dim","base16/flat","base16/framer","base16/gigavolt","base16/google-dark","base16/grayscale-dark","base16/green-screen","base16/gruvbox-dark-hard","base16/gruvbox-dark-medium","base16/gruvbox-dark-pale","base16/gruvbox-dark-soft","base16/hardcore","base16/harmonic16-dark","base16/heetch-dark","base16/helios","base16/hopscotch","base16/horizon-dark","base16/humanoid-dark","base16/ia-dark","base16/icy-dark","base16/ir-black","base16/isotope","base16/kimber","base16/london-tube","base16/macintosh","base16/marrakesh","base16/materia","base16/material","base16/material-darker","base16/material-palenight","base16/material-vivid","base16/mellow-purple","base16/mocha","base16/monokai","base16/nebula","base16/nord","base16/nova","base16/ocean","base16/oceanicnext","base16/onedark","base16/outrun-dark","base16/papercolor-dark","base16/paraiso","base16/pasque","base16/phd","base16/pico","base16/pop","base16/porple","base16/qualia","base16/railscasts","base16/rebecca","base16/ros-pine","base16/ros-pine-moon","base16/sandcastle","base16/seti-ui","base16/silk-dark","base16/snazzy","base16/solar-flare","base16/solarized-dark","base16/spacemacs","base16/summercamp","base16/summerfruit-dark","base16/synth-midnight-terminal-dark","base16/tango","base16/tender","base16/tomorrow-night","base16/twilight","base16/unikitty-dark","base16/vulcan","base16/windows-10","base16/windows-95","base16/windows-high-contrast","base16/windows-nt","base16/woodland","base16/xcode-dusk","base16/zenburn","codepen-embed","dark","devibeans","far","felipec","github-dark","github-dark-dimmed","gml","gradient-dark","hybrid","ir-black","isbl-editor-dark","kimbie-dark","lioshi","monokai","monokai-sublime","night-owl","nnfx-dark","nord","obsidian","panda-syntax-dark","paraiso-dark","pojoaque","qtcreator-dark","rainbow","shades-of-purple","srcery","stackoverflow-dark","sunburst","tomorrow-night-blue","tomorrow-night-bright","tokyo-night-dark","vs2015","xt256","ant-design","a11y-light","arduino-light","ascetic","atom-one-light","base16/atelier-cave-light","base16/atelier-dune-light","base16/atelier-estuary-light","base16/atelier-forest-light","base16/atelier-heath-light","base16/atelier-lakeside-light","base16/atelier-plateau-light","base16/atelier-savanna-light","base16/atelier-seaside-light","base16/atelier-sulphurpool-light","base16/brush-trees","base16/classic-light","base16/cupcake","base16/cupertino","base16/default-light","base16/dirtysea","base16/edge-light","base16/equilibrium-gray-light","base16/equilibrium-light","base16/fruit-soda","base16/github","base16/google-light","base16/grayscale-light","base16/gruvbox-light-hard","base16/gruvbox-light-medium","base16/gruvbox-light-soft","base16/harmonic16-light","base16/heetch-light","base16/humanoid-light","base16/horizon-light","base16/ia-light","base16/material-lighter","base16/mexico-light","base16/one-light","base16/papercolor-light","base16/ros-pine-dawn","base16/sagelight","base16/shapeshifter","base16/silk-light","base16/solar-flare-light","base16/solarized-light","base16/summerfruit-light","base16/synth-midnight-terminal-light","base16/tomorrow","base16/unikitty-light","base16/windows-10-light","base16/windows-95-light","base16/windows-high-contrast-light","brown-paper","base16/windows-nt-light","color-brewer","docco","foundation","github","googlecode","gradient-light","grayscale","idea","intellij-light","isbl-editor-light","kimbie-light","lightfair","magula","mono-blue","nnfx-light","panda-syntax-light","paraiso-light","purebasic","qtcreator-light","routeros","school-book","stackoverflow-light","tokyo-night-light","vs","xcode","default"],d.ALIAS_CODE_LANGUAGES=["abc","plantuml","mermaid","flowchart","echarts","mindmap","graphviz","math","markmap","smiles","js","ts","html","toml","c#","bat"],d.CDN="https://unpkg.com/vditor@".concat("3.10.9"),d.MARKDOWN_OPTIONS={autoSpace:!1,gfmAutoLink:!0,codeBlockPreview:!0,fixTermTypo:!1,footnotes:!0,linkBase:"",linkPrefix:"",listStyle:!1,mark:!1,mathBlockPreview:!0,paragraphBeginningSpace:!1,sanitize:!0,toc:!1},d.HLJS_OPTIONS={enable:!0,lineNumber:!1,defaultLang:"",style:"github"},d.MATH_OPTIONS={engine:"KaTeX",inlineDigit:!1,macros:{}},d.THEME_OPTIONS={current:"light",list:{"ant-design":"Ant Design",dark:"Dark",light:"Light",wechat:"WeChat"},path:"".concat(d.CDN,"/dist/css/content-theme")},d}()},931:(m,f,w)=>{w.d(f,{Y:()=>p});var T=w(913),S=w(161),d=w(59),u=w(933),p=function(g,v,b){g===void 0&&(g=document),v===void 0&&(v=T.Y.CDN);var k=d.SMILESRenderAdapter.getElements(g);k.length>0&&(0,S.Z)("".concat(v,"/dist/js/smiles-drawer/smiles-drawer.min.js?v=2.1.7"),"vditorAbcjsScript").then(function(){var M=new SmiDrawer({},{});k.forEach(function(_){var x=d.SMILESRenderAdapter.getCode(_).trim();if(!(_.getAttribute("data-processed")==="true"||x.trim()==="")){var y="smiles"+(0,u.Ee)();_.innerHTML='<svg id="'.concat(y,'"></svg>'),M.draw(x,"#"+y,b==="dark"?"dark":void 0),_.setAttribute("data-processed","true")}})})}},288:(m,f,w)=>{w.d(f,{$:()=>u});var T=w(913),S=w(161),d=w(59),u=function(p,g){p===void 0&&(p=document),g===void 0&&(g=T.Y.CDN);var v=d.abcRenderAdapter.getElements(p);v.length>0&&(0,S.Z)("".concat(g,"/dist/js/abcjs/abcjs_basic.min.js"),"vditorAbcjsScript").then(function(){v.forEach(function(b){b.parentElement.classList.contains("vditor-wysiwyg__pre")||b.parentElement.classList.contains("vditor-ir__marker--pre")||b.getAttribute("data-processed")!=="true"&&(ABCJS.renderAbc(b,d.abcRenderAdapter.getCode(b).trim()),b.style.overflowX="auto",b.setAttribute("data-processed","true"))})})}},59:(m,f,w)=>{w.r(f),w.d(f,{SMILESRenderAdapter:()=>S,abcRenderAdapter:()=>v,chartRenderAdapter:()=>g,flowchartRenderAdapter:()=>k,graphvizRenderAdapter:()=>b,markmapRenderAdapter:()=>u,mathRenderAdapter:()=>T,mermaidRenderAdapter:()=>d,mindmapRenderAdapter:()=>p,plantumlRenderAdapter:()=>M});var T={getCode:function(_){return _.textContent},getElements:function(_){return _.querySelectorAll(".language-math")}},S={getCode:function(_){return _.textContent},getElements:function(_){return _.querySelectorAll(".language-smiles")}},d={getCode:function(_){return _.textContent},getElements:function(_){return _.querySelectorAll(".language-mermaid")}},u={getCode:function(_){return _.textContent},getElements:function(_){return _.querySelectorAll(".language-markmap")}},p={getCode:function(_){return _.getAttribute("data-code")},getElements:function(_){return _.querySelectorAll(".language-mindmap")}},g={getCode:function(_){return _.innerText},getElements:function(_){return _.querySelectorAll(".language-echarts")}},v={getCode:function(_){return _.textContent},getElements:function(_){return _.querySelectorAll(".language-abc")}},b={getCode:function(_){return _.textContent},getElements:function(_){return _.querySelectorAll(".language-graphviz")}},k={getCode:function(_){return _.textContent},getElements:function(_){return _.querySelectorAll(".language-flowchart")}},M={getCode:function(_){return _.textContent},getElements:function(_){return _.querySelectorAll(".language-plantuml")}}},784:(m,f,w)=>{w.d(f,{v:()=>v});var T=w(913),S=w(161),d=w(59),u=w(933),p=function(b,k,M,_){function x(y){return y instanceof M?y:new M(function(O){O(y)})}return new(M||(M=Promise))(function(y,O){function N(I){try{R(_.next(I))}catch(j){O(j)}}function F(I){try{R(_.throw(I))}catch(j){O(j)}}function R(I){I.done?y(I.value):x(I.value).then(N,F)}R((_=_.apply(b,k||[])).next())})},g=function(b,k){var M={label:0,sent:function(){if(y[0]&1)throw y[1];return y[1]},trys:[],ops:[]},_,x,y,O;return O={next:N(0),throw:N(1),return:N(2)},typeof Symbol=="function"&&(O[Symbol.iterator]=function(){return this}),O;function N(R){return function(I){return F([R,I])}}function F(R){if(_)throw new TypeError("Generator is already executing.");for(;O&&(O=0,R[0]&&(M=0)),M;)try{if(_=1,x&&(y=R[0]&2?x.return:R[0]?x.throw||((y=x.return)&&y.call(x),0):x.next)&&!(y=y.call(x,R[1])).done)return y;switch(x=0,y&&(R=[R[0]&2,y.value]),R[0]){case 0:case 1:y=R;break;case 4:return M.label++,{value:R[1],done:!1};case 5:M.label++,x=R[1],R=[0];continue;case 7:R=M.ops.pop(),M.trys.pop();continue;default:if(y=M.trys,!(y=y.length>0&&y[y.length-1])&&(R[0]===6||R[0]===2)){M=0;continue}if(R[0]===3&&(!y||R[1]>y[0]&&R[1]<y[3])){M.label=R[1];break}if(R[0]===6&&M.label<y[1]){M.label=y[1],y=R;break}if(y&&M.label<y[2]){M.label=y[2],M.ops.push(R);break}y[2]&&M.ops.pop(),M.trys.pop();continue}R=k.call(b,M)}catch(I){R=[6,I],x=0}finally{_=y=0}if(R[0]&5)throw R[1];return{value:R[0]?R[1]:void 0,done:!0}}},v=function(b,k,M){b===void 0&&(b=document),k===void 0&&(k=T.Y.CDN);var _=d.chartRenderAdapter.getElements(b);_.length>0&&(0,S.Z)("".concat(k,"/dist/js/echarts/echarts.min.js?v=5.5.1"),"vditorEchartsScript").then(function(){_.forEach(function(x){return p(void 0,void 0,void 0,function(){var y,O,N;return g(this,function(F){switch(F.label){case 0:if(x.parentElement.classList.contains("vditor-wysiwyg__pre")||x.parentElement.classList.contains("vditor-ir__marker--pre"))return[2];if(y=d.chartRenderAdapter.getCode(x).trim(),!y)return[2];F.label=1;case 1:return F.trys.push([1,3,,4]),x.getAttribute("data-processed")==="true"?[2]:[4,(0,u.kY)(y)];case 2:return O=F.sent(),echarts.init(x,M==="dark"?"dark":void 0).setOption(O),x.setAttribute("data-processed","true"),[3,4];case 3:return N=F.sent(),x.className="vditor-reset--error",x.innerHTML="echarts render error: <br>".concat(N),[3,4];case 4:return[2]}})})})})}},51:(m,f,w)=>{w.d(f,{o:()=>d});var T=w(695),S=w(913),d=function(u,p){Array.from(u.querySelectorAll("pre > code")).filter(function(g,v){return!(g.parentElement.classList.contains("vditor-wysiwyg__pre")||g.parentElement.classList.contains("vditor-ir__marker--pre")||g.classList.contains("language-mermaid")||g.classList.contains("language-flowchart")||g.classList.contains("language-echarts")||g.classList.contains("language-mindmap")||g.classList.contains("language-plantuml")||g.classList.contains("language-markmap")||g.classList.contains("language-abc")||g.classList.contains("language-graphviz")||g.classList.contains("language-math")||g.classList.contains("language-smiles")||g.style.maxHeight.indexOf("px")>-1||u.classList.contains("vditor-preview")&&v>5)}).forEach(function(g){var v,b,k,M=g.innerText;if(g.classList.contains("highlight-chroma")){var _=g.cloneNode(!0);_.querySelectorAll(".highlight-ln").forEach(function(N){N.remove()}),M=_.innerText}else M.endsWith(`
`)&&(M=M.substr(0,M.length-1));var x='<svg><use xlink:href="#vditor-icon-copy"></use></svg>';document.getElementById("vditorIconScript")||(x='<svg viewBox="0 0 32 32"><path d="M22.545-0h-17.455c-1.6 0-2.909 1.309-2.909 2.909v20.364h2.909v-20.364h17.455v-2.909zM26.909 5.818h-16c-1.6 0-2.909 1.309-2.909 2.909v20.364c0 1.6 1.309 2.909 2.909 2.909h16c1.6 0 2.909-1.309 2.909-2.909v-20.364c0-1.6-1.309-2.909-2.909-2.909zM26.909 29.091h-16v-20.364h16v20.364z"></path></svg>');var y=document.createElement("div");y.className="vditor-copy",y.innerHTML='<span aria-label="'.concat(((v=window.VditorI18n)===null||v===void 0?void 0:v.copy)||"复制",`"
onmouseover="this.setAttribute('aria-label', '`).concat(((b=window.VditorI18n)===null||b===void 0?void 0:b.copy)||"复制",`')"
class="vditor-tooltipped vditor-tooltipped__w"
onclick="this.previousElementSibling.select();document.execCommand('copy');this.setAttribute('aria-label', '`).concat(((k=window.VditorI18n)===null||k===void 0?void 0:k.copied)||"已复制",`');this.previousElementSibling.blur()">`).concat(x,"</span>");var O=document.createElement("textarea");O.value=(0,T.p)(M),y.insertAdjacentElement("afterbegin",O),p&&p.renderMenu&&p.renderMenu(g,y),g.before(y),g.style.maxHeight=window.outerHeight-40+"px",g.insertAdjacentHTML("afterend",'<span style="position: absolute">'.concat(S.Y.ZWSP,"</span>"))})}},500:(m,f,w)=>{w.d(f,{D:()=>u});var T=w(913),S=w(161),d=w(59),u=function(p,g){g===void 0&&(g=T.Y.CDN);var v=d.flowchartRenderAdapter.getElements(p);v.length!==0&&(0,S.Z)("".concat(g,"/dist/js/flowchart.js/flowchart.min.js"),"vditorFlowchartScript").then(function(){v.forEach(function(b){if(b.getAttribute("data-processed")!=="true"){var k=flowchart.parse(d.flowchartRenderAdapter.getCode(b));b.innerHTML="",k.drawSVG(b),b.setAttribute("data-processed","true")}})})}},339:(m,f,w)=>{w.d(f,{m:()=>u});var T=w(913),S=w(161),d=w(59),u=function(p,g){g===void 0&&(g=T.Y.CDN);var v=d.graphvizRenderAdapter.getElements(p);v.length!==0&&(0,S.Z)("".concat(g,"/dist/js/graphviz/viz.js"),"vditorGraphVizScript").then(function(){v.forEach(function(b){var k=d.graphvizRenderAdapter.getCode(b);if(!(b.parentElement.classList.contains("vditor-wysiwyg__pre")||b.parentElement.classList.contains("vditor-ir__marker--pre"))&&!(b.getAttribute("data-processed")==="true"||k.trim()==="")){try{var M=new Blob(["importScripts('".concat(document.getElementById("vditorGraphVizScript").src.replace("viz.js","full.render.js"),"');")],{type:"application/javascript"}),_=window.URL||window.webkitURL,x=_.createObjectURL(M),y=new Worker(x);new Viz({worker:y}).renderSVGElement(k).then(function(O){b.innerHTML=O.outerHTML}).catch(function(O){b.innerHTML="graphviz render error: <br>".concat(O),b.className="vditor-reset--error"})}catch(O){console.error("graphviz error",O)}b.setAttribute("data-processed","true")}})})}},108:(m,f,w)=>{w.d(f,{$:()=>u});var T=w(913),S=w(161),d=w(505),u=function(p,g,v){g===void 0&&(g=document),v===void 0&&(v=T.Y.CDN);var b=p.style;T.Y.CODE_THEME.includes(b)||(b="github");var k=document.getElementById("vditorHljsStyle"),M="".concat(v,"/dist/js/highlight.js/styles/").concat(b,".min.css");if(k&&k.getAttribute("href")!==M&&k.remove(),(0,d.T)("".concat(v,"/dist/js/highlight.js/styles/").concat(b,".min.css"),"vditorHljsStyle"),p.enable!==!1){var _=g.querySelectorAll("pre > code");_.length!==0&&(0,S.Z)("".concat(v,"/dist/js/highlight.js/highlight.min.js?v=11.7.0"),"vditorHljsScript").then(function(){(0,S.Z)("".concat(v,"/dist/js/highlight.js/third-languages.js?v=1.0.1"),"vditorHljsThirdScript").then(function(){g.querySelectorAll("pre > code").forEach(function(x){if(!(x.parentElement.classList.contains("vditor-ir__marker--pre")||x.parentElement.classList.contains("vditor-wysiwyg__pre"))&&!(x.classList.contains("language-mermaid")||x.classList.contains("language-flowchart")||x.classList.contains("language-echarts")||x.classList.contains("language-mindmap")||x.classList.contains("language-plantuml")||x.classList.contains("language-smiles")||x.classList.contains("language-abc")||x.classList.contains("language-graphviz")||x.classList.contains("language-math"))){p.defaultLang!==""&&x.className.indexOf("language-")===-1&&x.classList.add("language-"+p.defaultLang);var y=x.className.replace("language-","");if(window.hljs.getLanguage(y)||(y="plaintext"),x.innerHTML=window.hljs.highlight(x.textContent,{language:y,ignoreIllegals:!0}).value,x.classList.add("hljs"),!!p.lineNumber){x.classList.add("vditor-linenumber");var O=x.querySelector(".vditor-linenumber__temp");O||(O=document.createElement("div"),O.className="vditor-linenumber__temp",x.insertAdjacentElement("beforeend",O));var N=getComputedStyle(x).whiteSpace,F=!1;(N==="pre-wrap"||N==="pre-line")&&(F=!0);var R="",I=x.textContent.split(/\r\n|\r|\n/g);I.pop(),I.map(function(j){var q="";F&&(O.textContent=j||`
`,q=' style="height:'.concat(O.getBoundingClientRect().height,'px"')),R+="<span".concat(q,"></span>")}),O.style.display="none",R='<span class="vditor-linenumber__rows">'.concat(R,"</span>"),x.insertAdjacentHTML("beforeend",R)}}})})})}}},597:(m,f,w)=>{w.d(f,{K:()=>v});var T=w(913),S=w(161),d=w(59),u={},p=function(b,k){var M=b.transform(k),_=Object.keys(M.features).filter(function(F){return!u[F]});_.forEach(function(F){u[F]=!0});var x=b.getAssets(_),y=x.styles,O=x.scripts,N=window.markmap;return y&&N.loadCSS(y),O&&N.loadJS(O),M},g=function(b,k){var M=window.markmap,_=M.Transformer,x=M.Markmap,y=M.deriveOptions;M.globalCSS;var O=new _;b.innerHTML='<svg style="width:100%"></svg>';var N=b.firstChild,F=x.create(N,null),R=p(O,k),I=R.root,j=R.frontmatter,q=j==null?void 0:j.markmap,ne=y(q);F.setData(I,ne),F.fit()},v=function(b,k){b===void 0&&(b=document),k===void 0&&(k=T.Y.CDN);var M=d.markmapRenderAdapter.getElements(b);M.length!==0&&(0,S.Z)("".concat(k,"/dist/js/markmap/markmap.min.js"),"vditorMarkerScript").then(function(){M.forEach(function(_){var x=d.markmapRenderAdapter.getCode(_);if(!(_.getAttribute("data-processed")==="true"||x.trim()==="")){var y=document.createElement("div");y.className="language-markmap",_.parentNode.appendChild(y),g(y,x),_.parentNode.childNodes[0].nodeName=="CODE"&&_.parentNode.removeChild(_.parentNode.childNodes[0])}})})}},960:(m,f,w)=>{w.d(f,{T:()=>g});var T=w(913),S=w(161),d=w(505),u=w(695),p=w(59),g=function(v,b){v===void 0&&(v=document);var k=p.mathRenderAdapter.getElements(v);if(k.length!==0){var M={cdn:T.Y.CDN,math:{engine:"KaTeX",inlineDigit:!1,macros:{}}};if(b&&b.math&&(b.math=Object.assign({},M.math,b.math)),b=Object.assign({},M,b),b.math.engine==="KaTeX")(0,d.T)("".concat(b.cdn,"/dist/js/katex/katex.min.css?v=0.16.9"),"vditorKatexStyle"),(0,S.Z)("".concat(b.cdn,"/dist/js/katex/katex.min.js?v=0.16.9"),"vditorKatexScript").then(function(){(0,S.Z)("".concat(b.cdn,"/dist/js/katex/mhchem.min.js?v=0.16.9"),"vditorKatexChemScript").then(function(){k.forEach(function(y){if(!(y.parentElement.classList.contains("vditor-wysiwyg__pre")||y.parentElement.classList.contains("vditor-ir__marker--pre"))&&!y.getAttribute("data-math")){var O=(0,u.p)(p.mathRenderAdapter.getCode(y));y.setAttribute("data-math",O);try{y.innerHTML=katex.renderToString(O,{displayMode:y.tagName==="DIV",output:"html",macros:b.math.macros})}catch(N){y.innerHTML=N.message,y.className="language-math vditor-reset--error"}y.addEventListener("copy",function(N){N.stopPropagation(),N.preventDefault();var F=N.currentTarget.closest(".language-math");N.clipboardData.setData("text/html",F.innerHTML),N.clipboardData.setData("text/plain",F.getAttribute("data-math"))})}})})});else if(b.math.engine==="MathJax"){var _=function(y){if(y.length!==0){var O=0,N=y[y.length-1],F=function(){var R=y[O++];R===N?R():R(F)};F()}};window.MathJax||(window.MathJax={loader:{paths:{mathjax:"".concat(b.cdn,"/dist/js/mathjax")}},startup:{typeset:!1},tex:{macros:b.math.macros}},Object.assign(window.MathJax,b.math.mathJaxOptions)),(0,S.U)("".concat(b.cdn,"/dist/js/mathjax/tex-svg-full.js"),"protyleMathJaxScript");var x=function(y,O){var N=(0,u.p)(y.textContent).trim(),F=window.MathJax.getMetricsFor(y);F.display=y.tagName==="DIV",window.MathJax.tex2svgPromise(N,F).then(function(R){y.innerHTML="",y.setAttribute("data-math",N),y.append(R),window.MathJax.startup.document.clear(),window.MathJax.startup.document.updateDocument();var I=R.querySelector('[data-mml-node="merror"]');I&&I.textContent.trim()!==""&&(y.innerHTML=I.textContent.trim(),y.className="vditor-reset--error"),O&&O()})};window.MathJax.startup.promise.then(function(){for(var y=[],O=function(F){var R=k[F];!R.parentElement.classList.contains("vditor-wysiwyg__pre")&&!R.parentElement.classList.contains("vditor-ir__marker--pre")&&!R.getAttribute("data-math")&&(0,u.p)(R.textContent).trim()&&y.push(function(I){F===k.length-1?x(R):x(R,I)})},N=0;N<k.length;N++)O(N);_(y)})}}}},0:(m,f,w)=>{w.d(f,{l:()=>p});var T=w(933),S=function(g,v){g.insertAdjacentHTML("afterend",'<video controls="controls" src="'.concat(v,'"></video>')),g.remove()},d=function(g,v){g.insertAdjacentHTML("afterend",'<audio controls="controls" src="'.concat(v,'"></audio>')),g.remove()},u=function(g,v){var b=v.match(/\/\/(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))([\w|-]{11})(?:(?:[\?&]t=)(\S+))?/),k=v.match(/\/\/v\.youku\.com\/v_show\/id_(\w+)=*\.html/),M=v.match(/\/\/v\.qq\.com\/x\/cover\/.*\/([^\/]+)\.html\??.*/),_=v.match(/(?:www\.|\/\/)coub\.com\/view\/(\w+)/),x=v.match(/(?:www\.|\/\/)facebook\.com\/([^\/]+)\/videos\/([0-9]+)/),y=v.match(/.+dailymotion.com\/(video|hub)\/(\w+)\?/),O=v.match(/(?:www\.|\/\/)bilibili\.com\/video\/(\w+)/),N=v.match(/(?:www\.|\/\/)ted\.com\/talks\/(\w+)/);if(b&&b[1].length===11)g.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//www.youtube.com/embed/'.concat(b[1]+(b[2]?"?start="+b[2]:""),'"></iframe>')),g.remove();else if(k&&k[1])g.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//player.youku.com/embed/'.concat(k[1],'"></iframe>')),g.remove();else if(M&&M[1])g.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="https://v.qq.com/txp/iframe/player.html?vid='.concat(M[1],'"></iframe>')),g.remove();else if(_&&_[1])g.insertAdjacentHTML("afterend",`<iframe class="iframe__video"
 src="//coub.com/embed/`.concat(_[1],'?muted=false&autostart=false&originalSize=true&startWithHD=true"></iframe>')),g.remove();else if(x&&x[0])g.insertAdjacentHTML("afterend",`<iframe class="iframe__video"
 src="https://www.facebook.com/plugins/video.php?href=`.concat(encodeURIComponent(x[0]),'"></iframe>')),g.remove();else if(y&&y[2])g.insertAdjacentHTML("afterend",`<iframe class="iframe__video"
 src="https://www.dailymotion.com/embed/video/`.concat(y[2],'"></iframe>')),g.remove();else if(v.indexOf("bilibili.com")>-1&&(v.indexOf("bvid=")>-1||O&&O[1])){var F={bvid:(0,T.TK)("bvid",v)||O&&O[1],page:"1",high_quality:"1",as_wide:"1",allowfullscreen:"true",autoplay:"0"};new URL(v.startsWith("http")?v:"https:"+v).search.split("&").forEach(function(j,q){if(j){q===0&&(j=j.substr(1));var ne=j.split("=");F[ne[0]]=ne[1]}});var R="https://player.bilibili.com/player.html?",I=Object.keys(F);I.forEach(function(j,q){R+="".concat(j,"=").concat(F[j]),q<I.length-1&&(R+="&")}),g.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="'.concat(R,'"></iframe>')),g.remove()}else N&&N[1]&&(g.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//embed.ted.com/talks/'.concat(N[1],'"></iframe>')),g.remove())},p=function(g){g&&g.querySelectorAll("a").forEach(function(v){var b=v.getAttribute("href");b&&(b.match(/^.+.(mp4|m4v|ogg|ogv|webm)$/)?S(v,b):b.match(/^.+.(mp3|wav|flac)$/)?d(v,b):u(v,b))})}},975:(m,f,w)=>{w.d(f,{e:()=>v});var T=w(913),S=w(161),d=w(59),u=w(933),p=function(b,k,M,_){function x(y){return y instanceof M?y:new M(function(O){O(y)})}return new(M||(M=Promise))(function(y,O){function N(I){try{R(_.next(I))}catch(j){O(j)}}function F(I){try{R(_.throw(I))}catch(j){O(j)}}function R(I){I.done?y(I.value):x(I.value).then(N,F)}R((_=_.apply(b,k||[])).next())})},g=function(b,k){var M={label:0,sent:function(){if(y[0]&1)throw y[1];return y[1]},trys:[],ops:[]},_,x,y,O;return O={next:N(0),throw:N(1),return:N(2)},typeof Symbol=="function"&&(O[Symbol.iterator]=function(){return this}),O;function N(R){return function(I){return F([R,I])}}function F(R){if(_)throw new TypeError("Generator is already executing.");for(;O&&(O=0,R[0]&&(M=0)),M;)try{if(_=1,x&&(y=R[0]&2?x.return:R[0]?x.throw||((y=x.return)&&y.call(x),0):x.next)&&!(y=y.call(x,R[1])).done)return y;switch(x=0,y&&(R=[R[0]&2,y.value]),R[0]){case 0:case 1:y=R;break;case 4:return M.label++,{value:R[1],done:!1};case 5:M.label++,x=R[1],R=[0];continue;case 7:R=M.ops.pop(),M.trys.pop();continue;default:if(y=M.trys,!(y=y.length>0&&y[y.length-1])&&(R[0]===6||R[0]===2)){M=0;continue}if(R[0]===3&&(!y||R[1]>y[0]&&R[1]<y[3])){M.label=R[1];break}if(R[0]===6&&M.label<y[1]){M.label=y[1],y=R;break}if(y&&M.label<y[2]){M.label=y[2],M.ops.push(R);break}y[2]&&M.ops.pop(),M.trys.pop();continue}R=k.call(b,M)}catch(I){R=[6,I],x=0}finally{_=y=0}if(R[0]&5)throw R[1];return{value:R[0]?R[1]:void 0,done:!0}}},v=function(b,k,M){b===void 0&&(b=document),k===void 0&&(k=T.Y.CDN);var _=d.mermaidRenderAdapter.getElements(b);_.length!==0&&(0,S.Z)("".concat(k,"/dist/js/mermaid/mermaid.min.js"),"vditorMermaidScript").then(function(){var x={securityLevel:"loose",altFontFamily:"sans-serif",fontFamily:"sans-serif",startOnLoad:!1,flowchart:{htmlLabels:!0,useMaxWidth:!0},sequence:{useMaxWidth:!0,diagramMarginX:8,diagramMarginY:8,boxMargin:8,showSequenceNumbers:!0},gantt:{leftPadding:75,rightPadding:20}};M==="dark"&&(x.theme="dark"),mermaid.initialize(x),_.forEach(function(y){return p(void 0,void 0,void 0,function(){var O,N,F,R,I;return g(this,function(j){switch(j.label){case 0:if(O=d.mermaidRenderAdapter.getCode(y),y.getAttribute("data-processed")==="true"||O.trim()==="")return[2];N="mermaid"+(0,u.Ee)(),j.label=1;case 1:return j.trys.push([1,3,,4]),[4,mermaid.render(N,y.textContent)];case 2:return F=j.sent(),y.innerHTML=F.svg,[3,4];case 3:return R=j.sent(),I=document.querySelector("#"+N),y.innerHTML="".concat(I.outerHTML,`<br>
<div style="text-align: left"><small>`).concat(R.message.replace(/\n/,"<br>"),"</small></div>"),I.parentElement.remove(),[3,4];case 4:return y.setAttribute("data-processed","true"),[2]}})})})})}},162:(m,f,w)=>{w.d(f,{l:()=>u});var T=w(913),S=w(161),d=w(59),u=function(p,g,v){p===void 0&&(p=document),g===void 0&&(g=T.Y.CDN);var b=d.mindmapRenderAdapter.getElements(p);b.length>0&&(0,S.Z)("".concat(g,"/dist/js/echarts/echarts.min.js?v=5.5.1"),"vditorEchartsScript").then(function(){b.forEach(function(k){if(!(k.parentElement.classList.contains("vditor-wysiwyg__pre")||k.parentElement.classList.contains("vditor-ir__marker--pre"))){var M=d.mindmapRenderAdapter.getCode(k);if(M)try{if(k.getAttribute("data-processed")==="true")return;echarts.init(k,v==="dark"?"dark":void 0).setOption({series:[{data:[JSON.parse(decodeURIComponent(M))],initialTreeDepth:-1,itemStyle:{borderWidth:0,color:"#4285f4"},label:{backgroundColor:"#f6f8fa",borderColor:"#d1d5da",borderRadius:5,borderWidth:.5,color:"#586069",lineHeight:20,offset:[-5,0],padding:[0,5],position:"insideRight"},lineStyle:{color:"#d1d5da",width:1},roam:!0,symbol:function(_,x){var y;return!((y=x==null?void 0:x.data)===null||y===void 0)&&y.children?"circle":"path://"},type:"tree"}],tooltip:{trigger:"item",triggerOn:"mousemove"}}),k.setAttribute("data-processed","true")}catch(_){k.className="vditor-reset--error",k.innerHTML="mindmap render error: <br>".concat(_)}}})})}},70:(m,f,w)=>{w.d(f,{N:()=>d});var T=w(164),S=w(960),d=function(u,p,g){var v="",b=[];if(Array.from(u.children).forEach(function(x,y){if((0,T.c)(x)){if(g){var O=x.id.lastIndexOf("_");x.id=x.id.substring(0,O===-1?void 0:O)+"_"+y}b.push(x.id),v+=x.outerHTML.replace("<wbr>","")}}),v==="")return p.innerHTML="","";var k=document.createElement("div");if(g)g.lute.SetToC(!0),g.currentMode==="wysiwyg"&&!g.preview.element.contains(u)?k.innerHTML=g.lute.SpinVditorDOM("<p>[ToC]</p>"+v):g.currentMode==="ir"&&!g.preview.element.contains(u)?k.innerHTML=g.lute.SpinVditorIRDOM("<p>[ToC]</p>"+v):k.innerHTML=g.lute.HTML2VditorDOM("<p>[ToC]</p>"+v),g.lute.SetToC(g.options.preview.markdown.toc);else{p.classList.add("vditor-outline");var M=Lute.New();M.SetToC(!0),k.innerHTML=M.HTML2VditorDOM("<p>[ToC]</p>"+v)}var _=k.firstElementChild.querySelectorAll("li > span[data-target-id]");return _.forEach(function(x,y){if(x.nextElementSibling&&x.nextElementSibling.tagName==="UL"){var O="<svg class='vditor-outline__action'><use xlink:href='#vditor-icon-down'></use></svg>";document.getElementById("vditorIconScript")||(O='<svg class="vditor-outline__action" viewBox="0 0 32 32"><path d="M3.76 6.12l12.24 12.213 12.24-12.213 3.76 3.76-16 16-16-16 3.76-3.76z"></path></svg>'),x.innerHTML="".concat(O,"<span>").concat(x.innerHTML,"</span>")}else x.innerHTML="<svg></svg><span>".concat(x.innerHTML,"</span>");x.setAttribute("data-target-id",b[y])}),v=k.firstElementChild.innerHTML,_.length===0?(p.innerHTML="",v):(p.innerHTML=v,g&&(0,S.T)(p,{cdn:g.options.cdn,math:g.options.preview.math}),p.firstElementChild.addEventListener("click",function(x){for(var y=x.target;y&&!y.isEqualNode(p);){if(y.classList.contains("vditor-outline__action")){y.classList.contains("vditor-outline__action--close")?(y.classList.remove("vditor-outline__action--close"),y.parentElement.nextElementSibling.setAttribute("style","display:block")):(y.classList.add("vditor-outline__action--close"),y.parentElement.nextElementSibling.setAttribute("style","display:none")),x.preventDefault(),x.stopPropagation();break}else if(y.getAttribute("data-target-id")){x.preventDefault(),x.stopPropagation();var O=document.getElementById(y.getAttribute("data-target-id"));if(!O)return;if(g)if(g.options.height==="auto"){var N=O.offsetTop+g.element.offsetTop;g.options.toolbarConfig.pin||(N+=g.toolbar.element.offsetHeight),window.scrollTo(window.scrollX,N)}else g.element.offsetTop<window.scrollY&&window.scrollTo(window.scrollX,g.element.offsetTop),g.preview.element.contains(u)?u.parentElement.scrollTop=O.offsetTop:u.scrollTop=O.offsetTop;else window.scrollTo(window.scrollX,O.offsetTop);break}y=y.parentElement}}),v)}},591:(m,f,w)=>{w.d(f,{M:()=>u});var T=w(913),S=w(161),d=w(59),u=function(p,g){p===void 0&&(p=document),g===void 0&&(g=T.Y.CDN);var v=d.plantumlRenderAdapter.getElements(p);v.length!==0&&(0,S.Z)("".concat(g,"/dist/js/plantuml/plantuml-encoder.min.js"),"vditorPlantumlScript").then(function(){v.forEach(function(b){if(!(b.parentElement.classList.contains("vditor-wysiwyg__pre")||b.parentElement.classList.contains("vditor-ir__marker--pre"))){var k=d.plantumlRenderAdapter.getCode(b).trim();if(k)try{b.innerHTML='<object type="image/svg+xml" data="https://www.plantuml.com/plantuml/svg/~1'.concat(plantumlEncoder.encode(k),'"/>')}catch(M){b.className="vditor-reset--error",b.innerHTML="plantuml render error: <br>".concat(M)}}})})}},796:(m,f,w)=>{w.d(f,{X:()=>T});var T=function(S){var d=Lute.New();return d.PutEmojis(S.emojis),d.SetEmojiSite(S.emojiSite),d.SetHeadingAnchor(S.headingAnchor),d.SetInlineMathAllowDigitAfterOpenMarker(S.inlineMathDigit),d.SetAutoSpace(S.autoSpace),d.SetToC(S.toc),d.SetFootnotes(S.footnotes),d.SetFixTermTypo(S.fixTermTypo),d.SetVditorCodeBlockPreview(S.codeBlockPreview),d.SetVditorMathBlockPreview(S.mathBlockPreview),d.SetSanitize(S.sanitize),d.SetChineseParagraphBeginningSpace(S.paragraphBeginningSpace),d.SetRenderListStyle(S.listStyle),d.SetLinkBase(S.linkBase),d.SetLinkPrefix(S.linkPrefix),d.SetMark(S.mark),d.SetGFMAutoLink(S.gfmAutoLink),S.lazyLoadImage&&d.SetImageLazyLoading(S.lazyLoadImage),d}},726:(m,f,w)=>{w.d(f,{o:()=>T});var T=function(S,d,u){u===void 0&&(u="classic");var p=S.getBoundingClientRect(),g=36;document.body.insertAdjacentHTML("beforeend",'<div class="vditor vditor-img'.concat(u==="dark"?" vditor--dark":"",`">
    <div class="vditor-img__bar">
      <span class="vditor-img__btn" data-deg="0">
        <svg><use xlink:href="#vditor-icon-redo"></use></svg>
        `).concat(window.VditorI18n.spin,`
      </span>
      <span class="vditor-img__btn"  onclick="this.parentElement.parentElement.outerHTML = '';document.body.style.overflow = ''">
        X &nbsp;`).concat(window.VditorI18n.close,`
      </span>
    </div>
    <div class="vditor-img__img" onclick="this.parentElement.outerHTML = '';document.body.style.overflow = ''">
      <img style="width: `).concat(S.width,"px;height:").concat(S.height,"px;transform: translate3d(").concat(p.left,"px, ").concat(p.top-g,'px, 0)" src="').concat(S.getAttribute("src"),`">
    </div>
</div>`)),document.body.style.overflow="hidden";var v=document.querySelector(".vditor-img img"),b="translate3d(".concat(Math.max(0,window.innerWidth-S.naturalWidth)/2,"px, ").concat(Math.max(0,window.innerHeight-g-S.naturalHeight)/2,"px, 0)");setTimeout(function(){v.setAttribute("style","transition: transform .3s ease-in-out;transform: ".concat(b)),setTimeout(function(){v.parentElement.scrollTo((v.parentElement.scrollWidth-v.parentElement.clientWidth)/2,(v.parentElement.scrollHeight-v.parentElement.clientHeight)/2)},400)});var k=document.querySelector(".vditor-img__btn");k.addEventListener("click",function(){var M=parseInt(k.getAttribute("data-deg"),10)+90;M/90%2===1&&S.naturalWidth>v.parentElement.clientHeight?v.style.transform="translate3d(".concat(Math.max(0,window.innerWidth-S.naturalWidth)/2,"px, ").concat(S.naturalWidth/2-S.naturalHeight/2,"px, 0) rotateZ(").concat(M,"deg)"):v.style.transform="".concat(b," rotateZ(").concat(M,"deg)"),k.setAttribute("data-deg",M.toString()),setTimeout(function(){v.parentElement.scrollTo((v.parentElement.scrollWidth-v.parentElement.clientWidth)/2,(v.parentElement.scrollHeight-v.parentElement.clientHeight)/2)},400)})}},13:(m,f,w)=>{w.d(f,{h:()=>d});var T=w(913),S=w(505),d=function(u,p){p===void 0&&(p=T.Y.CDN),T.Y.CODE_THEME.includes(u)||(u="github");var g=document.getElementById("vditorHljsStyle"),v="".concat(p,"/dist/js/highlight.js/styles/").concat(u,".min.css");g?g.getAttribute("href")!==v&&(g.remove(),(0,S.T)(v,"vditorHljsStyle")):(0,S.T)(v,"vditorHljsStyle")}},873:(m,f,w)=>{w.d(f,{H:()=>S});var T=w(505),S=function(d,u){if(!(!d||!u)){var p=document.getElementById("vditorContentTheme"),g="".concat(u,"/").concat(d,".css");p?p.getAttribute("href")!==g&&(p.remove(),(0,T.T)(g,"vditorContentTheme")):(0,T.T)(g,"vditorContentTheme")}}},161:(m,f,w)=>{w.d(f,{U:()=>T,Z:()=>S});var T=function(d,u){if(document.getElementById(u))return!1;var p=new XMLHttpRequest;p.open("GET",d,!1),p.setRequestHeader("Accept","text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01"),p.send("");var g=document.createElement("script");g.type="text/javascript",g.text=p.responseText,g.id=u,document.head.appendChild(g)},S=function(d,u){return new Promise(function(p,g){if(document.getElementById(u))return p(!0),!1;var v=document.createElement("script");v.src=d,v.async=!0,document.head.appendChild(v),v.onerror=function(b){g(b)},v.onload=function(){if(document.getElementById(u))return v.remove(),p(!0),!1;v.id=u,p(!0)}})}},505:(m,f,w)=>{w.d(f,{T:()=>T});var T=function(S,d){if(!document.getElementById(d)){var u=document.createElement("link");u.id=d,u.rel="stylesheet",u.type="text/css",u.href=S,document.getElementsByTagName("head")[0].appendChild(u)}}},695:(m,f,w)=>{w.d(f,{p:()=>T});var T=function(S){return S.replace(/\u00a0/g," ")}},629:(m,f,w)=>{w.d(f,{D:()=>d,H8:()=>v,_0:()=>p,fG:()=>g,gm:()=>S,nr:()=>T,y3:()=>u});var T=function(){return navigator.userAgent.indexOf("Safari")>-1&&navigator.userAgent.indexOf("Chrome")===-1},S=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},d=function(){try{return typeof localStorage<"u"}catch{return!1}},u=function(){return navigator.userAgent.indexOf("iPhone")>-1?"touchstart":"click"},p=function(b){return navigator.platform.toUpperCase().indexOf("MAC")>=0?!!(b.metaKey&&!b.ctrlKey):!!(!b.metaKey&&b.ctrlKey)},g=function(b){return/Mac/.test(navigator.platform)||navigator.platform==="iPhone"?b.indexOf("⇧")>-1&&S()&&(b=b.replace(";",":").replace("=","+").replace("-","_")):(b.startsWith("⌘")?b=b.replace("⌘","⌘+"):b.startsWith("⌥")&&b.substr(1,1)!=="⌘"?b=b.replace("⌥","⌥+"):b=b.replace("⇧⌘","⌘+⇧+").replace("⌥⌘","⌥+⌘+"),b=b.replace("⌘","Ctrl").replace("⇧","Shift").replace("⌥","Alt"),b.indexOf("Shift")>-1&&(b=b.replace(";",":").replace("=","+").replace("-","_"))),b},v=function(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}},933:(m,f,w)=>{w.d(f,{Ee:()=>T,TK:()=>S,kY:()=>d});var T=function(){return([1e7].toString()+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(u){return(parseInt(u,10)^window.crypto.getRandomValues(new Uint32Array(1))[0]&15>>parseInt(u,10)/4).toString(16)})},S=function(u,p){p===void 0&&(p=window.location.search);var g=p.substring(p.indexOf("?")),v=g.indexOf("#"),b=new URLSearchParams(g.substring(0,v>=0?v:void 0));return b.get(u)},d=function(u){return Function('"use strict";return ('.concat(u,")"))()}},598:(m,f,w)=>{w.d(f,{Ab:()=>d,KJ:()=>b,KR:()=>u,Rp:()=>k,Th:()=>p,XW:()=>S,_Y:()=>v,pt:()=>g});var T=w(164),S=function(M,_){for(var x=b(M,_),y=!1,O=!1;x&&!x.classList.contains("vditor-reset")&&!O;)y=b(x.parentElement,_),y?x=y:O=!0;return x||!1},d=function(M,_){for(var x=(0,T.f)(M,_),y=!1,O=!1;x&&!x.classList.contains("vditor-reset")&&!O;)y=(0,T.f)(x.parentElement,_),y?x=y:O=!0;return x||!1},u=function(M){var _=d(M,"UL"),x=d(M,"OL"),y=_;return x&&(!_||_&&x.contains(_))&&(y=x),y},p=function(M,_,x){if(!M)return!1;M.nodeType===3&&(M=M.parentElement);for(var y=M,O=!1;y&&!O&&!y.classList.contains("vditor-reset");)y.getAttribute(_)===x?O=!0:y=y.parentElement;return O&&y},g=function(M){if(!M)return!1;M.nodeType===3&&(M=M.parentElement);var _=M,x=!1,y=p(M,"data-block","0");if(y)return y;for(;_&&!x&&!_.classList.contains("vditor-reset");)_.tagName==="H1"||_.tagName==="H2"||_.tagName==="H3"||_.tagName==="H4"||_.tagName==="H5"||_.tagName==="H6"||_.tagName==="P"||_.tagName==="BLOCKQUOTE"||_.tagName==="OL"||_.tagName==="UL"?x=!0:_=_.parentElement;return x&&_},v=function(M,_){if(!M)return!1;M.nodeType===3&&(M=M.parentElement);for(var x=M,y=!1;x&&!y&&!x.classList.contains("vditor-reset");)x.nodeName===_?y=!0:x=x.parentElement;return y&&x},b=function(M,_){if(!M)return!1;M.nodeType===3&&(M=M.parentElement);for(var x=M,y=!1;x&&!y&&!x.classList.contains("vditor-reset");)x.classList.contains(_)?y=!0:x=x.parentElement;return y&&x},k=function(M){for(;M&&M.lastChild;)M=M.lastChild;return M}},164:(m,f,w)=>{w.d(f,{c:()=>S,f:()=>T});var T=function(d,u){if(!d)return!1;d.nodeType===3&&(d=d.parentElement);for(var p=d,g=!1;p&&!g&&!p.classList.contains("vditor-reset");)p.nodeName.indexOf(u)===0?g=!0:p=p.parentElement;return g&&p},S=function(d){var u=T(d,"H");return u&&u.tagName.length===2&&u.tagName!=="HR"?u:!1}},905:(m,f,w)=>{w.d(f,{h:()=>T});var T=function(){for(var S=[],d=0;d<arguments.length;d++)S[d]=arguments[d];for(var u={},p=function(v){for(var b in v)v.hasOwnProperty(b)&&(Object.prototype.toString.call(v[b])==="[object Object]"?u[b]=T(u[b],v[b]):u[b]=v[b])},g=0;g<S.length;g++)p(S[g]);return u}},827:(m,f,w)=>{w.d(f,{Co:()=>g,ED:()=>b,Ey:()=>p,Fm:()=>k,RN:()=>u,Z2:()=>_,ir:()=>M,jl:()=>v});var T=w(913),S=w(629),d=w(598),u=function(x){var y,O=x[x.currentMode].element;return getSelection().rangeCount>0&&(y=getSelection().getRangeAt(0),O.isEqualNode(y.startContainer)||O.contains(y.startContainer))?y:x[x.currentMode].range?x[x.currentMode].range:(O.focus(),y=O.ownerDocument.createRange(),y.setStart(O,0),y.collapse(!0),y)},p=function(x){var y=window.getSelection().getRangeAt(0);if(!x.contains(y.startContainer)&&!(0,d.KJ)(y.startContainer,"vditor-panel--none"))return{left:0,top:0};var O=x.parentElement.getBoundingClientRect(),N;if(y.getClientRects().length===0)if(y.startContainer.nodeType===3){var F=y.startContainer.parentElement;if(F&&F.getClientRects().length>0)N=F.getClientRects()[0];else return{left:0,top:0}}else{var R=y.startContainer.children;if(R[y.startOffset]&&R[y.startOffset].getClientRects().length>0)N=R[y.startOffset].getClientRects()[0];else if(y.startContainer.childNodes.length>0){var I=y.cloneRange();y.selectNode(y.startContainer.childNodes[Math.max(0,y.startOffset-1)]),N=y.getClientRects()[0],y.setEnd(I.endContainer,I.endOffset),y.setStart(I.startContainer,I.startOffset)}else N=y.startContainer.getClientRects()[0];if(!N){for(var j=y.startContainer.childNodes[y.startOffset];!j.getClientRects||j.getClientRects&&j.getClientRects().length===0;)j=j.parentElement;N=j.getClientRects()[0]}}else N=y.getClientRects()[0];return{left:N.left-O.left,top:N.top-O.top}},g=function(x,y){if(!y){if(getSelection().rangeCount===0)return!1;y=getSelection().getRangeAt(0)}var O=y.commonAncestorContainer;return x.isEqualNode(O)||x.contains(O)},v=function(x){var y=window.getSelection();y.removeAllRanges(),y.addRange(x)},b=function(x,y,O){var N={end:0,start:0};if(!O){if(getSelection().rangeCount===0)return N;O=window.getSelection().getRangeAt(0)}if(g(y,O)){var F=O.cloneRange();x.childNodes[0]&&x.childNodes[0].childNodes[0]?F.setStart(x.childNodes[0].childNodes[0],0):F.selectNodeContents(x),F.setEnd(O.startContainer,O.startOffset),N.start=F.toString().length,N.end=N.start+O.toString().length}return N},k=function(x,y,O){var N=0,F=0,R=O.childNodes[F],I=!1,j=!1;x=Math.max(0,x),y=Math.max(0,y);var q=O.ownerDocument.createRange();for(q.setStart(R||O,0),q.collapse(!0);!j&&R;){var ne=N+R.textContent.length;if(!I&&x>=N&&x<=ne&&(x===0?q.setStart(R,0):R.childNodes[0].nodeType===3?q.setStart(R.childNodes[0],x-N):R.nextSibling?q.setStartBefore(R.nextSibling):q.setStartAfter(R),I=!0,x===y)){j=!0;break}I&&y>=N&&y<=ne&&(y===0?q.setEnd(R,0):R.childNodes[0].nodeType===3?q.setEnd(R.childNodes[0],y-N):R.nextSibling?q.setEndBefore(R.nextSibling):q.setEndAfter(R),j=!0),N=ne,R=O.childNodes[++F]}return!j&&O.childNodes[F-1]&&q.setStartBefore(O.childNodes[F-1]),v(q),q},M=function(x,y){var O=x.querySelector("wbr");if(O){if(!O.previousElementSibling)O.previousSibling?y.setStart(O.previousSibling,O.previousSibling.textContent.length):O.nextSibling?O.nextSibling.nodeType===3?y.setStart(O.nextSibling,0):y.setStartBefore(O.nextSibling):y.setStart(O.parentElement,0);else if(O.previousElementSibling.isSameNode(O.previousSibling))if(O.previousElementSibling.lastChild){y.setStartBefore(O),y.collapse(!0),v(y),(0,S.H8)()&&(O.previousElementSibling.tagName==="EM"||O.previousElementSibling.tagName==="STRONG"||O.previousElementSibling.tagName==="S")&&(y.insertNode(document.createTextNode(T.Y.ZWSP)),y.collapse(!1)),O.remove();return}else y.setStartAfter(O.previousElementSibling);else y.setStart(O.previousSibling,O.previousSibling.textContent.length);y.collapse(!0),O.remove(),v(y)}},_=function(x,y){var O=document.createElement("div");O.innerHTML=x;var N=O.querySelectorAll("p");N.length===1&&!N[0].previousSibling&&!N[0].nextSibling&&y[y.currentMode].element.children.length>0&&O.firstElementChild.tagName==="P"&&(x=N[0].innerHTML.trim());var F=document.createElement("div");F.innerHTML=x;var R=u(y);if(R.toString()!==""&&(y[y.currentMode].preventInput=!0,document.execCommand("delete",!1,"")),F.firstElementChild&&F.firstElementChild.getAttribute("data-block")==="0"){F.lastElementChild.insertAdjacentHTML("beforeend","<wbr>");var I=(0,d.pt)(R.startContainer);I?I.insertAdjacentHTML("afterend",F.innerHTML):y[y.currentMode].element.insertAdjacentHTML("beforeend",F.innerHTML),M(y[y.currentMode].element,R)}else{var j=document.createElement("template");j.innerHTML=x,R.insertNode(j.content.cloneNode(!0)),R.collapse(!1),v(R)}}}},s={};function c(m){var f=s[m];if(f!==void 0)return f.exports;var w=s[m]={exports:{}};return r[m](w,w.exports,c),w.exports}c.d=(m,f)=>{for(var w in f)c.o(f,w)&&!c.o(m,w)&&Object.defineProperty(m,w,{enumerable:!0,get:f[w]})},c.o=(m,f)=>Object.prototype.hasOwnProperty.call(m,f),c.r=m=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(m,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(m,"__esModule",{value:!0})};var h={};return(()=>{c.d(h,{default:()=>Zs});var m=c(923),f=c(913),w=c(695),T=function(e){return e.currentMode==="sv"?(0,w.p)("".concat(e.sv.element.textContent,`
`).replace(/\n\n$/,`
`)):e.currentMode==="wysiwyg"?e.lute.VditorDOM2Md(e.wysiwyg.element.innerHTML):e.currentMode==="ir"?e.lute.VditorIRDOM2Md(e.ir.element.innerHTML):""},S=c(161),d=function(){function e(){this.element=document.createElement("div"),this.element.className="vditor-devtools",this.element.innerHTML='<div class="vditor-reset--error"></div><div style="height: 100%;"></div>'}return e.prototype.renderEchart=function(t){var i=this;t.devtools.element.style.display==="block"&&(0,S.Z)("".concat(t.options.cdn,"/dist/js/echarts/echarts.min.js?v=5.5.1"),"vditorEchartsScript").then(function(){i.ASTChart||(i.ASTChart=echarts.init(t.devtools.element.lastElementChild));try{i.element.lastElementChild.style.display="block",i.element.firstElementChild.innerHTML="",i.ASTChart.setOption({series:[{data:JSON.parse(t.lute.RenderEChartsJSON(T(t))),initialTreeDepth:-1,label:{align:"left",backgroundColor:"rgba(68, 77, 86, .68)",borderRadius:3,color:"#d1d5da",fontSize:12,lineHeight:12,offset:[9,12],padding:[2,4,2,4],position:"top",verticalAlign:"middle"},lineStyle:{color:"#4285f4",type:"curve",width:1},orient:"vertical",roam:!0,type:"tree"}],toolbox:{bottom:25,emphasis:{iconStyle:{color:"#4285f4"}},feature:{restore:{show:!0},saveAsImage:{show:!0}},right:15,show:!0}}),i.ASTChart.resize()}catch(a){i.element.lastElementChild.style.display="none",i.element.firstElementChild.innerHTML=a}})},e}(),u=c(629),p=function(e,t){t.forEach(function(i){if(e[i]){var a=e[i].children[0];a&&a.classList.contains("vditor-menu--current")&&a.classList.remove("vditor-menu--current")}})},g=function(e,t){t.forEach(function(i){if(e[i]){var a=e[i].children[0];a&&!a.classList.contains("vditor-menu--current")&&a.classList.add("vditor-menu--current")}})},v=function(e,t){t.forEach(function(i){if(e[i]){var a=e[i].children[0];a&&a.classList.contains(f.Y.CLASS_MENU_DISABLED)&&a.classList.remove(f.Y.CLASS_MENU_DISABLED)}})},b=function(e,t){t.forEach(function(i){if(e[i]){var a=e[i].children[0];a&&!a.classList.contains(f.Y.CLASS_MENU_DISABLED)&&a.classList.add(f.Y.CLASS_MENU_DISABLED)}})},k=function(e,t){t.forEach(function(i){e[i]&&e[i]&&(e[i].style.display="none")})},M=function(e,t){t.forEach(function(i){e[i]&&e[i]&&(e[i].style.display="block")})},_=function(e,t,i){t.includes("subToolbar")&&(e.toolbar.element.querySelectorAll(".vditor-hint").forEach(function(a){i&&a.isEqualNode(i)||(a.style.display="none")}),e.toolbar.elements.emoji&&(e.toolbar.elements.emoji.lastElementChild.style.display="none")),t.includes("hint")&&(e.hint.element.style.display="none"),e.wysiwyg.popover&&t.includes("popover")&&(e.wysiwyg.popover.style.display="none")},x=function(e,t,i,a){i.addEventListener((0,u.y3)(),function(o){o.preventDefault(),o.stopPropagation(),!i.classList.contains(f.Y.CLASS_MENU_DISABLED)&&(e.toolbar.element.querySelectorAll(".vditor-hint--current").forEach(function(l){l.classList.remove("vditor-hint--current")}),t.style.display==="block"?t.style.display="none":(_(e,["subToolbar","hint","popover"],i.parentElement.parentElement),i.classList.contains("vditor-tooltipped")||i.classList.add("vditor-hint--current"),t.style.display="block",e.toolbar.element.getBoundingClientRect().right-i.getBoundingClientRect().right<250?t.classList.add("vditor-panel--left"):t.classList.remove("vditor-panel--left")))})},y=c(598),O=c(164),N=function(e,t,i,a){a&&console.log("".concat(e," - ").concat(i,": ").concat(t))},F=c(288),R=c(784),I=c(51),j=c(500),q=c(339),ne=c(108),ce=c(960),ke=c(975),Se=c(597),Ee=c(162),me=c(591),Me=c(931),oe=function(e,t,i){i===void 0&&(i="sv");var a=document.createElement("div");a.innerHTML=e;var o=!1;a.childElementCount===1&&a.lastElementChild.style.fontFamily.indexOf("monospace")>-1&&(o=!0);var l=a.querySelectorAll("pre");if(a.childElementCount===1&&l.length===1&&l[0].className!=="vditor-wysiwyg"&&l[0].className!=="vditor-sv"&&(o=!0),e.indexOf(`
<p class="p1">`)===0&&(o=!0),a.childElementCount===1&&a.firstElementChild.tagName==="TABLE"&&a.querySelector(".line-number")&&a.querySelector(".line-content")&&(o=!0),o){var E=t||e;return/\n/.test(E)||l.length===1?i==="wysiwyg"?'<div class="vditor-wysiwyg__block" data-block="0" data-type="code-block"><pre><code>'.concat(E.replace(/&/g,"&amp;").replace(/</g,"&lt;"),"<wbr></code></pre></div>"):"\n```\n"+E.replace(/&/g,"&amp;").replace(/</g,"&lt;")+"\n```":i==="wysiwyg"?"<code>".concat(E.replace(/&/g,"&amp;").replace(/</g,"&lt;"),"</code><wbr>"):"`".concat(E,"`")}return!1},le=function(e,t){if(e){if(e.parentElement.getAttribute("data-type")==="html-block"){e.setAttribute("data-render","1");return}var i=e.firstElementChild.className.replace("language-","");if(i==="abc")(0,F.$)(e,t.options.cdn);else if(i==="mermaid")(0,ke.e)(e,t.options.cdn,t.options.theme);else if(i==="smiles")(0,Me.Y)(e,t.options.cdn,t.options.theme);else if(i==="markmap")(0,Se.K)(e,t.options.cdn);else if(i==="flowchart")(0,j.D)(e,t.options.cdn);else if(i==="echarts")(0,R.v)(e,t.options.cdn,t.options.theme);else if(i==="mindmap")(0,Ee.l)(e,t.options.cdn,t.options.theme);else if(i==="plantuml")(0,me.M)(e,t.options.cdn);else if(i==="graphviz")(0,q.m)(e,t.options.cdn);else if(i==="math")(0,ce.T)(e,{cdn:t.options.cdn,math:t.options.preview.math});else{var a=t.options.customRenders.find(function(o){if(o.language===i)return o.render(e,t),!0});a||((0,ne.$)(Object.assign({},t.options.preview.hljs),e,t.options.cdn),(0,I.o)(e,t.options.preview.hljs))}e.setAttribute("data-render","1")}},H=c(827),de=function(e){if(e.currentMode!=="sv"){var t=e[e.currentMode].element,i=e.outline.render(e);i===""&&(i="[ToC]"),t.querySelectorAll('[data-type="toc-block"]').forEach(function(a){a.innerHTML=i,(0,ce.T)(a,{cdn:e.options.cdn,math:e.options.preview.math})})}},Z=function(e,t){var i=(0,y._Y)(e.target,"SPAN");if(i&&(0,y.KJ)(i,"vditor-toc")){var a=t[t.currentMode].element.querySelector("#"+i.getAttribute("data-target-id"));if(a)if(t.options.height==="auto"){var o=a.offsetTop+t.element.offsetTop;t.options.toolbarConfig.pin||(o+=t.toolbar.element.offsetHeight),window.scrollTo(window.scrollX,o)}else t.element.offsetTop<window.scrollY&&window.scrollTo(window.scrollX,t.element.offsetTop),t[t.currentMode].element.scrollTop=a.offsetTop;return}},Y=function(e,t,i,a){if(e.previousElementSibling&&e.previousElementSibling.classList.contains("vditor-toc")){if(i.key==="Backspace"&&(0,H.ED)(e,t[t.currentMode].element,a).start===0)return e.previousElementSibling.remove(),Ne(t),!0;if(yn(t,i,a,e,e.previousElementSibling))return!0}if(e.nextElementSibling&&e.nextElementSibling.classList.contains("vditor-toc")){if(i.key==="Delete"&&(0,H.ED)(e,t[t.currentMode].element,a).start>=e.textContent.trimRight().length)return e.nextElementSibling.remove(),Ne(t),!0;if(jn(t,i,a,e,e.nextElementSibling))return!0}if(i.key==="Backspace"||i.key==="Delete"){var o=(0,y.KJ)(a.startContainer,"vditor-toc");if(o)return o.remove(),Ne(t),!0}},J=function(e,t,i,a){i===void 0&&(i=!1);var o=(0,y.pt)(t.startContainer);if(o&&!i&&o.getAttribute("data-type")!=="code-block"){if(Ui(o.innerHTML)&&o.previousElementSibling||Vi(o.innerHTML))return;for(var l=(0,H.ED)(o,e.ir.element,t).start,E=!0,L=l-1;L>o.textContent.substr(0,l).lastIndexOf(`
`);L--)if(o.textContent.charAt(L)!==" "&&o.textContent.charAt(L)!=="	"){E=!1;break}l===0&&(E=!1);for(var D=!0,L=l-1;L<o.textContent.length;L++)if(o.textContent.charAt(L)!==" "&&o.textContent.charAt(L)!==`
`){D=!1;break}if(E){typeof e.options.input=="function"&&e.options.input(T(e));return}if(D&&/^#{1,6} $/.test(o.textContent)&&(D=!1),D){var A=(0,y.KJ)(t.startContainer,"vditor-ir__marker");if(!A){var P=t.startContainer.previousSibling;P&&P.nodeType!==3&&P.classList.contains("vditor-ir__node--expand")&&P.classList.remove("vditor-ir__node--expand"),typeof e.options.input=="function"&&e.options.input(T(e));return}}}if(e.ir.element.querySelectorAll(".vditor-ir__node--expand").forEach(function(Re){Re.classList.remove("vditor-ir__node--expand")}),o||(o=e.ir.element),!o.querySelector("wbr")){var U=(0,y.KJ)(t.startContainer,"vditor-ir__preview");U?U.previousElementSibling.insertAdjacentHTML("beforeend","<wbr>"):t.insertNode(document.createElement("wbr"))}o.querySelectorAll("[style]").forEach(function(Re){Re.removeAttribute("style")}),o.getAttribute("data-type")==="link-ref-defs-block"&&(o=e.ir.element);var re=o.isEqualNode(e.ir.element),ie=(0,y.Th)(o,"data-type","footnotes-block"),te="";if(re)te=o.innerHTML;else{var be=(0,O.f)(t.startContainer,"BLOCKQUOTE"),he=(0,y.KR)(t.startContainer);if(he&&(o=he),be&&(!he||he&&!be.contains(he))&&(o=be),ie&&(o=ie),te=o.outerHTML,o.tagName==="UL"||o.tagName==="OL"){var ee=o.previousElementSibling,xe=o.nextElementSibling;ee&&(ee.tagName==="UL"||ee.tagName==="OL")&&(te=ee.outerHTML+te,ee.remove()),xe&&(xe.tagName==="UL"||xe.tagName==="OL")&&(te=te+xe.outerHTML,xe.remove()),te=te.replace("<div><wbr><br></div>","<li><p><wbr><br></p></li>")}else o.previousElementSibling&&o.previousElementSibling.textContent.replace(f.Y.ZWSP,"")!==""&&a&&a.inputType==="insertParagraph"&&(te=o.previousElementSibling.outerHTML+te,o.previousElementSibling.remove());o.innerText.startsWith("```")||(e.ir.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(Re){Re&&!o.isEqualNode(Re)&&(te+=Re.outerHTML,Re.remove())}),e.ir.element.querySelectorAll("[data-type='footnotes-block']").forEach(function(Re){Re&&!o.isEqualNode(Re)&&(te+=Re.outerHTML,Re.remove())}))}if(N("SpinVditorIRDOM",te,"argument",e.options.debugger),te=e.lute.SpinVditorIRDOM(te),N("SpinVditorIRDOM",te,"result",e.options.debugger),re)o.innerHTML=te;else if(o.outerHTML=te,ie){var ve=(0,y.Th)(e.ir.element.querySelector("wbr"),"data-type","footnotes-def");if(ve){var _e=ve.textContent,Ke=_e.substring(1,_e.indexOf("]:")),We=e.ir.element.querySelector('sup[data-type="footnotes-ref"][data-footnotes-label="'.concat(Ke,'"]'));We&&We.setAttribute("aria-label",_e.substr(Ke.length+3).trim().substr(0,24))}}var Ge,mt=e.ir.element.querySelectorAll("[data-type='link-ref-defs-block']");mt.forEach(function(Re,it){it===0?Ge=Re:(Ge.insertAdjacentHTML("beforeend",Re.innerHTML),Re.remove())}),mt.length>0&&e.ir.element.insertAdjacentElement("beforeend",mt[0]);var dt,gt=e.ir.element.querySelectorAll("[data-type='footnotes-block']");gt.forEach(function(Re,it){it===0?dt=Re:(dt.insertAdjacentHTML("beforeend",Re.innerHTML),Re.remove())}),gt.length>0&&e.ir.element.insertAdjacentElement("beforeend",gt[0]),(0,H.ir)(e.ir.element,t),e.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach(function(Re){le(Re,e)}),de(e),Ut(e,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},z=function(e,t){if(e==="")return!1;if(e.indexOf("⇧")===-1&&e.indexOf("⌘")===-1&&e.indexOf("⌥")===-1)return!(0,u._0)(t)&&!t.altKey&&!t.shiftKey&&t.code===e;if(e==="⇧Tab")return!!(!(0,u._0)(t)&&!t.altKey&&t.shiftKey&&t.code==="Tab");var i=e.split("");if(e.startsWith("⌥")){var a=i.length===3?i[2]:i[1];return!!((i.length===3?(0,u._0)(t):!(0,u._0)(t))&&t.altKey&&!t.shiftKey&&t.code===(/^[0-9]$/.test(a)?"Digit":"Key")+a)}e==="⌘Enter"&&(i=["⌘","Enter"]);var o=i.length>2&&i[0]==="⇧",l=o?i[2]:i[1];return o&&((0,u.gm)()||!/Mac/.test(navigator.platform))&&(l==="-"?l="_":l==="="&&(l="+")),!!((0,u._0)(t)&&t.key.toLowerCase()===l.toLowerCase()&&!t.altKey&&(!o&&!t.shiftKey||o&&t.shiftKey))},Q=function(e){var t=e.startContainer;if(t.nodeType===3&&t.nodeValue.length!==e.startOffset)return!1;for(var i=t.nextSibling;i&&i.textContent==="";)i=i.nextSibling;if(i){if(i&&i.nodeType!==3&&i.classList.contains("vditor-ir__node")&&!i.getAttribute("data-block"))return i}else{var a=(0,y.KJ)(t,"vditor-ir__marker");if(a&&!a.nextSibling){var o=t.parentElement.parentElement.nextSibling;if(o&&o.nodeType!==3&&o.classList.contains("vditor-ir__node"))return o}return!1}return!1},K=function(e){var t=e.startContainer,i=t.previousSibling;return t.nodeType===3&&e.startOffset===0&&i&&i.nodeType!==3&&i.classList.contains("vditor-ir__node")&&!i.getAttribute("data-block")?i:!1},B=function(e,t){t.ir.element.querySelectorAll(".vditor-ir__node--expand").forEach(function(E){E.classList.remove("vditor-ir__node--expand")});var i=(0,y.XW)(e.startContainer,"vditor-ir__node"),a=!e.collapsed&&(0,y.XW)(e.endContainer,"vditor-ir__node");if(!(!e.collapsed&&(!i||i!==a))){i&&(i.classList.add("vditor-ir__node--expand"),i.classList.remove("vditor-ir__node--hidden"),(0,H.jl)(e));var o=Q(e);if(o){o.classList.add("vditor-ir__node--expand"),o.classList.remove("vditor-ir__node--hidden");return}var l=K(e);if(l){l.classList.add("vditor-ir__node--expand"),l.classList.remove("vditor-ir__node--hidden");return}}},Te=function(e,t){if(e.ir.composingLock=t.isComposing,t.isComposing)return!1;t.key.indexOf("Arrow")===-1&&t.key!=="Meta"&&t.key!=="Control"&&t.key!=="Alt"&&t.key!=="Shift"&&t.key!=="CapsLock"&&t.key!=="Escape"&&!/^F\d{1,2}$/.test(t.key)&&e.undo.recordFirstPosition(e,t);var i=(0,H.RN)(e),a=i.startContainer;if(!Or(t,e,a)||(Pr(i,e,t),Kr(i),t.key!=="Enter"&&t.key!=="Tab"&&t.key!=="Backspace"&&t.key.indexOf("Arrow")===-1&&!(0,u._0)(t)&&t.key!=="Escape"&&t.key!=="Delete"))return!1;var o=(0,y.Th)(a,"data-newline","1");if(!(0,u._0)(t)&&!t.altKey&&!t.shiftKey&&t.key==="Enter"&&o&&i.startOffset<o.textContent.length){var l=o.previousElementSibling;l&&(i.insertNode(document.createTextNode(l.textContent)),i.collapse(!1));var E=o.nextSibling;E&&(i.insertNode(document.createTextNode(E.textContent)),i.collapse(!0))}var L=(0,y._Y)(a,"P");if(jr(t,e,L,i)||Nr(i,e,L,t)||qr(e,i,t,L))return!0;var D=(0,y.KJ)(a,"vditor-ir__marker--pre");if(D&&D.tagName==="PRE"){var A=D.firstChild;if(Vr(e,t,D,i)||(A.getAttribute("data-type")==="math-block"||A.getAttribute("data-type")==="html-block")&&yn(e,t,i,A,D.parentElement)||jn(e,t,i,A,D.parentElement))return!0}var P=(0,y.Th)(a,"data-type","code-block-info");if(P){if(t.key==="Enter"||t.key==="Tab")return i.selectNodeContents(P.nextElementSibling.firstChild),i.collapse(!0),t.preventDefault(),_(e,["hint"]),!0;if(t.key==="Backspace"){var U=(0,H.ED)(P,e.ir.element).start;U===1&&i.setStart(a,0),U===2&&(e.hint.recentLanguage="")}if(yn(e,t,i,P,P.parentElement))return _(e,["hint"]),!0}var re=(0,y._Y)(a,"TD")||(0,y._Y)(a,"TH");if(t.key.indexOf("Arrow")>-1&&re){var ie=Ro(re);if(ie&&yn(e,t,i,re,ie))return!0;var te=Io(re);if(te&&jn(e,t,i,re,te))return!0}if(Ur(e,t,i)||Wr(e,i,t)||qi(e,i,t))return!0;var be=(0,O.c)(a);if(be){if(z("⌘=",t)){var he=be.querySelector(".vditor-ir__marker--heading");return he&&he.textContent.trim().length>1&&Bn(e,he.textContent.substr(1)),t.preventDefault(),!0}if(z("⌘-",t)){var he=be.querySelector(".vditor-ir__marker--heading");return he&&he.textContent.trim().length<6&&Bn(e,he.textContent.trim()+"# "),t.preventDefault(),!0}}var ee=(0,y.pt)(a);if(t.key==="Backspace"&&!(0,u._0)(t)&&!t.shiftKey&&!t.altKey&&i.toString()===""){if(Yr(e,i,t,L))return!0;if(ee&&ee.previousElementSibling&&ee.tagName!=="UL"&&ee.tagName!=="OL"&&(ee.previousElementSibling.getAttribute("data-type")==="code-block"||ee.previousElementSibling.getAttribute("data-type")==="math-block")){var xe=(0,H.ED)(ee,e.ir.element,i).start;if(xe===0||xe===1&&ee.innerText.startsWith(f.Y.ZWSP))return i.selectNodeContents(ee.previousElementSibling.querySelector(".vditor-ir__marker--pre code")),i.collapse(!1),B(i,e),ee.textContent.trim().replace(f.Y.ZWSP,"")===""&&(ee.remove(),Ut(e)),t.preventDefault(),!0}if(be){var ve=be.firstElementChild.textContent.length;(0,H.ED)(be,e.ir.element).start===ve&&ve!==0&&(i.setStart(be.firstElementChild.firstChild,ve-1),i.collapse(!0),(0,H.jl)(i))}}return(t.key==="ArrowUp"||t.key==="ArrowDown")&&ee&&(ee.querySelectorAll(".vditor-ir__node").forEach(function(_e){_e.contains(a)||_e.classList.add("vditor-ir__node--hidden")}),Gr(t,ee,i))?!0:(Rr(i,t.key),ee&&Y(ee,e,t,i)?(t.preventDefault(),!0):!1)},se=c(726),je=function(e,t){e.querySelectorAll("[data-type=footnotes-link]").forEach(function(i){for(var a=i.parentElement,o=a.nextSibling;o&&o.textContent.startsWith("    ");){var l=o;l.childNodes.forEach(function(E){a.append(E.cloneNode(!0))}),o=o.nextSibling,l.remove()}t&&t(a)})},V=function(e,t){var i,a=getSelection().getRangeAt(0).cloneRange(),o=a.startContainer;a.startContainer.nodeType!==3&&a.startContainer.tagName==="DIV"&&(o=a.startContainer.childNodes[a.startOffset-1]);var l=(0,y.Th)(o,"data-block","0");if(l&&t&&(t.inputType==="deleteContentBackward"||t.data===" ")){for(var E=(0,H.ED)(l,e.sv.element,a).start,L=!0,D=E-1;D>l.textContent.substr(0,E).lastIndexOf(`
`);D--)if(l.textContent.charAt(D)!==" "&&l.textContent.charAt(D)!=="	"){L=!1;break}if(E===0&&(L=!1),L){at(e);return}if(t.inputType==="deleteContentBackward"){var A=(0,y.Th)(o,"data-type","code-block-open-marker")||(0,y.Th)(o,"data-type","code-block-close-marker");if(A){if(A.getAttribute("data-type")==="code-block-close-marker"){var P=Qn(o,"code-block-open-marker");if(P){P.textContent=A.textContent,at(e);return}}if(A.getAttribute("data-type")==="code-block-open-marker"){var P=Qn(o,"code-block-close-marker",!1);if(P){P.textContent=A.textContent,at(e);return}}}var U=(0,y.Th)(o,"data-type","math-block-open-marker");if(U){var re=U.nextElementSibling.nextElementSibling;re&&re.getAttribute("data-type")==="math-block-close-marker"&&(re.remove(),at(e));return}l.querySelectorAll('[data-type="code-block-open-marker"]').forEach(function(ee){ee.textContent.length===1&&ee.remove()}),l.querySelectorAll('[data-type="code-block-close-marker"]').forEach(function(ee){ee.textContent.length===1&&ee.remove()});var ie=(0,y.Th)(o,"data-type","heading-marker");if(ie&&ie.textContent.indexOf("#")===-1){at(e);return}}if((t.data===" "||t.inputType==="deleteContentBackward")&&((0,y.Th)(o,"data-type","padding")||(0,y.Th)(o,"data-type","li-marker")||(0,y.Th)(o,"data-type","task-marker")||(0,y.Th)(o,"data-type","blockquote-marker"))){at(e);return}}if(l&&l.textContent.trimRight()==="$$"){at(e);return}l||(l=e.sv.element),((i=l.firstElementChild)===null||i===void 0?void 0:i.getAttribute("data-type"))==="link-ref-defs-block"&&(l=e.sv.element),(0,y.Th)(o,"data-type","footnotes-link")&&(l=e.sv.element),l.textContent.indexOf(Lute.Caret)===-1&&a.insertNode(document.createTextNode(Lute.Caret)),l.querySelectorAll("[style]").forEach(function(ee){ee.removeAttribute("style")}),l.querySelectorAll("font").forEach(function(ee){ee.outerHTML=ee.innerHTML});var te=l.textContent,be=l.isEqualNode(e.sv.element);if(be)te=l.textContent;else{l.previousElementSibling&&(te=l.previousElementSibling.textContent+te,l.previousElementSibling.remove()),l.previousElementSibling&&te.indexOf(`---
`)===0&&(te=l.previousElementSibling.textContent+te,l.previousElementSibling.remove());var he="";e.sv.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(ee,xe){ee&&!l.isEqualNode(ee.parentElement)&&(he+=ee.parentElement.textContent+`
`,ee.parentElement.remove())}),e.sv.element.querySelectorAll("[data-type='footnotes-link']").forEach(function(ee,xe){ee&&!l.isEqualNode(ee.parentElement)&&(he+=ee.parentElement.textContent+`
`,ee.parentElement.remove())}),te=he+te}te=_r(te,e),be?l.innerHTML=te:l.outerHTML=te,e.sv.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(ee){e.sv.element.insertAdjacentElement("beforeend",ee.parentElement)}),je(e.sv.element,function(ee){e.sv.element.insertAdjacentElement("beforeend",ee)}),(0,H.ir)(e.sv.element,a),nt(e),at(e,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},$=function(e,t){var i,a,o,l,E;if(e.sv.composingLock=t.isComposing,t.isComposing||(t.key.indexOf("Arrow")===-1&&t.key!=="Meta"&&t.key!=="Control"&&t.key!=="Alt"&&t.key!=="Shift"&&t.key!=="CapsLock"&&t.key!=="Escape"&&!/^F\d{1,2}$/.test(t.key)&&e.undo.recordFirstPosition(e,t),t.key!=="Enter"&&t.key!=="Tab"&&t.key!=="Backspace"&&t.key.indexOf("Arrow")===-1&&!(0,u._0)(t)&&t.key!=="Escape"))return!1;var L=(0,H.RN)(e),D=L.startContainer;L.startContainer.nodeType!==3&&L.startContainer.tagName==="DIV"&&(D=L.startContainer.childNodes[L.startOffset-1]);var A=(0,y.Th)(D,"data-type","text"),P=(0,y.Th)(D,"data-type","blockquote-marker");if(!P&&L.startOffset===0&&A&&A.previousElementSibling&&A.previousElementSibling.getAttribute("data-type")==="blockquote-marker"&&(P=A.previousElementSibling),P&&t.key==="Enter"&&!(0,u._0)(t)&&!t.altKey&&P.nextElementSibling.textContent.trim()===""&&(0,H.ED)(P,e.sv.element,L).start===P.textContent.length)return((i=P.previousElementSibling)===null||i===void 0?void 0:i.getAttribute("data-type"))==="padding"&&P.previousElementSibling.setAttribute("data-action","enter-remove"),P.remove(),at(e),t.preventDefault(),!0;var U=(0,y.Th)(D,"data-type","li-marker"),re=(0,y.Th)(D,"data-type","task-marker"),ie=U;if(ie||re&&re.nextElementSibling.getAttribute("data-type")!=="task-marker"&&(ie=re),!ie&&L.startOffset===0&&A&&A.previousElementSibling&&(A.previousElementSibling.getAttribute("data-type")==="li-marker"||A.previousElementSibling.getAttribute("data-type")==="task-marker")&&(ie=A.previousElementSibling),ie){var te=(0,H.ED)(ie,e.sv.element,L).start,be=ie.getAttribute("data-type")==="task-marker",he=ie;if(be&&(he=ie.previousElementSibling.previousElementSibling.previousElementSibling),te===ie.textContent.length){if(t.key==="Enter"&&!(0,u._0)(t)&&!t.altKey&&!t.shiftKey&&ie.nextElementSibling.textContent.trim()==="")return((a=he.previousElementSibling)===null||a===void 0?void 0:a.getAttribute("data-type"))==="padding"?(he.previousElementSibling.remove(),V(e)):(be&&(he.remove(),ie.previousElementSibling.previousElementSibling.remove(),ie.previousElementSibling.remove()),ie.nextElementSibling.remove(),ie.remove(),at(e)),t.preventDefault(),!0;if(t.key==="Tab")return t.shiftKey?he.previousElementSibling.getAttribute("data-type")==="padding"&&he.previousElementSibling.remove():he.insertAdjacentHTML("beforebegin",'<span data-type="padding">'.concat(he.textContent.replace(/\S/g," "),"</span>")),/^\d/.test(he.textContent)&&(he.textContent=he.textContent.replace(/^\d{1,}/,"1"),L.selectNodeContents(ie.firstChild),L.collapse(!1)),V(e),t.preventDefault(),!0}}if(qi(e,L,t))return!0;var ee=(0,y.Th)(D,"data-block","0"),xe=(0,O.f)(D,"SPAN");if(t.key==="Enter"&&!(0,u._0)(t)&&!t.altKey&&!t.shiftKey&&ee){var ve=!1,_e=ee.textContent.match(/^\n+/);(0,H.ED)(ee,e.sv.element).start<=(_e?_e[0].length:0)&&(ve=!0);var Ke=`
`;if(xe){if(((o=xe.previousElementSibling)===null||o===void 0?void 0:o.getAttribute("data-action"))==="enter-remove")return xe.previousElementSibling.remove(),at(e),t.preventDefault(),!0;Ke+=To(xe)}return L.insertNode(document.createTextNode(Ke)),L.collapse(!1),ee&&ee.textContent.trim()!==""&&!ve?V(e):at(e),t.preventDefault(),!0}if(t.key==="Backspace"&&!(0,u._0)(t)&&!t.altKey&&!t.shiftKey){if(xe&&((l=xe.previousElementSibling)===null||l===void 0?void 0:l.getAttribute("data-type"))==="newline"&&(0,H.ED)(xe,e.sv.element,L).start===1&&xe.getAttribute("data-type").indexOf("code-block-")===-1)return L.setStart(xe,0),L.extractContents(),xe.textContent.trim()!==""?V(e):at(e),t.preventDefault(),!0;if(ee&&(0,H.ED)(ee,e.sv.element,L).start===0&&ee.previousElementSibling){L.extractContents();var We=ee.previousElementSibling.lastElementChild;return We.getAttribute("data-type")==="newline"&&(We.remove(),We=ee.previousElementSibling.lastElementChild),We.getAttribute("data-type")!=="newline"&&(We.insertAdjacentHTML("afterend",ee.innerHTML),ee.remove()),ee.textContent.trim()!==""&&!(!((E=ee.previousElementSibling)===null||E===void 0)&&E.querySelector('[data-type="code-block-open-marker"]'))?V(e):(We.getAttribute("data-type")!=="newline"&&(L.selectNodeContents(We.lastChild),L.collapse(!1)),at(e)),t.preventDefault(),!0}}return!1},W=c(873),X=function(e){e.options.theme==="dark"?e.element.classList.add("vditor--dark"):e.element.classList.remove("vditor--dark")},we=function(e){e.element.innerHTML="",e.element.classList.add("vditor"),e.options.rtl&&e.element.setAttribute("dir","rtl"),X(e),(0,W.H)(e.options.preview.theme.current,e.options.preview.theme.path),typeof e.options.height=="number"?e.element.style.height=e.options.height+"px":e.element.style.height=e.options.height,typeof e.options.minHeight=="number"&&(e.element.style.minHeight=e.options.minHeight+"px"),typeof e.options.width=="number"?e.element.style.width=e.options.width+"px":e.element.style.width=e.options.width,e.element.appendChild(e.toolbar.element);var t=document.createElement("div");if(t.className="vditor-content",e.options.outline.position==="left"&&t.appendChild(e.outline.element),t.appendChild(e.wysiwyg.element.parentElement),t.appendChild(e.sv.element),t.appendChild(e.ir.element.parentElement),t.appendChild(e.preview.element),e.toolbar.elements.devtools&&t.appendChild(e.devtools.element),e.options.outline.position==="right"&&(e.outline.element.classList.add("vditor-outline--right"),t.appendChild(e.outline.element)),e.upload&&t.appendChild(e.upload.element),e.options.resize.enable&&t.appendChild(e.resize.element),t.appendChild(e.hint.element),t.appendChild(e.tip.element),e.element.appendChild(t),t.addEventListener("click",function(){_(e,["subToolbar"])}),e.toolbar.elements.export&&e.element.insertAdjacentHTML("beforeend",'<iframe id="vditorExportIframe" style="width: 100%;height: 0;border: 0"></iframe>'),tn(e,e.options.mode,Gt(e)),document.execCommand("DefaultParagraphSeparator",!1,"p"),navigator.userAgent.indexOf("iPhone")>-1&&typeof window.visualViewport<"u"){var i=!1,a=function(o){i||(i=!0,requestAnimationFrame(function(){i=!1;var l=e.toolbar.element;l.style.transform="none",l.getBoundingClientRect().top<0&&(l.style.transform="translate(0, ".concat(-l.getBoundingClientRect().top,"px)"))}))};window.visualViewport.addEventListener("scroll",a),window.visualViewport.addEventListener("resize",a)}},Oe=function(e){var t=window.innerWidth<=f.Y.MOBILE_WIDTH?10:35;if(e.wysiwyg.element.parentElement.style.display!=="none"){var i=(e.wysiwyg.element.parentElement.clientWidth-e.options.preview.maxWidth)/2;e.wysiwyg.element.style.padding="10px ".concat(Math.max(t,i),"px")}if(e.ir.element.parentElement.style.display!=="none"){var i=(e.ir.element.parentElement.clientWidth-e.options.preview.maxWidth)/2;e.ir.element.style.padding="10px ".concat(Math.max(t,i),"px")}e.preview.element.style.display!=="block"?e.toolbar.element.style.paddingLeft=Math.max(5,parseInt(e[e.currentMode].element.style.paddingLeft||"0",10)+(e.options.outline.position==="left"?e.outline.element.offsetWidth:0))+"px":e.toolbar.element.style.paddingLeft=5+(e.options.outline.position==="left"?e.outline.element.offsetWidth:0)+"px"},tt=function(e){if(e.options.typewriterMode){var t=window.innerHeight;typeof e.options.height=="number"?(t=e.options.height,typeof e.options.minHeight=="number"&&(t=Math.max(t,e.options.minHeight)),t=Math.min(window.innerHeight,t)):t=e.element.clientHeight,e.element.classList.contains("vditor--fullscreen")&&(t=window.innerHeight),e[e.currentMode].element.style.setProperty("--editor-bottom",(t-e.toolbar.element.offsetHeight)/2+"px")}},ct;function De(){window.removeEventListener("resize",ct)}var Gt=function(e){tt(e),De(),window.addEventListener("resize",ct=function(){Oe(e),tt(e)});var t=(0,u.D)()&&localStorage.getItem(e.options.cache.id);return(!e.options.cache.enable||!t)&&(e.options.value?t=e.options.value:e.originalInnerHTML?t=e.lute.HTML2Md(e.originalInnerHTML):e.options.cache.enable||(t="")),t||""},ut=function(e){clearTimeout(e[e.currentMode].hlToolbarTimeoutId),e[e.currentMode].hlToolbarTimeoutId=window.setTimeout(function(){if(e[e.currentMode].element.getAttribute("contenteditable")!=="false"&&(0,H.Co)(e[e.currentMode].element)){p(e.toolbar.elements,f.Y.EDIT_TOOLBARS),v(e.toolbar.elements,f.Y.EDIT_TOOLBARS);var t=(0,H.RN)(e),i=t.startContainer;t.startContainer.nodeType===3&&(i=t.startContainer.parentElement),i.classList.contains("vditor-reset")&&(i=i.childNodes[t.startOffset]);var a=e.currentMode==="sv"?(0,y.Th)(i,"data-type","heading"):(0,O.c)(i);a&&g(e.toolbar.elements,["headings"]);var o=e.currentMode==="sv"?(0,y.Th)(i,"data-type","blockquote"):(0,y._Y)(i,"BLOCKQUOTE");o&&g(e.toolbar.elements,["quote"]);var l=(0,y.Th)(i,"data-type","strong");l&&g(e.toolbar.elements,["bold"]);var E=(0,y.Th)(i,"data-type","em");E&&g(e.toolbar.elements,["italic"]);var L=(0,y.Th)(i,"data-type","s");L&&g(e.toolbar.elements,["strike"]);var D=(0,y.Th)(i,"data-type","a");D&&g(e.toolbar.elements,["link"]);var A=(0,y._Y)(i,"LI");A?(A.classList.contains("vditor-task")?g(e.toolbar.elements,["check"]):A.parentElement.tagName==="OL"?g(e.toolbar.elements,["ordered-list"]):A.parentElement.tagName==="UL"&&g(e.toolbar.elements,["list"]),v(e.toolbar.elements,["outdent","indent"])):b(e.toolbar.elements,["outdent","indent"]);var P=(0,y.Th)(i,"data-type","code-block");P&&(b(e.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","inline-code","upload","link","table","record"]),g(e.toolbar.elements,["code"]));var U=(0,y.Th)(i,"data-type","code");U&&(b(e.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","upload","link","table","record"]),g(e.toolbar.elements,["inline-code"]));var re=(0,y.Th)(i,"data-type","table");re&&b(e.toolbar.elements,["headings","list","ordered-list","check","line","quote","code","table"])}},200)},Ie=function(e,t){t===void 0&&(t={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),t.enableHint&&e.hint.render(e),clearTimeout(e.wysiwyg.afterRenderTimeoutId),e.wysiwyg.afterRenderTimeoutId=window.setTimeout(function(){if(!e.wysiwyg.composingLock){var i=T(e);typeof e.options.input=="function"&&t.enableInput&&e.options.input(i),e.options.counter.enable&&e.counter.render(e,i),e.options.cache.enable&&(0,u.D)()&&(localStorage.setItem(e.options.cache.id,i),e.options.cache.after&&e.options.cache.after(i)),e.devtools&&e.devtools.renderEchart(e),t.enableAddUndoStack&&e.undo.addToUndoStack(e)}},e.options.undoDelay)},Et=function(e){for(var t=e.previousSibling;t;){if(t.nodeType!==3&&t.tagName==="A"&&!t.previousSibling&&t.innerHTML.replace(f.Y.ZWSP,"")===""&&t.nextSibling)return t;t=t.previousSibling}return!1},On=function(e){for(var t=e.startContainer.nextSibling;t&&t.textContent==="";)t=t.nextSibling;return!!(t&&t.nodeType!==3&&(t.tagName==="CODE"||t.getAttribute("data-type")==="math-inline"||t.getAttribute("data-type")==="html-entity"||t.getAttribute("data-type")==="html-inline"))},Xn=function(e){for(var t="",i=e.nextSibling;i;)i.nodeType===3?t+=i.textContent:t+=i.outerHTML,i=i.nextSibling;return t},Ft=function(e){for(var t="",i=e.previousSibling;i;)i.nodeType===3?t=i.textContent+t:t=i.outerHTML+t,i=i.previousSibling;return t},kr=function(e){for(var t=e;t&&!t.nextSibling;)t=t.parentElement;return t.nextSibling},Pn=function(e){var t=Ft(e.startContainer),i=Xn(e.startContainer),a=e.startContainer.textContent,o=e.startOffset,l="",E="";return(a.substr(0,o)!==""&&a.substr(0,o)!==f.Y.ZWSP||t)&&(l="".concat(t).concat(a.substr(0,o))),(a.substr(o)!==""&&a.substr(o)!==f.Y.ZWSP||i)&&(E="".concat(a.substr(o)).concat(i)),{afterHTML:E,beforeHTML:l}},mn=function(e,t){Array.from(e.wysiwyg.element.childNodes).find(function(i){if(i.nodeType===3){var a=document.createElement("p");a.setAttribute("data-block","0"),a.textContent=i.textContent;var o=t.startContainer.nodeType===3?t.startOffset:i.textContent.length;return i.parentNode.insertBefore(a,i),i.remove(),t.setStart(a.firstChild,Math.min(a.firstChild.textContent.length,o)),t.collapse(!0),(0,H.jl)(t),!0}else if(!i.getAttribute("data-block"))return i.tagName==="P"?i.remove():(i.tagName==="DIV"?(t.insertNode(document.createElement("wbr")),i.outerHTML='<p data-block="0">'.concat(i.innerHTML,"</p>")):i.tagName==="BR"?i.outerHTML='<p data-block="0">'.concat(i.outerHTML,"<wbr></p>"):(t.insertNode(document.createElement("wbr")),i.outerHTML='<p data-block="0">'.concat(i.outerHTML,"</p>")),(0,H.ir)(e.wysiwyg.element,t),t=getSelection().getRangeAt(0)),!0})},$t=function(e,t){var i=(0,H.RN)(e),a=(0,y.pt)(i.startContainer);a||(a=i.startContainer.childNodes[i.startOffset]),!a&&e.wysiwyg.element.children.length===0&&(a=e.wysiwyg.element),a&&!a.classList.contains("vditor-wysiwyg__block")&&(i.insertNode(document.createElement("wbr")),a.innerHTML.trim()==="<wbr>"&&(a.innerHTML="<wbr><br>"),a.tagName==="BLOCKQUOTE"||a.classList.contains("vditor-reset")?a.innerHTML="<".concat(t,' data-block="0">').concat(a.innerHTML.trim(),"</").concat(t,">"):a.outerHTML="<".concat(t,' data-block="0">').concat(a.innerHTML.trim(),"</").concat(t,">"),(0,H.ir)(e.wysiwyg.element,i),de(e))},Jn=function(e){var t=getSelection().getRangeAt(0),i=(0,y.pt)(t.startContainer);i||(i=t.startContainer.childNodes[t.startOffset]),i&&(t.insertNode(document.createElement("wbr")),i.outerHTML='<p data-block="0">'.concat(i.innerHTML,"</p>"),(0,H.ir)(e.wysiwyg.element,t)),e.wysiwyg.popover.style.display="none"},gn=function(e,t,i){i===void 0&&(i=!0);var a=e.previousElementSibling,o=a.ownerDocument.createRange();a.tagName==="CODE"?(a.style.display="inline-block",i?o.setStart(a.firstChild,1):o.selectNodeContents(a)):(a.style.display="block",a.firstChild.firstChild||a.firstChild.appendChild(document.createTextNode("")),o.selectNodeContents(a.firstChild)),i?o.collapse(!0):o.collapse(!1),(0,H.jl)(o),!e.firstElementChild.classList.contains("language-mindmap")&&nt(t)},Rn=function(e,t){if(e.wysiwyg.composingLock=t.isComposing,t.isComposing)return!1;t.key.indexOf("Arrow")===-1&&t.key!=="Meta"&&t.key!=="Control"&&t.key!=="Alt"&&t.key!=="Shift"&&t.key!=="CapsLock"&&t.key!=="Escape"&&!/^F\d{1,2}$/.test(t.key)&&e.undo.recordFirstPosition(e,t);var i=(0,H.RN)(e),a=i.startContainer;if(!Or(t,e,a)||(Pr(i,e,t),Kr(i),t.key!=="Enter"&&t.key!=="Tab"&&t.key!=="Backspace"&&t.key.indexOf("Arrow")===-1&&!(0,u._0)(t)&&t.key!=="Escape"&&t.key!=="Delete"))return!1;var o=(0,y.pt)(a),l=(0,y._Y)(a,"P");if(jr(t,e,l,i)||Nr(i,e,l,t)||Ur(e,t,i))return!0;var E=(0,y.KJ)(a,"vditor-wysiwyg__block");if(E){if(t.key==="Escape"&&E.children.length===2)return e.wysiwyg.popover.style.display="none",E.firstElementChild.style.display="none",e.wysiwyg.element.blur(),t.preventDefault(),!0;if(!(0,u._0)(t)&&!t.shiftKey&&t.altKey&&t.key==="Enter"&&E.getAttribute("data-type")==="code-block"){var L=e.wysiwyg.popover.querySelector(".vditor-input");return L.focus(),L.select(),t.preventDefault(),!0}if(E.getAttribute("data-block")==="0"&&(Vr(e,t,E.firstElementChild,i)||jn(e,t,i,E.firstElementChild,E)||E.getAttribute("data-type")!=="yaml-front-matter"&&yn(e,t,i,E.firstElementChild,E)))return!0}if(qr(e,i,t,l))return!0;var D=(0,y.Ab)(a,"BLOCKQUOTE");if(D&&!t.shiftKey&&t.altKey&&t.key==="Enter"){(0,u._0)(t)?i.setStartBefore(D):i.setStartAfter(D),(0,H.jl)(i);var A=document.createElement("p");return A.setAttribute("data-block","0"),A.innerHTML=`
`,i.insertNode(A),i.collapse(!0),(0,H.jl)(i),Ie(e),nt(e),t.preventDefault(),!0}var P=(0,O.c)(a);if(P){if(P.tagName==="H6"&&a.textContent.length===i.startOffset&&!(0,u._0)(t)&&!t.shiftKey&&!t.altKey&&t.key==="Enter"){var U=document.createElement("p");return U.textContent=`
`,U.setAttribute("data-block","0"),a.parentElement.insertAdjacentElement("afterend",U),i.setStart(U,0),(0,H.jl)(i),Ie(e),nt(e),t.preventDefault(),!0}if(z("⌘=",t)){var re=parseInt(P.tagName.substr(1),10)-1;return re>0&&($t(e,"h".concat(re)),Ie(e)),t.preventDefault(),!0}if(z("⌘-",t)){var re=parseInt(P.tagName.substr(1),10)+1;return re<7&&($t(e,"h".concat(re)),Ie(e)),t.preventDefault(),!0}t.key==="Backspace"&&!(0,u._0)(t)&&!t.shiftKey&&!t.altKey&&P.textContent.length===1&&Jn(e)}if(Wr(e,i,t))return!0;if(t.altKey&&t.key==="Enter"&&!(0,u._0)(t)&&!t.shiftKey){var ie=(0,y._Y)(a,"A"),te=(0,y.Th)(a,"data-type","link-ref"),be=(0,y.Th)(a,"data-type","footnotes-ref");if(ie||te||be||P&&P.tagName.length===2){var he=e.wysiwyg.popover.querySelector("input");he.focus(),he.select()}}if(ft(e,t))return!0;if(z("⇧⌘U",t)){var ee=e.wysiwyg.popover.querySelector('[data-type="up"]');if(ee)return ee.click(),t.preventDefault(),!0}if(z("⇧⌘D",t)){var ee=e.wysiwyg.popover.querySelector('[data-type="down"]');if(ee)return ee.click(),t.preventDefault(),!0}if(qi(e,i,t))return!0;if(!(0,u._0)(t)&&t.shiftKey&&!t.altKey&&t.key==="Enter"&&a.parentElement.tagName!=="LI"&&a.parentElement.tagName!=="P")return["STRONG","STRIKE","S","I","EM","B"].includes(a.parentElement.tagName)?i.insertNode(document.createTextNode(`
`+f.Y.ZWSP)):i.insertNode(document.createTextNode(`
`)),i.collapse(!1),(0,H.jl)(i),Ie(e),nt(e),t.preventDefault(),!0;if(t.key==="Backspace"&&!(0,u._0)(t)&&!t.shiftKey&&!t.altKey&&i.toString()===""){if(Yr(e,i,t,l))return!0;if(o){if(o.previousElementSibling&&o.previousElementSibling.classList.contains("vditor-wysiwyg__block")&&o.previousElementSibling.getAttribute("data-block")==="0"&&o.tagName!=="UL"&&o.tagName!=="OL"){var xe=(0,H.ED)(o,e.wysiwyg.element,i).start;if(xe===0&&i.startOffset===0||xe===1&&o.innerText.startsWith(f.Y.ZWSP))return gn(o.previousElementSibling.lastElementChild,e,!1),o.innerHTML.trim().replace(f.Y.ZWSP,"")===""&&(o.remove(),Ie(e)),t.preventDefault(),!0}var ve=i.startOffset;if(i.toString()===""&&a.nodeType===3&&a.textContent.charAt(ve-2)===`
`&&a.textContent.charAt(ve-1)!==f.Y.ZWSP&&["STRONG","STRIKE","S","I","EM","B"].includes(a.parentElement.tagName))return a.textContent=a.textContent.substring(0,ve-1)+f.Y.ZWSP,i.setStart(a,ve),i.collapse(!0),Ie(e),t.preventDefault(),!0;a.textContent===f.Y.ZWSP&&i.startOffset===1&&!a.previousSibling&&On(i)&&(a.textContent=""),o.querySelectorAll("span.vditor-wysiwyg__block[data-type='math-inline']").forEach(function(Ke){Ke.firstElementChild.style.display="inline",Ke.lastElementChild.style.display="none"}),o.querySelectorAll("span.vditor-wysiwyg__block[data-type='html-entity']").forEach(function(Ke){Ke.firstElementChild.style.display="inline",Ke.lastElementChild.style.display="none"})}}if((0,u.gm)()&&i.startOffset===1&&a.textContent.indexOf(f.Y.ZWSP)>-1&&a.previousSibling&&a.previousSibling.nodeType!==3&&a.previousSibling.tagName==="CODE"&&(t.key==="Backspace"||t.key==="ArrowLeft"))return i.selectNodeContents(a.previousSibling),i.collapse(!1),t.preventDefault(),!0;if(Gr(t,o,i))return t.preventDefault(),!0;if(Rr(i,t.key),t.key==="ArrowDown"){var _e=a.nextSibling;_e&&_e.nodeType!==3&&_e.getAttribute("data-type")==="math-inline"&&i.setStartAfter(_e)}return o&&Y(o,e,t,i)?(t.preventDefault(),!0):!1},ft=function(e,t){if(z("⇧⌘X",t)){var i=e.wysiwyg.popover.querySelector('[data-type="remove"]');return i&&i.click(),t.preventDefault(),!0}},Lt=function(e){clearTimeout(e.wysiwyg.hlToolbarTimeoutId),e.wysiwyg.hlToolbarTimeoutId=window.setTimeout(function(){if(e.wysiwyg.element.getAttribute("contenteditable")!=="false"&&(0,H.Co)(e.wysiwyg.element)){p(e.toolbar.elements,f.Y.EDIT_TOOLBARS),v(e.toolbar.elements,f.Y.EDIT_TOOLBARS);var t=getSelection().getRangeAt(0),i=t.startContainer;t.startContainer.nodeType===3?i=t.startContainer.parentElement:i=i.childNodes[t.startOffset>=i.childNodes.length?i.childNodes.length-1:t.startOffset];var a=(0,y.Th)(i,"data-type","footnotes-block");if(a){e.wysiwyg.popover.innerHTML="",et(a,e),ze(e,a);return}var o=(0,y._Y)(i,"LI");o?(o.classList.contains("vditor-task")?g(e.toolbar.elements,["check"]):o.parentElement.tagName==="OL"?g(e.toolbar.elements,["ordered-list"]):o.parentElement.tagName==="UL"&&g(e.toolbar.elements,["list"]),v(e.toolbar.elements,["outdent","indent"])):b(e.toolbar.elements,["outdent","indent"]),(0,y._Y)(i,"BLOCKQUOTE")&&g(e.toolbar.elements,["quote"]),((0,y._Y)(i,"B")||(0,y._Y)(i,"STRONG"))&&g(e.toolbar.elements,["bold"]),((0,y._Y)(i,"I")||(0,y._Y)(i,"EM"))&&g(e.toolbar.elements,["italic"]),((0,y._Y)(i,"STRIKE")||(0,y._Y)(i,"S"))&&g(e.toolbar.elements,["strike"]),e.wysiwyg.element.querySelectorAll(".vditor-comment--focus").forEach(function(ye){ye.classList.remove("vditor-comment--focus")});var l=(0,y.KJ)(i,"vditor-comment");if(l){var E=l.getAttribute("data-cmtids").split(" ");if(E.length>1&&l.nextSibling.isSameNode(l.nextElementSibling)){var L=l.nextElementSibling.getAttribute("data-cmtids").split(" ");E.find(function(ye){if(L.includes(ye))return E=[ye],!0})}e.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(ye){ye.getAttribute("data-cmtids").indexOf(E[0])>-1&&ye.classList.add("vditor-comment--focus")})}var D=(0,y._Y)(i,"A");D&&g(e.toolbar.elements,["link"]);var A=(0,y._Y)(i,"TABLE"),P=(0,O.c)(i);(0,y._Y)(i,"CODE")?(0,y._Y)(i,"PRE")?(b(e.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","inline-code","upload","link","table","record"]),g(e.toolbar.elements,["code"])):(b(e.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","upload","link","table","record"]),g(e.toolbar.elements,["inline-code"])):P?(b(e.toolbar.elements,["bold"]),g(e.toolbar.elements,["headings"])):A&&b(e.toolbar.elements,["table"]);var U=(0,y.KJ)(i,"vditor-toc");if(U){e.wysiwyg.popover.innerHTML="",et(U,e),ze(e,U);return}var re=(0,O.f)(i,"BLOCKQUOTE");if(re&&(e.wysiwyg.popover.innerHTML="",pt(t,re,e),At(t,re,e),et(re,e),ze(e,re)),o&&(e.wysiwyg.popover.innerHTML="",pt(t,o,e),At(t,o,e),et(o,e),ze(e,o)),A){e.options.lang,e.options,e.wysiwyg.popover.innerHTML="";var ie=function(){var ye=A.rows.length,Be=A.rows[0].cells.length,Xt=parseInt(it.value,10)||ye,Jt=parseInt(St.value,10)||Be;if(!(Xt===ye&&Be===Jt)){if(Be!==Jt)for(var Fn=Jt-Be,It=0;It<A.rows.length;It++)if(Fn>0)for(var aa=0;aa<Fn;aa++)It===0?A.rows[It].lastElementChild.insertAdjacentHTML("afterend","<th> </th>"):A.rows[It].lastElementChild.insertAdjacentHTML("afterend","<td> </td>");else for(var Ki=Be-1;Ki>=Jt;Ki--)A.rows[It].cells[Ki].remove();if(ye!==Xt){var oa=Xt-ye;if(oa>0){for(var Gi="<tr>",En=0;En<Jt;En++)Gi+="<td> </td>";for(var sa=0;sa<oa;sa++)A.querySelector("tbody")?A.querySelector("tbody").insertAdjacentHTML("beforeend",Gi):A.querySelector("thead").insertAdjacentHTML("afterend",Gi+"</tr>")}else for(var En=ye-1;En>=Xt;En--)A.rows[En].remove(),A.rows.length===1&&A.querySelector("tbody").remove()}typeof e.options.input=="function"&&e.options.input(T(e))}},te=function(ye){ni(A,ye),ye==="right"?(xe.classList.remove("vditor-icon--current"),ve.classList.remove("vditor-icon--current"),_e.classList.add("vditor-icon--current")):ye==="center"?(xe.classList.remove("vditor-icon--current"),_e.classList.remove("vditor-icon--current"),ve.classList.add("vditor-icon--current")):(ve.classList.remove("vditor-icon--current"),_e.classList.remove("vditor-icon--current"),xe.classList.add("vditor-icon--current")),(0,H.jl)(t),Ie(e)},be=(0,y._Y)(i,"TD"),he=(0,y._Y)(i,"TH"),ee="left";be?ee=be.getAttribute("align")||"left":he&&(ee=he.getAttribute("align")||"center");var xe=document.createElement("button");xe.setAttribute("type","button"),xe.setAttribute("aria-label",window.VditorI18n.alignLeft+"<"+(0,u.fG)("⇧⌘L")+">"),xe.setAttribute("data-type","left"),xe.innerHTML='<svg><use xlink:href="#vditor-icon-align-left"></use></svg>',xe.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+(ee==="left"?" vditor-icon--current":""),xe.onclick=function(){te("left")};var ve=document.createElement("button");ve.setAttribute("type","button"),ve.setAttribute("aria-label",window.VditorI18n.alignCenter+"<"+(0,u.fG)("⇧⌘C")+">"),ve.setAttribute("data-type","center"),ve.innerHTML='<svg><use xlink:href="#vditor-icon-align-center"></use></svg>',ve.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+(ee==="center"?" vditor-icon--current":""),ve.onclick=function(){te("center")};var _e=document.createElement("button");_e.setAttribute("type","button"),_e.setAttribute("aria-label",window.VditorI18n.alignRight+"<"+(0,u.fG)("⇧⌘R")+">"),_e.setAttribute("data-type","right"),_e.innerHTML='<svg><use xlink:href="#vditor-icon-align-right"></use></svg>',_e.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+(ee==="right"?" vditor-icon--current":""),_e.onclick=function(){te("right")};var Ke=document.createElement("button");Ke.setAttribute("type","button"),Ke.setAttribute("aria-label",window.VditorI18n.insertRowBelow+"<"+(0,u.fG)("⌘=")+">"),Ke.setAttribute("data-type","insertRow"),Ke.innerHTML='<svg><use xlink:href="#vditor-icon-insert-row"></use></svg>',Ke.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",Ke.onclick=function(){var ye=getSelection().getRangeAt(0).startContainer,Be=(0,y._Y)(ye,"TD")||(0,y._Y)(ye,"TH");Be&&Br(e,t,Be)};var We=document.createElement("button");We.setAttribute("type","button"),We.setAttribute("aria-label",window.VditorI18n.insertRowAbove+"<"+(0,u.fG)("⇧⌘F")+">"),We.setAttribute("data-type","insertRow"),We.innerHTML='<svg><use xlink:href="#vditor-icon-insert-rowb"></use></svg>',We.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",We.onclick=function(){var ye=getSelection().getRangeAt(0).startContainer,Be=(0,y._Y)(ye,"TD")||(0,y._Y)(ye,"TH");Be&&zr(e,t,Be)};var Ge=document.createElement("button");Ge.setAttribute("type","button"),Ge.setAttribute("aria-label",window.VditorI18n.insertColumnRight+"<"+(0,u.fG)("⇧⌘=")+">"),Ge.setAttribute("data-type","insertColumn"),Ge.innerHTML='<svg><use xlink:href="#vditor-icon-insert-column"></use></svg>',Ge.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",Ge.onclick=function(){var ye=getSelection().getRangeAt(0).startContainer,Be=(0,y._Y)(ye,"TD")||(0,y._Y)(ye,"TH");Be&&ii(e,A,Be)};var mt=document.createElement("button");mt.setAttribute("type","button"),mt.setAttribute("aria-label",window.VditorI18n.insertColumnLeft+"<"+(0,u.fG)("⇧⌘G")+">"),mt.setAttribute("data-type","insertColumn"),mt.innerHTML='<svg><use xlink:href="#vditor-icon-insert-columnb"></use></svg>',mt.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",mt.onclick=function(){var ye=getSelection().getRangeAt(0).startContainer,Be=(0,y._Y)(ye,"TD")||(0,y._Y)(ye,"TH");Be&&ii(e,A,Be,"beforebegin")};var dt=document.createElement("button");dt.setAttribute("type","button"),dt.setAttribute("aria-label",window.VditorI18n["delete-row"]+"<"+(0,u.fG)("⌘-")+">"),dt.setAttribute("data-type","deleteRow"),dt.innerHTML='<svg><use xlink:href="#vditor-icon-delete-row"></use></svg>',dt.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",dt.onclick=function(){var ye=getSelection().getRangeAt(0).startContainer,Be=(0,y._Y)(ye,"TD")||(0,y._Y)(ye,"TH");Be&&Fr(e,t,Be)};var gt=document.createElement("button");gt.setAttribute("type","button"),gt.setAttribute("aria-label",window.VditorI18n["delete-column"]+"<"+(0,u.fG)("⇧⌘-")+">"),gt.setAttribute("data-type","deleteColumn"),gt.innerHTML='<svg><use xlink:href="#vditor-icon-delete-column"></use></svg>',gt.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",gt.onclick=function(){var ye=getSelection().getRangeAt(0).startContainer,Be=(0,y._Y)(ye,"TD")||(0,y._Y)(ye,"TH");Be&&$r(e,t,A,Be)};var Re=document.createElement("span");Re.setAttribute("aria-label",window.VditorI18n.row),Re.className="vditor-tooltipped vditor-tooltipped__n";var it=document.createElement("input");Re.appendChild(it),it.type="number",it.min="1",it.className="vditor-input",it.style.width="42px",it.style.textAlign="center",it.setAttribute("placeholder",window.VditorI18n.row),it.value=A.rows.length.toString(),it.oninput=function(){ie()},it.onkeydown=function(ye){if(!ye.isComposing){if(ye.key==="Tab"){St.focus(),St.select(),ye.preventDefault();return}ft(e,ye)||Rt(ye,t)}};var oi=document.createElement("span");oi.setAttribute("aria-label",window.VditorI18n.column),oi.className="vditor-tooltipped vditor-tooltipped__n";var St=document.createElement("input");oi.appendChild(St),St.type="number",St.min="1",St.className="vditor-input",St.style.width="42px",St.style.textAlign="center",St.setAttribute("placeholder",window.VditorI18n.column),St.value=A.rows[0].cells.length.toString(),St.oninput=function(){ie()},St.onkeydown=function(ye){if(!ye.isComposing){if(ye.key==="Tab"){it.focus(),it.select(),ye.preventDefault();return}ft(e,ye)||Rt(ye,t)}},pt(t,A,e),At(t,A,e),et(A,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",xe),e.wysiwyg.popover.insertAdjacentElement("beforeend",ve),e.wysiwyg.popover.insertAdjacentElement("beforeend",_e),e.wysiwyg.popover.insertAdjacentElement("beforeend",We),e.wysiwyg.popover.insertAdjacentElement("beforeend",Ke),e.wysiwyg.popover.insertAdjacentElement("beforeend",mt),e.wysiwyg.popover.insertAdjacentElement("beforeend",Ge),e.wysiwyg.popover.insertAdjacentElement("beforeend",dt),e.wysiwyg.popover.insertAdjacentElement("beforeend",gt),e.wysiwyg.popover.insertAdjacentElement("beforeend",Re),e.wysiwyg.popover.insertAdjacentHTML("beforeend"," x "),e.wysiwyg.popover.insertAdjacentElement("beforeend",oi),ze(e,A)}var Yi=(0,y.Th)(i,"data-type","link-ref");Yi&&Ye(e,Yi,t);var bn=(0,y.Th)(i,"data-type","footnotes-ref");if(bn){e.options.lang,e.options,e.wysiwyg.popover.innerHTML="";var Re=document.createElement("span");Re.setAttribute("aria-label",window.VditorI18n.footnoteRef+"<"+(0,u.fG)("⌥Enter")+">"),Re.className="vditor-tooltipped vditor-tooltipped__n";var Vt=document.createElement("input");Re.appendChild(Vt),Vt.className="vditor-input",Vt.setAttribute("placeholder",window.VditorI18n.footnoteRef+"<"+(0,u.fG)("⌥Enter")+">"),Vt.style.width="120px",Vt.value=bn.getAttribute("data-footnotes-label"),Vt.oninput=function(){Vt.value.trim()!==""&&bn.setAttribute("data-footnotes-label",Vt.value),typeof e.options.input=="function"&&e.options.input(T(e))},Vt.onkeydown=function(Be){Be.isComposing||ft(e,Be)||Rt(Be,t)},et(bn,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",Re),ze(e,bn)}var st=(0,y.KJ)(i,"vditor-wysiwyg__block"),ia=st?st.getAttribute("data-type").indexOf("block")>-1:!1;if(e.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview").forEach(function(ye){if(!st||st&&ia&&!st.contains(ye)){var Be=ye.previousElementSibling;Be.style.display="none"}}),st&&ia){if(e.wysiwyg.popover.innerHTML="",pt(t,st,e),At(t,st,e),et(st,e),st.getAttribute("data-type")==="code-block"){var si=document.createElement("span");si.setAttribute("aria-label",window.VditorI18n.language+"<"+(0,u.fG)("⌥Enter")+">"),si.className="vditor-tooltipped vditor-tooltipped__n";var Dt=document.createElement("input");si.appendChild(Dt);var zn=st.firstElementChild.firstElementChild;Dt.className="vditor-input",Dt.setAttribute("placeholder",window.VditorI18n.language+"<"+(0,u.fG)("⌥Enter")+">"),Dt.value=zn.className.indexOf("language-")>-1?zn.className.split("-")[1].split(" ")[0]:"",Dt.oninput=function(ye){Dt.value.trim()!==""?zn.className="language-".concat(Dt.value):(zn.className="",e.hint.recentLanguage=""),st.lastElementChild.classList.contains("vditor-wysiwyg__preview")&&(st.lastElementChild.innerHTML=st.firstElementChild.innerHTML,le(st.lastElementChild,e)),Ie(e),ye.detail===1&&(t.setStart(zn.firstChild,0),t.collapse(!0),(0,H.jl)(t))},Dt.onkeydown=function(ye){if(!ye.isComposing&&!ft(e,ye)){if(ye.key==="Escape"&&e.hint.element.style.display==="block"){e.hint.element.style.display="none",ye.preventDefault();return}e.hint.select(ye,e),Rt(ye,t)}},Dt.onkeyup=function(ye){var Be,Xt;if(!(ye.isComposing||ye.key==="Enter"||ye.key==="ArrowUp"||ye.key==="Escape"||ye.key==="ArrowDown")){var Jt=[],Fn=Dt.value.substring(0,Dt.selectionStart);(e.options.preview.hljs.langs||f.Y.ALIAS_CODE_LANGUAGES.concat(((Xt=(Be=window.hljs)===null||Be===void 0?void 0:Be.listLanguages())!==null&&Xt!==void 0?Xt:[]).sort())).forEach(function(It){It.indexOf(Fn.toLowerCase())>-1&&Jt.push({html:It,value:It})}),e.hint.genHTML(Jt,Fn,e),ye.preventDefault()}},e.wysiwyg.popover.insertAdjacentElement("beforeend",si)}ze(e,st)}else st=void 0;if(P){e.wysiwyg.popover.innerHTML="";var Re=document.createElement("span");Re.setAttribute("aria-label","ID<"+(0,u.fG)("⌥Enter")+">"),Re.className="vditor-tooltipped vditor-tooltipped__n";var Zt=document.createElement("input");Re.appendChild(Zt),Zt.className="vditor-input",Zt.setAttribute("placeholder","ID<"+(0,u.fG)("⌥Enter")+">"),Zt.style.width="120px",Zt.value=P.getAttribute("data-id")||"",Zt.oninput=function(){P.setAttribute("data-id",Zt.value),typeof e.options.input=="function"&&e.options.input(T(e))},Zt.onkeydown=function(Be){Be.isComposing||ft(e,Be)||Rt(Be,t)},pt(t,P,e),At(t,P,e),et(P,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",Re),ze(e,P)}if(D&&Oi(e,D,t),!re&&!o&&!A&&!st&&!D&&!Yi&&!bn&&!P&&!U){var wn=(0,y.Th)(i,"data-block","0");wn&&wn.parentElement.isEqualNode(e.wysiwyg.element)?(e.wysiwyg.popover.innerHTML="",pt(t,wn,e),At(t,wn,e),et(wn,e),ze(e,wn)):e.wysiwyg.popover.style.display="none"}e.wysiwyg.element.querySelectorAll('span[data-type="backslash"] > span').forEach(function(ye){ye.style.display="none"});var ra=(0,y.Th)(t.startContainer,"data-type","backslash");ra&&(ra.querySelector("span").style.display="inline")}},200)},ze=function(e,t){var i=t,a=(0,y._Y)(t,"TABLE");a&&(i=a),e.wysiwyg.popover.style.left="0",e.wysiwyg.popover.style.display="block",e.wysiwyg.popover.style.top=Math.max(-8,i.offsetTop-21-e.wysiwyg.element.scrollTop)+"px",e.wysiwyg.popover.style.left=Math.min(i.offsetLeft,e.wysiwyg.element.clientWidth-e.wysiwyg.popover.clientWidth)+"px",e.wysiwyg.popover.setAttribute("data-top",(i.offsetTop-21).toString())},Ye=function(e,t,i){i===void 0&&(i=getSelection().getRangeAt(0)),e.wysiwyg.popover.innerHTML="";var a=function(){l.value.trim()!==""&&(t.tagName==="IMG"?t.setAttribute("alt",l.value):t.textContent=l.value),L.value.trim()!==""&&t.setAttribute("data-link-label",L.value),typeof e.options.input=="function"&&e.options.input(T(e))},o=document.createElement("span");o.setAttribute("aria-label",window.VditorI18n.textIsNotEmpty),o.className="vditor-tooltipped vditor-tooltipped__n";var l=document.createElement("input");o.appendChild(l),l.className="vditor-input",l.setAttribute("placeholder",window.VditorI18n.textIsNotEmpty),l.style.width="120px",l.value=t.getAttribute("alt")||t.textContent,l.oninput=function(){a()},l.onkeydown=function(D){ft(e,D)||Rt(D,i)||In(e,t,D,L)};var E=document.createElement("span");E.setAttribute("aria-label",window.VditorI18n.linkRef),E.className="vditor-tooltipped vditor-tooltipped__n";var L=document.createElement("input");E.appendChild(L),L.className="vditor-input",L.setAttribute("placeholder",window.VditorI18n.linkRef),L.value=t.getAttribute("data-link-label"),L.oninput=function(){a()},L.onkeydown=function(D){ft(e,D)||Rt(D,i)||In(e,t,D,l)},et(t,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",o),e.wysiwyg.popover.insertAdjacentElement("beforeend",E),ze(e,t)},pt=function(e,t,i){var a=t.previousElementSibling;if(!(!a||!t.parentElement.isEqualNode(i.wysiwyg.element)&&t.tagName!=="LI")){var o=document.createElement("button");o.setAttribute("type","button"),o.setAttribute("data-type","up"),o.setAttribute("aria-label",window.VditorI18n.up+"<"+(0,u.fG)("⇧⌘U")+">"),o.innerHTML='<svg><use xlink:href="#vditor-icon-up"></use></svg>',o.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",o.onclick=function(){e.insertNode(document.createElement("wbr")),a.insertAdjacentElement("beforebegin",t),(0,H.ir)(i.wysiwyg.element,e),Ie(i),Lt(i),nt(i)},i.wysiwyg.popover.insertAdjacentElement("beforeend",o)}},At=function(e,t,i){var a=t.nextElementSibling;if(!(!a||!t.parentElement.isEqualNode(i.wysiwyg.element)&&t.tagName!=="LI")){var o=document.createElement("button");o.setAttribute("type","button"),o.setAttribute("data-type","down"),o.setAttribute("aria-label",window.VditorI18n.down+"<"+(0,u.fG)("⇧⌘D")+">"),o.innerHTML='<svg><use xlink:href="#vditor-icon-down"></use></svg>',o.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",o.onclick=function(){e.insertNode(document.createElement("wbr")),a.insertAdjacentElement("afterend",t),(0,H.ir)(i.wysiwyg.element,e),Ie(i),Lt(i),nt(i)},i.wysiwyg.popover.insertAdjacentElement("beforeend",o)}},et=function(e,t){var i=document.createElement("button");i.setAttribute("type","button"),i.setAttribute("data-type","remove"),i.setAttribute("aria-label",window.VditorI18n.remove+"<"+(0,u.fG)("⇧⌘X")+">"),i.innerHTML='<svg><use xlink:href="#vditor-icon-trashcan"></use></svg>',i.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",i.onclick=function(){var a=(0,H.RN)(t);a.setStartAfter(e),(0,H.jl)(a),e.remove(),Ie(t),Lt(t),["H1","H2","H3","H4","H5","H6"].includes(e.tagName)&&de(t)},t.wysiwyg.popover.insertAdjacentElement("beforeend",i)},In=function(e,t,i,a){if(!i.isComposing){if(i.key==="Tab"){a.focus(),a.select(),i.preventDefault();return}if(!(0,u._0)(i)&&!i.shiftKey&&i.altKey&&i.key==="Enter"){var o=(0,H.RN)(e);t.insertAdjacentHTML("afterend",f.Y.ZWSP),o.setStartAfter(t.nextSibling),o.collapse(!0),(0,H.jl)(o),i.preventDefault()}}},Oi=function(e,t,i){e.wysiwyg.popover.innerHTML="";var a=function(){l.value.trim()!==""&&(t.innerHTML=l.value),t.setAttribute("href",L.value),t.setAttribute("title",A.value),Ie(e)};t.querySelectorAll("[data-marker]").forEach(function(P){P.removeAttribute("data-marker")});var o=document.createElement("span");o.setAttribute("aria-label",window.VditorI18n.textIsNotEmpty),o.className="vditor-tooltipped vditor-tooltipped__n";var l=document.createElement("input");o.appendChild(l),l.className="vditor-input",l.setAttribute("placeholder",window.VditorI18n.textIsNotEmpty),l.style.width="120px",l.value=t.innerHTML||"",l.oninput=function(){a()},l.onkeydown=function(P){ft(e,P)||Rt(P,i)||In(e,t,P,L)};var E=document.createElement("span");E.setAttribute("aria-label",window.VditorI18n.link),E.className="vditor-tooltipped vditor-tooltipped__n";var L=document.createElement("input");E.appendChild(L),L.className="vditor-input",L.setAttribute("placeholder",window.VditorI18n.link),L.value=t.getAttribute("href")||"",L.oninput=function(){a()},L.onkeydown=function(P){ft(e,P)||Rt(P,i)||In(e,t,P,A)};var D=document.createElement("span");D.setAttribute("aria-label",window.VditorI18n.tooltipText),D.className="vditor-tooltipped vditor-tooltipped__n";var A=document.createElement("input");D.appendChild(A),A.className="vditor-input",A.setAttribute("placeholder",window.VditorI18n.tooltipText),A.style.width="60px",A.value=t.getAttribute("title")||"",A.oninput=function(){a()},A.onkeydown=function(P){ft(e,P)||Rt(P,i)||In(e,t,P,l)},et(t,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",o),e.wysiwyg.popover.insertAdjacentElement("beforeend",E),e.wysiwyg.popover.insertAdjacentElement("beforeend",D),ze(e,t)},bo=function(e,t){var i=e.target;t.wysiwyg.popover.innerHTML="";var a=function(){i.setAttribute("src",l.value),i.setAttribute("alt",L.value),i.setAttribute("title",A.value),typeof t.options.input=="function"&&t.options.input(T(t))},o=document.createElement("span");o.setAttribute("aria-label",window.VditorI18n.imageURL),o.className="vditor-tooltipped vditor-tooltipped__n";var l=document.createElement("input");o.appendChild(l),l.className="vditor-input",l.setAttribute("placeholder",window.VditorI18n.imageURL),l.value=i.getAttribute("src")||"",l.oninput=function(){a()},l.onkeydown=function(P){ft(t,P)};var E=document.createElement("span");E.setAttribute("aria-label",window.VditorI18n.alternateText),E.className="vditor-tooltipped vditor-tooltipped__n";var L=document.createElement("input");E.appendChild(L),L.className="vditor-input",L.setAttribute("placeholder",window.VditorI18n.alternateText),L.style.width="52px",L.value=i.getAttribute("alt")||"",L.oninput=function(){a()},L.onkeydown=function(P){ft(t,P)};var D=document.createElement("span");D.setAttribute("aria-label",window.VditorI18n.title),D.className="vditor-tooltipped vditor-tooltipped__n";var A=document.createElement("input");D.appendChild(A),A.className="vditor-input",A.setAttribute("placeholder",window.VditorI18n.title),A.value=i.getAttribute("title")||"",A.oninput=function(){a()},A.onkeydown=function(P){ft(t,P)},et(i,t),t.wysiwyg.popover.insertAdjacentElement("beforeend",o),t.wysiwyg.popover.insertAdjacentElement("beforeend",E),t.wysiwyg.popover.insertAdjacentElement("beforeend",D),ze(t,i)},Rt=function(e,t){if(!(0,u._0)(e)&&!e.shiftKey&&e.key==="Enter"||e.key==="Escape")return t&&(0,H.jl)(t),e.preventDefault(),e.stopPropagation(),!0},vn=function(e){e.currentMode==="wysiwyg"?Lt(e):e.currentMode==="ir"&&ut(e)},xr=function(e,t,i){i===void 0&&(i={enableAddUndoStack:!0,enableHint:!1,enableInput:!0});var a=e.wysiwyg.element;a.innerHTML=e.lute.Md2VditorDOM(t),a.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach(function(o){le(o,e),o.previousElementSibling.setAttribute("style","display:none")}),Ie(e,i)},wo=function(e,t,i){for(var a=e.startContainer.parentElement,o=!1,l="",E="",L=Pn(e),D=L.beforeHTML,A=L.afterHTML;a&&!o;){var P=a.tagName;if(P==="STRIKE"&&(P="S"),P==="I"&&(P="EM"),P==="B"&&(P="STRONG"),P==="S"||P==="STRONG"||P==="EM"){var U="",re="",ie="";a.parentElement.getAttribute("data-block")!=="0"&&(re=Ft(a),ie=Xn(a)),(D||re)&&(U="".concat(re,"<").concat(P,">").concat(D,"</").concat(P,">"),D=U),(i==="bold"&&P==="STRONG"||i==="italic"&&P==="EM"||i==="strikeThrough"&&P==="S")&&(U+="".concat(l).concat(f.Y.ZWSP,"<wbr>").concat(E),o=!0),(A||ie)&&(A="<".concat(P,">").concat(A,"</").concat(P,">").concat(ie),U+=A),a.parentElement.getAttribute("data-block")!=="0"?(a=a.parentElement,a.innerHTML=U):(a.outerHTML=U,a=a.parentElement),l="<".concat(P,">")+l,E="</".concat(P,">")+E}else o=!0}(0,H.ir)(t.wysiwyg.element,e)},Eo=function(e,t,i){if(!(e.wysiwyg.composingLock&&i instanceof CustomEvent)){var a=!0,o=!0;e.wysiwyg.element.querySelector("wbr")&&e.wysiwyg.element.querySelector("wbr").remove();var l=(0,H.RN)(e),E=t.getAttribute("data-type");if(t.classList.contains("vditor-menu--current"))if(E==="strike"&&(E="strikeThrough"),E==="quote"){var L=(0,y._Y)(l.startContainer,"BLOCKQUOTE");L||(L=l.startContainer.childNodes[l.startOffset]),L&&(a=!1,t.classList.remove("vditor-menu--current"),l.insertNode(document.createElement("wbr")),L.outerHTML=L.innerHTML.trim()===""?'<p data-block="0">'.concat(L.innerHTML,"</p>"):L.innerHTML,(0,H.ir)(e.wysiwyg.element,l))}else if(E==="inline-code"){var D=(0,y._Y)(l.startContainer,"CODE");D||(D=l.startContainer.childNodes[l.startOffset]),D&&(D.outerHTML=D.innerHTML.replace(f.Y.ZWSP,"")+"<wbr>",(0,H.ir)(e.wysiwyg.element,l))}else E==="link"?(l.collapsed&&l.selectNode(l.startContainer.parentElement),document.execCommand("unlink",!1,"")):E==="check"||E==="list"||E==="ordered-list"?(ti(e,l,E),(0,H.ir)(e.wysiwyg.element,l),a=!1,t.classList.remove("vditor-menu--current")):(a=!1,t.classList.remove("vditor-menu--current"),l.toString()===""?wo(l,e,E):document.execCommand(E,!1,""));else{e.wysiwyg.element.childNodes.length===0&&(e.wysiwyg.element.innerHTML='<p data-block="0"><wbr></p>',(0,H.ir)(e.wysiwyg.element,l));var A=(0,y.pt)(l.startContainer);if(E==="quote"){if(A||(A=l.startContainer.childNodes[l.startOffset]),A){a=!1,t.classList.add("vditor-menu--current"),l.insertNode(document.createElement("wbr"));var P=(0,y._Y)(l.startContainer,"LI");P&&A.contains(P)?P.innerHTML='<blockquote data-block="0">'.concat(P.innerHTML,"</blockquote>"):A.outerHTML='<blockquote data-block="0">'.concat(A.outerHTML,"</blockquote>"),(0,H.ir)(e.wysiwyg.element,l)}}else if(E==="check"||E==="list"||E==="ordered-list")ti(e,l,E,!1),(0,H.ir)(e.wysiwyg.element,l),a=!1,p(e.toolbar.elements,["check","list","ordered-list"]),t.classList.add("vditor-menu--current");else if(E==="inline-code"){if(l.toString()===""){var U=document.createElement("code");U.textContent=f.Y.ZWSP,l.insertNode(U),l.setStart(U.firstChild,1),l.collapse(!0),(0,H.jl)(l)}else if(l.startContainer.nodeType===3){var U=document.createElement("code");l.surroundContents(U),l.insertNode(U),(0,H.jl)(l)}t.classList.add("vditor-menu--current")}else if(E==="code"){var U=document.createElement("div");U.className="vditor-wysiwyg__block",U.setAttribute("data-type","code-block"),U.setAttribute("data-block","0"),U.setAttribute("data-marker","```"),l.toString()===""?U.innerHTML=`<pre><code><wbr>
</code></pre>`:(U.innerHTML="<pre><code>".concat(l.toString(),"<wbr></code></pre>"),l.deleteContents()),l.insertNode(U),A&&(A.outerHTML=e.lute.SpinVditorDOM(A.outerHTML)),(0,H.ir)(e.wysiwyg.element,l),e.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach(function(Ke){le(Ke,e)}),t.classList.add("vditor-menu--disabled")}else if(E==="link"){if(l.toString()===""){var re=document.createElement("a");re.innerText=f.Y.ZWSP,l.insertNode(re),l.setStart(re.firstChild,1),l.collapse(!0),Oi(e,re,l);var ie=e.wysiwyg.popover.querySelector("input");ie.value="",ie.focus(),o=!1}else{var U=document.createElement("a");U.setAttribute("href",""),U.innerHTML=l.toString(),l.surroundContents(U),l.insertNode(U),(0,H.jl)(l),Oi(e,U,l);var te=e.wysiwyg.popover.querySelectorAll("input");te[0].value=U.innerText,te[1].focus()}a=!1,t.classList.add("vditor-menu--current")}else if(E==="table"){var be='<table data-block="0"><thead><tr><th>col1<wbr></th><th>col2</th><th>col3</th></tr></thead><tbody><tr><td> </td><td> </td><td> </td></tr><tr><td> </td><td> </td><td> </td></tr></tbody></table>';if(l.toString().trim()==="")A&&A.innerHTML.trim().replace(f.Y.ZWSP,"")===""?A.outerHTML=be:document.execCommand("insertHTML",!1,be),l.selectNode(e.wysiwyg.element.querySelector("wbr").previousSibling),e.wysiwyg.element.querySelector("wbr").remove(),(0,H.jl)(l);else{be='<table data-block="0"><thead><tr>';var he=l.toString().split(`
`),ee=he[0].split(",").length>he[0].split("	").length?",":"	";he.forEach(function(_e,Ke){Ke===0?(_e.split(ee).forEach(function(We,Ge){Ge===0?be+="<th>".concat(We,"<wbr></th>"):be+="<th>".concat(We,"</th>")}),be+="</tr></thead>"):(Ke===1?be+="<tbody><tr>":be+="<tr>",_e.split(ee).forEach(function(We){be+="<td>".concat(We,"</td>")}),be+="</tr>")}),be+="</tbody></table>",document.execCommand("insertHTML",!1,be),(0,H.ir)(e.wysiwyg.element,l)}a=!1,t.classList.add("vditor-menu--disabled")}else if(E==="line"){if(A){var xe=`<hr data-block="0"><p data-block="0"><wbr>
</p>`;A.innerHTML.trim()===""?A.outerHTML=xe:A.insertAdjacentHTML("afterend",xe),(0,H.ir)(e.wysiwyg.element,l)}}else if(a=!1,t.classList.add("vditor-menu--current"),E==="strike"&&(E="strikeThrough"),l.toString()===""&&(E==="bold"||E==="italic"||E==="strikeThrough")){var ve="strong";E==="italic"?ve="em":E==="strikeThrough"&&(ve="s");var U=document.createElement(ve);U.textContent=f.Y.ZWSP,l.insertNode(U),U.previousSibling&&U.previousSibling.textContent===f.Y.ZWSP&&(U.previousSibling.textContent=""),l.setStart(U.firstChild,1),l.collapse(!0),(0,H.jl)(l)}else document.execCommand(E,!1,"")}a&&Lt(e),o&&Ie(e)}},Je=function(){function e(t,i){var a,o=this;this.element=document.createElement("div"),i.className&&(a=this.element.classList).add.apply(a,i.className.split(" "));var l=i.hotkey?" <".concat((0,u.fG)(i.hotkey),">"):"";i.level===2&&(l=i.hotkey?" &lt;".concat((0,u.fG)(i.hotkey),"&gt;"):"");var E=i.tip?i.tip+l:"".concat(window.VditorI18n[i.name]).concat(l),L=i.name==="upload"?"div":"button";if(i.level===2)this.element.innerHTML="<".concat(L,' data-type="').concat(i.name,'">').concat(E,"</").concat(L,">");else{this.element.classList.add("vditor-toolbar__item");var D=document.createElement(L);D.setAttribute("data-type",i.name),D.className="vditor-tooltipped vditor-tooltipped__".concat(i.tipPosition),D.setAttribute("aria-label",E),D.innerHTML=i.icon,this.element.appendChild(D)}i.prefix&&this.element.children[0].addEventListener((0,u.y3)(),function(A){A.preventDefault(),!o.element.firstElementChild.classList.contains(f.Y.CLASS_MENU_DISABLED)&&(t.currentMode==="wysiwyg"?Eo(t,o.element.children[0],A):t.currentMode==="ir"?Ho(t,o.element.children[0],i.prefix||"",i.suffix||""):ko(t,o.element.children[0],i.prefix||"",i.suffix||""))})}return e}(),So=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),tn=function(e,t,i){var a;if(typeof i!="string"?(_(e,["subToolbar","hint"]),i.preventDefault(),a=T(e)):a=i,!(e.currentMode===t&&typeof i!="string")){if(e.devtools&&e.devtools.renderEchart(e),e.options.preview.mode==="both"&&t==="sv"?e.preview.element.style.display="block":e.preview.element.style.display="none",v(e.toolbar.elements,f.Y.EDIT_TOOLBARS),p(e.toolbar.elements,f.Y.EDIT_TOOLBARS),b(e.toolbar.elements,["outdent","indent"]),t==="ir")k(e.toolbar.elements,["both"]),M(e.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),e.sv.element.style.display="none",e.wysiwyg.element.parentElement.style.display="none",e.ir.element.parentElement.style.display="block",e.lute.SetVditorIR(!0),e.lute.SetVditorWYSIWYG(!1),e.lute.SetVditorSV(!1),e.currentMode="ir",e.ir.element.innerHTML=e.lute.Md2VditorIRDOM(a),Ut(e,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),Oe(e),e.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach(function(l){le(l,e)}),e.ir.element.querySelectorAll(".vditor-toc").forEach(function(l){(0,ce.T)(l,{cdn:e.options.cdn,math:e.options.preview.math})});else if(t==="wysiwyg")k(e.toolbar.elements,["both"]),M(e.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),e.sv.element.style.display="none",e.wysiwyg.element.parentElement.style.display="block",e.ir.element.parentElement.style.display="none",e.lute.SetVditorIR(!1),e.lute.SetVditorWYSIWYG(!0),e.lute.SetVditorSV(!1),e.currentMode="wysiwyg",Oe(e),xr(e,a,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),e.wysiwyg.element.querySelectorAll(".vditor-toc").forEach(function(l){(0,ce.T)(l,{cdn:e.options.cdn,math:e.options.preview.math})}),e.wysiwyg.popover.style.display="none";else if(t==="sv"){M(e.toolbar.elements,["both"]),k(e.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),e.wysiwyg.element.parentElement.style.display="none",e.ir.element.parentElement.style.display="none",(e.options.preview.mode==="both"||e.options.preview.mode==="editor")&&(e.sv.element.style.display="block"),e.lute.SetVditorIR(!1),e.lute.SetVditorWYSIWYG(!1),e.lute.SetVditorSV(!0),e.currentMode="sv";var o=_r(a,e);o==="<div data-block='0'></div>"&&(o=""),e.sv.element.innerHTML=o,je(e.sv.element),at(e,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),Oe(e)}e.undo.resetIcon(e),typeof i!="string"&&(e[e.currentMode].element.focus(),vn(e)),de(e),tt(e),e.toolbar.elements["edit-mode"]&&(e.toolbar.elements["edit-mode"].querySelectorAll("button").forEach(function(l){l.classList.remove("vditor-menu--current")}),e.toolbar.elements["edit-mode"].querySelector('button[data-mode="'.concat(e.currentMode,'"]')).classList.add("vditor-menu--current")),e.outline.toggle(e,e.currentMode!=="sv"&&e.options.outline.enable,typeof i!="string")}},Co=function(e){So(t,e);function t(i,a){var o=e.call(this,i,a)||this,l=document.createElement("div");return l.className="vditor-hint".concat(a.level===2?"":" vditor-panel--arrow"),l.innerHTML='<button data-mode="wysiwyg">'.concat(window.VditorI18n.wysiwyg," &lt;").concat((0,u.fG)("⌥⌘7"),`></button>
<button data-mode="ir">`).concat(window.VditorI18n.instantRendering," &lt;").concat((0,u.fG)("⌥⌘8"),`></button>
<button data-mode="sv">`).concat(window.VditorI18n.splitView," &lt;").concat((0,u.fG)("⌥⌘9"),"></button>"),o.element.appendChild(l),o._bindEvent(i,l,a),o}return t.prototype._bindEvent=function(i,a,o){var l=this.element.children[0];x(i,a,l,o.level),a.children.item(0).addEventListener((0,u.y3)(),function(E){tn(i,"wysiwyg",E),E.preventDefault(),E.stopPropagation()}),a.children.item(1).addEventListener((0,u.y3)(),function(E){tn(i,"ir",E),E.preventDefault(),E.stopPropagation()}),a.children.item(2).addEventListener((0,u.y3)(),function(E){tn(i,"sv",E),E.preventDefault(),E.stopPropagation()})},t}(Je),Hn=function(e,t){return(0,H.Co)(e,t)?getSelection().toString():""},Pi=function(e,t){t.addEventListener("focus",function(){e.options.focus&&e.options.focus(T(e)),_(e,["subToolbar","hint"])})},Mr=function(e,t){t.addEventListener("dblclick",function(i){i.target.tagName==="IMG"&&(e.options.image.preview?e.options.image.preview(i.target):e.options.image.isPreview&&(0,se.o)(i.target,e.options.lang,e.options.theme))})},Ri=function(e,t){t.addEventListener("blur",function(i){if(e.currentMode==="ir"){var a=e.ir.element.querySelector(".vditor-ir__node--expand");a&&a.classList.remove("vditor-ir__node--expand")}else e.currentMode==="wysiwyg"&&!e.wysiwyg.selectPopover.contains(i.relatedTarget)&&e.wysiwyg.hideComment();e[e.currentMode].range=(0,H.RN)(e),e.options.blur&&e.options.blur(T(e))})},Ii=function(e,t){t.addEventListener("dragstart",function(i){i.dataTransfer.setData(f.Y.DROP_EDITOR,f.Y.DROP_EDITOR)}),t.addEventListener("drop",function(i){i.dataTransfer.getData(f.Y.DROP_EDITOR)?Ne(e):(i.dataTransfer.types.includes("Files")||i.dataTransfer.types.includes("text/html"))&&ri(e,i,{pasteCode:function(a){document.execCommand("insertHTML",!1,a)}})})},Hi=function(e,t,i){t.addEventListener("copy",function(a){return i(a,e)})},Ni=function(e,t,i){t.addEventListener("cut",function(a){i(a,e),e.options.comment.enable&&e.currentMode==="wysiwyg"&&e.wysiwyg.getComments(e),document.execCommand("delete")})},nt=function(e){if(e.currentMode==="wysiwyg"&&e.options.comment.enable&&e.options.comment.adjustTop(e.wysiwyg.getComments(e,!0)),!!e.options.typewriterMode){var t=e[e.currentMode].element,i=(0,H.Ey)(t).top;e.options.height==="auto"&&!e.element.classList.contains("vditor--fullscreen")&&window.scrollTo(window.scrollX,i+e.element.offsetTop+e.toolbar.element.offsetHeight-window.innerHeight/2+10),(e.options.height!=="auto"||e.element.classList.contains("vditor--fullscreen"))&&(t.scrollTop=i+t.scrollTop-t.clientHeight/2+10)}},ji=function(e,t){t.addEventListener("keydown",function(i){if(!i.isComposing&&e.options.keydown&&e.options.keydown(i),!((e.options.hint.extend.length>1||e.toolbar.elements.emoji)&&e.hint.select(i,e))){if(e.options.comment.enable&&e.currentMode==="wysiwyg"&&(i.key==="Backspace"||z("⌘X",i))&&e.wysiwyg.getComments(e),e.currentMode==="sv"){if($(e,i))return}else if(e.currentMode==="wysiwyg"){if(Rn(e,i))return}else if(e.currentMode==="ir"&&Te(e,i))return;if(e.options.ctrlEnter&&z("⌘Enter",i)){e.options.ctrlEnter(T(e)),i.preventDefault();return}if(z("⌘Z",i)&&!e.toolbar.elements.undo){e.undo.undo(e),i.preventDefault();return}if(z("⌘Y",i)&&!e.toolbar.elements.redo){e.undo.redo(e),i.preventDefault();return}if(i.key==="Escape"){e.hint.element.style.display==="block"?e.hint.element.style.display="none":e.options.esc&&!i.isComposing&&e.options.esc(T(e)),i.preventDefault();return}if((0,u._0)(i)&&i.altKey&&!i.shiftKey&&/^Digit[1-6]$/.test(i.code)){if(e.currentMode==="wysiwyg"){var a=i.code.replace("Digit","H");(0,y._Y)(getSelection().getRangeAt(0).startContainer,a)?Jn(e):$t(e,a),Ie(e)}else e.currentMode==="sv"?Lr(e,"#".repeat(parseInt(i.code.replace("Digit",""),10))+" "):e.currentMode==="ir"&&Bn(e,"#".repeat(parseInt(i.code.replace("Digit",""),10))+" ");return i.preventDefault(),!0}if((0,u._0)(i)&&i.altKey&&!i.shiftKey&&/^Digit[7-9]$/.test(i.code))return i.code==="Digit7"?tn(e,"wysiwyg",i):i.code==="Digit8"?tn(e,"ir",i):i.code==="Digit9"&&tn(e,"sv",i),!0;e.options.toolbar.find(function(o){if(!o.hotkey||o.toolbar){if(o.toolbar){var l=o.toolbar.find(function(E){if(!E.hotkey)return!1;if(z(E.hotkey,i))return e.toolbar.elements[E.name].children[0].dispatchEvent(new CustomEvent((0,u.y3)())),i.preventDefault(),!0});return!!l}return!1}if(z(o.hotkey,i))return e.toolbar.elements[o.name].children[0].dispatchEvent(new CustomEvent((0,u.y3)())),i.preventDefault(),!0})}})},Bi=function(e,t){t.addEventListener("selectstart",function(i){t.onmouseup=function(){setTimeout(function(){var a=Hn(e[e.currentMode].element);a.trim()?(e.currentMode==="wysiwyg"&&e.options.comment.enable&&(!(0,y.Th)(i.target,"data-type","footnotes-block")&&!(0,y.Th)(i.target,"data-type","link-ref-defs-block")?e.wysiwyg.showComment():e.wysiwyg.hideComment()),e.options.select&&e.options.select(a)):e.currentMode==="wysiwyg"&&e.options.comment.enable&&e.wysiwyg.hideComment()})}})},zi=function(e,t){var i=(0,H.RN)(e);i.extractContents(),i.insertNode(document.createTextNode(Lute.Caret)),i.insertNode(document.createTextNode(t));var a=(0,y.Th)(i.startContainer,"data-block","0");a||(a=e.sv.element);var o=e.lute.SpinVditorSVDOM(a.textContent);o="<div data-block='0'>"+o.replace(/<span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span><span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span></g,`<span data-type="newline"><br /><span style="display: none">
</span></span><span data-type="newline"><br /><span style="display: none">
</span></span></div><div data-block="0"><`)+"</div>",a.isEqualNode(e.sv.element)?a.innerHTML=o:a.outerHTML=o,je(e.sv.element),(0,H.ir)(e.sv.element,i),nt(e)},Qn=function(e,t,i){i===void 0&&(i=!0);var a=e;for(a.nodeType===3&&(a=a.parentElement);a;){if(a.getAttribute("data-type")===t)return a;i?a=a.previousElementSibling:a=a.nextElementSibling}return!1},_r=function(e,t){N("SpinVditorSVDOM",e,"argument",t.options.debugger);var i=t.lute.SpinVditorSVDOM(e);return e="<div data-block='0'>"+i.replace(/<span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span><span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span></g,`<span data-type="newline"><br /><span style="display: none">
</span></span><span data-type="newline"><br /><span style="display: none">
</span></span></div><div data-block="0"><`)+"</div>",N("SpinVditorSVDOM",e,"result",t.options.debugger),e},To=function(e){var t=e.getAttribute("data-type"),i=e.previousElementSibling,a=t&&t!=="text"&&t!=="table"&&t!=="heading-marker"&&t!=="newline"&&t!=="yaml-front-matter-open-marker"&&t!=="yaml-front-matter-close-marker"&&t!=="code-block-info"&&t!=="code-block-close-marker"&&t!=="code-block-open-marker"?e.textContent:"",o=!1;for(t==="newline"&&(o=!0);i&&!o;){var l=i.getAttribute("data-type");if(l==="li-marker"||l==="blockquote-marker"||l==="task-marker"||l==="padding"){var E=i.textContent;if(l==="li-marker"&&(t==="code-block-open-marker"||t==="code-block-info"))a=E.replace(/\S/g," ")+a;else if(t==="code-block-close-marker"&&i.nextElementSibling.isSameNode(e)){var L=Qn(e,"code-block-open-marker");L&&L.previousElementSibling&&(i=L.previousElementSibling,a=E+a)}else a=E+a}else l==="newline"&&(o=!0);i=i.previousElementSibling}return a},at=function(e,t){t===void 0&&(t={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),t.enableHint&&e.hint.render(e),e.preview.render(e);var i=T(e);typeof e.options.input=="function"&&t.enableInput&&e.options.input(i),e.options.counter.enable&&e.counter.render(e,i),e.options.cache.enable&&(0,u.D)()&&(localStorage.setItem(e.options.cache.id,i),e.options.cache.after&&e.options.cache.after(i)),e.devtools&&e.devtools.renderEchart(e),clearTimeout(e.sv.processTimeoutId),e.sv.processTimeoutId=window.setTimeout(function(){t.enableAddUndoStack&&!e.sv.composingLock&&e.undo.addToUndoStack(e)},e.options.undoDelay)},Lr=function(e,t){var i=(0,H.RN)(e),a=(0,O.f)(i.startContainer,"SPAN");a&&a.textContent.trim()!==""&&(t=`
`+t),i.collapse(!0),document.execCommand("insertHTML",!1,t)},ko=function(e,t,i,a){var o=(0,H.RN)(e),l=t.getAttribute("data-type");e.sv.element.childNodes.length===0&&(e.sv.element.innerHTML=`<span data-type="p" data-block="0"><span data-type="text"><wbr></span></span><span data-type="newline"><br><span style="display: none">
</span></span>`,(0,H.ir)(e.sv.element,o));var E=(0,y.pt)(o.startContainer),L=(0,O.f)(o.startContainer,"SPAN");if(E){if(l==="link"){var D=void 0;o.toString()===""?D="".concat(i).concat(Lute.Caret).concat(a):D="".concat(i).concat(o.toString()).concat(a.replace(")",Lute.Caret+")")),document.execCommand("insertHTML",!1,D);return}else if(l==="italic"||l==="bold"||l==="strike"||l==="inline-code"||l==="code"||l==="table"||l==="line"){var D=void 0;o.toString()===""?D="".concat(i).concat(Lute.Caret).concat(l==="code"?"":a):D="".concat(i).concat(o.toString()).concat(Lute.Caret).concat(l==="code"?"":a),l==="table"||l==="code"&&L&&L.textContent!==""?D=`

`+D:l==="line"&&(D=`

`.concat(i,`
`).concat(Lute.Caret)),document.execCommand("insertHTML",!1,D);return}else if((l==="check"||l==="list"||l==="ordered-list"||l==="quote")&&L){var A="* ";l==="check"?A="* [ ] ":l==="ordered-list"?A="1. ":l==="quote"&&(A="> ");var P=Qn(L,"newline");P?P.insertAdjacentText("afterend",A):E.insertAdjacentText("afterbegin",A),V(e);return}(0,H.ir)(e.sv.element,o),at(e)}},Ar=function(e){switch(e.currentMode){case"ir":return e.ir.element;case"wysiwyg":return e.wysiwyg.element;case"sv":return e.sv.element}},Dr=function(e,t){e.options.upload.setHeaders&&(e.options.upload.headers=e.options.upload.setHeaders()),e.options.upload.headers&&Object.keys(e.options.upload.headers).forEach(function(i){t.setRequestHeader(i,e.options.upload.headers[i])})},xo=function(e,t,i,a){function o(l){return l instanceof i?l:new i(function(E){E(l)})}return new(i||(i=Promise))(function(l,E){function L(P){try{A(a.next(P))}catch(U){E(U)}}function D(P){try{A(a.throw(P))}catch(U){E(U)}}function A(P){P.done?l(P.value):o(P.value).then(L,D)}A((a=a.apply(e,t||[])).next())})},Mo=function(e,t){var i={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,o,l,E;return E={next:L(0),throw:L(1),return:L(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function L(A){return function(P){return D([A,P])}}function D(A){if(a)throw new TypeError("Generator is already executing.");for(;E&&(E=0,A[0]&&(i=0)),i;)try{if(a=1,o&&(l=A[0]&2?o.return:A[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,A[1])).done)return l;switch(o=0,l&&(A=[A[0]&2,l.value]),A[0]){case 0:case 1:l=A;break;case 4:return i.label++,{value:A[1],done:!1};case 5:i.label++,o=A[1],A=[0];continue;case 7:A=i.ops.pop(),i.trys.pop();continue;default:if(l=i.trys,!(l=l.length>0&&l[l.length-1])&&(A[0]===6||A[0]===2)){i=0;continue}if(A[0]===3&&(!l||A[1]>l[0]&&A[1]<l[3])){i.label=A[1];break}if(A[0]===6&&i.label<l[1]){i.label=l[1],l=A;break}if(l&&i.label<l[2]){i.label=l[2],i.ops.push(A);break}l[2]&&i.ops.pop(),i.trys.pop();continue}A=t.call(e,i)}catch(P){A=[6,P],o=0}finally{a=l=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}},_o=function(){function e(){this.isUploading=!1,this.element=document.createElement("div"),this.element.className="vditor-upload"}return e}(),Lo=function(e,t){e.tip.hide();var i=[],a="",o="";e.options.lang,e.options;for(var l=function(D,A){var P=t[A],U=!0;P.name||(a+="<li>".concat(window.VditorI18n.nameEmpty,"</li>"),U=!1),P.size>e.options.upload.max&&(a+="<li>".concat(P.name," ").concat(window.VditorI18n.over," ").concat(e.options.upload.max/1024/1024,"M</li>"),U=!1);var re=P.name.lastIndexOf("."),ie=P.name.substr(re),te=e.options.upload.filename(P.name.substr(0,re))+ie;if(e.options.upload.accept){var be=e.options.upload.accept.split(",").some(function(he){var ee=he.trim();if(ee.indexOf(".")===0){if(ie.toLowerCase()===ee.toLowerCase())return!0}else if(P.type.split("/")[0]===ee.split("/")[0])return!0;return!1});be||(a+="<li>".concat(P.name," ").concat(window.VditorI18n.fileTypeError,"</li>"),U=!1)}U&&(i.push(P),o+="<li>".concat(te," ").concat(window.VditorI18n.uploading,"</li>"))},E=t.length,L=0;L<E;L++)l(E,L);return e.tip.show("<ul>".concat(a).concat(o,"</ul>")),i},Ao=function(e,t){var i=Ar(t);i.focus();var a=JSON.parse(e),o="";a.code===1&&(o="".concat(a.msg)),a.data.errFiles&&a.data.errFiles.length>0&&(o="<ul><li>".concat(o,"</li>"),a.data.errFiles.forEach(function(E){var L=E.lastIndexOf("."),D=t.options.upload.filename(E.substr(0,L))+E.substr(L);o+="<li>".concat(D," ").concat(window.VditorI18n.uploadError,"</li>")}),o+="</ul>"),o?t.tip.show(o):t.tip.hide();var l="";Object.keys(a.data.succMap).forEach(function(E){var L=a.data.succMap[E],D=E.lastIndexOf("."),A=E.substr(D),P=t.options.upload.filename(E.substr(0,D))+A;A=A.toLowerCase(),A.indexOf(".wav")===0||A.indexOf(".mp3")===0||A.indexOf(".ogg")===0?t.currentMode==="wysiwyg"?l+=`<div class="vditor-wysiwyg__block" data-type="html-block"
 data-block="0"><pre><code>&lt;audio controls="controls" src="`.concat(L,'"&gt;&lt;/audio&gt;</code></pre><pre class="vditor-wysiwyg__preview" data-render="1"><audio controls="controls" src="').concat(L,`"></audio></pre></div>
`):t.currentMode==="ir"?l+='<audio controls="controls" src="'.concat(L,`"></audio>
`):l+="[".concat(P,"](").concat(L,`)
`):A.indexOf(".apng")===0||A.indexOf(".bmp")===0||A.indexOf(".gif")===0||A.indexOf(".ico")===0||A.indexOf(".cur")===0||A.indexOf(".jpg")===0||A.indexOf(".jpeg")===0||A.indexOf(".jfif")===0||A.indexOf(".pjp")===0||A.indexOf(".pjpeg")===0||A.indexOf(".png")===0||A.indexOf(".svg")===0||A.indexOf(".webp")===0?t.currentMode==="wysiwyg"?l+='<img alt="'.concat(P,'" src="').concat(L,`">
`):l+="![".concat(P,"](").concat(L,`)
`):t.currentMode==="wysiwyg"?l+='<a href="'.concat(L,'">').concat(P,`</a>
`):l+="[".concat(P,"](").concat(L,`)
`)}),(0,H.jl)(t.upload.range),document.execCommand("insertHTML",!1,l),t.upload.range=getSelection().getRangeAt(0).cloneRange()},Fi=function(e,t,i){return xo(void 0,void 0,void 0,function(){var a,o,te,l,E,E,L,D,A,P,U,re,ie,te,be,he;return Mo(this,function(ee){switch(ee.label){case 0:for(a=[],o=e.options.upload.multiple===!0?t.length:1,te=0;te<o;te++)l=t[te],l instanceof DataTransferItem&&(l=l.getAsFile()),a.push(l);return e.options.upload.handler?[4,e.options.upload.handler(a)]:[3,2];case 1:return E=ee.sent(),i&&(i.value=""),typeof E=="string"?(e.tip.show(E),[2]):[2];case 2:return!e.options.upload.url||!e.upload?(i&&(i.value=""),e.tip.show("please config: options.upload.url"),[2]):e.options.upload.file?[4,e.options.upload.file(a)]:[3,4];case 3:a=ee.sent(),ee.label=4;case 4:if(e.options.upload.validate&&(E=e.options.upload.validate(a),typeof E=="string"))return e.tip.show(E),[2];if(L=Ar(e),e.upload.range=(0,H.RN)(e),D=Lo(e,a),D.length===0)return i&&(i.value=""),[2];for(A=new FormData,P=e.options.upload.extraData,U=0,re=Object.keys(P);U<re.length;U++)ie=re[U],A.append(ie,P[ie]);for(te=0,be=D.length;te<be;te++)A.append(e.options.upload.fieldName,D[te]);return he=new XMLHttpRequest,he.open("POST",e.options.upload.url),e.options.upload.token&&he.setRequestHeader("X-Upload-Token",e.options.upload.token),e.options.upload.withCredentials&&(he.withCredentials=!0),Dr(e,he),e.upload.isUploading=!0,L.setAttribute("contenteditable","false"),he.onreadystatechange=function(){if(he.readyState===XMLHttpRequest.DONE){if(e.upload.isUploading=!1,L.setAttribute("contenteditable","true"),he.status>=200&&he.status<300)if(e.options.upload.success)e.options.upload.success(L,he.responseText);else{var xe=he.responseText;e.options.upload.format&&(xe=e.options.upload.format(t,he.responseText)),Ao(xe,e)}else e.options.upload.error?e.options.upload.error(he.responseText):e.tip.show(he.responseText);i&&(i.value=""),e.upload.element.style.display="none"}},he.upload.onprogress=function(xe){if(xe.lengthComputable){var ve=xe.loaded/xe.total*100;e.upload.element.style.display="block";var _e=e.upload.element;_e.style.width=ve+"%"}},he.send(A),[2]}})})},ei=function(e,t,i){var a,o=(0,y.pt)(t.startContainer);if(o||(o=e.wysiwyg.element),i&&i.inputType!=="formatItalic"&&i.inputType!=="deleteByDrag"&&i.inputType!=="insertFromDrop"&&i.inputType!=="formatBold"&&i.inputType!=="formatRemove"&&i.inputType!=="formatStrikeThrough"&&i.inputType!=="insertUnorderedList"&&i.inputType!=="insertOrderedList"&&i.inputType!=="formatOutdent"&&i.inputType!=="formatIndent"&&i.inputType!==""||!i){var l=Et(t.startContainer);l&&l.remove(),e.wysiwyg.element.querySelectorAll("wbr").forEach(function(ve){ve.remove()}),t.insertNode(document.createElement("wbr")),o.querySelectorAll("[style]").forEach(function(ve){ve.removeAttribute("style")}),o.querySelectorAll(".vditor-comment").forEach(function(ve){ve.textContent.trim()===""&&(ve.classList.remove("vditor-comment","vditor-comment--focus"),ve.removeAttribute("data-cmtids"))}),(a=o.previousElementSibling)===null||a===void 0||a.querySelectorAll(".vditor-comment").forEach(function(ve){ve.textContent.trim()===""&&(ve.classList.remove("vditor-comment","vditor-comment--focus"),ve.removeAttribute("data-cmtids"))});var E="";o.getAttribute("data-type")==="link-ref-defs-block"&&(o=e.wysiwyg.element);var L=o.isEqualNode(e.wysiwyg.element),D=(0,y.Th)(o,"data-type","footnotes-block");if(L)E=o.innerHTML;else{var A=(0,y.KR)(t.startContainer);if(A&&!D){var P=(0,O.f)(t.startContainer,"BLOCKQUOTE");P?o=(0,y.pt)(t.startContainer)||o:o=A}if(D&&(o=D),E=o.outerHTML,o.tagName==="UL"||o.tagName==="OL"){var U=o.previousElementSibling,re=o.nextElementSibling;U&&(U.tagName==="UL"||U.tagName==="OL")&&(E=U.outerHTML+E,U.remove()),re&&(re.tagName==="UL"||re.tagName==="OL")&&(E=E+re.outerHTML,re.remove()),E=E.replace("<div><wbr><br></div>","<li><p><wbr><br></p></li>")}o.innerText.startsWith("```")||(e.wysiwyg.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(ve){ve&&!o.isEqualNode(ve)&&(E+=ve.outerHTML,ve.remove())}),e.wysiwyg.element.querySelectorAll("[data-type='footnotes-block']").forEach(function(ve){ve&&!o.isEqualNode(ve)&&(E+=ve.outerHTML,ve.remove())}))}if(E=E.replace(/<\/(strong|b)><strong data-marker="\W{2}">/g,"").replace(/<\/(em|i)><em data-marker="\W{1}">/g,"").replace(/<\/(s|strike)><s data-marker="~{1,2}">/g,""),E==='<p data-block="0">```<wbr></p>'&&e.hint.recentLanguage&&(E='<p data-block="0">```<wbr></p>'.replace("```","```"+e.hint.recentLanguage)),N("SpinVditorDOM",E,"argument",e.options.debugger),E=e.lute.SpinVditorDOM(E),N("SpinVditorDOM",E,"result",e.options.debugger),L)o.innerHTML=E;else if(o.outerHTML=E,D){var ie=(0,y.Ab)(e.wysiwyg.element.querySelector("wbr"),"LI");if(ie){var te=e.wysiwyg.element.querySelector('sup[data-type="footnotes-ref"][data-footnotes-label="'.concat(ie.getAttribute("data-marker"),'"]'));te&&te.setAttribute("aria-label",ie.textContent.trim().substr(0,24))}}var be,he=e.wysiwyg.element.querySelectorAll("[data-type='link-ref-defs-block']");he.forEach(function(ve,_e){_e===0?be=ve:(be.insertAdjacentHTML("beforeend",ve.innerHTML),ve.remove())}),he.length>0&&e.wysiwyg.element.insertAdjacentElement("beforeend",he[0]);var ee,xe=e.wysiwyg.element.querySelectorAll("[data-type='footnotes-block']");xe.forEach(function(ve,_e){_e===0?ee=ve:(ee.insertAdjacentHTML("beforeend",ve.innerHTML),ve.remove())}),xe.length>0&&e.wysiwyg.element.insertAdjacentElement("beforeend",xe[0]),(0,H.ir)(e.wysiwyg.element,t),e.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach(function(ve){le(ve,e)}),i&&(i.inputType==="deleteContentBackward"||i.inputType==="deleteContentForward")&&e.options.comment.enable&&(e.wysiwyg.triggerRemoveComment(e),e.options.comment.adjustTop(e.wysiwyg.getComments(e,!0)))}de(e),Ie(e,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},Do=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},Oo=function(e,t,i,a){function o(l){return l instanceof i?l:new i(function(E){E(l)})}return new(i||(i=Promise))(function(l,E){function L(P){try{A(a.next(P))}catch(U){E(U)}}function D(P){try{A(a.throw(P))}catch(U){E(U)}}function A(P){P.done?l(P.value):o(P.value).then(L,D)}A((a=a.apply(e,t||[])).next())})},Po=function(e,t){var i={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,o,l,E;return E={next:L(0),throw:L(1),return:L(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function L(A){return function(P){return D([A,P])}}function D(A){if(a)throw new TypeError("Generator is already executing.");for(;E&&(E=0,A[0]&&(i=0)),i;)try{if(a=1,o&&(l=A[0]&2?o.return:A[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,A[1])).done)return l;switch(o=0,l&&(A=[A[0]&2,l.value]),A[0]){case 0:case 1:l=A;break;case 4:return i.label++,{value:A[1],done:!1};case 5:i.label++,o=A[1],A=[0];continue;case 7:A=i.ops.pop(),i.trys.pop();continue;default:if(l=i.trys,!(l=l.length>0&&l[l.length-1])&&(A[0]===6||A[0]===2)){i=0;continue}if(A[0]===3&&(!l||A[1]>l[0]&&A[1]<l[3])){i.label=A[1];break}if(A[0]===6&&i.label<l[1]){i.label=l[1],l=A;break}if(l&&i.label<l[2]){i.label=l[2],i.ops.push(A);break}l[2]&&i.ops.pop(),i.trys.pop();continue}A=t.call(e,i)}catch(P){A=[6,P],o=0}finally{a=l=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}},Or=function(e,t,i){if(e.keyCode===229&&e.code===""&&e.key==="Unidentified"&&t.currentMode!=="sv"){var a=(0,y.pt)(i);if(a&&a.textContent.trim()==="")return t[t.currentMode].composingLock=!0,!1}return!0},Pr=function(e,t,i){if(!(i.key==="Enter"||i.key==="Tab"||i.key==="Backspace"||i.key.indexOf("Arrow")>-1||(0,u._0)(i)||i.key==="Escape"||i.shiftKey||i.altKey)){var a=(0,y._Y)(e.startContainer,"P")||(0,y._Y)(e.startContainer,"LI");if(a&&(0,H.ED)(a,t[t.currentMode].element,e).start===0){a.nodeValue&&(a.nodeValue=a.nodeValue.replace(/\u2006/g,""));var o=document.createTextNode(f.Y.ZWSP);e.insertNode(o),e.setStartAfter(o)}}},Rr=function(e,t){if(t==="ArrowDown"||t==="ArrowUp"){var i=(0,y.Th)(e.startContainer,"data-type","math-inline")||(0,y.Th)(e.startContainer,"data-type","html-entity")||(0,y.Th)(e.startContainer,"data-type","html-inline");i&&(t==="ArrowDown"&&e.setStartAfter(i.parentElement),t==="ArrowUp"&&e.setStartBefore(i.parentElement))}},Nn=function(e,t){var i=(0,H.RN)(e),a=(0,y.pt)(i.startContainer);a&&(a.insertAdjacentHTML(t,'<p data-block="0">'.concat(f.Y.ZWSP,`<wbr>
</p>`)),(0,H.ir)(e[e.currentMode].element,i),vn(e),Ne(e))},Ro=function(e){var t=(0,y._Y)(e,"TABLE");return t&&t.rows[0].cells[0].isSameNode(e)?t:!1},Io=function(e){var t=(0,y._Y)(e,"TABLE");return t&&t.lastElementChild.lastElementChild.lastElementChild.isSameNode(e)?t:!1},Ir=function(e,t,i){i===void 0&&(i=!0);var a=e.previousElementSibling;return a||(e.parentElement.previousElementSibling?a=e.parentElement.previousElementSibling.lastElementChild:e.parentElement.parentElement.tagName==="TBODY"&&e.parentElement.parentElement.previousElementSibling?a=e.parentElement.parentElement.previousElementSibling.lastElementChild.lastElementChild:a=null),a&&(t.selectNodeContents(a),i||t.collapse(!1),(0,H.jl)(t)),a},jn=function(e,t,i,a,o){var l=(0,H.ED)(a,e[e.currentMode].element,i);if(t.key==="ArrowDown"&&a.textContent.trimRight().substr(l.start).indexOf(`
`)===-1||t.key==="ArrowRight"&&l.start>=a.textContent.trimRight().length){var E=o.nextElementSibling;return!E||E&&(E.tagName==="TABLE"||E.getAttribute("data-type"))?(o.insertAdjacentHTML("afterend",'<p data-block="0">'.concat(f.Y.ZWSP,"<wbr></p>")),(0,H.ir)(e[e.currentMode].element,i)):(i.selectNodeContents(E),i.collapse(!0),(0,H.jl)(i)),t.preventDefault(),!0}return!1},yn=function(e,t,i,a,o){var l=(0,H.ED)(a,e[e.currentMode].element,i);if(t.key==="ArrowUp"&&a.textContent.substr(0,l.start).indexOf(`
`)===-1||(t.key==="ArrowLeft"||t.key==="Backspace"&&i.toString()==="")&&l.start===0){var E=o.previousElementSibling;return!E||E&&(E.tagName==="TABLE"||E.getAttribute("data-type"))?(o.insertAdjacentHTML("beforebegin",'<p data-block="0">'.concat(f.Y.ZWSP,"<wbr></p>")),(0,H.ir)(e[e.currentMode].element,i)):(i.selectNodeContents(E),i.collapse(!1),(0,H.jl)(i)),t.preventDefault(),!0}return!1},ti=function(e,t,i,a){a===void 0&&(a=!0);var o=(0,y._Y)(t.startContainer,"LI");if(e[e.currentMode].element.querySelectorAll("wbr").forEach(function(P){P.remove()}),t.insertNode(document.createElement("wbr")),a&&o){for(var l="",E=0;E<o.parentElement.childElementCount;E++){var L=o.parentElement.children[E].querySelector("input");L&&L.remove(),l+='<p data-block="0">'.concat(o.parentElement.children[E].innerHTML.trimLeft(),"</p>")}o.parentElement.insertAdjacentHTML("beforebegin",l),o.parentElement.remove()}else if(o)if(i==="check")o.parentElement.querySelectorAll("li").forEach(function(P){P.insertAdjacentHTML("afterbegin",'<input type="checkbox" />'.concat(P.textContent.indexOf(" ")===0?"":" ")),P.classList.add("vditor-task")});else{o.querySelector("input")&&o.parentElement.querySelectorAll("li").forEach(function(P){P.querySelector("input").remove(),P.classList.remove("vditor-task")});var A=void 0;i==="list"?(A=document.createElement("ul"),A.setAttribute("data-marker","*")):(A=document.createElement("ol"),A.setAttribute("data-marker","1.")),A.setAttribute("data-block","0"),A.setAttribute("data-tight",o.parentElement.getAttribute("data-tight")),A.innerHTML=o.parentElement.innerHTML,o.parentElement.parentNode.replaceChild(A,o.parentElement)}else{var D=(0,y.Th)(t.startContainer,"data-block","0");D||(e[e.currentMode].element.querySelector("wbr").remove(),D=e[e.currentMode].element.querySelector("p"),D.innerHTML="<wbr>"),i==="check"?(D.insertAdjacentHTML("beforebegin",'<ul data-block="0"><li class="vditor-task"><input type="checkbox" /> '.concat(D.innerHTML,"</li></ul>")),D.remove()):i==="list"?(D.insertAdjacentHTML("beforebegin",'<ul data-block="0"><li>'.concat(D.innerHTML,"</li></ul>")),D.remove()):i==="ordered-list"&&(D.insertAdjacentHTML("beforebegin",'<ol data-block="0"><li>'.concat(D.innerHTML,"</li></ol>")),D.remove())}},Hr=function(e,t,i){var a=t.previousElementSibling;if(t&&a){var o=[t];Array.from(i.cloneContents().children).forEach(function(D,A){D.nodeType!==3&&t&&D.textContent.trim()!==""&&t.getAttribute("data-node-id")===D.getAttribute("data-node-id")&&(A!==0&&o.push(t),t=t.nextElementSibling)}),e[e.currentMode].element.querySelectorAll("wbr").forEach(function(D){D.remove()}),i.insertNode(document.createElement("wbr"));var l=a.parentElement,E="";o.forEach(function(D){var A=D.getAttribute("data-marker");A.length!==1&&(A="1".concat(A.slice(-1))),E+='<li data-node-id="'.concat(D.getAttribute("data-node-id"),'" data-marker="').concat(A,'">').concat(D.innerHTML,"</li>"),D.remove()}),a.insertAdjacentHTML("beforeend","<".concat(l.tagName,' data-block="0">').concat(E,"</").concat(l.tagName,">")),e.currentMode==="wysiwyg"?l.outerHTML=e.lute.SpinVditorDOM(l.outerHTML):l.outerHTML=e.lute.SpinVditorIRDOM(l.outerHTML),(0,H.ir)(e[e.currentMode].element,i);var L=(0,y.KR)(i.startContainer);L&&L.querySelectorAll(".vditor-".concat(e.currentMode,"__preview[data-render='2']")).forEach(function(D){le(D,e),e.currentMode==="wysiwyg"&&D.previousElementSibling.setAttribute("style","display:none")}),Ne(e),vn(e)}else e[e.currentMode].element.focus()},$i=function(e,t,i,a){var o=(0,y._Y)(t.parentElement,"LI");if(o){e[e.currentMode].element.querySelectorAll("wbr").forEach(function(U){U.remove()}),i.insertNode(document.createElement("wbr"));var l=t.parentElement,E=l.cloneNode(),L=[t];Array.from(i.cloneContents().children).forEach(function(U,re){U.nodeType!==3&&t&&U.textContent.trim()!==""&&t.getAttribute("data-node-id")===U.getAttribute("data-node-id")&&(re!==0&&L.push(t),t=t.nextElementSibling)});var D=!1,A="";l.querySelectorAll("li").forEach(function(U){D&&(A+=U.outerHTML,!U.nextElementSibling&&!U.previousElementSibling?U.parentElement.remove():U.remove()),U.isSameNode(L[L.length-1])&&(D=!0)}),L.reverse().forEach(function(U){o.insertAdjacentElement("afterend",U)}),A&&(E.innerHTML=A,L[0].insertAdjacentElement("beforeend",E)),e.currentMode==="wysiwyg"?a.outerHTML=e.lute.SpinVditorDOM(a.outerHTML):a.outerHTML=e.lute.SpinVditorIRDOM(a.outerHTML),(0,H.ir)(e[e.currentMode].element,i);var P=(0,y.KR)(i.startContainer);P&&P.querySelectorAll(".vditor-".concat(e.currentMode,"__preview[data-render='2']")).forEach(function(U){le(U,e),e.currentMode==="wysiwyg"&&U.previousElementSibling.setAttribute("style","display:none")}),Ne(e),vn(e)}else e[e.currentMode].element.focus()},ni=function(e,t){for(var i=getSelection().getRangeAt(0).startContainer.parentElement,a=e.rows[0].cells.length,o=e.rows.length,l=0,E=0;E<o;E++)for(var L=0;L<a;L++)if(e.rows[E].cells[L].isSameNode(i)){l=L;break}for(var D=0;D<o;D++)e.rows[D].cells[l].setAttribute("align",t)},Ui=function(e){var t=e.trimRight().split(`
`).pop();return t===""?!1:(t.replace(/ |-/g,"")===""||t.replace(/ |_/g,"")===""||t.replace(/ |\*/g,"")==="")&&t.replace(/ /g,"").length>2?!(t.indexOf("-")>-1&&t.trimLeft().indexOf(" ")===-1&&e.trimRight().split(`
`).length>1||t.indexOf("    ")===0||t.indexOf("	")===0):!1},Vi=function(e){var t=e.trimRight().split(`
`);return e=t.pop(),e.indexOf("    ")===0||e.indexOf("	")===0||(e=e.trimLeft(),e===""||t.length===0)?!1:e.replace(/-/g,"")===""||e.replace(/=/g,"")===""},Ne=function(e,t){t===void 0&&(t={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),e.currentMode==="wysiwyg"?Ie(e,t):e.currentMode==="ir"?Ut(e,t):e.currentMode==="sv"&&at(e,t)},Nr=function(e,t,i,a){var o,l=e.startContainer,E=(0,y._Y)(l,"LI");if(E){if(!(0,u._0)(a)&&!a.altKey&&a.key==="Enter"&&!a.shiftKey&&i&&E.contains(i)&&i.nextElementSibling)return E&&!E.textContent.endsWith(`
`)&&E.insertAdjacentText("beforeend",`
`),e.insertNode(document.createTextNode(`

`)),e.collapse(!1),Ne(t),a.preventDefault(),!0;if(!(0,u._0)(a)&&!a.shiftKey&&!a.altKey&&a.key==="Backspace"&&!E.previousElementSibling&&e.toString()===""&&(0,H.ED)(E,t[t.currentMode].element,e).start===0)return E.nextElementSibling?(E.parentElement.insertAdjacentHTML("beforebegin",'<p data-block="0"><wbr>'.concat(E.innerHTML,"</p>")),E.remove()):E.parentElement.outerHTML='<p data-block="0"><wbr>'.concat(E.innerHTML,"</p>"),(0,H.ir)(t[t.currentMode].element,e),Ne(t),a.preventDefault(),!0;if(!(0,u._0)(a)&&!a.shiftKey&&!a.altKey&&a.key==="Backspace"&&E.textContent.trim().replace(f.Y.ZWSP,"")===""&&e.toString()===""&&((o=E.previousElementSibling)===null||o===void 0?void 0:o.tagName)==="LI")return E.previousElementSibling.insertAdjacentText("beforeend",`

`),e.selectNodeContents(E.previousElementSibling),e.collapse(!1),E.remove(),(0,H.ir)(t[t.currentMode].element,e),Ne(t),a.preventDefault(),!0;if(!(0,u._0)(a)&&!a.altKey&&a.key==="Tab"){var L=!1;if((e.startOffset===0&&(l.nodeType===3&&!l.previousSibling||l.nodeType!==3&&l.nodeName==="LI")||E.classList.contains("vditor-task")&&e.startOffset===1&&l.previousSibling.nodeType!==3&&l.previousSibling.tagName==="INPUT")&&(L=!0),L||e.toString()!=="")return a.shiftKey?$i(t,E,e,E.parentElement):Hr(t,E,e),a.preventDefault(),!0}}return!1},qi=function(e,t,i){if(e.options.tab&&i.key==="Tab")return i.shiftKey||(t.toString()===""?(t.insertNode(document.createTextNode(e.options.tab)),t.collapse(!1)):(t.extractContents(),t.insertNode(document.createTextNode(e.options.tab)),t.collapse(!1))),(0,H.jl)(t),Ne(e),i.preventDefault(),!0},jr=function(e,t,i,a){if(i){if(!(0,u._0)(e)&&!e.altKey&&e.key==="Enter"){var o=String.raw(Zr||(Zr=Do(["",""],["",""])),i.textContent).replace(/\\\|/g,"").trim(),l=o.split("|");if(o.startsWith("|")&&o.endsWith("|")&&l.length>3){var E=l.map(function(){return"---"}).join("|");return E=i.textContent+`
`+E.substring(3,E.length-3)+`
|<wbr>`,i.outerHTML=t.lute.SpinVditorDOM(E),(0,H.ir)(t[t.currentMode].element,a),Ne(t),nt(t),e.preventDefault(),!0}if(Ui(i.innerHTML)&&i.previousElementSibling){var L="",D=i.innerHTML.trimRight().split(`
`);return D.length>1&&(D.pop(),L='<p data-block="0">'.concat(D.join(`
`),"</p>")),i.insertAdjacentHTML("afterend","".concat(L,`<hr data-block="0"><p data-block="0"><wbr>
</p>`)),i.remove(),(0,H.ir)(t[t.currentMode].element,a),Ne(t),nt(t),e.preventDefault(),!0}if(Vi(i.innerHTML))return t.currentMode==="wysiwyg"?i.outerHTML=t.lute.SpinVditorDOM(i.innerHTML+`<p data-block="0"><wbr>
</p>`):i.outerHTML=t.lute.SpinVditorIRDOM(i.innerHTML+`<p data-block="0"><wbr>
</p>`),(0,H.ir)(t[t.currentMode].element,a),Ne(t),nt(t),e.preventDefault(),!0}if(a.collapsed&&i.previousElementSibling&&e.key==="Backspace"&&!(0,u._0)(e)&&!e.altKey&&!e.shiftKey&&i.textContent.trimRight().split(`
`).length>1&&(0,H.ED)(i,t[t.currentMode].element,a).start===0){var A=(0,y.Rp)(i.previousElementSibling);return A.textContent.endsWith(`
`)||(A.textContent=A.textContent+`
`),A.parentElement.insertAdjacentHTML("beforeend","<wbr>".concat(i.innerHTML)),i.remove(),(0,H.ir)(t[t.currentMode].element,a),!1}return!1}},Br=function(e,t,i){for(var a="",o=0;o<i.parentElement.childElementCount;o++)a+='<td align="'.concat(i.parentElement.children[o].getAttribute("align"),'"> </td>');i.tagName==="TH"?i.parentElement.parentElement.insertAdjacentHTML("afterend","<tbody><tr>".concat(a,"</tr></tbody>")):i.parentElement.insertAdjacentHTML("afterend","<tr>".concat(a,"</tr>")),Ne(e)},zr=function(e,t,i){for(var a="",o=0;o<i.parentElement.childElementCount;o++)i.tagName==="TH"?a+='<th align="'.concat(i.parentElement.children[o].getAttribute("align"),'"> </th>'):a+='<td align="'.concat(i.parentElement.children[o].getAttribute("align"),'"> </td>');if(i.tagName==="TH"){i.parentElement.parentElement.insertAdjacentHTML("beforebegin","<thead><tr>".concat(a,"</tr></thead>")),t.insertNode(document.createElement("wbr"));var l=i.parentElement.innerHTML.replace(/<th>/g,"<td>").replace(/<\/th>/g,"</td>");i.parentElement.parentElement.nextElementSibling.insertAdjacentHTML("afterbegin",l),i.parentElement.parentElement.remove(),(0,H.ir)(e.ir.element,t)}else i.parentElement.insertAdjacentHTML("beforebegin","<tr>".concat(a,"</tr>"));Ne(e)},ii=function(e,t,i,a){a===void 0&&(a="afterend");for(var o=0,l=i.previousElementSibling;l;)o++,l=l.previousElementSibling;for(var E=0;E<t.rows.length;E++)E===0?t.rows[E].cells[o].insertAdjacentHTML(a,"<th> </th>"):t.rows[E].cells[o].insertAdjacentHTML(a,"<td> </td>");Ne(e)},Fr=function(e,t,i){if(i.tagName==="TD"){var a=i.parentElement.parentElement;i.parentElement.previousElementSibling?t.selectNodeContents(i.parentElement.previousElementSibling.lastElementChild):t.selectNodeContents(a.previousElementSibling.lastElementChild.lastElementChild),a.childElementCount===1?a.remove():i.parentElement.remove(),t.collapse(!1),(0,H.jl)(t),Ne(e)}},$r=function(e,t,i,a){for(var o=0,l=a.previousElementSibling;l;)o++,l=l.previousElementSibling;(a.previousElementSibling||a.nextElementSibling)&&(t.selectNodeContents(a.previousElementSibling||a.nextElementSibling),t.collapse(!0));for(var E=0;E<i.rows.length;E++){var L=i.rows[E].cells;if(L.length===1){i.remove(),vn(e);break}L[o].remove()}(0,H.jl)(t),Ne(e)},Ur=function(e,t,i){var a=i.startContainer,o=(0,y._Y)(a,"TD")||(0,y._Y)(a,"TH");if(o){if(!(0,u._0)(t)&&!t.altKey&&t.key==="Enter"){(!o.lastElementChild||o.lastElementChild&&(!o.lastElementChild.isSameNode(o.lastChild)||o.lastElementChild.tagName!=="BR"))&&o.insertAdjacentHTML("beforeend","<br>");var l=document.createElement("br");return i.insertNode(l),i.setStartAfter(l),Ne(e),nt(e),t.preventDefault(),!0}if(t.key==="Tab"){if(t.shiftKey)return Ir(o,i),t.preventDefault(),!0;var E=o.nextElementSibling;return E||(o.parentElement.nextElementSibling?E=o.parentElement.nextElementSibling.firstElementChild:o.parentElement.parentElement.tagName==="THEAD"&&o.parentElement.parentElement.nextElementSibling?E=o.parentElement.parentElement.nextElementSibling.firstElementChild.firstElementChild:E=null),E&&(i.selectNodeContents(E),(0,H.jl)(i)),t.preventDefault(),!0}var L=o.parentElement.parentElement.parentElement;if(t.key==="ArrowUp"){if(t.preventDefault(),o.tagName==="TH")return L.previousElementSibling?(i.selectNodeContents(L.previousElementSibling),i.collapse(!1),(0,H.jl)(i)):Nn(e,"beforebegin"),!0;for(var D=0,A=o.parentElement;D<A.cells.length&&!A.cells[D].isSameNode(o);D++);var P=A.previousElementSibling;return P||(P=A.parentElement.previousElementSibling.firstChild),i.selectNodeContents(P.cells[D]),i.collapse(!1),(0,H.jl)(i),!0}if(t.key==="ArrowDown"){t.preventDefault();var A=o.parentElement;if(!A.nextElementSibling&&o.tagName==="TD")return L.nextElementSibling?(i.selectNodeContents(L.nextElementSibling),i.collapse(!0),(0,H.jl)(i)):Nn(e,"afterend"),!0;for(var D=0;D<A.cells.length&&!A.cells[D].isSameNode(o);D++);var E=A.nextElementSibling;return E||(E=A.parentElement.nextElementSibling.firstChild),i.selectNodeContents(E.cells[D]),i.collapse(!0),(0,H.jl)(i),!0}if(e.currentMode==="wysiwyg"&&!(0,u._0)(t)&&t.key==="Enter"&&!t.shiftKey&&t.altKey){var U=e.wysiwyg.popover.querySelector(".vditor-input");return U.focus(),U.select(),t.preventDefault(),!0}if(!(0,u._0)(t)&&!t.shiftKey&&!t.altKey&&t.key==="Backspace"&&i.startOffset===0&&i.toString()===""){var re=Ir(o,i,!1);return!re&&L&&(L.textContent.trim()===""?(L.outerHTML=`<p data-block="0"><wbr>
</p>`,(0,H.ir)(e[e.currentMode].element,i)):(i.setStartBefore(L),i.collapse(!0)),Ne(e)),t.preventDefault(),!0}if(z("⇧⌘F",t))return zr(e,i,o),t.preventDefault(),!0;if(z("⌘=",t))return Br(e,i,o),t.preventDefault(),!0;if(z("⇧⌘G",t))return ii(e,L,o,"beforebegin"),t.preventDefault(),!0;if(z("⇧⌘=",t))return ii(e,L,o),t.preventDefault(),!0;if(z("⌘-",t))return Fr(e,i,o),t.preventDefault(),!0;if(z("⇧⌘-",t))return $r(e,i,L,o),t.preventDefault(),!0;if(z("⇧⌘L",t)){if(e.currentMode==="ir")return ni(L,"left"),Ne(e),t.preventDefault(),!0;var ie=e.wysiwyg.popover.querySelector('[data-type="left"]');if(ie)return ie.click(),t.preventDefault(),!0}if(z("⇧⌘C",t)){if(e.currentMode==="ir")return ni(L,"center"),Ne(e),t.preventDefault(),!0;var ie=e.wysiwyg.popover.querySelector('[data-type="center"]');if(ie)return ie.click(),t.preventDefault(),!0}if(z("⇧⌘R",t)){if(e.currentMode==="ir")return ni(L,"right"),Ne(e),t.preventDefault(),!0;var ie=e.wysiwyg.popover.querySelector('[data-type="right"]');if(ie)return ie.click(),t.preventDefault(),!0}}return!1},Vr=function(e,t,i,a){if(i.tagName==="PRE"&&z("⌘A",t))return a.selectNodeContents(i.firstElementChild),t.preventDefault(),!0;if(e.options.tab&&t.key==="Tab"&&!t.shiftKey&&a.toString()==="")return a.insertNode(document.createTextNode(e.options.tab)),a.collapse(!1),Ne(e),t.preventDefault(),!0;if(t.key==="Backspace"&&!(0,u._0)(t)&&!t.shiftKey&&!t.altKey){var o=(0,H.ED)(i,e[e.currentMode].element,a);if((o.start===0||o.start===1&&i.innerText===`
`)&&a.toString()==="")return i.parentElement.outerHTML='<p data-block="0"><wbr>'.concat(i.firstElementChild.innerHTML,"</p>"),(0,H.ir)(e[e.currentMode].element,a),Ne(e),t.preventDefault(),!0}return!(0,u._0)(t)&&!t.altKey&&t.key==="Enter"?(i.firstElementChild.textContent.endsWith(`
`)||i.firstElementChild.insertAdjacentText("beforeend",`
`),a.extractContents(),a.insertNode(document.createTextNode(`
`)),a.collapse(!1),(0,H.jl)(a),(0,u.gm)()||(e.currentMode==="wysiwyg"?ei(e,a):J(e,a)),nt(e),t.preventDefault(),!0):!1},qr=function(e,t,i,a){var o=t.startContainer,l=(0,y._Y)(o,"BLOCKQUOTE");if(l&&t.toString()===""){if(i.key==="Backspace"&&!(0,u._0)(i)&&!i.shiftKey&&!i.altKey&&(0,H.ED)(l,e[e.currentMode].element,t).start===0)return t.insertNode(document.createElement("wbr")),l.outerHTML=l.innerHTML,(0,H.ir)(e[e.currentMode].element,t),Ne(e),i.preventDefault(),!0;if(a&&i.key==="Enter"&&!(0,u._0)(i)&&!i.shiftKey&&!i.altKey&&a.parentElement.tagName==="BLOCKQUOTE"){var E=!1;if(a.innerHTML.replace(f.Y.ZWSP,"")===`
`||a.innerHTML.replace(f.Y.ZWSP,"")===""?(E=!0,a.remove()):a.innerHTML.endsWith(`

`)&&(0,H.ED)(a,e[e.currentMode].element,t).start===a.textContent.length-1&&(a.innerHTML=a.innerHTML.substr(0,a.innerHTML.length-2),E=!0),E)return l.insertAdjacentHTML("afterend",'<p data-block="0">'.concat(f.Y.ZWSP,`<wbr>
</p>`)),(0,H.ir)(e[e.currentMode].element,t),Ne(e),i.preventDefault(),!0}var L=(0,y.pt)(o);if(e.currentMode==="wysiwyg"&&L&&z("⇧⌘;",i))return t.insertNode(document.createElement("wbr")),L.outerHTML='<blockquote data-block="0">'.concat(L.outerHTML,"</blockquote>"),(0,H.ir)(e.wysiwyg.element,t),Ie(e),i.preventDefault(),!0;if(jn(e,i,t,l,l)||yn(e,i,t,l,l))return!0}return!1},Wr=function(e,t,i){var a=t.startContainer,o=(0,y._Y)(a,"li");if(o&&o.classList.contains("vditor-task")){if(z("⇧⌘J",i)){var l=o.firstElementChild;return l.checked?l.removeAttribute("checked"):l.setAttribute("checked","checked"),Ne(e),i.preventDefault(),!0}if(i.key==="Backspace"&&!(0,u._0)(i)&&!i.shiftKey&&!i.altKey&&t.toString()===""&&t.startOffset===1&&(a.nodeType===3&&a.previousSibling&&a.previousSibling.tagName==="INPUT"||a.nodeType!==3)){var E=o.previousElementSibling;if(o.querySelector("input").remove(),E){var L=(0,y.Rp)(E);L.parentElement.insertAdjacentHTML("beforeend","<wbr>"+o.innerHTML.trim()),o.remove()}else o.parentElement.insertAdjacentHTML("beforebegin",'<p data-block="0"><wbr>'.concat(o.innerHTML.trim()||`
`,"</p>")),o.nextElementSibling?o.remove():o.parentElement.remove();return(0,H.ir)(e[e.currentMode].element,t),Ne(e),i.preventDefault(),!0}if(i.key==="Enter"&&!(0,u._0)(i)&&!i.shiftKey&&!i.altKey){if(o.textContent.trim()==="")if((0,y.KJ)(o.parentElement,"vditor-task")){var D=(0,y.KR)(a);D&&$i(e,o,t,D)}else if(o.nextElementSibling){var A="",P="",U=!1;Array.from(o.parentElement.children).forEach(function(be){o.isSameNode(be)?U=!0:U?A+=be.outerHTML:P+=be.outerHTML});var re=o.parentElement.tagName,ie=o.parentElement.tagName==="OL"?"":' data-marker="'.concat(o.parentElement.getAttribute("data-marker"),'"'),te="";P&&(te=o.parentElement.tagName==="UL"?"":' start="1"',P="<".concat(re,' data-tight="true"').concat(ie,' data-block="0">').concat(P,"</").concat(re,">")),o.parentElement.outerHTML="".concat(P,`<p data-block="0"><wbr>
</p><`).concat(re,`
 data-tight="true"`).concat(ie,' data-block="0"').concat(te,">").concat(A,"</").concat(re,">")}else o.parentElement.insertAdjacentHTML("afterend",`<p data-block="0"><wbr>
</p>`),o.parentElement.querySelectorAll("li").length===1?o.parentElement.remove():o.remove();else a.nodeType!==3&&t.startOffset===0&&a.firstChild.tagName==="INPUT"?t.setStart(a.childNodes[1],1):(t.setEndAfter(o.lastChild),o.insertAdjacentHTML("afterend",'<li class="vditor-task" data-marker="'.concat(o.getAttribute("data-marker"),'"><input type="checkbox"> <wbr></li>')),document.querySelector("wbr").after(t.extractContents()));return(0,H.ir)(e[e.currentMode].element,t),Ne(e),nt(e),i.preventDefault(),!0}}return!1},Yr=function(e,t,i,a){if(t.startContainer.nodeType!==3){var o=t.startContainer.children[t.startOffset];if(o&&o.tagName==="HR")return t.selectNodeContents(o.previousElementSibling),t.collapse(!1),i.preventDefault(),!0}if(a){var l=a.previousElementSibling;if(l&&(0,H.ED)(a,e[e.currentMode].element,t).start===0&&((0,u.gm)()&&l.tagName==="HR"||l.tagName==="TABLE")){if(l.tagName==="TABLE"){var E=l.lastElementChild.lastElementChild.lastElementChild;E.innerHTML=E.innerHTML.trimLeft()+"<wbr>"+a.textContent.trim(),a.remove()}else l.remove();return(0,H.ir)(e[e.currentMode].element,t),Ne(e),i.preventDefault(),!0}}return!1},Kr=function(e){(0,u.gm)()&&e.startContainer.nodeType!==3&&e.startContainer.tagName==="HR"&&e.setStartBefore(e.startContainer)},Gr=function(e,t,i){var a,o;if(!(0,u.gm)())return!1;if(e.key==="ArrowUp"&&t&&((a=t.previousElementSibling)===null||a===void 0?void 0:a.tagName)==="TABLE"){var l=t.previousElementSibling;return i.selectNodeContents(l.rows[l.rows.length-1].lastElementChild),i.collapse(!1),e.preventDefault(),!0}return e.key==="ArrowDown"&&t&&((o=t.nextElementSibling)===null||o===void 0?void 0:o.tagName)==="TABLE"?(i.selectNodeContents(t.nextElementSibling.rows[0].cells[0]),i.collapse(!0),e.preventDefault(),!0):!1},ri=function(e,t,i){return Oo(void 0,void 0,void 0,function(){var a,o,l,E,L,D,A,P,U,re,ie,te,be,ee,he,ee,xe;return Po(this,function(ve){switch(ve.label){case 0:return e[e.currentMode].element.getAttribute("contenteditable")!=="true"?[2]:(t.stopPropagation(),t.preventDefault(),"clipboardData"in t?(a=t.clipboardData.getData("text/html"),o=t.clipboardData.getData("text/plain"),l=t.clipboardData.files):(a=t.dataTransfer.getData("text/html"),o=t.dataTransfer.getData("text/plain"),t.dataTransfer.types.includes("Files")&&(l=t.dataTransfer.items)),E={},L=function(_e,Ke){if(!Ke)return["",Lute.WalkContinue];if(e.options.upload.renderLinkDest)return e.options.upload.renderLinkDest(e,_e,Ke);var We=_e.TokensStr();if(_e.__internal_object__.Parent.Type===34&&We&&We.indexOf("file://")===-1&&e.options.upload.linkToImgUrl){var Ge=new XMLHttpRequest;Ge.open("POST",e.options.upload.linkToImgUrl),e.options.upload.token&&Ge.setRequestHeader("X-Upload-Token",e.options.upload.token),e.options.upload.withCredentials&&(Ge.withCredentials=!0),Dr(e,Ge),Ge.setRequestHeader("Content-Type","application/json; charset=utf-8"),Ge.onreadystatechange=function(){if(Ge.readyState===XMLHttpRequest.DONE){if(Ge.status===200){var mt=Ge.responseText;e.options.upload.linkToImgFormat&&(mt=e.options.upload.linkToImgFormat(Ge.responseText));var dt=JSON.parse(mt);if(dt.code!==0){e.tip.show(dt.msg);return}var gt=dt.data.originalURL;if(e.currentMode==="sv")e.sv.element.querySelectorAll(".vditor-sv__marker--link").forEach(function(it){it.textContent===gt&&(it.textContent=dt.data.url)});else{var Re=e[e.currentMode].element.querySelector('img[src="'.concat(gt,'"]'));Re.src=dt.data.url,e.currentMode==="ir"&&(Re.previousElementSibling.previousElementSibling.innerHTML=dt.data.url)}Ne(e)}else e.tip.show(Ge.responseText);e.options.upload.linkToImgCallback&&e.options.upload.linkToImgCallback(Ge.responseText)}},Ge.send(JSON.stringify({url:We}))}return e.currentMode==="ir"?['<span class="vditor-ir__marker vditor-ir__marker--link">'.concat(Lute.EscapeHTMLStr(We),"</span>"),Lute.WalkContinue]:e.currentMode==="wysiwyg"?["",Lute.WalkContinue]:['<span class="vditor-sv__marker--link">'.concat(Lute.EscapeHTMLStr(We),"</span>"),Lute.WalkContinue]},(a.replace(/&amp;/g,"&").replace(/<(|\/)(html|body|meta)[^>]*?>/ig,"").trim()==='<a href="'.concat(o,'">').concat(o,"</a>")||a.replace(/&amp;/g,"&").replace(/<(|\/)(html|body|meta)[^>]*?>/ig,"").trim()==='<!--StartFragment--><a href="'.concat(o,'">').concat(o,"</a><!--EndFragment-->"))&&(a=""),D=new DOMParser().parseFromString(a,"text/html"),D.body&&(a=D.body.innerHTML),a=Lute.Sanitize(a),e.wysiwyg.getComments(e),A=e[e.currentMode].element.scrollHeight,P=oe(a,o,e.currentMode),U=e.currentMode==="sv"?(0,y.Th)(t.target,"data-type","code-block"):(0,y._Y)(t.target,"CODE"),U?(e.currentMode==="sv"?document.execCommand("insertHTML",!1,o.replace(/&/g,"&amp;").replace(/</g,"&lt;")):(re=(0,H.ED)(t.target,e[e.currentMode].element),U.parentElement.tagName!=="PRE"&&(o+=f.Y.ZWSP),U.textContent=U.textContent.substring(0,re.start)+o+U.textContent.substring(re.end),(0,H.Fm)(re.start+o.length,re.start+o.length,U.parentElement),!((xe=U.parentElement)===null||xe===void 0)&&xe.nextElementSibling.classList.contains("vditor-".concat(e.currentMode,"__preview"))&&(U.parentElement.nextElementSibling.innerHTML=U.outerHTML,le(U.parentElement.nextElementSibling,e))),[3,8]):[3,1]);case 1:return P?(i.pasteCode(P),[3,8]):[3,2];case 2:return a.trim()===""?[3,3]:(ie=document.createElement("div"),ie.innerHTML=a,ie.querySelectorAll("[style]").forEach(function(_e){_e.removeAttribute("style")}),ie.querySelectorAll(".vditor-copy").forEach(function(_e){_e.remove()}),e.currentMode==="ir"?(E.HTML2VditorIRDOM={renderLinkDest:L},e.lute.SetJSRenderers({renderers:E}),(0,H.Z2)(e.lute.HTML2VditorIRDOM(ie.innerHTML),e)):e.currentMode==="wysiwyg"?(E.HTML2VditorDOM={renderLinkDest:L},e.lute.SetJSRenderers({renderers:E}),(0,H.Z2)(e.lute.HTML2VditorDOM(ie.innerHTML),e)):(E.Md2VditorSVDOM={renderLinkDest:L},e.lute.SetJSRenderers({renderers:E}),zi(e,e.lute.HTML2Md(ie.innerHTML).trimRight())),e.outline.render(e),[3,8]);case 3:return l.length>0?e.options.upload.url||e.options.upload.handler?[4,Fi(e,l)]:[3,5]:[3,7];case 4:return ve.sent(),[3,6];case 5:te=new FileReader,"clipboardData"in t?(l=t.clipboardData.files,be=l[0]):t.dataTransfer.types.includes("Files")&&(l=t.dataTransfer.items,be=l[0].getAsFile()),be&&be.type.startsWith("image")&&(te.readAsDataURL(be),te.onload=function(){var _e="";e.currentMode==="wysiwyg"?_e+='<img alt="'.concat(be.name,'" src="').concat(te.result.toString(),`">
`):_e+="![".concat(be.name,"](").concat(te.result.toString(),`)
`),document.execCommand("insertHTML",!1,_e)}),ve.label=6;case 6:return[3,8];case 7:o.trim()!==""&&l.length===0&&(ee=(0,H.RN)(e),ee.toString()!==""&&e.lute.IsValidLinkDest(o)&&(o="[".concat(ee.toString(),"](").concat(o,")")),e.currentMode==="ir"?(E.Md2VditorIRDOM={renderLinkDest:L},e.lute.SetJSRenderers({renderers:E}),(0,H.Z2)(e.lute.Md2VditorIRDOM(o),e)):e.currentMode==="wysiwyg"?(E.Md2VditorDOM={renderLinkDest:L},e.lute.SetJSRenderers({renderers:E}),(0,H.Z2)(e.lute.Md2VditorDOM(o),e)):(E.Md2VditorSVDOM={renderLinkDest:L},e.lute.SetJSRenderers({renderers:E}),zi(e,o)),e.outline.render(e)),ve.label=8;case 8:return e.currentMode!=="sv"&&(he=(0,y.pt)((0,H.RN)(e).startContainer),he&&(ee=(0,H.RN)(e),e[e.currentMode].element.querySelectorAll("wbr").forEach(function(_e){_e.remove()}),ee.insertNode(document.createElement("wbr")),e.currentMode==="wysiwyg"?he.outerHTML=e.lute.SpinVditorDOM(he.outerHTML):he.outerHTML=e.lute.SpinVditorIRDOM(he.outerHTML),(0,H.ir)(e[e.currentMode].element,ee)),e[e.currentMode].element.querySelectorAll(".vditor-".concat(e.currentMode,"__preview[data-render='2']")).forEach(function(_e){le(_e,e)})),e.wysiwyg.triggerRemoveComment(e),Ne(e),e[e.currentMode].element.scrollHeight-A>Math.min(e[e.currentMode].element.clientHeight,window.innerHeight)/2&&nt(e),[2]}})})},Zr,Xr=function(e){var t,i;e.hint.render(e);var a=(0,H.RN)(e).startContainer,o=(0,y.Th)(a,"data-type","code-block-info");if(o)if(o.textContent.replace(f.Y.ZWSP,"")===""&&e.hint.recentLanguage){o.textContent=f.Y.ZWSP+e.hint.recentLanguage;var l=(0,H.RN)(e);l.selectNodeContents(o)}else{var E=[],L=o.textContent.substring(0,(0,H.ED)(o,e.ir.element).start).replace(f.Y.ZWSP,"");(e.options.preview.hljs.langs||f.Y.ALIAS_CODE_LANGUAGES.concat(((i=(t=window.hljs)===null||t===void 0?void 0:t.listLanguages())!==null&&i!==void 0?i:[]).sort())).forEach(function(D){D.indexOf(L.toLowerCase())>-1&&E.push({html:D,value:D})}),e.hint.genHTML(E,L,e)}},Ut=function(e,t){t===void 0&&(t={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),t.enableHint&&Xr(e),clearTimeout(e.ir.processTimeoutId),e.ir.processTimeoutId=window.setTimeout(function(){if(!e.ir.composingLock){var i=T(e);typeof e.options.input=="function"&&t.enableInput&&e.options.input(i),e.options.counter.enable&&e.counter.render(e,i),e.options.cache.enable&&(0,u.D)()&&(localStorage.setItem(e.options.cache.id,i),e.options.cache.after&&e.options.cache.after(i)),e.devtools&&e.devtools.renderEchart(e),t.enableAddUndoStack&&e.undo.addToUndoStack(e)}},e.options.undoDelay)},Bn=function(e,t){var i=(0,H.RN)(e),a=(0,y.pt)(i.startContainer)||i.startContainer;if(a){var o=a.querySelector(".vditor-ir__marker--heading");o?o.innerHTML=t:(a.insertAdjacentText("afterbegin",t),i.selectNodeContents(a),i.collapse(!1)),J(e,i.cloneRange()),ut(e)}},ai=function(e,t,i){var a=(0,y.Th)(e.startContainer,"data-type",i);if(a){a.firstElementChild.remove(),a.lastElementChild.remove(),e.insertNode(document.createElement("wbr"));var o=document.createElement("div");o.innerHTML=t.lute.SpinVditorIRDOM(a.outerHTML),a.outerHTML=o.firstElementChild.innerHTML.trim()}},Ho=function(e,t,i,a){var o=(0,H.RN)(e),l=t.getAttribute("data-type"),E=o.startContainer;E.nodeType===3&&(E=E.parentElement);var L=!0;if(t.classList.contains("vditor-menu--current"))if(l==="quote"){var D=(0,y._Y)(E,"BLOCKQUOTE");D&&(o.insertNode(document.createElement("wbr")),D.outerHTML=D.innerHTML.trim()===""?'<p data-block="0">'.concat(D.innerHTML,"</p>"):D.innerHTML)}else if(l==="link"){var A=(0,y.Th)(o.startContainer,"data-type","a");if(A){var P=(0,y.KJ)(o.startContainer,"vditor-ir__link");P?(o.insertNode(document.createElement("wbr")),A.outerHTML=P.innerHTML):A.outerHTML=A.querySelector(".vditor-ir__link").innerHTML+"<wbr>"}}else l==="italic"?ai(o,e,"em"):l==="bold"?ai(o,e,"strong"):l==="strike"?ai(o,e,"s"):l==="inline-code"?ai(o,e,"code"):(l==="check"||l==="list"||l==="ordered-list")&&(ti(e,o,l),L=!1,t.classList.remove("vditor-menu--current"));else{e.ir.element.childNodes.length===0&&(e.ir.element.innerHTML='<p data-block="0"><wbr></p>',(0,H.ir)(e.ir.element,o));var U=(0,y.pt)(o.startContainer);if(l==="line"){if(U){var re=`<hr data-block="0"><p data-block="0"><wbr>
</p>`;U.innerHTML.trim()===""?U.outerHTML=re:U.insertAdjacentHTML("afterend",re)}}else if(l==="quote")U&&(o.insertNode(document.createElement("wbr")),U.outerHTML='<blockquote data-block="0">'.concat(U.outerHTML,"</blockquote>"),L=!1,t.classList.add("vditor-menu--current"));else if(l==="link"){var ie=void 0;o.toString()===""?ie="".concat(i,"<wbr>").concat(a):ie="".concat(i).concat(o.toString()).concat(a.replace(")","<wbr>)")),document.execCommand("insertHTML",!1,ie),L=!1,t.classList.add("vditor-menu--current")}else if(l==="italic"||l==="bold"||l==="strike"||l==="inline-code"||l==="code"||l==="table"){var ie=void 0;o.toString()===""?ie="".concat(i,"<wbr>").concat(a):(l==="code"?ie="".concat(i,`
`).concat(o.toString(),"<wbr>").concat(a):l==="table"?ie="".concat(i).concat(o.toString(),"<wbr>").concat(a):ie="".concat(i).concat(o.toString()).concat(a,"<wbr>"),o.deleteContents()),(l==="table"||l==="code")&&(ie=`
`+ie+`

`);var te=document.createElement("span");te.innerHTML=ie,o.insertNode(te),J(e,o),l==="table"&&(o.selectNodeContents(getSelection().getRangeAt(0).startContainer.parentElement),(0,H.jl)(o))}else(l==="check"||l==="list"||l==="ordered-list")&&(ti(e,o,l,!1),L=!1,p(e.toolbar.elements,["check","list","ordered-list"]),t.classList.add("vditor-menu--current"))}(0,H.ir)(e.ir.element,o),Ut(e),L&&ut(e)},No=function(e,t,i,a){function o(l){return l instanceof i?l:new i(function(E){E(l)})}return new(i||(i=Promise))(function(l,E){function L(P){try{A(a.next(P))}catch(U){E(U)}}function D(P){try{A(a.throw(P))}catch(U){E(U)}}function A(P){P.done?l(P.value):o(P.value).then(L,D)}A((a=a.apply(e,t||[])).next())})},jo=function(e,t){var i={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,o,l,E;return E={next:L(0),throw:L(1),return:L(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function L(A){return function(P){return D([A,P])}}function D(A){if(a)throw new TypeError("Generator is already executing.");for(;E&&(E=0,A[0]&&(i=0)),i;)try{if(a=1,o&&(l=A[0]&2?o.return:A[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,A[1])).done)return l;switch(o=0,l&&(A=[A[0]&2,l.value]),A[0]){case 0:case 1:l=A;break;case 4:return i.label++,{value:A[1],done:!1};case 5:i.label++,o=A[1],A=[0];continue;case 7:A=i.ops.pop(),i.trys.pop();continue;default:if(l=i.trys,!(l=l.length>0&&l[l.length-1])&&(A[0]===6||A[0]===2)){i=0;continue}if(A[0]===3&&(!l||A[1]>l[0]&&A[1]<l[3])){i.label=A[1];break}if(A[0]===6&&i.label<l[1]){i.label=l[1],l=A;break}if(l&&i.label<l[2]){i.label=l[2],i.ops.push(A);break}l[2]&&i.ops.pop(),i.trys.pop();continue}A=t.call(e,i)}catch(P){A=[6,P],o=0}finally{a=l=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}},Bo=function(){function e(t){var i=this;this.splitChar="",this.lastIndex=-1,this.fillEmoji=function(a,o){i.element.style.display="none";var l=decodeURIComponent(a.getAttribute("data-value")),E=window.getSelection().getRangeAt(0);if(o.currentMode==="ir"){var L=(0,y.Th)(E.startContainer,"data-type","code-block-info");if(L){L.textContent=f.Y.ZWSP+l.trimRight(),E.selectNodeContents(L),E.collapse(!1),Ut(o),L.parentElement.querySelectorAll("code").forEach(function(U){U.className="language-"+l.trimRight()}),le(L.parentElement.querySelector(".vditor-ir__preview"),o),i.recentLanguage=l.trimRight();return}}if(o.currentMode==="wysiwyg"&&E.startContainer.nodeType!==3){var D=E.startContainer,A=void 0;if(D.classList.contains("vditor-input")?A=D:A=D.firstElementChild,A&&A.classList.contains("vditor-input")){A.value=l.trimRight(),E.selectNodeContents(A),E.collapse(!1),A.dispatchEvent(new CustomEvent("input",{detail:1})),i.recentLanguage=l.trimRight();return}}if(E.setStart(E.startContainer,i.lastIndex),E.deleteContents(),o.options.hint.parse?o.currentMode==="sv"?(0,H.Z2)(o.lute.SpinVditorSVDOM(l),o):o.currentMode==="wysiwyg"?(0,H.Z2)(o.lute.SpinVditorDOM(l),o):(0,H.Z2)(o.lute.SpinVditorIRDOM(l),o):(0,H.Z2)(l,o),i.splitChar===":"&&l.indexOf(":")>-1&&o.currentMode!=="sv"&&E.insertNode(document.createTextNode(" ")),E.collapse(!1),(0,H.jl)(E),o.currentMode==="wysiwyg"){var P=(0,y.KJ)(E.startContainer,"vditor-wysiwyg__block");P&&P.lastElementChild.classList.contains("vditor-wysiwyg__preview")&&(P.lastElementChild.innerHTML=P.firstElementChild.innerHTML,le(P.lastElementChild,o))}else if(o.currentMode==="ir"){var P=(0,y.KJ)(E.startContainer,"vditor-ir__marker--pre");P&&P.nextElementSibling.classList.contains("vditor-ir__preview")&&(P.nextElementSibling.innerHTML=P.innerHTML,le(P.nextElementSibling,o))}Ne(o)},this.timeId=-1,this.element=document.createElement("div"),this.element.className="vditor-hint",this.recentLanguage="",t.push({key:":"})}return e.prototype.render=function(t){var i=this;if(window.getSelection().focusNode){var a,o=getSelection().getRangeAt(0);a=o.startContainer.textContent.substring(0,o.startOffset)||"";var l=this.getKey(a,t.options.hint.extend);if(typeof l>"u")this.element.style.display="none",clearTimeout(this.timeId);else if(this.splitChar===":"){var E=l===""?t.options.hint.emoji:t.lute.GetEmojis(),L=[];Object.keys(E).forEach(function(D){D.indexOf(l.toLowerCase())===0&&(E[D].indexOf(".")>-1?L.push({html:'<img src="'.concat(E[D],'" title=":').concat(D,':"/> :').concat(D,":"),value:":".concat(D,":")}):L.push({html:'<span class="vditor-hint__emoji">'.concat(E[D],"</span>").concat(D),value:E[D]}))}),this.genHTML(L,l,t)}else t.options.hint.extend.forEach(function(D){D.key===i.splitChar&&(clearTimeout(i.timeId),i.timeId=window.setTimeout(function(){return No(i,void 0,void 0,function(){var A;return jo(this,function(P){switch(P.label){case 0:return A=this.genHTML,[4,D.hint(l)];case 1:return A.apply(this,[P.sent(),l,t]),[2]}})})},t.options.hint.delay))})}},e.prototype.genHTML=function(t,i,a){var o=this;if(t.length===0){this.element.style.display="none";return}var l=a[a.currentMode].element,E=(0,H.Ey)(l),L=E.left+(a.options.outline.position==="left"?a.outline.element.offsetWidth:0),D=E.top,A="";t.forEach(function(U,re){if(!(re>7)){var ie=U.html;if(i!==""){var te=ie.lastIndexOf(">")+1,be=ie.substr(te),he=be.toLowerCase().indexOf(i.toLowerCase());he>-1&&(be=be.substring(0,he)+"<b>"+be.substring(he,he+i.length)+"</b>"+be.substring(he+i.length),ie=ie.substr(0,te)+be)}A+='<button type="button" data-value="'.concat(encodeURIComponent(U.value),` "
`).concat(re===0?"class='vditor-hint--current'":"","> ").concat(ie,"</button>")}}),this.element.innerHTML=A;var P=parseInt(document.defaultView.getComputedStyle(l,null).getPropertyValue("line-height"),10);this.element.style.top="".concat(D+(P||22),"px"),this.element.style.left="".concat(L,"px"),this.element.style.display="block",this.element.style.right="auto",this.element.querySelectorAll("button").forEach(function(U){U.addEventListener("click",function(re){o.fillEmoji(U,a),re.preventDefault()})}),this.element.getBoundingClientRect().bottom>window.innerHeight&&(this.element.style.top="".concat(D-this.element.offsetHeight,"px")),this.element.getBoundingClientRect().right>window.innerWidth&&(this.element.style.left="auto",this.element.style.right="0")},e.prototype.select=function(t,i){if(this.element.querySelectorAll("button").length===0||this.element.style.display==="none")return!1;var a=this.element.querySelector(".vditor-hint--current");if(t.key==="ArrowDown")return t.preventDefault(),t.stopPropagation(),a.removeAttribute("class"),a.nextElementSibling?a.nextElementSibling.className="vditor-hint--current":this.element.children[0].className="vditor-hint--current",!0;if(t.key==="ArrowUp"){if(t.preventDefault(),t.stopPropagation(),a.removeAttribute("class"),a.previousElementSibling)a.previousElementSibling.className="vditor-hint--current";else{var o=this.element.children.length;this.element.children[o-1].className="vditor-hint--current"}return!0}else if(!(0,u._0)(t)&&!t.shiftKey&&!t.altKey&&t.key==="Enter"&&!t.isComposing)return t.preventDefault(),t.stopPropagation(),this.fillEmoji(a,i),!0;return!1},e.prototype.getKey=function(t,i){var a=this;this.lastIndex=-1,this.splitChar="",i.forEach(function(A){var P=t.lastIndexOf(A.key);a.lastIndex<P&&(a.splitChar=A.key,a.lastIndex=P)});var o;if(this.lastIndex===-1)return o;var l=t.split(this.splitChar),E=l[l.length-1],L=32;if(l.length>1&&E.trim()===E)if(l.length===2&&l[0]===""&&l[1].length<L)o=l[1];else{var D=l[l.length-2].slice(-1);(0,w.p)(D)===" "&&E.length<L&&(o=E)}return o},e}(),zo=function(){function e(t){this.composingLock=!1;var i=document.createElement("div");i.className="vditor-ir",i.innerHTML='<pre class="vditor-reset" placeholder="'.concat(t.options.placeholder,`"
 contenteditable="true" spellcheck="false"></pre>`),this.element=i.firstElementChild,this.bindEvent(t),Pi(t,this.element),Mr(t,this.element),Ri(t,this.element),ji(t,this.element),Bi(t,this.element),Ii(t,this.element),Hi(t,this.element,this.copy),Ni(t,this.element,this.copy)}return e.prototype.copy=function(t,i){var a=getSelection().getRangeAt(0);if(a.toString()!==""){t.stopPropagation(),t.preventDefault();var o=document.createElement("div");o.appendChild(a.cloneContents()),t.clipboardData.setData("text/plain",i.lute.VditorIRDOM2Md(o.innerHTML).trim()),t.clipboardData.setData("text/html","")}},e.prototype.bindEvent=function(t){var i=this;this.element.addEventListener("paste",function(a){ri(t,a,{pasteCode:function(o){document.execCommand("insertHTML",!1,o)}})}),this.element.addEventListener("scroll",function(){_(t,["hint"])}),this.element.addEventListener("compositionstart",function(a){i.composingLock=!0}),this.element.addEventListener("compositionend",function(a){(0,u.gm)()||J(t,getSelection().getRangeAt(0).cloneRange()),i.composingLock=!1}),this.element.addEventListener("input",function(a){if(!(a.inputType==="deleteByDrag"||a.inputType==="insertFromDrop")){if(i.preventInput){i.preventInput=!1,Ut(t,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0});return}i.composingLock||a.data==="‘"||a.data==="“"||a.data==="《"||J(t,getSelection().getRangeAt(0).cloneRange(),!1,a)}}),this.element.addEventListener("click",function(a){if(a.target.tagName==="INPUT"){a.target.checked?a.target.setAttribute("checked","checked"):a.target.removeAttribute("checked"),i.preventInput=!0,Ut(t);return}var o=(0,H.RN)(t),l=(0,y.KJ)(a.target,"vditor-ir__preview");if(l||(l=(0,y.KJ)(o.startContainer,"vditor-ir__preview")),l&&(l.previousElementSibling.firstElementChild?o.selectNodeContents(l.previousElementSibling.firstElementChild):o.selectNodeContents(l.previousElementSibling),o.collapse(!0),(0,H.jl)(o),nt(t)),a.target.tagName==="IMG"){var E=a.target.parentElement.querySelector(".vditor-ir__marker--link");E&&(o.selectNode(E),(0,H.jl)(o))}var L=(0,y.Th)(a.target,"data-type","a");if(L&&!L.classList.contains("vditor-ir__node--expand")){t.options.link.click?t.options.link.click(L.querySelector(":scope > .vditor-ir__marker--link")):t.options.link.isOpen&&window.open(L.querySelector(":scope > .vditor-ir__marker--link").textContent);return}if(a.target.isEqualNode(i.element)&&i.element.lastElementChild&&o.collapsed){var D=i.element.lastElementChild.getBoundingClientRect();a.y>D.top+D.height&&(i.element.lastElementChild.tagName==="P"&&i.element.lastElementChild.textContent.trim().replace(f.Y.ZWSP,"")===""?(o.selectNodeContents(i.element.lastElementChild),o.collapse(!1)):(i.element.insertAdjacentHTML("beforeend",'<p data-block="0">'.concat(f.Y.ZWSP,"<wbr></p>")),(0,H.ir)(i.element,o)))}o.toString()===""?B(o,t):setTimeout(function(){B((0,H.RN)(t),t)}),Z(a,t),ut(t)}),this.element.addEventListener("keyup",function(a){if(!(a.isComposing||(0,u._0)(a))){if(a.key==="Enter"&&nt(t),ut(t),(a.key==="Backspace"||a.key==="Delete")&&t.ir.element.innerHTML!==""&&t.ir.element.childNodes.length===1&&t.ir.element.firstElementChild&&t.ir.element.firstElementChild.tagName==="P"&&t.ir.element.firstElementChild.childElementCount===0&&(t.ir.element.textContent===""||t.ir.element.textContent===`
`)){t.ir.element.innerHTML="";return}var o=(0,H.RN)(t);a.key==="Backspace"?((0,u.gm)()&&o.startContainer.textContent===`
`&&o.startOffset===1&&(o.startContainer.textContent="",B(o,t)),i.element.querySelectorAll(".language-math").forEach(function(E){var L=E.querySelector("br");L&&L.remove()})):a.key.indexOf("Arrow")>-1?((a.key==="ArrowLeft"||a.key==="ArrowRight")&&Xr(t),B(o,t)):a.keyCode===229&&a.code===""&&a.key==="Unidentified"&&B(o,t);var l=(0,y.KJ)(o.startContainer,"vditor-ir__preview");if(l){if(a.key==="ArrowUp"||a.key==="ArrowLeft")return l.previousElementSibling.firstElementChild?o.selectNodeContents(l.previousElementSibling.firstElementChild):o.selectNodeContents(l.previousElementSibling),o.collapse(!1),a.preventDefault(),!0;if(l.tagName==="SPAN"&&(a.key==="ArrowDown"||a.key==="ArrowRight"))return l.parentElement.getAttribute("data-type")==="html-entity"?(l.parentElement.insertAdjacentText("afterend",f.Y.ZWSP),o.setStart(l.parentElement.nextSibling,1)):o.selectNodeContents(l.parentElement.lastElementChild),o.collapse(!1),a.preventDefault(),!0}}})},e}(),Jr=function(e){if(e.currentMode==="sv")return e.lute.Md2HTML(T(e));if(e.currentMode==="wysiwyg")return e.lute.VditorDOM2HTML(e.wysiwyg.element.innerHTML);if(e.currentMode==="ir")return e.lute.VditorIRDOM2HTML(e.ir.element.innerHTML)},Fo=c(796),Qr=c(70),$o=function(){function e(t){this.element=document.createElement("div"),this.element.className="vditor-outline",this.element.innerHTML='<div class="vditor-outline__title">'.concat(t,`</div>
<div class="vditor-outline__content"></div>`)}return e.prototype.render=function(t){var i="";return t.preview.element.style.display==="block"?i=(0,Qr.N)(t.preview.previewElement,this.element.lastElementChild,t):i=(0,Qr.N)(t[t.currentMode].element,this.element.lastElementChild,t),i},e.prototype.toggle=function(t,i,a){var o;i===void 0&&(i=!0),a===void 0&&(a=!0);var l=(o=t.toolbar.elements.outline)===null||o===void 0?void 0:o.firstElementChild;if(i&&window.innerWidth>=f.Y.MOBILE_WIDTH?(this.element.style.display="block",this.render(t),l==null||l.classList.add("vditor-menu--current")):(this.element.style.display="none",l==null||l.classList.remove("vditor-menu--current")),a&&getSelection().rangeCount>0){var E=getSelection().getRangeAt(0);t[t.currentMode].element.contains(E.startContainer)&&(0,H.jl)(E)}Oe(t)},e}(),Uo=c(0),Vo=function(){function e(t){var i=this;this.element=document.createElement("div"),this.element.className="vditor-preview",this.previewElement=document.createElement("div"),this.previewElement.className="vditor-reset",t.options.classes.preview&&this.previewElement.classList.add(t.options.classes.preview),this.previewElement.style.maxWidth=t.options.preview.maxWidth+"px",this.previewElement.addEventListener("copy",function(D){if(D.target.tagName!=="TEXTAREA"){var A=document.createElement("div");A.className="vditor-reset",A.appendChild(getSelection().getRangeAt(0).cloneContents()),i.copyToX(t,A,"default"),D.preventDefault()}}),this.previewElement.addEventListener("click",function(D){var A=(0,y._Y)(D.target,"SPAN");if(A&&(0,y.KJ)(A,"vditor-toc")){var P=i.previewElement.querySelector("#"+A.getAttribute("data-target-id"));P&&(i.element.scrollTop=P.offsetTop);return}if(D.target.tagName==="A"){t.options.link.click?t.options.link.click(D.target):t.options.link.isOpen&&window.open(D.target.getAttribute("href")),D.preventDefault();return}D.target.tagName==="IMG"&&(t.options.image.preview?t.options.image.preview(D.target):t.options.image.isPreview&&(0,se.o)(D.target,t.options.lang,t.options.theme))}),this.element.appendChild(this.previewElement);var a=t.options.preview.actions;if(a.length!==0){var o=document.createElement("div");o.className="vditor-preview__action";for(var l=[],E=0;E<a.length;E++){var L=a[E];if(typeof L=="object"){l.push('<button type="button" data-type="'.concat(L.key,'" class="').concat(L.className,'"').concat(L.tooltip?' aria-label="'.concat(L.tooltip,'"'):"",'">').concat(L.text,"</button>"));continue}switch(L){case"desktop":l.push('<button type="button" class="vditor-preview__action--current" data-type="desktop">Desktop</button>');break;case"tablet":l.push('<button type="button" data-type="tablet">Tablet</button>');break;case"mobile":l.push('<button type="button" data-type="mobile">Mobile/Wechat</button>');break;case"mp-wechat":l.push('<button type="button" data-type="mp-wechat" class="vditor-tooltipped vditor-tooltipped__w" aria-label="复制到公众号"><svg><use xlink:href="#vditor-icon-mp-wechat"></use></svg></button>');break;case"zhihu":l.push('<button type="button" data-type="zhihu" class="vditor-tooltipped vditor-tooltipped__w" aria-label="复制到知乎"><svg><use xlink:href="#vditor-icon-zhihu"></use></svg></button>');break}}o.innerHTML=l.join(""),o.addEventListener((0,u.y3)(),function(D){var A=(0,O.f)(D.target,"BUTTON");if(A){var P=A.getAttribute("data-type"),U=a.find(function(re){return(re==null?void 0:re.key)===P});if(U){U.click(P);return}if(P==="mp-wechat"||P==="zhihu"){i.copyToX(t,i.previewElement.cloneNode(!0),P);return}P==="desktop"?i.previewElement.style.width="auto":P==="tablet"?i.previewElement.style.width="780px":i.previewElement.style.width="360px",i.previewElement.scrollWidth>i.previewElement.parentElement.clientWidth&&(i.previewElement.style.width="auto"),i.render(t),o.querySelectorAll("button").forEach(function(re){re.classList.remove("vditor-preview__action--current")}),A.classList.add("vditor-preview__action--current")}}),this.element.insertBefore(o,this.previewElement)}}return e.prototype.render=function(t,i){var a=this;if(clearTimeout(this.mdTimeoutId),this.element.style.display==="none"){this.element.getAttribute("data-type")==="renderPerformance"&&t.tip.hide();return}if(i){this.previewElement.innerHTML=i;return}if(T(t).replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")===""){this.previewElement.innerHTML="";return}var o=new Date().getTime(),l=T(t);this.mdTimeoutId=window.setTimeout(function(){if(t.options.preview.url){var E=new XMLHttpRequest;E.open("POST",t.options.preview.url),E.setRequestHeader("Content-Type","application/json;charset=UTF-8"),E.onreadystatechange=function(){if(E.readyState===XMLHttpRequest.DONE)if(E.status===200){var D=JSON.parse(E.responseText);if(D.code!==0){t.tip.show(D.msg);return}t.options.preview.transform&&(D.data=t.options.preview.transform(D.data)),a.previewElement.innerHTML=D.data,a.afterRender(t,o)}else{var A=t.lute.Md2HTML(l);t.options.preview.transform&&(A=t.options.preview.transform(A)),a.previewElement.innerHTML=A,a.afterRender(t,o)}},E.send(JSON.stringify({markdownText:l}))}else{var L=t.lute.Md2HTML(l);t.options.preview.transform&&(L=t.options.preview.transform(L)),a.previewElement.innerHTML=L,a.afterRender(t,o)}},t.options.preview.delay)},e.prototype.afterRender=function(t,i){t.options.preview.parse&&t.options.preview.parse(this.element);var a=new Date().getTime()-i;new Date().getTime()-i>2600?(t.tip.show(window.VditorI18n.performanceTip.replace("${x}",a.toString())),t.preview.element.setAttribute("data-type","renderPerformance")):t.preview.element.getAttribute("data-type")==="renderPerformance"&&(t.tip.hide(),t.preview.element.removeAttribute("data-type"));var o=t.preview.element.querySelector(".vditor-comment--focus");o&&o.classList.remove("vditor-comment--focus"),(0,I.o)(t.preview.previewElement,t.options.preview.hljs),(0,ne.$)(t.options.preview.hljs,t.preview.previewElement,t.options.cdn),(0,ke.e)(t.preview.previewElement,t.options.cdn,t.options.theme),(0,Se.K)(t.preview.previewElement,t.options.cdn),(0,Me.Y)(t.preview.previewElement,t.options.cdn,t.options.theme),(0,j.D)(t.preview.previewElement,t.options.cdn),(0,q.m)(t.preview.previewElement,t.options.cdn),(0,R.v)(t.preview.previewElement,t.options.cdn,t.options.theme),(0,Ee.l)(t.preview.previewElement,t.options.cdn,t.options.theme),(0,me.M)(t.preview.previewElement,t.options.cdn),(0,F.$)(t.preview.previewElement,t.options.cdn),t.options.preview.render.media.enable&&(0,Uo.l)(t.preview.previewElement),t.options.customRenders.forEach(function(L){L.render(t.preview.previewElement,t)});var l=t.preview.element,E=t.outline.render(t);E===""&&(E="[ToC]"),l.querySelectorAll('[data-type="toc-block"]').forEach(function(L){L.innerHTML=E,(0,ce.T)(L,{cdn:t.options.cdn,math:t.options.preview.math})}),(0,ce.T)(t.preview.previewElement,{cdn:t.options.cdn,math:t.options.preview.math})},e.prototype.copyToX=function(t,i,a){a===void 0&&(a="mp-wechat"),a!=="zhihu"?i.querySelectorAll(".katex-html .base").forEach(function(l){l.style.display="initial"}):i.querySelectorAll(".language-math").forEach(function(l){l.outerHTML='<img class="Formula-image" data-eeimg="true" src="//www.zhihu.com/equation?tex=" alt="'.concat(l.getAttribute("data-math"),'\\" style="display: block; margin: 0 auto; max-width: 100%;">')}),i.style.backgroundColor="#fff",i.querySelectorAll("code").forEach(function(l){l.style.backgroundImage="none"}),this.element.append(i);var o=i.ownerDocument.createRange();o.selectNode(i),(0,H.jl)(o),document.execCommand("copy"),i.remove(),t.tip.show(["zhihu","mp-wechat"].includes(a)?"已复制，可到".concat(a==="zhihu"?"知乎":"微信公众号平台","进行粘贴"):"已复制到剪切板")},e}(),qo=function(){function e(t){this.element=document.createElement("div"),this.element.className="vditor-resize vditor-resize--".concat(t.options.resize.position),this.element.innerHTML='<div><svg><use xlink:href="#vditor-icon-resize"></use></svg></div>',this.bindEvent(t)}return e.prototype.bindEvent=function(t){var i=this;this.element.addEventListener("mousedown",function(a){var o=document,l=a.clientY,E=t.element.offsetHeight,L=63+t.element.querySelector(".vditor-toolbar").clientHeight;o.ondragstart=function(){return!1},window.captureEvents&&window.captureEvents(),i.element.classList.add("vditor-resize--selected"),o.onmousemove=function(D){t.options.resize.position==="top"?t.element.style.height=Math.max(L,E+(l-D.clientY))+"px":t.element.style.height=Math.max(L,E+(D.clientY-l))+"px",t.options.typewriterMode&&(t.sv.element.style.paddingBottom=t.sv.element.parentElement.offsetHeight/2+"px")},o.onmouseup=function(){t.options.resize.after&&t.options.resize.after(t.element.offsetHeight-E),window.captureEvents&&window.captureEvents(),o.onmousemove=null,o.onmouseup=null,o.ondragstart=null,o.onselectstart=null,o.onselect=null,i.element.classList.remove("vditor-resize--selected")}})},e}(),Wo=function(){function e(t){this.composingLock=!1,this.element=document.createElement("pre"),this.element.className="vditor-sv vditor-reset",this.element.setAttribute("placeholder",t.options.placeholder),this.element.setAttribute("contenteditable","true"),this.element.setAttribute("spellcheck","false"),this.bindEvent(t),Pi(t,this.element),Ri(t,this.element),ji(t,this.element),Bi(t,this.element),Ii(t,this.element),Hi(t,this.element,this.copy),Ni(t,this.element,this.copy)}return e.prototype.copy=function(t,i){t.stopPropagation(),t.preventDefault(),t.clipboardData.setData("text/plain",Hn(i[i.currentMode].element))},e.prototype.bindEvent=function(t){var i=this;this.element.addEventListener("paste",function(a){ri(t,a,{pasteCode:function(o){document.execCommand("insertHTML",!1,o)}})}),this.element.addEventListener("scroll",function(){if(t.preview.element.style.display==="block"){var a=i.element.scrollTop,o=i.element.clientHeight,l=i.element.scrollHeight-parseFloat(i.element.style.paddingBottom||"0"),E=t.preview.element;a/o>.5?E.scrollTop=(a+o)*E.scrollHeight/l-o:E.scrollTop=a*E.scrollHeight/l}}),this.element.addEventListener("compositionstart",function(a){i.composingLock=!0}),this.element.addEventListener("compositionend",function(a){(0,u.gm)()||V(t,a),i.composingLock=!1}),this.element.addEventListener("input",function(a){if(!(a.inputType==="deleteByDrag"||a.inputType==="insertFromDrop")&&!(i.composingLock||a.data==="‘"||a.data==="“"||a.data==="《")){if(i.preventInput){i.preventInput=!1,at(t,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0});return}V(t,a)}}),this.element.addEventListener("keyup",function(a){if(!(a.isComposing||(0,u._0)(a))){if((a.key==="Backspace"||a.key==="Delete")&&t.sv.element.innerHTML!==""&&t.sv.element.childNodes.length===1&&t.sv.element.firstElementChild&&t.sv.element.firstElementChild.tagName==="DIV"&&t.sv.element.firstElementChild.childElementCount===2&&(t.sv.element.firstElementChild.textContent===""||t.sv.element.textContent===`
`)){t.sv.element.innerHTML="";return}a.key==="Enter"&&nt(t)}})},e}(),ea=function(){function e(){this.element=document.createElement("div"),this.element.className="vditor-tip"}return e.prototype.show=function(t,i){var a=this;i===void 0&&(i=6e3),this.element.className="vditor-tip vditor-tip--show",i===0?(this.element.innerHTML='<div class="vditor-tip__content">'.concat(t,`
<div class="vditor-tip__close">X</div></div>`),this.element.querySelector(".vditor-tip__close").addEventListener("click",function(){a.hide()})):(this.element.innerHTML='<div class="vditor-tip__content">'.concat(t,"</div>"),setTimeout(function(){a.hide()},i)),this.element.removeAttribute("style"),setTimeout(function(){var o=a.element.getBoundingClientRect();o.top<46&&(a.element.style.position="fixed",a.element.style.top="46px")},150)},e.prototype.hide=function(){this.element.className="vditor-messageElementtip",this.element.innerHTML=""},e}(),Wi=function(e,t){if(t.options.preview.mode!==e){switch(t.options.preview.mode=e,e){case"both":t.sv.element.style.display="block",t.preview.element.style.display="block",t.preview.render(t),g(t.toolbar.elements,["both"]);break;case"editor":t.sv.element.style.display="block",t.preview.element.style.display="none",p(t.toolbar.elements,["both"]);break}t.devtools&&t.devtools.renderEchart(t)}},Yo=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Ko=function(e){Yo(t,e);function t(i,a){var o=e.call(this,i,a)||this;return i.options.preview.mode==="both"&&o.element.children[0].classList.add("vditor-menu--current"),o.element.children[0].addEventListener((0,u.y3)(),function(l){var E=o.element.firstElementChild;E.classList.contains(f.Y.CLASS_MENU_DISABLED)||(l.preventDefault(),i.currentMode==="sv"&&(i.options.preview.mode==="both"?Wi("editor",i):Wi("both",i)))}),o}return t}(Je),Go=function(){function e(){this.element=document.createElement("div"),this.element.className="vditor-toolbar__br"}return e}(),ta=c(13),Zo=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Xo=function(e){Zo(t,e);function t(i,a){var o=e.call(this,i,a)||this,l=o.element.children[0],E=document.createElement("div");E.className="vditor-hint".concat(a.level===2?"":" vditor-panel--arrow");var L="";return f.Y.CODE_THEME.forEach(function(D){L+="<button>".concat(D,"</button>")}),E.innerHTML='<div style="overflow: auto;max-height:'.concat(window.innerHeight/2,'px">').concat(L,"</div>"),E.addEventListener((0,u.y3)(),function(D){D.target.tagName==="BUTTON"&&(_(i,["subToolbar"]),i.options.preview.hljs.style=D.target.textContent,(0,ta.h)(D.target.textContent,i.options.cdn),D.preventDefault(),D.stopPropagation())}),o.element.appendChild(E),x(i,E,l,a.level),o}return t}(Je),Jo=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Qo=function(e){Jo(t,e);function t(i,a){var o=e.call(this,i,a)||this,l=o.element.children[0],E=document.createElement("div");E.className="vditor-hint".concat(a.level===2?"":" vditor-panel--arrow");var L="";return Object.keys(i.options.preview.theme.list).forEach(function(D){L+='<button data-type="'.concat(D,'">').concat(i.options.preview.theme.list[D],"</button>")}),E.innerHTML='<div style="overflow: auto;max-height:'.concat(window.innerHeight/2,'px">').concat(L,"</div>"),E.addEventListener((0,u.y3)(),function(D){D.target.tagName==="BUTTON"&&(_(i,["subToolbar"]),i.options.preview.theme.current=D.target.getAttribute("data-type"),(0,W.H)(i.options.preview.theme.current,i.options.preview.theme.path),D.preventDefault(),D.stopPropagation())}),o.element.appendChild(E),x(i,E,l,a.level),o}return t}(Je),es=function(){function e(t){this.element=document.createElement("span"),this.element.className="vditor-counter vditor-tooltipped vditor-tooltipped__nw",this.render(t,"")}return e.prototype.render=function(t,i){var a=i.endsWith(`
`)?i.length-1:i.length;if(t.options.counter.type==="text"&&t[t.currentMode]){var o=t[t.currentMode].element.cloneNode(!0);o.querySelectorAll(".vditor-wysiwyg__preview").forEach(function(l){l.remove()}),a=o.textContent.length}typeof t.options.counter.max=="number"?(a>t.options.counter.max?this.element.className="vditor-counter vditor-counter--error":this.element.className="vditor-counter",this.element.innerHTML="".concat(a,"/").concat(t.options.counter.max)):this.element.innerHTML="".concat(a),this.element.setAttribute("aria-label",t.options.counter.type),t.options.counter.after&&t.options.counter.after(a,{enable:t.options.counter.enable,max:t.options.counter.max,type:t.options.counter.type})},e}(),ts=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),ns=function(e){ts(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o.element.children[0].innerHTML=a.icon,o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),!l.currentTarget.classList.contains(f.Y.CLASS_MENU_DISABLED)&&a.click(l,i)}),o}return t}(Je),is=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),rs=function(e){is(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o.element.firstElementChild.addEventListener((0,u.y3)(),function(l){var E=o.element.firstElementChild;E.classList.contains(f.Y.CLASS_MENU_DISABLED)||(l.preventDefault(),E.classList.contains("vditor-menu--current")?(E.classList.remove("vditor-menu--current"),i.devtools.element.style.display="none",Oe(i)):(E.classList.add("vditor-menu--current"),i.devtools.element.style.display="block",Oe(i),i.devtools.renderEchart(i)))}),o}return t}(Je),as=function(){function e(){this.element=document.createElement("div"),this.element.className="vditor-toolbar__divider"}return e}(),os=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),ss=function(e){os(t,e);function t(i,a){var o=e.call(this,i,a)||this,l=document.createElement("div");l.className="vditor-panel vditor-panel--arrow";var E="";return Object.keys(i.options.hint.emoji).forEach(function(L){var D=i.options.hint.emoji[L];D.indexOf(".")>-1?E+='<button data-value=":'.concat(L,': " data-key=":').concat(L,`:"><img
data-value=":`).concat(L,': " data-key=":').concat(L,':" class="vditor-emojis__icon" src="').concat(D,'"/></button>'):E+='<button data-value="'.concat(D,` "
 data-key="`).concat(L,'"><span class="vditor-emojis__icon">').concat(D,"</span></button>")}),l.innerHTML='<div class="vditor-emojis" style="max-height: '.concat(i.options.height==="auto"?"auto":i.options.height-80,'px">').concat(E,`</div><div class="vditor-emojis__tail">
    <span class="vditor-emojis__tip"></span><span>`).concat(i.options.hint.emojiTail||"",`</span>
</div>`),o.element.appendChild(l),x(i,l,o.element.firstElementChild,a.level),o.bindEvent(i),o}return t.prototype.bindEvent=function(i){var a=this;this.element.lastElementChild.addEventListener((0,u.y3)(),function(o){var l=(0,O.f)(o.target,"BUTTON");if(l){o.preventDefault();var E=l.getAttribute("data-value"),L=(0,H.RN)(i),D=E;if(i.currentMode==="wysiwyg"?D=i.lute.SpinVditorDOM(E):i.currentMode==="ir"&&(D=i.lute.SpinVditorIRDOM(E)),E.indexOf(":")>-1&&i.currentMode!=="sv"){var A=document.createElement("div");A.innerHTML=D,D=A.firstElementChild.firstElementChild.outerHTML+" ",(0,H.Z2)(D,i)}else L.extractContents(),L.insertNode(document.createTextNode(E)),(0,y.pt)(L.startContainer)||mn(i,L);L.collapse(!1),(0,H.jl)(L),a.element.lastElementChild.style.display="none",Ne(i)}}),this.element.lastElementChild.addEventListener("mouseover",function(o){var l=(0,O.f)(o.target,"BUTTON");l&&(a.element.querySelector(".vditor-emojis__tip").innerHTML=l.getAttribute("data-key"))})},t}(Je),na=function(e,t,i){var a=document.createElement("a");"download"in a?(a.download=i,a.style.display="none",a.href=URL.createObjectURL(new Blob([t])),document.body.appendChild(a),a.click(),a.remove()):e.tip.show(window.VditorI18n.downloadTip,0)},ls=function(e){var t=T(e);na(e,t,t.substr(0,10)+".md")},cs=function(e){e.tip.show(window.VditorI18n.generate,3800);var t=document.querySelector("#vditorExportIframe");t.contentDocument.open(),t.contentDocument.write('<link rel="stylesheet" href="'.concat(e.options.cdn,`/dist/index.css"/>
<script src="`).concat(e.options.cdn,`/dist/method.min.js"><\/script>
<div id="preview" style="width: 800px"></div>
<script>
window.addEventListener("message", (e) => {
  if(!e.data) {
    return;
  }
  Vditor.preview(document.getElementById('preview'), e.data, {
    cdn: "`).concat(e.options.cdn,`",
    markdown: {
      theme: `).concat(JSON.stringify(e.options.preview.theme),`
    },
    hljs: {
      style: "`).concat(e.options.preview.hljs.style,`"
    }
  });
  setTimeout(() => {
        window.print();
    }, 3600);
}, false);
<\/script>`)),t.contentDocument.close(),setTimeout(function(){t.contentWindow.postMessage(T(e),"*")},200)},us=function(e){var t=Jr(e),i='<html><head><link rel="stylesheet" type="text/css" href="'.concat(e.options.cdn,`/dist/index.css"/>
<script src="`).concat(e.options.cdn,"/dist/js/i18n/").concat(e.options.lang,`.js"><\/script>
<script src="`).concat(e.options.cdn,`/dist/method.min.js"><\/script></head>
<body><div class="vditor-reset" id="preview">`).concat(t,`</div>
<script>
    const previewElement = document.getElementById('preview')
    Vditor.setContentTheme('`).concat(e.options.preview.theme.current,"', '").concat(e.options.preview.theme.path,`');
    Vditor.codeRender(previewElement);
    Vditor.highlightRender(`).concat(JSON.stringify(e.options.preview.hljs),", previewElement, '").concat(e.options.cdn,`');
    Vditor.mathRender(previewElement, {
        cdn: '`).concat(e.options.cdn,`',
        math: `).concat(JSON.stringify(e.options.preview.math),`,
    });
    Vditor.mermaidRender(previewElement, '`).concat(e.options.cdn,"', '").concat(e.options.theme,`');
    Vditor.SMILESRender(previewElement, '`).concat(e.options.cdn,"', '").concat(e.options.theme,`');
    Vditor.markmapRender(previewElement, '`).concat(e.options.cdn,`');
    Vditor.flowchartRender(previewElement, '`).concat(e.options.cdn,`');
    Vditor.graphvizRender(previewElement, '`).concat(e.options.cdn,`');
    Vditor.chartRender(previewElement, '`).concat(e.options.cdn,"', '").concat(e.options.theme,`');
    Vditor.mindmapRender(previewElement, '`).concat(e.options.cdn,"', '").concat(e.options.theme,`');
    Vditor.abcRender(previewElement, '`).concat(e.options.cdn,`');
    `).concat(e.options.preview.render.media.enable?"Vditor.mediaRender(previewElement);":"",`
    Vditor.speechRender(previewElement);
<\/script>
<script src="`).concat(e.options.cdn,"/dist/js/icons/").concat(e.options.icon,'.js"><\/script></body></html>');na(e,i,t.substr(0,10)+".html")},ds=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),fs=function(e){ds(t,e);function t(i,a){var o=e.call(this,i,a)||this,l=o.element.children[0],E=document.createElement("div");return E.className="vditor-hint".concat(a.level===2?"":" vditor-panel--arrow"),E.innerHTML=`<button data-type="markdown">Markdown</button>
<button data-type="pdf">PDF</button>
<button data-type="html">HTML</button>`,E.addEventListener((0,u.y3)(),function(L){var D=L.target;if(D.tagName==="BUTTON"){switch(D.getAttribute("data-type")){case"markdown":ls(i);break;case"pdf":cs(i);break;case"html":us(i);break}_(i,["subToolbar"]),L.preventDefault(),L.stopPropagation()}}),o.element.appendChild(E),x(i,E,l,a.level),o}return t}(Je),hs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),ps=function(e){hs(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o._bindEvent(i,a),o}return t.prototype._bindEvent=function(i,a){this.element.children[0].addEventListener((0,u.y3)(),function(o){o.preventDefault(),i.element.className.includes("vditor--fullscreen")?(a.level||(this.innerHTML=a.icon),i.element.style.zIndex="",document.body.style.overflow="",i.element.classList.remove("vditor--fullscreen"),Object.keys(i.toolbar.elements).forEach(function(l){var E=i.toolbar.elements[l].firstChild;E&&(E.className=E.className.replace("__s","__n"),i.options.toolbar.forEach(function(L){typeof L!="string"&&L.tipPosition&&L.name===E.dataset.type&&(E.className="vditor-tooltipped vditor-tooltipped__".concat(L.tipPosition))}))}),i.counter&&(i.counter.element.className=i.counter.element.className.replace("__s","__n"))):(a.level||(this.innerHTML='<svg><use xlink:href="#vditor-icon-contract"></use></svg>'),i.element.style.zIndex=i.options.fullscreen.index.toString(),document.body.style.overflow="hidden",i.element.classList.add("vditor--fullscreen"),Object.keys(i.toolbar.elements).forEach(function(l){var E=i.toolbar.elements[l].firstChild;E&&(E.className=E.className.replace("__n","__s"))}),i.counter&&(i.counter.element.className=i.counter.element.className.replace("__n","__s"))),i.devtools&&i.devtools.renderEchart(i),a.click&&a.click(o,i),Oe(i),tt(i)})},t}(Je),ms=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),gs=function(e){ms(t,e);function t(i,a){var o=e.call(this,i,a)||this,l=document.createElement("div");return l.className="vditor-hint vditor-panel--arrow",l.innerHTML='<button data-tag="h1" data-value="# ">'.concat(window.VditorI18n.heading1," ").concat((0,u.fG)("&lt;⌥⌘1>"),`</button>
<button data-tag="h2" data-value="## ">`).concat(window.VditorI18n.heading2," &lt;").concat((0,u.fG)("⌥⌘2"),`></button>
<button data-tag="h3" data-value="### ">`).concat(window.VditorI18n.heading3," &lt;").concat((0,u.fG)("⌥⌘3"),`></button>
<button data-tag="h4" data-value="#### ">`).concat(window.VditorI18n.heading4," &lt;").concat((0,u.fG)("⌥⌘4"),`></button>
<button data-tag="h5" data-value="##### ">`).concat(window.VditorI18n.heading5," &lt;").concat((0,u.fG)("⌥⌘5"),`></button>
<button data-tag="h6" data-value="###### ">`).concat(window.VditorI18n.heading6," &lt;").concat((0,u.fG)("⌥⌘6"),"></button>"),o.element.appendChild(l),o._bindEvent(i,l),o}return t.prototype._bindEvent=function(i,a){var o=this.element.children[0];o.addEventListener((0,u.y3)(),function(E){E.preventDefault(),clearTimeout(i.wysiwyg.afterRenderTimeoutId),clearTimeout(i.ir.processTimeoutId),clearTimeout(i.sv.processTimeoutId),!o.classList.contains(f.Y.CLASS_MENU_DISABLED)&&(o.blur(),o.classList.contains("vditor-menu--current")?(i.currentMode==="wysiwyg"?(Jn(i),Ie(i)):i.currentMode==="ir"&&Bn(i,""),o.classList.remove("vditor-menu--current")):(_(i,["subToolbar"]),a.style.display="block"))});for(var l=0;l<6;l++)a.children.item(l).addEventListener((0,u.y3)(),function(E){E.preventDefault(),i.currentMode==="wysiwyg"?($t(i,E.target.getAttribute("data-tag")),Ie(i),o.classList.add("vditor-menu--current")):i.currentMode==="ir"?(Bn(i,E.target.getAttribute("data-value")),o.classList.add("vditor-menu--current")):Lr(i,E.target.getAttribute("data-value")),a.style.display="none"})},t}(Je),vs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),ys=function(e){vs(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),i.tip.show(`<div style="margin-bottom:14px;font-size: 14px;line-height: 22px;min-width:300px;max-width: 360px;display: flex;">
<div style="margin-top: 14px;flex: 1">
    <div>Markdown 使用指南</div>
    <ul style="list-style: none">
        <li><a href="https://ld246.com/article/1583308420519" target="_blank">语法速查手册</a></li>
        <li><a href="https://ld246.com/article/1583129520165" target="_blank">基础语法</a></li>
        <li><a href="https://ld246.com/article/1583305480675" target="_blank">扩展语法</a></li>
        <li><a href="https://ld246.com/article/1582778815353" target="_blank">键盘快捷键</a></li>
    </ul>
</div>
<div style="margin-top: 14px;flex: 1">
    <div>Vditor 支持</div>
    <ul style="list-style: none">
        <li><a href="https://github.com/Vanessa219/vditor/issues" target="_blank">Issues</a></li>
        <li><a href="https://ld246.com/tag/vditor" target="_blank">官方讨论区</a></li>
        <li><a href="https://ld246.com/article/1549638745630" target="_blank">开发手册</a></li>
        <li><a href="https://ld246.com/guide/markdown" target="_blank">演示地址</a></li>
    </ul>
</div></div>`,0)}),o}return t}(Je),bs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),ws=function(e){bs(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o.element.children[0].addEventListener((0,u.y3)(),function(l){if(l.preventDefault(),!(o.element.firstElementChild.classList.contains(f.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")){var E=(0,H.RN)(i),L=(0,y._Y)(E.startContainer,"LI");L&&Hr(i,L,E)}}),o}return t}(Je),Es=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Ss=function(e){Es(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),i.tip.show(`<div style="max-width: 520px; font-size: 14px;line-height: 22px;margin-bottom: 14px;">
<p style="text-align: center;margin: 14px 0">
    <em>下一代的 Markdown 编辑器，为未来而构建</em>
</p>
<div style="display: flex;margin-bottom: 14px;flex-wrap: wrap;align-items: center">
    <img src="https://unpkg.com/vditor/dist/images/logo.png" style="margin: 0 auto;height: 68px"/>
    <div>&nbsp;&nbsp;</div>
    <div style="flex: 1;min-width: 250px">
        Vditor 是一款浏览器端的 Markdown 编辑器，支持所见即所得、即时渲染（类似 Typora）和分屏预览模式。
        它使用 TypeScript 实现，支持原生 JavaScript 以及 Vue、React、Angular 和 Svelte 等框架。
    </div>
</div>
<div style="display: flex;flex-wrap: wrap;">
    <ul style="list-style: none;flex: 1;min-width:148px">
        <li>
        项目地址：<a href="https://b3log.org/vditor" target="_blank">b3log.org/vditor</a>
        </li>
        <li>
        开源协议：MIT
        </li>
    </ul>
    <ul style="list-style: none;margin-right: 18px">
        <li>
        组件版本：Vditor v`.concat(f.g," / Lute v").concat(Lute.Version,`
        </li>
        <li>
        赞助捐赠：<a href="https://ld246.com/sponsor" target="_blank">https://ld246.com/sponsor</a>
        </li>
    </ul>
</div>
</div>`),0)}),o}return t}(Je),Cs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Ts=function(e){Cs(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),!(o.element.firstElementChild.classList.contains(f.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")&&Nn(i,"afterend")}),o}return t}(Je),ks=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),xs=function(e){ks(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),!(o.element.firstElementChild.classList.contains(f.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")&&Nn(i,"beforebegin")}),o}return t}(Je),Ms=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),_s=function(e){Ms(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o.element.children[0].addEventListener((0,u.y3)(),function(l){if(l.preventDefault(),!(o.element.firstElementChild.classList.contains(f.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")){var E=(0,H.RN)(i),L=(0,y._Y)(E.startContainer,"LI");L&&$i(i,L,E,L.parentElement)}}),o}return t}(Je),Ls=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),As=function(e){Ls(t,e);function t(i,a){var o=e.call(this,i,a)||this;return i.options.outline&&o.element.firstElementChild.classList.add("vditor-menu--current"),o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault();var E=i.toolbar.elements.outline.firstElementChild;E.classList.contains(f.Y.CLASS_MENU_DISABLED)||(i.options.outline.enable=!o.element.firstElementChild.classList.contains("vditor-menu--current"),i.outline.toggle(i,i.options.outline.enable))}),o}return t}(Je),Ds=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Os=function(e){Ds(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o._bindEvent(i),o}return t.prototype._bindEvent=function(i){var a=this;this.element.children[0].addEventListener((0,u.y3)(),function(o){o.preventDefault();var l=a.element.firstElementChild;if(!l.classList.contains(f.Y.CLASS_MENU_DISABLED)){var E=f.Y.EDIT_TOOLBARS.concat(["both","edit-mode","devtools"]);l.classList.contains("vditor-menu--current")?(l.classList.remove("vditor-menu--current"),i.currentMode==="sv"?(i.sv.element.style.display="block",i.options.preview.mode==="both"?i.preview.element.style.display="block":i.preview.element.style.display="none"):(i[i.currentMode].element.parentElement.style.display="block",i.preview.element.style.display="none"),v(i.toolbar.elements,E),i.outline.render(i)):(b(i.toolbar.elements,E),i.preview.element.style.display="block",i.currentMode==="sv"?i.sv.element.style.display="none":i[i.currentMode].element.parentElement.style.display="none",i.preview.render(i),l.classList.add("vditor-menu--current"),_(i,["subToolbar","hint","popover"]),setTimeout(function(){i.outline.render(i)},i.options.preview.delay+10)),Oe(i)}})},t}(Je),Ps=function(){function e(t){this.SAMPLE_RATE=5e3,this.isRecording=!1,this.readyFlag=!1,this.leftChannel=[],this.rightChannel=[],this.recordingLength=0;var i;if(typeof AudioContext<"u")i=new AudioContext;else if(webkitAudioContext)i=new webkitAudioContext;else return;this.DEFAULT_SAMPLE_RATE=i.sampleRate;var a=i.createGain(),o=i.createMediaStreamSource(t);o.connect(a),this.recorder=i.createScriptProcessor(2048,2,1),this.recorder.onaudioprocess=null,a.connect(this.recorder),this.recorder.connect(i.destination),this.readyFlag=!0}return e.prototype.cloneChannelData=function(t,i){this.leftChannel.push(new Float32Array(t)),this.rightChannel.push(new Float32Array(i)),this.recordingLength+=2048},e.prototype.startRecordingNewWavFile=function(){this.readyFlag&&(this.isRecording=!0,this.leftChannel.length=this.rightChannel.length=0,this.recordingLength=0)},e.prototype.stopRecording=function(){this.isRecording=!1},e.prototype.buildWavFileBlob=function(){for(var t=this.mergeBuffers(this.leftChannel),i=this.mergeBuffers(this.rightChannel),a=new Float32Array(t.length),o=0;o<t.length;++o)a[o]=.5*(t[o]+i[o]);this.DEFAULT_SAMPLE_RATE>this.SAMPLE_RATE&&(a=this.downSampleBuffer(a,this.SAMPLE_RATE));var l=44+a.length*2,E=new ArrayBuffer(l),L=new DataView(E);this.writeUTFBytes(L,0,"RIFF"),L.setUint32(4,l,!0),this.writeUTFBytes(L,8,"WAVE"),this.writeUTFBytes(L,12,"fmt "),L.setUint32(16,16,!0),L.setUint16(20,1,!0),L.setUint16(22,1,!0),L.setUint32(24,this.SAMPLE_RATE,!0),L.setUint32(28,this.SAMPLE_RATE*2,!0),L.setUint16(32,2,!0),L.setUint16(34,16,!0);var D=a.length*2;this.writeUTFBytes(L,36,"data"),L.setUint32(40,D,!0);for(var A=a.length,P=44,U=1,re=0;re<A;re++)L.setInt16(P,a[re]*(32767*U),!0),P+=2;return new Blob([L],{type:"audio/wav"})},e.prototype.downSampleBuffer=function(t,i){if(i===this.DEFAULT_SAMPLE_RATE||i>this.DEFAULT_SAMPLE_RATE)return t;for(var a=this.DEFAULT_SAMPLE_RATE/i,o=Math.round(t.length/a),l=new Float32Array(o),E=0,L=0;E<l.length;){for(var D=Math.round((E+1)*a),A=0,P=0,U=L;U<D&&U<t.length;U++)A+=t[U],P++;l[E]=A/P,E++,L=D}return l},e.prototype.mergeBuffers=function(t){for(var i=new Float32Array(this.recordingLength),a=0,o=t.length,l=0;l<o;++l){var E=t[l];i.set(E,a),a+=E.length}return i},e.prototype.writeUTFBytes=function(t,i,a){for(var o=a.length,l=0;l<o;l++)t.setUint8(i+l,a.charCodeAt(l))},e}(),Rs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Is=function(e){Rs(t,e);function t(i,a){var o=e.call(this,i,a)||this;return o._bindEvent(i),o}return t.prototype._bindEvent=function(i){var a=this,o;this.element.children[0].addEventListener((0,u.y3)(),function(l){if(l.preventDefault(),!a.element.firstElementChild.classList.contains(f.Y.CLASS_MENU_DISABLED)){var E=i[i.currentMode].element;if(!o){navigator.mediaDevices.getUserMedia({audio:!0}).then(function(D){o=new Ps(D),o.recorder.onaudioprocess=function(A){if(o.isRecording){var P=A.inputBuffer.getChannelData(0),U=A.inputBuffer.getChannelData(1);o.cloneChannelData(P,U)}},o.startRecordingNewWavFile(),i.tip.show(window.VditorI18n.recording),E.setAttribute("contenteditable","false"),a.element.children[0].classList.add("vditor-menu--current")}).catch(function(){i.tip.show(window.VditorI18n["record-tip"])});return}if(o.isRecording){o.stopRecording(),i.tip.hide();var L=new File([o.buildWavFileBlob()],"record".concat(new Date().getTime(),".wav"),{type:"video/webm"});Fi(i,[L]),a.element.children[0].classList.remove("vditor-menu--current")}else i.tip.show(window.VditorI18n.recording),E.setAttribute("contenteditable","false"),o.startRecordingNewWavFile(),a.element.children[0].classList.add("vditor-menu--current")}})},t}(Je),Hs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Ns=function(e){Hs(t,e);function t(i,a){var o=e.call(this,i,a)||this;return b({redo:o.element},["redo"]),o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),!o.element.firstElementChild.classList.contains(f.Y.CLASS_MENU_DISABLED)&&i.undo.redo(i)}),o}return t}(Je),js=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Bs=function(e){js(t,e);function t(i,a){var o=e.call(this,i,a)||this;return b({undo:o.element},["undo"]),o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),!o.element.firstElementChild.classList.contains(f.Y.CLASS_MENU_DISABLED)&&i.undo.undo(i)}),o}return t}(Je),zs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Fs=function(e){zs(t,e);function t(i,a){var o=e.call(this,i,a)||this,l='<input type="file"';return i.options.upload.multiple&&(l+=' multiple="multiple"'),i.options.upload.accept&&(l+=' accept="'.concat(i.options.upload.accept,'"')),o.element.children[0].innerHTML="".concat(a.icon||'<svg><use xlink:href="#vditor-icon-upload"></use></svg>').concat(l,">"),o._bindEvent(i),o}return t.prototype._bindEvent=function(i){var a=this;this.element.children[0].addEventListener((0,u.y3)(),function(o){if(a.element.firstElementChild.classList.contains(f.Y.CLASS_MENU_DISABLED)){o.stopPropagation(),o.preventDefault();return}}),this.element.querySelector("input").addEventListener("change",function(o){if(a.element.firstElementChild.classList.contains(f.Y.CLASS_MENU_DISABLED)){o.stopPropagation(),o.preventDefault();return}o.target.files.length!==0&&Fi(i,o.target.files,o.target)})},t}(Je),$s=function(){function e(t){var i=this,a=t.options;this.elements={},this.element=document.createElement("div"),this.element.className="vditor-toolbar",a.toolbar.forEach(function(o,l){var E=i.genItem(t,o,l);if(i.element.appendChild(E),o.toolbar){var L=document.createElement("div");L.className="vditor-hint vditor-panel--arrow",L.addEventListener((0,u.y3)(),function(D){L.style.display="none"}),o.toolbar.forEach(function(D,A){D.level=2,L.appendChild(i.genItem(t,D,l+A))}),E.appendChild(L),x(t,L,E.children[0])}}),t.options.toolbarConfig.hide&&this.element.classList.add("vditor-toolbar--hide"),t.options.toolbarConfig.pin&&this.element.classList.add("vditor-toolbar--pin"),t.options.counter.enable&&(t.counter=new es(t),this.element.appendChild(t.counter.element))}return e.prototype.updateConfig=function(t,i){t.options.toolbarConfig=Object.assign({hide:!1,pin:!1},i),t.options.toolbarConfig.hide?this.element.classList.add("vditor-toolbar--hide"):this.element.classList.remove("vditor-toolbar--hide"),t.options.toolbarConfig.pin?this.element.classList.add("vditor-toolbar--pin"):this.element.classList.remove("vditor-toolbar--pin")},e.prototype.genItem=function(t,i,a){var o;switch(i.name){case"bold":case"italic":case"more":case"strike":case"line":case"quote":case"list":case"ordered-list":case"check":case"code":case"inline-code":case"link":case"table":o=new Je(t,i);break;case"emoji":o=new ss(t,i);break;case"headings":o=new gs(t,i);break;case"|":o=new as;break;case"br":o=new Go;break;case"undo":o=new Bs(t,i);break;case"redo":o=new Ns(t,i);break;case"help":o=new ys(t,i);break;case"both":o=new Ko(t,i);break;case"preview":o=new Os(t,i);break;case"fullscreen":o=new ps(t,i);break;case"upload":o=new Fs(t,i);break;case"record":o=new Is(t,i);break;case"info":o=new Ss(t,i);break;case"edit-mode":o=new Co(t,i);break;case"devtools":o=new rs(t,i);break;case"outdent":o=new _s(t,i);break;case"indent":o=new ws(t,i);break;case"outline":o=new As(t,i);break;case"insert-after":o=new Ts(t,i);break;case"insert-before":o=new xs(t,i);break;case"code-theme":o=new Xo(t,i);break;case"content-theme":o=new Qo(t,i);break;case"export":o=new fs(t,i);break;default:o=new ns(t,i);break}if(o){var l=i.name;return(l==="br"||l==="|")&&(l=l+a),this.elements[l]=o.element,o.element}},e}(),Us=c(192),Vs=function(){function e(){this.stackSize=50,this.resetStack(),this.dmp=new Us}return e.prototype.clearStack=function(t){this.resetStack(),this.resetIcon(t)},e.prototype.resetIcon=function(t){t.toolbar&&(this[t.currentMode].undoStack.length>1?v(t.toolbar.elements,["undo"]):b(t.toolbar.elements,["undo"]),this[t.currentMode].redoStack.length!==0?v(t.toolbar.elements,["redo"]):b(t.toolbar.elements,["redo"]))},e.prototype.undo=function(t){if(t[t.currentMode].element.getAttribute("contenteditable")!=="false"&&!(this[t.currentMode].undoStack.length<2)){var i=this[t.currentMode].undoStack.pop();i&&(this[t.currentMode].redoStack.push(i),this.renderDiff(i,t),this[t.currentMode].hasUndo=!0,_(t,["hint"]))}},e.prototype.redo=function(t){if(t[t.currentMode].element.getAttribute("contenteditable")!=="false"){var i=this[t.currentMode].redoStack.pop();i&&(this[t.currentMode].undoStack.push(i),this.renderDiff(i,t,!0))}},e.prototype.recordFirstPosition=function(t,i){if(getSelection().rangeCount!==0&&!(this[t.currentMode].undoStack.length!==1||this[t.currentMode].undoStack[0].length===0||this[t.currentMode].redoStack.length>0)&&!((0,u.gm)()&&i.key==="Backspace")&&!(0,u.nr)()){var a=this.addCaret(t);a.replace("<wbr>","").replace(" vditor-ir__node--expand","")===this[t.currentMode].undoStack[0][0].diffs[0][1].replace("<wbr>","")&&(this[t.currentMode].undoStack[0][0].diffs[0][1]=a,this[t.currentMode].lastText=a)}},e.prototype.addToUndoStack=function(t){var i=this.addCaret(t,!0),a=this.dmp.diff_main(i,this[t.currentMode].lastText,!0),o=this.dmp.patch_make(i,this[t.currentMode].lastText,a);o.length===0&&this[t.currentMode].undoStack.length>0||(this[t.currentMode].lastText=i,this[t.currentMode].undoStack.push(o),this[t.currentMode].undoStack.length>this.stackSize&&this[t.currentMode].undoStack.shift(),this[t.currentMode].hasUndo&&(this[t.currentMode].redoStack=[],this[t.currentMode].hasUndo=!1,b(t.toolbar.elements,["redo"])),this[t.currentMode].undoStack.length>1&&v(t.toolbar.elements,["undo"]))},e.prototype.renderDiff=function(t,i,a){a===void 0&&(a=!1);var o;if(a){var l=this.dmp.patch_deepCopy(t).reverse();l.forEach(function(L){L.diffs.forEach(function(D){D[0]=-D[0]})}),o=this.dmp.patch_apply(l,this[i.currentMode].lastText)[0]}else o=this.dmp.patch_apply(t,this[i.currentMode].lastText)[0];if(this[i.currentMode].lastText=o,i[i.currentMode].element.innerHTML=o,i.currentMode!=="sv"&&(i[i.currentMode].element.querySelectorAll(".vditor-".concat(i.currentMode,"__preview")).forEach(function(L){L.parentElement.querySelector(".language-echarts")&&(i.currentMode==="ir"?L.parentElement.outerHTML=i.lute.SpinVditorIRDOM(L.parentElement.outerHTML):L.parentElement.outerHTML=i.lute.SpinVditorDOM(L.parentElement.outerHTML))}),i[i.currentMode].element.querySelectorAll(".vditor-".concat(i.currentMode,"__preview[data-render='2']")).forEach(function(L){le(L,i)})),i[i.currentMode].element.querySelector("wbr"))(0,H.ir)(i[i.currentMode].element,i[i.currentMode].element.ownerDocument.createRange()),nt(i);else{var E=getSelection().getRangeAt(0);E.setEndBefore(i[i.currentMode].element),E.collapse(!1)}de(i),Ne(i,{enableAddUndoStack:!1,enableHint:!1,enableInput:!0}),vn(i),i[i.currentMode].element.querySelectorAll(".vditor-".concat(i.currentMode,"__preview[data-render='2']")).forEach(function(L){le(L,i)}),this[i.currentMode].undoStack.length>1?v(i.toolbar.elements,["undo"]):b(i.toolbar.elements,["undo"]),this[i.currentMode].redoStack.length!==0?v(i.toolbar.elements,["redo"]):b(i.toolbar.elements,["redo"])},e.prototype.resetStack=function(){this.ir={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]},this.sv={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]},this.wysiwyg={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]}},e.prototype.addCaret=function(t,i){i===void 0&&(i=!1);var a;if(getSelection().rangeCount!==0&&!t[t.currentMode].element.querySelector("wbr")){var o=getSelection().getRangeAt(0);if(t[t.currentMode].element.contains(o.startContainer)){a=o.cloneRange();var l=document.createElement("span");l.className="vditor-wbr",o.insertNode(l)}}var E=t[t.currentMode].element.cloneNode(!0);E.querySelectorAll(".vditor-".concat(t.currentMode,"__preview[data-render='1']")).forEach(function(D){D.firstElementChild&&(D.firstElementChild.classList.contains("language-echarts")||D.firstElementChild.classList.contains("language-plantuml")||D.firstElementChild.classList.contains("language-mindmap")?(D.firstElementChild.removeAttribute("_echarts_instance_"),D.firstElementChild.removeAttribute("data-processed"),D.firstElementChild.innerHTML=D.previousElementSibling.firstElementChild.innerHTML,D.setAttribute("data-render","2")):D.firstElementChild.classList.contains("language-math")&&(D.setAttribute("data-render","2"),D.firstElementChild.textContent=D.firstElementChild.getAttribute("data-math"),D.firstElementChild.removeAttribute("data-math")))});var L=E.innerHTML;return t[t.currentMode].element.querySelectorAll(".vditor-wbr").forEach(function(D){D.remove()}),i&&a&&(0,H.jl)(a),L.replace('<span class="vditor-wbr"></span>',"<wbr>")},e}(),qs=c(905),Ws=function(){function e(t){this.defaultOptions={rtl:!1,after:void 0,cache:{enable:!0},cdn:f.Y.CDN,classes:{preview:""},comment:{enable:!1},counter:{enable:!1,type:"markdown"},customRenders:[],debugger:!1,fullscreen:{index:90},height:"auto",hint:{delay:200,emoji:{"+1":"👍","-1":"👎",confused:"😕",eyes:"👀️",heart:"❤️",rocket:"🚀️",smile:"😄",tada:"🎉️"},emojiPath:"".concat(f.Y.CDN,"/dist/images/emoji"),extend:[],parse:!0},icon:"ant",lang:"zh_CN",mode:"ir",outline:{enable:!1,position:"left"},placeholder:"",preview:{actions:["desktop","tablet","mobile","mp-wechat","zhihu"],delay:1e3,hljs:f.Y.HLJS_OPTIONS,markdown:f.Y.MARKDOWN_OPTIONS,math:f.Y.MATH_OPTIONS,maxWidth:800,mode:"both",theme:f.Y.THEME_OPTIONS,render:{media:{enable:!0}}},link:{isOpen:!0},image:{isPreview:!0},resize:{enable:!1,position:"bottom"},theme:"classic",toolbar:["emoji","headings","bold","italic","strike","link","|","list","ordered-list","check","outdent","indent","|","quote","line","code","inline-code","insert-before","insert-after","|","upload","record","table","|","undo","redo","|","fullscreen","edit-mode",{name:"more",toolbar:["both","code-theme","content-theme","export","outline","preview","devtools","info","help"]}],toolbarConfig:{hide:!1,pin:!1},typewriterMode:!1,undoDelay:800,upload:{extraData:{},fieldName:"file[]",filename:function(i){return i.replace(/\W/g,"")},linkToImgUrl:"",max:10*1024*1024,multiple:!0,url:"",withCredentials:!1},value:"",width:"auto"},this.options=t}return e.prototype.merge=function(){var t,i,a,o,l,E,L,D,A;this.options&&(this.options.toolbar?this.options.toolbar=this.mergeToolbar(this.options.toolbar):this.options.toolbar=this.mergeToolbar(this.defaultOptions.toolbar),!((i=(t=this.options.preview)===null||t===void 0?void 0:t.theme)===null||i===void 0)&&i.list&&(this.defaultOptions.preview.theme.list=this.options.preview.theme.list),!((l=(o=(a=this.options.preview)===null||a===void 0?void 0:a.render)===null||o===void 0?void 0:o.media)===null||l===void 0)&&l.enable&&(this.defaultOptions.preview.render.media.enable=this.options.preview.render.media.enable),!((E=this.options.hint)===null||E===void 0)&&E.emoji&&(this.defaultOptions.hint.emoji=this.options.hint.emoji),this.options.comment&&(this.defaultOptions.comment=this.options.comment),this.options.cdn&&(!((D=(L=this.options.preview)===null||L===void 0?void 0:L.theme)===null||D===void 0)&&D.path||(this.defaultOptions.preview.theme.path="".concat(this.options.cdn,"/dist/css/content-theme")),!((A=this.options.hint)===null||A===void 0)&&A.emojiPath||(this.defaultOptions.hint.emojiPath="".concat(this.options.cdn,"/dist/images/emoji"))));var P=(0,qs.h)(this.defaultOptions,this.options);if(P.cache.enable&&!P.cache.id)throw new Error("need options.cache.id, see https://ld246.com/article/1549638745630#options");return P},e.prototype.mergeToolbar=function(t){var i=this,a=[{icon:'<svg><use xlink:href="#vditor-icon-export"></use></svg>',name:"export",tipPosition:"ne"},{hotkey:"⌘E",icon:'<svg><use xlink:href="#vditor-icon-emoji"></use></svg>',name:"emoji",tipPosition:"ne"},{hotkey:"⌘H",icon:'<svg><use xlink:href="#vditor-icon-headings"></use></svg>',name:"headings",tipPosition:"ne"},{hotkey:"⌘B",icon:'<svg><use xlink:href="#vditor-icon-bold"></use></svg>',name:"bold",prefix:"**",suffix:"**",tipPosition:"ne"},{hotkey:"⌘I",icon:'<svg><use xlink:href="#vditor-icon-italic"></use></svg>',name:"italic",prefix:"*",suffix:"*",tipPosition:"ne"},{hotkey:"⌘D",icon:'<svg><use xlink:href="#vditor-icon-strike"></use></svg>',name:"strike",prefix:"~~",suffix:"~~",tipPosition:"ne"},{hotkey:"⌘K",icon:'<svg><use xlink:href="#vditor-icon-link"></use></svg>',name:"link",prefix:"[",suffix:"](https://)",tipPosition:"n"},{name:"|"},{hotkey:"⌘L",icon:'<svg><use xlink:href="#vditor-icon-list"></use></svg>',name:"list",prefix:"* ",tipPosition:"n"},{hotkey:"⌘O",icon:'<svg><use xlink:href="#vditor-icon-ordered-list"></use></svg>',name:"ordered-list",prefix:"1. ",tipPosition:"n"},{hotkey:"⌘J",icon:'<svg><use xlink:href="#vditor-icon-check"></use></svg>',name:"check",prefix:"* [ ] ",tipPosition:"n"},{hotkey:"⇧⌘I",icon:'<svg><use xlink:href="#vditor-icon-outdent"></use></svg>',name:"outdent",tipPosition:"n"},{hotkey:"⇧⌘O",icon:'<svg><use xlink:href="#vditor-icon-indent"></use></svg>',name:"indent",tipPosition:"n"},{name:"|"},{hotkey:"⌘;",icon:'<svg><use xlink:href="#vditor-icon-quote"></use></svg>',name:"quote",prefix:"> ",tipPosition:"n"},{hotkey:"⇧⌘H",icon:'<svg><use xlink:href="#vditor-icon-line"></use></svg>',name:"line",prefix:"---",tipPosition:"n"},{hotkey:"⌘U",icon:'<svg><use xlink:href="#vditor-icon-code"></use></svg>',name:"code",prefix:"```",suffix:"\n```",tipPosition:"n"},{hotkey:"⌘G",icon:'<svg><use xlink:href="#vditor-icon-inline-code"></use></svg>',name:"inline-code",prefix:"`",suffix:"`",tipPosition:"n"},{hotkey:"⇧⌘B",icon:'<svg><use xlink:href="#vditor-icon-before"></use></svg>',name:"insert-before",tipPosition:"n"},{hotkey:"⇧⌘E",icon:'<svg><use xlink:href="#vditor-icon-after"></use></svg>',name:"insert-after",tipPosition:"n"},{name:"|"},{icon:'<svg><use xlink:href="#vditor-icon-upload"></use></svg>',name:"upload",tipPosition:"n"},{icon:'<svg><use xlink:href="#vditor-icon-record"></use></svg>',name:"record",tipPosition:"n"},{hotkey:"⌘M",icon:'<svg><use xlink:href="#vditor-icon-table"></use></svg>',name:"table",prefix:"| col1",suffix:` | col2 | col3 |
| --- | --- | --- |
|  |  |  |
|  |  |  |`,tipPosition:"n"},{name:"|"},{hotkey:"⌘Z",icon:'<svg><use xlink:href="#vditor-icon-undo"></use></svg>',name:"undo",tipPosition:"nw"},{hotkey:"⌘Y",icon:'<svg><use xlink:href="#vditor-icon-redo"></use></svg>',name:"redo",tipPosition:"nw"},{name:"|"},{icon:'<svg><use xlink:href="#vditor-icon-more"></use></svg>',name:"more",tipPosition:"e"},{hotkey:"⌘'",icon:'<svg><use xlink:href="#vditor-icon-fullscreen"></use></svg>',name:"fullscreen",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-edit"></use></svg>',name:"edit-mode",tipPosition:"nw"},{hotkey:"⌘P",icon:'<svg><use xlink:href="#vditor-icon-both"></use></svg>',name:"both",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-preview"></use></svg>',name:"preview",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-align-center"></use></svg>',name:"outline",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-theme"></use></svg>',name:"content-theme",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-code-theme"></use></svg>',name:"code-theme",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-bug"></use></svg>',name:"devtools",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-info"></use></svg>',name:"info",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-help"></use></svg>',name:"help",tipPosition:"nw"},{name:"br"}],o=[];return t.forEach(function(l){var E=l;a.forEach(function(L){typeof l=="string"&&L.name===l&&(E=L),typeof l=="object"&&L.name===l.name&&(E=Object.assign({},L,l))}),l.toolbar&&(E.toolbar=i.mergeToolbar(l.toolbar)),o.push(E)}),o},e}(),Ys=function(){function e(t){var i=this;this.composingLock=!1,this.commentIds=[];var a=document.createElement("div");a.className="vditor-wysiwyg",a.innerHTML='<pre class="vditor-reset" placeholder="'.concat(t.options.placeholder,`"
 contenteditable="true" spellcheck="false"></pre>
<div class="vditor-panel vditor-panel--none"></div>
<div class="vditor-panel vditor-panel--none">
    <button type="button" aria-label="`).concat(window.VditorI18n.comment,`" class="vditor-icon vditor-tooltipped vditor-tooltipped__n">
        <svg><use xlink:href="#vditor-icon-comment"></use></svg>
    </button>
</div>`),this.element=a.firstElementChild,this.popover=a.firstElementChild.nextElementSibling,this.selectPopover=a.lastElementChild,this.bindEvent(t),Pi(t,this.element),Mr(t,this.element),Ri(t,this.element),ji(t,this.element),Bi(t,this.element),Ii(t,this.element),Hi(t,this.element,this.copy),Ni(t,this.element,this.copy),t.options.comment.enable&&(this.selectPopover.querySelector("button").onclick=function(){var o=Lute.NewNodeID(),l=getSelection().getRangeAt(0),E=l.cloneRange(),L=l.extractContents(),D,A,P=!1,U=!1;L.childNodes.forEach(function(te,be){var he=!1;if(te.nodeType===3?he=!0:te.classList.contains("vditor-comment")?te.classList.contains("vditor-comment")&&te.setAttribute("data-cmtids",te.getAttribute("data-cmtids")+" "+o):he=!0,he)if(te.nodeType!==3&&te.getAttribute("data-block")==="0"&&be===0&&E.startOffset>0)te.innerHTML='<span class="vditor-comment" data-cmtids="'.concat(o,'">').concat(te.innerHTML,"</span>"),D=te;else if(te.nodeType!==3&&te.getAttribute("data-block")==="0"&&be===L.childNodes.length-1&&E.endOffset<E.endContainer.textContent.length)te.innerHTML='<span class="vditor-comment" data-cmtids="'.concat(o,'">').concat(te.innerHTML,"</span>"),A=te;else if(te.nodeType!==3&&te.getAttribute("data-block")==="0")be===0?P=!0:be===L.childNodes.length-1&&(U=!0),te.innerHTML='<span class="vditor-comment" data-cmtids="'.concat(o,'">').concat(te.innerHTML,"</span>");else{var ee=document.createElement("span");ee.classList.add("vditor-comment"),ee.setAttribute("data-cmtids",o),te.parentNode.insertBefore(ee,te),ee.appendChild(te)}});var re=(0,y.pt)(E.startContainer);re&&(D?(re.insertAdjacentHTML("beforeend",D.innerHTML),D.remove()):re.textContent.trim().replace(f.Y.ZWSP,"")===""&&P&&re.remove());var ie=(0,y.pt)(E.endContainer);ie&&(A?(ie.insertAdjacentHTML("afterbegin",A.innerHTML),A.remove()):ie.textContent.trim().replace(f.Y.ZWSP,"")===""&&U&&ie.remove()),l.insertNode(L),t.options.comment.add(o,l.toString(),i.getComments(t,!0)),Ie(t,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),i.hideComment()})}return e.prototype.getComments=function(t,i){var a=this;if(i===void 0&&(i=!1),t.currentMode==="wysiwyg"&&t.options.comment.enable){this.commentIds=[],this.element.querySelectorAll(".vditor-comment").forEach(function(l){a.commentIds=a.commentIds.concat(l.getAttribute("data-cmtids").split(" "))}),this.commentIds=Array.from(new Set(this.commentIds));var o=[];if(i)return this.commentIds.forEach(function(l){o.push({id:l,top:a.element.querySelector('.vditor-comment[data-cmtids="'.concat(l,'"]')).offsetTop})}),o}else return[]},e.prototype.triggerRemoveComment=function(t){var i=function(l,E){var L=new Set(E);return l.filter(function(D){return!L.has(D)})};if(t.currentMode==="wysiwyg"&&t.options.comment.enable&&t.wysiwyg.commentIds.length>0){var a=JSON.parse(JSON.stringify(this.commentIds));this.getComments(t);var o=i(a,this.commentIds);o.length>0&&t.options.comment.remove(o)}},e.prototype.showComment=function(){var t=(0,H.Ey)(this.element);this.selectPopover.setAttribute("style","left:".concat(t.left,"px;display:block;top:").concat(Math.max(-8,t.top-21),"px"))},e.prototype.hideComment=function(){this.selectPopover.setAttribute("style","display:none")},e.prototype.unbindListener=function(){window.removeEventListener("scroll",this.scrollListener)},e.prototype.copy=function(t,i){var a=getSelection().getRangeAt(0);if(a.toString()!==""){t.stopPropagation(),t.preventDefault();var o=(0,y._Y)(a.startContainer,"CODE"),l=(0,y._Y)(a.endContainer,"CODE");if(o&&l&&l.isSameNode(o)){var E="";o.parentElement.tagName==="PRE"?E=a.toString():E="`"+a.toString()+"`",t.clipboardData.setData("text/plain",E),t.clipboardData.setData("text/html","");return}var L=(0,y._Y)(a.startContainer,"A"),D=(0,y._Y)(a.endContainer,"A");if(L&&D&&D.isSameNode(L)){var A=L.getAttribute("title")||"";A&&(A=' "'.concat(A,'"')),t.clipboardData.setData("text/plain","[".concat(a.toString(),"](").concat(L.getAttribute("href")).concat(A,")")),t.clipboardData.setData("text/html","");return}var P=document.createElement("div");P.appendChild(a.cloneContents()),t.clipboardData.setData("text/plain",i.lute.VditorDOM2Md(P.innerHTML).trim()),t.clipboardData.setData("text/html","")}},e.prototype.bindEvent=function(t){var i=this;this.unbindListener(),window.addEventListener("scroll",this.scrollListener=function(){if(_(t,["hint"]),!(i.popover.style.display!=="block"||i.selectPopover.style.display!=="block")){var a=parseInt(i.popover.getAttribute("data-top"),10);if(t.options.height!=="auto"){if(t.options.toolbarConfig.pin&&t.toolbar.element.getBoundingClientRect().top===0){var o=Math.max(window.scrollY-t.element.offsetTop-8,Math.min(a-t.wysiwyg.element.scrollTop,i.element.clientHeight-21))+"px";i.popover.style.display==="block"&&(i.popover.style.top=o),i.selectPopover.style.display==="block"&&(i.selectPopover.style.top=o)}return}else if(!t.options.toolbarConfig.pin)return;var l=Math.max(a,window.scrollY-t.element.offsetTop-8)+"px";i.popover.style.display==="block"&&(i.popover.style.top=l),i.selectPopover.style.display==="block"&&(i.selectPopover.style.top=l)}}),this.element.addEventListener("scroll",function(){if(_(t,["hint"]),t.options.comment&&t.options.comment.enable&&t.options.comment.scroll&&t.options.comment.scroll(t.wysiwyg.element.scrollTop),i.popover.style.display==="block"){var a=parseInt(i.popover.getAttribute("data-top"),10)-t.wysiwyg.element.scrollTop,o=-8;t.options.toolbarConfig.pin&&t.toolbar.element.getBoundingClientRect().top===0&&(o=window.scrollY-t.element.offsetTop+o);var l=Math.max(o,Math.min(a,i.element.clientHeight-21))+"px";i.popover.style.top=l,i.selectPopover.style.top=l}}),this.element.addEventListener("paste",function(a){ri(t,a,{pasteCode:function(o){var l=(0,H.RN)(t),E=document.createElement("template");E.innerHTML=o,l.insertNode(E.content.cloneNode(!0));var L=(0,y.Th)(l.startContainer,"data-block","0");L?L.outerHTML=t.lute.SpinVditorDOM(L.outerHTML):t.wysiwyg.element.innerHTML=t.lute.SpinVditorDOM(t.wysiwyg.element.innerHTML),(0,H.ir)(t.wysiwyg.element,l)}})}),this.element.addEventListener("compositionstart",function(){i.composingLock=!0}),this.element.addEventListener("compositionend",function(a){var o=(0,O.c)(getSelection().getRangeAt(0).startContainer);if(o&&o.textContent===""){de(t);return}(0,u.gm)()||ei(t,getSelection().getRangeAt(0).cloneRange(),a),i.composingLock=!1}),this.element.addEventListener("input",function(a){if(!(a.inputType==="deleteByDrag"||a.inputType==="insertFromDrop")){if(i.preventInput){i.preventInput=!1,Ie(t);return}if(i.composingLock||a.data==="‘"||a.data==="“"||a.data==="《"){Ie(t);return}var o=getSelection().getRangeAt(0),l=(0,y.pt)(o.startContainer);if(l||(mn(t,o),l=(0,y.pt)(o.startContainer)),!!l){for(var E=(0,H.ED)(l,t.wysiwyg.element,o).start,L=!0,D=E-1;D>l.textContent.substr(0,E).lastIndexOf(`
`);D--)if(l.textContent.charAt(D)!==" "&&l.textContent.charAt(D)!=="	"){L=!1;break}E===0&&(L=!1);for(var A=!0,D=E-1;D<l.textContent.length;D++)if(l.textContent.charAt(D)!==" "&&l.textContent.charAt(D)!==`
`){A=!1;break}A&&/^#{1,6} $/.test(l.textContent)&&(A=!1);var P=(0,O.c)(getSelection().getRangeAt(0).startContainer);if(P&&P.textContent===""&&(de(t),P.remove()),L&&l.getAttribute("data-type")!=="code-block"||A||Vi(l.innerHTML)||Ui(l.innerHTML)&&l.previousElementSibling){typeof t.options.input=="function"&&t.options.input(T(t));return}a.inputType==="insertParagraph"&&i.element.innerHTML==="<p><br></p><p><br></p>"&&l.previousElementSibling.remove(),ei(t,o,a)}}}),this.element.addEventListener("click",function(a){if(a.target.tagName==="INPUT"){var o=a.target;o.checked?o.setAttribute("checked","checked"):o.removeAttribute("checked"),i.preventInput=!0,getSelection().rangeCount>0&&(0,H.jl)(getSelection().getRangeAt(0)),Ie(t);return}if(a.target.tagName==="IMG"&&!a.target.parentElement.classList.contains("vditor-wysiwyg__preview")){a.target.getAttribute("data-type")==="link-ref"?Ye(t,a.target):bo(a,t);return}var l=(0,y._Y)(a.target,"A");if(l){t.options.link.click?t.options.link.click(l):t.options.link.isOpen&&window.open(l.getAttribute("href")),a.preventDefault();return}var E=(0,H.RN)(t);if(a.target.isEqualNode(i.element)&&i.element.lastElementChild&&E.collapsed){var L=i.element.lastElementChild.getBoundingClientRect();a.y>L.top+L.height&&(i.element.lastElementChild.tagName==="P"&&i.element.lastElementChild.textContent.trim().replace(f.Y.ZWSP,"")===""?(E.selectNodeContents(i.element.lastElementChild),E.collapse(!1)):(i.element.insertAdjacentHTML("beforeend",'<p data-block="0">'.concat(f.Y.ZWSP,"<wbr></p>")),(0,H.ir)(i.element,E)))}Lt(t);var D=(0,y.KJ)(a.target,"vditor-wysiwyg__preview");D||(D=(0,y.KJ)((0,H.RN)(t).startContainer,"vditor-wysiwyg__preview")),D&&gn(D,t),Z(a,t)}),this.element.addEventListener("keyup",function(a){if(!(a.isComposing||(0,u._0)(a))){a.key==="Enter"&&nt(t),(a.key==="Backspace"||a.key==="Delete")&&t.wysiwyg.element.innerHTML!==""&&t.wysiwyg.element.childNodes.length===1&&t.wysiwyg.element.firstElementChild&&t.wysiwyg.element.firstElementChild.tagName==="P"&&t.wysiwyg.element.firstElementChild.childElementCount===0&&(t.wysiwyg.element.textContent===""||t.wysiwyg.element.textContent===`
`)&&(t.wysiwyg.element.innerHTML="");var o=(0,H.RN)(t);if(a.key==="Backspace"&&(0,u.gm)()&&o.startContainer.textContent===`
`&&o.startOffset===1&&(o.startContainer.textContent=""),mn(t,o),Lt(t),!(a.key!=="ArrowDown"&&a.key!=="ArrowRight"&&a.key!=="Backspace"&&a.key!=="ArrowLeft"&&a.key!=="ArrowUp")){(a.key==="ArrowLeft"||a.key==="ArrowRight")&&t.hint.render(t);var l=(0,y.KJ)(o.startContainer,"vditor-wysiwyg__preview");if(!l&&o.startContainer.nodeType!==3&&o.startOffset>0){var E=o.startContainer;E.classList.contains("vditor-wysiwyg__block")&&(l=E.lastElementChild)}if(l){var L=l.previousElementSibling;if(L.style.display==="none"){a.key==="ArrowDown"||a.key==="ArrowRight"?gn(l,t):gn(l,t,!1);return}var D=l.previousElementSibling;if(D.tagName==="PRE"&&(D=D.firstElementChild),a.key==="ArrowDown"||a.key==="ArrowRight"){var E=l.parentElement,A=kr(E);if(A&&A.nodeType!==3){var P=A.querySelector(".vditor-wysiwyg__preview");if(P){gn(P,t);return}}if(A.nodeType===3){for(;A.textContent.length===0&&A.nextSibling;)A=A.nextSibling;o.setStart(A,1)}else o.setStart(A.firstChild,0)}else o.selectNodeContents(D),o.collapse(!1)}}}})},e}(),Ks=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function a(){this.constructor=t}t.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Gs=function(e){Ks(t,e);function t(i,a){var o=e.call(this)||this;if(o.version=f.g,typeof i=="string"){if(a?a.cache?a.cache.id||(a.cache.id="vditor".concat(i)):a.cache={id:"vditor".concat(i)}:a={cache:{id:"vditor".concat(i)}},!document.getElementById(i))return o.showErrorTip("Failed to get element by id: ".concat(i)),o;i=document.getElementById(i)}var l=new Ws(a),E=l.merge();if(E.i18n)window.VditorI18n=E.i18n,o.init(i,E);else if(["en_US","fr_FR","pt_BR","ja_JP","ko_KR","ru_RU","sv_SE","zh_CN","zh_TW"].includes(E.lang)){var L="vditorI18nScript",D=L+E.lang;document.querySelectorAll('head script[id^="'.concat(L,'"]')).forEach(function(A){A.id!==D&&document.head.removeChild(A)}),(0,S.Z)("".concat(E.cdn,"/dist/js/i18n/").concat(E.lang,".js"),D).then(function(){o.init(i,E)}).catch(function(A){o.showErrorTip("GET ".concat(E.cdn,"/dist/js/i18n/").concat(E.lang,".js net::ERR_ABORTED 404 (Not Found)"))})}else throw new Error("options.lang error, see https://ld246.com/article/1549638745630#options");return o}return t.prototype.showErrorTip=function(i){var a=new ea;document.body.appendChild(a.element),a.show(i,0)},t.prototype.updateToolbarConfig=function(i){this.vditor.toolbar.updateConfig(this.vditor,i)},t.prototype.setTheme=function(i,a,o,l){this.vditor.options.theme=i,X(this.vditor),a&&(this.vditor.options.preview.theme.current=a,(0,W.H)(a,l||this.vditor.options.preview.theme.path)),o&&(this.vditor.options.preview.hljs.style=o,(0,ta.h)(o,this.vditor.options.cdn))},t.prototype.getValue=function(){return T(this.vditor)},t.prototype.getCurrentMode=function(){return this.vditor.currentMode},t.prototype.focus=function(){this.vditor.currentMode==="sv"?this.vditor.sv.element.focus():this.vditor.currentMode==="wysiwyg"?this.vditor.wysiwyg.element.focus():this.vditor.currentMode==="ir"&&this.vditor.ir.element.focus()},t.prototype.blur=function(){this.vditor.currentMode==="sv"?this.vditor.sv.element.blur():this.vditor.currentMode==="wysiwyg"?this.vditor.wysiwyg.element.blur():this.vditor.currentMode==="ir"&&this.vditor.ir.element.blur()},t.prototype.disabled=function(){_(this.vditor,["subToolbar","hint","popover"]),b(this.vditor.toolbar.elements,f.Y.EDIT_TOOLBARS.concat(["undo","redo","fullscreen","edit-mode"])),this.vditor[this.vditor.currentMode].element.setAttribute("contenteditable","false")},t.prototype.enable=function(){v(this.vditor.toolbar.elements,f.Y.EDIT_TOOLBARS.concat(["undo","redo","fullscreen","edit-mode"])),this.vditor.undo.resetIcon(this.vditor),this.vditor[this.vditor.currentMode].element.setAttribute("contenteditable","true")},t.prototype.getSelection=function(){if(this.vditor.currentMode==="wysiwyg")return Hn(this.vditor.wysiwyg.element);if(this.vditor.currentMode==="sv")return Hn(this.vditor.sv.element);if(this.vditor.currentMode==="ir")return Hn(this.vditor.ir.element)},t.prototype.renderPreview=function(i){this.vditor.preview.render(this.vditor,i)},t.prototype.getCursorPosition=function(){return(0,H.Ey)(this.vditor[this.vditor.currentMode].element)},t.prototype.isUploading=function(){return this.vditor.upload.isUploading},t.prototype.clearCache=function(){this.vditor.options.cache.enable&&(0,u.D)()&&localStorage.removeItem(this.vditor.options.cache.id)},t.prototype.disabledCache=function(){this.vditor.options.cache.enable=!1},t.prototype.enableCache=function(){if(!this.vditor.options.cache.id)throw new Error("need options.cache.id, see https://ld246.com/article/1549638745630#options");this.vditor.options.cache.enable=!0},t.prototype.html2md=function(i){return this.vditor.lute.HTML2Md(i)},t.prototype.exportJSON=function(i){return this.vditor.lute.RenderJSON(i)},t.prototype.getHTML=function(){return Jr(this.vditor)},t.prototype.tip=function(i,a){this.vditor.tip.show(i,a)},t.prototype.setPreviewMode=function(i){Wi(i,this.vditor)},t.prototype.deleteValue=function(){window.getSelection().isCollapsed||document.execCommand("delete",!1)},t.prototype.updateValue=function(i){document.execCommand("insertHTML",!1,i)},t.prototype.insertValue=function(i,a){a===void 0&&(a=!0);var o=(0,H.RN)(this.vditor);o.collapse(!0);var l=document.createElement("template");l.innerHTML=i,o.insertNode(l.content.cloneNode(!0)),o.collapse(!1),this.vditor.currentMode==="sv"?(this.vditor.sv.preventInput=!0,a&&V(this.vditor)):this.vditor.currentMode==="wysiwyg"?a&&ei(this.vditor,getSelection().getRangeAt(0)):this.vditor.currentMode==="ir"&&(this.vditor.ir.preventInput=!0,a&&J(this.vditor,getSelection().getRangeAt(0),!0))},t.prototype.insertMD=function(i){this.vditor.currentMode==="ir"?(0,H.Z2)(this.vditor.lute.Md2VditorIRDOM(i),this.vditor):this.vditor.currentMode==="wysiwyg"?(0,H.Z2)(this.vditor.lute.Md2VditorDOM(i),this.vditor):zi(this.vditor,i),this.vditor.outline.render(this.vditor),Ne(this.vditor)},t.prototype.setValue=function(i,a){var o=this;a===void 0&&(a=!1),this.vditor.currentMode==="sv"?(this.vditor.sv.element.innerHTML="<div data-block='0'>".concat(this.vditor.lute.SpinVditorSVDOM(i),"</div>"),at(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})):this.vditor.currentMode==="wysiwyg"?xr(this.vditor,i,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}):(this.vditor.ir.element.innerHTML=this.vditor.lute.Md2VditorIRDOM(i),this.vditor.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach(function(l){le(l,o.vditor)}),Ut(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})),this.vditor.outline.render(this.vditor),i||(_(this.vditor,["emoji","headings","submenu","hint"]),this.vditor.wysiwyg.popover&&(this.vditor.wysiwyg.popover.style.display="none"),this.clearCache()),a&&this.clearStack()},t.prototype.insertEmptyBlock=function(i){Nn(this.vditor,i)},t.prototype.clearStack=function(){this.vditor.undo.clearStack(this.vditor),this.vditor.undo.addToUndoStack(this.vditor)},t.prototype.destroy=function(){this.vditor.element.innerHTML=this.vditor.originalInnerHTML,this.vditor.element.classList.remove("vditor"),this.vditor.element.removeAttribute("style");var i=document.getElementById("vditorIconScript");i&&i.remove(),this.clearCache(),De(),this.vditor.wysiwyg.unbindListener()},t.prototype.getCommentIds=function(){return this.vditor.currentMode!=="wysiwyg"?[]:this.vditor.wysiwyg.getComments(this.vditor,!0)},t.prototype.hlCommentIds=function(i){if(this.vditor.currentMode==="wysiwyg"){var a=function(o){o.classList.remove("vditor-comment--hover"),i.forEach(function(l){o.getAttribute("data-cmtids").indexOf(l)>-1&&o.classList.add("vditor-comment--hover")})};this.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(o){a(o)}),this.vditor.preview.element.style.display!=="none"&&this.vditor.preview.element.querySelectorAll(".vditor-comment").forEach(function(o){a(o)})}},t.prototype.unHlCommentIds=function(i){if(this.vditor.currentMode==="wysiwyg"){var a=function(o){i.forEach(function(l){o.getAttribute("data-cmtids").indexOf(l)>-1&&o.classList.remove("vditor-comment--hover")})};this.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(o){a(o)}),this.vditor.preview.element.style.display!=="none"&&this.vditor.preview.element.querySelectorAll(".vditor-comment").forEach(function(o){a(o)})}},t.prototype.removeCommentIds=function(i){var a=this;if(this.vditor.currentMode==="wysiwyg"){var o=function(l,E){var L=l.getAttribute("data-cmtids").split(" ");L.find(function(D,A){if(D===E)return L.splice(A,1),!0}),L.length===0?(l.outerHTML=l.innerHTML,(0,H.RN)(a.vditor).collapse(!0)):l.setAttribute("data-cmtids",L.join(" "))};i.forEach(function(l){a.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(E){o(E,l)}),a.vditor.preview.element.style.display!=="none"&&a.vditor.preview.element.querySelectorAll(".vditor-comment").forEach(function(E){o(E,l)})}),Ie(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})}},t.prototype.init=function(i,a){var o=this;this.vditor={currentMode:a.mode,element:i,hint:new Bo(a.hint.extend),lute:void 0,options:a,originalInnerHTML:i.innerHTML,outline:new $o(window.VditorI18n.outline),tip:new ea},this.vditor.sv=new Wo(this.vditor),this.vditor.undo=new Vs,this.vditor.wysiwyg=new Ys(this.vditor),this.vditor.ir=new zo(this.vditor),this.vditor.toolbar=new $s(this.vditor),a.resize.enable&&(this.vditor.resize=new qo(this.vditor)),this.vditor.toolbar.elements.devtools&&(this.vditor.devtools=new d),(a.upload.url||a.upload.handler)&&(this.vditor.upload=new _o),(0,S.Z)(a._lutePath||"".concat(a.cdn,"/dist/js/lute/lute.min.js"),"vditorLuteScript").then(function(){o.vditor.lute=(0,Fo.X)({autoSpace:o.vditor.options.preview.markdown.autoSpace,gfmAutoLink:o.vditor.options.preview.markdown.gfmAutoLink,codeBlockPreview:o.vditor.options.preview.markdown.codeBlockPreview,emojiSite:o.vditor.options.hint.emojiPath,emojis:o.vditor.options.hint.emoji,fixTermTypo:o.vditor.options.preview.markdown.fixTermTypo,footnotes:o.vditor.options.preview.markdown.footnotes,headingAnchor:!1,inlineMathDigit:o.vditor.options.preview.math.inlineDigit,linkBase:o.vditor.options.preview.markdown.linkBase,linkPrefix:o.vditor.options.preview.markdown.linkPrefix,listStyle:o.vditor.options.preview.markdown.listStyle,mark:o.vditor.options.preview.markdown.mark,mathBlockPreview:o.vditor.options.preview.markdown.mathBlockPreview,paragraphBeginningSpace:o.vditor.options.preview.markdown.paragraphBeginningSpace,sanitize:o.vditor.options.preview.markdown.sanitize,toc:o.vditor.options.preview.markdown.toc}),o.vditor.preview=new Vo(o.vditor),we(o.vditor),a.after&&a.after(),a.icon&&(0,S.U)("".concat(a.cdn,"/dist/js/icons/").concat(a.icon,".js"),"vditorIconScript")})},t}(m.default);const Zs=Gs})(),h=h.default,h})())}(xi)),xi.exports}var Jl=Xl();const Yn=Gl(Jl),Ql=wt({__name:"VditorEditor",props:{modelValue:{type:String,default:""},theme:{type:String,default:"classic"}},emits:["update:modelValue"],setup(C,{expose:n,emit:r}){const s=C,c=r,h=ae();let m=null;const f={mode:"ir",height:"auto",minHeight:140,resize:{enable:!0,position:"bottom"},icon:"ant",lang:"zh_CN",theme:"classic",toolbar:["emoji","headings","bold","italic","strike","link","|","list","ordered-list","check","|","quote","line","code","inline-code","|","preview","fullscreen"],toolbarConfig:{pin:!0,hideTooltip:!0},counter:{enable:!1},cache:{enable:!0,id:"vue-vditor"},input:w=>{c("update:modelValue",w)},preview:{hljs:{style:"native"},markdown:{listStyle:!0,mark:!0},actions:[]},placeholder:"灵感记录~"};return Ot(async()=>{h.value&&(m=new Yn(h.value,{...f,after:()=>{m==null||m.setValue(s.modelValue),m==null||m.setTheme(s.theme==="dark"?"dark":"classic")}}))}),Zn(()=>{try{m&&(m.destroy(),m=null)}catch(w){console.warn("Vditor destroy error",w)}}),n({clear:()=>{m&&(m.setValue(""),c("update:modelValue",""))},insertValue:w=>{m&&(m.insertValue(w),c("update:modelValue",m.getValue()))}}),ot(()=>s.theme,w=>{m&&m.setTheme(w==="dark"?"dark":"classic")}),(w,T)=>(ue(),ge("div",{ref_key:"editorContainer",ref:h,class:"vditor-container"},null,512))}}),ec={class:"bg-gray-800 p-6 rounded-lg"},tc={class:"space-y-4"},nc={class:"flex justify-end gap-2"},ic=wt({__name:"Searchmode",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","search-result"],setup(C,{expose:n,emit:r}){const s=He(),h=Gn().public.baseApi||"/api",m=C,f=r,w=Ae({get:()=>m.modelValue,set:u=>f("update:modelValue",u)}),T=()=>{f("update:modelValue",!1)},S=ae(""),d=async()=>{var u,p;if(!S.value.trim()){s.add({title:"提示",description:"请输入搜索关键词",color:"yellow"});return}try{const{data:g,error:v}=await Ml("/messages/search",{method:"GET",baseURL:h,params:{keyword:S.value,page:1,pageSize:10}},"$4cD5OWGgav");if(v.value)throw new Error(((u=v.value)==null?void 0:u.message)||"网络请求失败");if(!g.value)throw new Error("未收到服务器响应");if(g.value.code===1)f("search-result",g.value),f("update:modelValue",!1),S.value="",s.add({title:"成功",description:"搜索完成",color:"green"});else throw new Error(((p=g.value)==null?void 0:p.msg)||"搜索失败")}catch(g){console.error("Search error:",g),s.add({title:"错误",description:g instanceof Error?g.message:"搜索失败，请稍后重试",color:"red"})}};return n({handleSearch:d}),(u,p)=>{const g=Di,v=_t,b=Er;return ue(),bt(b,{modelValue:w.value,"onUpdate:modelValue":p[1]||(p[1]=k=>w.value=k)},{default:Ue(()=>[G("div",ec,[p[4]||(p[4]=G("h3",{class:"text-xl font-semibold text-white mb-4"},"搜索内容",-1)),G("div",tc,[fe(g,{modelValue:S.value,"onUpdate:modelValue":p[0]||(p[0]=k=>S.value=k),placeholder:"输入搜索关键词",class:"w-full",onKeyup:qa(d,["enter"])},null,8,["modelValue"]),G("div",nc,[fe(v,{variant:"solid",color:"gray",onClick:T,class:"bg-gray-700 hover:bg-gray-700 text-white hover:text-white border border-gray-600"},{default:Ue(()=>p[2]||(p[2]=[Xe(" 取消 ")])),_:1}),fe(v,{color:"primary",onClick:d,class:"text-white hover:text-white"},{default:Ue(()=>p[3]||(p[3]=[Xe(" 搜索 ")])),_:1})])])])]),_:1},8,["modelValue"])}}}),yo=Kt(ic,[["__scopeId","data-v-e473120d"]]),rc=Ua("notify",{state:()=>({config:{webhookEnabled:!1,webhookURL:"",telegramEnabled:!1,telegramToken:"",telegramChatID:"",weworkEnabled:!1,weworkKey:"",feishuEnabled:!1,feishuWebhook:"",feishuSecret:"",twitterEnabled:!1,twitterApiKey:"",twitterApiSecret:"",twitterAccessToken:"",twitterAccessTokenSecret:"",customHttpEnabled:!1,customHttpUrl:"",customHttpMethod:"POST",customHttpHeaders:"",customHttpBody:'{"content":"{{content}}"}'}}),actions:{async fetchConfig(){try{const n=await(await fetch("/api/notify/config",{credentials:"include"})).json();n.code===1&&(this.config=n.data)}catch(C){console.error("获取推送配置失败:",C)}},async saveConfig(C){try{const r=await(await fetch("/api/notify/config",{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)})).json();if(r.code===1){const s=r.data||C;return Object.keys(this.config).forEach(c=>{c.endsWith("Enabled")?this.config[c]=!!s[c]&&s[c]!=="false":s[c]!==void 0&&(this.config[c]=s[c])}),!0}return!1}catch(n){return console.error("保存推送配置失败:",n),!1}},async testNotify(C){try{return(await(await fetch("/api/notify/test",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:C})})).json()).code===1}catch(n){return console.error("测试推送失败:",n),!1}},async sendNotify(C){try{let n=C.content;return C.images&&C.images.length>0&&(n+=`

`,C.images.forEach(c=>{n+=`![](${c})
`})),(await(await fetch("/api/notify/send",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:n,format:C.format||"markdown",config:this.config})})).json()).code===1}catch(n){return console.error("发送推送失败:",n),!1}}}}),ac=wt({__name:"VideoUpload",emits:["video-uploaded","upload-progress"],setup(C,{emit:n}){const r=n,s=ae(null),c=He(),h=Gn().public.baseApi||"/api",m=()=>{var w;(w=s.value)==null||w.click()},f=async w=>{const T=w.target,S=T.files?T.files[0]:null;if(!S){c.add({title:"错误",description:"未选择视频",color:"red"});return}const d=200*1024*1024;if(S.size>d){c.add({title:"错误",description:"视频不能超过200MB",color:"red"});return}const u=new FormData;u.append("video",S);const p=new XMLHttpRequest;p.open("POST",`${h}/videos/upload`,!0),p.withCredentials=!0,p.upload.onprogress=g=>{if(g.lengthComputable){const v=Math.round(g.loaded/g.total*100);r("upload-progress",v)}},p.onload=()=>{if(p.status===200)try{const g=JSON.parse(p.responseText);if(g.code===1&&g.data)r("video-uploaded",g.data),c.add({title:"成功",description:"视频上传成功",color:"green"});else throw new Error(g.msg||"视频上传失败")}catch(g){c.add({title:"错误",description:g.message||"视频上传失败",color:"red"})}else c.add({title:"错误",description:"视频上传失败",color:"red"});r("upload-progress",0),s.value&&(s.value.value="")},p.onerror=()=>{c.add({title:"错误",description:"视频上传失败",color:"red"}),r("upload-progress",0),s.value&&(s.value.value="")},p.send(u)};return(w,T)=>{const S=_t;return ue(),ge("div",null,[G("input",{ref_key:"videoInput",ref:s,type:"file",accept:"video/*",class:"hidden",onChange:f},null,544),fe(S,{color:"gray",variant:"solid",size:"sm",icon:"i-mdi-video",class:"cursor-pointer",onClick:m,title:"上传视频"})])}}}),_n=Fa(Kn.ui.strategy,Kn.ui.progress,Ll),oc=wt({inheritAttrs:!1,props:{value:{type:Number,default:null},max:{type:[Number,Array],default:100},indicator:{type:Boolean,default:!1},animation:{type:String,default:()=>_n.default.animation,validator(C){return Object.keys(_n.animation).includes(C)}},size:{type:String,default:()=>_n.default.size,validator(C){return Object.keys(_n.progress.size).includes(C)}},color:{type:String,default:()=>_n.default.color,validator(C){return Kn.ui.colors.includes(C)}},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(C){const{ui:n,attrs:r}=$a("progress",Mi(C,"ui"),_n,Mi(C,"class")),s=Ae(()=>en(n.value.indicator.container.base,n.value.indicator.container.width,n.value.indicator.container.transition)),c=Ae(()=>en(n.value.indicator.align,n.value.indicator.width,n.value.indicator.color,n.value.indicator.size[C.size])),h=Ae(()=>{var M;const k=[n.value.progress.base,n.value.progress.width,n.value.progress.size[C.size],n.value.progress.rounded,n.value.progress.track,n.value.progress.bar,(M=n.value.progress.color)==null?void 0:M.replaceAll("{color}",C.color),n.value.progress.background,n.value.progress.indeterminate.base,n.value.progress.indeterminate.rounded];return p.value&&k.push(n.value.animation[C.animation]),en(...k)}),m=Ae(()=>{var k;return en(n.value.steps.base,(k=n.value.steps.color)==null?void 0:k.replaceAll("{color}",C.color),n.value.steps.size[C.size])}),f=Ae(()=>en(n.value.step.base,n.value.step.align)),w=Ae(()=>en(n.value.step.active)),T=Ae(()=>en(n.value.step.first));function S(k){return k===Number(C.value)}function d(k){return k===0}function u(k){k=Number(k);const M=[f.value];return d(k)&&M.push(T.value),S(k)&&M.push(w.value),M.join(" ")}const p=Ae(()=>C.value===void 0||C.value===null),g=Ae(()=>Array.isArray(C.max)),v=Ae(()=>p.value?null:Array.isArray(C.max)?C.max.length-1:Number(C.max)),b=Ae(()=>{if(!p.value)switch(!0){case C.value<0:return 0;case C.value>v.value:return 100;default:return C.value/v.value*100}});return{ui:n,attrs:r,indicatorContainerClass:s,indicatorClass:c,progressClass:h,stepsClass:m,stepClasses:u,isIndeterminate:p,isSteps:g,realMax:v,percent:b}}}),sc=["aria-valuemax","aria-valuenow"];function lc(C,n,r,s,c,h){return ue(),ge("div",{class:$e(C.ui.wrapper),role:"progressbar"},[C.indicator||C.$slots.indicator?pr(C.$slots,"indicator",ul(Ti({key:0},{percent:C.percent})),()=>[C.isSteps?Pe("",!0):(ue(),ge("div",{key:0,class:$e(C.indicatorContainerClass),style:hn({width:`${C.percent}%`})},[G("div",{class:$e(C.indicatorClass)},Ze(Math.round(C.percent))+"% ",3)],6))],!0):Pe("",!0),G("progress",Ti({"aria-valuemax":C.realMax,"aria-valuenow":C.value,class:C.progressClass},{value:C.value,max:C.realMax,...C.attrs}),Ze(C.percent!==void 0?`${Math.round(C.percent)}%`:void 0),17,sc),C.isSteps?(ue(),ge("div",{key:1,class:$e(C.stepsClass)},[(ue(!0),ge(Ct,null,jt(C.max,(m,f)=>(ue(),ge("div",{key:f,class:$e(C.stepClasses(f))},[pr(C.$slots,`step-${f}`,Ti({ref_for:!0},{step:m}),()=>[Xe(Ze(m),1)],!0)],2))),128))],2)):Pe("",!0)],2)}const cc=Kt(oc,[["render",lc],["__scopeId","data-v-157fbd8e"]]),uc={class:"flex justify-between items-center mb-3"},dc={class:"mb-4"},fc={class:"flex gap-2 mb-3"},hc={key:0,class:"space-y-2 mb-3"},pc={class:"flex items-center gap-2"},mc={class:"flex justify-end mt-2 mb-3"},gc=["src"],vc={key:3,class:"text-sm text-gray-300"},yc={key:4,class:"text-sm text-gray-300"},bc={key:1,class:"flex justify-end mt-2"},wc={key:2,class:"mt-2 text-red-400 text-sm"},Ec={key:3,class:"mt-2"},Sc={class:"flex items-center gap-2 bg-gray-800 p-2 rounded"},Cc=["value"],Tc={class:"flex justify-end mt-2"},kc=wt({__name:"ImageHostingUploader",props:{position:{type:Object,required:!0,default:()=>({x:0,y:0})},editorRef:{type:Object,required:!1,default:null}},emits:["close","upload-success"],setup(C,{emit:n}){const r=C,s=Ae(()=>{if(typeof window>"u")return{};const de=window.innerWidth,Z=window.innerHeight,Y=400,J=500;let z=r.position.x,Q=r.position.y;return z+Y>de&&(z=de-Y-20),z<0&&(z=20),Q+J>Z&&(Q=Z-J-20),Q<0&&(Q=20),de<768&&(z=(de-Y)/2,Q=60),{position:"fixed",top:`${Q}px`,left:`${z}px`,maxWidth:`${Math.min(Y,de-40)}px`,width:"100%",cursor:"move",userSelect:"none",touchAction:"none"}}),c=ae(!1),h=ae({x:0,y:0}),m=de=>{c.value=!0;const Z="touches"in de?de.touches[0].clientX:de.clientX,Y="touches"in de?de.touches[0].clientY:de.clientY;h.value={x:Z-r.position.x,y:Y-r.position.y},document.addEventListener("mousemove",f),document.addEventListener("touchmove",f),document.addEventListener("mouseup",w),document.addEventListener("touchend",w)},f=de=>{if(!c.value)return;const Z="touches"in de?de.touches[0].clientX:de.clientX,Y="touches"in de?de.touches[0].clientY:de.clientY;T("update:position",{x:Z-h.value.x,y:Y-h.value.y})},w=()=>{c.value=!1,document.removeEventListener("mousemove",f),document.removeEventListener("touchmove",f),document.removeEventListener("mouseup",w),document.removeEventListener("touchend",w)},T=n,S=He(),d=ae("smms"),u=ae(null),p=ae(!1),g=ae(!1),v=ae(0),b=ae(""),k=ae(""),M=ae(""),_=ae(""),x=ae(""),y=ae("main"),O=ae("images/"),N=ae(!1),F=ae(""),R=ae(""),I=ae(""),j=()=>{var de;(de=u.value)==null||de.click()},q=de=>{var Y;p.value=!1;const Z=(Y=de.dataTransfer)==null?void 0:Y.files;Z&&Z.length>0&&ke(Z[0])},ne=de=>{const Y=de.target.files;Y&&Y.length>0&&ke(Y[0])},ce=ae(null),ke=async de=>{if(!de.type.startsWith("image/")){M.value="请选择图片文件";return}const Z=5*1024*1024;if(de.size>Z){M.value="图片大小不能超过 5MB";return}M.value="",ce.value=de;const Y=new FileReader;Y.onload=J=>{var z;b.value=(z=J.target)==null?void 0:z.result},Y.readAsDataURL(de)},Se=()=>{if(!k.value){M.value="请先上传图片";return}const de=`![](${k.value})`;T("upload-success",de),T("close"),ce.value=null,b.value="",k.value="",v.value=0,g.value=!1,M.value=""},Ee=async de=>{try{await navigator.clipboard.writeText(de),S.add({title:"成功",description:"已复制到剪贴板",color:"green",timeout:2e3})}catch{S.add({title:"错误",description:"复制失败",color:"red",timeout:2e3})}},me=async()=>{if(!ce.value){M.value="请先选择图片";return}g.value=!0,v.value=0,M.value="";try{switch(d.value){case"github":await Me(ce.value);break;default:throw new Error("未知的图床类型")}}catch(de){console.error("上传错误:",de),M.value=de.message||"上传失败",g.value=!1,de.name==="AbortError"?M.value="请求超时，请检查网络连接":de.message.includes("Failed to fetch")&&(M.value="网络请求失败，可能是跨域问题或API不可用")}},Me=async de=>{if(!_.value||!x.value){M.value="请先配置 GitHub Token 和仓库名";return}try{v.value=30;const Z=Date.now(),Y=de.name.split(".").pop(),J=`${Z}.${Y}`,z=`${O.value}${J}`.replace(/\/\//g,"/"),Q=await oe(de),K={message:`Upload image ${J}`,content:Q,branch:y.value||"main"};v.value=50;const B=await fetch(`https://api.github.com/repos/${x.value}/contents/${z}`,{method:"PUT",headers:{Authorization:`token ${_.value}`,"Content-Type":"application/json"},body:JSON.stringify(K)});if(v.value=80,!B.ok)throw new Error(`GitHub 上传失败: ${B.status}`);const Te=await B.json();k.value=N.value&&F.value?`https://${F.value}/gh/${x.value}@${y.value||"main"}/${z}`:Te.content.download_url,v.value=100,g.value=!1,S.add({title:"成功",description:`图片已上传到 GitHub${N.value&&F.value?" (CDN加速)":""}`,color:"green",timeout:2e3})}catch(Z){console.error("GitHub 上传错误:",Z),M.value=Z.message||"GitHub 上传失败",g.value=!1}},oe=de=>new Promise((Z,Y)=>{const J=new FileReader;J.onload=()=>Z(J.result.split(",")[1]),J.onerror=Y,J.readAsDataURL(de)}),le=()=>{try{const de={selectedHost:d.value,github:{token:_.value,repo:x.value,branch:y.value,path:O.value,enableCDN:N.value,cdnDomain:F.value},smms:{token:R.value},freeimage:{token:I.value}};localStorage.setItem("imageHostingConfig",JSON.stringify(de)),S.add({title:"成功",description:"配置已保存",color:"green",timeout:2e3})}catch(de){console.error("保存配置失败:",de),S.add({title:"错误",description:"保存配置失败",color:"red",timeout:2e3})}},H=()=>{const de=localStorage.getItem("imageHostingConfig");if(de)try{const Z=JSON.parse(de);d.value=Z.selectedHost||"smms",Z.github&&(_.value=Z.github.token||"",x.value=Z.github.repo||"",y.value=Z.github.branch||"main",O.value=Z.github.path||"images/",N.value=Z.github.enableCDN||!1,F.value=Z.github.cdnDomain||""),Z.smms&&(R.value=Z.smms.token||""),Z.imgtp&&(imgtpToken.value=Z.imgtp.token||""),Z.freeimage&&(I.value=Z.freeimage.token||"")}catch(Z){console.error("加载配置失败:",Z)}};return ot([d,_,x,y,O,R],()=>{le()},{deep:!0}),Ot(()=>{H()}),(de,Z)=>{const Y=_t,J=Di,z=fl,Q=Dn,K=cc;return ue(),ge("div",{class:"fixed z-[5000] bg-black/80 backdrop-blur-sm rounded-lg shadow-lg p-4 text-white",style:hn(s.value),onMousedown:m,onTouchstart:m},[G("div",uc,[Z[11]||(Z[11]=G("h3",{class:"text-lg font-medium"},"图床上传",-1)),fe(Y,{icon:"i-heroicons-x-mark",color:"gray",variant:"ghost",size:"xs",onClick:Z[0]||(Z[0]=B=>de.$emit("close"))})]),G("div",dc,[G("div",fc,[fe(Y,{color:d.value==="github"?"blue":"gray",variant:"solid",size:"sm",onClick:Z[1]||(Z[1]=B=>d.value="github")},{default:Ue(()=>Z[12]||(Z[12]=[Xe(" GitHub ")])),_:1},8,["color"])]),d.value==="github"?(ue(),ge("div",hc,[fe(J,{modelValue:_.value,"onUpdate:modelValue":Z[2]||(Z[2]=B=>_.value=B),placeholder:"GitHub Token",size:"sm",type:"password"},null,8,["modelValue"]),fe(J,{modelValue:x.value,"onUpdate:modelValue":Z[3]||(Z[3]=B=>x.value=B),placeholder:"仓库名 (用户名/仓库)",size:"sm"},null,8,["modelValue"]),fe(J,{modelValue:y.value,"onUpdate:modelValue":Z[4]||(Z[4]=B=>y.value=B),placeholder:"分支名 (默认: main)",size:"sm"},null,8,["modelValue"]),fe(J,{modelValue:O.value,"onUpdate:modelValue":Z[5]||(Z[5]=B=>O.value=B),placeholder:"存储路径 (默认: images/)",size:"sm"},null,8,["modelValue"]),G("div",pc,[fe(z,{modelValue:N.value,"onUpdate:modelValue":Z[6]||(Z[6]=B=>N.value=B)},null,8,["modelValue"]),Z[13]||(Z[13]=G("span",{class:"text-sm"},"启用CDN加速",-1))]),N.value?(ue(),bt(J,{key:0,modelValue:F.value,"onUpdate:modelValue":Z[7]||(Z[7]=B=>F.value=B),placeholder:"输入CDN域名 (如: jsd.cdn.noisework.cn)",size:"sm"},null,8,["modelValue"])):Pe("",!0)])):Pe("",!0),G("div",mc,[fe(Y,{color:"green",variant:"solid",size:"sm",icon:"i-heroicons-check",onClick:le},{default:Ue(()=>Z[14]||(Z[14]=[Xe(" 保存配置 ")])),_:1})]),G("div",{class:$e(["flex flex-col items-center justify-center border-2 border-dashed border-gray-500 rounded-lg p-4 cursor-pointer hover:border-blue-400 transition-colors",{"border-blue-400":p.value}]),onClick:j,onDragover:Z[8]||(Z[8]=Zi(B=>p.value=!0,["prevent"])),onDragleave:Z[9]||(Z[9]=Zi(B=>p.value=!1,["prevent"])),onDrop:Zi(q,["prevent"])},[G("input",{ref_key:"fileInput",ref:u,type:"file",accept:"image/*",onChange:ne,class:"hidden"},null,544),!g.value&&!b.value?(ue(),bt(Q,{key:0,name:"i-heroicons-cloud-arrow-up",class:"w-10 h-10 text-gray-400 mb-2"})):Pe("",!0),b.value&&!g.value?(ue(),ge("img",{key:1,src:b.value,class:"max-h-32 max-w-full mb-2 rounded"},null,8,gc)):Pe("",!0),g.value?(ue(),bt(K,{key:2,value:v.value,color:"blue",class:"w-full mb-2"},null,8,["value"])):Pe("",!0),!g.value&&!b.value?(ue(),ge("p",vc," 点击或拖拽图片到此处上传 ")):Pe("",!0),g.value?(ue(),ge("p",yc," 上传中... "+Ze(v.value)+"% ",1)):Pe("",!0)],34),b.value&&!g.value&&!k.value?(ue(),ge("div",bc,[fe(Y,{color:"blue",variant:"solid",size:"sm",icon:"i-heroicons-cloud-arrow-up",onClick:me},{default:Ue(()=>Z[15]||(Z[15]=[Xe(" 开始上传 ")])),_:1})])):Pe("",!0),M.value?(ue(),ge("div",wc,Ze(M.value),1)):Pe("",!0),k.value?(ue(),ge("div",Ec,[G("div",Sc,[G("input",{type:"text",value:k.value,readonly:"",class:"bg-transparent flex-1 text-sm outline-none"},null,8,Cc),fe(Y,{icon:"i-heroicons-clipboard",color:"gray",variant:"ghost",size:"xs",onClick:Z[10]||(Z[10]=B=>Ee(k.value))})]),G("div",Tc,[fe(Y,{color:"blue",variant:"solid",size:"sm",onClick:Se},{default:Ue(()=>Z[16]||(Z[16]=[Xe(" 插入图片 ")])),_:1})])])):Pe("",!0)])],36)}}}),xc=Kt(kc,[["__scopeId","data-v-b776646b"]]),Mc={class:"flex justify-between mb-3"},_c={class:"flex justify-start items-center gap-2"},Lc={class:"flex gap-2"},Ac={href:"/rss",target:"_blank"},Dc={class:"flex justify-between items-center"},Oc={class:"flex items-center justify-start gap-2"},Pc={key:0,class:"w-full mt-2"},Rc={class:"bg-gray-700 rounded h-2"},Ic={class:"text-xs text-gray-300 mt-1 text-right"},Hc={class:"flex gap-2"},Nc={key:0,class:"mx-auto sm:max-w-2xl mt-5 backdrop-blur-sm bg-black/40 p-4 rounded-md editor-preview"},jc={class:"prose prose-invert max-w-none"},Bc=["innerHTML"],zc={key:0,class:"prose prose-invert max-w-none editor-preview"},Fc=["innerHTML"],$c=wt({__name:"AddForm",emits:["search-result","video-uploaded","before-upload","upload-progress"],setup(C,{emit:n}){const r=ae(!1),s=ae({x:400,y:320}),c=Z=>{var Y;(Y=F.value)!=null&&Y.insertValue&&F.value.insertValue(Z),r.value=!1},h=Z=>{s.value=Z},m=ae(0),f=Z=>{m.value=Z},w=ae(!1),T=n,S=Z=>{T("search-result",Z)},d=He(),u=Gn().public.baseApi||"/api",{save:p}=Ja(),g=An("showHeatmap");ki("showHeatmap",g);const v=()=>{g.value=!g.value},b=ae(""),k=ae(""),M=ae(""),_=ae(typeof window<"u"&&localStorage.getItem("postPrivate")==="true"),x=An("contentTheme"),y=An("toggleContentTheme"),O=()=>{y&&y(),typeof window<"u"&&(document.documentElement.className=x.value==="dark"?"dark":"")},N=ae(null),F=ae(null),R=Ae(()=>_.value?"i-mdi-eye-off-outline":"i-mdi-eye-outline");rc();const I=ae(localStorage.getItem("enableNotify")==="true"),j=()=>{b.value="",k.value="",M.value="",F.value&&F.value.clear()},q=br(),ne=()=>q.isLogin?!0:(d.add({title:"提示",description:"请先登录",color:"orange",timeout:2e3}),!1),ce=()=>{const Z=document.getElementById("file-input");Z&&Z.click()},ke=async Z=>{var Te;if(!ne())return;const Y=Z.target,J=Y.files?Y.files[0]:null;if(!J){d.add({title:"错误",description:"没有选择文件",color:"red",timeout:2e3});return}const z=["image/jpeg","image/png","image/gif","image/webp"],Q=[".jpg",".jpeg",".png",".gif",".webp"],K=J.name.toLowerCase().substring(J.name.lastIndexOf("."));if(!z.includes(J.type)||!Q.includes(K)){d.add({title:"错误",description:"仅支持 JPG、PNG、GIF、WEBP 格式的图片",color:"red",timeout:2e3});return}const B=5*1024*1024;if(J.size>B){d.add({title:"错误",description:"图片大小不能超过 5MB",color:"red",timeout:2e3});return}try{const se=new FormData;se.append("image",J);const je=await fetch(`${u}/images/upload`,{method:"POST",body:se,credentials:"include"});if(!je.ok){const $=await je.json();throw new Error($.msg||"图片上传失败")}const V=await je.json();if(V.code===1&&V.data){if((Te=F.value)!=null&&Te.insertValue){const W=`
![](${typeof window<"u"?window.location.origin:""}${u}${V.data})
`;F.value.insertValue(W)}d.add({title:"成功",description:"图片上传成功",color:"green",timeout:2e3})}else throw new Error(V.msg||"图片上传失败")}catch(se){console.error("上传错误:",se),d.add({title:"错误",description:se.message||"图片上传失败",color:"red",timeout:2e3})}finally{N.value&&(N.value.value="")}},Se=Z=>{var Q;const Y=typeof window<"u"?window.location.origin:"",J=Z.startsWith("/")?Z:`/${Z}`,z=`<video width="100%" height="100%" src="${Y}${J}" controls loop></video>
`;(Q=F.value)!=null&&Q.insertValue&&F.value.insertValue(z)},Ee=/!\s*(https?:\/\/[^\s!]+\.(?:png|jpe?g|gif|webp))(?:\?[^\s!]*)?/gi,me=Z=>Z.replace(Ee,(Y,J)=>`![](${J})`),Me=Z=>{const J=new DOMParser().parseFromString(Z,"text/html"),z=Te=>{let se=!0;const je=Array.from(Te.childNodes);if(je.length===0)return!1;for(const V of je)if(V.nodeType===Node.ELEMENT_NODE){const $=V,W=$.tagName.toLowerCase();if(W==="img"||W==="a"&&$.childElementCount===1&&$.querySelector("img"))continue;if(W==="br"){se=!1;break}se=!1;break}else if(V.nodeType===Node.TEXT_NODE&&(V.textContent||"").trim()!==""){se=!1;break}return se},Q=Array.from(J.body.querySelectorAll("p")),K=[];let B=[];for(const Te of Q)if(z(Te)){const se=B[B.length-1];!se||se.nextElementSibling===Te?B.push(Te):(B.length>=2&&K.push(B),B=[Te])}else B.length>=2&&K.push(B),B=[];B.length>=2&&K.push(B);for(const Te of K){const se=J.createElement("div"),je=Te.length,V=je===2||je===4?2:Math.min(3,je);se.className=`image-grid cols-${V}`;const $=`grid-${Math.random().toString(36).slice(2)}`;for(const X of Te){const we=X.querySelector("img"),Oe=X.querySelector("a");if(!we&&!Oe)continue;const tt=J.createElement("div");tt.className="image-grid-item";let ct;if(Oe&&Oe.querySelector("img")){if(ct=Oe,ct.setAttribute("data-fancybox",$),!ct.getAttribute("href")){const De=Oe.querySelector("img");ct.setAttribute("href",De.src)}}else if(we)ct=J.createElement("a"),ct.setAttribute("href",we.src),ct.setAttribute("data-fancybox",$),ct.appendChild(we);else continue;tt.appendChild(ct),se.appendChild(tt)}Te[0].replaceWith(se);for(let X=1;X<Te.length;X++)Te[X].remove()}return J.body.innerHTML};ot(k,Z=>{const Y=Yn.md2html(me(Z||""));M.value=Me(Y),Qe(()=>{document.querySelectorAll(".editor-preview").forEach(z=>{z.querySelectorAll(".image-grid-item img").forEach(Q=>{const K=Q,B=K.parentElement,Te=()=>{const se=K.naturalWidth,je=K.naturalHeight;B.classList.remove("ar-169","ar-34","ar-11"),se>je?B.classList.add("ar-169"):je>se?B.classList.add("ar-34"):B.classList.add("ar-11")};K.complete&&K.naturalWidth&&K.naturalHeight?Te():K.addEventListener("load",Te,{once:!0})})})})}),ot(()=>q.isLogin,Z=>{Z&&(I.value=localStorage.getItem("enableNotify")==="true")},{immediate:!0}),Ot(async()=>{Fe.bind("[data-fancybox]",{}),q.isLogin||localStorage.getItem("token")&&q.fetchUserInfo&&await q.fetchUserInfo(),_.value=localStorage.getItem("postPrivate")==="true",x.value=localStorage.getItem("contentTheme")||x.value}),Zn(()=>{Fe.destroy()});const oe=()=>{I.value=!I.value,localStorage.setItem("enableNotify",I.value.toString())},le=()=>{_.value=!_.value,localStorage.setItem("postPrivate",_.value?"true":"false")},H=Z=>q.isLogin?!0:(d.add({title:"提示",description:"请登录后操作",color:"orange",timeout:2e3}),Z.preventDefault&&Z.preventDefault(),!1),de=async()=>{if(!ne())return;if(!k.value.trim()){d.add({title:"错误",description:"请输入内容或上传图片/视频",color:"red",timeout:2e3});return}const Z={username:b.value,content:k.value,private:_.value,notify:I.value};try{await p(Z)&&j()}catch(Y){console.error("发布错误:",Y),d.add({title:"错误",description:Y.message||"发布失败",color:"red",timeout:2e3})}};return(Z,Y)=>{const J=Dn,z=hl,Q=dl,K=wr;return ue(),ge(Ct,null,[fe(K,{class:"mx-auto sm:max-w-2xl hover:shadow-md backdrop-blur-sm bg-black/20 shadow-lg text-white"},{default:Ue(()=>[G("div",Mc,[G("div",_c,[fe(J,{name:"i-heroicons-pencil-square",class:"w-6 h-6 transition-all duration-300 hover:scale-110 hover:text-blue-400 animate-pulse"}),Y[5]||(Y[5]=G("h2",{class:"text-lg font-bold italic text-white"},"说说·笔记~",-1))]),G("div",Lc,[fe(z,null,{default:Ue(()=>[G("div",{onClick:Y[0]||(Y[0]=B=>w.value=!0),class:"cursor-pointer flex"},[fe(J,{name:"i-heroicons-magnifying-glass",class:"w-5 h-5 text-gray-200"})]),G("button",{onClick:v},[fe(J,{name:"i-mdi-calendar-month",class:"w-5 h-5 text-gray-200"})]),G("button",{onClick:O,title:"切换暗黑/白天模式"},[fe(J,{name:Le(x)==="dark"?"i-mdi-weather-night":"i-mdi-white-balance-sunny",class:"w-5 h-5 text-gray-200"},null,8,["name"])]),G("a",Ac,[fe(J,{name:"i-mdi-rss",class:"w-5 h-5 text-gray-200"})])]),_:1}),fe(Q,{to:"/status"},{default:Ue(()=>[fe(J,{name:"i-mdi-server-outline",class:"w-5 h-5 text-gray-200"})]),_:1})])]),G("div",null,[fe(Ql,{ref_key:"vditorEditor",ref:F,modelValue:k.value,"onUpdate:modelValue":Y[1]||(Y[1]=B=>k.value=B),theme:Le(x)},null,8,["modelValue","theme"]),G("div",Dc,[G("div",Oc,[G("input",{id:"file-input",ref_key:"fileInput",ref:N,type:"file",accept:"image/*",onChange:ke,class:"hidden",placeholder:"选择图片"},null,544),fe(ac,{onVideoUploaded:Se,onBeforeUpload:H,onUploadProgress:f}),m.value>0&&m.value<100?(ue(),ge("div",Pc,[G("div",Rc,[G("div",{class:"bg-blue-500 h-2 rounded",style:hn({width:m.value+"%"})},null,4)]),G("div",Ic,Ze(m.value)+"%",1)])):Pe("",!0),fe(Le(_t),{color:"gray",variant:"solid",class:"cursor-pointer",size:"sm",icon:"i-fluent-image-20-regular",onClick:ce}),fe(Le(_t),{color:"gray",variant:"solid",class:"cursor-pointer",size:"sm",icon:"i-mdi-cloud-upload-outline",onClick:Y[2]||(Y[2]=B=>r.value=!0),title:"图床上传"}),fe(Le(_t),{color:"gray",variant:"solid",size:"sm",onClick:le,icon:R.value,title:_.value?"设为公开":"设为私密",ui:{tooltip:{text:_.value?"设为公开":"设为私密"}}},null,8,["icon","title","ui"]),fe(Le(_t),{color:"gray",variant:"solid",size:"sm",onClick:oe,icon:I.value?"i-mdi-bell":"i-mdi-bell-off",title:I.value?"关闭推送":"开启推送",ui:{tooltip:{text:I.value?"关闭推送":"开启推送"}},class:"text-gray-600"},null,8,["icon","title","ui"])]),G("div",Hc,[fe(Le(_t),{icon:"i-fluent-broom-16-regular",variant:"solid",color:"gray",size:"sm",onClick:j}),fe(Le(_t),{icon:"i-fluent-add-12-filled",variant:"solid",color:"gray",size:"sm",onClick:de})])])])]),_:1}),M.value?(ue(),ge("div",Nc,[G("div",jc,[G("div",{innerHTML:M.value},null,8,Bc)]),Y[6]||(Y[6]=G("hr",{class:"border-gray-600 my-4"},null,-1)),M.value?(ue(),ge("div",zc,[G("div",{innerHTML:M.value},null,8,Fc)])):Pe("",!0)])):Pe("",!0),fe(yo,{modelValue:w.value,"onUpdate:modelValue":Y[3]||(Y[3]=B=>w.value=B),onSearchResult:S},null,8,["modelValue"]),r.value?(ue(),bt(xc,{key:1,position:s.value,onClose:Y[4]||(Y[4]=B=>r.value=!1),onUploadSuccess:c,"onUpdate:position":h},null,8,["position"])):Pe("",!0)],64)}}}),Uc=Kt($c,[["__scopeId","data-v-7b984a80"]]),yr=wt({__name:"MarkdownRenderer",props:{content:{type:String,required:!0},enableGithubCard:{type:Boolean,default:!0}},emits:["tagClick","rendered"],setup(C,{emit:n}){const r=/https:\/\/www\.bilibili\.com\/video\/(BV[\w]+)\/?$/,s=/https:\/\/(?:www\.)?youtube\.com\/watch\?v=([\w-]+)|https:\/\/youtu\.be\/([\w-]+)/,c=/https:\/\/music\.163\.com(?:\/#)?\/song\?id=(\d+)/,h=/https:\/\/y\.qq\.com\/n\/yqq\/song(\w+)\.html/,m=/https:\/\/v\.qq\.com\/x\/cover\/\w+\/(\w+)\.html/,f=/https:\/\/open\.spotify\.com\/(track|album|playlist)\/([a-zA-Z0-9]+)/,w=/https:\/\/v\.youku\.com\/v_show\/id_([a-zA-Z0-9]+)\.html/,T=n,S=ae(null);let d=null;const u=C,p=An("contentTheme"),g=()=>{if(!S.value)return;const O=p&&p.value==="dark";S.value.classList.toggle("theme-dark",!!O),S.value.classList.toggle("theme-light",!O)},v=()=>{var O;if(window.mediumZoom){d&&d.detach();const N=(O=S.value)==null?void 0:O.getElementsByTagName("img");N&&N.length>0&&(d=window.mediumZoom(N,{background:"rgba(0, 0, 0, 0.9)",margin:24,scrollOffset:0}))}},b=()=>{if(!S.value)return;const O=I=>{let j=!0;const q=Array.from(I.childNodes);if(q.length===0)return!1;for(const ne of q)if(ne.nodeType===Node.ELEMENT_NODE){const ce=ne,ke=ce.tagName.toLowerCase();if(ke==="img"||ke==="a"&&ce.childElementCount===1&&ce.querySelector("img"))continue;if(ke==="br"){j=!1;break}j=!1;break}else if(ne.nodeType===Node.TEXT_NODE&&(ne.textContent||"").trim()!==""){j=!1;break}return j},N=Array.from(S.value.querySelectorAll("p")),F=[];let R=[];for(const I of N)if(O(I)){const j=R[R.length-1];!j||j.nextElementSibling===I?R.push(I):(R.length>=2&&F.push(R),R=[I])}else R.length>=2&&F.push(R),R=[];R.length>=2&&F.push(R);for(const I of F){const j=document.createElement("div"),q=I.length,ne=q===2||q===4?2:Math.min(3,q);j.className=`image-grid cols-${ne}`;const ce=`grid-${Math.random().toString(36).slice(2)}`;for(const Se of I){const Ee=Se.querySelector("img"),me=Se.querySelector("a");if(!Ee&&!me)continue;const Me=document.createElement("div");Me.className="image-grid-item";let oe;if(me&&me.querySelector("img")){if(oe=me,oe.setAttribute("data-fancybox",ce),!oe.getAttribute("href")&&me.querySelector("img")){const le=me.querySelector("img");oe.setAttribute("href",le.src)}}else if(Ee)oe=document.createElement("a"),oe.setAttribute("href",Ee.src),oe.setAttribute("data-fancybox",ce),oe.appendChild(Ee);else continue;Me.appendChild(oe),j.appendChild(Me)}j.querySelectorAll("img").forEach(Se=>{const Ee=Se,me=Ee.closest(".image-grid-item"),Me=()=>{const oe=Ee.naturalWidth,le=Ee.naturalHeight;me&&(me.classList.remove("ar-169","ar-34","ar-11"),oe>le?me.classList.add("ar-169"):le>oe?me.classList.add("ar-34"):me.classList.add("ar-11"))};Ee.complete&&Ee.naturalWidth&&Ee.naturalHeight?Me():Ee.addEventListener("load",Me,{once:!0})}),I[0].replaceWith(j);for(let Se=1;Se<I.length;Se++)I[Se].remove()}},k=new RegExp("(?<!!)\\[([^\\]]+)\\]\\((https:\\/\\/github\\.com\\/([\\w-]+)\\/([\\w.-]+)(?:\\/[^\\s)]*)?)\\)","g"),M=new RegExp(`(?<!["'\\(])\\bhttps:\\/\\/github\\.com\\/([\\w-]+)\\/([\\w.-]+)(?:\\/[^\\s<\\)]*)?\\b`,"g"),_=O=>(u.enableGithubCard&&(O=O.replace(k,(N,F,R,I,j)=>`<div class="github-card" id="${`github-card-${I}-${j}`}" data-owner="${I}" data-repo="${j}">
        <div class="github-card-loading">Loading GitHub Repo...</div>
      </div>`),O=O.replace(M,(N,F,R)=>`<div class="github-card" id="${`github-card-${F}-${R}`}" data-owner="${F}" data-repo="${R}">
        <div class="github-card-loading">Loading GitHub Repo...</div>
      </div>`)),O.replace(r,"<div class='video-wrapper'><iframe src='https://www.bilibili.com/blackboard/html5mobileplayer.html?bvid=$1&as_wide=1&high_quality=1&danmaku=0' scrolling='no' border='0' frameborder='no' framespacing='0' allowfullscreen='true' style='position:absolute;height:100%;width:100%'></iframe></div>").replace(s,"<div class='video-wrapper'><iframe src='https://www.youtube.com/embed/$1$2' title='YouTube video player' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen></iframe></div>").replace(c,"<div class='music-wrapper'><meting-js auto='https://music.163.com/#/song?id=$1'></meting-js></div>").replace(h,"<meting-js auto='https://y.qq.com/n/yqq/song$1.html'></meting-js>").replace(m,"<div class='video-wrapper'><iframe src='//v.qq.com/iframe/player.html?vid=$1' allowFullScreen='true' frameborder='no'></iframe></div>").replace(f,"<div class='spotify-wrapper'><iframe style='border-radius:12px' src='https://open.spotify.com/embed/$1/$2?utm_source=generator&theme=0' width='100%' frameBorder='0' allowfullscreen='' allow='autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture' loading='lazy'></iframe></div>").replace(w,"<div class='video-wrapper'><iframe src='https://player.youku.com/embed/$1' frameborder=0 'allowfullscreen'></iframe></div>")),x=async(O,N,F)=>{try{const R=await fetch(`https://api.github.com/repos/${O}/${N}`);if(!R.ok)return;const I=await R.json(),j=document.getElementById(F);j&&(j.innerHTML=`
        <div class="github-card-header">
          <img src="${I.owner.avatar_url}" class="github-card-avatar" />
          <div>
            <a href="${I.html_url}" target="_blank" class="github-card-title">${I.full_name}</a>
            <div class="github-card-desc">${I.description||""}</div>
          </div>
        </div>
        <div class="github-card-footer">
          <span>⭐ ${I.stargazers_count}</span>
          <span>🍴 ${I.forks_count}</span>
          <span>🛠️ ${I.language||""}</span>
        </div>
      `)}catch{}},y=async O=>{if(S.value)try{if(typeof Yn>"u"){console.error("Vditor is not loaded.");return}let N="";try{N=normalizeInlineImageLinks(O??"")}catch{N=O??""}const F=_(N);let R="";try{R=F.replace(/<a /g,'<a target="_blank" ').replace(new RegExp("(?<!<[^>]*)#([^\\s#<>]+)(?![^<]*>)","g"),`<span class="clickable-tag" onclick="window.handleTagClick('$1')" style="cursor: pointer;">#$1</span>`)}catch{R=F.replace(/<a /g,'<a target="_blank" ')}const I=p&&p.value==="dark"?"dark":"light",j=I==="dark"?"github-dark":"github";try{Yn.preview(S.value,R,{mode:"light",lang:"zh_CN",theme:{current:I},hljs:{style:j,lineNumber:!0,enable:!0},after:()=>{var ke,Se,Ee;const q=(ke=S.value)==null?void 0:ke.querySelectorAll("a");q==null||q.forEach(me=>{me.hasAttribute("target")||(me.setAttribute("target","_blank"),me.setAttribute("rel","noopener noreferrer"))}),g(),b(),v(),console.log("Rendering complete."),T("rendered");const ne=window.processNMPv2Shortcodes;ne&&S.value&&ne(S.value);const ce=(Se=S.value)==null?void 0:Se.querySelectorAll(".clickable-tag");if(ce==null||ce.forEach(me=>{me.addEventListener("click",Me=>{var le;Me.preventDefault();const oe=(le=me.textContent)==null?void 0:le.substring(1);oe&&T("tagClick",oe)})}),u.enableGithubCard){const me=(Ee=S.value)==null?void 0:Ee.querySelectorAll(".github-card");me==null||me.forEach(Me=>{const oe=Me.getAttribute("data-owner"),le=Me.getAttribute("data-repo"),H=Me.id;oe&&le&&H&&x(oe,le,H)})}}})}catch{try{S.value.innerHTML=Yn.md2html(R),g()}catch{S.value.innerHTML=R}}}catch(N){console.error("Error rendering markdown:",N),S.value.innerHTML=""}};return ot(()=>u.content,async O=>{await y(O)},{immediate:!0}),Ot(()=>{y(u.content),window.APlayer&&window.MetingJSElement?console.log("MetingJS is ready"):console.error("MetingJS or APlayer is not loaded properly"),g()}),Zn(()=>{d&&(d.detach(),d=null)}),ot(()=>p&&p.value,()=>{g(),y(u.content)}),(O,N)=>(ue(),ge("div",{ref_key:"previewElement",ref:S,class:"markdown-preview"},null,512))}}),Vc={class:"builtin-comments"},qc={class:"space-y-3 mb-4"},Wc={class:"grid grid-cols-1 md:grid-cols-3 gap-3"},Yc={class:"flex justify-end"},Kc={key:1,class:"space-y-4"},Gc={class:"mt-2 flex gap-2"},Zc={class:"mt-2 flex gap-2"},Xc={class:"p-4"},Jc={class:"flex justify-end gap-2"},Si="border border-black rounded ring-0 focus:ring-0 focus:border-black",Ci="bg-[rgba(24,28,32,0.85)] text-white border border-white/20 rounded focus:ring-0 focus:border-primary-400 placeholder:text-gray-400",Qc=wt({__name:"BuiltinComments",props:{messageId:{},siteConfig:{}},setup(C){const n=C,r=ae([]),s=ae(""),c=ae(""),h=ae(""),m=ae(""),f=ae(null),w=ae(!1),T=ae(!1),S=ae(!1),d=ae(null),u=br(),p=Ae(()=>{var oe;return!!((oe=u.user)!=null&&oe.is_admin)}),g=An("contentTheme",ae("light")),v=Ae(()=>String((g==null?void 0:g.value)||"light")==="dark"||document.documentElement.classList.contains("dark")),b=Ae(()=>v.value?"bg-[rgba(24,28,32,0.95)]":"bg-white"),k=Ae(()=>v.value?"border-white/20":"border-black"),M=Ae(()=>v.value?"text-gray-200":"text-[#111]"),_=Ae(()=>v.value?"text-gray-400":"text-gray-500"),x=Ae(()=>v.value?"bg-[rgba(24,28,32,0.7)]":"bg-white"),y=Ae(()=>v.value?"border-white/20":"border-black"),O=Ae(()=>w.value?"ring-1 ring-red-500":v.value?Ci:`bg-gray-50 ${Si}`),N=Ae(()=>T.value?"ring-1 ring-red-500":v.value?Ci:`bg-gray-50 ${Si}`),F=Ae(()=>v.value?Ci:`bg-white ${Si}`),R=Ae(()=>v.value?Ci:`bg-white ${Si}`),I=async()=>{try{const oe=await Nt(`messages/${n.messageId}/comments`,void 0,{credentials:"include"});if(oe&&oe.code===1){const le=Array.isArray(oe.data)?oe.data:[];r.value=le.sort((H,de)=>new Date(H.created_at).getTime()-new Date(de.created_at).getTime())}else r.value=[]}catch{r.value=[]}},j=async()=>{try{if(w.value=!s.value.trim(),T.value=!c.value.trim(),w.value||T.value){He().add({title:"缺少必填字段",description:(s.value?"":"昵称 ")+(c.value?"":"邮箱"),color:"red"});return}const oe={nick:s.value.trim(),mail:c.value.trim(),link:h.value.trim(),content:m.value.trim()};if(!oe.content){He().add({title:"内容不能为空",color:"red"});return}if(oe.mail&&!/^\S+@\S+\.\S+$/.test(oe.mail)){He().add({title:"邮箱格式不正确",color:"red"});return}f.value&&(oe.parent_id=f.value);const le=await un(`messages/${n.messageId}/comments`,oe,{credentials:"include"});if(le&&le.code===1){m.value="",f.value=null,r.value=[...r.value,le.data],await I(),await Qe();const H=document.querySelector(`.content-container[data-msg-id="${n.messageId}"]`);H==null||H.scrollIntoView({behavior:"smooth",block:"start"}),He().add({title:"已发布",color:"green"})}else He().add({title:"发布失败",description:le==null?void 0:le.msg,color:"red"})}catch{He().add({title:"发布失败",color:"red"})}},q=oe=>new Date(oe).toLocaleString();Ot(I);const ne=()=>I();Ot(()=>{window.addEventListener(`refresh-comments-${n.messageId}`,ne)}),Zn(()=>{window.removeEventListener(`refresh-comments-${n.messageId}`,ne)}),ot(()=>n.messageId,I);const ce=(oe,le)=>{f.value=oe,m.value.startsWith(`@${le} `)||(m.value=`@${le} `+m.value)},ke=oe=>{d.value=oe,S.value=!0},Se=async()=>{if(d.value)try{const oe=await Va(`messages/${n.messageId}/comments/${d.value}`,void 0,{credentials:"include"});oe&&oe.code===1?(r.value=r.value.filter(le=>le.id!==d.value),He().add({title:"已删除",color:"green"}),Ee()):He().add({title:"删除失败",description:oe==null?void 0:oe.msg,color:"red"})}catch{He().add({title:"删除失败",color:"red"})}finally{S.value=!1,d.value=null}},Ee=()=>{const oe=document.querySelector(`.content-container[data-msg-id="${n.messageId}"]`);oe==null||oe.scrollIntoView({behavior:"smooth",block:"start"})},me=Ae(()=>(r.value||[]).filter(oe=>!oe.parent_id)),Me=Ae(()=>{const oe={}(r.value||[]).forEach(le=>{const H=le.parent_id;H&&(oe[H]||(oe[H]=[]),oe[H].push(le))});return oe});return(oe,le)=>{var z;const H=Di,de=Ga,Z=_t,Y=Er,J=ml;return ue(),ge("div",Vc,[G("div",{class:$e(["waline-wrapper p-3 rounded-lg border",[b.value,k.value]])},[G("div",{class:$e(["text-sm mb-2",M.value])},"评论",2),(z=oe.siteConfig)!=null&&z.commentEmailEnabled?(ue(),ge("div",{key:0,class:$e(["text-xs mb-2",_.value])},"新评论或回复会发送通知邮件",2)):Pe("",!0),G("div",qc,[G("div",Wc,[fe(H,{modelValue:s.value,"onUpdate:modelValue":le[0]||(le[0]=Q=>s.value=Q),placeholder:"昵称",class:$e(O.value)},null,8,["modelValue","class"]),fe(H,{modelValue:c.value,"onUpdate:modelValue":le[1]||(le[1]=Q=>c.value=Q),placeholder:"邮箱",class:$e(N.value)},null,8,["modelValue","class"]),fe(H,{modelValue:h.value,"onUpdate:modelValue":le[2]||(le[2]=Q=>h.value=Q),placeholder:"网址（可选）",class:$e(F.value)},null,8,["modelValue","class"])]),fe(de,{modelValue:m.value,"onUpdate:modelValue":le[3]||(le[3]=Q=>m.value=Q),rows:3,maxlength:500,placeholder:"写点什么...",class:$e(R.value)},null,8,["modelValue","class"]),G("div",Yc,[fe(Z,{color:"green",onClick:j},{default:Ue(()=>[Xe(Ze(f.value?"发布回复":"发布评论"),1)]),_:1})])]),me.value.length?(ue(),ge("div",Kc,[(ue(!0),ge(Ct,null,jt(me.value,Q=>{var K;return ue(),ge("div",{key:Q.id,class:$e(["rounded-md p-3 border",[x.value,k.value]])},[G("div",{class:$e(["text-xs flex items-center justify-between",_.value])},[G("span",null,Ze(Q.nick||"匿名"),1),G("span",null,Ze(q(Q.created_at)),1)],2),G("div",{class:$e(["mt-1 text-sm",M.value])},Ze(Q.content),3),G("div",Gc,[fe(Z,{size:"xs",variant:"ghost",onClick:B=>ce(Q.id,Q.nick||"匿名")},{default:Ue(()=>le[6]||(le[6]=[Xe("回复")])),_:2},1032,["onClick"]),p.value?(ue(),bt(Z,{key:0,size:"xs",color:"red",variant:"ghost",onClick:B=>ke(Q.id)},{default:Ue(()=>le[7]||(le[7]=[Xe("删除")])),_:2},1032,["onClick"])):Pe("",!0)]),(K=Me.value[Q.id])!=null&&K.length?(ue(),ge("div",{key:0,class:$e(["mt-3 pl-4 border-l space-y-2",y.value])},[(ue(!0),ge(Ct,null,jt(Me.value[Q.id],B=>(ue(),ge("div",{key:B.id,class:$e(["rounded-md p-3 border",[x.value,k.value]])},[G("div",{class:$e(["text-xs flex items-center justify-between",_.value])},[G("span",null,Ze(B.nick||"匿名"),1),G("span",null,Ze(q(B.created_at)),1)],2),G("div",{class:$e(["mt-1 text-sm",M.value])},Ze(B.content),3),G("div",Zc,[fe(Z,{size:"xs",variant:"ghost",onClick:Te=>ce(B.id,B.nick||"匿名")},{default:Ue(()=>le[8]||(le[8]=[Xe("回复")])),_:2},1032,["onClick"]),p.value?(ue(),bt(Z,{key:0,size:"xs",color:"red",variant:"ghost",onClick:Te=>ke(B.id)},{default:Ue(()=>le[9]||(le[9]=[Xe("删除")])),_:2},1032,["onClick"])):Pe("",!0)])],2))),128))],2)):Pe("",!0)],2)}),128))])):(ue(),ge("div",{key:2,class:$e(["text-xs",_.value])},"暂无评论",2))],2),fe(Y,{modelValue:S.value,"onUpdate:modelValue":le[5]||(le[5]=Q=>S.value=Q)},{default:Ue(()=>[G("div",Xc,[le[12]||(le[12]=G("div",{class:"mb-3"},"确认删除该评论吗？此操作不可恢复。",-1)),G("div",Jc,[fe(Z,{variant:"ghost",onClick:le[4]||(le[4]=Q=>S.value=!1)},{default:Ue(()=>le[10]||(le[10]=[Xe("取消")])),_:1}),fe(Z,{color:"red",onClick:Se},{default:Ue(()=>le[11]||(le[11]=[Xe("删除")])),_:1})])])]),_:1},8,["modelValue"]),fe(J)])}}}),eu={class:"min-h-screen flex flex-col"},tu={key:0,class:"text-center text-gray-500 py-8"},nu={class:"flex-grow mx-auto w-full sm:max-w-2xl px-2"},iu={key:0,class:"flex justify-between items-center mb-4 p-4 rounded-lg"},ru={class:"text-gray-400"},au={class:"my-4"},ou={key:0,class:"text-center text-gray-500 py-8"},su={class:"flex justify-between items-center"},lu={class:"flex justify-start items-center h-auto overflow-x-auto whitespace-nowrap hide-scrollbar"},cu={class:"flex justify-start items-center text-sm"},uu={class:"text-orange-500"},du={class:"text-orange-500"},fu={key:0,class:"flex items-center text-orange-500 flex-shrink-0 ml-1",title:"置顶"},hu={class:"message-actions flex justify-end items-center space-x-2 flex-shrink-0 px-3 py-1.5 mr-[9px] -mb-[1px]"},pu={key:0,class:"w-5 h-5 flex-shrink-0 transition-transform duration-200 hover:scale-110"},mu=["onClick","title"],gu=["onClick"],vu=["onClick"],yu=["onClick"],bu=["onClick"],wu=["onClick"],Eu={class:"border-l-2 border-gray-300 p-4 ml-1"},Su=["data-msg-id"],Cu=["src","fetchpriority"],Tu={key:1,class:"border-t border-gray-600 my-4"},ku={key:2,class:"text-center mt-2 relative",style:{"z-index":"9999"}},xu=["onClick"],Mu=["id"],_u={key:2,class:"text-xs opacity-70"},Lu={key:1,class:"flex justify-center items-center space-x-4 w-full my-4 flex-wrap md:flex-nowrap"},Au={class:"flex justify-center items-center space-x-4 w-full md:w-auto"},Du={key:2,class:"ml-2 text-orange-400"},Ou={class:"flex items-center justify-center space-x-2 w-full md:w-auto mt-3 md:mt-0"},Pu={class:"text-gray-500 text-shadow-sm text-sm"},Ru={key:2,class:"text-center text-gray-500 mt-4"},Iu={key:1,class:"text-center text-xs text-gray-400 py-4"},Hu=["innerHTML"],Nu={class:"flex justify-between items-center"},ju={class:"flex flex-col space-y-4"},Bu={class:"border-t border-gray-200 my-2 pt-2"},zu={class:"p-4 rounded-lg overflow-auto max-h-[300px] bg-[rgba(36,43,50,0.95)]"},Fu={class:"text-white"},$u={class:"flex justify-end space-x-2"},Uu=wt({__name:"MessageList",props:{siteConfig:{type:Object,required:!0},targetMessageId:{type:String,default:null}},setup(C,{expose:n}){const r=An("contentTheme",ae(typeof window<"u"&&localStorage.getItem("contentTheme")||"dark")),s=Ae(()=>r.value==="dark"?"bg-[rgba(36,43,50,0.95)] text-white":"bg-white text-black"),c=Ae(()=>r.value==="dark"?"text-white":"text-black"),h=Ae(()=>r.value==="dark"?"from-[rgba(36,43,50,1)] via-[rgba(36,43,50,0.8)] to-transparent":"from-[rgba(255,255,255,1)] via-[rgba(255,255,255,0.8)] to-transparent"),m=Ae(()=>r.value==="dark"?"bg-[rgba(36,43,50,0.95)] text-white rounded-lg p-3":"bg-white text-black rounded-lg p-3"),f=Ae(()=>r.value==="dark"?"bg-[rgba(36,43,50,0.95)] text-white hover:text-white border-none shadow-sm rounded-full":"bg-white text-black hover:text-black border border-gray-300 shadow-sm rounded-full"),w=Ae(()=>r.value==="dark"?"bg-[rgba(36,43,50,0.75)] text-white hover:text-white hover:bg-[rgba(36,43,50,0.85)] active:bg-[rgba(36,43,50,0.9)] focus:bg-[rgba(36,43,50,0.85)] border border-white/70":"bg-[rgba(24,28,32,0.6)] text-white hover:text-white hover:bg-[rgba(24,28,32,0.7)] active:bg-[rgba(24,28,32,0.75)] focus:bg-[rgba(24,28,32,0.7)] border border-white/70"),T=ae(""),S=Ae(()=>Math.ceil(v.total/15)),d=async()=>{const V=parseInt(T.value);if(!V||V<1||V>S.value||v.loading){He().add({title:"页码无效",description:`请输入 1-${S.value} 之间的数字`,color:"orange",timeout:2e3});return}try{const $=document.querySelector(".content-wrapper"),W=$?$.scrollTop:window.scrollY,X=await v.getMessages({page:V,pageSize:15});if(!X)throw new Error("跳转页面失败");const we=X.items.filter(Oe=>!Oe.pinned);v.messages=[...R.value,...we],v.page=X.page||V,T.value="",await Qe(),$?$.scrollTo({top:W,behavior:"instant"}):window.scrollTo({top:W,behavior:"instant"})}catch($){console.error("跳转页面失败:",$),He().add({title:"跳转失败",color:"red",timeout:2e3})}},u=C,p=Ae(()=>{const V=u.siteConfig||{},$=String(V.commentSystem||"waline").toLowerCase();return(typeof V.commentEnabled=="boolean"?!!V.commentEnabled:!0)&&$==="waline"&&!!V.walineServerURL});ot(()=>u.targetMessageId,async V=>{if(!V)return;await Qe();const $=document.querySelector(`.content-container[data-msg-id="${V}"]`);$&&($.scrollIntoView({behavior:"smooth",block:"center"}),$.classList.add("highlight-message"),setTimeout(()=>{$.classList.remove("highlight-message")},2e3))},{immediate:!0});const g=Gn().public.baseApi||"/api";Ja();const v=Xa(),b=ae(null),k=br(),M=Ae(()=>k.isLogin),_=async V=>{try{const $=encodeURIComponent(V.trim()),W=await fetch(`${g}/messages/tags/${$}`,{credentials:"include",headers:{Accept:"application/json"}});if(!W.ok)throw new Error(`HTTP error! status: ${W.status}`);const X=await W.json();if(X.code===1&&Array.isArray(X.data))K.value=!0,B.value=X.data,await Qe(),Se(),O();else throw new Error(X.msg||"获取标签内容失败")}catch($){console.error("获取标签消息失败:",$),He().add({title:"获取标签消息失败",description:$.message||"服务器错误，请稍后重试",color:"red",timeout:3e3})}},x=async()=>{B.value=[],K.value=!1,await v.getMessages({page:1,pageSize:15}),await Qe(),Se(),O()},y=async V=>{if(confirm("确定要删除这条消息吗？"))try{await v.deleteMessage(V),v.messages=v.messages.filter(W=>W.id!==V),He().add({title:"删除成功",color:"green",timeout:2e3})}catch(W){console.error("删除失败:",W),He().add({title:"删除失败",color:"red",timeout:2e3})}},O=()=>{if(window.Fancybox){window.Fancybox.destroy();const V={Carousel:{infinite:!1},Toolbar:{display:[{id:"prev",position:"center"},{id:"counter",position:"center"},{id:"next",position:"center"},"zoom","slideshow","fullscreen","close"]},Image:{zoom:!0,click:!0,wheel:"slide"}};document.querySelectorAll(".markdown-preview img").forEach(W=>{const X=W.getAttribute("src")||"",we=/^https?:\/\//i.test(X),Oe=W.parentElement;if(Oe&&Oe.tagName==="A"&&Oe.hasAttribute("data-fancybox")){we||Oe.replaceWith(W);return}if(we){const tt=document.createElement("a");tt.href=X,tt.setAttribute("data-fancybox","uploaded-image"),tt.style.display="block",W.parentNode.insertBefore(tt,W),tt.appendChild(W)}else Oe&&Oe.tagName==="A"&&Oe.hasAttribute("data-fancybox")&&Oe.replaceWith(W)}),window.Fancybox.bind("[data-fancybox]",V)}},N=async V=>{var $,W;if(b.value===V){b.value=null;return}if(b.value=V,await Qe(),((($=u.siteConfig)==null?void 0:$.commentSystem)||"waline")==="builtin"){const X=document.querySelector(`.content-container[data-msg-id="${V}"] .builtin-comments`);if(X){X.scrollIntoView({behavior:"smooth",block:"center"});const we=X.querySelector("textarea");(W=we==null?void 0:we.focus)==null||W.call(we)}return}p.value&&window.Waline&&(document.querySelector(`#waline-${V}`)?window.Waline.init({el:`#waline-${V}`,serverURL:u.siteConfig.walineServerURL,path:`messages/${V}`,reaction:!1,meta:["nick","mail","link"],requiredMeta:["mail","nick"],pageview:!0,search:!1,wordLimit:200,pageSize:5,avatar:"monsterid",emoji:["https://unpkg.com/@waline/emojis@1.2.0/tieba"],imageUploader:!1,copyright:!1,dark:'html[class="dark"]'}):console.error(`评论容器 #waline-${V} 未找到`))},F=V=>{if(!M.value)return!1;const $=k.user;if(!$)return!1;const W=!!($.IsAdmin||$.is_admin),X=($.ID||$.userid)===V.user_id;return W||X},R=ae([]),I=async V=>{try{const $=!V.pinned;await v.setPinned(V.id,$)&&($?R.value.some(X=>X.id===V.id)||(R.value=[V,...R.value]):R.value=R.value.filter(X=>X.id!==V.id),He().add({title:$?"已置顶":"已取消置顶",color:"green",timeout:1500}))}catch{He().add({title:"操作失败",color:"red",timeout:2e3})}},j=V=>{const $=new Date(V),X=new Date().getTime()-$.getTime(),we=Math.floor(X/(1e3*60*60*24)),Oe=Math.floor(X/(1e3*60*60)),tt=Math.floor(X/(1e3*60));return Math.floor(X/1e3)<60?"刚刚":tt<60?`${tt}分钟前`:Oe<24?`${Oe}小时前`:we<3?`${we}天前`:$.toLocaleString()},q=ae({}),ne=ae({}),ce=ae({}),ke=V=>{q.value[V]=!q.value[V]},Se=()=>{Qe(()=>{(K.value?B.value:v.messages).forEach($=>{const W=document.querySelector(`.content-container[data-msg-id="${$.id}"] .overflow-y-hidden`);if(!W)return;const X=!!document.querySelector(`.content-container[data-msg-id="${$.id}"] .image-grid`);if(ce.value[$.id]=X,X){ne.value[$.id]=!1,q.value[$.id]=!0;return}W.scrollHeight>700?(ne.value[$.id]=!0,q.value[$.id]===void 0&&(q.value[$.id]=!1)):ne.value[$.id]=!1})})};ot(()=>v.messages,()=>{Ee.hash.includes("/messages/")||Qe(()=>{requestAnimationFrame(()=>{Se(),O()})})},{deep:!0});const Ee=Wa();Ot(async()=>{try{const V=Ee.hash.split("/messages/").pop();if(p.value&&!window.Waline){const $=document.createElement("link");$.rel="stylesheet",$.href="https://unpkg.com/@waline/client@v2/dist/waline.css",document.head.appendChild($),await new Promise((W,X)=>{const we=document.createElement("script");we.src="https://unpkg.com/@waline/client@v2/dist/waline.js",we.crossOrigin="anonymous",we.onload=W,we.onerror=X,document.head.appendChild(we)})}if(V){const $=await fetch(`${g}/messages/${V}`,{credentials:"include",headers:{Accept:"application/json"}});if(!$.ok)throw new Error("消息加载失败");const W=await $.json();if(W.code===1&&W.data){v.messages=[W.data],v.hasMore=!1,v.page=1,await Qe();const X=document.querySelector(`.content-container[data-msg-id="${V}"]`);X&&X.scrollIntoView({behavior:"instant",block:"start"})}else throw new Error("消息不存在")}else if(!Ee.hash.includes("/messages/")){const $=await fetch(`${g}/messages/page`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({page:1,pageSize:15})});if($.ok){const W=await $.json();W.code===1&&W.data&&(v.messages=W.data.items||[],v.total=W.data.total||0,v.hasMore=v.messages.length<v.total,v.page=1)}}await Qe(),Se(),O()}catch(V){console.error("初始化失败:",V),V instanceof Error&&He().add({title:"加载失败",description:V.message||"请刷新重试",color:"red",timeout:2e3})}}),ot(()=>Ee.hash,async V=>{const $=V.split("/messages/").pop();if(!$){if(!Ee.hash.includes("/messages/")){const W=await fetch(`${g}/messages/page`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({page:1,pageSize:15})});if(W.ok){const X=await W.json();X.code===1&&X.data&&(v.messages=X.data.items||[],v.total=X.data.total||0,v.hasMore=v.messages.length<v.total,v.page=1)}}return}try{const W=await fetch(`${g}/messages/${$}`,{credentials:"include",headers:{Accept:"application/json"}});if(!W.ok)throw new Error("消息加载失败");const X=await W.json();if(X.code===1&&X.data){v.messages=[X.data],v.hasMore=!1,v.page=1,await Qe();const we=document.querySelector(`.content-container[data-msg-id="${$}"]`);we&&we.scrollIntoView({behavior:"instant",block:"start"})}}catch(W){console.error("加载消息失败:",W),He().add({title:"加载失败",color:"red",timeout:2e3})}},{immediate:!0});const me=ae(!1),Me=async()=>{if(!(me.value||v.page<=1)){me.value=!0;try{const V=document.querySelector(".content-wrapper"),$=V?V.scrollTop:window.scrollY,W=v.page-1,X=await v.getMessages({page:W,pageSize:15});if(X&&Array.isArray(X.items)){const we=X.items.filter(Oe=>!Oe.pinned);v.messages=[...R.value,...we],v.page=X.page||W}else v.page=W;await Qe(),V?V.scrollTo({top:$,behavior:"instant"}):window.scrollTo({top:$,behavior:"instant"})}catch{He().add({title:"加载失败",color:"red",timeout:2e3})}finally{me.value=!1}}},oe=async()=>{if(!(me.value||!v.hasMore)){me.value=!0;try{const V=document.querySelector(".content-wrapper"),$=V?V.scrollTop:window.scrollY,W=v.page+1,X=await v.getMessages({page:W,pageSize:15});if(X&&Array.isArray(X.items)){const we=X.items.filter(Oe=>!Oe.pinned);v.messages=[...R.value,...we],v.page=X.page||W}else v.page=W;await Qe(),V?V.scrollTo({top:$,behavior:"instant"}):window.scrollTo({top:$,behavior:"instant"})}catch{He().add({title:"加载失败",color:"red",timeout:2e3})}finally{me.value=!1}}};ot(()=>k.isLogin,V=>{V&&v.getMessages({page:1,pageSize:15})}),ot(()=>v.messages,async()=>{try{if(v.page===1){const $=(v.messages||[]).filter(W=>W.pinned).filter((W,X,we)=>we.findIndex(Oe=>Oe.id===W.id)===X);R.value=$}await Qe(),Se(),O()}catch(V){console.error("更新视图失败:",V)}},{deep:!0}),Zn(()=>{window.Fancybox&&window.Fancybox.destroy()});const le=async V=>{try{await navigator.clipboard.writeText(V),He().add({title:"复制成功",color:"green",timeout:2e3})}catch($){console.error("复制失败:",$),He().add({title:"复制失败",color:"red",timeout:2e3})}},H=ae(!1),de=ae(""),Z=ae(null),Y=ae(!1),J=V=>{if(Z.value=V.id,de.value=V.content,V.image_url){const $=`

<!-- 附件图片(编辑时可删除) -->
![附件图片](${g}${V.image_url})
<!-- 附件图片结束 -->`;de.value+=$}H.value=!0},z=async()=>{if(Z.value){Y.value=!0;try{const V=v.messages.find(we=>we.id===Z.value);if(!V)return;let $=de.value;if($=$.replace(/\n*<!-- 附件图片\(编辑时可删除\) -->\n!\[附件图片\]\(.*?\)\n<!-- 附件图片结束 -->\n*/g,""),$===V.content){He().add({title:"内容未修改",description:"请修改内容后再保存",color:"orange",timeout:2e3}),Y.value=!1;return}const W=await fetch(`${g}/messages/${Z.value}`,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({content:$,image_url:V.image_url})});if(!W.ok)throw new Error(`HTTP error! status: ${W.status}`);const X=await W.json();if(X.code===1){const we=v.messages.findIndex(Oe=>Oe.id===Z.value);we!==-1&&(v.messages[we]={...v.messages[we],content:de.value,image_url:V.image_url}),H.value=!1,He().add({title:"更新成功",color:"green",timeout:2e3})}else throw new Error(X.msg||"保存失败")}catch(V){console.error("更新消息失败:",V),He().add({title:"更新失败",color:"red",timeout:2e3})}finally{Y.value=!1}}},Q=async V=>{var $,W;try{const X=document.querySelector(`.content-container[data-msg-id="${V}"]`);if(!X)return;const we=(W=($=X.querySelector(".markdown-preview"))==null?void 0:$.textContent)==null?void 0:W.trim(),Oe=X.querySelector("img"),tt=X.querySelector("video"),ct=X.querySelector("audio");if(!we&&!Oe&&tt||!we&&!Oe&&ct){He().add({title:"此内容不可生成卡片",color:"orange",timeout:2e3});return}const De=setTimeout(()=>{He().add({title:"生成超时",description:"卡片生成时间过长，请稍后重试",color:"red",timeout:3e3})},1e4),Gt=q.value[V];q.value[V]=!0,await Qe();const ut=document.createElement("div");ut.style.cssText=`
  padding: 16px;
  background: transparent;
  border-radius: 12px;
  width: ${Oe?"640px":"480px"};
  position: absolute;
  left: -9999px;
  top: 0;
  z-index: -1;
  overflow: visible;
  min-height: fit-content;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
  border: none;
`,document.body.appendChild(ut);const Ie=X.cloneNode(!0),Et=window.getComputedStyle(X),On=Et.backgroundColor&&Et.backgroundColor!=="rgba(0, 0, 0, 0)"?Et.backgroundColor:"#ffffff",Xn=Et.color||"#333";Ie.querySelectorAll(".text-center.mt-2, .bg-gradient-to-t").forEach(ze=>ze.remove()),Ie.style.cssText=`
      max-height: none;
      overflow: visible;
      padding: 0;
      margin: 0;
      background: ${On};
      border-radius: 12px;
    `;const Ft=Ie.querySelector(".overflow-y-hidden");Ft&&(Ft.className="",Ft.style.cssText=`
        overflow: visible;
        max-height: none !important;
        height: auto !important;
        padding: 4px 12px;
        line-height: 1.6;
        margin-top: 0;
        margin-bottom: 0;
        white-space: pre-wrap;
        background: ${On};
        border-radius: 12px;
        font-size: 14px;
        color: ${Xn};
      `);const Pn=Array.from(Ie.children).find(ze=>ze.tagName==="IMG");Pn&&(Pn.style.margin="1px 0",Pn.style.display="block"),Ie.querySelectorAll("img").forEach(ze=>{ze.style.margin="1px 0",ze.style.display="block"});const mn=Ie.querySelector(".border-t");mn&&(mn.style.margin="1px 0");const $t=Ie.querySelector(".markdown-preview");if($t){$t.style.marginTop="1px";const ze=$t.firstElementChild;ze&&(ze.style.marginTop="1px"),$t.querySelectorAll("p, h1, h2, h3, h4, h5, h6").forEach(Ye=>{Ye.style.marginTop=Ye.style.marginTop||"2px"})}Ie.querySelectorAll("video, audio, iframe").forEach(ze=>{var pt;const Ye=document.createElement("div");Ye.style.cssText=`
        padding: 15px;
        background: rgba(251, 146, 60, 0.1);
        border: 1px solid rgba(251, 146, 60, 0.3);
        border-radius: 8px;
        color: #fb923c;
        margin: 15px 0;
        word-break: break-all;
      `,ze instanceof HTMLVideoElement?Ye.innerHTML=`🎬 视频链接：${ze.src||"未知链接"}`:ze instanceof HTMLAudioElement?Ye.innerHTML=`🎵 音频链接：${ze.src||"未知链接"}`:ze instanceof HTMLIFrameElement&&(Ye.innerHTML=`🔗 嵌入内容链接：${ze.src||"未知链接"}`),(pt=ze.parentNode)==null||pt.replaceChild(Ye,ze)}),await(async()=>{const ze=Ie.querySelectorAll("img");await Promise.all(Array.from(ze).map(async Ye=>new Promise(pt=>{const At=Ye.src;Ye.crossOrigin="anonymous",At.startsWith("/")?(Ye.src=`${g}${At}`,fetch(Ye.src,{credentials:"include"}).then(et=>et.blob()).then(et=>{Ye.src=URL.createObjectURL(et),pt()}).catch(()=>{var et;console.error("图片加载失败:",At),(et=Ye.parentElement)==null||et.removeChild(Ye),pt()})):Ye.complete?pt():(Ye.onload=()=>pt(),Ye.onerror=()=>{var et;console.error("图片加载失败:",At),(et=Ye.parentElement)==null||et.removeChild(Ye),pt()})})))})(),ut.appendChild(Ie);const Rn=document.createElement("div");Rn.style.cssText=`
    margin-top: 12px;
    padding-top: 12px;
    text-align: center;
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    background: transparent;
  `,Rn.innerHTML=`
    <div style="color: #fb923c; font-size: 13px; margin-bottom: 4px; font-weight: 500;">
      ${u.siteConfig.cardFooterTitle}
    </div>
    <a href="https://note.noisework.cn" 
       target="_blank" 
       rel="noopener noreferrer" 
       style="color: rgba(255,255,255,0.5); text-decoration: none;">
      ${u.siteConfig.cardFooterSubtitle}
    </a>
  `,ut.appendChild(Rn),await Qe();const ft=await html2canvas(ut,{backgroundColor:null,scale:2,useCORS:!0,allowTaint:!0,logging:!1,width:ut.offsetWidth,height:ut.scrollHeight,borderRadius:"16px",onclone:ze=>{const Ye=ze.querySelector(".content-container");Ye&&(Ye.style.cssText=`
            overflow: visible !important;
            max-height: none !important;
            height: auto !important;
            padding: 0;
            min-height: ${(Ft==null?void 0:Ft.scrollHeight)||0}px;
            background: ${On};
            border-radius: 12px;
          `)}});clearTimeout(De);const Lt=document.createElement("a");Lt.download=`message-${V}.png`,Lt.href=ft.toDataURL("image/png"),Lt.click(),document.body.removeChild(ut),q.value[V]=Gt,He().add({title:"下载成功",color:"green",timeout:2e3})}catch(X){console.error("下载失败:",X),He().add({title:"下载失败",color:"red",timeout:2e3})}},K=ae(!1),B=ae([]),Te=async V=>{var $;try{const W=K.value?null:window.scrollY;if(console.debug("API返回的原始数据:",V),!V)throw new Error("API返回数据为空");let X=[],we=0;if(V.code===1?Array.isArray(V.data)?X=V.data:($=V.data)!=null&&$.items&&(X=V.data.items):Array.isArray(V)&&(X=V),!Array.isArray(X))throw new Error("无效的数据格式");we=X.length,K.value=!0,B.value=X,we===0?He().add({title:"未找到相关内容",color:"orange",timeout:2e3}):He().add({title:`找到 ${we} 条结果`,color:"green",timeout:2e3}),W!==null&&window.scrollTo({top:0,behavior:"smooth"}),await Qe(),Se(),O()}catch(W){console.error("处理搜索结果时出错:",W),He().add({title:"搜索失败",description:W.message||"处理搜索结果时发生错误",color:"red",timeout:2e3}),se()}},se=()=>{B.value=[],K.value=!1,console.log("重置搜索 - searchResults:",B.value),console.log("重置搜索 - isSearchMode:",K.value),Qe(()=>{Se(),O()})},je=Ae(()=>{if(K.value&&Array.isArray(B.value))return B.value;const V=v.messages||[];if(!R.value.length)return V;const $=V.filter(W=>!R.value.some(X=>X.id===W.id));return[...R.value,...$]});return n({handleSearchResult:Te}),ot(B,V=>{console.log("searchResults变化:",V),Qe(()=>{Se(),O()})},{deep:!0,immediate:!0}),ot(K,V=>{console.log("isSearchMode变化:",V),Qe(()=>{Se(),O()})}),Ae(()=>({cardFooterTitle:u.siteConfig.cardFooterTitle,cardFooterSubtitle:u.siteConfig.cardFooterSubtitle,pageFooterHTML:u.siteConfig.pageFooterHTML,walineServerURL:u.siteConfig.walineServerURL})),(V,$)=>{const W=Dn,X=_t,we=Di,Oe=Ga,tt=wr,ct=Er;return ue(),ge(Ct,null,[G("div",eu,[Le(je).length?Pe("",!0):(ue(),ge("div",tu,[fe(W,{name:"i-heroicons-inbox",class:"w-12 h-12 mx-auto mb-4"}),$[5]||($[5]=G("p",null,"暂无消息内容",-1))])),G("div",nu,[Le(K)?(ue(),ge("div",iu,[G("p",ru,"搜索结果 ("+Ze(Le(B).length)+" 条)",1),fe(X,{size:"sm",variant:"ghost",class:"text-gray-400 hover:text-orange-500",icon:"i-heroicons-arrow-left",onClick:x},{default:Ue(()=>$[6]||($[6]=[Xe(" 返回完整列表 ")])),_:1})])):Pe("",!0),G("div",au,[Le(K)&&Le(B).length===0?(ue(),ge("div",ou,[fe(W,{name:"i-heroicons-magnifying-glass",class:"w-12 h-12 mx-auto mb-4"}),$[7]||($[7]=G("p",null,"未找到相关内容",-1))])):Pe("",!0),(ue(!0),ge(Ct,null,jt(Le(je),De=>{var Gt,ut,Ie;return ue(),ge("div",{key:De.id,class:"w-full h-auto overflow-hidden flex flex-col justify-between"},[G("div",su,[G("div",lu,[$[9]||($[9]=G("div",{class:"w-2 h-2 rounded-full bg-orange-600 mr-2 flex-shrink-0"},null,-1)),G("div",cu,[G("span",uu,Ze(j(De.created_at)),1),$[8]||($[8]=G("span",{class:"gradient-dot mx-2 flex-shrink-0"},"@",-1)),G("span",du,Ze(De.username||"匿名用户"),1),De.pinned?(ue(),ge("div",fu,[fe(W,{name:"i-mdi-pin",class:"w-4 h-4"})])):Pe("",!0)])]),G("div",hu,[De.private?(ue(),ge("div",pu,[fe(W,{name:"i-mdi-lock-outline",class:"text-gray-400"})])):Pe("",!0),F(De)?(ue(),ge("div",{key:1,class:"w-5 h-5 cursor-pointer flex-shrink-0 transition-all duration-200 hover:scale-110",onClick:Et=>I(De),title:De.pinned?"取消置顶":"置顶内容"},[fe(W,{name:De.pinned?"i-mdi-pin":"i-mdi-pin-outline",class:"text-gray-400 hover:text-orange-500"},null,8,["name"])],8,mu)):Pe("",!0),Le(M)?(ue(),ge("div",{key:2,class:"w-5 h-5 cursor-pointer flex-shrink-0 transition-all duration-200 hover:scale-110",onClick:Et=>J(De),title:"编辑内容"},[fe(W,{name:"i-mdi-pencil-outline",class:"text-gray-400 hover:text-orange-500"})],8,gu)):Pe("",!0),G("div",{class:"w-5 h-5 cursor-pointer flex-shrink-0 transition-all duration-200 hover:scale-110",onClick:Et=>le(De.content),title:"复制内容"},[fe(W,{name:"i-mdi-content-copy",class:"text-gray-400 hover:text-orange-500"})],8,vu),G("div",{class:"w-5 h-5 cursor-pointer flex-shrink-0 transition-all duration-200 hover:scale-110",onClick:Et=>Q(De.id),title:"下载为图片"},[fe(W,{name:"i-mdi-image-outline",class:"text-gray-400 hover:text-orange-500"})],8,yu),G("div",{class:"w-5 h-5 cursor-pointer flex-shrink-0 transition-all duration-200 hover:scale-110",onClick:Et=>N(De.id),title:"评论"},[fe(W,{name:"i-mdi-comment-outline",class:"text-gray-400 hover:text-orange-500"})],8,bu),Le(M)?(ue(),ge("div",{key:3,class:"w-5 h-5 cursor-pointer flex-shrink-0 transition-all duration-200 hover:scale-110",onClick:Et=>y(De.id),title:"删除"},[fe(W,{name:"i-mdi-paper-roll-outline",class:"text-gray-400 hover:text-orange-500"})],8,wu)):Pe("",!0)])]),G("div",Eu,[De.image_url||De.content?(ue(),ge("div",{key:0,class:$e(["content-container",Le(s)]),"data-msg-id":De.id},[De.image_url?(ue(),ge("img",{key:0,src:`${Le(g)}${De.image_url}`,alt:"Image",class:"max-w-full object-cover rounded-lg mb-4",loading:"lazy",fetchpriority:V.index<3?"high":"low"},null,8,Cu)):Pe("",!0),De.image_url&&De.content?(ue(),ge("div",Tu)):Pe("",!0),G("div",{class:$e(["overflow-y-hidden relative",[{"max-h-[700px]":!Le(q)[De.id]&&!Le(ce)[De.id]},Le(c)]])},[fe(yr,{content:De.content,enableGithubCard:((Gt=C.siteConfig)==null?void 0:Gt.enableGithubCard)===!0,onTagClick:_,onRendered:Se,"link-target":"_blank"},null,8,["content","enableGithubCard"]),Le(ne)[De.id]&&!Le(q)[De.id]?(ue(),ge("div",{key:0,class:$e(["absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t",Le(h)])},null,2)):Pe("",!0)],2),Le(ne)[De.id]?(ue(),ge("div",ku,[G("button",{onClick:Et=>ke(De.id),class:$e(["expand-toggle-btn flex items-center justify-center space-x-1 mx-auto px-4 py-2 focus:outline-none transition-colors duration-200",Le(f)])},[G("span",null,Ze(Le(q)[De.id]?"收起内容":"展开全文"),1),fe(W,{name:Le(q)[De.id]?"i-mdi-chevron-up":"i-mdi-chevron-down",class:"w-5 h-5"},null,8,["name"])],10,xu)])):Pe("",!0)],10,Su)):Pe("",!0),Ya(G("div",{class:$e(["mt-4",Le(m)])},[((ut=C.siteConfig)==null?void 0:ut.commentEnabled)===!0?(ue(),ge(Ct,{key:0},[(((Ie=C.siteConfig)==null?void 0:Ie.commentSystem)||"waline")==="builtin"?(ue(),bt(Qc,{key:0,"message-id":De.id,"site-config":C.siteConfig},null,8,["message-id","site-config"])):Le(p)?(ue(),ge("div",{key:1,id:`waline-${De.id}`},null,8,Mu)):(ue(),ge("div",_u,"未配置评论系统"))],64)):Pe("",!0)],2),[[Ka,Le(b)===De.id]])])])}),128))]),Le(K)?Pe("",!0):(ue(),ge("div",Lu,[G("div",Au,[Le(v).page>1?(ue(),bt(X,{key:0,color:"gray",variant:"ghost",size:"xs",class:$e(["rounded-full px-4 py-1.5 shadow-lg hover:shadow-xl transition-all duration-300 backdrop-blur-sm",Le(w)]),onClick:Me,disabled:Le(me)},{default:Ue(()=>[fe(W,{name:"i-heroicons-arrow-left",class:"mr-1 w-4 h-4"}),$[10]||($[10]=Xe(" 上一页 "))]),_:1},8,["class","disabled"])):Pe("",!0),Le(v).hasMore?(ue(),bt(X,{key:1,color:"gray",variant:"ghost",size:"xs",class:$e(["rounded-full px-4 py-1.5 shadow-lg hover:shadow-xl transition-all duration-300 backdrop-blur-sm",Le(w)]),onClick:oe,disabled:Le(me)},{default:Ue(()=>[$[11]||($[11]=Xe(" 下一页 ")),fe(W,{name:"i-heroicons-arrow-right",class:"ml-1 w-4 h-4"})]),_:1},8,["class","disabled"])):Pe("",!0),Le(me)?(ue(),ge("span",Du,"加载中...")):Pe("",!0)]),G("div",Ou,[G("span",Pu,"第 "+Ze(Le(v).page)+" 页",1),fe(we,{modelValue:Le(T),"onUpdate:modelValue":$[0]||($[0]=De=>Xi(T)?T.value=De:null),type:"number",min:"1",max:Le(S),class:"w-12 text-center text-sm",placeholder:"#",onKeyup:qa(d,["enter"])},null,8,["modelValue","max"]),fe(X,{size:"xs",color:"gray",variant:"ghost",class:"text-gray-400 hover:text-orange-500 text-sm",onClick:d},{default:Ue(()=>$[12]||($[12]=[Xe(" 跳转 ")])),_:1})])])),!Le(K)&&Le(v).messages.length>0&&!Le(v).hasMore?(ue(),ge("div",Ru,[fe(W,{name:"i-fluent-emoji-flat-confetti-ball",size:"lg"}),$[13]||($[13]=Xe(" 加载完毕~ "))])):Pe("",!0)]),C.siteConfig.pageFooterHTML?(ue(),ge("div",{key:2,innerHTML:C.siteConfig.pageFooterHTML},null,8,Hu)):(ue(),ge("div",Iu,$[14]||($[14]=[Xe(" 来自"),G("a",{href:"https://www.noisework.cn",target:"_blank",rel:"noopener noreferrer",class:"text-orange-400 hover:text-orange-500"},"Noise",-1),Xe(" 使用"),G("a",{href:"https://github.com/rcy1314/echo-noise",target:"_blank",rel:"noopener noreferrer",class:"text-orange-400 hover:text-orange-500"},"Ech0-Noise",-1),Xe("发布 ")])))]),fe(ct,{modelValue:Le(H),"onUpdate:modelValue":$[4]||($[4]=De=>Xi(H)?H.value=De:null),ui:{width:"sm:max-w-2xl"}},{default:Ue(()=>[fe(tt,null,{header:Ue(()=>[G("div",Nu,[$[15]||($[15]=G("h3",{class:"text-lg font-medium"},"编辑内容",-1)),fe(X,{color:"gray",variant:"ghost",icon:"i-mdi-close",class:"-my-1",onClick:$[1]||($[1]=De=>H.value=!1)})])]),footer:Ue(()=>[G("div",$u,[fe(X,{color:"gray",variant:"outline",onClick:$[3]||($[3]=De=>H.value=!1),class:"text-white"},{default:Ue(()=>$[17]||($[17]=[Xe(" 取消 ")])),_:1}),fe(X,{color:"orange",onClick:z,loading:Le(Y),class:"text-white"},{default:Ue(()=>$[18]||($[18]=[Xe(" 保存 ")])),_:1},8,["loading"])])]),default:Ue(()=>{var De;return[G("div",ju,[fe(Oe,{modelValue:Le(de),"onUpdate:modelValue":$[2]||($[2]=Gt=>Xi(de)?de.value=Gt:null),placeholder:"编辑内容...",rows:"10",class:"font-mono text-sm"},null,8,["modelValue"]),G("div",Bu,[$[16]||($[16]=G("div",{class:"text-sm text-gray-500 mb-2"},"预览：",-1)),G("div",zu,[G("div",Fu,[fe(yr,{content:Le(de),enableGithubCard:((De=C.siteConfig)==null?void 0:De.enableGithubCard)===!0},null,8,["content","enableGithubCard"])])])])])]}),_:1})]),_:1},8,["modelValue"])],64)}}}),Vu=Kt(Uu,[["__scopeId","data-v-8dbb93c3"]]),qu={class:"heatmap-header"},Wu={class:"heatmap-legend"},Yu={class:"legend-colors"},Ku={class:"calendar-wrapper"},Gu={class:"month-labels"},Zu={class:"weekday-labels"},Xu={class:"heatmap-grid"},Ju=["title"],Qu=wt({__name:"heatmap",setup(C){const n=ae([]),r=ae([]),s=ae(null),c=Ae(()=>{if(!n.value.length)return Array(12).fill("").map((k,M)=>`${M+1}月`);const u=n.value.map(k=>new Date(k.date)),p=new Date(Math.min(...u)),g=[];let v=new Date(p);v.setDate(1);let b=v.getFullYear();for(let k=0;k<12;k++){const M=v.getMonth(),_=v.getFullYear();_!==b||k===0?(g.push(`${_}年${M+1}月`),b=_):g.push(`${M+1}月`),v.setMonth(M+1)}return g}),h=["日","一","二","三","四","五","六"],m=u=>["#9be9a8","#40c463","#30a14e","#216e39","#0e4429"][Math.min(u-1,4)]||"#ebedf0",f=u=>u.count?m(u.level):"rgba(235, 237, 240, 0.4)",w=async()=>{try{const p=await(await fetch("/api/messages/calendar")).json();p&&p.code===1&&p.data&&p.data.length>0?(n.value=p.data,d()):T()}catch(u){console.error("获取热力图数据失败:",u),T()}},T=()=>{const u=new Date,p=new Date(u);p.setMonth(u.getMonth()-11),p.setDate(1);const g=[];let v=new Date(p);for(;v<=u;){const b=Math.random()>.7?Math.floor(Math.random()*10)+1:0;g.push({date:S(v),count:b}),v.setDate(v.getDate()+1)}n.value=g,d()},S=u=>{const p=u.getFullYear(),g=String(u.getMonth()+1).padStart(2,"0"),v=String(u.getDate()).padStart(2,"0");return`${p}-${g}-${v}`},d=()=>{if(!n.value.length)return;const u=n.value.map(_=>new Date(_.date)),p=new Date(Math.min(...u));new Date(Math.max(...u));const g=new Date(p);g.setDate(1);const v=new Date(g);v.setMonth(g.getMonth()+11),v.setDate(v.getDate()+(6-v.getDay()));const b=new Map;n.value.forEach(_=>{_&&_.date&&_.count!==void 0&&b.set(_.date,_.count)});const k=[];let M=new Date(g);for(M.setDate(M.getDate()-M.getDay());M<=v;){const _=[];for(let x=0;x<7;x++){const y=S(M),O=b.get(y)||0;_.push({date:y,count:O,level:O?Math.min(Math.ceil(O/2),5):0}),M.setDate(M.getDate()+1)}k.push(_)}r.value=k};return Ot(()=>{w()}),(u,p)=>{const g=wr;return ue(),bt(g,{class:"mx-auto sm:max-w-2xl hover:shadow-md backdrop-blur-sm bg-black/40 shadow-lg text-white"},{default:Ue(()=>[G("div",qu,[p[2]||(p[2]=G("h3",null,"内容发布日历",-1)),G("div",Wu,[p[0]||(p[0]=G("span",null,"少",-1)),G("div",Yu,[(ue(),ge(Ct,null,jt(5,v=>G("div",{key:v,style:hn({backgroundColor:m(v)})},null,4)),64))]),p[1]||(p[1]=G("span",null,"多",-1))])]),G("div",Ku,[G("div",{class:"calendar-container",ref_key:"calendarContainer",ref:s},[G("div",Gu,[(ue(!0),ge(Ct,null,jt(c.value,(v,b)=>(ue(),ge("div",{class:"month-label",key:b},Ze(v),1))),128))]),G("div",Zu,[(ue(),ge(Ct,null,jt(h,v=>G("div",{class:"weekday-label",key:v},Ze(v),1)),64))]),G("div",Xu,[(ue(!0),ge(Ct,null,jt(r.value,(v,b)=>(ue(),ge("div",{key:b,class:"heatmap-week"},[(ue(!0),ge(Ct,null,jt(v,(k,M)=>(ue(),ge("div",{key:M,class:"heatmap-day",style:hn({backgroundColor:f(k)}),title:`${k.date}: ${k.count||0} 条内容`},null,12,Ju))),128))]))),128))])],512)])]),_:1})}}}),ed=Kt(Qu,[["__scopeId","data-v-4da783b8"]]),td={class:"tags-container mx-auto w-full sm:max-w-2xl"},nd={class:"relative"},id={class:"tags-wrapper"},rd={class:"tags-scroll"},ad=["onClick"],od={class:"tag-count"},sd=wt({__name:"TagList",props:{tags:{type:Array,default:()=>[]}},emits:["tagClick","updateTags"],setup(C,{emit:n}){const r=n,s=ae(!1),c=ae(Date.now()),h=C,m=Ae(()=>{const T=/[/?=&]/,S=/^(song|video|playlist)\?id=\d+$/,d=new Map;return h.tags.reduce((u,p)=>(d.has(p.name)||!T.test(p.name)&&!S.test(p.name)&&(d.set(p.name,!0),u.push(p)),u),[])},{}),f=T=>{r("tagClick",T)},w=async()=>{s.value||(s.value=!0,c.value=Date.now(),r("updateTags"),setTimeout(()=>{s.value=!1},1e3))};return(T,S)=>{const d=Dn;return ue(),ge("div",td,[G("div",nd,[G("div",id,[G("div",rd,[(ue(!0),ge(Ct,null,jt(m.value,u=>(ue(),ge("span",{key:u.name+c.value,class:"tag-item",onClick:p=>f(u.name)},[Xe(" #"+Ze(u.name)+" ",1),G("span",od,"("+Ze(u.count)+")",1)],8,ad))),128))])]),G("div",{class:"absolute -right-1 top-1/2 -translate-y-1/2 p-2 cursor-pointer transition-all duration-200 hover:scale-110 z-10",onClick:w,title:"刷新标签"},[fe(d,{name:"i-mdi-refresh",class:$e(["w-5 h-5 text-gray-400 hover:text-orange-500",{"animate-spin":s.value}])},null,8,["class"])]),S[0]||(S[0]=G("div",{class:"scroll-fade"},null,-1))])])}}}),ld=Kt(sd,[["__scopeId","data-v-a469a53f"]]),cd={class:"announcement-container mx-auto w-full sm:max-w-2xl px-2"},ud={class:"announcement-wrapper"},dd=["title"],fd=wt({__name:"AnnouncementBar",props:{text:{}},setup(C){return(n,r)=>{const s=Dn;return ue(),ge("div",cd,[r[0]||(r[0]=G("div",{class:"divider"},null,-1)),G("div",ud,[fe(s,{name:"i-mdi-bell-outline",class:"w-5 h-5 text-orange-500 mr-2 flex-shrink-0"}),G("div",{class:"announcement-text",title:n.text},[fe(yr,{content:n.text,enableGithubCard:!1},null,8,["content"])],8,dd)])])}}}),hd=Kt(fd,[["__scopeId","data-v-a8511e82"]]),pd={key:0,class:"loading"},md={class:"moments-header"},gd={class:"header-title"},vd={class:"profile-info"},yd=["src","alt"],bd={class:"profile-text"},wd={class:"title"},Ed={class:"description"},Sd={key:0,class:"mx-auto sm:max-w-2xl mb-4"},Cd=["data-playlist-id","data-song-id","data-position","data-theme","data-lyric","data-default-minimized","data-embed","data-autoplay"],Dd=wt({__name:"index",setup(C){const n=ae(null),r=ae(null),s=Y=>{console.log("接收到搜索结果:",Y),n.value&&n.value.handleSearchResult(Y)},c=ae(!1),h=ae(typeof window<"u"&&localStorage.getItem("contentTheme")||"light");ki("showHeatmap",c),ki("contentTheme",h),ki("toggleContentTheme",()=>{h.value=h.value==="dark"?"light":"dark",typeof window<"u"&&(localStorage.setItem("contentTheme",h.value),document.documentElement.className=h.value==="dark"?"dark":"")});const m=ae(null),f=()=>{const Y=m.value;Y?Y.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"})},w=()=>{const Y=m.value;if(Y)Y.scrollTo({top:Y.scrollHeight,behavior:"smooth"});else{const J=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight);window.scrollTo({top:J,behavior:"smooth"})}},T=ae(!1),S=ae(!0),d=ae(!1),u=()=>{const Y=m.value;if(!Y){const Q=window.scrollY||document.documentElement.scrollTop||0,K=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight);S.value=Q<=2,d.value=window.innerHeight+Q>=K-2;return}const J=Y.scrollTop,z=Y.scrollHeight;S.value=J<=2,d.value=Y.clientHeight+J>=z-2};Ot(()=>{var Y;u(),(Y=m.value)==null||Y.addEventListener("scroll",u,{passive:!0})}),Vn(()=>{var Y;(Y=m.value)==null||Y.removeEventListener("scroll",u)});const p=Ae(()=>S.value||d.value||T.value),g=Ae(()=>d.value&&!S.value?"i-heroicons-arrow-up":"i-heroicons-arrow-down"),v=()=>{d.value&&!S.value?f():w()},b=Ae(()=>h.value==="dark"),k=Ae(()=>b.value?"scroll-button bg-[rgba(36,43,50,0.85)] hover:bg-[rgba(36,43,50,0.95)] text-white shadow-[0_6px_16px_rgba(0,0,0,0.35)]":"scroll-button bg-white/95 hover:bg-white text-gray-700 ring-1 ring-gray-200 shadow-[0_4px_12px_rgba(0,0,0,0.12)]"),M=Ae(()=>b.value?"text-white w-6 h-6":"text-gray-600 w-6 h-6");ot(c,Y=>{console.log("index.vue 中热力图状态变化:",Y)}),ca({meta:[{name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"}]});const _=Wa();ot(()=>_.hash,Y=>{const J=(Y||"").split("/messages/").pop();r.value=J||null},{immediate:!0});const x=ae({siteTitle:"",subtitleText:"",avatarURL:"",username:"",description:"",backgrounds:[],cardFooterTitle:"",cardFooterSubtitle:"",pageFooterHTML:"",rssTitle:"",rssDescription:"",rssAuthorName:"",rssFaviconURL:"",enableGithubCard:!1,pwaEnabled:!0,pwaTitle:"",pwaDescription:"",pwaIconURL:"",announcementText:"",announcementEnabled:!0,commentEnabled:!1,commentSystem:"waline",commentEmailEnabled:!1,walineServerURL:"",musicEnabled:!1,musicPlaylistId:"2141128031",musicSongId:"",musicPosition:"bottom-left",musicTheme:"auto",musicLyric:!0,musicAutoplay:!1,musicDefaultMinimized:!0,musicEmbed:!1}),y=async()=>{await Qe();const Y=window.NeteaseMiniPlayer;Y&&typeof Y.init=="function"&&Y.init()},O=async()=>{if(typeof window>"u")return!1;if(window.NeteaseMiniPlayer)return!0;const Y=document.head,J=document.body,z="nmp-css";if(!document.getElementById(z)){const K=document.createElement("link");K.id=z,K.rel="stylesheet",K.href="/NeteaseMiniPlayer/netease-mini-player-v2.css",Y.appendChild(K)}const Q="nmp-js";return document.getElementById(Q)?!!window.NeteaseMiniPlayer:await new Promise(K=>{const B=document.createElement("script");B.id=Q,B.src="/NeteaseMiniPlayer/netease-mini-player-v2.js",B.defer=!0,B.onload=()=>K(!!window.NeteaseMiniPlayer),B.onerror=()=>K(!1),J.appendChild(B)})};ot(()=>x.value.musicEnabled,async Y=>{Y&&await O()&&await y()});const N=Ae(()=>({"--bg-image":`url(${j.value||x.value.backgrounds[0]})`})),F=Ae(()=>({"background-image":`url(${j.value||x.value.backgrounds[0]})`,"background-size":"cover","background-position":"center"})),R={siteTitle:"Noise的说说笔记",subtitleText:"欢迎访问，点击头像可更换封面背景！",avatarURL:"https://s2.loli.net/2025/03/24/HnSXKvibAQlosIW.png",username:"Noise",description:"执迷不悟",backgrounds:["https://s2.loli.net/2025/03/27/KJ1trnU2ksbFEYM.jpg","https://s2.loli.net/2025/03/27/MZqaLczCvwjSmW7.jpg","https://s2.loli.net/2025/03/27/UMijKXwJ9yTqSeE.jpg","https://s2.loli.net/2025/03/27/WJQIlkXvBg2afcR.jpg","https://s2.loli.net/2025/03/27/oHNQtf4spkq2iln.jpg","https://s2.loli.net/2025/03/27/PMRuX5loc6Uaimw.jpg","https://s2.loli.net/2025/03/27/U2WIslbNyTLt4rD.jpg","https://s2.loli.net/2025/03/27/xu1jZL5Og4pqT9d.jpg","https://s2.loli.net/2025/03/27/OXqwzZ6v3PVIns9.jpg","https://s2.loli.net/2025/03/27/HGuqlE6apgNywbh.jpg","https://s2.loli.net/2025/03/26/d7iyuPYA8cRqD1K.jpg","https://s2.loli.net/2025/03/27/wYy12qDMH6bGJOI.jpg","https://s2.loli.net/2025/03/27/y67m2k5xcSdTsHN.jpg"],cardFooterTitle:"Noise·说说·笔记~",cardFooterSubtitle:"note.noisework.cn",pageFooterHTML:'<div class="text-center text-xs text-gray-400 py-4">来自<a href="https://www.noisework.cn" target="_blank" rel="noopener noreferrer" class="text-orange-400 hover:text-orange-500">Noise</a> 使用<a href="https://github.com/rcy1314/echo-noise" target="_blank" rel="noopener noreferrer" class="text-orange-400 hover:text-orange-500">Ech0-Noise</a>发布</div>',rssTitle:"Noise的说说笔记",rssDescription:"一个说说笔记~",rssAuthorName:"Noise",rssFaviconURL:"/favicon.ico",enableGithubCard:!1,pwaEnabled:!0,pwaTitle:"",pwaDescription:"",pwaIconURL:"",announcementText:"欢迎访问我的说说笔记！",announcementEnabled:!0,commentEnabled:!1,commentSystem:"waline",commentEmailEnabled:!1,walineServerURL:"",musicEnabled:!1,musicPlaylistId:"2141128031",musicSongId:"",musicPosition:"bottom-left",musicTheme:"auto",musicLyric:!0,musicAutoplay:!1,musicDefaultMinimized:!0,musicEmbed:!1},I=async()=>{var Y;try{x.value={...R};const J=await Nt("frontend/config",void 0,{credentials:"include"});if(J&&J.code===1&&J.data&&J.data.frontendSettings){const z=J.data.frontendSettings,Q=["enableGithubCard","pwaEnabled","announcementEnabled","commentEnabled","commentEmailEnabled","musicEnabled","musicLyric","musicAutoplay","musicDefaultMinimized","musicEmbed"];Object.keys(x.value).forEach(B=>{if(z[B]!==null&&z[B]!==void 0)if(B==="backgrounds"&&Array.isArray(z[B]))x.value.backgrounds=[...z[B]];else if(Q.includes(B)){const Te=z[B];x.value[B]=Te===!0||Te==="true"}else{const Te=z[B];x.value[B]=typeof Te=="string"?Te.trim():Te}});const K=(z.defaultContentTheme||"light").trim();typeof window<"u"&&!localStorage.getItem("contentTheme")?(h.value=K==="light"?"light":"dark",document.documentElement.className=h.value==="dark"?"dark":""):typeof window<"u"&&(document.documentElement.className=h.value==="dark"?"dark":"")}if((Y=x.value.backgrounds)!=null&&Y.length||(x.value.backgrounds=[...R.backgrounds]),x.value.backgrounds.length>0){const z=Math.floor(Math.random()*x.value.backgrounds.length);j.value=x.value.backgrounds[z]}q.value=!0}catch(J){console.error("获取配置失败:",J),x.value={...R},q.value=!0}},j=ae(""),q=ae(!1),ne=ae(!1),ce=async Y=>{const J=z=>new Promise(Q=>{const K=new Image;K.src=z,K.onload=()=>Q(z),K.onerror=()=>Q(null)});await Promise.all(Y.map(z=>J(z)))};Vn(()=>{window.removeEventListener("frontend-config-updated",I)});const ke=async()=>{if(ne.value)return;ne.value=!0;const Y=Math.floor(Math.random()*x.value.backgrounds.length),J=x.value.backgrounds[Y];if(J===j.value){ne.value=!1;return}const z=`${J}?imageView2/2/w/10/blur/1/q/10`;j.value=z,requestAnimationFrame(()=>{const Q=new Image;Q.src=J,Q.onload=()=>{requestAnimationFrame(()=>{j.value=J,ne.value=!1})},Q.onerror=()=>{ne.value=!1}})};let Se=null;const Ee=()=>{Se&&clearTimeout(Se),Se=setTimeout(()=>me(),100)},me=()=>{const Y=(x.value.pwaTitle||x.value.siteTitle||"说说笔记").trim(),J=(x.value.rssFaviconURL||"/favicon.ico").trim(),z=x.value.pwaIconURL&&x.value.pwaIconURL.trim()!==""?x.value.pwaIconURL.trim():J.toLowerCase().endsWith(".png")?J:"/android-chrome-192x192.png",Q=(x.value.pwaDescription||x.value.description||"").trim();ca({title:Y,meta:[{key:"description",name:"description",content:Q},{key:"theme-color",name:"theme-color",content:"#000000"}],link:[{key:"icon-32",rel:"icon",type:"image/png",href:"/favicon-32x32.png",sizes:"32x32"},{key:"shortcut-icon-32",rel:"shortcut icon",type:"image/png",href:"/favicon-32x32.png",sizes:"32x32"},{key:"icon-fallback",rel:"icon",href:J},...x.value.pwaEnabled?[{key:"manifest",rel:"manifest",href:"/manifest.webmanifest"},{key:"apple-touch",rel:"apple-touch-icon",href:z,sizes:"180x180"},{key:"pwa-192",rel:"icon",href:z,sizes:"192x192"},{key:"pwa-512",rel:"icon",href:z.toLowerCase().endsWith(".png")?z:"/android-chrome-512x512.png",sizes:"512x512"}]:[]]})};ot(()=>[x.value.pwaEnabled,x.value.pwaTitle,x.value.pwaIconURL,x.value.pwaDescription,x.value.siteTitle,x.value.rssFaviconURL,x.value.description],()=>{Ee()},{immediate:!0});const Me=ae(null),oe=ae([]),le=async()=>{await H()},H=async()=>{try{const Y=await Nt("messages/tags");Y&&Y.code===1?oe.value=Y.data||[]:oe.value=[]}catch(Y){console.error("获取标签失败:",Y),oe.value=[]}};Ot(()=>{const Y=()=>I();window.addEventListener("frontend-config-updated",Y),I(),Vn(()=>window.removeEventListener("frontend-config-updated",Y))});const de=async Y=>{try{const J=encodeURIComponent(Y.trim()),z=await Nt(`messages/tags/${J}`,void 0,{credentials:"include"});if(z&&z.code===1&&Array.isArray(z.data))n.value&&n.value.handleSearchResult(z.data);else throw new Error((z==null?void 0:z.msg)||"获取标签内容失败")}catch(J){console.error("获取标签消息失败:",J),He().add({title:"获取标签消息失败",description:J.message||"服务器错误，请稍后重试",color:"red",timeout:3e3})}},Z=()=>{if(!Me.value)return;let Y=0,J=!1,z=!1;const Q=gl(()=>{if(!Me.value){clearInterval(Q);return}z||(J?(Y--,Me.value.textContent=x.value.subtitleText.slice(0,Y),Y<=0&&(z=!0,Me.value.textContent="",setTimeout(()=>{J=!1,z=!1,Y=0},1e3))):(Me.value.textContent=x.value.subtitleText.slice(0,Y+1),Y++,Y>=x.value.subtitleText.length&&(z=!0,setTimeout(()=>{J=!0,z=!1},2e3))))},100);return Q};return Ot(async()=>{try{if(q.value=!1,window.requestIdleCallback=window.requestIdleCallback||(J=>setTimeout(J,1)),await I(),x.value.musicEnabled&&await y(),ua(async()=>{await H(),await ce(x.value.backgrounds)}),x.value.backgrounds.length>0){const J=x.value.backgrounds[Math.floor(Math.random()*x.value.backgrounds.length)],z=`${J}?imageView2/2/w/100/q/30`;j.value=z,ua(async()=>{await ce(x.value.backgrounds)});const Q=new Image;Q.src=J,Q.onload=()=>{requestAnimationFrame(()=>{j.value=J,q.value=!0})},Q.onerror=()=>{q.value=!0},setTimeout(()=>{q.value||(q.value=!0)},2e3)}const Y=Z();Vn(()=>{Y&&clearInterval(Y)}),window.addEventListener("frontend-config-updated",async J=>{var z;if(await I(),((z=x.value.backgrounds)==null?void 0:z.length)>0){const Q=Math.floor(Math.random()*x.value.backgrounds.length),K=x.value.backgrounds[Q];j.value=K}})}catch(Y){console.error("初始化失败:",Y),q.value=!0}}),(Y,J)=>{const z=Rl,Q=Dn,K=_t;return ue(),ge("div",{class:"background-container",style:hn(N.value)},[q.value?Pe("",!0):(ue(),ge("div",pd,J[3]||(J[3]=[G("div",{class:"rainbow-spinner"},null,-1),G("div",{class:"loading-text"},"加载中...",-1)]))),G("div",{ref_key:"contentWrapper",ref:m,class:$e(["content-wrapper",{"gpu-accelerated":!0}])},[fe(z,{class:"container-fixed py-2 pb-4 my-4"},{default:Ue(()=>[G("div",md,[G("div",{class:"header-image",style:hn(F.value)},[G("h1",gd,Ze(x.value.siteTitle),1),G("div",{ref_key:"subtitleEl",ref:Me,class:"header-subtitle"},Ze(x.value.subtitleText),513),G("div",vd,[G("img",{class:"avatar",onClick:ke,src:x.value.avatarURL,alt:x.value.username},null,8,yd),G("div",bd,[G("div",wd,Ze(x.value.username),1),G("div",Ed,Ze(x.value.description),1)])])],4)]),c.value?(ue(),ge("div",Sd,[fe(ed)])):Pe("",!0),fe(Uc,{onSearchResult:s}),oe.value&&oe.value.length>0?(ue(),bt(ld,{key:1,tags:oe.value,onTagClick:de,onUpdateTags:le},null,8,["tags"])):Pe("",!0),x.value.announcementEnabled&&(x.value.announcementText||"").trim()!==""?(ue(),bt(hd,{key:2,text:x.value.announcementText||"欢迎访问我的说说笔记！"},null,8,["text"])):Pe("",!0),fe(Vu,{ref_key:"messageList",ref:n,class:"message-list-container","site-config":x.value,"target-message-id":r.value},null,8,["site-config","target-message-id"]),x.value.musicEnabled?(ue(),ge("div",{key:3,class:"netease-mini-player","data-playlist-id":x.value.musicPlaylistId||"","data-song-id":x.value.musicSongId||"","data-position":x.value.musicPosition||"bottom-left","data-theme":x.value.musicTheme||"auto","data-lyric":x.value.musicLyric?"true":"false","data-default-minimized":x.value.musicDefaultMinimized?"true":"false","data-embed":x.value.musicEmbed?"true":"false","data-autoplay":x.value.musicAutoplay?"true":"false"},null,8,Cd)):Pe("",!0)]),_:1}),fe(pl),fe(yo,{modelValue:Y.showSearchModal,"onUpdate:modelValue":J[0]||(J[0]=B=>Y.showSearchModal=B),onSearchResult:s},null,8,["modelValue"]),G("div",{class:"scroll-buttons",onMouseenter:J[1]||(J[1]=B=>T.value=!0),onMouseleave:J[2]||(J[2]=B=>T.value=!1)},[Ya(fe(K,{class:$e(k.value),variant:"ghost",size:"sm",onClick:v},{default:Ue(()=>[fe(Q,{class:$e(M.value),name:g.value},null,8,["class","name"])]),_:1},8,["class"]),[[Ka,p.value]])],32)],512)],4)}}});export{Dd as default};
