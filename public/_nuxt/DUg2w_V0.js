var sc=Object.defineProperty;var lc=(p,e,r)=>e in p?sc(p,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):p[e]=r;var Ti=(p,e,r)=>lc(p,typeof e!="symbol"?e+"":e,r);import{s as cc,u as uc,a as tr,r as G,b as dc,t as Cr,g as fc,o as hc,c as oi,w as Et,d as mo,e as pc,f as mc,h as Se,i as he,j as Oi,k as ea,l as gc,m as qa,n as ir,_ as Tn,p as nn,q as ae,v as J,x as ia,y as dt,z as We,A as ra,B as Wa,C as rs,D as as,E as Ht,F as vc,G as Le,H as be,I as te,J as Te,K as N,L as It,M as Qt,N as Lt,T as bc,O as yc,P as wc,Q as Er,R as Ec,S as os,U as Ze,V as Bn,W as yt,X as jr,Y as Ii,Z as ss,$ as gn,a0 as Ni,a1 as ca,a2 as ci,a3 as ls,a4 as Mr,a5 as ji,a6 as nr,a7 as $i,a8 as Gn,a9 as Pi,aa as $r,ab as kc,ac as cs,ad as ba,ae as us,af as Sc,ag as go,ah as vo}from"./0OnjJYD1.js";import{u as bo,_ as ua,a as xc}from"./D21KAGHF.js";import{_ as _c}from"./D1xjn2Vz.js";import{_ as da}from"./qD5Zp9-H.js";import{_ as Cc,a as Tc,b as Mc,N as Ac}from"./fFs5cCAR.js";import{s as Ki}from"./x_rD_Ya3.js";const Lc=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],Dc=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],Oc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",Mi=[];let Pc=class{constructor(){Ti(this,"_data",new Br);Ti(this,"_hash",new Br([...Lc]));Ti(this,"_nDataBytes",0);Ti(this,"_minBufferSize",0)}finalize(e){e&&this._append(e);const r=this._nDataBytes*8,s=this._data.sigBytes*8;return this._data.words[s>>>5]|=128<<24-s%32,this._data.words[(s+64>>>9<<4)+14]=Math.floor(r/4294967296),this._data.words[(s+64>>>9<<4)+15]=r,this._data.sigBytes=this._data.words.length*4,this._process(),this._hash}_doProcessBlock(e,r){const s=this._hash.words;let l=s[0],d=s[1],m=s[2],u=s[3],v=s[4],S=s[5],E=s[6],h=s[7];for(let f=0;f<64;f++){if(f<16)Mi[f]=e[r+f]|0;else{const T=Mi[f-15],M=(T<<25|T>>>7)^(T<<14|T>>>18)^T>>>3,y=Mi[f-2],O=(y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10;Mi[f]=M+Mi[f-7]+O+Mi[f-16]}const g=v&S^~v&E,b=l&d^l&m^d&m,k=(l<<30|l>>>2)^(l<<19|l>>>13)^(l<<10|l>>>22),w=(v<<26|v>>>6)^(v<<21|v>>>11)^(v<<7|v>>>25),_=h+w+g+Dc[f]+Mi[f],C=k+b;h=E,E=S,S=v,v=u+_|0,u=m,m=d,d=l,l=_+C|0}s[0]=s[0]+l|0,s[1]=s[1]+d|0,s[2]=s[2]+m|0,s[3]=s[3]+u|0,s[4]=s[4]+v|0,s[5]=s[5]+S|0,s[6]=s[6]+E|0,s[7]=s[7]+h|0}_append(e){typeof e=="string"&&(e=Br.fromUtf8(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes}_process(e){let r,s=this._data.sigBytes/64;e?s=Math.ceil(s):s=Math.max((s|0)-this._minBufferSize,0);const l=s*16,d=Math.min(l*4,this._data.sigBytes);if(l){for(let m=0;m<l;m+=16)this._doProcessBlock(this._data.words,m);r=this._data.words.splice(0,l),this._data.sigBytes-=d}return new Br(r,d)}},Br=class ds{constructor(e,r){Ti(this,"words");Ti(this,"sigBytes");e=this.words=e||[],this.sigBytes=r===void 0?e.length*4:r}static fromUtf8(e){const r=unescape(encodeURIComponent(e)),s=r.length,l=[];for(let d=0;d<s;d++)l[d>>>2]|=(r.charCodeAt(d)&255)<<24-d%4*8;return new ds(l,s)}toBase64(){const e=[];for(let r=0;r<this.sigBytes;r+=3){const s=this.words[r>>>2]>>>24-r%4*8&255,l=this.words[r+1>>>2]>>>24-(r+1)%4*8&255,d=this.words[r+2>>>2]>>>24-(r+2)%4*8&255,m=s<<16|l<<8|d;for(let u=0;u<4&&r*8+u*6<this.sigBytes*8;u++)e.push(Oc.charAt(m>>>6*(3-u)&63))}return e.join("")}concat(e){if(this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4),this.sigBytes%4)for(let r=0;r<e.sigBytes;r++){const s=e.words[r>>>2]>>>24-r%4*8&255;this.words[this.sigBytes+r>>>2]|=s<<24-(this.sigBytes+r)%4*8}else for(let r=0;r<e.sigBytes;r+=4)this.words[this.sigBytes+r>>>2]=e.words[r>>>2];this.sigBytes+=e.sigBytes}};function Rc(p){return new Pc().finalize(p).toBase64()}function Ic(p){return Rc(cc(p))}const Hc=p=>p==="defer"||p===!1;function Nc(...p){var k;const e=typeof p[p.length-1]=="string"?p.pop():void 0;typeof p[0]!="string"&&p.unshift(e);let[r,s,l={}]=p;if(typeof r!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof s!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");const d=uc(),m=s,u=()=>tr.value,v=()=>d.isHydrating?d.payload.data[r]:d.static.data[r];l.server??(l.server=!0),l.default??(l.default=u),l.getCachedData??(l.getCachedData=v),l.lazy??(l.lazy=!1),l.immediate??(l.immediate=!0),l.deep??(l.deep=tr.deep),l.dedupe??(l.dedupe="cancel");const S=l.getCachedData(r,d),E=S!=null;if(!d._asyncData[r]||!l.immediate){(k=d.payload._errors)[r]??(k[r]=tr.errorValue);const w=l.deep?G:dc;d._asyncData[r]={data:w(E?S:l.default()),pending:G(!E),error:Cr(d.payload._errors,r),status:G("idle"),_default:l.default}}const h={...d._asyncData[r]};delete h._default,h.refresh=h.execute=(w={})=>{if(d._asyncDataPromises[r]){if(Hc(w.dedupe??l.dedupe))return d._asyncDataPromises[r];d._asyncDataPromises[r].cancelled=!0}if(w._initial||d.isHydrating&&w._initial!==!1){const C=w._initial?S:l.getCachedData(r,d);if(C!=null)return Promise.resolve(C)}h.pending.value=!0,h.status.value="pending";const _=new Promise((C,T)=>{try{C(m(d))}catch(M){T(M)}}).then(async C=>{if(_.cancelled)return d._asyncDataPromises[r];let T=C;l.transform&&(T=await l.transform(C)),l.pick&&(T=$c(T,l.pick)),d.payload.data[r]=T,h.data.value=T,h.error.value=tr.errorValue,h.status.value="success"}).catch(C=>{if(_.cancelled)return d._asyncDataPromises[r];h.error.value=mc(C),h.data.value=Se(l.default()),h.status.value="error"}).finally(()=>{_.cancelled||(h.pending.value=!1,delete d._asyncDataPromises[r])});return d._asyncDataPromises[r]=_,d._asyncDataPromises[r]},h.clear=()=>jc(d,r);const f=()=>h.refresh({_initial:!0}),g=l.server!==!1&&d.payload.serverRendered;{const w=fc();if(w&&g&&l.immediate&&!w.sp&&(w.sp=[]),w&&!w._nuxtOnBeforeMountCbs){w._nuxtOnBeforeMountCbs=[];const T=w._nuxtOnBeforeMountCbs;hc(()=>{T.forEach(M=>{M()}),T.splice(0,T.length)}),oi(()=>T.splice(0,T.length))}g&&d.isHydrating&&(h.error.value||S!=null)?(h.pending.value=!1,h.status.value=h.error.value?"error":"success"):w&&(d.payload.serverRendered&&d.isHydrating||l.lazy)&&l.immediate?w._nuxtOnBeforeMountCbs.push(f):l.immediate&&f();const _=pc();if(l.watch){const T=Et(l.watch,()=>h.refresh());_&&mo(T)}const C=d.hook("app:data:refresh",async T=>{(!T||T.includes(r))&&await h.refresh()});_&&mo(C)}const b=Promise.resolve(d._asyncDataPromises[r]).then(()=>h);return Object.assign(b,h),b}function jc(p,e){e in p.payload.data&&(p.payload.data[e]=void 0),e in p.payload._errors&&(p.payload._errors[e]=tr.errorValue),p._asyncData[e]&&(p._asyncData[e].data.value=void 0,p._asyncData[e].error.value=tr.errorValue,p._asyncData[e].pending.value=!1,p._asyncData[e].status.value="idle"),e in p._asyncDataPromises&&(p._asyncDataPromises[e]&&(p._asyncDataPromises[e].cancelled=!0),p._asyncDataPromises[e]=void 0)}function $c(p,e){const r={};for(const s of e)r[s]=p[s];return r}function Bc(p,e,r){const[s={},l]=typeof e=="string"?[{},e]:[e,r],d=he(()=>Oi(p)),m=s.key||Ic([l,typeof d.value=="string"?d.value:"",...Uc(s)]);if(!m||typeof m!="string")throw new TypeError("[nuxt] [useFetch] key must be a string: "+m);const u=m===l?"$f"+m:m;if(!s.baseURL&&typeof d.value=="string"&&d.value[0]==="/"&&d.value[1]==="/")throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:v,lazy:S,default:E,transform:h,pick:f,watch:g,immediate:b,getCachedData:k,deep:w,dedupe:_,...C}=s,T=ea({...gc,...C,cache:typeof s.cache=="boolean"?void 0:s.cache}),M={server:v,lazy:S,default:E,transform:h,pick:f,immediate:b,getCachedData:k,deep:w,dedupe:_,watch:g===!1?[]:[T,d,...g||[]]};let y;return Nc(u,()=>{var j;(j=y==null?void 0:y.abort)==null||j.call(y,new DOMException("Request aborted as another request to the same endpoint was initiated.","AbortError")),y=typeof AbortController<"u"?new AbortController:{};const B=Oi(s.timeout);let V;return B&&(V=setTimeout(()=>y.abort(new DOMException("Request aborted due to timeout.","AbortError")),B),y.signal.onabort=()=>clearTimeout(V)),(s.$fetch||globalThis.$fetch)(d.value,{signal:y.signal,...T}).finally(()=>{clearTimeout(V)})},M)}function Uc(p){var r;const e=[((r=Oi(p.method))==null?void 0:r.toUpperCase())||"GET",Oi(p.baseURL)];for(const s of[p.params||p.query]){const l=Oi(s);if(!l)continue;const d={};for(const[m,u]of Object.entries(l))d[Oi(m)]=Oi(u);e.push(d)}return e}const zc={base:"invisible before:visible before:block before:rotate-45 before:z-[-1] before:w-2 before:h-2",ring:"before:ring-1 before:ring-gray-200 dark:before:ring-gray-800",rounded:"before:rounded-sm",background:"before:bg-gray-200 dark:before:bg-gray-800",shadow:"before:shadow",placement:"group-data-[popper-placement*='right']:-left-1 group-data-[popper-placement*='left']:-right-1 group-data-[popper-placement*='top']:-bottom-1 group-data-[popper-placement*='bottom']:-top-1"},Fc={base:"inline-flex items-center justify-center text-gray-900 dark:text-white",padding:"px-1",size:{xs:"h-4 min-w-[16px] text-[10px]",sm:"h-5 min-w-[20px] text-[11px]",md:"h-6 min-w-[24px] text-[12px]"},rounded:"rounded",font:"font-medium font-sans",background:"bg-gray-100 dark:bg-gray-800",ring:"ring-1 ring-gray-300 dark:ring-gray-700 ring-inset",default:{size:"sm"}},Vc={base:"mx-auto",padding:"px-4 sm:px-6 lg:px-8",constrained:"max-w-7xl"},qc={wrapper:"relative inline-flex",container:"z-20 group",width:"max-w-xs",background:"bg-white dark:bg-gray-900",color:"text-gray-900 dark:text-white",shadow:"shadow",rounded:"rounded",ring:"ring-1 ring-gray-200 dark:ring-gray-800",base:"[@media(pointer:coarse)]:hidden h-6 px-2 py-1 text-xs font-normal truncate relative",shortcuts:"hidden md:inline-flex flex-shrink-0 gap-0.5",middot:"mx-1 text-gray-700 dark:text-gray-200",transition:{enterActiveClass:"transition ease-out duration-200",enterFromClass:"opacity-0 translate-y-1",enterToClass:"opacity-100 translate-y-0",leaveActiveClass:"transition ease-in duration-150",leaveFromClass:"opacity-100 translate-y-0",leaveToClass:"opacity-0 translate-y-1"},popper:{strategy:"fixed"},default:{openDelay:0,closeDelay:0},arrow:{...zc,base:"[@media(pointer:coarse)]:hidden invisible before:visible before:block before:rotate-45 before:z-[-1] before:w-2 before:h-2"}},ya=qa(ir.ui.strategy,ir.ui.kbd,Fc),Wc=nn({inheritAttrs:!1,props:{value:{type:String,default:null},size:{type:String,default:()=>ya.default.size,validator(p){return Object.keys(ya.size).includes(p)}},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(p){const{ui:e,attrs:r}=Wa("kbd",Cr(p,"ui"),ya),s=he(()=>rs(as(e.value.base,e.value.size[p.size],e.value.padding,e.value.rounded,e.value.font,e.value.background,e.value.ring),p.class));return{ui:e,attrs:r,kbdClass:s}}});function Yc(p,e,r,s,l,d){return J(),ae("kbd",ra({class:p.kbdClass},p.attrs),[ia(p.$slots,"default",{},()=>[dt(We(p.value),1)])],16)}const fs=Tn(Wc,[["render",Yc]]);function Cn(p){if(p==null)return window;if(p.toString()!=="[object Window]"){var e=p.ownerDocument;return e&&e.defaultView||window}return p}function zi(p){var e=Cn(p).Element;return p instanceof e||p instanceof Element}function In(p){var e=Cn(p).HTMLElement;return p instanceof e||p instanceof HTMLElement}function Ya(p){if(typeof ShadowRoot>"u")return!1;var e=Cn(p).ShadowRoot;return p instanceof e||p instanceof ShadowRoot}var Bi=Math.max,aa=Math.min,rr=Math.round;function Ba(){var p=navigator.userAgentData;return p!=null&&p.brands&&Array.isArray(p.brands)?p.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function hs(){return!/^((?!chrome|android).)*safari/i.test(Ba())}function ar(p,e,r){e===void 0&&(e=!1),r===void 0&&(r=!1);var s=p.getBoundingClientRect(),l=1,d=1;e&&In(p)&&(l=p.offsetWidth>0&&rr(s.width)/p.offsetWidth||1,d=p.offsetHeight>0&&rr(s.height)/p.offsetHeight||1);var m=zi(p)?Cn(p):window,u=m.visualViewport,v=!hs()&&r,S=(s.left+(v&&u?u.offsetLeft:0))/l,E=(s.top+(v&&u?u.offsetTop:0))/d,h=s.width/l,f=s.height/d;return{width:h,height:f,top:E,right:S+h,bottom:E+f,left:S,x:S,y:E}}function Ka(p){var e=Cn(p),r=e.pageXOffset,s=e.pageYOffset;return{scrollLeft:r,scrollTop:s}}function Kc(p){return{scrollLeft:p.scrollLeft,scrollTop:p.scrollTop}}function Gc(p){return p===Cn(p)||!In(p)?Ka(p):Kc(p)}function Qn(p){return p?(p.nodeName||"").toLowerCase():null}function Ei(p){return((zi(p)?p.ownerDocument:p.document)||window.document).documentElement}function Ga(p){return ar(Ei(p)).left+Ka(p).scrollLeft}function li(p){return Cn(p).getComputedStyle(p)}function Xa(p){var e=li(p),r=e.overflow,s=e.overflowX,l=e.overflowY;return/auto|scroll|overlay|hidden/.test(r+l+s)}function Xc(p){var e=p.getBoundingClientRect(),r=rr(e.width)/p.offsetWidth||1,s=rr(e.height)/p.offsetHeight||1;return r!==1||s!==1}function Zc(p,e,r){r===void 0&&(r=!1);var s=In(e),l=In(e)&&Xc(e),d=Ei(e),m=ar(p,l,r),u={scrollLeft:0,scrollTop:0},v={x:0,y:0};return(s||!s&&!r)&&((Qn(e)!=="body"||Xa(d))&&(u=Gc(e)),In(e)?(v=ar(e,!0),v.x+=e.clientLeft,v.y+=e.clientTop):d&&(v.x=Ga(d))),{x:m.left+u.scrollLeft-v.x,y:m.top+u.scrollTop-v.y,width:m.width,height:m.height}}function Za(p){var e=ar(p),r=p.offsetWidth,s=p.offsetHeight;return Math.abs(e.width-r)<=1&&(r=e.width),Math.abs(e.height-s)<=1&&(s=e.height),{x:p.offsetLeft,y:p.offsetTop,width:r,height:s}}function fa(p){return Qn(p)==="html"?p:p.assignedSlot||p.parentNode||(Ya(p)?p.host:null)||Ei(p)}function ps(p){return["html","body","#document"].indexOf(Qn(p))>=0?p.ownerDocument.body:In(p)&&Xa(p)?p:ps(fa(p))}function kr(p,e){var r;e===void 0&&(e=[]);var s=ps(p),l=s===((r=p.ownerDocument)==null?void 0:r.body),d=Cn(s),m=l?[d].concat(d.visualViewport||[],Xa(s)?s:[]):s,u=e.concat(m);return l?u:u.concat(kr(fa(m)))}function Jc(p){return["table","td","th"].indexOf(Qn(p))>=0}function yo(p){return!In(p)||li(p).position==="fixed"?null:p.offsetParent}function Qc(p){var e=/firefox/i.test(Ba()),r=/Trident/i.test(Ba());if(r&&In(p)){var s=li(p);if(s.position==="fixed")return null}var l=fa(p);for(Ya(l)&&(l=l.host);In(l)&&["html","body"].indexOf(Qn(l))<0;){var d=li(l);if(d.transform!=="none"||d.perspective!=="none"||d.contain==="paint"||["transform","perspective"].indexOf(d.willChange)!==-1||e&&d.willChange==="filter"||e&&d.filter&&d.filter!=="none")return l;l=l.parentNode}return null}function Ar(p){for(var e=Cn(p),r=yo(p);r&&Jc(r)&&li(r).position==="static";)r=yo(r);return r&&(Qn(r)==="html"||Qn(r)==="body"&&li(r).position==="static")?e:r||Qc(p)||e}var xn="top",Un="bottom",zn="right",_n="left",Ja="auto",Lr=[xn,Un,zn,_n],or="start",Tr="end",eu="clippingParents",ms="viewport",vr="popper",tu="reference",wo=Lr.reduce(function(p,e){return p.concat([e+"-"+or,e+"-"+Tr])},[]),gs=[].concat(Lr,[Ja]).reduce(function(p,e){return p.concat([e,e+"-"+or,e+"-"+Tr])},[]),nu="beforeRead",iu="read",ru="afterRead",au="beforeMain",ou="main",su="afterMain",lu="beforeWrite",cu="write",uu="afterWrite",du=[nu,iu,ru,au,ou,su,lu,cu,uu];function fu(p){var e=new Map,r=new Set,s=[];p.forEach(function(d){e.set(d.name,d)});function l(d){r.add(d.name);var m=[].concat(d.requires||[],d.requiresIfExists||[]);m.forEach(function(u){if(!r.has(u)){var v=e.get(u);v&&l(v)}}),s.push(d)}return p.forEach(function(d){r.has(d.name)||l(d)}),s}function hu(p){var e=fu(p);return du.reduce(function(r,s){return r.concat(e.filter(function(l){return l.phase===s}))},[])}function pu(p){var e;return function(){return e||(e=new Promise(function(r){Promise.resolve().then(function(){e=void 0,r(p())})})),e}}function mu(p){var e=p.reduce(function(r,s){var l=r[s.name];return r[s.name]=l?Object.assign({},l,s,{options:Object.assign({},l.options,s.options),data:Object.assign({},l.data,s.data)}):s,r},{});return Object.keys(e).map(function(r){return e[r]})}function gu(p,e){var r=Cn(p),s=Ei(p),l=r.visualViewport,d=s.clientWidth,m=s.clientHeight,u=0,v=0;if(l){d=l.width,m=l.height;var S=hs();(S||!S&&e==="fixed")&&(u=l.offsetLeft,v=l.offsetTop)}return{width:d,height:m,x:u+Ga(p),y:v}}function vu(p){var e,r=Ei(p),s=Ka(p),l=(e=p.ownerDocument)==null?void 0:e.body,d=Bi(r.scrollWidth,r.clientWidth,l?l.scrollWidth:0,l?l.clientWidth:0),m=Bi(r.scrollHeight,r.clientHeight,l?l.scrollHeight:0,l?l.clientHeight:0),u=-s.scrollLeft+Ga(p),v=-s.scrollTop;return li(l||r).direction==="rtl"&&(u+=Bi(r.clientWidth,l?l.clientWidth:0)-d),{width:d,height:m,x:u,y:v}}function vs(p,e){var r=e.getRootNode&&e.getRootNode();if(p.contains(e))return!0;if(r&&Ya(r)){var s=e;do{if(s&&p.isSameNode(s))return!0;s=s.parentNode||s.host}while(s)}return!1}function Ua(p){return Object.assign({},p,{left:p.x,top:p.y,right:p.x+p.width,bottom:p.y+p.height})}function bu(p,e){var r=ar(p,!1,e==="fixed");return r.top=r.top+p.clientTop,r.left=r.left+p.clientLeft,r.bottom=r.top+p.clientHeight,r.right=r.left+p.clientWidth,r.width=p.clientWidth,r.height=p.clientHeight,r.x=r.left,r.y=r.top,r}function Eo(p,e,r){return e===ms?Ua(gu(p,r)):zi(e)?bu(e,r):Ua(vu(Ei(p)))}function yu(p){var e=kr(fa(p)),r=["absolute","fixed"].indexOf(li(p).position)>=0,s=r&&In(p)?Ar(p):p;return zi(s)?e.filter(function(l){return zi(l)&&vs(l,s)&&Qn(l)!=="body"}):[]}function wu(p,e,r,s){var l=e==="clippingParents"?yu(p):[].concat(e),d=[].concat(l,[r]),m=d[0],u=d.reduce(function(v,S){var E=Eo(p,S,s);return v.top=Bi(E.top,v.top),v.right=aa(E.right,v.right),v.bottom=aa(E.bottom,v.bottom),v.left=Bi(E.left,v.left),v},Eo(p,m,s));return u.width=u.right-u.left,u.height=u.bottom-u.top,u.x=u.left,u.y=u.top,u}function Jn(p){return p.split("-")[0]}function sr(p){return p.split("-")[1]}function Qa(p){return["top","bottom"].indexOf(p)>=0?"x":"y"}function bs(p){var e=p.reference,r=p.element,s=p.placement,l=s?Jn(s):null,d=s?sr(s):null,m=e.x+e.width/2-r.width/2,u=e.y+e.height/2-r.height/2,v;switch(l){case xn:v={x:m,y:e.y-r.height};break;case Un:v={x:m,y:e.y+e.height};break;case zn:v={x:e.x+e.width,y:u};break;case _n:v={x:e.x-r.width,y:u};break;default:v={x:e.x,y:e.y}}var S=l?Qa(l):null;if(S!=null){var E=S==="y"?"height":"width";switch(d){case or:v[S]=v[S]-(e[E]/2-r[E]/2);break;case Tr:v[S]=v[S]+(e[E]/2-r[E]/2);break}}return v}function ys(){return{top:0,right:0,bottom:0,left:0}}function ws(p){return Object.assign({},ys(),p)}function Es(p,e){return e.reduce(function(r,s){return r[s]=p,r},{})}function eo(p,e){e===void 0&&(e={});var r=e,s=r.placement,l=s===void 0?p.placement:s,d=r.strategy,m=d===void 0?p.strategy:d,u=r.boundary,v=u===void 0?eu:u,S=r.rootBoundary,E=S===void 0?ms:S,h=r.elementContext,f=h===void 0?vr:h,g=r.altBoundary,b=g===void 0?!1:g,k=r.padding,w=k===void 0?0:k,_=ws(typeof w!="number"?w:Es(w,Lr)),C=f===vr?tu:vr,T=p.rects.popper,M=p.elements[b?C:f],y=wu(zi(M)?M:M.contextElement||Ei(p.elements.popper),v,E,m),O=ar(p.elements.reference),B=bs({reference:O,element:T,placement:l}),V=Ua(Object.assign({},T,B)),I=f===vr?V:O,j={top:y.top-I.top+_.top,bottom:I.bottom-y.bottom+_.bottom,left:y.left-I.left+_.left,right:I.right-y.right+_.right},z=p.modifiersData.offset;if(f===vr&&z){var F=z[l];Object.keys(j).forEach(function(le){var de=[zn,Un].indexOf(le)>=0?1:-1,Re=[xn,Un].indexOf(le)>=0?"y":"x";j[le]+=F[Re]*de})}return j}var ko={placement:"bottom",modifiers:[],strategy:"absolute"};function So(){for(var p=arguments.length,e=new Array(p),r=0;r<p;r++)e[r]=arguments[r];return!e.some(function(s){return!(s&&typeof s.getBoundingClientRect=="function")})}function Eu(p){p===void 0&&(p={});var e=p,r=e.defaultModifiers,s=r===void 0?[]:r,l=e.defaultOptions,d=l===void 0?ko:l;return function(u,v,S){S===void 0&&(S=d);var E={placement:"bottom",orderedModifiers:[],options:Object.assign({},ko,d),modifiersData:{},elements:{reference:u,popper:v},attributes:{},styles:{}},h=[],f=!1,g={state:E,setOptions:function(_){var C=typeof _=="function"?_(E.options):_;k(),E.options=Object.assign({},d,E.options,C),E.scrollParents={reference:zi(u)?kr(u):u.contextElement?kr(u.contextElement):[],popper:kr(v)};var T=hu(mu([].concat(s,E.options.modifiers)));return E.orderedModifiers=T.filter(function(M){return M.enabled}),b(),g.update()},forceUpdate:function(){if(!f){var _=E.elements,C=_.reference,T=_.popper;if(So(C,T)){E.rects={reference:Zc(C,Ar(T),E.options.strategy==="fixed"),popper:Za(T)},E.reset=!1,E.placement=E.options.placement,E.orderedModifiers.forEach(function(j){return E.modifiersData[j.name]=Object.assign({},j.data)});for(var M=0;M<E.orderedModifiers.length;M++){if(E.reset===!0){E.reset=!1,M=-1;continue}var y=E.orderedModifiers[M],O=y.fn,B=y.options,V=B===void 0?{}:B,I=y.name;typeof O=="function"&&(E=O({state:E,options:V,name:I,instance:g})||E)}}}},update:pu(function(){return new Promise(function(w){g.forceUpdate(),w(E)})}),destroy:function(){k(),f=!0}};if(!So(u,v))return g;g.setOptions(S).then(function(w){!f&&S.onFirstUpdate&&S.onFirstUpdate(w)});function b(){E.orderedModifiers.forEach(function(w){var _=w.name,C=w.options,T=C===void 0?{}:C,M=w.effect;if(typeof M=="function"){var y=M({state:E,name:_,instance:g,options:T}),O=function(){};h.push(y||O)}})}function k(){h.forEach(function(w){return w()}),h=[]}return g}}var Ur={passive:!0};function ku(p){var e=p.state,r=p.instance,s=p.options,l=s.scroll,d=l===void 0?!0:l,m=s.resize,u=m===void 0?!0:m,v=Cn(e.elements.popper),S=[].concat(e.scrollParents.reference,e.scrollParents.popper);return d&&S.forEach(function(E){E.addEventListener("scroll",r.update,Ur)}),u&&v.addEventListener("resize",r.update,Ur),function(){d&&S.forEach(function(E){E.removeEventListener("scroll",r.update,Ur)}),u&&v.removeEventListener("resize",r.update,Ur)}}const ks={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:ku,data:{}};function Su(p){var e=p.state,r=p.name;e.modifiersData[r]=bs({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const xu={name:"popperOffsets",enabled:!0,phase:"read",fn:Su,data:{}};var _u={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Cu(p,e){var r=p.x,s=p.y,l=e.devicePixelRatio||1;return{x:rr(r*l)/l||0,y:rr(s*l)/l||0}}function xo(p){var e,r=p.popper,s=p.popperRect,l=p.placement,d=p.variation,m=p.offsets,u=p.position,v=p.gpuAcceleration,S=p.adaptive,E=p.roundOffsets,h=p.isFixed,f=m.x,g=f===void 0?0:f,b=m.y,k=b===void 0?0:b,w=typeof E=="function"?E({x:g,y:k}):{x:g,y:k};g=w.x,k=w.y;var _=m.hasOwnProperty("x"),C=m.hasOwnProperty("y"),T=_n,M=xn,y=window;if(S){var O=Ar(r),B="clientHeight",V="clientWidth";if(O===Cn(r)&&(O=Ei(r),li(O).position!=="static"&&u==="absolute"&&(B="scrollHeight",V="scrollWidth")),O=O,l===xn||(l===_n||l===zn)&&d===Tr){M=Un;var I=h&&O===y&&y.visualViewport?y.visualViewport.height:O[B];k-=I-s.height,k*=v?1:-1}if(l===_n||(l===xn||l===Un)&&d===Tr){T=zn;var j=h&&O===y&&y.visualViewport?y.visualViewport.width:O[V];g-=j-s.width,g*=v?1:-1}}var z=Object.assign({position:u},S&&_u),F=E===!0?Cu({x:g,y:k},Cn(r)):{x:g,y:k};if(g=F.x,k=F.y,v){var le;return Object.assign({},z,(le={},le[M]=C?"0":"",le[T]=_?"0":"",le.transform=(y.devicePixelRatio||1)<=1?"translate("+g+"px, "+k+"px)":"translate3d("+g+"px, "+k+"px, 0)",le))}return Object.assign({},z,(e={},e[M]=C?k+"px":"",e[T]=_?g+"px":"",e.transform="",e))}function Tu(p){var e=p.state,r=p.options,s=r.gpuAcceleration,l=s===void 0?!0:s,d=r.adaptive,m=d===void 0?!0:d,u=r.roundOffsets,v=u===void 0?!0:u,S={placement:Jn(e.placement),variation:sr(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:l,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,xo(Object.assign({},S,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:m,roundOffsets:v})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,xo(Object.assign({},S,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:v})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Ss={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Tu,data:{}};function Mu(p){var e=p.state;Object.keys(e.elements).forEach(function(r){var s=e.styles[r]||{},l=e.attributes[r]||{},d=e.elements[r];!In(d)||!Qn(d)||(Object.assign(d.style,s),Object.keys(l).forEach(function(m){var u=l[m];u===!1?d.removeAttribute(m):d.setAttribute(m,u===!0?"":u)}))})}function Au(p){var e=p.state,r={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,r.popper),e.styles=r,e.elements.arrow&&Object.assign(e.elements.arrow.style,r.arrow),function(){Object.keys(e.elements).forEach(function(s){var l=e.elements[s],d=e.attributes[s]||{},m=Object.keys(e.styles.hasOwnProperty(s)?e.styles[s]:r[s]),u=m.reduce(function(v,S){return v[S]="",v},{});!In(l)||!Qn(l)||(Object.assign(l.style,u),Object.keys(d).forEach(function(v){l.removeAttribute(v)}))})}}const Lu={name:"applyStyles",enabled:!0,phase:"write",fn:Mu,effect:Au,requires:["computeStyles"]};var Du=[ks,xu,Ss,Lu],Ou={left:"right",right:"left",bottom:"top",top:"bottom"};function ta(p){return p.replace(/left|right|bottom|top/g,function(e){return Ou[e]})}var Pu={start:"end",end:"start"};function _o(p){return p.replace(/start|end/g,function(e){return Pu[e]})}function Ru(p,e){e===void 0&&(e={});var r=e,s=r.placement,l=r.boundary,d=r.rootBoundary,m=r.padding,u=r.flipVariations,v=r.allowedAutoPlacements,S=v===void 0?gs:v,E=sr(s),h=E?u?wo:wo.filter(function(b){return sr(b)===E}):Lr,f=h.filter(function(b){return S.indexOf(b)>=0});f.length===0&&(f=h);var g=f.reduce(function(b,k){return b[k]=eo(p,{placement:k,boundary:l,rootBoundary:d,padding:m})[Jn(k)],b},{});return Object.keys(g).sort(function(b,k){return g[b]-g[k]})}function Iu(p){if(Jn(p)===Ja)return[];var e=ta(p);return[_o(p),e,_o(e)]}function Hu(p){var e=p.state,r=p.options,s=p.name;if(!e.modifiersData[s]._skip){for(var l=r.mainAxis,d=l===void 0?!0:l,m=r.altAxis,u=m===void 0?!0:m,v=r.fallbackPlacements,S=r.padding,E=r.boundary,h=r.rootBoundary,f=r.altBoundary,g=r.flipVariations,b=g===void 0?!0:g,k=r.allowedAutoPlacements,w=e.options.placement,_=Jn(w),C=_===w,T=v||(C||!b?[ta(w)]:Iu(w)),M=[w].concat(T).reduce(function(re,Ae){return re.concat(Jn(Ae)===Ja?Ru(e,{placement:Ae,boundary:E,rootBoundary:h,padding:S,flipVariations:b,allowedAutoPlacements:k}):Ae)},[]),y=e.rects.reference,O=e.rects.popper,B=new Map,V=!0,I=M[0],j=0;j<M.length;j++){var z=M[j],F=Jn(z),le=sr(z)===or,de=[xn,Un].indexOf(F)>=0,Re=de?"width":"height",Be=eo(e,{placement:z,boundary:E,rootBoundary:h,altBoundary:f,padding:S}),Ce=de?le?zn:_n:le?Un:xn;y[Re]>O[Re]&&(Ce=ta(Ce));var De=ta(Ce),Ie=[];if(d&&Ie.push(Be[F]<=0),u&&Ie.push(Be[Ce]<=0,Be[De]<=0),Ie.every(function(re){return re})){I=z,V=!1;break}B.set(z,Ie)}if(V)for(var Je=b?3:1,tt=function(Ae){var Ke=M.find(function(X){var we=B.get(X);if(we)return we.slice(0,Ae).every(function(se){return se})});if(Ke)return I=Ke,"break"},U=Je;U>0;U--){var oe=tt(U);if(oe==="break")break}e.placement!==I&&(e.modifiersData[s]._skip=!0,e.placement=I,e.reset=!0)}}const Nu={name:"flip",enabled:!0,phase:"main",fn:Hu,requiresIfExists:["offset"],data:{_skip:!1}};function ju(p,e,r){var s=Jn(p),l=[_n,xn].indexOf(s)>=0?-1:1,d=typeof r=="function"?r(Object.assign({},e,{placement:p})):r,m=d[0],u=d[1];return m=m||0,u=(u||0)*l,[_n,zn].indexOf(s)>=0?{x:u,y:m}:{x:m,y:u}}function $u(p){var e=p.state,r=p.options,s=p.name,l=r.offset,d=l===void 0?[0,0]:l,m=gs.reduce(function(E,h){return E[h]=ju(h,e.rects,d),E},{}),u=m[e.placement],v=u.x,S=u.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=v,e.modifiersData.popperOffsets.y+=S),e.modifiersData[s]=m}const Bu={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:$u};function Uu(p){return p==="x"?"y":"x"}function Sr(p,e,r){return Bi(p,aa(e,r))}function zu(p,e,r){var s=Sr(p,e,r);return s>r?r:s}function Fu(p){var e=p.state,r=p.options,s=p.name,l=r.mainAxis,d=l===void 0?!0:l,m=r.altAxis,u=m===void 0?!1:m,v=r.boundary,S=r.rootBoundary,E=r.altBoundary,h=r.padding,f=r.tether,g=f===void 0?!0:f,b=r.tetherOffset,k=b===void 0?0:b,w=eo(e,{boundary:v,rootBoundary:S,padding:h,altBoundary:E}),_=Jn(e.placement),C=sr(e.placement),T=!C,M=Qa(_),y=Uu(M),O=e.modifiersData.popperOffsets,B=e.rects.reference,V=e.rects.popper,I=typeof k=="function"?k(Object.assign({},e.rects,{placement:e.placement})):k,j=typeof I=="number"?{mainAxis:I,altAxis:I}:Object.assign({mainAxis:0,altAxis:0},I),z=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,F={x:0,y:0};if(O){if(d){var le,de=M==="y"?xn:_n,Re=M==="y"?Un:zn,Be=M==="y"?"height":"width",Ce=O[M],De=Ce+w[de],Ie=Ce-w[Re],Je=g?-V[Be]/2:0,tt=C===or?B[Be]:V[Be],U=C===or?-V[Be]:-B[Be],oe=e.elements.arrow,re=g&&oe?Za(oe):{width:0,height:0},Ae=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:ys(),Ke=Ae[de],X=Ae[Re],we=Sr(0,B[Be],re[Be]),se=T?B[Be]/2-Je-we-Ke-j.mainAxis:tt-we-Ke-j.mainAxis,ee=T?-B[Be]/2+Je+we+X+j.mainAxis:U+we+X+j.mainAxis,He=e.elements.arrow&&Ar(e.elements.arrow),ve=He?M==="y"?He.clientTop||0:He.clientLeft||0:0,st=(le=z==null?void 0:z[M])!=null?le:0,Ve=Ce+se-st-ve,Qe=Ce+ee-st,Oe=Sr(g?aa(De,Ve):De,Ce,g?Bi(Ie,Qe):Ie);O[M]=Oe,F[M]=Oe-Ce}if(u){var it,lt=M==="x"?xn:_n,ft=M==="x"?Un:zn,ht=O[y],Dt=y==="y"?"height":"width",Mn=ht+w[lt],rn=ht-w[ft],an=[xn,_n].indexOf(_)!==-1,rt=(it=z==null?void 0:z[y])!=null?it:0,Kt=an?Mn:ht-B[Dt]-V[Dt]-rt+j.altAxis,dn=an?ht+B[Dt]+V[Dt]-rt-j.altAxis:rn,on=g&&an?zu(Kt,ht,dn):Sr(g?Kt:Mn,ht,g?dn:rn);O[y]=on,F[y]=on-ht}e.modifiersData[s]=F}}const Vu={name:"preventOverflow",enabled:!0,phase:"main",fn:Fu,requiresIfExists:["offset"]};var qu=function(e,r){return e=typeof e=="function"?e(Object.assign({},r.rects,{placement:r.placement})):e,ws(typeof e!="number"?e:Es(e,Lr))};function Wu(p){var e,r=p.state,s=p.name,l=p.options,d=r.elements.arrow,m=r.modifiersData.popperOffsets,u=Jn(r.placement),v=Qa(u),S=[_n,zn].indexOf(u)>=0,E=S?"height":"width";if(!(!d||!m)){var h=qu(l.padding,r),f=Za(d),g=v==="y"?xn:_n,b=v==="y"?Un:zn,k=r.rects.reference[E]+r.rects.reference[v]-m[v]-r.rects.popper[E],w=m[v]-r.rects.reference[v],_=Ar(d),C=_?v==="y"?_.clientHeight||0:_.clientWidth||0:0,T=k/2-w/2,M=h[g],y=C-f[E]-h[b],O=C/2-f[E]/2+T,B=Sr(M,O,y),V=v;r.modifiersData[s]=(e={},e[V]=B,e.centerOffset=B-O,e)}}function Yu(p){var e=p.state,r=p.options,s=r.element,l=s===void 0?"[data-popper-arrow]":s;l!=null&&(typeof l=="string"&&(l=e.elements.popper.querySelector(l),!l)||vs(e.elements.popper,l)&&(e.elements.arrow=l))}const Ku={name:"arrow",enabled:!0,phase:"main",fn:Wu,effect:Yu,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},Gu=Eu({defaultModifiers:[...Du,Bu,Nu,Vu,Ss,ks,Ku]});function Xu({locked:p=!1,overflowPadding:e=8,offsetDistance:r=8,offsetSkid:s=0,gpuAcceleration:l=!0,adaptive:d=!0,scroll:m=!0,resize:u=!0,arrow:v=!1,placement:S,strategy:E},h){const f=G(null),g=G(null),b=G(null);return Ht(()=>{vc(k=>{if(!g.value||!f.value)return;const w=bo(g),_=bo(f);if(!(w instanceof HTMLElement)||!_)return;const C={modifiers:[{name:"flip",enabled:!p},{name:"preventOverflow",options:{padding:e}},{name:"offset",options:{offset:[s,r]}},{name:"computeStyles",options:{adaptive:d,gpuAcceleration:l}},{name:"eventListeners",options:{scroll:m,resize:u}},{name:"arrow",enabled:v}]};S&&(C.placement=S),E&&(C.strategy=E),b.value=Gu(_,w,C),k(b.value.destroy)})}),[f,g,b]}const wa=qa(ir.ui.strategy,ir.ui.tooltip,qc),Zu=nn({components:{UKbd:fs},inheritAttrs:!1,props:{text:{type:String,default:null},prevent:{type:Boolean,default:!1},shortcuts:{type:Array,default:()=>[]},openDelay:{type:Number,default:()=>wa.default.openDelay},closeDelay:{type:Number,default:()=>wa.default.closeDelay},popper:{type:Object,default:()=>({})},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(p){const{ui:e,attrs:r}=Wa("tooltip",Cr(p,"ui"),wa,Cr(p,"class")),s=he(()=>yc({},p.popper,e.value.popper)),[l,d]=Xu(s.value),m=G(!1);let u=null,v=null;const S=he(()=>!!(wc().text||p.text));function E(){v&&(clearTimeout(v),v=null),!m.value&&(u=u||setTimeout(()=>{m.value=!0,u=null},p.openDelay))}function h(){u&&(clearTimeout(u),u=null),m.value&&(v=v||setTimeout(()=>{m.value=!1,v=null},p.closeDelay))}return{ui:e,attrs:r,popper:s,trigger:l,container:d,open:m,onMouseEnter:E,onMouseLeave:h,isVisible:S}}});function Ju(p,e,r,s,l,d){const m=fs;return J(),ae("div",ra({ref:"trigger",class:p.ui.wrapper},p.attrs,{onMouseenter:e[0]||(e[0]=(...u)=>p.onMouseEnter&&p.onMouseEnter(...u)),onMouseleave:e[1]||(e[1]=(...u)=>p.onMouseLeave&&p.onMouseLeave(...u))}),[ia(p.$slots,"default",{open:p.open},()=>[e[2]||(e[2]=dt(" Hover "))]),p.open&&!p.prevent&&p.isVisible?(J(),ae("div",{key:0,ref:"container",class:be([p.ui.container,p.ui.width])},[te(bc,ra({appear:""},p.ui.transition),{default:Te(()=>{var u;return[N("div",null,[p.popper.arrow?(J(),ae("div",{key:0,"data-popper-arrow":"",class:be(Object.values(p.ui.arrow))},null,2)):Le("",!0),N("div",{class:be([p.ui.base,p.ui.background,p.ui.color,p.ui.rounded,p.ui.shadow,p.ui.ring])},[ia(p.$slots,"text",{},()=>[dt(We(p.text),1)]),(u=p.shortcuts)!=null&&u.length?(J(),ae("span",{key:0,class:be(p.ui.shortcuts)},[N("span",{class:be(p.ui.middot)},"·",2),(J(!0),ae(It,null,Qt(p.shortcuts,v=>(J(),Lt(m,{key:v,size:"xs"},{default:Te(()=>[dt(We(v),1)]),_:2},1024))),128))],2)):Le("",!0)],2)])]}),_:3},16)],2)):Le("",!0)],16)}const Qu=Tn(Zu,[["render",Ju]]),ed=Symbol.for("nuxt:client-only"),td=nn({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(p,{slots:e,attrs:r}){const s=G(!1);return Ht(()=>{s.value=!0}),Er(ed,!0),l=>{var v;if(s.value)return(v=e.default)==null?void 0:v.call(e);const d=e.fallback||e.placeholder;if(d)return d();const m=l.fallback||l.placeholder||"",u=l.fallbackTag||l.placeholderTag||"span";return ae(u,r,m)}}}),nd=qa(ir.ui.strategy,ir.ui.container,Vc),id=nn({inheritAttrs:!1,props:{as:{type:String,default:"div"},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(p){const{ui:e,attrs:r}=Wa("container",Cr(p,"ui"),nd),s=he(()=>rs(as(e.value.base,e.value.padding,e.value.constrained),p.class));return{ui:e,attrs:r,containerClass:s}}});function rd(p,e,r,s,l,d){return J(),Lt(Ec(p.as),ra({class:p.containerClass},p.attrs),{default:Te(()=>[ia(p.$slots,"default")]),_:3},16,["class"])}const ad=Tn(id,[["render",rd]]),xs=os("messageStore",()=>{const p=G([]),e=G(0),r=G(!0),s=G(1),l=G(15),d=Ze(),m=G(!1),u=G(null),v=G([]),S=G([]),E=G(null);return{messages:p,total:e,hasMore:r,page:s,pageSize:l,loading:m,siteConfig:u,reset:()=>{p.value=[],e.value=0,r.value=!0,s.value=1,m.value=!1},getMessages:async j=>{if(!m.value){m.value=!0;try{const z=await Ii("messages/page",j,{credentials:"include"});if(!z)return d.add({title:"获取笔记列表失败",description:"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const F=z.data.items.filter(le=>!p.value.some(de=>de.id===le.id));return j.page===1?p.value=z.data.items:p.value=[...p.value,...F],e.value=z.data.total,s.value=j.page,l.value=j.pageSize,r.value=p.value.length<e.value,z.data}catch(z){console.error("获取笔记列表失败:",z),d.add({title:"获取笔记列表失败",description:"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3})}finally{m.value=!1}}},deleteMessage:async j=>{try{const z=await ss(`messages/${j}`,void 0,{credentials:"include"});return!z||z.code!==1?(d.add({title:"删除笔记失败",description:z==null?void 0:z.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):(p.value=p.value.filter(F=>F.id!==j),e.value-=1,z)}catch(z){throw console.error("删除笔记失败:",z),z}},updateMessage:async(j,z)=>{try{const F=await jr(`messages/${j}`,{content:z},{credentials:"include"});if(!F||F.code!==1)return d.add({title:"更新笔记失败",description:F==null?void 0:F.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const le=p.value.findIndex(de=>de.id===j);return le!==-1&&(p.value[le]=F.data),F}catch(F){throw console.error("更新笔记失败:",F),F}},setPinned:async(j,z)=>{try{const F=await jr(`messages/${j}/pin`,{pinned:z},{credentials:"include"});if(!F||F.code!==1)return d.add({title:"更新置顶状态失败",description:F==null?void 0:F.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const le=p.value.findIndex(de=>de.id===j);return le!==-1&&(p.value[le]={...p.value[le],pinned:z},p.value=[...p.value].sort((de,Re)=>{const Be=de.pinned?1:0,Ce=Re.pinned?1:0;return Be!==Ce?Ce-Be:new Date(Re.created_at).getTime()-new Date(de.created_at).getTime()})),F}catch(F){throw console.error("更新置顶状态失败:",F),F}},getMessageById:async j=>{try{const z=await Bn(`messages/${j}`,void 0,{credentials:"include"});return!z||z.code!==1?(d.add({title:"获取消息失败",description:(z==null?void 0:z.msg)||"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):z.data}catch(z){throw console.error("获取消息失败:",z),z}},getSiteConfig:async()=>{try{const j=await Bn("site/config",void 0,{credentials:"include"});return!j||j.code!==1?(d.add({title:"获取网站配置失败",description:(j==null?void 0:j.msg)||"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):(u.value=j.data,yt(),j.data)}catch(j){throw console.error("获取网站配置失败:",j),j}},updateSiteConfig:async(j,z)=>{try{const F=await jr("site/config",{[j]:z},{credentials:"include"});return!F||F.code!==1?(d.add({title:"更新配置失败",description:F==null?void 0:F.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):(u.value={...u.value,[j]:z},F.data)}catch(F){throw console.error("更新配置失败:",F),F}},tags:v,images:S,getAllTags:async()=>{try{const j=await Bn("messages/tags",void 0,{credentials:"include"});return!j||j.code!==1?(d.add({title:"获取标签列表失败",description:(j==null?void 0:j.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(v.value=j.data,j.data)}catch(j){throw console.error("获取标签列表失败:",j),j}},getMessagesByTag:async j=>{try{const z=await Bn(`messages/tags/${encodeURIComponent(j)}`,void 0,{credentials:"include"});return!z||z.code!==1?(d.add({title:"获取标签消息失败",description:(z==null?void 0:z.msg)||"请稍后重试",color:"red",timeout:2e3}),null):z.data}catch(z){throw console.error("获取标签消息失败:",z),z}},getAllImages:async()=>{try{const j=await Bn("messages/images",void 0,{credentials:"include"});return!j||j.code!==1?(d.add({title:"获取图片列表失败",description:(j==null?void 0:j.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(S.value=j.data,j.data)}catch(j){throw console.error("获取图片列表失败:",j),j}},notifyConfig:E,getNotifyConfig:async()=>{try{const j=await Bn("notify/config",void 0,{credentials:"include"});return!j||j.code!==1?(d.add({title:"获取推送配置失败",description:(j==null?void 0:j.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(E.value=j.data,j.data)}catch(j){throw console.error("获取推送配置失败:",j),j}},updateNotifyConfig:async j=>{try{const z=await jr("notify/config",j,{credentials:"include"});return!z||z.code!==1?(d.add({title:"更新推送配置失败",description:(z==null?void 0:z.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(E.value=z.data,z.data)}catch(z){throw console.error("更新推送配置失败:",z),z}},testNotify:async j=>{try{const z=await Ii(`notify/test?type=${j}`,{},{credentials:"include"});if(!z||z.code!==1)throw new Error((z==null?void 0:z.msg)||"测试失败");return z.data}catch(z){throw console.error("推送测试失败:",z),z}},createMessage:async j=>{try{const z=await Ii("messages",j,{credentials:"include"});if(!z||z.code!==1)throw new Error((z==null?void 0:z.msg)||"创建消息失败");if(j.notify)try{const F=gn().public.baseApi,le={content:j.content,images:j.image_url?[`${F}${j.image_url}`].filter(Boolean):[],format:"markdown"},de=await Ii("notify/send",le,{credentials:"include"});(!de||de.code!==1)&&console.warn("推送失败:",de==null?void 0:de.msg)}catch(F){console.error("消息推送失败:",F)}return d.add({title:"成功",description:"发布成功",color:"green",timeout:2e3}),z.data}catch(z){throw console.error("创建消息失败:",z),z}}}}),_s=()=>{const p=xs(),e=Ze();return{save:async d=>{try{const m=await Ii("messages",d,{credentials:"include"});if(!m||m.code!==1)return console.log(m==null?void 0:m.code),e.add({title:"添加失败",description:String(m==null?void 0:m.msg),icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const u=m.data;return p.messages.unshift(u),e.add({title:"保存成功",description:"消息已保存",icon:"i-fluent-checkmark-starburst-16-filled",color:"green",timeout:1e3}),m.data}catch(m){console.error(m)}},uploadImage:async d=>{try{const m=new FormData;m.append("image",d);const u=await Ii("images/upload",m,{credentials:"include"});return!u||u.code!==1?(console.log(u==null?void 0:u.code),e.add({title:"上传失败",description:String(u==null?void 0:u.msg),icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):u.data}catch(m){return console.error("上传图片错误:",m),null}},deleteMessage:async d=>{try{const m=await p.deleteMessage(d);if(m&&m.code===1)return e.add({title:"删除成功",description:"笔记已删除",icon:"i-fluent-checkmark-starburst-16-filled",color:"green",timeout:1e3}),!0}catch(m){console.error(m)}}}},_e=(p,e=1e4)=>(p=parseFloat(p+"")||0,Math.round((p+Number.EPSILON)*e)/e),za=function(p){if(!(p&&p instanceof Element&&p.offsetParent))return!1;const e=p.scrollHeight>p.clientHeight,r=window.getComputedStyle(p).overflowY,s=r.indexOf("hidden")!==-1,l=r.indexOf("visible")!==-1;return e&&!s&&!l},oa=function(p,e=void 0){return!(!p||p===document.body||e&&p===e)&&(za(p)?p:oa(p.parentElement,e))},Xn=function(p){var e=new DOMParser().parseFromString(p,"text/html").body;if(e.childElementCount>1){for(var r=document.createElement("div");e.firstChild;)r.appendChild(e.firstChild);return r}return e.firstChild},to=p=>`${p||""}`.split(" ").filter(e=>!!e),Zn=(p,e,r)=>{p&&to(e).forEach(s=>{p.classList.toggle(s,r||!1)})};class Gi{constructor(e){Object.defineProperty(this,"pageX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pageY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"nativePointer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.nativePointer=e,this.pageX=e.pageX,this.pageY=e.pageY,this.clientX=e.clientX,this.clientY=e.clientY,this.id=self.Touch&&e instanceof Touch?e.identifier:-1,this.time=Date.now()}}const Xi={passive:!1};class od{constructor(e,{start:r=()=>!0,move:s=()=>{},end:l=()=>{}}){Object.defineProperty(this,"element",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"startCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"moveCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"endCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"currentPointers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"startPointers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.element=e,this.startCallback=r,this.moveCallback=s,this.endCallback=l;for(const d of["onPointerStart","onTouchStart","onMove","onTouchEnd","onPointerEnd","onWindowBlur"])this[d]=this[d].bind(this);this.element.addEventListener("mousedown",this.onPointerStart,Xi),this.element.addEventListener("touchstart",this.onTouchStart,Xi),this.element.addEventListener("touchmove",this.onMove,Xi),this.element.addEventListener("touchend",this.onTouchEnd),this.element.addEventListener("touchcancel",this.onTouchEnd)}onPointerStart(e){if(!e.buttons||e.button!==0)return;const r=new Gi(e);this.currentPointers.some(s=>s.id===r.id)||this.triggerPointerStart(r,e)&&(window.addEventListener("mousemove",this.onMove),window.addEventListener("mouseup",this.onPointerEnd),window.addEventListener("blur",this.onWindowBlur))}onTouchStart(e){for(const r of Array.from(e.changedTouches||[]))this.triggerPointerStart(new Gi(r),e);window.addEventListener("blur",this.onWindowBlur)}onMove(e){const r=this.currentPointers.slice(),s="changedTouches"in e?Array.from(e.changedTouches||[]).map(d=>new Gi(d)):[new Gi(e)],l=[];for(const d of s){const m=this.currentPointers.findIndex(u=>u.id===d.id);m<0||(l.push(d),this.currentPointers[m]=d)}l.length&&this.moveCallback(e,this.currentPointers.slice(),r)}onPointerEnd(e){e.buttons>0&&e.button!==0||(this.triggerPointerEnd(e,new Gi(e)),window.removeEventListener("mousemove",this.onMove),window.removeEventListener("mouseup",this.onPointerEnd),window.removeEventListener("blur",this.onWindowBlur))}onTouchEnd(e){for(const r of Array.from(e.changedTouches||[]))this.triggerPointerEnd(e,new Gi(r))}triggerPointerStart(e,r){return!!this.startCallback(r,e,this.currentPointers.slice())&&(this.currentPointers.push(e),this.startPointers.push(e),!0)}triggerPointerEnd(e,r){const s=this.currentPointers.findIndex(l=>l.id===r.id);s<0||(this.currentPointers.splice(s,1),this.startPointers.splice(s,1),this.endCallback(e,r,this.currentPointers.slice()))}onWindowBlur(){this.clear()}clear(){for(;this.currentPointers.length;){const e=this.currentPointers[this.currentPointers.length-1];this.currentPointers.splice(this.currentPointers.length-1,1),this.startPointers.splice(this.currentPointers.length-1,1),this.endCallback(new Event("touchend",{bubbles:!0,cancelable:!0,clientX:e.clientX,clientY:e.clientY}),e,this.currentPointers.slice())}}stop(){this.element.removeEventListener("mousedown",this.onPointerStart,Xi),this.element.removeEventListener("touchstart",this.onTouchStart,Xi),this.element.removeEventListener("touchmove",this.onMove,Xi),this.element.removeEventListener("touchend",this.onTouchEnd),this.element.removeEventListener("touchcancel",this.onTouchEnd),window.removeEventListener("mousemove",this.onMove),window.removeEventListener("mouseup",this.onPointerEnd),window.removeEventListener("blur",this.onWindowBlur)}}function Co(p,e){return e?Math.sqrt(Math.pow(e.clientX-p.clientX,2)+Math.pow(e.clientY-p.clientY,2)):0}function To(p,e){return e?{clientX:(p.clientX+e.clientX)/2,clientY:(p.clientY+e.clientY)/2}:p}const Fa=p=>typeof p=="object"&&p!==null&&p.constructor===Object&&Object.prototype.toString.call(p)==="[object Object]",bn=(p,...e)=>{const r=e.length;for(let s=0;s<r;s++){const l=e[s]||{};Object.entries(l).forEach(([d,m])=>{const u=Array.isArray(m)?[]:{};p[d]||Object.assign(p,{[d]:u}),Fa(m)?Object.assign(p[d],bn(u,m)):Array.isArray(m)?Object.assign(p,{[d]:[...m]}):Object.assign(p,{[d]:m})})}return p},Ea=function(p,e){return p.split(".").reduce((r,s)=>typeof r=="object"?r[s]:void 0,e)};class sa{constructor(e={}){Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),this.setOptions(e);for(const r of Object.getOwnPropertyNames(Object.getPrototypeOf(this)))r.startsWith("on")&&typeof this[r]=="function"&&(this[r]=this[r].bind(this))}setOptions(e){this.options=e?bn({},this.constructor.defaults,e):{};for(const[r,s]of Object.entries(this.option("on")||{}))this.on(r,s)}option(e,...r){let s=Ea(e,this.options);return s&&typeof s=="function"&&(s=s.call(this,this,...r)),s}optionFor(e,r,s,...l){let d=Ea(r,e);var m;typeof(m=d)!="string"||isNaN(m)||isNaN(parseFloat(m))||(d=parseFloat(d)),d==="true"&&(d=!0),d==="false"&&(d=!1),d&&typeof d=="function"&&(d=d.call(this,this,e,...l));let u=Ea(r,this.options);return u&&typeof u=="function"?d=u.call(this,this,e,...l,d):d===void 0&&(d=u),d===void 0?s:d}cn(e){const r=this.options.classes;return r&&r[e]||""}localize(e,r=[]){e=String(e).replace(/\{\{(\w+).?(\w+)?\}\}/g,(s,l,d)=>{let m="";return d?m=this.option(`${l[0]+l.toLowerCase().substring(1)}.l10n.${d}`):l&&(m=this.option(`l10n.${l}`)),m||(m=s),m});for(let s=0;s<r.length;s++)e=e.split(r[s][0]).join(r[s][1]);return e=e.replace(/\{\{(.*?)\}\}/g,(s,l)=>l)}on(e,r){let s=[];typeof e=="string"?s=e.split(" "):Array.isArray(e)&&(s=e),this.events||(this.events=new Map),s.forEach(l=>{let d=this.events.get(l);d||(this.events.set(l,[]),d=[]),d.includes(r)||d.push(r),this.events.set(l,d)})}off(e,r){let s=[];typeof e=="string"?s=e.split(" "):Array.isArray(e)&&(s=e),s.forEach(l=>{const d=this.events.get(l);if(Array.isArray(d)){const m=d.indexOf(r);m>-1&&d.splice(m,1)}})}emit(e,...r){[...this.events.get(e)||[]].forEach(s=>s(this,...r)),e!=="*"&&this.emit("*",e,...r)}}Object.defineProperty(sa,"version",{enumerable:!0,configurable:!0,writable:!0,value:"5.0.36"}),Object.defineProperty(sa,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{}});class no extends sa{constructor(e={}){super(e),Object.defineProperty(this,"plugins",{enumerable:!0,configurable:!0,writable:!0,value:{}})}attachPlugins(e={}){const r=new Map;for(const[s,l]of Object.entries(e)){const d=this.option(s),m=this.plugins[s];m||d===!1?m&&d===!1&&(m.detach(),delete this.plugins[s]):r.set(s,new l(this,d||{}))}for(const[s,l]of r)this.plugins[s]=l,l.attach()}detachPlugins(e){e=e||Object.keys(this.plugins);for(const r of e){const s=this.plugins[r];s&&s.detach(),delete this.plugins[r]}return this.emit("detachPlugins"),this}}var kt;(function(p){p[p.Init=0]="Init",p[p.Error=1]="Error",p[p.Ready=2]="Ready",p[p.Panning=3]="Panning",p[p.Mousemove=4]="Mousemove",p[p.Destroy=5]="Destroy"})(kt||(kt={}));const ri=["a","b","c","d","e","f"],Cs={PANUP:"Move up",PANDOWN:"Move down",PANLEFT:"Move left",PANRIGHT:"Move right",ZOOMIN:"Zoom in",ZOOMOUT:"Zoom out",TOGGLEZOOM:"Toggle zoom level",TOGGLE1TO1:"Toggle zoom level",ITERATEZOOM:"Toggle zoom level",ROTATECCW:"Rotate counterclockwise",ROTATECW:"Rotate clockwise",FLIPX:"Flip horizontally",FLIPY:"Flip vertically",FITX:"Fit horizontally",FITY:"Fit vertically",RESET:"Reset",TOGGLEFS:"Toggle fullscreen"},sd={content:null,width:"auto",height:"auto",panMode:"drag",touch:!0,dragMinThreshold:3,lockAxis:!1,mouseMoveFactor:1,mouseMoveFriction:.12,zoom:!0,pinchToZoom:!0,panOnlyZoomed:"auto",minScale:1,maxScale:2,friction:.25,dragFriction:.35,decelFriction:.05,click:"toggleZoom",dblClick:!1,wheel:"zoom",wheelLimit:7,spinner:!0,bounds:"auto",infinite:!1,rubberband:!0,bounce:!0,maxVelocity:75,transformParent:!1,classes:{content:"f-panzoom__content",isLoading:"is-loading",canZoomIn:"can-zoom_in",canZoomOut:"can-zoom_out",isDraggable:"is-draggable",isDragging:"is-dragging",inFullscreen:"in-fullscreen",htmlHasFullscreen:"with-panzoom-in-fullscreen"},l10n:Cs},Mo='<circle cx="25" cy="25" r="20"></circle>',io='<div class="f-spinner"><svg viewBox="0 0 50 50">'+Mo+Mo+"</svg></div>",vn=p=>p&&p!==null&&p instanceof Element&&"nodeType"in p,wt=(p,e)=>{p&&to(e).forEach(r=>{p.classList.remove(r)})},qe=(p,e)=>{p&&to(e).forEach(r=>{p.classList.add(r)})},zr={a:1,b:0,c:0,d:1,e:0,f:0},ld=1e5,Fr=1e4,Dn="mousemove",Ao="drag",Lo="content",On="auto";let ka=null,Sa=null;class Fi extends no{get fits(){return this.contentRect.width-this.contentRect.fitWidth<1&&this.contentRect.height-this.contentRect.fitHeight<1}get isTouchDevice(){return Sa===null&&(Sa=window.matchMedia("(hover: none)").matches),Sa}get isMobile(){return ka===null&&(ka=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)),ka}get panMode(){return this.options.panMode!==Dn||this.isTouchDevice?Ao:Dn}get panOnlyZoomed(){const e=this.options.panOnlyZoomed;return e===On?this.isTouchDevice:e}get isInfinite(){return this.option("infinite")}get angle(){return 180*Math.atan2(this.current.b,this.current.a)/Math.PI||0}get targetAngle(){return 180*Math.atan2(this.target.b,this.target.a)/Math.PI||0}get scale(){const{a:e,b:r}=this.current;return Math.sqrt(e*e+r*r)||1}get targetScale(){const{a:e,b:r}=this.target;return Math.sqrt(e*e+r*r)||1}get minScale(){return this.option("minScale")||1}get fullScale(){const{contentRect:e}=this;return e.fullWidth/e.fitWidth||1}get maxScale(){return this.fullScale*(this.option("maxScale")||1)||1}get coverScale(){const{containerRect:e,contentRect:r}=this,s=Math.max(e.height/r.fitHeight,e.width/r.fitWidth)||1;return Math.min(this.fullScale,s)}get isScaling(){return Math.abs(this.targetScale-this.scale)>1e-5&&!this.isResting}get isContentLoading(){const e=this.content;return!!(e&&e instanceof HTMLImageElement)&&!e.complete}get isResting(){if(this.isBouncingX||this.isBouncingY)return!1;for(const e of ri){const r=e=="e"||e==="f"?1e-4:1e-5;if(Math.abs(this.target[e]-this.current[e])>r)return!1}return!(!this.ignoreBounds&&!this.checkBounds().inBounds)}constructor(e,r={},s={}){var l;if(super(r),Object.defineProperty(this,"pointerTracker",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"resizeObserver",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"updateTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"clickTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"rAF",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"isTicking",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreBounds",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isBouncingX",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isBouncingY",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"clicks",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"trackingPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"pwt",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"cwd",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"pmme",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"friction",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:kt.Init}),Object.defineProperty(this,"isDragging",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"spinner",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"containerRect",{enumerable:!0,configurable:!0,writable:!0,value:{width:0,height:0,innerWidth:0,innerHeight:0}}),Object.defineProperty(this,"contentRect",{enumerable:!0,configurable:!0,writable:!0,value:{top:0,right:0,bottom:0,left:0,fullWidth:0,fullHeight:0,fitWidth:0,fitHeight:0,width:0,height:0}}),Object.defineProperty(this,"dragStart",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0,top:0,left:0,time:0}}),Object.defineProperty(this,"dragOffset",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0,time:0}}),Object.defineProperty(this,"current",{enumerable:!0,configurable:!0,writable:!0,value:Object.assign({},zr)}),Object.defineProperty(this,"target",{enumerable:!0,configurable:!0,writable:!0,value:Object.assign({},zr)}),Object.defineProperty(this,"velocity",{enumerable:!0,configurable:!0,writable:!0,value:{a:0,b:0,c:0,d:0,e:0,f:0}}),Object.defineProperty(this,"lockedAxis",{enumerable:!0,configurable:!0,writable:!0,value:!1}),!e)throw new Error("Container Element Not Found");this.container=e,this.initContent(),this.attachPlugins(Object.assign(Object.assign({},Fi.Plugins),s)),this.emit("attachPlugins"),this.emit("init");const d=this.content;if(d.addEventListener("load",this.onLoad),d.addEventListener("error",this.onError),this.isContentLoading){if(this.option("spinner")){e.classList.add(this.cn("isLoading"));const m=Xn(io);!e.contains(d)||d.parentElement instanceof HTMLPictureElement?this.spinner=e.appendChild(m):this.spinner=((l=d.parentElement)===null||l===void 0?void 0:l.insertBefore(m,d))||null}this.emit("beforeLoad")}else queueMicrotask(()=>{this.enable()})}initContent(){const{container:e}=this,r=this.cn(Lo);let s=this.option(Lo)||e.querySelector(`.${r}`);if(s||(s=e.querySelector("img,picture")||e.firstElementChild,s&&qe(s,r)),s instanceof HTMLPictureElement&&(s=s.querySelector("img")),!s)throw new Error("No content found");this.content=s}onLoad(){const{spinner:e,container:r,state:s}=this;e&&(e.remove(),this.spinner=null),this.option("spinner")&&r.classList.remove(this.cn("isLoading")),this.emit("afterLoad"),s===kt.Init?this.enable():this.updateMetrics()}onError(){this.state!==kt.Destroy&&(this.spinner&&(this.spinner.remove(),this.spinner=null),this.stop(),this.detachEvents(),this.state=kt.Error,this.emit("error"))}getNextScale(e){const{fullScale:r,targetScale:s,coverScale:l,maxScale:d,minScale:m}=this;let u=m;switch(e){case"toggleMax":u=s-m<.5*(d-m)?d:m;break;case"toggleCover":u=s-m<.5*(l-m)?l:m;break;case"toggleZoom":u=s-m<.5*(r-m)?r:m;break;case"iterateZoom":let v=[1,r,d].sort((E,h)=>E-h),S=v.findIndex(E=>E>s+1e-5);u=v[S]||1}return u}attachObserver(){var e;const r=()=>{const{container:s,containerRect:l}=this;return Math.abs(l.width-s.getBoundingClientRect().width)>.1||Math.abs(l.height-s.getBoundingClientRect().height)>.1};this.resizeObserver||window.ResizeObserver===void 0||(this.resizeObserver=new ResizeObserver(()=>{this.updateTimer||(r()?(this.onResize(),this.isMobile&&(this.updateTimer=setTimeout(()=>{r()&&this.onResize(),this.updateTimer=null},500))):this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null))})),(e=this.resizeObserver)===null||e===void 0||e.observe(this.container)}detachObserver(){var e;(e=this.resizeObserver)===null||e===void 0||e.disconnect()}attachEvents(){const{container:e}=this;e.addEventListener("click",this.onClick,{passive:!1,capture:!1}),e.addEventListener("wheel",this.onWheel,{passive:!1}),this.pointerTracker=new od(e,{start:this.onPointerDown,move:this.onPointerMove,end:this.onPointerUp}),document.addEventListener(Dn,this.onMouseMove)}detachEvents(){var e;const{container:r}=this;r.removeEventListener("click",this.onClick,{passive:!1,capture:!1}),r.removeEventListener("wheel",this.onWheel,{passive:!1}),(e=this.pointerTracker)===null||e===void 0||e.stop(),this.pointerTracker=null,document.removeEventListener(Dn,this.onMouseMove),document.removeEventListener("keydown",this.onKeydown,!0),this.clickTimer&&(clearTimeout(this.clickTimer),this.clickTimer=null),this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null)}animate(){this.setTargetForce();const e=this.friction,r=this.option("maxVelocity");for(const s of ri)e?(this.velocity[s]*=1-e,r&&!this.isScaling&&(this.velocity[s]=Math.max(Math.min(this.velocity[s],r),-1*r)),this.current[s]+=this.velocity[s]):this.current[s]=this.target[s];this.setTransform(),this.setEdgeForce(),!this.isResting||this.isDragging?this.rAF=requestAnimationFrame(()=>this.animate()):this.stop("current")}setTargetForce(){for(const e of ri)e==="e"&&this.isBouncingX||e==="f"&&this.isBouncingY||(this.velocity[e]=(1/(1-this.friction)-1)*(this.target[e]-this.current[e]))}checkBounds(e=0,r=0){const{current:s}=this,l=s.e+e,d=s.f+r,m=this.getBounds(),{x:u,y:v}=m,S=u.min,E=u.max,h=v.min,f=v.max;let g=0,b=0;return S!==1/0&&l<S?g=S-l:E!==1/0&&l>E&&(g=E-l),h!==1/0&&d<h?b=h-d:f!==1/0&&d>f&&(b=f-d),Math.abs(g)<1e-4&&(g=0),Math.abs(b)<1e-4&&(b=0),Object.assign(Object.assign({},m),{xDiff:g,yDiff:b,inBounds:!g&&!b})}clampTargetBounds(){const{target:e}=this,{x:r,y:s}=this.getBounds();r.min!==1/0&&(e.e=Math.max(e.e,r.min)),r.max!==1/0&&(e.e=Math.min(e.e,r.max)),s.min!==1/0&&(e.f=Math.max(e.f,s.min)),s.max!==1/0&&(e.f=Math.min(e.f,s.max))}calculateContentDim(e=this.current){const{content:r,contentRect:s}=this,{fitWidth:l,fitHeight:d,fullWidth:m,fullHeight:u}=s;let v=m,S=u;if(this.option("zoom")||this.angle!==0){const E=!(r instanceof HTMLImageElement)&&(window.getComputedStyle(r).maxWidth==="none"||window.getComputedStyle(r).maxHeight==="none"),h=E?m:l,f=E?u:d,g=this.getMatrix(e),b=new DOMPoint(0,0).matrixTransform(g),k=new DOMPoint(0+h,0).matrixTransform(g),w=new DOMPoint(0+h,0+f).matrixTransform(g),_=new DOMPoint(0,0+f).matrixTransform(g),C=Math.abs(w.x-b.x),T=Math.abs(w.y-b.y),M=Math.abs(_.x-k.x),y=Math.abs(_.y-k.y);v=Math.max(C,M),S=Math.max(T,y)}return{contentWidth:v,contentHeight:S}}setEdgeForce(){if(this.ignoreBounds||this.isDragging||this.panMode===Dn||this.targetScale<this.scale)return this.isBouncingX=!1,void(this.isBouncingY=!1);const{target:e}=this,{x:r,y:s,xDiff:l,yDiff:d}=this.checkBounds(),m=this.option("maxVelocity");let u=this.velocity.e,v=this.velocity.f;l!==0?(this.isBouncingX=!0,l*u<=0?u+=.14*l:(u=.14*l,r.min!==1/0&&(this.target.e=Math.max(e.e,r.min)),r.max!==1/0&&(this.target.e=Math.min(e.e,r.max))),m&&(u=Math.max(Math.min(u,m),-1*m))):this.isBouncingX=!1,d!==0?(this.isBouncingY=!0,d*v<=0?v+=.14*d:(v=.14*d,s.min!==1/0&&(this.target.f=Math.max(e.f,s.min)),s.max!==1/0&&(this.target.f=Math.min(e.f,s.max))),m&&(v=Math.max(Math.min(v,m),-1*m))):this.isBouncingY=!1,this.isBouncingX&&(this.velocity.e=u),this.isBouncingY&&(this.velocity.f=v)}enable(){const{content:e}=this,r=new DOMMatrixReadOnly(window.getComputedStyle(e).transform);for(const s of ri)this.current[s]=this.target[s]=r[s];this.updateMetrics(),this.attachObserver(),this.attachEvents(),this.state=kt.Ready,this.emit("ready")}onClick(e){var r;e.type==="click"&&e.detail===0&&(this.dragOffset.x=0,this.dragOffset.y=0),this.isDragging&&((r=this.pointerTracker)===null||r===void 0||r.clear(),this.trackingPoints=[],this.startDecelAnim());const s=e.target;if(!s||e.defaultPrevented)return;if(s.hasAttribute("disabled"))return e.preventDefault(),void e.stopPropagation();if((()=>{const g=window.getSelection();return g&&g.type==="Range"})()&&!s.closest("button"))return;const l=s.closest("[data-panzoom-action]"),d=s.closest("[data-panzoom-change]"),m=l||d,u=m&&vn(m)?m.dataset:null;if(u){const g=u.panzoomChange,b=u.panzoomAction;if((g||b)&&e.preventDefault(),g){let k={};try{k=JSON.parse(g)}catch{console&&console.warn("The given data was not valid JSON")}return void this.applyChange(k)}if(b)return void(this[b]&&this[b]())}if(Math.abs(this.dragOffset.x)>3||Math.abs(this.dragOffset.y)>3)return e.preventDefault(),void e.stopPropagation();if(s.closest("[data-fancybox]"))return;const v=this.content.getBoundingClientRect(),S=this.dragStart;if(S.time&&!this.canZoomOut()&&(Math.abs(v.x-S.x)>2||Math.abs(v.y-S.y)>2))return;this.dragStart.time=0;const E=g=>{this.option("zoom",e)&&g&&typeof g=="string"&&/(iterateZoom)|(toggle(Zoom|Full|Cover|Max)|(zoomTo(Fit|Cover|Max)))/.test(g)&&typeof this[g]=="function"&&(e.preventDefault(),this[g]({event:e}))},h=this.option("click",e),f=this.option("dblClick",e);f?(this.clicks++,this.clicks==1&&(this.clickTimer=setTimeout(()=>{this.clicks===1?(this.emit("click",e),!e.defaultPrevented&&h&&E(h)):(this.emit("dblClick",e),e.defaultPrevented||E(f)),this.clicks=0,this.clickTimer=null},350))):(this.emit("click",e),!e.defaultPrevented&&h&&E(h))}addTrackingPoint(e){const r=this.trackingPoints.filter(s=>s.time>Date.now()-100);r.push(e),this.trackingPoints=r}onPointerDown(e,r,s){var l;if(this.option("touch",e)===!1)return!1;this.pwt=0,this.dragOffset={x:0,y:0,time:0},this.trackingPoints=[];const d=this.content.getBoundingClientRect();if(this.dragStart={x:d.x,y:d.y,top:d.top,left:d.left,time:Date.now()},this.clickTimer)return!1;if(this.panMode===Dn&&this.targetScale>1)return e.preventDefault(),e.stopPropagation(),!1;const m=e.composedPath()[0];if(!s.length){if(["TEXTAREA","OPTION","INPUT","SELECT","VIDEO","IFRAME"].includes(m.nodeName)||m.closest("[contenteditable],[data-selectable],[data-draggable],[data-clickable],[data-panzoom-change],[data-panzoom-action]"))return!1;(l=window.getSelection())===null||l===void 0||l.removeAllRanges()}if(e.type==="mousedown")["A","BUTTON"].includes(m.nodeName)||e.preventDefault();else if(Math.abs(this.velocity.a)>.3)return!1;return this.target.e=this.current.e,this.target.f=this.current.f,this.stop(),this.isDragging||(this.isDragging=!0,this.addTrackingPoint(r),this.emit("touchStart",e)),!0}onPointerMove(e,r,s){if(this.option("touch",e)===!1||!this.isDragging||r.length<2&&this.panOnlyZoomed&&_e(this.targetScale)<=_e(this.minScale)||(this.emit("touchMove",e),e.defaultPrevented))return;this.addTrackingPoint(r[0]);const{content:l}=this,d=To(s[0],s[1]),m=To(r[0],r[1]);let u=0,v=0;if(r.length>1){const T=l.getBoundingClientRect();u=d.clientX-T.left-.5*T.width,v=d.clientY-T.top-.5*T.height}const S=Co(s[0],s[1]),E=Co(r[0],r[1]);let h=S?E/S:1,f=m.clientX-d.clientX,g=m.clientY-d.clientY;this.dragOffset.x+=f,this.dragOffset.y+=g,this.dragOffset.time=Date.now()-this.dragStart.time;let b=_e(this.targetScale)===_e(this.minScale)&&this.option("lockAxis");if(b&&!this.lockedAxis)if(b==="xy"||b==="y"||e.type==="touchmove"){if(Math.abs(this.dragOffset.x)<6&&Math.abs(this.dragOffset.y)<6)return void e.preventDefault();const T=Math.abs(180*Math.atan2(this.dragOffset.y,this.dragOffset.x)/Math.PI);this.lockedAxis=T>45&&T<135?"y":"x",this.dragOffset.x=0,this.dragOffset.y=0,f=0,g=0}else this.lockedAxis=b;if(oa(e.target,this.content)&&(b="x",this.dragOffset.y=0),b&&b!=="xy"&&this.lockedAxis!==b&&_e(this.targetScale)===_e(this.minScale))return;e.cancelable&&e.preventDefault(),this.container.classList.add(this.cn("isDragging"));const k=this.checkBounds(f,g);this.option("rubberband")?(this.isInfinite!=="x"&&(k.xDiff>0&&f<0||k.xDiff<0&&f>0)&&(f*=Math.max(0,.5-Math.abs(.75/this.contentRect.fitWidth*k.xDiff))),this.isInfinite!=="y"&&(k.yDiff>0&&g<0||k.yDiff<0&&g>0)&&(g*=Math.max(0,.5-Math.abs(.75/this.contentRect.fitHeight*k.yDiff)))):(k.xDiff&&(f=0),k.yDiff&&(g=0));const w=this.targetScale,_=this.minScale,C=this.maxScale;w<.5*_&&(h=Math.max(h,_)),w>1.5*C&&(h=Math.min(h,C)),this.lockedAxis==="y"&&_e(w)===_e(_)&&(f=0),this.lockedAxis==="x"&&_e(w)===_e(_)&&(g=0),this.applyChange({originX:u,originY:v,panX:f,panY:g,scale:h,friction:this.option("dragFriction"),ignoreBounds:!0})}onPointerUp(e,r,s){if(s.length)return this.dragOffset.x=0,this.dragOffset.y=0,void(this.trackingPoints=[]);this.container.classList.remove(this.cn("isDragging")),this.isDragging&&(this.addTrackingPoint(r),this.panOnlyZoomed&&this.contentRect.width-this.contentRect.fitWidth<1&&this.contentRect.height-this.contentRect.fitHeight<1&&(this.trackingPoints=[]),oa(e.target,this.content)&&this.lockedAxis==="y"&&(this.trackingPoints=[]),this.emit("touchEnd",e),this.isDragging=!1,this.lockedAxis=!1,this.state!==kt.Destroy&&(e.defaultPrevented||this.startDecelAnim()))}startDecelAnim(){var e;const r=this.isScaling;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.isBouncingX=!1,this.isBouncingY=!1;for(const T of ri)this.velocity[T]=0;this.target.e=this.current.e,this.target.f=this.current.f,wt(this.container,"is-scaling"),wt(this.container,"is-animating"),this.isTicking=!1;const{trackingPoints:s}=this,l=s[0],d=s[s.length-1];let m=0,u=0,v=0;d&&l&&(m=d.clientX-l.clientX,u=d.clientY-l.clientY,v=d.time-l.time);const S=((e=window.visualViewport)===null||e===void 0?void 0:e.scale)||1;S!==1&&(m*=S,u*=S);let E=0,h=0,f=0,g=0,b=this.option("decelFriction");const k=this.targetScale;if(v>0){f=Math.abs(m)>3?m/(v/30):0,g=Math.abs(u)>3?u/(v/30):0;const T=this.option("maxVelocity");T&&(f=Math.max(Math.min(f,T),-1*T),g=Math.max(Math.min(g,T),-1*T))}f&&(E=f/(1/(1-b)-1)),g&&(h=g/(1/(1-b)-1)),(this.option("lockAxis")==="y"||this.option("lockAxis")==="xy"&&this.lockedAxis==="y"&&_e(k)===this.minScale)&&(E=f=0),(this.option("lockAxis")==="x"||this.option("lockAxis")==="xy"&&this.lockedAxis==="x"&&_e(k)===this.minScale)&&(h=g=0);const w=this.dragOffset.x,_=this.dragOffset.y,C=this.option("dragMinThreshold")||0;Math.abs(w)<C&&Math.abs(_)<C&&(E=h=0,f=g=0),(this.option("zoom")&&(k<this.minScale-1e-5||k>this.maxScale+1e-5)||r&&!E&&!h)&&(b=.35),this.applyChange({panX:E,panY:h,friction:b}),this.emit("decel",f,g,w,_)}onWheel(e){var r=[-e.deltaX||0,-e.deltaY||0,-e.detail||0].reduce(function(d,m){return Math.abs(m)>Math.abs(d)?m:d});const s=Math.max(-1,Math.min(1,r));if(this.emit("wheel",e,s),this.panMode===Dn||e.defaultPrevented)return;const l=this.option("wheel");l==="pan"?(e.preventDefault(),this.panOnlyZoomed&&!this.canZoomOut()||this.applyChange({panX:2*-e.deltaX,panY:2*-e.deltaY,bounce:!1})):l==="zoom"&&this.option("zoom")!==!1&&this.zoomWithWheel(e)}onMouseMove(e){this.panWithMouse(e)}onKeydown(e){e.key==="Escape"&&this.toggleFS()}onResize(){this.updateMetrics(),this.checkBounds().inBounds||this.requestTick()}setTransform(){this.emit("beforeTransform");const{current:e,target:r,content:s,contentRect:l}=this,d=Object.assign({},zr);for(const w of ri){const _=w=="e"||w==="f"?Fr:ld;d[w]=_e(e[w],_),Math.abs(r[w]-e[w])<(w=="e"||w==="f"?.51:.001)&&(e[w]=r[w])}let{a:m,b:u,c:v,d:S,e:E,f:h}=d,f=`matrix(${m}, ${u}, ${v}, ${S}, ${E}, ${h})`,g=s.parentElement instanceof HTMLPictureElement?s.parentElement:s;if(this.option("transformParent")&&(g=g.parentElement||g),g.style.transform===f)return;g.style.transform=f;const{contentWidth:b,contentHeight:k}=this.calculateContentDim();l.width=b,l.height=k,this.emit("afterTransform")}updateMetrics(e=!1){var r;if(!this||this.state===kt.Destroy||this.isContentLoading)return;const s=Math.max(1,((r=window.visualViewport)===null||r===void 0?void 0:r.scale)||1),{container:l,content:d}=this,m=d instanceof HTMLImageElement,u=l.getBoundingClientRect(),v=getComputedStyle(this.container);let S=u.width*s,E=u.height*s;const h=parseFloat(v.paddingTop)+parseFloat(v.paddingBottom),f=S-(parseFloat(v.paddingLeft)+parseFloat(v.paddingRight)),g=E-h;this.containerRect={width:S,height:E,innerWidth:f,innerHeight:g};const b=parseFloat(d.dataset.width||"")||(le=>{let de=0;return de=le instanceof HTMLImageElement?le.naturalWidth:le instanceof SVGElement?le.width.baseVal.value:Math.max(le.offsetWidth,le.scrollWidth),de||0})(d),k=parseFloat(d.dataset.height||"")||(le=>{let de=0;return de=le instanceof HTMLImageElement?le.naturalHeight:le instanceof SVGElement?le.height.baseVal.value:Math.max(le.offsetHeight,le.scrollHeight),de||0})(d);let w=this.option("width",b)||On,_=this.option("height",k)||On;const C=w===On,T=_===On;typeof w!="number"&&(w=b),typeof _!="number"&&(_=k),C&&(w=b*(_/k)),T&&(_=k/(b/w));let M=d.parentElement instanceof HTMLPictureElement?d.parentElement:d;this.option("transformParent")&&(M=M.parentElement||M);const y=M.getAttribute("style")||"";M.style.setProperty("transform","none","important"),m&&(M.style.width="",M.style.height=""),M.offsetHeight;const O=d.getBoundingClientRect();let B=O.width*s,V=O.height*s,I=B,j=V;B=Math.min(B,w),V=Math.min(V,_),m?{width:B,height:V}=((le,de,Re,Be)=>{const Ce=Re/le,De=Be/de,Ie=Math.min(Ce,De);return{width:le*=Ie,height:de*=Ie}})(w,_,B,V):(B=Math.min(B,w),V=Math.min(V,_));let z=.5*(j-V),F=.5*(I-B);this.contentRect=Object.assign(Object.assign({},this.contentRect),{top:O.top-u.top+z,bottom:u.bottom-O.bottom+z,left:O.left-u.left+F,right:u.right-O.right+F,fitWidth:B,fitHeight:V,width:B,height:V,fullWidth:w,fullHeight:_}),M.style.cssText=y,m&&(M.style.width=`${B}px`,M.style.height=`${V}px`),this.setTransform(),e!==!0&&this.emit("refresh"),this.ignoreBounds||(_e(this.targetScale)<_e(this.minScale)?this.zoomTo(this.minScale,{friction:0}):this.targetScale>this.maxScale?this.zoomTo(this.maxScale,{friction:0}):this.state===kt.Init||this.checkBounds().inBounds||this.requestTick()),this.updateControls()}calculateBounds(){const{contentWidth:e,contentHeight:r}=this.calculateContentDim(this.target),{targetScale:s,lockedAxis:l}=this,{fitWidth:d,fitHeight:m}=this.contentRect;let u=0,v=0,S=0,E=0;const h=this.option("infinite");if(h===!0||l&&h===l)u=-1/0,S=1/0,v=-1/0,E=1/0;else{let{containerRect:f,contentRect:g}=this,b=_e(d*s,Fr),k=_e(m*s,Fr),{innerWidth:w,innerHeight:_}=f;if(f.width===b&&(w=f.width),f.width===k&&(_=f.height),e>w){S=.5*(e-w),u=-1*S;let C=.5*(g.right-g.left);u+=C,S+=C}if(d>w&&e<w&&(u-=.5*(d-w),S-=.5*(d-w)),r>_){E=.5*(r-_),v=-1*E;let C=.5*(g.bottom-g.top);v+=C,E+=C}m>_&&r<_&&(u-=.5*(m-_),S-=.5*(m-_))}return{x:{min:u,max:S},y:{min:v,max:E}}}getBounds(){const e=this.option("bounds");return e!==On?e:this.calculateBounds()}updateControls(){const e=this,r=e.container,{panMode:s,contentRect:l,targetScale:d,minScale:m}=e;let u=m,v=e.option("click")||!1;v&&(u=e.getNextScale(v));let S=e.canZoomIn(),E=e.canZoomOut(),h=s===Ao&&!!this.option("touch"),f=E&&h;if(h&&(_e(d)<_e(m)&&!this.panOnlyZoomed&&(f=!0),(_e(l.width,1)>_e(l.fitWidth,1)||_e(l.height,1)>_e(l.fitHeight,1))&&(f=!0)),_e(l.width*d,1)<_e(l.fitWidth,1)&&(f=!1),s===Dn&&(f=!1),Zn(r,this.cn("isDraggable"),f),!this.option("zoom"))return;let g=S&&_e(u)>_e(d),b=!g&&!f&&E&&_e(u)<_e(d);Zn(r,this.cn("canZoomIn"),g),Zn(r,this.cn("canZoomOut"),b);for(const k of r.querySelectorAll("[data-panzoom-action]")){let w=!1,_=!1;switch(k.dataset.panzoomAction){case"zoomIn":S?w=!0:_=!0;break;case"zoomOut":E?w=!0:_=!0;break;case"toggleZoom":case"iterateZoom":S||E?w=!0:_=!0;const C=k.querySelector("g");C&&(C.style.display=S?"":"none")}w?(k.removeAttribute("disabled"),k.removeAttribute("tabindex")):_&&(k.setAttribute("disabled",""),k.setAttribute("tabindex","-1"))}}panTo({x:e=this.target.e,y:r=this.target.f,scale:s=this.targetScale,friction:l=this.option("friction"),angle:d=0,originX:m=0,originY:u=0,flipX:v=!1,flipY:S=!1,ignoreBounds:E=!1}){this.state!==kt.Destroy&&this.applyChange({panX:e-this.target.e,panY:r-this.target.f,scale:s/this.targetScale,angle:d,originX:m,originY:u,friction:l,flipX:v,flipY:S,ignoreBounds:E})}applyChange({panX:e=0,panY:r=0,scale:s=1,angle:l=0,originX:d=-this.current.e,originY:m=-this.current.f,friction:u=this.option("friction"),flipX:v=!1,flipY:S=!1,ignoreBounds:E=!1,bounce:h=this.option("bounce")}){const f=this.state;if(f===kt.Destroy)return;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.friction=u||0,this.ignoreBounds=E;const{current:g}=this,b=g.e,k=g.f,w=this.getMatrix(this.target);let _=new DOMMatrix().translate(b,k).translate(d,m).translate(e,r);if(this.option("zoom")){if(!E){const C=this.targetScale,T=this.minScale,M=this.maxScale;C*s<T&&(s=T/C),C*s>M&&(s=M/C)}_=_.scale(s)}_=_.translate(-d,-m).translate(-b,-k).multiply(w),l&&(_=_.rotate(l)),v&&(_=_.scale(-1,1)),S&&(_=_.scale(1,-1));for(const C of ri)C!=="e"&&C!=="f"&&(_[C]>this.minScale+1e-5||_[C]<this.minScale-1e-5)?this.target[C]=_[C]:this.target[C]=_e(_[C],Fr);(this.targetScale<this.scale||Math.abs(s-1)>.1||this.panMode===Dn||h===!1)&&!E&&this.clampTargetBounds(),f===kt.Init?this.animate():this.isResting||(this.state=kt.Panning,this.requestTick())}stop(e=!1){if(this.state===kt.Init||this.state===kt.Destroy)return;const r=this.isTicking;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.isBouncingX=!1,this.isBouncingY=!1;for(const s of ri)this.velocity[s]=0,e==="current"?this.current[s]=this.target[s]:e==="target"&&(this.target[s]=this.current[s]);this.setTransform(),wt(this.container,"is-scaling"),wt(this.container,"is-animating"),this.isTicking=!1,this.state=kt.Ready,r&&(this.emit("endAnimation"),this.updateControls())}requestTick(){this.isTicking||(this.emit("startAnimation"),this.updateControls(),qe(this.container,"is-animating"),this.isScaling&&qe(this.container,"is-scaling")),this.isTicking=!0,this.rAF||(this.rAF=requestAnimationFrame(()=>this.animate()))}panWithMouse(e,r=this.option("mouseMoveFriction")){if(this.pmme=e,this.panMode!==Dn||!e||_e(this.targetScale)<=_e(this.minScale))return;this.emit("mouseMove",e);const{container:s,containerRect:l,contentRect:d}=this,m=l.width,u=l.height,v=s.getBoundingClientRect(),S=(e.clientX||0)-v.left,E=(e.clientY||0)-v.top;let{contentWidth:h,contentHeight:f}=this.calculateContentDim(this.target);const g=this.option("mouseMoveFactor");g>1&&(h!==m&&(h*=g),f!==u&&(f*=g));let b=.5*(h-m)-S/m*100/100*(h-m);b+=.5*(d.right-d.left);let k=.5*(f-u)-E/u*100/100*(f-u);k+=.5*(d.bottom-d.top),this.applyChange({panX:b-this.target.e,panY:k-this.target.f,friction:r})}zoomWithWheel(e){if(this.state===kt.Destroy||this.state===kt.Init)return;const r=Date.now();if(r-this.pwt<45)return void e.preventDefault();this.pwt=r;var s=[-e.deltaX||0,-e.deltaY||0,-e.detail||0].reduce(function(S,E){return Math.abs(E)>Math.abs(S)?E:S});const l=Math.max(-1,Math.min(1,s)),{targetScale:d,maxScale:m,minScale:u}=this;let v=d*(100+45*l)/100;_e(v)<_e(u)&&_e(d)<=_e(u)?(this.cwd+=Math.abs(l),v=u):_e(v)>_e(m)&&_e(d)>=_e(m)?(this.cwd+=Math.abs(l),v=m):(this.cwd=0,v=Math.max(Math.min(v,m),u)),this.cwd>this.option("wheelLimit")||(e.preventDefault(),_e(v)!==_e(d)&&this.zoomTo(v,{event:e}))}canZoomIn(){return this.option("zoom")&&(_e(this.contentRect.width,1)<_e(this.contentRect.fitWidth,1)||_e(this.targetScale)<_e(this.maxScale))}canZoomOut(){return this.option("zoom")&&_e(this.targetScale)>_e(this.minScale)}zoomIn(e=1.25,r){this.zoomTo(this.targetScale*e,r)}zoomOut(e=.8,r){this.zoomTo(this.targetScale*e,r)}zoomToFit(e){this.zoomTo("fit",e)}zoomToCover(e){this.zoomTo("cover",e)}zoomToFull(e){this.zoomTo("full",e)}zoomToMax(e){this.zoomTo("max",e)}toggleZoom(e){this.zoomTo(this.getNextScale("toggleZoom"),e)}toggleMax(e){this.zoomTo(this.getNextScale("toggleMax"),e)}toggleCover(e){this.zoomTo(this.getNextScale("toggleCover"),e)}iterateZoom(e){this.zoomTo("next",e)}zoomTo(e=1,{friction:r=On,originX:s=On,originY:l=On,event:d}={}){if(this.isContentLoading||this.state===kt.Destroy)return;const{targetScale:m,fullScale:u,maxScale:v,coverScale:S}=this;if(this.stop(),this.panMode===Dn&&(d=this.pmme||d),d||s===On||l===On){const h=this.content.getBoundingClientRect(),f=this.container.getBoundingClientRect(),g=d?d.clientX:f.left+.5*f.width,b=d?d.clientY:f.top+.5*f.height;s=g-h.left-.5*h.width,l=b-h.top-.5*h.height}let E=1;typeof e=="number"?E=e:e==="full"?E=u:e==="cover"?E=S:e==="max"?E=v:e==="fit"?E=1:e==="next"&&(E=this.getNextScale("iterateZoom")),E=E/m||1,r=r===On?E>1?.15:.25:r,this.applyChange({scale:E,originX:s,originY:l,friction:r}),d&&this.panMode===Dn&&this.panWithMouse(d,r)}rotateCCW(){this.applyChange({angle:-90})}rotateCW(){this.applyChange({angle:90})}flipX(){this.applyChange({flipX:!0})}flipY(){this.applyChange({flipY:!0})}fitX(){this.stop("target");const{containerRect:e,contentRect:r,target:s}=this;this.applyChange({panX:.5*e.width-(r.left+.5*r.fitWidth)-s.e,panY:.5*e.height-(r.top+.5*r.fitHeight)-s.f,scale:e.width/r.fitWidth/this.targetScale,originX:0,originY:0,ignoreBounds:!0})}fitY(){this.stop("target");const{containerRect:e,contentRect:r,target:s}=this;this.applyChange({panX:.5*e.width-(r.left+.5*r.fitWidth)-s.e,panY:.5*e.innerHeight-(r.top+.5*r.fitHeight)-s.f,scale:e.height/r.fitHeight/this.targetScale,originX:0,originY:0,ignoreBounds:!0})}toggleFS(){const{container:e}=this,r=this.cn("inFullscreen"),s=this.cn("htmlHasFullscreen");e.classList.toggle(r);const l=e.classList.contains(r);l?(document.documentElement.classList.add(s),document.addEventListener("keydown",this.onKeydown,!0)):(document.documentElement.classList.remove(s),document.removeEventListener("keydown",this.onKeydown,!0)),this.updateMetrics(),this.emit(l?"enterFS":"exitFS")}getMatrix(e=this.current){const{a:r,b:s,c:l,d,e:m,f:u}=e;return new DOMMatrix([r,s,l,d,m,u])}reset(e){if(this.state!==kt.Init&&this.state!==kt.Destroy){this.stop("current");for(const r of ri)this.target[r]=zr[r];this.target.a=this.minScale,this.target.d=this.minScale,this.clampTargetBounds(),this.isResting||(this.friction=e===void 0?this.option("friction"):e,this.state=kt.Panning,this.requestTick())}}destroy(){this.stop(),this.state=kt.Destroy,this.detachEvents(),this.detachObserver();const{container:e,content:r}=this,s=this.option("classes")||{};for(const l of Object.values(s))e.classList.remove(l+"");r&&(r.removeEventListener("load",this.onLoad),r.removeEventListener("error",this.onError)),this.detachPlugins()}}Object.defineProperty(Fi,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:sd}),Object.defineProperty(Fi,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:{}});const Do=function(p,e){let r=!0;return(...s)=>{r&&(r=!1,p(...s),setTimeout(()=>{r=!0},e))}},Oo=(p,e)=>{let r=[];return p.childNodes.forEach(s=>{s.nodeType!==Node.ELEMENT_NODE||e&&!s.matches(e)||r.push(s)}),r},cd={viewport:null,track:null,enabled:!0,slides:[],axis:"x",transition:"fade",preload:1,slidesPerPage:"auto",initialPage:0,friction:.12,Panzoom:{decelFriction:.12},center:!0,infinite:!0,fill:!0,dragFree:!1,adaptiveHeight:!1,direction:"ltr",classes:{container:"f-carousel",viewport:"f-carousel__viewport",track:"f-carousel__track",slide:"f-carousel__slide",isLTR:"is-ltr",isRTL:"is-rtl",isHorizontal:"is-horizontal",isVertical:"is-vertical",inTransition:"in-transition",isSelected:"is-selected"},l10n:{NEXT:"Next slide",PREV:"Previous slide",GOTO:"Go to slide #%d"}};var qt;(function(p){p[p.Init=0]="Init",p[p.Ready=1]="Ready",p[p.Destroy=2]="Destroy"})(qt||(qt={}));const xa=p=>{if(typeof p=="string"||p instanceof HTMLElement)p={html:p};else{const e=p.thumb;e!==void 0&&(typeof e=="string"&&(p.thumbSrc=e),e instanceof HTMLImageElement&&(p.thumbEl=e,p.thumbElSrc=e.src,p.thumbSrc=e.src),delete p.thumb)}return Object.assign({html:"",el:null,isDom:!1,class:"",customClass:"",index:-1,dim:0,gap:0,pos:0,transition:!1},p)},ud=(p={})=>Object.assign({index:-1,slides:[],dim:0,pos:-1},p);class Fn extends sa{constructor(e,r){super(r),Object.defineProperty(this,"instance",{enumerable:!0,configurable:!0,writable:!0,value:e})}attach(){}detach(){}}const dd={classes:{list:"f-carousel__dots",isDynamic:"is-dynamic",hasDots:"has-dots",dot:"f-carousel__dot",isBeforePrev:"is-before-prev",isPrev:"is-prev",isCurrent:"is-current",isNext:"is-next",isAfterNext:"is-after-next"},dotTpl:'<button type="button" data-carousel-page="%i" aria-label="{{GOTO}}"><span class="f-carousel__dot" aria-hidden="true"></span></button>',dynamicFrom:11,maxCount:1/0,minCount:2};class Ts extends Fn{constructor(){super(...arguments),Object.defineProperty(this,"isDynamic",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"list",{enumerable:!0,configurable:!0,writable:!0,value:null})}onRefresh(){this.refresh()}build(){let e=this.list;if(!e){e=document.createElement("ul"),qe(e,this.cn("list")),e.setAttribute("role","tablist");const r=this.instance.container;r.appendChild(e),qe(r,this.cn("hasDots")),this.list=e}return e}refresh(){var e;const r=this.instance.pages.length,s=Math.min(2,this.option("minCount")),l=Math.max(2e3,this.option("maxCount")),d=this.option("dynamicFrom");if(r<s||r>l)return void this.cleanup();const m=typeof d=="number"&&r>5&&r>=d,u=!this.list||this.isDynamic!==m||this.list.children.length!==r;u&&this.cleanup();const v=this.build();if(Zn(v,this.cn("isDynamic"),!!m),u)for(let h=0;h<r;h++)v.append(this.createItem(h));let S,E=0;for(const h of[...v.children]){const f=E===this.instance.page;f&&(S=h),Zn(h,this.cn("isCurrent"),f),(e=h.children[0])===null||e===void 0||e.setAttribute("aria-selected",f?"true":"false");for(const g of["isBeforePrev","isPrev","isNext","isAfterNext"])wt(h,this.cn(g));E++}if(S=S||v.firstChild,m&&S){const h=S.previousElementSibling,f=h&&h.previousElementSibling;qe(h,this.cn("isPrev")),qe(f,this.cn("isBeforePrev"));const g=S.nextElementSibling,b=g&&g.nextElementSibling;qe(g,this.cn("isNext")),qe(b,this.cn("isAfterNext"))}this.isDynamic=m}createItem(e=0){var r;const s=document.createElement("li");s.setAttribute("role","presentation");const l=Xn(this.instance.localize(this.option("dotTpl"),[["%d",e+1]]).replace(/\%i/g,e+""));return s.appendChild(l),(r=s.children[0])===null||r===void 0||r.setAttribute("role","tab"),s}cleanup(){this.list&&(this.list.remove(),this.list=null),this.isDynamic=!1,wt(this.instance.container,this.cn("hasDots"))}attach(){this.instance.on(["refresh","change"],this.onRefresh)}detach(){this.instance.off(["refresh","change"],this.onRefresh),this.cleanup()}}Object.defineProperty(Ts,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:dd});const Vr="disabled",qr="next",Po="prev";class Ms extends Fn{constructor(){super(...arguments),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"prev",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"next",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"isDom",{enumerable:!0,configurable:!0,writable:!0,value:!1})}onRefresh(){const e=this.instance,r=e.pages.length,s=e.page;if(r<2)return void this.cleanup();this.build();let l=this.prev,d=this.next;l&&d&&(l.removeAttribute(Vr),d.removeAttribute(Vr),e.isInfinite||(s<=0&&l.setAttribute(Vr,""),s>=r-1&&d.setAttribute(Vr,"")))}addBtn(e){var r;const s=this.instance,l=document.createElement("button");l.setAttribute("tabindex","0"),l.setAttribute("title",s.localize(`{{${e.toUpperCase()}}}`)),qe(l,this.cn("button")+" "+this.cn(e===qr?"isNext":"isPrev"));const d=s.isRTL?e===qr?Po:qr:e;var m;return l.innerHTML=s.localize(this.option(`${d}Tpl`)),l.dataset[`carousel${m=e,m?m.match("^[a-z]")?m.charAt(0).toUpperCase()+m.substring(1):m:""}`]="true",(r=this.container)===null||r===void 0||r.appendChild(l),l}build(){const e=this.instance.container,r=this.cn("container");let{container:s,prev:l,next:d}=this;s||(s=e.querySelector("."+r),this.isDom=!!s),s||(s=document.createElement("div"),qe(s,r),e.appendChild(s)),this.container=s,d||(d=s.querySelector("[data-carousel-next]")),d||(d=this.addBtn(qr)),this.next=d,l||(l=s.querySelector("[data-carousel-prev]")),l||(l=this.addBtn(Po)),this.prev=l}cleanup(){this.isDom||(this.prev&&this.prev.remove(),this.next&&this.next.remove(),this.container&&this.container.remove()),this.prev=null,this.next=null,this.container=null,this.isDom=!1}attach(){this.instance.on(["refresh","change"],this.onRefresh)}detach(){this.instance.off(["refresh","change"],this.onRefresh),this.cleanup()}}Object.defineProperty(Ms,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{classes:{container:"f-carousel__nav",button:"f-button",isNext:"is-next",isPrev:"is-prev"},nextTpl:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M9 3l9 9-9 9"/></svg>',prevTpl:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M15 3l-9 9 9 9"/></svg>'}});class As extends Fn{constructor(){super(...arguments),Object.defineProperty(this,"selectedIndex",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"target",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"nav",{enumerable:!0,configurable:!0,writable:!0,value:null})}addAsTargetFor(e){this.target=this.instance,this.nav=e,this.attachEvents()}addAsNavFor(e){this.nav=this.instance,this.target=e,this.attachEvents()}attachEvents(){const{nav:e,target:r}=this;e&&r&&(e.options.initialSlide=r.options.initialPage,e.state===qt.Ready?this.onNavReady(e):e.on("ready",this.onNavReady),r.state===qt.Ready?this.onTargetReady(r):r.on("ready",this.onTargetReady))}onNavReady(e){e.on("createSlide",this.onNavCreateSlide),e.on("Panzoom.click",this.onNavClick),e.on("Panzoom.touchEnd",this.onNavTouch),this.onTargetChange()}onTargetReady(e){e.on("change",this.onTargetChange),e.on("Panzoom.refresh",this.onTargetChange),this.onTargetChange()}onNavClick(e,r,s){this.onNavTouch(e,e.panzoom,s)}onNavTouch(e,r,s){var l,d;if(Math.abs(r.dragOffset.x)>3||Math.abs(r.dragOffset.y)>3)return;const m=s.target,{nav:u,target:v}=this;if(!u||!v||!m)return;const S=m.closest("[data-index]");if(s.stopPropagation(),s.preventDefault(),!S)return;const E=parseInt(S.dataset.index||"",10)||0,h=v.getPageForSlide(E),f=u.getPageForSlide(E);u.slideTo(f),v.slideTo(h,{friction:((d=(l=this.nav)===null||l===void 0?void 0:l.plugins)===null||d===void 0?void 0:d.Sync.option("friction"))||0}),this.markSelectedSlide(E)}onNavCreateSlide(e,r){r.index===this.selectedIndex&&this.markSelectedSlide(r.index)}onTargetChange(){var e,r;const{target:s,nav:l}=this;if(!s||!l||l.state!==qt.Ready||s.state!==qt.Ready)return;const d=(r=(e=s.pages[s.page])===null||e===void 0?void 0:e.slides[0])===null||r===void 0?void 0:r.index,m=l.getPageForSlide(d);this.markSelectedSlide(d),l.slideTo(m,l.prevPage===null&&s.prevPage===null?{friction:0}:void 0)}markSelectedSlide(e){const r=this.nav;r&&r.state===qt.Ready&&(this.selectedIndex=e,[...r.slides].map(s=>{s.el&&s.el.classList[s.index===e?"add":"remove"]("is-nav-selected")}))}attach(){const e=this;let r=e.options.target,s=e.options.nav;r?e.addAsNavFor(r):s&&e.addAsTargetFor(s)}detach(){const e=this,r=e.nav,s=e.target;r&&(r.off("ready",e.onNavReady),r.off("createSlide",e.onNavCreateSlide),r.off("Panzoom.click",e.onNavClick),r.off("Panzoom.touchEnd",e.onNavTouch)),e.nav=null,s&&(s.off("ready",e.onTargetReady),s.off("refresh",e.onTargetChange),s.off("change",e.onTargetChange)),e.target=null}}Object.defineProperty(As,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{friction:.35}});const fd={Navigation:Ms,Dots:Ts,Sync:As},Wr="animationend",Ro="isSelected",Yr="slide";class Ui extends no{get axis(){return this.isHorizontal?"e":"f"}get isEnabled(){return this.state===qt.Ready}get isInfinite(){let e=!1;const{contentDim:r,viewportDim:s,pages:l,slides:d}=this,m=d[0];return l.length>=2&&m&&r+m.dim>=s&&(e=this.option("infinite")),e}get isRTL(){return this.option("direction")==="rtl"}get isHorizontal(){return this.option("axis")==="x"}constructor(e,r={},s={}){if(super(),Object.defineProperty(this,"bp",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"lp",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"userOptions",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"userPlugins",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:qt.Init}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"prevPage",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"viewport",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"track",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"slides",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"pages",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"panzoom",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"inTransition",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"contentDim",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"viewportDim",{enumerable:!0,configurable:!0,writable:!0,value:0}),typeof e=="string"&&(e=document.querySelector(e)),!e||!vn(e))throw new Error("No Element found");this.container=e,this.slideNext=Do(this.slideNext.bind(this),150),this.slidePrev=Do(this.slidePrev.bind(this),150),this.userOptions=r,this.userPlugins=s,queueMicrotask(()=>{this.processOptions()})}processOptions(){var e,r;const s=bn({},Ui.defaults,this.userOptions);let l="";const d=s.breakpoints;if(d&&Fa(d))for(const[m,u]of Object.entries(d))window.matchMedia(m).matches&&Fa(u)&&(l+=m,bn(s,u));l===this.bp&&this.state!==qt.Init||(this.bp=l,this.state===qt.Ready&&(s.initialSlide=((r=(e=this.pages[this.page])===null||e===void 0?void 0:e.slides[0])===null||r===void 0?void 0:r.index)||0),this.state!==qt.Init&&this.destroy(),super.setOptions(s),this.option("enabled")===!1?this.attachEvents():setTimeout(()=>{this.init()},0))}init(){this.state=qt.Init,this.emit("init"),this.attachPlugins(Object.assign(Object.assign({},Ui.Plugins),this.userPlugins)),this.emit("attachPlugins"),this.initLayout(),this.initSlides(),this.updateMetrics(),this.setInitialPosition(),this.initPanzoom(),this.attachEvents(),this.state=qt.Ready,this.emit("ready")}initLayout(){const{container:e}=this,r=this.option("classes");qe(e,this.cn("container")),Zn(e,r.isLTR,!this.isRTL),Zn(e,r.isRTL,this.isRTL),Zn(e,r.isVertical,!this.isHorizontal),Zn(e,r.isHorizontal,this.isHorizontal);let s=this.option("viewport")||e.querySelector(`.${r.viewport}`);s||(s=document.createElement("div"),qe(s,r.viewport),s.append(...Oo(e,`.${r.slide}`)),e.prepend(s)),s.addEventListener("scroll",this.onScroll);let l=this.option("track")||e.querySelector(`.${r.track}`);l||(l=document.createElement("div"),qe(l,r.track),l.append(...Array.from(s.childNodes))),l.setAttribute("aria-live","polite"),s.contains(l)||s.prepend(l),this.viewport=s,this.track=l,this.emit("initLayout")}initSlides(){const{track:e}=this;if(!e)return;const r=[...this.slides],s=[];[...Oo(e,`.${this.cn(Yr)}`)].forEach(l=>{if(vn(l)){const d=xa({el:l,isDom:!0,index:this.slides.length});s.push(d)}});for(let l of[...this.option("slides",[])||[],...r])s.push(xa(l));this.slides=s;for(let l=0;l<this.slides.length;l++)this.slides[l].index=l;for(const l of s)this.emit("beforeInitSlide",l,l.index),this.emit("initSlide",l,l.index);this.emit("initSlides")}setInitialPage(){const e=this.option("initialSlide");this.page=typeof e=="number"?this.getPageForSlide(e):parseInt(this.option("initialPage",0)+"",10)||0}setInitialPosition(){const{track:e,pages:r,isHorizontal:s}=this;if(!e||!r.length)return;let l=this.page;r[l]||(this.page=l=0);const d=(r[l].pos||0)*(this.isRTL&&s?1:-1),m=s?`${d}px`:"0",u=s?"0":`${d}px`;e.style.transform=`translate3d(${m}, ${u}, 0) scale(1)`,this.option("adaptiveHeight")&&this.setViewportHeight()}initPanzoom(){this.panzoom&&(this.panzoom.destroy(),this.panzoom=null);const e=this.option("Panzoom")||{};this.panzoom=new Fi(this.viewport,bn({},{content:this.track,zoom:!1,panOnlyZoomed:!1,lockAxis:this.isHorizontal?"x":"y",infinite:this.isInfinite,click:!1,dblClick:!1,touch:r=>!(this.pages.length<2&&!r.options.infinite),bounds:()=>this.getBounds(),maxVelocity:r=>Math.abs(r.target[this.axis]-r.current[this.axis])<2*this.viewportDim?100:0},e)),this.panzoom.on("*",(r,s,...l)=>{this.emit(`Panzoom.${s}`,r,...l)}),this.panzoom.on("decel",this.onDecel),this.panzoom.on("refresh",this.onRefresh),this.panzoom.on("beforeTransform",this.onBeforeTransform),this.panzoom.on("endAnimation",this.onEndAnimation)}attachEvents(){const e=this.container;e&&(e.addEventListener("click",this.onClick,{passive:!1,capture:!1}),e.addEventListener("slideTo",this.onSlideTo)),window.addEventListener("resize",this.onResize)}createPages(){let e=[];const{contentDim:r,viewportDim:s}=this;let l=this.option("slidesPerPage");l=(l==="auto"||r<=s)&&this.option("fill")!==!1?1/0:parseFloat(l+"");let d=0,m=0,u=0;for(const v of this.slides)(!e.length||m+v.dim-s>.05||u>=l)&&(e.push(ud()),d=e.length-1,m=0,u=0),e[d].slides.push(v),m+=v.dim+v.gap,u++;return e}processPages(){const e=this.pages,{contentDim:r,viewportDim:s,isInfinite:l}=this,d=this.option("center"),m=this.option("fill"),u=m&&d&&r>s&&!l;if(e.forEach((E,h)=>{var f;E.index=h,E.pos=((f=E.slides[0])===null||f===void 0?void 0:f.pos)||0,E.dim=0;for(const[g,b]of E.slides.entries())E.dim+=b.dim,g<E.slides.length-1&&(E.dim+=b.gap);u&&E.pos+.5*E.dim<.5*s?E.pos=0:u&&E.pos+.5*E.dim>=r-.5*s?E.pos=r-s:d&&(E.pos+=-.5*(s-E.dim))}),e.forEach(E=>{m&&!l&&r>s&&(E.pos=Math.max(E.pos,0),E.pos=Math.min(E.pos,r-s)),E.pos=_e(E.pos,1e3),E.dim=_e(E.dim,1e3),Math.abs(E.pos)<=.1&&(E.pos=0)}),l)return e;const v=[];let S;return e.forEach(E=>{const h=Object.assign({},E);S&&h.pos===S.pos?(S.dim+=h.dim,S.slides=[...S.slides,...h.slides]):(h.index=v.length,S=h,v.push(h))}),v}getPageFromIndex(e=0){const r=this.pages.length;let s;return e=parseInt((e||0).toString())||0,s=this.isInfinite?(e%r+r)%r:Math.max(Math.min(e,r-1),0),s}getSlideMetrics(e){var r,s;const l=this.isHorizontal?"width":"height";let d=0,m=0,u=e.el;const v=!(!u||u.parentNode);if(u?d=parseFloat(u.dataset[l]||"")||0:(u=document.createElement("div"),u.style.visibility="hidden",(this.track||document.body).prepend(u)),qe(u,this.cn(Yr)+" "+e.class+" "+e.customClass),d)u.style[l]=`${d}px`,u.style[l==="width"?"height":"width"]="";else{v&&(this.track||document.body).prepend(u),d=u.getBoundingClientRect()[l]*Math.max(1,((r=window.visualViewport)===null||r===void 0?void 0:r.scale)||1);let E=u[this.isHorizontal?"offsetWidth":"offsetHeight"];E-1>d&&(d=E)}const S=getComputedStyle(u);return S.boxSizing==="content-box"&&(this.isHorizontal?(d+=parseFloat(S.paddingLeft)||0,d+=parseFloat(S.paddingRight)||0):(d+=parseFloat(S.paddingTop)||0,d+=parseFloat(S.paddingBottom)||0)),m=parseFloat(S[this.isHorizontal?"marginRight":"marginBottom"])||0,v?(s=u.parentElement)===null||s===void 0||s.removeChild(u):e.el||u.remove(),{dim:_e(d,1e3),gap:_e(m,1e3)}}getBounds(){const{isInfinite:e,isRTL:r,isHorizontal:s,pages:l}=this;let d={min:0,max:0};if(e)d={min:-1/0,max:1/0};else if(l.length){const m=l[0].pos,u=l[l.length-1].pos;d=r&&s?{min:m,max:u}:{min:-1*u,max:-1*m}}return{x:s?d:{min:0,max:0},y:s?{min:0,max:0}:d}}repositionSlides(){let e,{isHorizontal:r,isRTL:s,isInfinite:l,viewport:d,viewportDim:m,contentDim:u,page:v,pages:S,slides:E,panzoom:h}=this,f=0,g=0,b=0,k=0;h?k=-1*h.current[this.axis]:S[v]&&(k=S[v].pos||0),e=r?s?"right":"left":"top",s&&r&&(k*=-1);for(const T of E){const M=T.el;M?(e==="top"?(M.style.right="",M.style.left=""):M.style.top="",T.index!==f?M.style[e]=g===0?"":`${_e(g,1e3)}px`:M.style[e]="",b+=T.dim+T.gap,f++):g+=T.dim+T.gap}if(l&&b&&d){let T=getComputedStyle(d),M="padding",y=r?"Right":"Bottom",O=parseFloat(T[M+(r?"Left":"Top")]);k-=O,m+=O,m+=parseFloat(T[M+y]);for(const B of E)B.el&&(_e(B.pos)<_e(m)&&_e(B.pos+B.dim+B.gap)<_e(k)&&_e(k)>_e(u-m)&&(B.el.style[e]=`${_e(g+b,1e3)}px`),_e(B.pos+B.gap)>=_e(u-m)&&_e(B.pos)>_e(k+m)&&_e(k)<_e(m)&&(B.el.style[e]=`-${_e(b,1e3)}px`))}let w,_,C=[...this.inTransition];if(C.length>1&&(w=S[C[0]],_=S[C[1]]),w&&_){let T=0;for(const M of E)M.el?this.inTransition.has(M.index)&&w.slides.indexOf(M)<0&&(M.el.style[e]=`${_e(T+(w.pos-_.pos),1e3)}px`):T+=M.dim+M.gap}}createSlideEl(e){const{track:r,slides:s}=this;if(!r||!e||e.el&&e.el.parentNode)return;const l=e.el||document.createElement("div");qe(l,this.cn(Yr)),qe(l,e.class),qe(l,e.customClass);const d=e.html;d&&(d instanceof HTMLElement?l.appendChild(d):l.innerHTML=e.html+"");const m=[];s.forEach((E,h)=>{E.el&&m.push(h)});const u=e.index;let v=null;m.length&&(v=s[m.reduce((E,h)=>Math.abs(h-u)<Math.abs(E-u)?h:E)]);const S=v&&v.el&&v.el.parentNode?v.index<e.index?v.el.nextSibling:v.el:null;r.insertBefore(l,r.contains(S)?S:null),e.el=l,this.emit("createSlide",e)}removeSlideEl(e,r=!1){const s=e==null?void 0:e.el;if(!s||!s.parentNode)return;const l=this.cn(Ro);if(s.classList.contains(l)&&(wt(s,l),this.emit("unselectSlide",e)),e.isDom&&!r)return s.removeAttribute("aria-hidden"),s.removeAttribute("data-index"),void(s.style.left="");this.emit("removeSlide",e);const d=new CustomEvent(Wr);s.dispatchEvent(d),e.el&&(e.el.remove(),e.el=null)}transitionTo(e=0,r=this.option("transition")){var s,l,d,m;if(!r)return!1;const u=this.page,{pages:v,panzoom:S}=this;e=parseInt((e||0).toString())||0;const E=this.getPageFromIndex(e);if(!S||!v[E]||v.length<2||Math.abs((((l=(s=v[u])===null||s===void 0?void 0:s.slides[0])===null||l===void 0?void 0:l.dim)||0)-this.viewportDim)>1)return!1;let h=e>u?1:-1;this.isInfinite&&(u===0&&e===v.length-1&&(h=-1),u===v.length-1&&e===0&&(h=1));const f=v[E].pos*(this.isRTL?1:-1);if(u===E&&Math.abs(f-S.target[this.axis])<1)return!1;this.clearTransitions();const g=S.isResting;qe(this.container,this.cn("inTransition"));const b=((d=v[u])===null||d===void 0?void 0:d.slides[0])||null,k=((m=v[E])===null||m===void 0?void 0:m.slides[0])||null;this.inTransition.add(k.index),this.createSlideEl(k);let w=b.el,_=k.el;g||r===Yr||(r="fadeFast",w=null);const C=this.isRTL?"next":"prev",T=this.isRTL?"prev":"next";return w&&(this.inTransition.add(b.index),b.transition=r,w.addEventListener(Wr,this.onAnimationEnd),w.classList.add(`f-${r}Out`,`to-${h>0?T:C}`)),_&&(k.transition=r,_.addEventListener(Wr,this.onAnimationEnd),_.classList.add(`f-${r}In`,`from-${h>0?C:T}`)),S.current[this.axis]=f,S.target[this.axis]=f,S.requestTick(),this.onChange(E),!0}manageSlideVisiblity(){const e=new Set,r=new Set,s=this.getVisibleSlides(parseFloat(this.option("preload",0)+"")||0);for(const l of this.slides)s.has(l)?e.add(l):r.add(l);for(const l of this.inTransition)e.add(this.slides[l]);for(const l of e)this.createSlideEl(l),this.lazyLoadSlide(l);for(const l of r)e.has(l)||this.removeSlideEl(l);this.markSelectedSlides(),this.repositionSlides()}markSelectedSlides(){if(!this.pages[this.page]||!this.pages[this.page].slides)return;const e="aria-hidden";let r=this.cn(Ro);if(r)for(const s of this.slides){const l=s.el;l&&(l.dataset.index=`${s.index}`,l.classList.contains("f-thumbs__slide")?this.getVisibleSlides(0).has(s)?l.removeAttribute(e):l.setAttribute(e,"true"):this.pages[this.page].slides.includes(s)?(l.classList.contains(r)||(qe(l,r),this.emit("selectSlide",s)),l.removeAttribute(e)):(l.classList.contains(r)&&(wt(l,r),this.emit("unselectSlide",s)),l.setAttribute(e,"true")))}}flipInfiniteTrack(){const{axis:e,isHorizontal:r,isInfinite:s,isRTL:l,viewportDim:d,contentDim:m}=this,u=this.panzoom;if(!u||!s)return;let v=u.current[e],S=u.target[e]-v,E=0,h=.5*d;l&&r?(v<-h&&(E=-1,v+=m),v>m-h&&(E=1,v-=m)):(v>h&&(E=1,v-=m),v<-m+h&&(E=-1,v+=m)),E&&(u.current[e]=v,u.target[e]=v+S)}lazyLoadImg(e,r){const s=this,l="f-fadeIn",d="is-preloading";let m=!1,u=null;const v=()=>{m||(m=!0,u&&(u.remove(),u=null),wt(r,d),r.complete&&(qe(r,l),setTimeout(()=>{wt(r,l)},350)),this.option("adaptiveHeight")&&e.el&&this.pages[this.page].slides.indexOf(e)>-1&&(s.updateMetrics(),s.setViewportHeight()),this.emit("load",e))};qe(r,d),r.src=r.dataset.lazySrcset||r.dataset.lazySrc||"",delete r.dataset.lazySrc,delete r.dataset.lazySrcset,r.addEventListener("error",()=>{v()}),r.addEventListener("load",()=>{v()}),setTimeout(()=>{const S=r.parentNode;S&&e.el&&(r.complete?v():m||(u=Xn(io),S.insertBefore(u,r)))},300)}lazyLoadSlide(e){const r=e&&e.el;if(!r)return;const s=new Set;let l=Array.from(r.querySelectorAll("[data-lazy-src],[data-lazy-srcset]"));r.dataset.lazySrc&&l.push(r),l.map(d=>{d instanceof HTMLImageElement?s.add(d):d instanceof HTMLElement&&d.dataset.lazySrc&&(d.style.backgroundImage=`url('${d.dataset.lazySrc}')`,delete d.dataset.lazySrc)});for(const d of s)this.lazyLoadImg(e,d)}onAnimationEnd(e){var r;const s=e.target,l=s?parseInt(s.dataset.index||"",10)||0:-1,d=this.slides[l],m=e.animationName;if(!s||!d||!m)return;const u=!!this.inTransition.has(l)&&d.transition;u&&m.substring(0,u.length+2)===`f-${u}`&&this.inTransition.delete(l),this.inTransition.size||this.clearTransitions(),l===this.page&&(!((r=this.panzoom)===null||r===void 0)&&r.isResting)&&this.emit("settle")}onDecel(e,r=0,s=0,l=0,d=0){if(this.option("dragFree"))return void this.setPageFromPosition();const{isRTL:m,isHorizontal:u,axis:v,pages:S}=this,E=S.length,h=Math.abs(Math.atan2(s,r)/(Math.PI/180));let f=0;if(f=h>45&&h<135?u?0:s:u?r:0,!E)return;let g=this.page,b=m&&u?1:-1;const k=e.current[v]*b;let{pageIndex:w}=this.getPageFromPosition(k);Math.abs(f)>5?(S[g].dim<document.documentElement["client"+(this.isHorizontal?"Width":"Height")]-1&&(g=w),g=m&&u?f<0?g-1:g+1:f<0?g+1:g-1):g=l===0&&d===0?g:w,this.slideTo(g,{transition:!1,friction:e.option("decelFriction")})}onClick(e){const r=e.target,s=r&&vn(r)?r.dataset:null;let l,d;s&&(s.carouselPage!==void 0?(d="slideTo",l=s.carouselPage):s.carouselNext!==void 0?d="slideNext":s.carouselPrev!==void 0&&(d="slidePrev")),d?(e.preventDefault(),e.stopPropagation(),r&&!r.hasAttribute("disabled")&&this[d](l)):this.emit("click",e)}onSlideTo(e){const r=e.detail||0;this.slideTo(this.getPageForSlide(r),{friction:0})}onChange(e,r=0){const s=this.page;this.prevPage=s,this.page=e,this.option("adaptiveHeight")&&this.setViewportHeight(),e!==s&&(this.markSelectedSlides(),this.emit("change",e,s,r))}onRefresh(){let e=this.contentDim,r=this.viewportDim;this.updateMetrics(),this.contentDim===e&&this.viewportDim===r||this.slideTo(this.page,{friction:0,transition:!1})}onScroll(){var e;(e=this.viewport)===null||e===void 0||e.scroll(0,0)}onResize(){this.option("breakpoints")&&this.processOptions()}onBeforeTransform(e){this.lp!==e.current[this.axis]&&(this.flipInfiniteTrack(),this.manageSlideVisiblity()),this.lp=e.current.e}onEndAnimation(){this.inTransition.size||this.emit("settle")}reInit(e=null,r=null){this.destroy(),this.state=qt.Init,this.prevPage=null,this.userOptions=e||this.userOptions,this.userPlugins=r||this.userPlugins,this.processOptions()}slideTo(e=0,{friction:r=this.option("friction"),transition:s=this.option("transition")}={}){if(this.state===qt.Destroy)return;e=parseInt((e||0).toString())||0;const l=this.getPageFromIndex(e),{axis:d,isHorizontal:m,isRTL:u,pages:v,panzoom:S}=this,E=v.length,h=u&&m?1:-1;if(!S||!E)return;if(this.page!==l){const g=new Event("beforeChange",{bubbles:!0,cancelable:!0});if(this.emit("beforeChange",g,e),g.defaultPrevented)return}if(this.transitionTo(e,s))return;let f=v[l].pos;if(this.isInfinite){const g=this.contentDim,b=S.target[d]*h;E===2?f+=g*Math.floor(parseFloat(e+"")/2):f=[f,f-g,f+g].reduce(function(k,w){return Math.abs(w-b)<Math.abs(k-b)?w:k})}f*=h,Math.abs(S.target[d]-f)<1||(S.panTo({x:m?f:0,y:m?0:f,friction:r}),this.onChange(l))}slideToClosest(e){if(this.panzoom){const{pageIndex:r}=this.getPageFromPosition();this.slideTo(r,e)}}slideNext(){this.slideTo(this.page+1)}slidePrev(){this.slideTo(this.page-1)}clearTransitions(){this.inTransition.clear(),wt(this.container,this.cn("inTransition"));const e=["to-prev","to-next","from-prev","from-next"];for(const r of this.slides){const s=r.el;if(s){s.removeEventListener(Wr,this.onAnimationEnd),s.classList.remove(...e);const l=r.transition;l&&s.classList.remove(`f-${l}Out`,`f-${l}In`)}}this.manageSlideVisiblity()}addSlide(e,r){var s,l,d,m;const u=this.panzoom,v=((s=this.pages[this.page])===null||s===void 0?void 0:s.pos)||0,S=((l=this.pages[this.page])===null||l===void 0?void 0:l.dim)||0,E=this.contentDim<this.viewportDim;let h=Array.isArray(r)?r:[r];const f=[];for(const g of h)f.push(xa(g));this.slides.splice(e,0,...f);for(let g=0;g<this.slides.length;g++)this.slides[g].index=g;for(const g of f)this.emit("beforeInitSlide",g,g.index);if(this.page>=e&&(this.page+=f.length),this.updateMetrics(),u){const g=((d=this.pages[this.page])===null||d===void 0?void 0:d.pos)||0,b=((m=this.pages[this.page])===null||m===void 0?void 0:m.dim)||0,k=this.pages.length||1,w=this.isRTL?S-b:b-S,_=this.isRTL?v-g:g-v;E&&k===1?(e<=this.page&&(u.current[this.axis]-=w,u.target[this.axis]-=w),u.panTo({[this.isHorizontal?"x":"y"]:-1*g})):_&&e<=this.page&&(u.target[this.axis]-=_,u.current[this.axis]-=_,u.requestTick())}for(const g of f)this.emit("initSlide",g,g.index)}prependSlide(e){this.addSlide(0,e)}appendSlide(e){this.addSlide(this.slides.length,e)}removeSlide(e){const r=this.slides.length;e=(e%r+r)%r;const s=this.slides[e];if(s){this.removeSlideEl(s,!0),this.slides.splice(e,1);for(let l=0;l<this.slides.length;l++)this.slides[l].index=l;this.updateMetrics(),this.slideTo(this.page,{friction:0,transition:!1}),this.emit("destroySlide",s)}}updateMetrics(){const{panzoom:e,viewport:r,track:s,slides:l,isHorizontal:d,isInfinite:m}=this;if(!s)return;const u=d?"width":"height",v=d?"offsetWidth":"offsetHeight";if(r){let h=Math.max(r[v],_e(r.getBoundingClientRect()[u],1e3)),f=getComputedStyle(r),g="padding",b=d?"Right":"Bottom";h-=parseFloat(f[g+(d?"Left":"Top")])+parseFloat(f[g+b]),this.viewportDim=h}let S,E=0;for(const[h,f]of l.entries()){let g=0,b=0;!f.el&&S?(g=S.dim,b=S.gap):({dim:g,gap:b}=this.getSlideMetrics(f),S=f),g=_e(g,1e3),b=_e(b,1e3),f.dim=g,f.gap=b,f.pos=E,E+=g,(m||h<l.length-1)&&(E+=b)}E=_e(E,1e3),this.contentDim=E,e&&(e.contentRect[u]=E,e.contentRect[d?"fullWidth":"fullHeight"]=E),this.pages=this.createPages(),this.pages=this.processPages(),this.state===qt.Init&&this.setInitialPage(),this.page=Math.max(0,Math.min(this.page,this.pages.length-1)),this.manageSlideVisiblity(),this.emit("refresh")}getProgress(e,r=!1,s=!1){e===void 0&&(e=this.page);const l=this,d=l.panzoom,m=l.contentDim,u=l.pages[e]||0;if(!u||!d)return e>this.page?-1:1;let v=-1*d.current.e,S=_e((v-u.pos)/(1*u.dim),1e3),E=S,h=S;this.isInfinite&&s!==!0&&(E=_e((v-u.pos+m)/(1*u.dim),1e3),h=_e((v-u.pos-m)/(1*u.dim),1e3));let f=[S,E,h].reduce(function(g,b){return Math.abs(b)<Math.abs(g)?b:g});return r?f:f>1?1:f<-1?-1:f}setViewportHeight(){const{page:e,pages:r,viewport:s,isHorizontal:l}=this;if(!s||!r[e])return;let d=0;l&&this.track&&(this.track.style.height="auto",r[e].slides.forEach(m=>{m.el&&(d=Math.max(d,m.el.offsetHeight))})),s.style.height=d?`${d}px`:""}getPageForSlide(e){for(const r of this.pages)for(const s of r.slides)if(s.index===e)return r.index;return-1}getVisibleSlides(e=0){var r;const s=new Set;let{panzoom:l,contentDim:d,viewportDim:m,pages:u,page:v}=this;if(m){d=d+((r=this.slides[this.slides.length-1])===null||r===void 0?void 0:r.gap)||0;let S=0;S=l&&l.state!==kt.Init&&l.state!==kt.Destroy?-1*l.current[this.axis]:u[v]&&u[v].pos||0,this.isInfinite&&(S-=Math.floor(S/d)*d),this.isRTL&&this.isHorizontal&&(S*=-1);const E=S-m*e,h=S+m*(e+1),f=this.isInfinite?[-1,0,1]:[0];for(const g of this.slides)for(const b of f){const k=g.pos+b*d,w=k+g.dim+g.gap;k<h&&w>E&&s.add(g)}}return s}getPageFromPosition(e){const{viewportDim:r,contentDim:s,slides:l,pages:d,panzoom:m}=this,u=d.length,v=l.length,S=l[0],E=l[v-1],h=this.option("center");let f=0,g=0,b=0,k=e===void 0?-1*((m==null?void 0:m.target[this.axis])||0):e;h&&(k+=.5*r),this.isInfinite?(k<S.pos-.5*E.gap&&(k-=s,b=-1),k>E.pos+E.dim+.5*E.gap&&(k-=s,b=1)):k=Math.max(S.pos||0,Math.min(k,E.pos));let w=E,_=l.find(C=>{const T=C.pos-.5*w.gap,M=C.pos+C.dim+.5*C.gap;return w=C,k>=T&&k<M});return _||(_=E),g=this.getPageForSlide(_.index),f=g+b*u,{page:f,pageIndex:g}}setPageFromPosition(){const{pageIndex:e}=this.getPageFromPosition();this.onChange(e)}destroy(){if([qt.Destroy].includes(this.state))return;this.state=qt.Destroy;const{container:e,viewport:r,track:s,slides:l,panzoom:d}=this,m=this.option("classes");e.removeEventListener("click",this.onClick,{passive:!1,capture:!1}),e.removeEventListener("slideTo",this.onSlideTo),window.removeEventListener("resize",this.onResize),d&&(d.destroy(),this.panzoom=null),l&&l.forEach(v=>{this.removeSlideEl(v)}),this.detachPlugins(),r&&(r.removeEventListener("scroll",this.onScroll),r.offsetParent&&s&&s.offsetParent&&r.replaceWith(...s.childNodes));for(const[v,S]of Object.entries(m))v!=="container"&&S&&e.classList.remove(S);this.track=null,this.viewport=null,this.page=0,this.slides=[];const u=this.events.get("ready");this.events=new Map,u&&this.events.set("ready",u)}}Object.defineProperty(Ui,"Panzoom",{enumerable:!0,configurable:!0,writable:!0,value:Fi}),Object.defineProperty(Ui,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:cd}),Object.defineProperty(Ui,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:fd});const Ls=function(p){if(!vn(p))return 0;const e=window.scrollY,r=window.innerHeight,s=e+r,l=p.getBoundingClientRect(),d=l.y+e,m=l.height,u=d+m;if(e>u||s<d)return 0;if(e<d&&s>u||d<e&&u>s)return 100;let v=m;d<e&&(v-=e-d),u>s&&(v-=u-s);const S=v/r*100;return Math.round(S)},xr=!(typeof window>"u"||!window.document||!window.document.createElement);let _a;const Ca=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden]):not(.fancybox-focus-guard)","iframe","object","embed","video","audio","[contenteditable]",'[tabindex]:not([tabindex^="-"]):not([disabled]):not([aria-hidden])'].join(","),Io=p=>{if(p&&xr){_a===void 0&&document.createElement("div").focus({get preventScroll(){return _a=!0,!1}});try{if(_a)p.focus({preventScroll:!0});else{const e=window.scrollY||document.body.scrollTop,r=window.scrollX||document.body.scrollLeft;p.focus(),document.body.scrollTo({top:e,left:r,behavior:"auto"})}}catch{}}},Ds=()=>{const p=document;let e,r="",s="",l="";return p.fullscreenEnabled?(r="requestFullscreen",s="exitFullscreen",l="fullscreenElement"):p.webkitFullscreenEnabled&&(r="webkitRequestFullscreen",s="webkitExitFullscreen",l="webkitFullscreenElement"),r&&(e={request:function(d=p.documentElement){return r==="webkitRequestFullscreen"?d[r](Element.ALLOW_KEYBOARD_INPUT):d[r]()},exit:function(){return p[l]&&p[s]()},isFullscreen:function(){return p[l]}}),e},Va={animated:!0,autoFocus:!0,backdropClick:"close",Carousel:{classes:{container:"fancybox__carousel",viewport:"fancybox__viewport",track:"fancybox__track",slide:"fancybox__slide"}},closeButton:"auto",closeExisting:!1,commonCaption:!1,compact:()=>window.matchMedia("(max-width: 578px), (max-height: 578px)").matches,contentClick:"toggleZoom",contentDblClick:!1,defaultType:"image",defaultDisplay:"flex",dragToClose:!0,Fullscreen:{autoStart:!1},groupAll:!1,groupAttr:"data-fancybox",hideClass:"f-fadeOut",hideScrollbar:!0,idle:3500,keyboard:{Escape:"close",Delete:"close",Backspace:"close",PageUp:"next",PageDown:"prev",ArrowUp:"prev",ArrowDown:"next",ArrowRight:"next",ArrowLeft:"prev"},l10n:Object.assign(Object.assign({},Cs),{CLOSE:"Close",NEXT:"Next",PREV:"Previous",MODAL:"You can close this modal content with the ESC key",ERROR:"Something Went Wrong, Please Try Again Later",IMAGE_ERROR:"Image Not Found",ELEMENT_NOT_FOUND:"HTML Element Not Found",AJAX_NOT_FOUND:"Error Loading AJAX : Not Found",AJAX_FORBIDDEN:"Error Loading AJAX : Forbidden",IFRAME_ERROR:"Error Loading Page",TOGGLE_ZOOM:"Toggle zoom level",TOGGLE_THUMBS:"Toggle thumbnails",TOGGLE_SLIDESHOW:"Toggle slideshow",TOGGLE_FULLSCREEN:"Toggle full-screen mode",DOWNLOAD:"Download"}),parentEl:null,placeFocusBack:!0,showClass:"f-zoomInUp",startIndex:0,tpl:{closeButton:'<button data-fancybox-close class="f-button is-close-btn" title="{{CLOSE}}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M20 20L4 4m16 0L4 20"/></svg></button>',main:`<div class="fancybox__container" role="dialog" aria-modal="true" aria-label="{{MODAL}}" tabindex="-1">
    <div class="fancybox__backdrop"></div>
    <div class="fancybox__carousel"></div>
    <div class="fancybox__footer"></div>
  </div>`},trapFocus:!0,wheel:"zoom"};var Jt,cn;(function(p){p[p.Init=0]="Init",p[p.Ready=1]="Ready",p[p.Closing=2]="Closing",p[p.CustomClosing=3]="CustomClosing",p[p.Destroy=4]="Destroy"})(Jt||(Jt={})),function(p){p[p.Loading=0]="Loading",p[p.Opening=1]="Opening",p[p.Ready=2]="Ready",p[p.Closing=3]="Closing"}(cn||(cn={}));let Ho="",wr=!1,Kr=!1,Ri=null;const Os=()=>{let p="",e="";const r=bt.getInstance();if(r){const s=r.carousel,l=r.getSlide();if(s&&l){let d=l.slug||void 0,m=l.triggerEl||void 0;e=d||r.option("slug")||"",!e&&m&&m.dataset&&(e=m.dataset.fancybox||""),e&&e!=="true"&&(p="#"+e+(!d&&s.slides.length>1?"-"+(l.index+1):""))}}return{hash:p,slug:e,index:1}},la=()=>{const p=new URL(document.URL).hash,e=p.slice(1).split("-"),r=e[e.length-1],s=r&&/^\+?\d+$/.test(r)&&parseInt(e.pop()||"1",10)||1;return{hash:p,slug:e.join("-"),index:s}},Ps=()=>{const{slug:p,index:e}=la();if(!p)return;let r=document.querySelector(`[data-slug="${p}"]`);if(r&&r.dispatchEvent(new CustomEvent("click",{bubbles:!0,cancelable:!0})),bt.getInstance())return;const s=document.querySelectorAll(`[data-fancybox="${p}"]`);s.length&&(r=s[e-1],r&&r.dispatchEvent(new CustomEvent("click",{bubbles:!0,cancelable:!0})))},Rs=()=>{if(bt.defaults.Hash===!1)return;const p=bt.getInstance();if((p==null?void 0:p.options.Hash)===!1)return;const{slug:e,index:r}=la(),{slug:s}=Os();p&&(e===s?p.jumpTo(r-1):(wr=!0,p.close())),Ps()},Is=()=>{Ri&&clearTimeout(Ri),queueMicrotask(()=>{Rs()})},No=()=>{window.addEventListener("hashchange",Is,!1),setTimeout(()=>{Rs()},500)};xr&&(/complete|interactive|loaded/.test(document.readyState)?No():document.addEventListener("DOMContentLoaded",No));const Gr="is-zooming-in";class Hs extends Fn{onCreateSlide(e,r,s){const l=this.instance.optionFor(s,"src")||"";s.el&&s.type==="image"&&typeof l=="string"&&this.setImage(s,l)}onRemoveSlide(e,r,s){s.panzoom&&s.panzoom.destroy(),s.panzoom=void 0,s.imageEl=void 0}onChange(e,r,s,l){wt(this.instance.container,Gr);for(const d of r.slides){const m=d.panzoom;m&&d.index!==s&&m.reset(.35)}}onClose(){var e;const r=this.instance,s=r.container,l=r.getSlide();if(!s||!s.parentElement||!l)return;const{el:d,contentEl:m,panzoom:u,thumbElSrc:v}=l;if(!d||!v||!m||!u||u.isContentLoading||u.state===kt.Init||u.state===kt.Destroy)return;u.updateMetrics();let S=this.getZoomInfo(l);if(!S)return;this.instance.state=Jt.CustomClosing,s.classList.remove(Gr),s.classList.add("is-zooming-out"),m.style.backgroundImage=`url('${v}')`;const E=s.getBoundingClientRect();(((e=window.visualViewport)===null||e===void 0?void 0:e.scale)||1)===1&&Object.assign(s.style,{position:"absolute",top:`${s.offsetTop+window.scrollY}px`,left:`${s.offsetLeft+window.scrollX}px`,bottom:"auto",right:"auto",width:`${E.width}px`,height:`${E.height}px`,overflow:"hidden"});const{x:h,y:f,scale:g,opacity:b}=S;if(b){const k=((w,_,C,T)=>{const M=_-w,y=T-C;return O=>C+((O-w)/M*y||0)})(u.scale,g,1,0);u.on("afterTransform",()=>{m.style.opacity=k(u.scale)+""})}u.on("endAnimation",()=>{r.destroy()}),u.target.a=g,u.target.b=0,u.target.c=0,u.target.d=g,u.panTo({x:h,y:f,scale:g,friction:b?.2:.33,ignoreBounds:!0}),u.isResting&&r.destroy()}setImage(e,r){const s=this.instance;e.src=r,this.process(e,r).then(l=>{const{contentEl:d,imageEl:m,thumbElSrc:u,el:v}=e;if(s.isClosing()||!d||!m)return;d.offsetHeight;const S=!!s.isOpeningSlide(e)&&this.getZoomInfo(e);if(this.option("protected")&&v){v.addEventListener("contextmenu",f=>{f.preventDefault()});const h=document.createElement("div");qe(h,"fancybox-protected"),d.appendChild(h)}if(u&&S){const h=l.contentRect,f=Math.max(h.fullWidth,h.fullHeight);let g=null;!S.opacity&&f>1200&&(g=document.createElement("img"),qe(g,"fancybox-ghost"),g.src=u,d.appendChild(g));const b=()=>{g&&(qe(g,"f-fadeFastOut"),setTimeout(()=>{g&&(g.remove(),g=null)},200))};(E=u,new Promise((k,w)=>{const _=new Image;_.onload=k,_.onerror=w,_.src=E})).then(()=>{s.hideLoading(e),e.state=cn.Opening,this.instance.emit("reveal",e),this.zoomIn(e).then(()=>{b(),this.instance.done(e)},()=>{}),g&&setTimeout(()=>{b()},f>2500?800:200)},()=>{s.hideLoading(e),s.revealContent(e)})}else{const h=this.optionFor(e,"initialSize"),f=this.optionFor(e,"zoom"),g={event:s.prevMouseMoveEvent||s.options.event,friction:f?.12:0};let b=s.optionFor(e,"showClass")||void 0,k=!0;s.isOpeningSlide(e)&&(h==="full"?l.zoomToFull(g):h==="cover"?l.zoomToCover(g):h==="max"?l.zoomToMax(g):k=!1,l.stop("current")),k&&b&&(b=l.isDragging?"f-fadeIn":""),s.hideLoading(e),s.revealContent(e,b)}var E},()=>{s.setError(e,"{{IMAGE_ERROR}}")})}process(e,r){return new Promise((s,l)=>{var d;const m=this.instance,u=e.el;m.clearContent(e),m.showLoading(e);let v=this.optionFor(e,"content");if(typeof v=="string"&&(v=Xn(v)),!v||!vn(v)){if(v=document.createElement("img"),v instanceof HTMLImageElement){let S="",E=e.caption;S=typeof E=="string"&&E?E.replace(/<[^>]+>/gi,"").substring(0,1e3):`Image ${e.index+1} of ${((d=m.carousel)===null||d===void 0?void 0:d.pages.length)||1}`,v.src=r||"",v.alt=S,v.draggable=!1,e.srcset&&v.setAttribute("srcset",e.srcset),this.instance.isOpeningSlide(e)&&(v.fetchPriority="high")}e.sizes&&v.setAttribute("sizes",e.sizes)}qe(v,"fancybox-image"),e.imageEl=v,m.setContent(e,v,!1),e.panzoom=new Fi(u,bn({transformParent:!0},this.option("Panzoom")||{},{content:v,width:(S,E)=>m.optionFor(e,"width","auto",E)||"auto",height:(S,E)=>m.optionFor(e,"height","auto",E)||"auto",wheel:()=>{const S=m.option("wheel");return(S==="zoom"||S=="pan")&&S},click:(S,E)=>{var h,f;if(m.isCompact||m.isClosing()||e.index!==((h=m.getSlide())===null||h===void 0?void 0:h.index))return!1;if(E){const b=E.composedPath()[0];if(["A","BUTTON","TEXTAREA","OPTION","INPUT","SELECT","VIDEO"].includes(b.nodeName))return!1}let g=!E||E.target&&((f=e.contentEl)===null||f===void 0?void 0:f.contains(E.target));return m.option(g?"contentClick":"backdropClick")||!1},dblClick:()=>m.isCompact?"toggleZoom":m.option("contentDblClick")||!1,spinner:!1,panOnlyZoomed:!0,wheelLimit:1/0,on:{ready:S=>{s(S)},error:()=>{l()},destroy:()=>{l()}}}))})}zoomIn(e){return new Promise((r,s)=>{const l=this.instance,d=l.container,{panzoom:m,contentEl:u,el:v}=e;m&&m.updateMetrics();const S=this.getZoomInfo(e);if(!(S&&v&&u&&m&&d))return void s();const{x:E,y:h,scale:f,opacity:g}=S,b=()=>{e.state!==cn.Closing&&(g&&(u.style.opacity=Math.max(Math.min(1,1-(1-m.scale)/(1-f)),0)+""),m.scale>=1&&m.scale>m.targetScale-.1&&r(m))},k=C=>{(C.scale<.99||C.scale>1.01)&&!C.isDragging||(wt(d,Gr),u.style.opacity="",C.off("endAnimation",k),C.off("touchStart",k),C.off("afterTransform",b),r(C))};m.on("endAnimation",k),m.on("touchStart",k),m.on("afterTransform",b),m.on(["error","destroy"],()=>{s()}),m.panTo({x:E,y:h,scale:f,friction:0,ignoreBounds:!0}),m.stop("current");const w={event:m.panMode==="mousemove"?l.prevMouseMoveEvent||l.options.event:void 0},_=this.optionFor(e,"initialSize");qe(d,Gr),l.hideLoading(e),_==="full"?m.zoomToFull(w):_==="cover"?m.zoomToCover(w):_==="max"?m.zoomToMax(w):m.reset(.172)})}getZoomInfo(e){const{el:r,imageEl:s,thumbEl:l,panzoom:d}=e,m=this.instance,u=m.container;if(!r||!s||!l||!d||Ls(l)<3||!this.optionFor(e,"zoom")||!u||m.state===Jt.Destroy||getComputedStyle(u).getPropertyValue("--f-images-zoom")==="0")return!1;const v=window.visualViewport||null;if((v?v.scale:1)!==1)return!1;let{top:S,left:E,width:h,height:f}=l.getBoundingClientRect(),{top:g,left:b,fitWidth:k,fitHeight:w}=d.contentRect;if(!(h&&f&&k&&w))return!1;const _=d.container.getBoundingClientRect();b+=_.left,g+=_.top;const C=-1*(b+.5*k-(E+.5*h)),T=-1*(g+.5*w-(S+.5*f)),M=h/k;let y=this.option("zoomOpacity")||!1;return y==="auto"&&(y=Math.abs(h/f-k/w)>.1),{x:C,y:T,scale:M,opacity:y}}attach(){const e=this,r=e.instance;r.on("Carousel.change",e.onChange),r.on("Carousel.createSlide",e.onCreateSlide),r.on("Carousel.removeSlide",e.onRemoveSlide),r.on("close",e.onClose)}detach(){const e=this,r=e.instance;r.off("Carousel.change",e.onChange),r.off("Carousel.createSlide",e.onCreateSlide),r.off("Carousel.removeSlide",e.onRemoveSlide),r.off("close",e.onClose)}}Object.defineProperty(Hs,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{initialSize:"fit",Panzoom:{maxScale:1},protected:!1,zoom:!0,zoomOpacity:"auto"}}),typeof SuppressedError=="function"&&SuppressedError;const Ta="html",jo="image",Ma="map",ai="youtube",Ai="vimeo",br="html5video",$o=(p,e={})=>{const r=new URL(p),s=new URLSearchParams(r.search),l=new URLSearchParams;for(const[u,v]of[...s,...Object.entries(e)]){let S=v+"";if(u==="t"){let E=S.match(/((\d*)m)?(\d*)s?/);E&&l.set("start",60*parseInt(E[2]||"0")+parseInt(E[3]||"0")+"")}else l.set(u,S)}let d=l+"",m=p.match(/#t=((.*)?\d+s)/);return m&&(d+=`#t=${m[1]}`),d},hd={ajax:null,autoSize:!0,iframeAttr:{allow:"autoplay; fullscreen",scrolling:"auto"},preload:!0,videoAutoplay:!0,videoRatio:16/9,videoTpl:`<video class="fancybox__html5video" playsinline controls controlsList="nodownload" poster="{{poster}}">
  <source src="{{src}}" type="{{format}}" />Sorry, your browser doesn't support embedded videos.</video>`,videoFormat:"",vimeo:{byline:1,color:"00adef",controls:1,dnt:1,muted:0},youtube:{controls:1,enablejsapi:1,nocookie:1,rel:0,fs:1}},pd=["image","html","ajax","inline","clone","iframe","map","pdf","html5video","youtube","vimeo"];class Ns extends Fn{onBeforeInitSlide(e,r,s){this.processType(s)}onCreateSlide(e,r,s){this.setContent(s)}onClearContent(e,r){r.xhr&&(r.xhr.abort(),r.xhr=null);const s=r.iframeEl;s&&(s.onload=s.onerror=null,s.src="//about:blank",r.iframeEl=null);const l=r.contentEl,d=r.placeholderEl;if(r.type==="inline"&&l&&d)l.classList.remove("fancybox__content"),getComputedStyle(l).getPropertyValue("display")!=="none"&&(l.style.display="none"),setTimeout(()=>{d&&(l&&d.parentNode&&d.parentNode.insertBefore(l,d),d.remove())},0),r.contentEl=void 0,r.placeholderEl=void 0;else for(;r.el&&r.el.firstChild;)r.el.removeChild(r.el.firstChild)}onSelectSlide(e,r,s){s.state===cn.Ready&&this.playVideo()}onUnselectSlide(e,r,s){var l,d;if(s.type===br){try{(d=(l=s.el)===null||l===void 0?void 0:l.querySelector("video"))===null||d===void 0||d.pause()}catch{}return}let m;s.type===Ai?m={method:"pause",value:"true"}:s.type===ai&&(m={event:"command",func:"pauseVideo"}),m&&s.iframeEl&&s.iframeEl.contentWindow&&s.iframeEl.contentWindow.postMessage(JSON.stringify(m),"*"),s.poller&&clearTimeout(s.poller)}onDone(e,r){e.isCurrentSlide(r)&&!e.isClosing()&&this.playVideo()}onRefresh(e,r){r.slides.forEach(s=>{s.el&&(this.resizeIframe(s),this.setAspectRatio(s))})}onMessage(e){try{let r=JSON.parse(e.data);if(e.origin==="https://player.vimeo.com"){if(r.event==="ready")for(let s of Array.from(document.getElementsByClassName("fancybox__iframe")))s instanceof HTMLIFrameElement&&s.contentWindow===e.source&&(s.dataset.ready="true")}else if(e.origin.match(/^https:\/\/(www.)?youtube(-nocookie)?.com$/)&&r.event==="onReady"){const s=document.getElementById(r.id);s&&(s.dataset.ready="true")}}catch{}}loadAjaxContent(e){const r=this.instance.optionFor(e,"src")||"";this.instance.showLoading(e);const s=this.instance,l=new XMLHttpRequest;s.showLoading(e),l.onreadystatechange=function(){l.readyState===XMLHttpRequest.DONE&&s.state===Jt.Ready&&(s.hideLoading(e),l.status===200?s.setContent(e,l.responseText):s.setError(e,l.status===404?"{{AJAX_NOT_FOUND}}":"{{AJAX_FORBIDDEN}}"))};const d=e.ajax||null;l.open(d?"POST":"GET",r+""),l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),l.setRequestHeader("X-Requested-With","XMLHttpRequest"),l.send(d),e.xhr=l}setInlineContent(e){let r=null;if(vn(e.src))r=e.src;else if(typeof e.src=="string"){const s=e.src.split("#",2).pop();r=s?document.getElementById(s):null}if(r){if(e.type==="clone"||r.closest(".fancybox__slide")){r=r.cloneNode(!0);const s=r.dataset.animationName;s&&(r.classList.remove(s),delete r.dataset.animationName);let l=r.getAttribute("id");l=l?`${l}--clone`:`clone-${this.instance.id}-${e.index}`,r.setAttribute("id",l)}else if(r.parentNode){const s=document.createElement("div");s.classList.add("fancybox-placeholder"),r.parentNode.insertBefore(s,r),e.placeholderEl=s}this.instance.setContent(e,r)}else this.instance.setError(e,"{{ELEMENT_NOT_FOUND}}")}setIframeContent(e){const{src:r,el:s}=e;if(!r||typeof r!="string"||!s)return;s.classList.add("is-loading");const l=this.instance,d=document.createElement("iframe");d.className="fancybox__iframe",d.setAttribute("id",`fancybox__iframe_${l.id}_${e.index}`);for(const[u,v]of Object.entries(this.optionFor(e,"iframeAttr")||{}))d.setAttribute(u,v);d.onerror=()=>{l.setError(e,"{{IFRAME_ERROR}}")},e.iframeEl=d;const m=this.optionFor(e,"preload");if(e.type!=="iframe"||m===!1)return d.setAttribute("src",e.src+""),l.setContent(e,d,!1),this.resizeIframe(e),void l.revealContent(e);l.showLoading(e),d.onload=()=>{if(!d.src.length)return;const u=d.dataset.ready!=="true";d.dataset.ready="true",this.resizeIframe(e),u?l.revealContent(e):l.hideLoading(e)},d.setAttribute("src",r),l.setContent(e,d,!1)}resizeIframe(e){const{type:r,iframeEl:s}=e;if(r===ai||r===Ai)return;const l=s==null?void 0:s.parentElement;if(!s||!l)return;let d=e.autoSize;d===void 0&&(d=this.optionFor(e,"autoSize"));let m=e.width||0,u=e.height||0;m&&u&&(d=!1);const v=l&&l.style;if(e.preload!==!1&&d!==!1&&v)try{const S=window.getComputedStyle(l),E=parseFloat(S.paddingLeft)+parseFloat(S.paddingRight),h=parseFloat(S.paddingTop)+parseFloat(S.paddingBottom),f=s.contentWindow;if(f){const g=f.document,b=g.getElementsByTagName(Ta)[0],k=g.body;v.width="",k.style.overflow="hidden",m=m||b.scrollWidth+E,v.width=`${m}px`,k.style.overflow="",v.flex="0 0 auto",v.height=`${k.scrollHeight}px`,u=b.scrollHeight+h}}catch{}if(m||u){const S={flex:"0 1 auto",width:"",height:""};m&&m!=="auto"&&(S.width=`${m}px`),u&&u!=="auto"&&(S.height=`${u}px`),Object.assign(v,S)}}playVideo(){const e=this.instance.getSlide();if(!e)return;const{el:r}=e;if(!r||!r.offsetParent||!this.optionFor(e,"videoAutoplay"))return;if(e.type===br)try{const l=r.querySelector("video");if(l){const d=l.play();d!==void 0&&d.then(()=>{}).catch(m=>{l.muted=!0,l.play()})}}catch{}if(e.type!==ai&&e.type!==Ai)return;const s=()=>{if(e.iframeEl&&e.iframeEl.contentWindow){let l;if(e.iframeEl.dataset.ready==="true")return l=e.type===ai?{event:"command",func:"playVideo"}:{method:"play",value:"true"},l&&e.iframeEl.contentWindow.postMessage(JSON.stringify(l),"*"),void(e.poller=void 0);e.type===ai&&(l={event:"listening",id:e.iframeEl.getAttribute("id")},e.iframeEl.contentWindow.postMessage(JSON.stringify(l),"*"))}e.poller=setTimeout(s,250)};s()}processType(e){if(e.html)return e.type=Ta,e.src=e.html,void(e.html="");const r=this.instance.optionFor(e,"src","");if(!r||typeof r!="string")return;let s=e.type,l=null;if(l=r.match(/(youtube\.com|youtu\.be|youtube\-nocookie\.com)\/(?:watch\?(?:.*&)?v=|v\/|u\/|shorts\/|embed\/?)?(videoseries\?list=(?:.*)|[\w-]{11}|\?listType=(?:.*)&list=(?:.*))(?:.*)/i)){const d=this.optionFor(e,ai),{nocookie:m}=d,u=function(h,f){var g={};for(var b in h)Object.prototype.hasOwnProperty.call(h,b)&&f.indexOf(b)<0&&(g[b]=h[b]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function"){var k=0;for(b=Object.getOwnPropertySymbols(h);k<b.length;k++)f.indexOf(b[k])<0&&Object.prototype.propertyIsEnumerable.call(h,b[k])&&(g[b[k]]=h[b[k]])}return g}(d,["nocookie"]),v=`www.youtube${m?"-nocookie":""}.com`,S=$o(r,u),E=encodeURIComponent(l[2]);e.videoId=E,e.src=`https://${v}/embed/${E}?${S}`,e.thumbSrc=e.thumbSrc||`https://i.ytimg.com/vi/${E}/mqdefault.jpg`,s=ai}else if(l=r.match(/^.+vimeo.com\/(?:\/)?([\d]+)((\/|\?h=)([a-z0-9]+))?(.*)?/)){const d=$o(r,this.optionFor(e,Ai)),m=encodeURIComponent(l[1]),u=l[4]||"";e.videoId=m,e.src=`https://player.vimeo.com/video/${m}?${u?`h=${u}${d?"&":""}`:""}${d}`,s=Ai}if(!s&&e.triggerEl){const d=e.triggerEl.dataset.type;pd.includes(d)&&(s=d)}s||typeof r=="string"&&(r.charAt(0)==="#"?s="inline":(l=r.match(/\.(mp4|mov|ogv|webm)((\?|#).*)?$/i))?(s=br,e.videoFormat=e.videoFormat||"video/"+(l[1]==="ogv"?"ogg":l[1])):r.match(/(^data:image\/[a-z0-9+\/=]*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg|ico)((\?|#).*)?$)/i)?s=jo:r.match(/\.(pdf)((\?|#).*)?$/i)&&(s="pdf")),(l=r.match(/(?:maps\.)?google\.([a-z]{2,3}(?:\.[a-z]{2})?)\/(?:(?:(?:maps\/(?:place\/(?:.*)\/)?\@(.*),(\d+.?\d+?)z))|(?:\?ll=))(.*)?/i))?(e.src=`https://maps.google.${l[1]}/?ll=${(l[2]?l[2]+"&z="+Math.floor(parseFloat(l[3]))+(l[4]?l[4].replace(/^\//,"&"):""):l[4]+"").replace(/\?/,"&")}&output=${l[4]&&l[4].indexOf("layer=c")>0?"svembed":"embed"}`,s=Ma):(l=r.match(/(?:maps\.)?google\.([a-z]{2,3}(?:\.[a-z]{2})?)\/(?:maps\/search\/)(.*)/i))&&(e.src=`https://maps.google.${l[1]}/maps?q=${l[2].replace("query=","q=").replace("api=1","")}&output=embed`,s=Ma),s=s||this.instance.option("defaultType"),e.type=s,s===jo&&(e.thumbSrc=e.thumbSrc||e.src)}setContent(e){const r=this.instance.optionFor(e,"src")||"";if(e&&e.type&&r){switch(e.type){case Ta:this.instance.setContent(e,r);break;case br:const s=this.option("videoTpl");s&&this.instance.setContent(e,s.replace(/\{\{src\}\}/gi,r+"").replace(/\{\{format\}\}/gi,this.optionFor(e,"videoFormat")||"").replace(/\{\{poster\}\}/gi,e.poster||e.thumbSrc||""));break;case"inline":case"clone":this.setInlineContent(e);break;case"ajax":this.loadAjaxContent(e);break;case"pdf":case Ma:case ai:case Ai:e.preload=!1;case"iframe":this.setIframeContent(e)}this.setAspectRatio(e)}}setAspectRatio(e){const r=e.contentEl;if(!(e.el&&r&&e.type&&[ai,Ai,br].includes(e.type)))return;let s,l=e.width||"auto",d=e.height||"auto";if(l==="auto"||d==="auto"){s=this.optionFor(e,"videoRatio");const S=(s+"").match(/(\d+)\s*\/\s?(\d+)/);s=S&&S.length>2?parseFloat(S[1])/parseFloat(S[2]):parseFloat(s+"")}else l&&d&&(s=l/d);if(!s)return;r.style.aspectRatio="",r.style.width="",r.style.height="",r.offsetHeight;const m=r.getBoundingClientRect(),u=m.width||1,v=m.height||1;r.style.aspectRatio=s+"",s<u/v?(d=d==="auto"?v:Math.min(v,d),r.style.width="auto",r.style.height=`${d}px`):(l=l==="auto"?u:Math.min(u,l),r.style.width=`${l}px`,r.style.height="auto")}attach(){const e=this,r=e.instance;r.on("Carousel.beforeInitSlide",e.onBeforeInitSlide),r.on("Carousel.createSlide",e.onCreateSlide),r.on("Carousel.selectSlide",e.onSelectSlide),r.on("Carousel.unselectSlide",e.onUnselectSlide),r.on("Carousel.Panzoom.refresh",e.onRefresh),r.on("done",e.onDone),r.on("clearContent",e.onClearContent),window.addEventListener("message",e.onMessage)}detach(){const e=this,r=e.instance;r.off("Carousel.beforeInitSlide",e.onBeforeInitSlide),r.off("Carousel.createSlide",e.onCreateSlide),r.off("Carousel.selectSlide",e.onSelectSlide),r.off("Carousel.unselectSlide",e.onUnselectSlide),r.off("Carousel.Panzoom.refresh",e.onRefresh),r.off("done",e.onDone),r.off("clearContent",e.onClearContent),window.removeEventListener("message",e.onMessage)}}Object.defineProperty(Ns,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:hd});const Xr="play",Zr="pause",yr="ready";class js extends Fn{constructor(){super(...arguments),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:yr}),Object.defineProperty(this,"inHover",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"timer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"progressBar",{enumerable:!0,configurable:!0,writable:!0,value:null})}get isActive(){return this.state!==yr}onReady(e){this.option("autoStart")&&(e.isInfinite||e.page<e.pages.length-1)&&this.start()}onChange(){this.removeProgressBar(),this.pause()}onSettle(){this.resume()}onVisibilityChange(){document.visibilityState==="visible"?this.resume():this.pause()}onMouseEnter(){this.inHover=!0,this.pause()}onMouseLeave(){var e;this.inHover=!1,!((e=this.instance.panzoom)===null||e===void 0)&&e.isResting&&this.resume()}onTimerEnd(){const e=this.instance;this.state==="play"&&(e.isInfinite||e.page!==e.pages.length-1?e.slideNext():e.slideTo(0))}removeProgressBar(){this.progressBar&&(this.progressBar.remove(),this.progressBar=null)}createProgressBar(){var e;if(!this.option("showProgress"))return null;this.removeProgressBar();const r=this.instance,s=((e=r.pages[r.page])===null||e===void 0?void 0:e.slides)||[];let l=this.option("progressParentEl");if(l||(l=(s.length===1?s[0].el:null)||r.viewport),!l)return null;const d=document.createElement("div");return qe(d,"f-progress"),l.prepend(d),this.progressBar=d,d.offsetHeight,d}set(){const e=this,r=e.instance;if(r.pages.length<2||e.timer)return;const s=e.option("timeout");e.state=Xr,qe(r.container,"has-autoplay");let l=e.createProgressBar();l&&(l.style.transitionDuration=`${s}ms`,l.style.transform="scaleX(1)"),e.timer=setTimeout(()=>{e.timer=null,e.inHover||e.onTimerEnd()},s),e.emit("set")}clear(){const e=this;e.timer&&(clearTimeout(e.timer),e.timer=null),e.removeProgressBar()}start(){const e=this;if(e.set(),e.state!==yr){if(e.option("pauseOnHover")){const r=e.instance.container;r.addEventListener("mouseenter",e.onMouseEnter,!1),r.addEventListener("mouseleave",e.onMouseLeave,!1)}document.addEventListener("visibilitychange",e.onVisibilityChange,!1),e.emit("start")}}stop(){const e=this,r=e.state,s=e.instance.container;e.clear(),e.state=yr,s.removeEventListener("mouseenter",e.onMouseEnter,!1),s.removeEventListener("mouseleave",e.onMouseLeave,!1),document.removeEventListener("visibilitychange",e.onVisibilityChange,!1),wt(s,"has-autoplay"),r!==yr&&e.emit("stop")}pause(){const e=this;e.state===Xr&&(e.state=Zr,e.clear(),e.emit(Zr))}resume(){const e=this,r=e.instance;if(r.isInfinite||r.page!==r.pages.length-1)if(e.state!==Xr){if(e.state===Zr&&!e.inHover){const s=new Event("resume",{bubbles:!0,cancelable:!0});e.emit("resume",s),s.defaultPrevented||e.set()}}else e.set();else e.stop()}toggle(){this.state===Xr||this.state===Zr?this.stop():this.start()}attach(){const e=this,r=e.instance;r.on("ready",e.onReady),r.on("Panzoom.startAnimation",e.onChange),r.on("Panzoom.endAnimation",e.onSettle),r.on("Panzoom.touchMove",e.onChange)}detach(){const e=this,r=e.instance;r.off("ready",e.onReady),r.off("Panzoom.startAnimation",e.onChange),r.off("Panzoom.endAnimation",e.onSettle),r.off("Panzoom.touchMove",e.onChange),e.stop()}}Object.defineProperty(js,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{autoStart:!0,pauseOnHover:!0,progressParentEl:null,showProgress:!0,timeout:3e3}});class $s extends Fn{constructor(){super(...arguments),Object.defineProperty(this,"ref",{enumerable:!0,configurable:!0,writable:!0,value:null})}onPrepare(e){const r=e.carousel;if(!r)return;const s=e.container;s&&(r.options.Autoplay=bn({autoStart:!1},this.option("Autoplay")||{},{pauseOnHover:!1,timeout:this.option("timeout"),progressParentEl:()=>this.option("progressParentEl")||null,on:{start:()=>{e.emit("startSlideshow")},set:l=>{var d;s.classList.add("has-slideshow"),((d=e.getSlide())===null||d===void 0?void 0:d.state)!==cn.Ready&&l.pause()},stop:()=>{s.classList.remove("has-slideshow"),e.isCompact||e.endIdle(),e.emit("endSlideshow")},resume:(l,d)=>{var m,u,v;!d||!d.cancelable||((m=e.getSlide())===null||m===void 0?void 0:m.state)===cn.Ready&&(!((v=(u=e.carousel)===null||u===void 0?void 0:u.panzoom)===null||v===void 0)&&v.isResting)||d.preventDefault()}}}),r.attachPlugins({Autoplay:js}),this.ref=r.plugins.Autoplay)}onReady(e){const r=e.carousel,s=this.ref;s&&r&&this.option("playOnStart")&&(r.isInfinite||r.page<r.pages.length-1)&&s.start()}onDone(e,r){const s=this.ref,l=e.carousel;if(!s||!l)return;const d=r.panzoom;d&&d.on("startAnimation",()=>{e.isCurrentSlide(r)&&s.stop()}),e.isCurrentSlide(r)&&s.resume()}onKeydown(e,r){var s;const l=this.ref;l&&r===this.option("key")&&((s=document.activeElement)===null||s===void 0?void 0:s.nodeName)!=="BUTTON"&&l.toggle()}attach(){const e=this,r=e.instance;r.on("Carousel.init",e.onPrepare),r.on("Carousel.ready",e.onReady),r.on("done",e.onDone),r.on("keydown",e.onKeydown)}detach(){const e=this,r=e.instance;r.off("Carousel.init",e.onPrepare),r.off("Carousel.ready",e.onReady),r.off("done",e.onDone),r.off("keydown",e.onKeydown)}}Object.defineProperty($s,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{key:" ",playOnStart:!1,progressParentEl:p=>{var e;return((e=p.instance.container)===null||e===void 0?void 0:e.querySelector(".fancybox__toolbar [data-fancybox-toggle-slideshow]"))||p.instance.container},timeout:3e3}});const Bs={classes:{container:"f-thumbs f-carousel__thumbs",viewport:"f-thumbs__viewport",track:"f-thumbs__track",slide:"f-thumbs__slide",isResting:"is-resting",isSelected:"is-selected",isLoading:"is-loading",hasThumbs:"has-thumbs"},minCount:2,parentEl:null,thumbTpl:'<button class="f-thumbs__slide__button" tabindex="0" type="button" aria-label="{{GOTO}}" data-carousel-index="%i"><img class="f-thumbs__slide__img" data-lazy-src="{{%s}}" alt="" /></button>',type:"modern"};var si;(function(p){p[p.Init=0]="Init",p[p.Ready=1]="Ready",p[p.Hidden=2]="Hidden"})(si||(si={}));const Bo="isResting",Jr="thumbWidth",Zi="thumbHeight",Kn="thumbClipWidth";let Us=class extends Fn{constructor(){super(...arguments),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:"modern"}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"track",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"carousel",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"thumbWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbClipWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbGap",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbExtraGap",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:si.Init})}get isModern(){return this.type==="modern"}onInitSlide(p,e){const r=e.el?e.el.dataset:void 0;r&&(e.thumbSrc=r.thumbSrc||e.thumbSrc||"",e[Kn]=parseFloat(r[Kn]||"")||e[Kn]||0,e[Zi]=parseFloat(r.thumbHeight||"")||e[Zi]||0),this.addSlide(e)}onInitSlides(){this.build()}onChange(){var p;if(!this.isModern)return;const e=this.container,r=this.instance,s=r.panzoom,l=this.carousel,d=l?l.panzoom:null,m=r.page;if(s&&l&&d){if(s.isDragging){wt(e,this.cn(Bo));let u=((p=l.pages[m])===null||p===void 0?void 0:p.pos)||0;u+=r.getProgress(m)*(this[Kn]+this.thumbGap);let v=d.getBounds();-1*u>v.x.min&&-1*u<v.x.max&&d.panTo({x:-1*u,friction:.12})}else Zn(e,this.cn(Bo),s.isResting);this.shiftModern()}}onRefresh(){this.updateProps();for(const p of this.instance.slides||[])this.resizeModernSlide(p);this.shiftModern()}isDisabled(){const p=this.option("minCount")||0;if(p){const r=this.instance;let s=0;for(const l of r.slides||[])l.thumbSrc&&s++;if(s<p)return!0}const e=this.option("type");return["modern","classic"].indexOf(e)<0}getThumb(p){const e=this.option("thumbTpl")||"";return{html:this.instance.localize(e,[["%i",p.index],["%d",p.index+1],["%s",p.thumbSrc||"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"]])}}addSlide(p){const e=this.carousel;e&&e.addSlide(p.index,this.getThumb(p))}getSlides(){const p=[];for(const e of this.instance.slides||[])p.push(this.getThumb(e));return p}resizeModernSlide(p){this.isModern&&(p[Jr]=p[Kn]&&p[Zi]?Math.round(this[Zi]*(p[Kn]/p[Zi])):this[Jr])}updateProps(){const p=this.container;if(!p)return;const e=r=>parseFloat(getComputedStyle(p).getPropertyValue("--f-thumb-"+r))||0;this.thumbGap=e("gap"),this.thumbExtraGap=e("extra-gap"),this[Jr]=e("width")||40,this[Kn]=e("clip-width")||40,this[Zi]=e("height")||40}build(){const p=this;if(p.state!==si.Init)return;if(p.isDisabled())return void p.emit("disabled");const e=p.instance,r=e.container,s=p.getSlides(),l=p.option("type");p.type=l;const d=p.option("parentEl"),m=p.cn("container"),u=p.cn("track");let v=d==null?void 0:d.querySelector("."+m);v||(v=document.createElement("div"),qe(v,m),d?d.appendChild(v):r.after(v)),qe(v,`is-${l}`),qe(r,p.cn("hasThumbs")),p.container=v,p.updateProps();let S=v.querySelector("."+u);S||(S=document.createElement("div"),qe(S,p.cn("track")),v.appendChild(S)),p.track=S;const E=bn({},{track:S,infinite:!1,center:!0,fill:l==="classic",dragFree:!0,slidesPerPage:1,transition:!1,preload:.25,friction:.12,Panzoom:{maxVelocity:0},Dots:!1,Navigation:!1,classes:{container:"f-thumbs",viewport:"f-thumbs__viewport",track:"f-thumbs__track",slide:"f-thumbs__slide"}},p.option("Carousel")||{},{Sync:{target:e},slides:s}),h=new e.constructor(v,E);h.on("createSlide",(f,g)=>{p.setProps(g.index),p.emit("createSlide",g,g.el)}),h.on("ready",()=>{p.shiftModern(),p.emit("ready")}),h.on("refresh",()=>{p.shiftModern()}),h.on("Panzoom.click",(f,g,b)=>{p.onClick(b)}),p.carousel=h,p.state=si.Ready}onClick(p){p.preventDefault(),p.stopPropagation();const e=this.instance,{pages:r,page:s}=e,l=k=>{if(k){const w=k.closest("[data-carousel-index]");if(w)return[parseInt(w.dataset.carouselIndex||"",10)||0,w]}return[-1,void 0]},d=(k,w)=>{const _=document.elementFromPoint(k,w);return _?l(_):[-1,void 0]};let[m,u]=l(p.target);if(m>-1)return;const v=this[Kn],S=p.clientX,E=p.clientY;let[h,f]=d(S-v,E),[g,b]=d(S+v,E);f&&b?(m=Math.abs(S-f.getBoundingClientRect().right)<Math.abs(S-b.getBoundingClientRect().left)?h:g,m===s&&(m=m===h?g:h)):f?m=h:b&&(m=g),m>-1&&r[m]&&e.slideTo(m)}getShift(p){var e;const r=this,{instance:s}=r,l=r.carousel;if(!s||!l)return 0;const d=r[Jr],m=r[Kn],u=r.thumbGap,v=r.thumbExtraGap;if(!(!((e=l.slides[p])===null||e===void 0)&&e.el))return 0;const S=.5*(d-m),E=s.pages.length-1;let h=s.getProgress(0),f=s.getProgress(E),g=s.getProgress(p,!1,!0),b=0,k=S+v+u;const w=h<0&&h>-1,_=f>0&&f<1;return p===0?(b=k*Math.abs(h),_&&h===1&&(b-=k*Math.abs(f))):p===E?(b=k*Math.abs(f)*-1,w&&f===-1&&(b+=k*Math.abs(h))):w||_?(b=-1*k,b+=k*Math.abs(h),b+=k*(1-Math.abs(f))):b=k*g,b}setProps(p){var e;const r=this;if(!r.isModern)return;const{instance:s}=r,l=r.carousel;if(s&&l){const d=(e=l.slides[p])===null||e===void 0?void 0:e.el;if(d&&d.childNodes.length){let m=_e(1-Math.abs(s.getProgress(p))),u=_e(r.getShift(p));d.style.setProperty("--progress",m?m+"":""),d.style.setProperty("--shift",u+"")}}}shiftModern(){const p=this;if(!p.isModern)return;const{instance:e,track:r}=p,s=e.panzoom,l=p.carousel;if(!(e&&r&&s&&l)||s.state===kt.Init||s.state===kt.Destroy)return;for(const m of e.slides)p.setProps(m.index);let d=(p[Kn]+p.thumbGap)*(l.slides.length||0);r.style.setProperty("--width",d+"")}cleanup(){const p=this;p.carousel&&p.carousel.destroy(),p.carousel=null,p.container&&p.container.remove(),p.container=null,p.track&&p.track.remove(),p.track=null,p.state=si.Init,wt(p.instance.container,p.cn("hasThumbs"))}attach(){const p=this,e=p.instance;e.on("initSlide",p.onInitSlide),e.state===qt.Init?e.on("initSlides",p.onInitSlides):p.onInitSlides(),e.on(["change","Panzoom.afterTransform"],p.onChange),e.on("Panzoom.refresh",p.onRefresh)}detach(){const p=this,e=p.instance;e.off("initSlide",p.onInitSlide),e.off("initSlides",p.onInitSlides),e.off(["change","Panzoom.afterTransform"],p.onChange),e.off("Panzoom.refresh",p.onRefresh),p.cleanup()}};Object.defineProperty(Us,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:Bs});const md=Object.assign(Object.assign({},Bs),{key:"t",showOnStart:!0,parentEl:null}),Uo="is-masked",zo="aria-hidden";class zs extends Fn{constructor(){super(...arguments),Object.defineProperty(this,"ref",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hidden",{enumerable:!0,configurable:!0,writable:!0,value:!1})}get isEnabled(){const e=this.ref;return e&&!e.isDisabled()}get isHidden(){return this.hidden}onClick(e,r){r.stopPropagation()}onCreateSlide(e,r){var s,l,d;const m=((d=(l=(s=this.instance)===null||s===void 0?void 0:s.carousel)===null||l===void 0?void 0:l.slides[r.index])===null||d===void 0?void 0:d.type)||"",u=r.el;if(u&&m){let v=`for-${m}`;["video","youtube","vimeo","html5video"].includes(m)&&(v+=" for-video"),qe(u,v)}}onInit(){var e;const r=this,s=r.instance,l=s.carousel;if(r.ref||!l)return;const d=r.option("parentEl")||s.footer||s.container;if(!d)return;const m=bn({},r.options,{parentEl:d,classes:{container:"f-thumbs fancybox__thumbs"},Carousel:{Sync:{friction:s.option("Carousel.friction")||0}},on:{ready:u=>{const v=u.container;v&&this.hidden&&(r.refresh(),v.style.transition="none",r.hide(),v.offsetHeight,queueMicrotask(()=>{v.style.transition="",r.show()}))}}});m.Carousel=m.Carousel||{},m.Carousel.on=bn(((e=r.options.Carousel)===null||e===void 0?void 0:e.on)||{},{click:this.onClick,createSlide:this.onCreateSlide}),l.options.Thumbs=m,l.attachPlugins({Thumbs:Us}),r.ref=l.plugins.Thumbs,r.option("showOnStart")||(r.ref.state=si.Hidden,r.hidden=!0)}onResize(){var e;const r=(e=this.ref)===null||e===void 0?void 0:e.container;r&&(r.style.maxHeight="")}onKeydown(e,r){const s=this.option("key");s&&s===r&&this.toggle()}toggle(){const e=this.ref;if(e&&!e.isDisabled())return e.state===si.Hidden?(e.state=si.Init,void e.build()):void(this.hidden?this.show():this.hide())}show(){const e=this.ref;if(!e||e.isDisabled())return;const r=e.container;r&&(this.refresh(),r.offsetHeight,r.removeAttribute(zo),r.classList.remove(Uo),this.hidden=!1)}hide(){const e=this.ref,r=e&&e.container;r&&(this.refresh(),r.offsetHeight,r.classList.add(Uo),r.setAttribute(zo,"true")),this.hidden=!0}refresh(){const e=this.ref;if(!e||!e.state)return;const r=e.container,s=(r==null?void 0:r.firstChild)||null;r&&s&&s.childNodes.length&&(r.style.maxHeight=`${s.getBoundingClientRect().height}px`)}attach(){const e=this,r=e.instance;r.state===Jt.Init?r.on("Carousel.init",e.onInit):e.onInit(),r.on("resize",e.onResize),r.on("keydown",e.onKeydown)}detach(){var e;const r=this,s=r.instance;s.off("Carousel.init",r.onInit),s.off("resize",r.onResize),s.off("keydown",r.onKeydown),(e=s.carousel)===null||e===void 0||e.detachPlugins(["Thumbs"]),r.ref=null}}Object.defineProperty(zs,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:md});const Aa={panLeft:{icon:'<svg><path d="M5 12h14M5 12l6 6M5 12l6-6"/></svg>',change:{panX:-100}},panRight:{icon:'<svg><path d="M5 12h14M13 18l6-6M13 6l6 6"/></svg>',change:{panX:100}},panUp:{icon:'<svg><path d="M12 5v14M18 11l-6-6M6 11l6-6"/></svg>',change:{panY:-100}},panDown:{icon:'<svg><path d="M12 5v14M18 13l-6 6M6 13l6 6"/></svg>',change:{panY:100}},zoomIn:{icon:'<svg><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M11 8v6M8 11h6"/></svg>',action:"zoomIn"},zoomOut:{icon:'<svg><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M8 11h6"/></svg>',action:"zoomOut"},toggle1to1:{icon:'<svg><path d="M3.51 3.07c5.74.02 11.48-.02 17.22.02 1.37.1 2.34 1.64 2.18 3.13 0 4.08.02 8.16 0 12.23-.1 1.54-1.47 2.64-2.79 2.46-5.61-.01-11.24.02-16.86-.01-1.36-.12-2.33-1.65-2.17-3.14 0-4.07-.02-8.16 0-12.23.1-1.36 1.22-2.48 2.42-2.46Z"/><path d="M5.65 8.54h1.49v6.92m8.94-6.92h1.49v6.92M11.5 9.4v.02m0 5.18v0"/></svg>',action:"toggleZoom"},toggleZoom:{icon:'<svg><g><line x1="11" y1="8" x2="11" y2="14"></line></g><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M8 11h6"/></svg>',action:"toggleZoom"},iterateZoom:{icon:'<svg><g><line x1="11" y1="8" x2="11" y2="14"></line></g><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M8 11h6"/></svg>',action:"iterateZoom"},rotateCCW:{icon:'<svg><path d="M15 4.55a8 8 0 0 0-6 14.9M9 15v5H4M18.37 7.16v.01M13 19.94v.01M16.84 18.37v.01M19.37 15.1v.01M19.94 11v.01"/></svg>',action:"rotateCCW"},rotateCW:{icon:'<svg><path d="M9 4.55a8 8 0 0 1 6 14.9M15 15v5h5M5.63 7.16v.01M4.06 11v.01M4.63 15.1v.01M7.16 18.37v.01M11 19.94v.01"/></svg>',action:"rotateCW"},flipX:{icon:'<svg style="stroke-width: 1.3"><path d="M12 3v18M16 7v10h5L16 7M8 7v10H3L8 7"/></svg>',action:"flipX"},flipY:{icon:'<svg style="stroke-width: 1.3"><path d="M3 12h18M7 16h10L7 21v-5M7 8h10L7 3v5"/></svg>',action:"flipY"},fitX:{icon:'<svg><path d="M4 12V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v6M10 18H3M21 18h-7M6 15l-3 3 3 3M18 15l3 3-3 3"/></svg>',action:"fitX"},fitY:{icon:'<svg><path d="M12 20H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h6M18 14v7M18 3v7M15 18l3 3 3-3M15 6l3-3 3 3"/></svg>',action:"fitY"},reset:{icon:'<svg><path d="M20 11A8.1 8.1 0 0 0 4.5 9M4 5v4h4M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4"/></svg>',action:"reset"},toggleFS:{icon:'<svg><g><path d="M14.5 9.5 21 3m0 0h-6m6 0v6M3 21l6.5-6.5M3 21v-6m0 6h6"/></g><g><path d="m14 10 7-7m-7 7h6m-6 0V4M3 21l7-7m0 0v6m0-6H4"/></g></svg>',action:"toggleFS"}};var Hi;(function(p){p[p.Init=0]="Init",p[p.Ready=1]="Ready",p[p.Disabled=2]="Disabled"})(Hi||(Hi={}));const gd={absolute:"auto",display:{left:["infobar"],middle:[],right:["iterateZoom","slideshow","fullscreen","thumbs","close"]},enabled:"auto",items:{infobar:{tpl:'<div class="fancybox__infobar" tabindex="-1"><span data-fancybox-current-index></span>/<span data-fancybox-count></span></div>'},download:{tpl:'<a class="f-button" title="{{DOWNLOAD}}" data-fancybox-download href="javasript:;"><svg><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2M7 11l5 5 5-5M12 4v12"/></svg></a>'},prev:{tpl:'<button class="f-button" title="{{PREV}}" data-fancybox-prev><svg><path d="m15 6-6 6 6 6"/></svg></button>'},next:{tpl:'<button class="f-button" title="{{NEXT}}" data-fancybox-next><svg><path d="m9 6 6 6-6 6"/></svg></button>'},slideshow:{tpl:'<button class="f-button" title="{{TOGGLE_SLIDESHOW}}" data-fancybox-toggle-slideshow><svg><g><path d="M8 4v16l13 -8z"></path></g><g><path d="M8 4v15M17 4v15"/></g></svg></button>'},fullscreen:{tpl:'<button class="f-button" title="{{TOGGLE_FULLSCREEN}}" data-fancybox-toggle-fullscreen><svg><g><path d="M4 8V6a2 2 0 0 1 2-2h2M4 16v2a2 2 0 0 0 2 2h2M16 4h2a2 2 0 0 1 2 2v2M16 20h2a2 2 0 0 0 2-2v-2"/></g><g><path d="M15 19v-2a2 2 0 0 1 2-2h2M15 5v2a2 2 0 0 0 2 2h2M5 15h2a2 2 0 0 1 2 2v2M5 9h2a2 2 0 0 0 2-2V5"/></g></svg></button>'},thumbs:{tpl:'<button class="f-button" title="{{TOGGLE_THUMBS}}" data-fancybox-toggle-thumbs><svg><circle cx="5.5" cy="5.5" r="1"/><circle cx="12" cy="5.5" r="1"/><circle cx="18.5" cy="5.5" r="1"/><circle cx="5.5" cy="12" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="18.5" cy="12" r="1"/><circle cx="5.5" cy="18.5" r="1"/><circle cx="12" cy="18.5" r="1"/><circle cx="18.5" cy="18.5" r="1"/></svg></button>'},close:{tpl:'<button class="f-button" title="{{CLOSE}}" data-fancybox-close><svg><path d="m19.5 4.5-15 15M4.5 4.5l15 15"/></svg></button>'}},parentEl:null},vd={tabindex:"-1",width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Fo="has-toolbar",La="fancybox__toolbar";class Fs extends Fn{constructor(){super(...arguments),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:Hi.Init}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null})}onReady(e){var r;if(!e.carousel)return;let s=this.option("display"),l=this.option("absolute"),d=this.option("enabled");if(d==="auto"){const S=this.instance.carousel;let E=0;if(S)for(const h of S.slides)(h.panzoom||h.type==="image")&&E++;E||(d=!1)}d||(s=void 0);let m=0;const u={left:[],middle:[],right:[]};if(s)for(const S of["left","middle","right"])for(const E of s[S]){const h=this.createEl(E);h&&((r=u[S])===null||r===void 0||r.push(h),m++)}let v=null;if(m&&(v=this.createContainer()),v){for(const[S,E]of Object.entries(u)){const h=document.createElement("div");qe(h,La+"__column is-"+S);for(const f of E)h.appendChild(f);l!=="auto"||S!=="middle"||E.length||(l=!0),v.appendChild(h)}l===!0&&qe(v,"is-absolute"),this.state=Hi.Ready,this.onRefresh()}else this.state=Hi.Disabled}onClick(e){var r,s;const l=this.instance,d=l.getSlide(),m=d==null?void 0:d.panzoom,u=e.target,v=u&&vn(u)?u.dataset:null;if(!v)return;if(v.fancyboxToggleThumbs!==void 0)return e.preventDefault(),e.stopPropagation(),void((r=l.plugins.Thumbs)===null||r===void 0||r.toggle());if(v.fancyboxToggleFullscreen!==void 0)return e.preventDefault(),e.stopPropagation(),void this.instance.toggleFullscreen();if(v.fancyboxToggleSlideshow!==void 0){e.preventDefault(),e.stopPropagation();const h=(s=l.carousel)===null||s===void 0?void 0:s.plugins.Autoplay;let f=h.isActive;return m&&m.panMode==="mousemove"&&!f&&m.reset(),void(f?h.stop():h.start())}const S=v.panzoomAction,E=v.panzoomChange;if((E||S)&&(e.preventDefault(),e.stopPropagation()),E){let h={};try{h=JSON.parse(E)}catch{}m&&m.applyChange(h)}else S&&m&&m[S]&&m[S]()}onChange(){this.onRefresh()}onRefresh(){if(this.instance.isClosing())return;const e=this.container;if(!e)return;const r=this.instance.getSlide();if(!r||r.state!==cn.Ready)return;const s=r&&!r.error&&r.panzoom;for(const m of e.querySelectorAll("[data-panzoom-action]"))s?(m.removeAttribute("disabled"),m.removeAttribute("tabindex")):(m.setAttribute("disabled",""),m.setAttribute("tabindex","-1"));let l=s&&s.canZoomIn(),d=s&&s.canZoomOut();for(const m of e.querySelectorAll('[data-panzoom-action="zoomIn"]'))l?(m.removeAttribute("disabled"),m.removeAttribute("tabindex")):(m.setAttribute("disabled",""),m.setAttribute("tabindex","-1"));for(const m of e.querySelectorAll('[data-panzoom-action="zoomOut"]'))d?(m.removeAttribute("disabled"),m.removeAttribute("tabindex")):(m.setAttribute("disabled",""),m.setAttribute("tabindex","-1"));for(const m of e.querySelectorAll('[data-panzoom-action="toggleZoom"],[data-panzoom-action="iterateZoom"]')){d||l?(m.removeAttribute("disabled"),m.removeAttribute("tabindex")):(m.setAttribute("disabled",""),m.setAttribute("tabindex","-1"));const u=m.querySelector("g");u&&(u.style.display=l?"":"none")}}onDone(e,r){var s;(s=r.panzoom)===null||s===void 0||s.on("afterTransform",()=>{this.instance.isCurrentSlide(r)&&this.onRefresh()}),this.instance.isCurrentSlide(r)&&this.onRefresh()}createContainer(){const e=this.instance.container;if(!e)return null;const r=this.option("parentEl")||e;let s=r.querySelector("."+La);return s||(s=document.createElement("div"),qe(s,La),r.prepend(s)),s.addEventListener("click",this.onClick,{passive:!1,capture:!0}),e&&qe(e,Fo),this.container=s,s}createEl(e){const r=this.instance,s=r.carousel;if(!s||e==="toggleFS"||e==="fullscreen"&&!Ds())return null;let l=null;const d=s.slides.length||0;let m=0,u=0;for(const S of s.slides)(S.panzoom||S.type==="image")&&m++,(S.type==="image"||S.downloadSrc)&&u++;if(d<2&&["infobar","prev","next"].includes(e))return l;if(Aa[e]!==void 0&&!m||e==="download"&&!u)return null;if(e==="thumbs"){const S=r.plugins.Thumbs;if(!S||!S.isEnabled)return null}if(e==="slideshow"&&(!s.plugins.Autoplay||d<2))return null;if(Aa[e]!==void 0){const S=Aa[e];l=document.createElement("button"),l.setAttribute("title",this.instance.localize(`{{${e.toUpperCase()}}}`)),qe(l,"f-button"),S.action&&(l.dataset.panzoomAction=S.action),S.change&&(l.dataset.panzoomChange=JSON.stringify(S.change)),l.appendChild(Xn(this.instance.localize(S.icon)))}else{const S=(this.option("items")||[])[e];S&&(l=Xn(this.instance.localize(S.tpl)),typeof S.click=="function"&&l.addEventListener("click",E=>{E.preventDefault(),E.stopPropagation(),typeof S.click=="function"&&S.click.call(this,this,E)}))}const v=l==null?void 0:l.querySelector("svg");if(v)for(const[S,E]of Object.entries(vd))v.getAttribute(S)||v.setAttribute(S,String(E));return l}removeContainer(){const e=this.container;e&&e.remove(),this.container=null,this.state=Hi.Disabled;const r=this.instance.container;r&&wt(r,Fo)}attach(){const e=this,r=e.instance;r.on("Carousel.initSlides",e.onReady),r.on("done",e.onDone),r.on(["reveal","Carousel.change"],e.onChange),e.onReady(e.instance)}detach(){const e=this,r=e.instance;r.off("Carousel.initSlides",e.onReady),r.off("done",e.onDone),r.off(["reveal","Carousel.change"],e.onChange),e.removeContainer()}}Object.defineProperty(Fs,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:gd});const bd={Hash:class extends Fn{onReady(){wr=!1}onChange(p){Ri&&clearTimeout(Ri);const{hash:e}=Os(),{hash:r}=la(),s=p.isOpeningSlide(p.getSlide());s&&(Ho=r===e?"":r),e&&e!==r&&(Ri=setTimeout(()=>{try{if(p.state===Jt.Ready){let l="replaceState";s&&!Kr&&(l="pushState",Kr=!0),window.history[l]({},document.title,window.location.pathname+window.location.search+e)}}catch{}},300))}onClose(p){if(Ri&&clearTimeout(Ri),!wr&&Kr)return Kr=!1,wr=!1,void window.history.back();if(!wr)try{window.history.replaceState({},document.title,window.location.pathname+window.location.search+(Ho||""))}catch{}}attach(){const p=this.instance;p.on("ready",this.onReady),p.on(["Carousel.ready","Carousel.change"],this.onChange),p.on("close",this.onClose)}detach(){const p=this.instance;p.off("ready",this.onReady),p.off(["Carousel.ready","Carousel.change"],this.onChange),p.off("close",this.onClose)}static parseURL(){return la()}static startFromUrl(){Ps()}static destroy(){window.removeEventListener("hashchange",Is,!1)}},Html:Ns,Images:Hs,Slideshow:$s,Thumbs:zs,Toolbar:Fs},Vo="with-fancybox",Da="hide-scrollbar",qo="--fancybox-scrollbar-compensate",Wo="--fancybox-body-margin",Oa="aria-hidden",Pa="is-using-tab",Ra="is-animated",Yo="is-compact",Ko="is-loading",Ia="is-opening",Qr="has-caption",Ji="disabled",Li="tabindex",Go="download",Ha="href",Qi="src",yi=p=>typeof p=="string",Xo=function(){var p=window.getSelection();return!!p&&p.type==="Range"};let Pn,Rn=null,Di=null,Zo=0,Jo=0,Qo=0,es=0;const er=new Map;let yd=0;class bt extends no{get isIdle(){return this.idle}get isCompact(){return this.option("compact")}constructor(e=[],r={},s={}){super(r),Object.defineProperty(this,"userSlides",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"userPlugins",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"idle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"idleTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"clickTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"pwt",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"ignoreFocusChange",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"startedFs",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:Jt.Init}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"footer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"carousel",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"lastFocus",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"prevMouseMoveEvent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Pn||(Pn=Ds()),this.id=r.id||++yd,er.set(this.id,this),this.userSlides=e,this.userPlugins=s,queueMicrotask(()=>{this.init()})}init(){if(this.state===Jt.Destroy)return;this.state=Jt.Init,this.attachPlugins(Object.assign(Object.assign({},bt.Plugins),this.userPlugins)),this.emit("init"),this.emit("attachPlugins"),this.option("hideScrollbar")===!0&&(()=>{if(!xr)return;const r=document,s=r.body,l=r.documentElement;if(s.classList.contains(Da))return;let d=window.innerWidth-l.getBoundingClientRect().width;const m=parseFloat(window.getComputedStyle(s).marginRight);d<0&&(d=0),l.style.setProperty(qo,`${d}px`),m&&s.style.setProperty(Wo,`${m}px`),s.classList.add(Da)})(),this.initLayout(),this.scale();const e=()=>{this.initCarousel(this.userSlides),this.state=Jt.Ready,this.attachEvents(),this.emit("ready"),setTimeout(()=>{this.container&&this.container.setAttribute(Oa,"false")},16)};this.option("Fullscreen.autoStart")&&Pn&&!Pn.isFullscreen()?Pn.request().then(()=>{this.startedFs=!0,e()}).catch(()=>e()):e()}initLayout(){var e,r;const s=this.option("parentEl")||document.body,l=Xn(this.localize(this.option("tpl.main")||""));if(l){if(l.setAttribute("id",`fancybox-${this.id}`),l.setAttribute("aria-label",this.localize("{{MODAL}}")),l.classList.toggle(Yo,this.isCompact),qe(l,this.option("mainClass")||""),qe(l,Ia),this.container=l,this.footer=l.querySelector(".fancybox__footer"),s.appendChild(l),qe(document.documentElement,Vo),Rn&&Di||(Rn=document.createElement("span"),qe(Rn,"fancybox-focus-guard"),Rn.setAttribute(Li,"0"),Rn.setAttribute(Oa,"true"),Rn.setAttribute("aria-label","Focus guard"),Di=Rn.cloneNode(),(e=l.parentElement)===null||e===void 0||e.insertBefore(Rn,l),(r=l.parentElement)===null||r===void 0||r.append(Di)),l.addEventListener("mousedown",d=>{Zo=d.pageX,Jo=d.pageY,wt(l,Pa)}),this.option("closeExisting"))for(const d of er.values())d.id!==this.id&&d.close();else this.option("animated")&&(qe(l,Ra),setTimeout(()=>{this.isClosing()||wt(l,Ra)},350));this.emit("initLayout")}}initCarousel(e){const r=this.container;if(!r)return;const s=r.querySelector(".fancybox__carousel");if(!s)return;const l=this.carousel=new Ui(s,bn({},{slides:e,transition:"fade",Panzoom:{lockAxis:this.option("dragToClose")?"xy":"x",infinite:!!this.option("dragToClose")&&"y"},Dots:!1,Navigation:{classes:{container:"fancybox__nav",button:"f-button",isNext:"is-next",isPrev:"is-prev"}},initialPage:this.option("startIndex"),l10n:this.option("l10n")},this.option("Carousel")||{}));l.on("*",(d,m,...u)=>{this.emit(`Carousel.${m}`,d,...u)}),l.on(["ready","change"],()=>{this.manageCaption()}),this.on("Carousel.removeSlide",(d,m,u)=>{this.clearContent(u),u.state=void 0}),l.on("Panzoom.touchStart",()=>{var d,m;this.isCompact||this.endIdle(),!((d=document.activeElement)===null||d===void 0)&&d.closest(".f-thumbs")&&((m=this.container)===null||m===void 0||m.focus())}),l.on("settle",()=>{this.idleTimer||this.isCompact||!this.option("idle")||this.setIdle(),this.option("autoFocus")&&!this.isClosing&&this.checkFocus()}),this.option("dragToClose")&&(l.on("Panzoom.afterTransform",(d,m)=>{const u=this.getSlide();if(u&&za(u.el))return;const v=this.container;if(v){const S=Math.abs(m.current.f),E=S<1?"":Math.max(.5,Math.min(1,1-S/m.contentRect.fitHeight*1.5));v.style.setProperty("--fancybox-ts",E?"0s":""),v.style.setProperty("--fancybox-opacity",E+"")}}),l.on("Panzoom.touchEnd",(d,m,u)=>{var v;const S=this.getSlide();if(S&&za(S.el)||m.isMobile&&document.activeElement&&["TEXTAREA","INPUT"].indexOf((v=document.activeElement)===null||v===void 0?void 0:v.nodeName)!==-1)return;const E=Math.abs(m.dragOffset.y);m.lockedAxis==="y"&&(E>=200||E>=50&&m.dragOffset.time<300)&&(u&&u.cancelable&&u.preventDefault(),this.close(u,"f-throwOut"+(m.current.f<0?"Up":"Down")))})),l.on("change",d=>{var m;let u=(m=this.getSlide())===null||m===void 0?void 0:m.triggerEl;if(u){const v=new CustomEvent("slideTo",{bubbles:!0,cancelable:!0,detail:d.page});u.dispatchEvent(v)}}),l.on(["refresh","change"],d=>{const m=this.container;if(!m)return;for(const S of m.querySelectorAll("[data-fancybox-current-index]"))S.innerHTML=d.page+1;for(const S of m.querySelectorAll("[data-fancybox-count]"))S.innerHTML=d.pages.length;if(!d.isInfinite){for(const S of m.querySelectorAll("[data-fancybox-next]"))d.page<d.pages.length-1?(S.removeAttribute(Ji),S.removeAttribute(Li)):(S.setAttribute(Ji,""),S.setAttribute(Li,"-1"));for(const S of m.querySelectorAll("[data-fancybox-prev]"))d.page>0?(S.removeAttribute(Ji),S.removeAttribute(Li)):(S.setAttribute(Ji,""),S.setAttribute(Li,"-1"))}const u=this.getSlide();if(!u)return;let v=u.downloadSrc||"";v||u.type!=="image"||u.error||!yi(u[Qi])||(v=u[Qi]);for(const S of m.querySelectorAll("[data-fancybox-download]")){const E=u.downloadFilename;v?(S.removeAttribute(Ji),S.removeAttribute(Li),S.setAttribute(Ha,v),S.setAttribute(Go,E||v),S.setAttribute("target","_blank")):(S.setAttribute(Ji,""),S.setAttribute(Li,"-1"),S.removeAttribute(Ha),S.removeAttribute(Go))}}),this.emit("initCarousel")}attachEvents(){const e=this,r=e.container;if(!r)return;r.addEventListener("click",e.onClick,{passive:!1,capture:!1}),r.addEventListener("wheel",e.onWheel,{passive:!1,capture:!1}),document.addEventListener("keydown",e.onKeydown,{passive:!1,capture:!0}),document.addEventListener("visibilitychange",e.onVisibilityChange,!1),document.addEventListener("mousemove",e.onMousemove),e.option("trapFocus")&&document.addEventListener("focus",e.onFocus,!0),window.addEventListener("resize",e.onResize);const s=window.visualViewport;s&&(s.addEventListener("scroll",e.onResize),s.addEventListener("resize",e.onResize))}detachEvents(){const e=this,r=e.container;if(!r)return;document.removeEventListener("keydown",e.onKeydown,{passive:!1,capture:!0}),r.removeEventListener("wheel",e.onWheel,{passive:!1,capture:!1}),r.removeEventListener("click",e.onClick,{passive:!1,capture:!1}),document.removeEventListener("mousemove",e.onMousemove),window.removeEventListener("resize",e.onResize);const s=window.visualViewport;s&&(s.removeEventListener("resize",e.onResize),s.removeEventListener("scroll",e.onResize)),document.removeEventListener("visibilitychange",e.onVisibilityChange,!1),document.removeEventListener("focus",e.onFocus,!0)}scale(){const e=this.container;if(!e)return;const r=window.visualViewport,s=Math.max(1,(r==null?void 0:r.scale)||1);let l="",d="",m="";if(r&&s>1){let u=`${r.offsetLeft}px`,v=`${r.offsetTop}px`;l=r.width*s+"px",d=r.height*s+"px",m=`translate3d(${u}, ${v}, 0) scale(${1/s})`}e.style.transform=m,e.style.width=l,e.style.height=d}onClick(e){var r;const{container:s,isCompact:l}=this;if(!s||this.isClosing())return;!l&&this.option("idle")&&this.resetIdle();const d=e.composedPath()[0];if(d.closest(".fancybox-spinner")||d.closest("[data-fancybox-close]"))return e.preventDefault(),void this.close(e);if(d.closest("[data-fancybox-prev]"))return e.preventDefault(),void this.prev();if(d.closest("[data-fancybox-next]"))return e.preventDefault(),void this.next();if(e.type==="click"&&e.detail===0||Math.abs(e.pageX-Zo)>30||Math.abs(e.pageY-Jo)>30)return;const m=document.activeElement;if(Xo()&&m&&s.contains(m))return;if(l&&((r=this.getSlide())===null||r===void 0?void 0:r.type)==="image")return void(this.clickTimer?(clearTimeout(this.clickTimer),this.clickTimer=null):this.clickTimer=setTimeout(()=>{this.toggleIdle(),this.clickTimer=null},350));if(this.emit("click",e),e.defaultPrevented)return;let u=!1;if(d.closest(".fancybox__content")){if(m){if(m.closest("[contenteditable]"))return;d.matches(Ca)||m.blur()}if(Xo())return;u=this.option("contentClick")}else d.closest(".fancybox__carousel")&&!d.matches(Ca)&&(u=this.option("backdropClick"));u==="close"?(e.preventDefault(),this.close(e)):u==="next"?(e.preventDefault(),this.next()):u==="prev"&&(e.preventDefault(),this.prev())}onWheel(e){const r=e.target;let s=this.option("wheel",e);r.closest(".fancybox__thumbs")&&(s="slide");const l=s==="slide",d=[-e.deltaX||0,-e.deltaY||0,-e.detail||0].reduce(function(v,S){return Math.abs(S)>Math.abs(v)?S:v}),m=Math.max(-1,Math.min(1,d)),u=Date.now();this.pwt&&u-this.pwt<300?l&&e.preventDefault():(this.pwt=u,this.emit("wheel",e,m),e.defaultPrevented||(s==="close"?(e.preventDefault(),this.close(e)):s==="slide"&&(oa(r)||(e.preventDefault(),this[m>0?"prev":"next"]()))))}onScroll(){window.scrollTo(Qo,es)}onKeydown(e){if(!this.isTopmost())return;this.isCompact||!this.option("idle")||this.isClosing()||this.resetIdle();const r=e.key,s=this.option("keyboard");if(!s)return;const l=e.composedPath()[0],d=document.activeElement&&document.activeElement.classList,m=d&&d.contains("f-button")||l.dataset.carouselPage||l.dataset.carouselIndex;if(r!=="Escape"&&!m&&vn(l)&&(l.isContentEditable||["TEXTAREA","OPTION","INPUT","SELECT","VIDEO"].indexOf(l.nodeName)!==-1)||(e.key==="Tab"?qe(this.container,Pa):wt(this.container,Pa),e.ctrlKey||e.altKey||e.shiftKey))return;this.emit("keydown",r,e);const u=s[r];u&&typeof this[u]=="function"&&(e.preventDefault(),this[u]())}onResize(){const e=this.container;if(!e)return;const r=this.isCompact;e.classList.toggle(Yo,r),this.manageCaption(this.getSlide()),this.isCompact?this.clearIdle():this.endIdle(),this.scale(),this.emit("resize")}onFocus(e){this.isTopmost()&&this.checkFocus(e)}onMousemove(e){this.prevMouseMoveEvent=e,!this.isCompact&&this.option("idle")&&this.resetIdle()}onVisibilityChange(){document.visibilityState==="visible"?this.checkFocus():this.endIdle()}manageCloseBtn(e){const r=this.optionFor(e,"closeButton")||!1;if(r==="auto"){const l=this.plugins.Toolbar;if(l&&l.state===Hi.Ready)return}if(!r||!e.contentEl||e.closeBtnEl)return;const s=this.option("tpl.closeButton");if(s){const l=Xn(this.localize(s));e.closeBtnEl=e.contentEl.appendChild(l),e.el&&qe(e.el,"has-close-btn")}}manageCaption(e=void 0){var r,s;const l="fancybox__caption",d=this.container;if(!d)return;wt(d,Qr);const m=this.isCompact||this.option("commonCaption"),u=!m;if(this.caption&&this.stop(this.caption),u&&this.caption&&(this.caption.remove(),this.caption=null),m&&!this.caption)for(const h of((r=this.carousel)===null||r===void 0?void 0:r.slides)||[])h.captionEl&&(h.captionEl.remove(),h.captionEl=void 0,wt(h.el,Qr),(s=h.el)===null||s===void 0||s.removeAttribute("aria-labelledby"));if(e||(e=this.getSlide()),!e||m&&!this.isCurrentSlide(e))return;const v=e.el;let S=this.optionFor(e,"caption","");if(!S)return void(m&&this.caption&&this.animate(this.caption,"f-fadeOut",()=>{this.caption&&(this.caption.innerHTML="")}));let E=null;if(u){if(E=e.captionEl||null,v&&!E){const h=l+`_${this.id}_${e.index}`;E=document.createElement("div"),qe(E,l),E.setAttribute("id",h),e.captionEl=v.appendChild(E),qe(v,Qr),v.setAttribute("aria-labelledby",h)}}else E=this.caption,E||(E=d.querySelector("."+l)),!E&&(E=document.createElement("div"),E.dataset.fancyboxCaption="",qe(E,l),(this.footer||d).prepend(E)),qe(d,Qr),this.caption=E;E&&(E.innerHTML="",yi(S)||typeof S=="number"?E.innerHTML=S+"":S instanceof HTMLElement&&E.appendChild(S))}checkFocus(e){this.focus(e)}focus(e){var r;if(this.ignoreFocusChange)return;const s=document.activeElement||null,l=(e==null?void 0:e.target)||null,d=this.container,m=(r=this.carousel)===null||r===void 0?void 0:r.viewport;if(!d||!m||!e&&s&&d.contains(s))return;const u=this.getSlide(),v=u&&u.state===cn.Ready?u.el:null;if(!v||v.contains(s)||d===s)return;e&&e.cancelable&&e.preventDefault(),this.ignoreFocusChange=!0;const S=Array.from(d.querySelectorAll(Ca));let E=[],h=null;for(let g of S){const b=!g.offsetParent||!!g.closest('[aria-hidden="true"]'),k=v&&v.contains(g),w=!m.contains(g);if(g===d||(k||w)&&!b){E.push(g);const _=g.dataset.origTabindex;_!==void 0&&_&&(g.tabIndex=parseFloat(_)),g.removeAttribute("data-orig-tabindex"),!g.hasAttribute("autoFocus")&&h||(h=g)}else{const _=g.dataset.origTabindex===void 0?g.getAttribute("tabindex")||"":g.dataset.origTabindex;_&&(g.dataset.origTabindex=_),g.tabIndex=-1}}let f=null;e?(!l||E.indexOf(l)<0)&&(f=h||d,E.length&&(s===Di?f=E[0]:this.lastFocus!==d&&s!==Rn||(f=E[E.length-1]))):f=u&&u.type==="image"?d:h||d,f&&Io(f),this.lastFocus=document.activeElement,this.ignoreFocusChange=!1}next(){const e=this.carousel;e&&e.pages.length>1&&e.slideNext()}prev(){const e=this.carousel;e&&e.pages.length>1&&e.slidePrev()}jumpTo(...e){this.carousel&&this.carousel.slideTo(...e)}isTopmost(){var e;return((e=bt.getInstance())===null||e===void 0?void 0:e.id)==this.id}animate(e=null,r="",s){if(!e||!r)return void(s&&s());this.stop(e);const l=d=>{d.target===e&&e.dataset.animationName&&(e.removeEventListener("animationend",l),delete e.dataset.animationName,s&&s(),wt(e,r))};e.dataset.animationName=r,e.addEventListener("animationend",l),qe(e,r)}stop(e){e&&e.dispatchEvent(new CustomEvent("animationend",{bubbles:!1,cancelable:!0,currentTarget:e}))}setContent(e,r="",s=!0){if(this.isClosing())return;const l=e.el;if(!l)return;let d=null;if(vn(r)?d=r:(d=Xn(r+""),vn(d)||(d=document.createElement("div"),d.innerHTML=r+"")),["img","picture","iframe","video","audio"].includes(d.nodeName.toLowerCase())){const m=document.createElement("div");m.appendChild(d),d=m}vn(d)&&e.filter&&!e.error&&(d=d.querySelector(e.filter)),d&&vn(d)?(qe(d,"fancybox__content"),e.id&&d.setAttribute("id",e.id),l.classList.add(`has-${e.error?"error":e.type||"unknown"}`),l.prepend(d),d.style.display==="none"&&(d.style.display=""),getComputedStyle(d).getPropertyValue("display")==="none"&&(d.style.display=e.display||this.option("defaultDisplay")||"flex"),e.contentEl=d,s&&this.revealContent(e),this.manageCloseBtn(e),this.manageCaption(e)):this.setError(e,"{{ELEMENT_NOT_FOUND}}")}revealContent(e,r){const s=e.el,l=e.contentEl;s&&l&&(this.emit("reveal",e),this.hideLoading(e),e.state=cn.Opening,(r=this.isOpeningSlide(e)?r===void 0?this.optionFor(e,"showClass"):r:"f-fadeIn")?this.animate(l,r,()=>{this.done(e)}):this.done(e))}done(e){this.isClosing()||(e.state=cn.Ready,this.emit("done",e),qe(e.el,"is-done"),this.isCurrentSlide(e)&&this.option("autoFocus")&&queueMicrotask(()=>{var r;(r=e.panzoom)===null||r===void 0||r.updateControls(),this.option("autoFocus")&&this.focus()}),this.isOpeningSlide(e)&&(wt(this.container,Ia),!this.isCompact&&this.option("idle")&&this.setIdle()))}isCurrentSlide(e){const r=this.getSlide();return!(!e||!r)&&r.index===e.index}isOpeningSlide(e){var r,s;return((r=this.carousel)===null||r===void 0?void 0:r.prevPage)===null&&e&&e.index===((s=this.getSlide())===null||s===void 0?void 0:s.index)}showLoading(e){e.state=cn.Loading;const r=e.el;r&&(qe(r,Ko),this.emit("loading",e),e.spinnerEl||setTimeout(()=>{if(!this.isClosing()&&!e.spinnerEl&&e.state===cn.Loading){let s=Xn(io);qe(s,"fancybox-spinner"),e.spinnerEl=s,r.prepend(s),this.animate(s,"f-fadeIn")}},250))}hideLoading(e){const r=e.el;if(!r)return;const s=e.spinnerEl;this.isClosing()?s==null||s.remove():(wt(r,Ko),s&&this.animate(s,"f-fadeOut",()=>{s.remove()}),e.state===cn.Loading&&(this.emit("loaded",e),e.state=cn.Ready))}setError(e,r){if(this.isClosing())return;const s=new Event("error",{bubbles:!0,cancelable:!0});if(this.emit("error",s,e),s.defaultPrevented)return;e.error=r,this.hideLoading(e),this.clearContent(e);const l=document.createElement("div");l.classList.add("fancybox-error"),l.innerHTML=this.localize(r||"<p>{{ERROR}}</p>"),this.setContent(e,l)}clearContent(e){if(e.state===void 0)return;this.emit("clearContent",e),e.contentEl&&(e.contentEl.remove(),e.contentEl=void 0);const r=e.el;r&&(wt(r,"has-error"),wt(r,"has-unknown"),wt(r,`has-${e.type||"unknown"}`)),e.closeBtnEl&&e.closeBtnEl.remove(),e.closeBtnEl=void 0,e.captionEl&&e.captionEl.remove(),e.captionEl=void 0,e.spinnerEl&&e.spinnerEl.remove(),e.spinnerEl=void 0}getSlide(){var e;const r=this.carousel;return((e=r==null?void 0:r.pages[r==null?void 0:r.page])===null||e===void 0?void 0:e.slides[0])||void 0}close(e,r){if(this.isClosing())return;const s=new Event("shouldClose",{bubbles:!0,cancelable:!0});if(this.emit("shouldClose",s,e),s.defaultPrevented)return;e&&e.cancelable&&(e.preventDefault(),e.stopPropagation());const l=()=>{this.proceedClose(e,r)};this.startedFs&&Pn&&Pn.isFullscreen()?Promise.resolve(Pn.exit()).then(()=>l()):l()}clearIdle(){this.idleTimer&&clearTimeout(this.idleTimer),this.idleTimer=null}setIdle(e=!1){const r=()=>{this.clearIdle(),this.idle=!0,qe(this.container,"is-idle"),this.emit("setIdle")};if(this.clearIdle(),!this.isClosing())if(e)r();else{const s=this.option("idle");s&&(this.idleTimer=setTimeout(r,s))}}endIdle(){this.clearIdle(),this.idle&&!this.isClosing()&&(this.idle=!1,wt(this.container,"is-idle"),this.emit("endIdle"))}resetIdle(){this.endIdle(),this.setIdle()}toggleIdle(){this.idle?this.endIdle():this.setIdle(!0)}toggleFullscreen(){Pn&&(Pn.isFullscreen()?Pn.exit():Pn.request().then(()=>{this.startedFs=!0}))}isClosing(){return[Jt.Closing,Jt.CustomClosing,Jt.Destroy].includes(this.state)}proceedClose(e,r){var s,l;this.state=Jt.Closing,this.clearIdle(),this.detachEvents();const d=this.container,m=this.carousel,u=this.getSlide(),v=u&&this.option("placeFocusBack")?u.triggerEl||this.option("triggerEl"):null;if(v&&(Ls(v)?Io(v):v.focus()),d&&(wt(d,Ia),qe(d,"is-closing"),d.setAttribute(Oa,"true"),this.option("animated")&&qe(d,Ra),d.style.pointerEvents="none"),m){m.clearTransitions(),(s=m.panzoom)===null||s===void 0||s.destroy(),(l=m.plugins.Navigation)===null||l===void 0||l.detach();for(const S of m.slides){S.state=cn.Closing,this.hideLoading(S);const E=S.contentEl;E&&this.stop(E);const h=S==null?void 0:S.panzoom;h&&(h.stop(),h.detachEvents(),h.detachObserver()),this.isCurrentSlide(S)||m.emit("removeSlide",S)}}Qo=window.scrollX,es=window.scrollY,window.addEventListener("scroll",this.onScroll),this.emit("close",e),this.state!==Jt.CustomClosing?(r===void 0&&u&&(r=this.optionFor(u,"hideClass")),r&&u?(this.animate(u.contentEl,r,()=>{m&&m.emit("removeSlide",u)}),setTimeout(()=>{this.destroy()},500)):this.destroy()):setTimeout(()=>{this.destroy()},500)}destroy(){var e;if(this.state===Jt.Destroy)return;window.removeEventListener("scroll",this.onScroll),this.state=Jt.Destroy,(e=this.carousel)===null||e===void 0||e.destroy();const r=this.container;r&&r.remove(),er.delete(this.id);const s=bt.getInstance();s?s.focus():(Rn&&(Rn.remove(),Rn=null),Di&&(Di.remove(),Di=null),wt(document.documentElement,Vo),(()=>{if(!xr)return;const l=document,d=l.body;d.classList.remove(Da),d.style.setProperty(Wo,""),l.documentElement.style.setProperty(qo,"")})(),this.emit("destroy"))}static bind(e,r,s){if(!xr)return;let l,d="",m={};if(e===void 0?l=document.body:yi(e)?(l=document.body,d=e,typeof r=="object"&&(m=r||{})):(l=e,yi(r)&&(d=r),typeof s=="object"&&(m=s||{})),!l||!vn(l))return;d=d||"[data-fancybox]";const u=bt.openers.get(l)||new Map;u.set(d,m),bt.openers.set(l,u),u.size===1&&l.addEventListener("click",bt.fromEvent)}static unbind(e,r){let s,l="";if(yi(e)?(s=document.body,l=e):(s=e,yi(r)&&(l=r)),!s)return;const d=bt.openers.get(s);d&&l&&d.delete(l),l&&d||(bt.openers.delete(s),s.removeEventListener("click",bt.fromEvent))}static destroy(){let e;for(;e=bt.getInstance();)e.destroy();for(const r of bt.openers.keys())r.removeEventListener("click",bt.fromEvent);bt.openers=new Map}static fromEvent(e){if(e.defaultPrevented||e.button&&e.button!==0||e.ctrlKey||e.metaKey||e.shiftKey)return;let r=e.composedPath()[0];const s=r.closest("[data-fancybox-trigger]");if(s){const b=s.dataset.fancyboxTrigger||"",k=document.querySelectorAll(`[data-fancybox="${b}"]`),w=parseInt(s.dataset.fancyboxIndex||"",10)||0;r=k[w]||r}if(!(r&&r instanceof Element))return;let l,d,m,u;if([...bt.openers].reverse().find(([b,k])=>!(!b.contains(r)||![...k].reverse().find(([w,_])=>{let C=r.closest(w);return!!C&&(l=b,d=w,m=C,u=_,!0)}))),!l||!d||!m)return;u=u||{},e.preventDefault(),r=m;let v=[],S=bn({},Va,u);S.event=e,S.triggerEl=r,S.delegate=s;const E=S.groupAll,h=S.groupAttr,f=h&&r?r.getAttribute(`${h}`):"";if((!r||f||E)&&(v=[].slice.call(l.querySelectorAll(d))),r&&!E&&(v=f?v.filter(b=>b.getAttribute(`${h}`)===f):[r]),!v.length)return;const g=bt.getInstance();return g&&g.options.triggerEl&&v.indexOf(g.options.triggerEl)>-1?void 0:(r&&(S.startIndex=v.indexOf(r)),bt.fromNodes(v,S))}static fromSelector(e,r,s){let l=null,d="",m={};if(yi(e)?(l=document.body,d=e,typeof r=="object"&&(m=r||{})):e instanceof HTMLElement&&yi(r)&&(l=e,d=r,typeof s=="object"&&(m=s||{})),!l||!d)return!1;const u=bt.openers.get(l);return!!u&&(m=bn({},u.get(d)||{},m),!!m&&bt.fromNodes(Array.from(l.querySelectorAll(d)),m))}static fromNodes(e,r){r=bn({},Va,r||{});const s=[];for(const l of e){const d=l.dataset||{},m=d[Qi]||l.getAttribute(Ha)||l.getAttribute("currentSrc")||l.getAttribute(Qi)||void 0;let u;const v=r.delegate;let S;v&&s.length===r.startIndex&&(u=v instanceof HTMLImageElement?v:v.querySelector("img:not([aria-hidden])")),u||(u=l instanceof HTMLImageElement?l:l.querySelector("img:not([aria-hidden])")),u&&(S=u.currentSrc||u[Qi]||void 0,!S&&u.dataset&&(S=u.dataset.lazySrc||u.dataset[Qi]||void 0));const E={src:m,triggerEl:l,thumbEl:u,thumbElSrc:S,thumbSrc:S};for(const h in d){let f=d[h]+"";f=f!=="false"&&(f==="true"||f),E[h]=f}s.push(E)}return new bt(s,r)}static getInstance(e){return e?er.get(e):Array.from(er.values()).reverse().find(r=>!r.isClosing()&&r)||null}static getSlide(){var e;return((e=bt.getInstance())===null||e===void 0?void 0:e.getSlide())||null}static show(e=[],r={}){return new bt(e,r)}static next(){const e=bt.getInstance();e&&e.next()}static prev(){const e=bt.getInstance();e&&e.prev()}static close(e=!0,...r){if(e)for(const s of er.values())s.close(...r);else{const s=bt.getInstance();s&&s.close(...r)}}}Object.defineProperty(bt,"version",{enumerable:!0,configurable:!0,writable:!0,value:"5.0.36"}),Object.defineProperty(bt,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:Va}),Object.defineProperty(bt,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:bd}),Object.defineProperty(bt,"openers",{enumerable:!0,configurable:!0,writable:!0,value:new Map});function wd(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}var na={exports:{}};/*!
 * Vditor v3.10.9 - A markdown editor written in TypeScript.
 *
 * MIT License
 *
 * Copyright (c) 2018-present B3log 开源, b3log.org
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */var Ed=na.exports,ts;function kd(){return ts||(ts=1,function(p,e){(function(s,l){p.exports=l()})(Ed,()=>(()=>{var r={192:m=>{var u=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},v=-1,S=1,E=0;u.Diff=function(h,f){return[h,f]},u.prototype.diff_main=function(h,f,g,b){typeof b>"u"&&(this.Diff_Timeout<=0?b=Number.MAX_VALUE:b=new Date().getTime()+this.Diff_Timeout*1e3);var k=b;if(h==null||f==null)throw new Error("Null input. (diff_main)");if(h==f)return h?[new u.Diff(E,h)]:[];typeof g>"u"&&(g=!0);var w=g,_=this.diff_commonPrefix(h,f),C=h.substring(0,_);h=h.substring(_),f=f.substring(_),_=this.diff_commonSuffix(h,f);var T=h.substring(h.length-_);h=h.substring(0,h.length-_),f=f.substring(0,f.length-_);var M=this.diff_compute_(h,f,w,k);return C&&M.unshift(new u.Diff(E,C)),T&&M.push(new u.Diff(E,T)),this.diff_cleanupMerge(M),M},u.prototype.diff_compute_=function(h,f,g,b){var k;if(!h)return[new u.Diff(S,f)];if(!f)return[new u.Diff(v,h)];var w=h.length>f.length?h:f,_=h.length>f.length?f:h,C=w.indexOf(_);if(C!=-1)return k=[new u.Diff(S,w.substring(0,C)),new u.Diff(E,_),new u.Diff(S,w.substring(C+_.length))],h.length>f.length&&(k[0][0]=k[2][0]=v),k;if(_.length==1)return[new u.Diff(v,h),new u.Diff(S,f)];var T=this.diff_halfMatch_(h,f);if(T){var M=T[0],y=T[1],O=T[2],B=T[3],V=T[4],I=this.diff_main(M,O,g,b),j=this.diff_main(y,B,g,b);return I.concat([new u.Diff(E,V)],j)}return g&&h.length>100&&f.length>100?this.diff_lineMode_(h,f,b):this.diff_bisect_(h,f,b)},u.prototype.diff_lineMode_=function(h,f,g){var b=this.diff_linesToChars_(h,f);h=b.chars1,f=b.chars2;var k=b.lineArray,w=this.diff_main(h,f,!1,g);this.diff_charsToLines_(w,k),this.diff_cleanupSemantic(w),w.push(new u.Diff(E,""));for(var _=0,C=0,T=0,M="",y="";_<w.length;){switch(w[_][0]){case S:T++,y+=w[_][1];break;case v:C++,M+=w[_][1];break;case E:if(C>=1&&T>=1){w.splice(_-C-T,C+T),_=_-C-T;for(var O=this.diff_main(M,y,!1,g),B=O.length-1;B>=0;B--)w.splice(_,0,O[B]);_=_+O.length}T=0,C=0,M="",y="";break}_++}return w.pop(),w},u.prototype.diff_bisect_=function(h,f,g){for(var b=h.length,k=f.length,w=Math.ceil((b+k)/2),_=w,C=2*w,T=new Array(C),M=new Array(C),y=0;y<C;y++)T[y]=-1,M[y]=-1;T[_+1]=0,M[_+1]=0;for(var O=b-k,B=O%2!=0,V=0,I=0,j=0,z=0,F=0;F<w&&!(new Date().getTime()>g);F++){for(var le=-F+V;le<=F-I;le+=2){var de=_+le,Re;le==-F||le!=F&&T[de-1]<T[de+1]?Re=T[de+1]:Re=T[de-1]+1;for(var Be=Re-le;Re<b&&Be<k&&h.charAt(Re)==f.charAt(Be);)Re++,Be++;if(T[de]=Re,Re>b)I+=2;else if(Be>k)V+=2;else if(B){var Ce=_+O-le;if(Ce>=0&&Ce<C&&M[Ce]!=-1){var De=b-M[Ce];if(Re>=De)return this.diff_bisectSplit_(h,f,Re,Be,g)}}}for(var Ie=-F+j;Ie<=F-z;Ie+=2){var Ce=_+Ie,De;Ie==-F||Ie!=F&&M[Ce-1]<M[Ce+1]?De=M[Ce+1]:De=M[Ce-1]+1;for(var Je=De-Ie;De<b&&Je<k&&h.charAt(b-De-1)==f.charAt(k-Je-1);)De++,Je++;if(M[Ce]=De,De>b)z+=2;else if(Je>k)j+=2;else if(!B){var de=_+O-Ie;if(de>=0&&de<C&&T[de]!=-1){var Re=T[de],Be=_+Re-de;if(De=b-De,Re>=De)return this.diff_bisectSplit_(h,f,Re,Be,g)}}}}return[new u.Diff(v,h),new u.Diff(S,f)]},u.prototype.diff_bisectSplit_=function(h,f,g,b,k){var w=h.substring(0,g),_=f.substring(0,b),C=h.substring(g),T=f.substring(b),M=this.diff_main(w,_,!1,k),y=this.diff_main(C,T,!1,k);return M.concat(y)},u.prototype.diff_linesToChars_=function(h,f){var g=[],b={};g[0]="";function k(T){for(var M="",y=0,O=-1,B=g.length;O<T.length-1;){O=T.indexOf(`
`,y),O==-1&&(O=T.length-1);var V=T.substring(y,O+1);(b.hasOwnProperty?b.hasOwnProperty(V):b[V]!==void 0)?M+=String.fromCharCode(b[V]):(B==w&&(V=T.substring(y),O=T.length),M+=String.fromCharCode(B),b[V]=B,g[B++]=V),y=O+1}return M}var w=4e4,_=k(h);w=65535;var C=k(f);return{chars1:_,chars2:C,lineArray:g}},u.prototype.diff_charsToLines_=function(h,f){for(var g=0;g<h.length;g++){for(var b=h[g][1],k=[],w=0;w<b.length;w++)k[w]=f[b.charCodeAt(w)];h[g][1]=k.join("")}},u.prototype.diff_commonPrefix=function(h,f){if(!h||!f||h.charAt(0)!=f.charAt(0))return 0;for(var g=0,b=Math.min(h.length,f.length),k=b,w=0;g<k;)h.substring(w,k)==f.substring(w,k)?(g=k,w=g):b=k,k=Math.floor((b-g)/2+g);return k},u.prototype.diff_commonSuffix=function(h,f){if(!h||!f||h.charAt(h.length-1)!=f.charAt(f.length-1))return 0;for(var g=0,b=Math.min(h.length,f.length),k=b,w=0;g<k;)h.substring(h.length-k,h.length-w)==f.substring(f.length-k,f.length-w)?(g=k,w=g):b=k,k=Math.floor((b-g)/2+g);return k},u.prototype.diff_commonOverlap_=function(h,f){var g=h.length,b=f.length;if(g==0||b==0)return 0;g>b?h=h.substring(g-b):g<b&&(f=f.substring(0,g));var k=Math.min(g,b);if(h==f)return k;for(var w=0,_=1;;){var C=h.substring(k-_),T=f.indexOf(C);if(T==-1)return w;_+=T,(T==0||h.substring(k-_)==f.substring(0,_))&&(w=_,_++)}},u.prototype.diff_halfMatch_=function(h,f){if(this.Diff_Timeout<=0)return null;var g=h.length>f.length?h:f,b=h.length>f.length?f:h;if(g.length<4||b.length*2<g.length)return null;var k=this;function w(I,j,z){for(var F=I.substring(z,z+Math.floor(I.length/4)),le=-1,de="",Re,Be,Ce,De;(le=j.indexOf(F,le+1))!=-1;){var Ie=k.diff_commonPrefix(I.substring(z),j.substring(le)),Je=k.diff_commonSuffix(I.substring(0,z),j.substring(0,le));de.length<Je+Ie&&(de=j.substring(le-Je,le)+j.substring(le,le+Ie),Re=I.substring(0,z-Je),Be=I.substring(z+Ie),Ce=j.substring(0,le-Je),De=j.substring(le+Ie))}return de.length*2>=I.length?[Re,Be,Ce,De,de]:null}var _=w(g,b,Math.ceil(g.length/4)),C=w(g,b,Math.ceil(g.length/2)),T;if(!_&&!C)return null;C?_?T=_[4].length>C[4].length?_:C:T=C:T=_;var M,y,O,B;h.length>f.length?(M=T[0],y=T[1],O=T[2],B=T[3]):(O=T[0],B=T[1],M=T[2],y=T[3]);var V=T[4];return[M,y,O,B,V]},u.prototype.diff_cleanupSemantic=function(h){for(var f=!1,g=[],b=0,k=null,w=0,_=0,C=0,T=0,M=0;w<h.length;)h[w][0]==E?(g[b++]=w,_=T,C=M,T=0,M=0,k=h[w][1]):(h[w][0]==S?T+=h[w][1].length:M+=h[w][1].length,k&&k.length<=Math.max(_,C)&&k.length<=Math.max(T,M)&&(h.splice(g[b-1],0,new u.Diff(v,k)),h[g[b-1]+1][0]=S,b--,b--,w=b>0?g[b-1]:-1,_=0,C=0,T=0,M=0,k=null,f=!0)),w++;for(f&&this.diff_cleanupMerge(h),this.diff_cleanupSemanticLossless(h),w=1;w<h.length;){if(h[w-1][0]==v&&h[w][0]==S){var y=h[w-1][1],O=h[w][1],B=this.diff_commonOverlap_(y,O),V=this.diff_commonOverlap_(O,y);B>=V?(B>=y.length/2||B>=O.length/2)&&(h.splice(w,0,new u.Diff(E,O.substring(0,B))),h[w-1][1]=y.substring(0,y.length-B),h[w+1][1]=O.substring(B),w++):(V>=y.length/2||V>=O.length/2)&&(h.splice(w,0,new u.Diff(E,y.substring(0,V))),h[w-1][0]=S,h[w-1][1]=O.substring(0,O.length-V),h[w+1][0]=v,h[w+1][1]=y.substring(V),w++),w++}w++}},u.prototype.diff_cleanupSemanticLossless=function(h){function f(V,I){if(!V||!I)return 6;var j=V.charAt(V.length-1),z=I.charAt(0),F=j.match(u.nonAlphaNumericRegex_),le=z.match(u.nonAlphaNumericRegex_),de=F&&j.match(u.whitespaceRegex_),Re=le&&z.match(u.whitespaceRegex_),Be=de&&j.match(u.linebreakRegex_),Ce=Re&&z.match(u.linebreakRegex_),De=Be&&V.match(u.blanklineEndRegex_),Ie=Ce&&I.match(u.blanklineStartRegex_);return De||Ie?5:Be||Ce?4:F&&!de&&Re?3:de||Re?2:F||le?1:0}for(var g=1;g<h.length-1;){if(h[g-1][0]==E&&h[g+1][0]==E){var b=h[g-1][1],k=h[g][1],w=h[g+1][1],_=this.diff_commonSuffix(b,k);if(_){var C=k.substring(k.length-_);b=b.substring(0,b.length-_),k=C+k.substring(0,k.length-_),w=C+w}for(var T=b,M=k,y=w,O=f(b,k)+f(k,w);k.charAt(0)===w.charAt(0);){b+=k.charAt(0),k=k.substring(1)+w.charAt(0),w=w.substring(1);var B=f(b,k)+f(k,w);B>=O&&(O=B,T=b,M=k,y=w)}h[g-1][1]!=T&&(T?h[g-1][1]=T:(h.splice(g-1,1),g--),h[g][1]=M,y?h[g+1][1]=y:(h.splice(g+1,1),g--))}g++}},u.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,u.whitespaceRegex_=/\s/,u.linebreakRegex_=/[\r\n]/,u.blanklineEndRegex_=/\n\r?\n$/,u.blanklineStartRegex_=/^\r?\n\r?\n/,u.prototype.diff_cleanupEfficiency=function(h){for(var f=!1,g=[],b=0,k=null,w=0,_=!1,C=!1,T=!1,M=!1;w<h.length;)h[w][0]==E?(h[w][1].length<this.Diff_EditCost&&(T||M)?(g[b++]=w,_=T,C=M,k=h[w][1]):(b=0,k=null),T=M=!1):(h[w][0]==v?M=!0:T=!0,k&&(_&&C&&T&&M||k.length<this.Diff_EditCost/2&&_+C+T+M==3)&&(h.splice(g[b-1],0,new u.Diff(v,k)),h[g[b-1]+1][0]=S,b--,k=null,_&&C?(T=M=!0,b=0):(b--,w=b>0?g[b-1]:-1,T=M=!1),f=!0)),w++;f&&this.diff_cleanupMerge(h)},u.prototype.diff_cleanupMerge=function(h){h.push(new u.Diff(E,""));for(var f=0,g=0,b=0,k="",w="",_;f<h.length;)switch(h[f][0]){case S:b++,w+=h[f][1],f++;break;case v:g++,k+=h[f][1],f++;break;case E:g+b>1?(g!==0&&b!==0&&(_=this.diff_commonPrefix(w,k),_!==0&&(f-g-b>0&&h[f-g-b-1][0]==E?h[f-g-b-1][1]+=w.substring(0,_):(h.splice(0,0,new u.Diff(E,w.substring(0,_))),f++),w=w.substring(_),k=k.substring(_)),_=this.diff_commonSuffix(w,k),_!==0&&(h[f][1]=w.substring(w.length-_)+h[f][1],w=w.substring(0,w.length-_),k=k.substring(0,k.length-_))),f-=g+b,h.splice(f,g+b),k.length&&(h.splice(f,0,new u.Diff(v,k)),f++),w.length&&(h.splice(f,0,new u.Diff(S,w)),f++),f++):f!==0&&h[f-1][0]==E?(h[f-1][1]+=h[f][1],h.splice(f,1)):f++,b=0,g=0,k="",w="";break}h[h.length-1][1]===""&&h.pop();var C=!1;for(f=1;f<h.length-1;)h[f-1][0]==E&&h[f+1][0]==E&&(h[f][1].substring(h[f][1].length-h[f-1][1].length)==h[f-1][1]?(h[f][1]=h[f-1][1]+h[f][1].substring(0,h[f][1].length-h[f-1][1].length),h[f+1][1]=h[f-1][1]+h[f+1][1],h.splice(f-1,1),C=!0):h[f][1].substring(0,h[f+1][1].length)==h[f+1][1]&&(h[f-1][1]+=h[f+1][1],h[f][1]=h[f][1].substring(h[f+1][1].length)+h[f+1][1],h.splice(f+1,1),C=!0)),f++;C&&this.diff_cleanupMerge(h)},u.prototype.diff_xIndex=function(h,f){var g=0,b=0,k=0,w=0,_;for(_=0;_<h.length&&(h[_][0]!==S&&(g+=h[_][1].length),h[_][0]!==v&&(b+=h[_][1].length),!(g>f));_++)k=g,w=b;return h.length!=_&&h[_][0]===v?w:w+(f-k)},u.prototype.diff_prettyHtml=function(h){for(var f=[],g=/&/g,b=/</g,k=/>/g,w=/\n/g,_=0;_<h.length;_++){var C=h[_][0],T=h[_][1],M=T.replace(g,"&amp;").replace(b,"&lt;").replace(k,"&gt;").replace(w,"&para;<br>");switch(C){case S:f[_]='<ins style="background:#e6ffe6;">'+M+"</ins>";break;case v:f[_]='<del style="background:#ffe6e6;">'+M+"</del>";break;case E:f[_]="<span>"+M+"</span>";break}}return f.join("")},u.prototype.diff_text1=function(h){for(var f=[],g=0;g<h.length;g++)h[g][0]!==S&&(f[g]=h[g][1]);return f.join("")},u.prototype.diff_text2=function(h){for(var f=[],g=0;g<h.length;g++)h[g][0]!==v&&(f[g]=h[g][1]);return f.join("")},u.prototype.diff_levenshtein=function(h){for(var f=0,g=0,b=0,k=0;k<h.length;k++){var w=h[k][0],_=h[k][1];switch(w){case S:g+=_.length;break;case v:b+=_.length;break;case E:f+=Math.max(g,b),g=0,b=0;break}}return f+=Math.max(g,b),f},u.prototype.diff_toDelta=function(h){for(var f=[],g=0;g<h.length;g++)switch(h[g][0]){case S:f[g]="+"+encodeURI(h[g][1]);break;case v:f[g]="-"+h[g][1].length;break;case E:f[g]="="+h[g][1].length;break}return f.join("	").replace(/%20/g," ")},u.prototype.diff_fromDelta=function(h,f){for(var g=[],b=0,k=0,w=f.split(/\t/g),_=0;_<w.length;_++){var C=w[_].substring(1);switch(w[_].charAt(0)){case"+":try{g[b++]=new u.Diff(S,decodeURI(C))}catch{throw new Error("Illegal escape in diff_fromDelta: "+C)}break;case"-":case"=":var T=parseInt(C,10);if(isNaN(T)||T<0)throw new Error("Invalid number in diff_fromDelta: "+C);var M=h.substring(k,k+=T);w[_].charAt(0)=="="?g[b++]=new u.Diff(E,M):g[b++]=new u.Diff(v,M);break;default:if(w[_])throw new Error("Invalid diff operation in diff_fromDelta: "+w[_])}}if(k!=h.length)throw new Error("Delta length ("+k+") does not equal source text length ("+h.length+").");return g},u.prototype.match_main=function(h,f,g){if(h==null||f==null||g==null)throw new Error("Null input. (match_main)");return g=Math.max(0,Math.min(g,h.length)),h==f?0:h.length?h.substring(g,g+f.length)==f?g:this.match_bitap_(h,f,g):-1},u.prototype.match_bitap_=function(h,f,g){if(f.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var b=this.match_alphabet_(f),k=this;function w(Re,Be){var Ce=Re/f.length,De=Math.abs(g-Be);return k.Match_Distance?Ce+De/k.Match_Distance:De?1:Ce}var _=this.Match_Threshold,C=h.indexOf(f,g);C!=-1&&(_=Math.min(w(0,C),_),C=h.lastIndexOf(f,g+f.length),C!=-1&&(_=Math.min(w(0,C),_)));var T=1<<f.length-1;C=-1;for(var M,y,O=f.length+h.length,B,V=0;V<f.length;V++){for(M=0,y=O;M<y;)w(V,g+y)<=_?M=y:O=y,y=Math.floor((O-M)/2+M);O=y;var I=Math.max(1,g-y+1),j=Math.min(g+y,h.length)+f.length,z=Array(j+2);z[j+1]=(1<<V)-1;for(var F=j;F>=I;F--){var le=b[h.charAt(F-1)];if(V===0?z[F]=(z[F+1]<<1|1)&le:z[F]=(z[F+1]<<1|1)&le|((B[F+1]|B[F])<<1|1)|B[F+1],z[F]&T){var de=w(V,F-1);if(de<=_)if(_=de,C=F-1,C>g)I=Math.max(1,2*g-C);else break}}if(w(V+1,g)>_)break;B=z}return C},u.prototype.match_alphabet_=function(h){for(var f={},g=0;g<h.length;g++)f[h.charAt(g)]=0;for(var g=0;g<h.length;g++)f[h.charAt(g)]|=1<<h.length-g-1;return f},u.prototype.patch_addContext_=function(h,f){if(f.length!=0){if(h.start2===null)throw Error("patch not initialized");for(var g=f.substring(h.start2,h.start2+h.length1),b=0;f.indexOf(g)!=f.lastIndexOf(g)&&g.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)b+=this.Patch_Margin,g=f.substring(h.start2-b,h.start2+h.length1+b);b+=this.Patch_Margin;var k=f.substring(h.start2-b,h.start2);k&&h.diffs.unshift(new u.Diff(E,k));var w=f.substring(h.start2+h.length1,h.start2+h.length1+b);w&&h.diffs.push(new u.Diff(E,w)),h.start1-=k.length,h.start2-=k.length,h.length1+=k.length+w.length,h.length2+=k.length+w.length}},u.prototype.patch_make=function(h,f,g){var b,k;if(typeof h=="string"&&typeof f=="string"&&typeof g>"u")b=h,k=this.diff_main(b,f,!0),k.length>2&&(this.diff_cleanupSemantic(k),this.diff_cleanupEfficiency(k));else if(h&&typeof h=="object"&&typeof f>"u"&&typeof g>"u")k=h,b=this.diff_text1(k);else if(typeof h=="string"&&f&&typeof f=="object"&&typeof g>"u")b=h,k=f;else if(typeof h=="string"&&typeof f=="string"&&g&&typeof g=="object")b=h,k=g;else throw new Error("Unknown call format to patch_make.");if(k.length===0)return[];for(var w=[],_=new u.patch_obj,C=0,T=0,M=0,y=b,O=b,B=0;B<k.length;B++){var V=k[B][0],I=k[B][1];switch(!C&&V!==E&&(_.start1=T,_.start2=M),V){case S:_.diffs[C++]=k[B],_.length2+=I.length,O=O.substring(0,M)+I+O.substring(M);break;case v:_.length1+=I.length,_.diffs[C++]=k[B],O=O.substring(0,M)+O.substring(M+I.length);break;case E:I.length<=2*this.Patch_Margin&&C&&k.length!=B+1?(_.diffs[C++]=k[B],_.length1+=I.length,_.length2+=I.length):I.length>=2*this.Patch_Margin&&C&&(this.patch_addContext_(_,y),w.push(_),_=new u.patch_obj,C=0,y=O,T=M);break}V!==S&&(T+=I.length),V!==v&&(M+=I.length)}return C&&(this.patch_addContext_(_,y),w.push(_)),w},u.prototype.patch_deepCopy=function(h){for(var f=[],g=0;g<h.length;g++){var b=h[g],k=new u.patch_obj;k.diffs=[];for(var w=0;w<b.diffs.length;w++)k.diffs[w]=new u.Diff(b.diffs[w][0],b.diffs[w][1]);k.start1=b.start1,k.start2=b.start2,k.length1=b.length1,k.length2=b.length2,f[g]=k}return f},u.prototype.patch_apply=function(h,f){if(h.length==0)return[f,[]];h=this.patch_deepCopy(h);var g=this.patch_addPadding(h);f=g+f+g,this.patch_splitMax(h);for(var b=0,k=[],w=0;w<h.length;w++){var _=h[w].start2+b,C=this.diff_text1(h[w].diffs),T,M=-1;if(C.length>this.Match_MaxBits?(T=this.match_main(f,C.substring(0,this.Match_MaxBits),_),T!=-1&&(M=this.match_main(f,C.substring(C.length-this.Match_MaxBits),_+C.length-this.Match_MaxBits),(M==-1||T>=M)&&(T=-1))):T=this.match_main(f,C,_),T==-1)k[w]=!1,b-=h[w].length2-h[w].length1;else{k[w]=!0,b=T-_;var y;if(M==-1?y=f.substring(T,T+C.length):y=f.substring(T,M+this.Match_MaxBits),C==y)f=f.substring(0,T)+this.diff_text2(h[w].diffs)+f.substring(T+C.length);else{var O=this.diff_main(C,y,!1);if(C.length>this.Match_MaxBits&&this.diff_levenshtein(O)/C.length>this.Patch_DeleteThreshold)k[w]=!1;else{this.diff_cleanupSemanticLossless(O);for(var B=0,V,I=0;I<h[w].diffs.length;I++){var j=h[w].diffs[I];j[0]!==E&&(V=this.diff_xIndex(O,B)),j[0]===S?f=f.substring(0,T+V)+j[1]+f.substring(T+V):j[0]===v&&(f=f.substring(0,T+V)+f.substring(T+this.diff_xIndex(O,B+j[1].length))),j[0]!==v&&(B+=j[1].length)}}}}}return f=f.substring(g.length,f.length-g.length),[f,k]},u.prototype.patch_addPadding=function(h){for(var f=this.Patch_Margin,g="",b=1;b<=f;b++)g+=String.fromCharCode(b);for(var b=0;b<h.length;b++)h[b].start1+=f,h[b].start2+=f;var k=h[0],w=k.diffs;if(w.length==0||w[0][0]!=E)w.unshift(new u.Diff(E,g)),k.start1-=f,k.start2-=f,k.length1+=f,k.length2+=f;else if(f>w[0][1].length){var _=f-w[0][1].length;w[0][1]=g.substring(w[0][1].length)+w[0][1],k.start1-=_,k.start2-=_,k.length1+=_,k.length2+=_}if(k=h[h.length-1],w=k.diffs,w.length==0||w[w.length-1][0]!=E)w.push(new u.Diff(E,g)),k.length1+=f,k.length2+=f;else if(f>w[w.length-1][1].length){var _=f-w[w.length-1][1].length;w[w.length-1][1]+=g.substring(0,_),k.length1+=_,k.length2+=_}return g},u.prototype.patch_splitMax=function(h){for(var f=this.Match_MaxBits,g=0;g<h.length;g++)if(!(h[g].length1<=f)){var b=h[g];h.splice(g--,1);for(var k=b.start1,w=b.start2,_="";b.diffs.length!==0;){var C=new u.patch_obj,T=!0;for(C.start1=k-_.length,C.start2=w-_.length,_!==""&&(C.length1=C.length2=_.length,C.diffs.push(new u.Diff(E,_)));b.diffs.length!==0&&C.length1<f-this.Patch_Margin;){var M=b.diffs[0][0],y=b.diffs[0][1];M===S?(C.length2+=y.length,w+=y.length,C.diffs.push(b.diffs.shift()),T=!1):M===v&&C.diffs.length==1&&C.diffs[0][0]==E&&y.length>2*f?(C.length1+=y.length,k+=y.length,T=!1,C.diffs.push(new u.Diff(M,y)),b.diffs.shift()):(y=y.substring(0,f-C.length1-this.Patch_Margin),C.length1+=y.length,k+=y.length,M===E?(C.length2+=y.length,w+=y.length):T=!1,C.diffs.push(new u.Diff(M,y)),y==b.diffs[0][1]?b.diffs.shift():b.diffs[0][1]=b.diffs[0][1].substring(y.length))}_=this.diff_text2(C.diffs),_=_.substring(_.length-this.Patch_Margin);var O=this.diff_text1(b.diffs).substring(0,this.Patch_Margin);O!==""&&(C.length1+=O.length,C.length2+=O.length,C.diffs.length!==0&&C.diffs[C.diffs.length-1][0]===E?C.diffs[C.diffs.length-1][1]+=O:C.diffs.push(new u.Diff(E,O))),T||h.splice(++g,0,C)}}},u.prototype.patch_toText=function(h){for(var f=[],g=0;g<h.length;g++)f[g]=h[g];return f.join("")},u.prototype.patch_fromText=function(h){var f=[];if(!h)return f;for(var g=h.split(`
`),b=0,k=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;b<g.length;){var w=g[b].match(k);if(!w)throw new Error("Invalid patch string: "+g[b]);var _=new u.patch_obj;for(f.push(_),_.start1=parseInt(w[1],10),w[2]===""?(_.start1--,_.length1=1):w[2]=="0"?_.length1=0:(_.start1--,_.length1=parseInt(w[2],10)),_.start2=parseInt(w[3],10),w[4]===""?(_.start2--,_.length2=1):w[4]=="0"?_.length2=0:(_.start2--,_.length2=parseInt(w[4],10)),b++;b<g.length;){var C=g[b].charAt(0);try{var T=decodeURI(g[b].substring(1))}catch{throw new Error("Illegal escape in patch_fromText: "+T)}if(C=="-")_.diffs.push(new u.Diff(v,T));else if(C=="+")_.diffs.push(new u.Diff(S,T));else if(C==" ")_.diffs.push(new u.Diff(E,T));else{if(C=="@")break;if(C!=="")throw new Error('Invalid patch mode "'+C+'" in: '+T)}b++}}return f},u.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},u.patch_obj.prototype.toString=function(){var h,f;this.length1===0?h=this.start1+",0":this.length1==1?h=this.start1+1:h=this.start1+1+","+this.length1,this.length2===0?f=this.start2+",0":this.length2==1?f=this.start2+1:f=this.start2+1+","+this.length2;for(var g=["@@ -"+h+" +"+f+` @@
`],b,k=0;k<this.diffs.length;k++){switch(this.diffs[k][0]){case S:b="+";break;case v:b="-";break;case E:b=" ";break}g[k+1]=b+encodeURI(this.diffs[k][1])+`
`}return g.join("").replace(/%20/g," ")},m.exports=u,m.exports.diff_match_patch=u,m.exports.DIFF_DELETE=v,m.exports.DIFF_INSERT=S,m.exports.DIFF_EQUAL=E},923:(m,u,v)=>{v.d(u,{default:()=>Ke});var S=v(288),E=v(59),h=v(784),f=v(51),g=v(500),b=v(339),k=v(108),w=function(X){X===void 0&&(X=document);var we=function(se){var ee=document.createElement("img");ee.src=se.getAttribute("data-src"),ee.addEventListener("load",function(){!se.getAttribute("style")&&!se.getAttribute("class")&&!se.getAttribute("width")&&!se.getAttribute("height")&&ee.naturalHeight>ee.naturalWidth&&ee.naturalWidth/ee.naturalHeight<document.querySelector(".vditor-reset").clientWidth/(window.innerHeight-40)&&ee.naturalHeight>window.innerHeight-40&&(se.style.height=window.innerHeight-40+"px"),se.src=ee.src}),se.removeAttribute("data-src")};if(!("IntersectionObserver"in window))return X.querySelectorAll("img").forEach(function(se){se.getAttribute("data-src")&&we(se)}),!1;window.vditorImageIntersectionObserver?(window.vditorImageIntersectionObserver.disconnect(),X.querySelectorAll("img").forEach(function(se){window.vditorImageIntersectionObserver.observe(se)})):(window.vditorImageIntersectionObserver=new IntersectionObserver(function(se){se.forEach(function(ee){(typeof ee.isIntersecting>"u"?ee.intersectionRatio!==0:ee.isIntersecting)&&ee.target.getAttribute("data-src")&&we(ee.target)})}),X.querySelectorAll("img").forEach(function(se){window.vditorImageIntersectionObserver.observe(se)}))},_=v(960),C=v(0),T=v(975),M=v(931),y=v(597),O=v(162),B=v(70),V=v(591),I=v(913),j=v(873),z=v(161),F=v(598),le=v(905),de=function(X){document.querySelectorAll(".vditor-anchor").forEach(function(we){X===1&&we.classList.add("vditor-anchor--left"),we.onclick=function(){var se=we.getAttribute("href").substr(1),ee=document.getElementById("vditorAnchor-"+se).offsetTop;document.querySelector("html").scrollTop=ee}}),window.onhashchange=function(){var we=document.getElementById("vditorAnchor-"+decodeURIComponent(window.location.hash.substr(1)));we&&(document.querySelector("html").scrollTop=we.offsetTop)}},Re=v(796),Be=v(827),Ce=function(X,we){if(we===void 0&&(we="zh_CN"),!(typeof speechSynthesis>"u"||typeof SpeechSynthesisUtterance>"u")){var se=function(){var Qe=speechSynthesis.getVoices(),Oe,it;return Qe.forEach(function(lt){lt.lang===we.replace("_","-")&&(Oe=lt),lt.default&&(it=lt)}),Oe||(Oe=it),Oe},ee='<svg><use xlink:href="#vditor-icon-play"></use></svg>',He='<svg><use xlink:href="#vditor-icon-pause"></use></svg>';document.getElementById("vditorIconScript")||(ee='<svg viewBox="0 0 32 32"><path d="M3.436 0l25.128 16-25.128 16v-32z"></path></svg>',He='<svg viewBox="0 0 32 32"><path d="M20.617 0h9.128v32h-9.128v-32zM2.255 32v-32h9.128v32h-9.128z"></path></svg>');var ve=document.querySelector(".vditor-speech");ve||(ve=document.createElement("button"),ve.className="vditor-speech",X.insertAdjacentElement("beforeend",ve),speechSynthesis.onvoiceschanged!==void 0&&(speechSynthesis.onvoiceschanged=se));var st=se(),Ve=new SpeechSynthesisUtterance;Ve.voice=st,Ve.onend=Ve.onerror=function(){ve.style.display="none",speechSynthesis.cancel(),ve.classList.remove("vditor-speech--current"),ve.innerHTML=ee},X.addEventListener(window.ontouchstart!==void 0?"touchend":"click",function(Qe){var Oe=Qe.target;if(Oe.classList.contains("vditor-speech")||Oe.parentElement.classList.contains("vditor-speech")){ve.classList.contains("vditor-speech--current")?speechSynthesis.speaking&&(speechSynthesis.paused?(speechSynthesis.resume(),ve.innerHTML=He):(speechSynthesis.pause(),ve.innerHTML=ee)):(Ve.text=ve.getAttribute("data-text"),speechSynthesis.speak(Ve),ve.classList.add("vditor-speech--current"),ve.innerHTML=He),(0,Be.jl)(window.vditorSpeechRange),X.focus();return}if(ve.style.display="none",speechSynthesis.cancel(),ve.classList.remove("vditor-speech--current"),ve.innerHTML=ee,getSelection().rangeCount!==0){var it=getSelection().getRangeAt(0),lt=it.toString().trim();if(lt){window.vditorSpeechRange=it.cloneRange();var ft=it.getBoundingClientRect();ve.innerHTML=ee,ve.style.display="block",ve.style.top=ft.top+ft.height+document.querySelector("html").scrollTop-20+"px",window.ontouchstart!==void 0?ve.style.left=Qe.changedTouches[Qe.changedTouches.length-1].pageX+2+"px":ve.style.left=Qe.clientX+2+"px",ve.setAttribute("data-text",lt)}}})}},De=function(X,we,se,ee){function He(ve){return ve instanceof se?ve:new se(function(st){st(ve)})}return new(se||(se=Promise))(function(ve,st){function Ve(it){try{Oe(ee.next(it))}catch(lt){st(lt)}}function Qe(it){try{Oe(ee.throw(it))}catch(lt){st(lt)}}function Oe(it){it.done?ve(it.value):He(it.value).then(Ve,Qe)}Oe((ee=ee.apply(X,we||[])).next())})},Ie=function(X,we){var se={label:0,sent:function(){if(ve[0]&1)throw ve[1];return ve[1]},trys:[],ops:[]},ee,He,ve,st;return st={next:Ve(0),throw:Ve(1),return:Ve(2)},typeof Symbol=="function"&&(st[Symbol.iterator]=function(){return this}),st;function Ve(Oe){return function(it){return Qe([Oe,it])}}function Qe(Oe){if(ee)throw new TypeError("Generator is already executing.");for(;st&&(st=0,Oe[0]&&(se=0)),se;)try{if(ee=1,He&&(ve=Oe[0]&2?He.return:Oe[0]?He.throw||((ve=He.return)&&ve.call(He),0):He.next)&&!(ve=ve.call(He,Oe[1])).done)return ve;switch(He=0,ve&&(Oe=[Oe[0]&2,ve.value]),Oe[0]){case 0:case 1:ve=Oe;break;case 4:return se.label++,{value:Oe[1],done:!1};case 5:se.label++,He=Oe[1],Oe=[0];continue;case 7:Oe=se.ops.pop(),se.trys.pop();continue;default:if(ve=se.trys,!(ve=ve.length>0&&ve[ve.length-1])&&(Oe[0]===6||Oe[0]===2)){se=0;continue}if(Oe[0]===3&&(!ve||Oe[1]>ve[0]&&Oe[1]<ve[3])){se.label=Oe[1];break}if(Oe[0]===6&&se.label<ve[1]){se.label=ve[1],ve=Oe;break}if(ve&&se.label<ve[2]){se.label=ve[2],se.ops.push(Oe);break}ve[2]&&se.ops.pop(),se.trys.pop();continue}Oe=we.call(X,se)}catch(it){Oe=[6,it],He=0}finally{ee=ve=0}if(Oe[0]&5)throw Oe[1];return{value:Oe[0]?Oe[1]:void 0,done:!0}}},Je=function(X){var we,se={anchor:0,cdn:I.Y.CDN,customEmoji:{},emojiPath:"".concat(I.Y.CDN,"/dist/images/emoji"),hljs:I.Y.HLJS_OPTIONS,icon:"ant",lang:"zh_CN",markdown:I.Y.MARKDOWN_OPTIONS,math:I.Y.MATH_OPTIONS,mode:"light",speech:{enable:!1},render:{media:{enable:!0}},theme:I.Y.THEME_OPTIONS};return X.cdn&&(!((we=X.theme)===null||we===void 0)&&we.path||(se.theme.path="".concat(X.cdn,"/dist/css/content-theme")),X.emojiPath||(se.emojiPath="".concat(X.cdn,"/dist/images/emoji"))),(0,le.h)(se,X)},tt=function(X,we){var se=Je(we);return(0,z.Z)("".concat(se.cdn,"/dist/js/lute/lute.min.js"),"vditorLuteScript").then(function(){var ee=(0,Re.X)({autoSpace:se.markdown.autoSpace,gfmAutoLink:se.markdown.gfmAutoLink,codeBlockPreview:se.markdown.codeBlockPreview,emojiSite:se.emojiPath,emojis:se.customEmoji,fixTermTypo:se.markdown.fixTermTypo,footnotes:se.markdown.footnotes,headingAnchor:se.anchor!==0,inlineMathDigit:se.math.inlineDigit,lazyLoadImage:se.lazyLoadImage,linkBase:se.markdown.linkBase,linkPrefix:se.markdown.linkPrefix,listStyle:se.markdown.listStyle,mark:se.markdown.mark,mathBlockPreview:se.markdown.mathBlockPreview,paragraphBeginningSpace:se.markdown.paragraphBeginningSpace,sanitize:se.markdown.sanitize,toc:se.markdown.toc});return we!=null&&we.renderers&&ee.SetJSRenderers({renderers:{Md2HTML:we.renderers}}),ee.SetHeadingID(!0),ee.Md2HTML(X)})},U=function(X,we,se){return De(void 0,void 0,void 0,function(){var ee,He,ve,st;return Ie(this,function(Ve){switch(Ve.label){case 0:return ee=Je(se),[4,tt(we,ee)];case 1:if(He=Ve.sent(),ee.transform&&(He=ee.transform(He)),X.innerHTML=He,X.classList.add("vditor-reset"),ee.i18n)return[3,5];if(["en_US","fr_FR","pt_BR","ja_JP","ko_KR","ru_RU","sv_SE","zh_CN","zh_TW"].includes(ee.lang))return[3,2];throw new Error("options.lang error, see https://ld246.com/article/1549638745630#options");case 2:return ve="vditorI18nScript",st=ve+ee.lang,document.querySelectorAll('head script[id^="'.concat(ve,'"]')).forEach(function(Qe){Qe.id!==st&&document.head.removeChild(Qe)}),[4,(0,z.Z)("".concat(ee.cdn,"/dist/js/i18n/").concat(ee.lang,".js"),st)];case 3:Ve.sent(),Ve.label=4;case 4:return[3,6];case 5:window.VditorI18n=ee.i18n,Ve.label=6;case 6:return ee.icon?[4,(0,z.Z)("".concat(ee.cdn,"/dist/js/icons/").concat(ee.icon,".js"),"vditorIconScript")]:[3,8];case 7:Ve.sent(),Ve.label=8;case 8:return(0,j.H)(ee.theme.current,ee.theme.path),ee.anchor===1&&X.classList.add("vditor-reset--anchor"),(0,f.o)(X,ee.hljs),(0,k.$)(ee.hljs,X,ee.cdn),(0,_.T)(X,{cdn:ee.cdn,math:ee.math}),(0,T.e)(X,ee.cdn,ee.mode),(0,M.Y)(X,ee.cdn,ee.mode),(0,y.K)(X,ee.cdn),(0,g.D)(X,ee.cdn),(0,b.m)(X,ee.cdn),(0,h.v)(X,ee.cdn,ee.mode),(0,O.l)(X,ee.cdn,ee.mode),(0,V.M)(X,ee.cdn),(0,S.$)(X,ee.cdn),ee.render.media.enable&&(0,C.l)(X),ee.speech.enable&&Ce(X),ee.anchor!==0&&de(ee.anchor),ee.after&&ee.after(),ee.lazyLoadImage&&w(X),X.addEventListener("click",function(Qe){var Oe=(0,F._Y)(Qe.target,"SPAN");if(Oe&&(0,F.KJ)(Oe,"vditor-toc")){var it=X.querySelector("#"+Oe.getAttribute("data-target-id"));it&&window.scrollTo(window.scrollX,it.offsetTop);return}}),[2]}})})},oe=v(726),re=v(13),Ae=function(){function X(){}return X.adapterRender=E,X.previewImage=oe.o,X.codeRender=f.o,X.graphvizRender=b.m,X.highlightRender=k.$,X.mathRender=_.T,X.mermaidRender=T.e,X.SMILESRender=M.Y,X.markmapRender=y.K,X.flowchartRender=g.D,X.chartRender=h.v,X.abcRender=S.$,X.mindmapRender=O.l,X.plantumlRender=V.M,X.outlineRender=B.N,X.mediaRender=C.l,X.speechRender=Ce,X.lazyLoadImageRender=w,X.md2html=tt,X.preview=U,X.setCodeTheme=re.h,X.setContentTheme=j.H,X}();const Ke=Ae},913:(m,u,v)=>{v.d(u,{Y:()=>E,g:()=>S});var S="3.10.9",E=function(){function h(){}return h.ZWSP="​",h.DROP_EDITOR="application/editor",h.MOBILE_WIDTH=520,h.CLASS_MENU_DISABLED="vditor-menu--disabled",h.EDIT_TOOLBARS=["emoji","headings","bold","italic","strike","link","list","ordered-list","outdent","indent","check","line","quote","code","inline-code","insert-after","insert-before","upload","record","table"],h.CODE_THEME=["a11y-dark","agate","an-old-hope","androidstudio","arta","atom-one-dark","atom-one-dark-reasonable","base16/3024","base16/apathy","base16/apprentice","base16/ashes","base16/atelier-cave","base16/atelier-dune","base16/atelier-estuary","base16/atelier-forest","base16/atelier-heath","base16/atelier-lakeside","base16/atelier-plateau","base16/atelier-savanna","base16/atelier-seaside","base16/atelier-sulphurpool","base16/atlas","base16/bespin","base16/black-metal","base16/black-metal-bathory","base16/black-metal-burzum","base16/black-metal-dark-funeral","base16/black-metal-gorgoroth","base16/black-metal-immortal","base16/black-metal-khold","base16/black-metal-marduk","base16/black-metal-mayhem","base16/black-metal-nile","base16/black-metal-venom","base16/brewer","base16/bright","base16/brogrammer","base16/brush-trees-dark","base16/chalk","base16/circus","base16/classic-dark","base16/codeschool","base16/colors","base16/danqing","base16/darcula","base16/dark-violet","base16/darkmoss","base16/darktooth","base16/decaf","base16/default-dark","base16/dracula","base16/edge-dark","base16/eighties","base16/embers","base16/equilibrium-dark","base16/equilibrium-gray-dark","base16/espresso","base16/eva","base16/eva-dim","base16/flat","base16/framer","base16/gigavolt","base16/google-dark","base16/grayscale-dark","base16/green-screen","base16/gruvbox-dark-hard","base16/gruvbox-dark-medium","base16/gruvbox-dark-pale","base16/gruvbox-dark-soft","base16/hardcore","base16/harmonic16-dark","base16/heetch-dark","base16/helios","base16/hopscotch","base16/horizon-dark","base16/humanoid-dark","base16/ia-dark","base16/icy-dark","base16/ir-black","base16/isotope","base16/kimber","base16/london-tube","base16/macintosh","base16/marrakesh","base16/materia","base16/material","base16/material-darker","base16/material-palenight","base16/material-vivid","base16/mellow-purple","base16/mocha","base16/monokai","base16/nebula","base16/nord","base16/nova","base16/ocean","base16/oceanicnext","base16/onedark","base16/outrun-dark","base16/papercolor-dark","base16/paraiso","base16/pasque","base16/phd","base16/pico","base16/pop","base16/porple","base16/qualia","base16/railscasts","base16/rebecca","base16/ros-pine","base16/ros-pine-moon","base16/sandcastle","base16/seti-ui","base16/silk-dark","base16/snazzy","base16/solar-flare","base16/solarized-dark","base16/spacemacs","base16/summercamp","base16/summerfruit-dark","base16/synth-midnight-terminal-dark","base16/tango","base16/tender","base16/tomorrow-night","base16/twilight","base16/unikitty-dark","base16/vulcan","base16/windows-10","base16/windows-95","base16/windows-high-contrast","base16/windows-nt","base16/woodland","base16/xcode-dusk","base16/zenburn","codepen-embed","dark","devibeans","far","felipec","github-dark","github-dark-dimmed","gml","gradient-dark","hybrid","ir-black","isbl-editor-dark","kimbie-dark","lioshi","monokai","monokai-sublime","night-owl","nnfx-dark","nord","obsidian","panda-syntax-dark","paraiso-dark","pojoaque","qtcreator-dark","rainbow","shades-of-purple","srcery","stackoverflow-dark","sunburst","tomorrow-night-blue","tomorrow-night-bright","tokyo-night-dark","vs2015","xt256","ant-design","a11y-light","arduino-light","ascetic","atom-one-light","base16/atelier-cave-light","base16/atelier-dune-light","base16/atelier-estuary-light","base16/atelier-forest-light","base16/atelier-heath-light","base16/atelier-lakeside-light","base16/atelier-plateau-light","base16/atelier-savanna-light","base16/atelier-seaside-light","base16/atelier-sulphurpool-light","base16/brush-trees","base16/classic-light","base16/cupcake","base16/cupertino","base16/default-light","base16/dirtysea","base16/edge-light","base16/equilibrium-gray-light","base16/equilibrium-light","base16/fruit-soda","base16/github","base16/google-light","base16/grayscale-light","base16/gruvbox-light-hard","base16/gruvbox-light-medium","base16/gruvbox-light-soft","base16/harmonic16-light","base16/heetch-light","base16/humanoid-light","base16/horizon-light","base16/ia-light","base16/material-lighter","base16/mexico-light","base16/one-light","base16/papercolor-light","base16/ros-pine-dawn","base16/sagelight","base16/shapeshifter","base16/silk-light","base16/solar-flare-light","base16/solarized-light","base16/summerfruit-light","base16/synth-midnight-terminal-light","base16/tomorrow","base16/unikitty-light","base16/windows-10-light","base16/windows-95-light","base16/windows-high-contrast-light","brown-paper","base16/windows-nt-light","color-brewer","docco","foundation","github","googlecode","gradient-light","grayscale","idea","intellij-light","isbl-editor-light","kimbie-light","lightfair","magula","mono-blue","nnfx-light","panda-syntax-light","paraiso-light","purebasic","qtcreator-light","routeros","school-book","stackoverflow-light","tokyo-night-light","vs","xcode","default"],h.ALIAS_CODE_LANGUAGES=["abc","plantuml","mermaid","flowchart","echarts","mindmap","graphviz","math","markmap","smiles","js","ts","html","toml","c#","bat"],h.CDN="https://unpkg.com/vditor@".concat("3.10.9"),h.MARKDOWN_OPTIONS={autoSpace:!1,gfmAutoLink:!0,codeBlockPreview:!0,fixTermTypo:!1,footnotes:!0,linkBase:"",linkPrefix:"",listStyle:!1,mark:!1,mathBlockPreview:!0,paragraphBeginningSpace:!1,sanitize:!0,toc:!1},h.HLJS_OPTIONS={enable:!0,lineNumber:!1,defaultLang:"",style:"github"},h.MATH_OPTIONS={engine:"KaTeX",inlineDigit:!1,macros:{}},h.THEME_OPTIONS={current:"light",list:{"ant-design":"Ant Design",dark:"Dark",light:"Light",wechat:"WeChat"},path:"".concat(h.CDN,"/dist/css/content-theme")},h}()},931:(m,u,v)=>{v.d(u,{Y:()=>g});var S=v(913),E=v(161),h=v(59),f=v(933),g=function(b,k,w){b===void 0&&(b=document),k===void 0&&(k=S.Y.CDN);var _=h.SMILESRenderAdapter.getElements(b);_.length>0&&(0,E.Z)("".concat(k,"/dist/js/smiles-drawer/smiles-drawer.min.js?v=2.1.7"),"vditorAbcjsScript").then(function(){var C=new SmiDrawer({},{});_.forEach(function(T){var M=h.SMILESRenderAdapter.getCode(T).trim();if(!(T.getAttribute("data-processed")==="true"||M.trim()==="")){var y="smiles"+(0,f.Ee)();T.innerHTML='<svg id="'.concat(y,'"></svg>'),C.draw(M,"#"+y,w==="dark"?"dark":void 0),T.setAttribute("data-processed","true")}})})}},288:(m,u,v)=>{v.d(u,{$:()=>f});var S=v(913),E=v(161),h=v(59),f=function(g,b){g===void 0&&(g=document),b===void 0&&(b=S.Y.CDN);var k=h.abcRenderAdapter.getElements(g);k.length>0&&(0,E.Z)("".concat(b,"/dist/js/abcjs/abcjs_basic.min.js"),"vditorAbcjsScript").then(function(){k.forEach(function(w){w.parentElement.classList.contains("vditor-wysiwyg__pre")||w.parentElement.classList.contains("vditor-ir__marker--pre")||w.getAttribute("data-processed")!=="true"&&(ABCJS.renderAbc(w,h.abcRenderAdapter.getCode(w).trim()),w.style.overflowX="auto",w.setAttribute("data-processed","true"))})})}},59:(m,u,v)=>{v.r(u),v.d(u,{SMILESRenderAdapter:()=>E,abcRenderAdapter:()=>k,chartRenderAdapter:()=>b,flowchartRenderAdapter:()=>_,graphvizRenderAdapter:()=>w,markmapRenderAdapter:()=>f,mathRenderAdapter:()=>S,mermaidRenderAdapter:()=>h,mindmapRenderAdapter:()=>g,plantumlRenderAdapter:()=>C});var S={getCode:function(T){return T.textContent},getElements:function(T){return T.querySelectorAll(".language-math")}},E={getCode:function(T){return T.textContent},getElements:function(T){return T.querySelectorAll(".language-smiles")}},h={getCode:function(T){return T.textContent},getElements:function(T){return T.querySelectorAll(".language-mermaid")}},f={getCode:function(T){return T.textContent},getElements:function(T){return T.querySelectorAll(".language-markmap")}},g={getCode:function(T){return T.getAttribute("data-code")},getElements:function(T){return T.querySelectorAll(".language-mindmap")}},b={getCode:function(T){return T.innerText},getElements:function(T){return T.querySelectorAll(".language-echarts")}},k={getCode:function(T){return T.textContent},getElements:function(T){return T.querySelectorAll(".language-abc")}},w={getCode:function(T){return T.textContent},getElements:function(T){return T.querySelectorAll(".language-graphviz")}},_={getCode:function(T){return T.textContent},getElements:function(T){return T.querySelectorAll(".language-flowchart")}},C={getCode:function(T){return T.textContent},getElements:function(T){return T.querySelectorAll(".language-plantuml")}}},784:(m,u,v)=>{v.d(u,{v:()=>k});var S=v(913),E=v(161),h=v(59),f=v(933),g=function(w,_,C,T){function M(y){return y instanceof C?y:new C(function(O){O(y)})}return new(C||(C=Promise))(function(y,O){function B(j){try{I(T.next(j))}catch(z){O(z)}}function V(j){try{I(T.throw(j))}catch(z){O(z)}}function I(j){j.done?y(j.value):M(j.value).then(B,V)}I((T=T.apply(w,_||[])).next())})},b=function(w,_){var C={label:0,sent:function(){if(y[0]&1)throw y[1];return y[1]},trys:[],ops:[]},T,M,y,O;return O={next:B(0),throw:B(1),return:B(2)},typeof Symbol=="function"&&(O[Symbol.iterator]=function(){return this}),O;function B(I){return function(j){return V([I,j])}}function V(I){if(T)throw new TypeError("Generator is already executing.");for(;O&&(O=0,I[0]&&(C=0)),C;)try{if(T=1,M&&(y=I[0]&2?M.return:I[0]?M.throw||((y=M.return)&&y.call(M),0):M.next)&&!(y=y.call(M,I[1])).done)return y;switch(M=0,y&&(I=[I[0]&2,y.value]),I[0]){case 0:case 1:y=I;break;case 4:return C.label++,{value:I[1],done:!1};case 5:C.label++,M=I[1],I=[0];continue;case 7:I=C.ops.pop(),C.trys.pop();continue;default:if(y=C.trys,!(y=y.length>0&&y[y.length-1])&&(I[0]===6||I[0]===2)){C=0;continue}if(I[0]===3&&(!y||I[1]>y[0]&&I[1]<y[3])){C.label=I[1];break}if(I[0]===6&&C.label<y[1]){C.label=y[1],y=I;break}if(y&&C.label<y[2]){C.label=y[2],C.ops.push(I);break}y[2]&&C.ops.pop(),C.trys.pop();continue}I=_.call(w,C)}catch(j){I=[6,j],M=0}finally{T=y=0}if(I[0]&5)throw I[1];return{value:I[0]?I[1]:void 0,done:!0}}},k=function(w,_,C){w===void 0&&(w=document),_===void 0&&(_=S.Y.CDN);var T=h.chartRenderAdapter.getElements(w);T.length>0&&(0,E.Z)("".concat(_,"/dist/js/echarts/echarts.min.js?v=5.5.1"),"vditorEchartsScript").then(function(){T.forEach(function(M){return g(void 0,void 0,void 0,function(){var y,O,B;return b(this,function(V){switch(V.label){case 0:if(M.parentElement.classList.contains("vditor-wysiwyg__pre")||M.parentElement.classList.contains("vditor-ir__marker--pre"))return[2];if(y=h.chartRenderAdapter.getCode(M).trim(),!y)return[2];V.label=1;case 1:return V.trys.push([1,3,,4]),M.getAttribute("data-processed")==="true"?[2]:[4,(0,f.kY)(y)];case 2:return O=V.sent(),echarts.init(M,C==="dark"?"dark":void 0).setOption(O),M.setAttribute("data-processed","true"),[3,4];case 3:return B=V.sent(),M.className="vditor-reset--error",M.innerHTML="echarts render error: <br>".concat(B),[3,4];case 4:return[2]}})})})})}},51:(m,u,v)=>{v.d(u,{o:()=>h});var S=v(695),E=v(913),h=function(f,g){Array.from(f.querySelectorAll("pre > code")).filter(function(b,k){return!(b.parentElement.classList.contains("vditor-wysiwyg__pre")||b.parentElement.classList.contains("vditor-ir__marker--pre")||b.classList.contains("language-mermaid")||b.classList.contains("language-flowchart")||b.classList.contains("language-echarts")||b.classList.contains("language-mindmap")||b.classList.contains("language-plantuml")||b.classList.contains("language-markmap")||b.classList.contains("language-abc")||b.classList.contains("language-graphviz")||b.classList.contains("language-math")||b.classList.contains("language-smiles")||b.style.maxHeight.indexOf("px")>-1||f.classList.contains("vditor-preview")&&k>5)}).forEach(function(b){var k,w,_,C=b.innerText;if(b.classList.contains("highlight-chroma")){var T=b.cloneNode(!0);T.querySelectorAll(".highlight-ln").forEach(function(B){B.remove()}),C=T.innerText}else C.endsWith(`
`)&&(C=C.substr(0,C.length-1));var M='<svg><use xlink:href="#vditor-icon-copy"></use></svg>';document.getElementById("vditorIconScript")||(M='<svg viewBox="0 0 32 32"><path d="M22.545-0h-17.455c-1.6 0-2.909 1.309-2.909 2.909v20.364h2.909v-20.364h17.455v-2.909zM26.909 5.818h-16c-1.6 0-2.909 1.309-2.909 2.909v20.364c0 1.6 1.309 2.909 2.909 2.909h16c1.6 0 2.909-1.309 2.909-2.909v-20.364c0-1.6-1.309-2.909-2.909-2.909zM26.909 29.091h-16v-20.364h16v20.364z"></path></svg>');var y=document.createElement("div");y.className="vditor-copy",y.innerHTML='<span aria-label="'.concat(((k=window.VditorI18n)===null||k===void 0?void 0:k.copy)||"复制",`"
onmouseover="this.setAttribute('aria-label', '`).concat(((w=window.VditorI18n)===null||w===void 0?void 0:w.copy)||"复制",`')"
class="vditor-tooltipped vditor-tooltipped__w"
onclick="this.previousElementSibling.select();document.execCommand('copy');this.setAttribute('aria-label', '`).concat(((_=window.VditorI18n)===null||_===void 0?void 0:_.copied)||"已复制",`');this.previousElementSibling.blur()">`).concat(M,"</span>");var O=document.createElement("textarea");O.value=(0,S.p)(C),y.insertAdjacentElement("afterbegin",O),g&&g.renderMenu&&g.renderMenu(b,y),b.before(y),b.style.maxHeight=window.outerHeight-40+"px",b.insertAdjacentHTML("afterend",'<span style="position: absolute">'.concat(E.Y.ZWSP,"</span>"))})}},500:(m,u,v)=>{v.d(u,{D:()=>f});var S=v(913),E=v(161),h=v(59),f=function(g,b){b===void 0&&(b=S.Y.CDN);var k=h.flowchartRenderAdapter.getElements(g);k.length!==0&&(0,E.Z)("".concat(b,"/dist/js/flowchart.js/flowchart.min.js"),"vditorFlowchartScript").then(function(){k.forEach(function(w){if(w.getAttribute("data-processed")!=="true"){var _=flowchart.parse(h.flowchartRenderAdapter.getCode(w));w.innerHTML="",_.drawSVG(w),w.setAttribute("data-processed","true")}})})}},339:(m,u,v)=>{v.d(u,{m:()=>f});var S=v(913),E=v(161),h=v(59),f=function(g,b){b===void 0&&(b=S.Y.CDN);var k=h.graphvizRenderAdapter.getElements(g);k.length!==0&&(0,E.Z)("".concat(b,"/dist/js/graphviz/viz.js"),"vditorGraphVizScript").then(function(){k.forEach(function(w){var _=h.graphvizRenderAdapter.getCode(w);if(!(w.parentElement.classList.contains("vditor-wysiwyg__pre")||w.parentElement.classList.contains("vditor-ir__marker--pre"))&&!(w.getAttribute("data-processed")==="true"||_.trim()==="")){try{var C=new Blob(["importScripts('".concat(document.getElementById("vditorGraphVizScript").src.replace("viz.js","full.render.js"),"');")],{type:"application/javascript"}),T=window.URL||window.webkitURL,M=T.createObjectURL(C),y=new Worker(M);new Viz({worker:y}).renderSVGElement(_).then(function(O){w.innerHTML=O.outerHTML}).catch(function(O){w.innerHTML="graphviz render error: <br>".concat(O),w.className="vditor-reset--error"})}catch(O){console.error("graphviz error",O)}w.setAttribute("data-processed","true")}})})}},108:(m,u,v)=>{v.d(u,{$:()=>f});var S=v(913),E=v(161),h=v(505),f=function(g,b,k){b===void 0&&(b=document),k===void 0&&(k=S.Y.CDN);var w=g.style;S.Y.CODE_THEME.includes(w)||(w="github");var _=document.getElementById("vditorHljsStyle"),C="".concat(k,"/dist/js/highlight.js/styles/").concat(w,".min.css");if(_&&_.getAttribute("href")!==C&&_.remove(),(0,h.T)("".concat(k,"/dist/js/highlight.js/styles/").concat(w,".min.css"),"vditorHljsStyle"),g.enable!==!1){var T=b.querySelectorAll("pre > code");T.length!==0&&(0,E.Z)("".concat(k,"/dist/js/highlight.js/highlight.min.js?v=11.7.0"),"vditorHljsScript").then(function(){(0,E.Z)("".concat(k,"/dist/js/highlight.js/third-languages.js?v=1.0.1"),"vditorHljsThirdScript").then(function(){b.querySelectorAll("pre > code").forEach(function(M){if(!(M.parentElement.classList.contains("vditor-ir__marker--pre")||M.parentElement.classList.contains("vditor-wysiwyg__pre"))&&!(M.classList.contains("language-mermaid")||M.classList.contains("language-flowchart")||M.classList.contains("language-echarts")||M.classList.contains("language-mindmap")||M.classList.contains("language-plantuml")||M.classList.contains("language-smiles")||M.classList.contains("language-abc")||M.classList.contains("language-graphviz")||M.classList.contains("language-math"))){g.defaultLang!==""&&M.className.indexOf("language-")===-1&&M.classList.add("language-"+g.defaultLang);var y=M.className.replace("language-","");if(window.hljs.getLanguage(y)||(y="plaintext"),M.innerHTML=window.hljs.highlight(M.textContent,{language:y,ignoreIllegals:!0}).value,M.classList.add("hljs"),!!g.lineNumber){M.classList.add("vditor-linenumber");var O=M.querySelector(".vditor-linenumber__temp");O||(O=document.createElement("div"),O.className="vditor-linenumber__temp",M.insertAdjacentElement("beforeend",O));var B=getComputedStyle(M).whiteSpace,V=!1;(B==="pre-wrap"||B==="pre-line")&&(V=!0);var I="",j=M.textContent.split(/\r\n|\r|\n/g);j.pop(),j.map(function(z){var F="";V&&(O.textContent=z||`
`,F=' style="height:'.concat(O.getBoundingClientRect().height,'px"')),I+="<span".concat(F,"></span>")}),O.style.display="none",I='<span class="vditor-linenumber__rows">'.concat(I,"</span>"),M.insertAdjacentHTML("beforeend",I)}}})})})}}},597:(m,u,v)=>{v.d(u,{K:()=>k});var S=v(913),E=v(161),h=v(59),f={},g=function(w,_){var C=w.transform(_),T=Object.keys(C.features).filter(function(V){return!f[V]});T.forEach(function(V){f[V]=!0});var M=w.getAssets(T),y=M.styles,O=M.scripts,B=window.markmap;return y&&B.loadCSS(y),O&&B.loadJS(O),C},b=function(w,_){var C=window.markmap,T=C.Transformer,M=C.Markmap,y=C.deriveOptions;C.globalCSS;var O=new T;w.innerHTML='<svg style="width:100%"></svg>';var B=w.firstChild,V=M.create(B,null),I=g(O,_),j=I.root,z=I.frontmatter,F=z==null?void 0:z.markmap,le=y(F);V.setData(j,le),V.fit()},k=function(w,_){w===void 0&&(w=document),_===void 0&&(_=S.Y.CDN);var C=h.markmapRenderAdapter.getElements(w);C.length!==0&&(0,E.Z)("".concat(_,"/dist/js/markmap/markmap.min.js"),"vditorMarkerScript").then(function(){C.forEach(function(T){var M=h.markmapRenderAdapter.getCode(T);if(!(T.getAttribute("data-processed")==="true"||M.trim()==="")){var y=document.createElement("div");y.className="language-markmap",T.parentNode.appendChild(y),b(y,M),T.parentNode.childNodes[0].nodeName=="CODE"&&T.parentNode.removeChild(T.parentNode.childNodes[0])}})})}},960:(m,u,v)=>{v.d(u,{T:()=>b});var S=v(913),E=v(161),h=v(505),f=v(695),g=v(59),b=function(k,w){k===void 0&&(k=document);var _=g.mathRenderAdapter.getElements(k);if(_.length!==0){var C={cdn:S.Y.CDN,math:{engine:"KaTeX",inlineDigit:!1,macros:{}}};if(w&&w.math&&(w.math=Object.assign({},C.math,w.math)),w=Object.assign({},C,w),w.math.engine==="KaTeX")(0,h.T)("".concat(w.cdn,"/dist/js/katex/katex.min.css?v=0.16.9"),"vditorKatexStyle"),(0,E.Z)("".concat(w.cdn,"/dist/js/katex/katex.min.js?v=0.16.9"),"vditorKatexScript").then(function(){(0,E.Z)("".concat(w.cdn,"/dist/js/katex/mhchem.min.js?v=0.16.9"),"vditorKatexChemScript").then(function(){_.forEach(function(y){if(!(y.parentElement.classList.contains("vditor-wysiwyg__pre")||y.parentElement.classList.contains("vditor-ir__marker--pre"))&&!y.getAttribute("data-math")){var O=(0,f.p)(g.mathRenderAdapter.getCode(y));y.setAttribute("data-math",O);try{y.innerHTML=katex.renderToString(O,{displayMode:y.tagName==="DIV",output:"html",macros:w.math.macros})}catch(B){y.innerHTML=B.message,y.className="language-math vditor-reset--error"}y.addEventListener("copy",function(B){B.stopPropagation(),B.preventDefault();var V=B.currentTarget.closest(".language-math");B.clipboardData.setData("text/html",V.innerHTML),B.clipboardData.setData("text/plain",V.getAttribute("data-math"))})}})})});else if(w.math.engine==="MathJax"){var T=function(y){if(y.length!==0){var O=0,B=y[y.length-1],V=function(){var I=y[O++];I===B?I():I(V)};V()}};window.MathJax||(window.MathJax={loader:{paths:{mathjax:"".concat(w.cdn,"/dist/js/mathjax")}},startup:{typeset:!1},tex:{macros:w.math.macros}},Object.assign(window.MathJax,w.math.mathJaxOptions)),(0,E.U)("".concat(w.cdn,"/dist/js/mathjax/tex-svg-full.js"),"protyleMathJaxScript");var M=function(y,O){var B=(0,f.p)(y.textContent).trim(),V=window.MathJax.getMetricsFor(y);V.display=y.tagName==="DIV",window.MathJax.tex2svgPromise(B,V).then(function(I){y.innerHTML="",y.setAttribute("data-math",B),y.append(I),window.MathJax.startup.document.clear(),window.MathJax.startup.document.updateDocument();var j=I.querySelector('[data-mml-node="merror"]');j&&j.textContent.trim()!==""&&(y.innerHTML=j.textContent.trim(),y.className="vditor-reset--error"),O&&O()})};window.MathJax.startup.promise.then(function(){for(var y=[],O=function(V){var I=_[V];!I.parentElement.classList.contains("vditor-wysiwyg__pre")&&!I.parentElement.classList.contains("vditor-ir__marker--pre")&&!I.getAttribute("data-math")&&(0,f.p)(I.textContent).trim()&&y.push(function(j){V===_.length-1?M(I):M(I,j)})},B=0;B<_.length;B++)O(B);T(y)})}}}},0:(m,u,v)=>{v.d(u,{l:()=>g});var S=v(933),E=function(b,k){b.insertAdjacentHTML("afterend",'<video controls="controls" src="'.concat(k,'"></video>')),b.remove()},h=function(b,k){b.insertAdjacentHTML("afterend",'<audio controls="controls" src="'.concat(k,'"></audio>')),b.remove()},f=function(b,k){var w=k.match(/\/\/(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))([\w|-]{11})(?:(?:[\?&]t=)(\S+))?/),_=k.match(/\/\/v\.youku\.com\/v_show\/id_(\w+)=*\.html/),C=k.match(/\/\/v\.qq\.com\/x\/cover\/.*\/([^\/]+)\.html\??.*/),T=k.match(/(?:www\.|\/\/)coub\.com\/view\/(\w+)/),M=k.match(/(?:www\.|\/\/)facebook\.com\/([^\/]+)\/videos\/([0-9]+)/),y=k.match(/.+dailymotion.com\/(video|hub)\/(\w+)\?/),O=k.match(/(?:www\.|\/\/)bilibili\.com\/video\/(\w+)/),B=k.match(/(?:www\.|\/\/)ted\.com\/talks\/(\w+)/);if(w&&w[1].length===11)b.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//www.youtube.com/embed/'.concat(w[1]+(w[2]?"?start="+w[2]:""),'"></iframe>')),b.remove();else if(_&&_[1])b.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//player.youku.com/embed/'.concat(_[1],'"></iframe>')),b.remove();else if(C&&C[1])b.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="https://v.qq.com/txp/iframe/player.html?vid='.concat(C[1],'"></iframe>')),b.remove();else if(T&&T[1])b.insertAdjacentHTML("afterend",`<iframe class="iframe__video"
 src="//coub.com/embed/`.concat(T[1],'?muted=false&autostart=false&originalSize=true&startWithHD=true"></iframe>')),b.remove();else if(M&&M[0])b.insertAdjacentHTML("afterend",`<iframe class="iframe__video"
 src="https://www.facebook.com/plugins/video.php?href=`.concat(encodeURIComponent(M[0]),'"></iframe>')),b.remove();else if(y&&y[2])b.insertAdjacentHTML("afterend",`<iframe class="iframe__video"
 src="https://www.dailymotion.com/embed/video/`.concat(y[2],'"></iframe>')),b.remove();else if(k.indexOf("bilibili.com")>-1&&(k.indexOf("bvid=")>-1||O&&O[1])){var V={bvid:(0,S.TK)("bvid",k)||O&&O[1],page:"1",high_quality:"1",as_wide:"1",allowfullscreen:"true",autoplay:"0"};new URL(k.startsWith("http")?k:"https:"+k).search.split("&").forEach(function(z,F){if(z){F===0&&(z=z.substr(1));var le=z.split("=");V[le[0]]=le[1]}});var I="https://player.bilibili.com/player.html?",j=Object.keys(V);j.forEach(function(z,F){I+="".concat(z,"=").concat(V[z]),F<j.length-1&&(I+="&")}),b.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="'.concat(I,'"></iframe>')),b.remove()}else B&&B[1]&&(b.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//embed.ted.com/talks/'.concat(B[1],'"></iframe>')),b.remove())},g=function(b){b&&b.querySelectorAll("a").forEach(function(k){var w=k.getAttribute("href");w&&(w.match(/^.+.(mp4|m4v|ogg|ogv|webm)$/)?E(k,w):w.match(/^.+.(mp3|wav|flac)$/)?h(k,w):f(k,w))})}},975:(m,u,v)=>{v.d(u,{e:()=>k});var S=v(913),E=v(161),h=v(59),f=v(933),g=function(w,_,C,T){function M(y){return y instanceof C?y:new C(function(O){O(y)})}return new(C||(C=Promise))(function(y,O){function B(j){try{I(T.next(j))}catch(z){O(z)}}function V(j){try{I(T.throw(j))}catch(z){O(z)}}function I(j){j.done?y(j.value):M(j.value).then(B,V)}I((T=T.apply(w,_||[])).next())})},b=function(w,_){var C={label:0,sent:function(){if(y[0]&1)throw y[1];return y[1]},trys:[],ops:[]},T,M,y,O;return O={next:B(0),throw:B(1),return:B(2)},typeof Symbol=="function"&&(O[Symbol.iterator]=function(){return this}),O;function B(I){return function(j){return V([I,j])}}function V(I){if(T)throw new TypeError("Generator is already executing.");for(;O&&(O=0,I[0]&&(C=0)),C;)try{if(T=1,M&&(y=I[0]&2?M.return:I[0]?M.throw||((y=M.return)&&y.call(M),0):M.next)&&!(y=y.call(M,I[1])).done)return y;switch(M=0,y&&(I=[I[0]&2,y.value]),I[0]){case 0:case 1:y=I;break;case 4:return C.label++,{value:I[1],done:!1};case 5:C.label++,M=I[1],I=[0];continue;case 7:I=C.ops.pop(),C.trys.pop();continue;default:if(y=C.trys,!(y=y.length>0&&y[y.length-1])&&(I[0]===6||I[0]===2)){C=0;continue}if(I[0]===3&&(!y||I[1]>y[0]&&I[1]<y[3])){C.label=I[1];break}if(I[0]===6&&C.label<y[1]){C.label=y[1],y=I;break}if(y&&C.label<y[2]){C.label=y[2],C.ops.push(I);break}y[2]&&C.ops.pop(),C.trys.pop();continue}I=_.call(w,C)}catch(j){I=[6,j],M=0}finally{T=y=0}if(I[0]&5)throw I[1];return{value:I[0]?I[1]:void 0,done:!0}}},k=function(w,_,C){w===void 0&&(w=document),_===void 0&&(_=S.Y.CDN);var T=h.mermaidRenderAdapter.getElements(w);T.length!==0&&(0,E.Z)("".concat(_,"/dist/js/mermaid/mermaid.min.js"),"vditorMermaidScript").then(function(){var M={securityLevel:"loose",altFontFamily:"sans-serif",fontFamily:"sans-serif",startOnLoad:!1,flowchart:{htmlLabels:!0,useMaxWidth:!0},sequence:{useMaxWidth:!0,diagramMarginX:8,diagramMarginY:8,boxMargin:8,showSequenceNumbers:!0},gantt:{leftPadding:75,rightPadding:20}};C==="dark"&&(M.theme="dark"),mermaid.initialize(M),T.forEach(function(y){return g(void 0,void 0,void 0,function(){var O,B,V,I,j;return b(this,function(z){switch(z.label){case 0:if(O=h.mermaidRenderAdapter.getCode(y),y.getAttribute("data-processed")==="true"||O.trim()==="")return[2];B="mermaid"+(0,f.Ee)(),z.label=1;case 1:return z.trys.push([1,3,,4]),[4,mermaid.render(B,y.textContent)];case 2:return V=z.sent(),y.innerHTML=V.svg,[3,4];case 3:return I=z.sent(),j=document.querySelector("#"+B),y.innerHTML="".concat(j.outerHTML,`<br>
<div style="text-align: left"><small>`).concat(I.message.replace(/\n/,"<br>"),"</small></div>"),j.parentElement.remove(),[3,4];case 4:return y.setAttribute("data-processed","true"),[2]}})})})})}},162:(m,u,v)=>{v.d(u,{l:()=>f});var S=v(913),E=v(161),h=v(59),f=function(g,b,k){g===void 0&&(g=document),b===void 0&&(b=S.Y.CDN);var w=h.mindmapRenderAdapter.getElements(g);w.length>0&&(0,E.Z)("".concat(b,"/dist/js/echarts/echarts.min.js?v=5.5.1"),"vditorEchartsScript").then(function(){w.forEach(function(_){if(!(_.parentElement.classList.contains("vditor-wysiwyg__pre")||_.parentElement.classList.contains("vditor-ir__marker--pre"))){var C=h.mindmapRenderAdapter.getCode(_);if(C)try{if(_.getAttribute("data-processed")==="true")return;echarts.init(_,k==="dark"?"dark":void 0).setOption({series:[{data:[JSON.parse(decodeURIComponent(C))],initialTreeDepth:-1,itemStyle:{borderWidth:0,color:"#4285f4"},label:{backgroundColor:"#f6f8fa",borderColor:"#d1d5da",borderRadius:5,borderWidth:.5,color:"#586069",lineHeight:20,offset:[-5,0],padding:[0,5],position:"insideRight"},lineStyle:{color:"#d1d5da",width:1},roam:!0,symbol:function(T,M){var y;return!((y=M==null?void 0:M.data)===null||y===void 0)&&y.children?"circle":"path://"},type:"tree"}],tooltip:{trigger:"item",triggerOn:"mousemove"}}),_.setAttribute("data-processed","true")}catch(T){_.className="vditor-reset--error",_.innerHTML="mindmap render error: <br>".concat(T)}}})})}},70:(m,u,v)=>{v.d(u,{N:()=>h});var S=v(164),E=v(960),h=function(f,g,b){var k="",w=[];if(Array.from(f.children).forEach(function(M,y){if((0,S.c)(M)){if(b){var O=M.id.lastIndexOf("_");M.id=M.id.substring(0,O===-1?void 0:O)+"_"+y}w.push(M.id),k+=M.outerHTML.replace("<wbr>","")}}),k==="")return g.innerHTML="","";var _=document.createElement("div");if(b)b.lute.SetToC(!0),b.currentMode==="wysiwyg"&&!b.preview.element.contains(f)?_.innerHTML=b.lute.SpinVditorDOM("<p>[ToC]</p>"+k):b.currentMode==="ir"&&!b.preview.element.contains(f)?_.innerHTML=b.lute.SpinVditorIRDOM("<p>[ToC]</p>"+k):_.innerHTML=b.lute.HTML2VditorDOM("<p>[ToC]</p>"+k),b.lute.SetToC(b.options.preview.markdown.toc);else{g.classList.add("vditor-outline");var C=Lute.New();C.SetToC(!0),_.innerHTML=C.HTML2VditorDOM("<p>[ToC]</p>"+k)}var T=_.firstElementChild.querySelectorAll("li > span[data-target-id]");return T.forEach(function(M,y){if(M.nextElementSibling&&M.nextElementSibling.tagName==="UL"){var O="<svg class='vditor-outline__action'><use xlink:href='#vditor-icon-down'></use></svg>";document.getElementById("vditorIconScript")||(O='<svg class="vditor-outline__action" viewBox="0 0 32 32"><path d="M3.76 6.12l12.24 12.213 12.24-12.213 3.76 3.76-16 16-16-16 3.76-3.76z"></path></svg>'),M.innerHTML="".concat(O,"<span>").concat(M.innerHTML,"</span>")}else M.innerHTML="<svg></svg><span>".concat(M.innerHTML,"</span>");M.setAttribute("data-target-id",w[y])}),k=_.firstElementChild.innerHTML,T.length===0?(g.innerHTML="",k):(g.innerHTML=k,b&&(0,E.T)(g,{cdn:b.options.cdn,math:b.options.preview.math}),g.firstElementChild.addEventListener("click",function(M){for(var y=M.target;y&&!y.isEqualNode(g);){if(y.classList.contains("vditor-outline__action")){y.classList.contains("vditor-outline__action--close")?(y.classList.remove("vditor-outline__action--close"),y.parentElement.nextElementSibling.setAttribute("style","display:block")):(y.classList.add("vditor-outline__action--close"),y.parentElement.nextElementSibling.setAttribute("style","display:none")),M.preventDefault(),M.stopPropagation();break}else if(y.getAttribute("data-target-id")){M.preventDefault(),M.stopPropagation();var O=document.getElementById(y.getAttribute("data-target-id"));if(!O)return;if(b)if(b.options.height==="auto"){var B=O.offsetTop+b.element.offsetTop;b.options.toolbarConfig.pin||(B+=b.toolbar.element.offsetHeight),window.scrollTo(window.scrollX,B)}else b.element.offsetTop<window.scrollY&&window.scrollTo(window.scrollX,b.element.offsetTop),b.preview.element.contains(f)?f.parentElement.scrollTop=O.offsetTop:f.scrollTop=O.offsetTop;else window.scrollTo(window.scrollX,O.offsetTop);break}y=y.parentElement}}),k)}},591:(m,u,v)=>{v.d(u,{M:()=>f});var S=v(913),E=v(161),h=v(59),f=function(g,b){g===void 0&&(g=document),b===void 0&&(b=S.Y.CDN);var k=h.plantumlRenderAdapter.getElements(g);k.length!==0&&(0,E.Z)("".concat(b,"/dist/js/plantuml/plantuml-encoder.min.js"),"vditorPlantumlScript").then(function(){k.forEach(function(w){if(!(w.parentElement.classList.contains("vditor-wysiwyg__pre")||w.parentElement.classList.contains("vditor-ir__marker--pre"))){var _=h.plantumlRenderAdapter.getCode(w).trim();if(_)try{w.innerHTML='<object type="image/svg+xml" data="https://www.plantuml.com/plantuml/svg/~1'.concat(plantumlEncoder.encode(_),'"/>')}catch(C){w.className="vditor-reset--error",w.innerHTML="plantuml render error: <br>".concat(C)}}})})}},796:(m,u,v)=>{v.d(u,{X:()=>S});var S=function(E){var h=Lute.New();return h.PutEmojis(E.emojis),h.SetEmojiSite(E.emojiSite),h.SetHeadingAnchor(E.headingAnchor),h.SetInlineMathAllowDigitAfterOpenMarker(E.inlineMathDigit),h.SetAutoSpace(E.autoSpace),h.SetToC(E.toc),h.SetFootnotes(E.footnotes),h.SetFixTermTypo(E.fixTermTypo),h.SetVditorCodeBlockPreview(E.codeBlockPreview),h.SetVditorMathBlockPreview(E.mathBlockPreview),h.SetSanitize(E.sanitize),h.SetChineseParagraphBeginningSpace(E.paragraphBeginningSpace),h.SetRenderListStyle(E.listStyle),h.SetLinkBase(E.linkBase),h.SetLinkPrefix(E.linkPrefix),h.SetMark(E.mark),h.SetGFMAutoLink(E.gfmAutoLink),E.lazyLoadImage&&h.SetImageLazyLoading(E.lazyLoadImage),h}},726:(m,u,v)=>{v.d(u,{o:()=>S});var S=function(E,h,f){f===void 0&&(f="classic");var g=E.getBoundingClientRect(),b=36;document.body.insertAdjacentHTML("beforeend",'<div class="vditor vditor-img'.concat(f==="dark"?" vditor--dark":"",`">
    <div class="vditor-img__bar">
      <span class="vditor-img__btn" data-deg="0">
        <svg><use xlink:href="#vditor-icon-redo"></use></svg>
        `).concat(window.VditorI18n.spin,`
      </span>
      <span class="vditor-img__btn"  onclick="this.parentElement.parentElement.outerHTML = '';document.body.style.overflow = ''">
        X &nbsp;`).concat(window.VditorI18n.close,`
      </span>
    </div>
    <div class="vditor-img__img" onclick="this.parentElement.outerHTML = '';document.body.style.overflow = ''">
      <img style="width: `).concat(E.width,"px;height:").concat(E.height,"px;transform: translate3d(").concat(g.left,"px, ").concat(g.top-b,'px, 0)" src="').concat(E.getAttribute("src"),`">
    </div>
</div>`)),document.body.style.overflow="hidden";var k=document.querySelector(".vditor-img img"),w="translate3d(".concat(Math.max(0,window.innerWidth-E.naturalWidth)/2,"px, ").concat(Math.max(0,window.innerHeight-b-E.naturalHeight)/2,"px, 0)");setTimeout(function(){k.setAttribute("style","transition: transform .3s ease-in-out;transform: ".concat(w)),setTimeout(function(){k.parentElement.scrollTo((k.parentElement.scrollWidth-k.parentElement.clientWidth)/2,(k.parentElement.scrollHeight-k.parentElement.clientHeight)/2)},400)});var _=document.querySelector(".vditor-img__btn");_.addEventListener("click",function(){var C=parseInt(_.getAttribute("data-deg"),10)+90;C/90%2===1&&E.naturalWidth>k.parentElement.clientHeight?k.style.transform="translate3d(".concat(Math.max(0,window.innerWidth-E.naturalWidth)/2,"px, ").concat(E.naturalWidth/2-E.naturalHeight/2,"px, 0) rotateZ(").concat(C,"deg)"):k.style.transform="".concat(w," rotateZ(").concat(C,"deg)"),_.setAttribute("data-deg",C.toString()),setTimeout(function(){k.parentElement.scrollTo((k.parentElement.scrollWidth-k.parentElement.clientWidth)/2,(k.parentElement.scrollHeight-k.parentElement.clientHeight)/2)},400)})}},13:(m,u,v)=>{v.d(u,{h:()=>h});var S=v(913),E=v(505),h=function(f,g){g===void 0&&(g=S.Y.CDN),S.Y.CODE_THEME.includes(f)||(f="github");var b=document.getElementById("vditorHljsStyle"),k="".concat(g,"/dist/js/highlight.js/styles/").concat(f,".min.css");b?b.getAttribute("href")!==k&&(b.remove(),(0,E.T)(k,"vditorHljsStyle")):(0,E.T)(k,"vditorHljsStyle")}},873:(m,u,v)=>{v.d(u,{H:()=>E});var S=v(505),E=function(h,f){if(!(!h||!f)){var g=document.getElementById("vditorContentTheme"),b="".concat(f,"/").concat(h,".css");g?g.getAttribute("href")!==b&&(g.remove(),(0,S.T)(b,"vditorContentTheme")):(0,S.T)(b,"vditorContentTheme")}}},161:(m,u,v)=>{v.d(u,{U:()=>S,Z:()=>E});var S=function(h,f){if(document.getElementById(f))return!1;var g=new XMLHttpRequest;g.open("GET",h,!1),g.setRequestHeader("Accept","text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01"),g.send("");var b=document.createElement("script");b.type="text/javascript",b.text=g.responseText,b.id=f,document.head.appendChild(b)},E=function(h,f){return new Promise(function(g,b){if(document.getElementById(f))return g(!0),!1;var k=document.createElement("script");k.src=h,k.async=!0,document.head.appendChild(k),k.onerror=function(w){b(w)},k.onload=function(){if(document.getElementById(f))return k.remove(),g(!0),!1;k.id=f,g(!0)}})}},505:(m,u,v)=>{v.d(u,{T:()=>S});var S=function(E,h){if(!document.getElementById(h)){var f=document.createElement("link");f.id=h,f.rel="stylesheet",f.type="text/css",f.href=E,document.getElementsByTagName("head")[0].appendChild(f)}}},695:(m,u,v)=>{v.d(u,{p:()=>S});var S=function(E){return E.replace(/\u00a0/g," ")}},629:(m,u,v)=>{v.d(u,{D:()=>h,H8:()=>k,_0:()=>g,fG:()=>b,gm:()=>E,nr:()=>S,y3:()=>f});var S=function(){return navigator.userAgent.indexOf("Safari")>-1&&navigator.userAgent.indexOf("Chrome")===-1},E=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},h=function(){try{return typeof localStorage<"u"}catch{return!1}},f=function(){return navigator.userAgent.indexOf("iPhone")>-1?"touchstart":"click"},g=function(w){return navigator.platform.toUpperCase().indexOf("MAC")>=0?!!(w.metaKey&&!w.ctrlKey):!!(!w.metaKey&&w.ctrlKey)},b=function(w){return/Mac/.test(navigator.platform)||navigator.platform==="iPhone"?w.indexOf("⇧")>-1&&E()&&(w=w.replace(";",":").replace("=","+").replace("-","_")):(w.startsWith("⌘")?w=w.replace("⌘","⌘+"):w.startsWith("⌥")&&w.substr(1,1)!=="⌘"?w=w.replace("⌥","⌥+"):w=w.replace("⇧⌘","⌘+⇧+").replace("⌥⌘","⌥+⌘+"),w=w.replace("⌘","Ctrl").replace("⇧","Shift").replace("⌥","Alt"),w.indexOf("Shift")>-1&&(w=w.replace(";",":").replace("=","+").replace("-","_"))),w},k=function(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}},933:(m,u,v)=>{v.d(u,{Ee:()=>S,TK:()=>E,kY:()=>h});var S=function(){return([1e7].toString()+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(f){return(parseInt(f,10)^window.crypto.getRandomValues(new Uint32Array(1))[0]&15>>parseInt(f,10)/4).toString(16)})},E=function(f,g){g===void 0&&(g=window.location.search);var b=g.substring(g.indexOf("?")),k=b.indexOf("#"),w=new URLSearchParams(b.substring(0,k>=0?k:void 0));return w.get(f)},h=function(f){return Function('"use strict";return ('.concat(f,")"))()}},598:(m,u,v)=>{v.d(u,{Ab:()=>h,KJ:()=>w,KR:()=>f,Rp:()=>_,Th:()=>g,XW:()=>E,_Y:()=>k,pt:()=>b});var S=v(164),E=function(C,T){for(var M=w(C,T),y=!1,O=!1;M&&!M.classList.contains("vditor-reset")&&!O;)y=w(M.parentElement,T),y?M=y:O=!0;return M||!1},h=function(C,T){for(var M=(0,S.f)(C,T),y=!1,O=!1;M&&!M.classList.contains("vditor-reset")&&!O;)y=(0,S.f)(M.parentElement,T),y?M=y:O=!0;return M||!1},f=function(C){var T=h(C,"UL"),M=h(C,"OL"),y=T;return M&&(!T||T&&M.contains(T))&&(y=M),y},g=function(C,T,M){if(!C)return!1;C.nodeType===3&&(C=C.parentElement);for(var y=C,O=!1;y&&!O&&!y.classList.contains("vditor-reset");)y.getAttribute(T)===M?O=!0:y=y.parentElement;return O&&y},b=function(C){if(!C)return!1;C.nodeType===3&&(C=C.parentElement);var T=C,M=!1,y=g(C,"data-block","0");if(y)return y;for(;T&&!M&&!T.classList.contains("vditor-reset");)T.tagName==="H1"||T.tagName==="H2"||T.tagName==="H3"||T.tagName==="H4"||T.tagName==="H5"||T.tagName==="H6"||T.tagName==="P"||T.tagName==="BLOCKQUOTE"||T.tagName==="OL"||T.tagName==="UL"?M=!0:T=T.parentElement;return M&&T},k=function(C,T){if(!C)return!1;C.nodeType===3&&(C=C.parentElement);for(var M=C,y=!1;M&&!y&&!M.classList.contains("vditor-reset");)M.nodeName===T?y=!0:M=M.parentElement;return y&&M},w=function(C,T){if(!C)return!1;C.nodeType===3&&(C=C.parentElement);for(var M=C,y=!1;M&&!y&&!M.classList.contains("vditor-reset");)M.classList.contains(T)?y=!0:M=M.parentElement;return y&&M},_=function(C){for(;C&&C.lastChild;)C=C.lastChild;return C}},164:(m,u,v)=>{v.d(u,{c:()=>E,f:()=>S});var S=function(h,f){if(!h)return!1;h.nodeType===3&&(h=h.parentElement);for(var g=h,b=!1;g&&!b&&!g.classList.contains("vditor-reset");)g.nodeName.indexOf(f)===0?b=!0:g=g.parentElement;return b&&g},E=function(h){var f=S(h,"H");return f&&f.tagName.length===2&&f.tagName!=="HR"?f:!1}},905:(m,u,v)=>{v.d(u,{h:()=>S});var S=function(){for(var E=[],h=0;h<arguments.length;h++)E[h]=arguments[h];for(var f={},g=function(k){for(var w in k)k.hasOwnProperty(w)&&(Object.prototype.toString.call(k[w])==="[object Object]"?f[w]=S(f[w],k[w]):f[w]=k[w])},b=0;b<E.length;b++)g(E[b]);return f}},827:(m,u,v)=>{v.d(u,{Co:()=>b,ED:()=>w,Ey:()=>g,Fm:()=>_,RN:()=>f,Z2:()=>T,ir:()=>C,jl:()=>k});var S=v(913),E=v(629),h=v(598),f=function(M){var y,O=M[M.currentMode].element;return getSelection().rangeCount>0&&(y=getSelection().getRangeAt(0),O.isEqualNode(y.startContainer)||O.contains(y.startContainer))?y:M[M.currentMode].range?M[M.currentMode].range:(O.focus(),y=O.ownerDocument.createRange(),y.setStart(O,0),y.collapse(!0),y)},g=function(M){var y=window.getSelection().getRangeAt(0);if(!M.contains(y.startContainer)&&!(0,h.KJ)(y.startContainer,"vditor-panel--none"))return{left:0,top:0};var O=M.parentElement.getBoundingClientRect(),B;if(y.getClientRects().length===0)if(y.startContainer.nodeType===3){var V=y.startContainer.parentElement;if(V&&V.getClientRects().length>0)B=V.getClientRects()[0];else return{left:0,top:0}}else{var I=y.startContainer.children;if(I[y.startOffset]&&I[y.startOffset].getClientRects().length>0)B=I[y.startOffset].getClientRects()[0];else if(y.startContainer.childNodes.length>0){var j=y.cloneRange();y.selectNode(y.startContainer.childNodes[Math.max(0,y.startOffset-1)]),B=y.getClientRects()[0],y.setEnd(j.endContainer,j.endOffset),y.setStart(j.startContainer,j.startOffset)}else B=y.startContainer.getClientRects()[0];if(!B){for(var z=y.startContainer.childNodes[y.startOffset];!z.getClientRects||z.getClientRects&&z.getClientRects().length===0;)z=z.parentElement;B=z.getClientRects()[0]}}else B=y.getClientRects()[0];return{left:B.left-O.left,top:B.top-O.top}},b=function(M,y){if(!y){if(getSelection().rangeCount===0)return!1;y=getSelection().getRangeAt(0)}var O=y.commonAncestorContainer;return M.isEqualNode(O)||M.contains(O)},k=function(M){var y=window.getSelection();y.removeAllRanges(),y.addRange(M)},w=function(M,y,O){var B={end:0,start:0};if(!O){if(getSelection().rangeCount===0)return B;O=window.getSelection().getRangeAt(0)}if(b(y,O)){var V=O.cloneRange();M.childNodes[0]&&M.childNodes[0].childNodes[0]?V.setStart(M.childNodes[0].childNodes[0],0):V.selectNodeContents(M),V.setEnd(O.startContainer,O.startOffset),B.start=V.toString().length,B.end=B.start+O.toString().length}return B},_=function(M,y,O){var B=0,V=0,I=O.childNodes[V],j=!1,z=!1;M=Math.max(0,M),y=Math.max(0,y);var F=O.ownerDocument.createRange();for(F.setStart(I||O,0),F.collapse(!0);!z&&I;){var le=B+I.textContent.length;if(!j&&M>=B&&M<=le&&(M===0?F.setStart(I,0):I.childNodes[0].nodeType===3?F.setStart(I.childNodes[0],M-B):I.nextSibling?F.setStartBefore(I.nextSibling):F.setStartAfter(I),j=!0,M===y)){z=!0;break}j&&y>=B&&y<=le&&(y===0?F.setEnd(I,0):I.childNodes[0].nodeType===3?F.setEnd(I.childNodes[0],y-B):I.nextSibling?F.setEndBefore(I.nextSibling):F.setEndAfter(I),z=!0),B=le,I=O.childNodes[++V]}return!z&&O.childNodes[V-1]&&F.setStartBefore(O.childNodes[V-1]),k(F),F},C=function(M,y){var O=M.querySelector("wbr");if(O){if(!O.previousElementSibling)O.previousSibling?y.setStart(O.previousSibling,O.previousSibling.textContent.length):O.nextSibling?O.nextSibling.nodeType===3?y.setStart(O.nextSibling,0):y.setStartBefore(O.nextSibling):y.setStart(O.parentElement,0);else if(O.previousElementSibling.isSameNode(O.previousSibling))if(O.previousElementSibling.lastChild){y.setStartBefore(O),y.collapse(!0),k(y),(0,E.H8)()&&(O.previousElementSibling.tagName==="EM"||O.previousElementSibling.tagName==="STRONG"||O.previousElementSibling.tagName==="S")&&(y.insertNode(document.createTextNode(S.Y.ZWSP)),y.collapse(!1)),O.remove();return}else y.setStartAfter(O.previousElementSibling);else y.setStart(O.previousSibling,O.previousSibling.textContent.length);y.collapse(!0),O.remove(),k(y)}},T=function(M,y){var O=document.createElement("div");O.innerHTML=M;var B=O.querySelectorAll("p");B.length===1&&!B[0].previousSibling&&!B[0].nextSibling&&y[y.currentMode].element.children.length>0&&O.firstElementChild.tagName==="P"&&(M=B[0].innerHTML.trim());var V=document.createElement("div");V.innerHTML=M;var I=f(y);if(I.toString()!==""&&(y[y.currentMode].preventInput=!0,document.execCommand("delete",!1,"")),V.firstElementChild&&V.firstElementChild.getAttribute("data-block")==="0"){V.lastElementChild.insertAdjacentHTML("beforeend","<wbr>");var j=(0,h.pt)(I.startContainer);j?j.insertAdjacentHTML("afterend",V.innerHTML):y[y.currentMode].element.insertAdjacentHTML("beforeend",V.innerHTML),C(y[y.currentMode].element,I)}else{var z=document.createElement("template");z.innerHTML=M,I.insertNode(z.content.cloneNode(!0)),I.collapse(!1),k(I)}}}},s={};function l(m){var u=s[m];if(u!==void 0)return u.exports;var v=s[m]={exports:{}};return r[m](v,v.exports,l),v.exports}l.d=(m,u)=>{for(var v in u)l.o(u,v)&&!l.o(m,v)&&Object.defineProperty(m,v,{enumerable:!0,get:u[v]})},l.o=(m,u)=>Object.prototype.hasOwnProperty.call(m,u),l.r=m=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(m,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(m,"__esModule",{value:!0})};var d={};return(()=>{l.d(d,{default:()=>oc});var m=l(923),u=l(913),v=l(695),S=function(t){return t.currentMode==="sv"?(0,v.p)("".concat(t.sv.element.textContent,`
`).replace(/\n\n$/,`
`)):t.currentMode==="wysiwyg"?t.lute.VditorDOM2Md(t.wysiwyg.element.innerHTML):t.currentMode==="ir"?t.lute.VditorIRDOM2Md(t.ir.element.innerHTML):""},E=l(161),h=function(){function t(){this.element=document.createElement("div"),this.element.className="vditor-devtools",this.element.innerHTML='<div class="vditor-reset--error"></div><div style="height: 100%;"></div>'}return t.prototype.renderEchart=function(n){var i=this;n.devtools.element.style.display==="block"&&(0,E.Z)("".concat(n.options.cdn,"/dist/js/echarts/echarts.min.js?v=5.5.1"),"vditorEchartsScript").then(function(){i.ASTChart||(i.ASTChart=echarts.init(n.devtools.element.lastElementChild));try{i.element.lastElementChild.style.display="block",i.element.firstElementChild.innerHTML="",i.ASTChart.setOption({series:[{data:JSON.parse(n.lute.RenderEChartsJSON(S(n))),initialTreeDepth:-1,label:{align:"left",backgroundColor:"rgba(68, 77, 86, .68)",borderRadius:3,color:"#d1d5da",fontSize:12,lineHeight:12,offset:[9,12],padding:[2,4,2,4],position:"top",verticalAlign:"middle"},lineStyle:{color:"#4285f4",type:"curve",width:1},orient:"vertical",roam:!0,type:"tree"}],toolbox:{bottom:25,emphasis:{iconStyle:{color:"#4285f4"}},feature:{restore:{show:!0},saveAsImage:{show:!0}},right:15,show:!0}}),i.ASTChart.resize()}catch(a){i.element.lastElementChild.style.display="none",i.element.firstElementChild.innerHTML=a}})},t}(),f=l(629),g=function(t,n){n.forEach(function(i){if(t[i]){var a=t[i].children[0];a&&a.classList.contains("vditor-menu--current")&&a.classList.remove("vditor-menu--current")}})},b=function(t,n){n.forEach(function(i){if(t[i]){var a=t[i].children[0];a&&!a.classList.contains("vditor-menu--current")&&a.classList.add("vditor-menu--current")}})},k=function(t,n){n.forEach(function(i){if(t[i]){var a=t[i].children[0];a&&a.classList.contains(u.Y.CLASS_MENU_DISABLED)&&a.classList.remove(u.Y.CLASS_MENU_DISABLED)}})},w=function(t,n){n.forEach(function(i){if(t[i]){var a=t[i].children[0];a&&!a.classList.contains(u.Y.CLASS_MENU_DISABLED)&&a.classList.add(u.Y.CLASS_MENU_DISABLED)}})},_=function(t,n){n.forEach(function(i){t[i]&&t[i]&&(t[i].style.display="none")})},C=function(t,n){n.forEach(function(i){t[i]&&t[i]&&(t[i].style.display="block")})},T=function(t,n,i){n.includes("subToolbar")&&(t.toolbar.element.querySelectorAll(".vditor-hint").forEach(function(a){i&&a.isEqualNode(i)||(a.style.display="none")}),t.toolbar.elements.emoji&&(t.toolbar.elements.emoji.lastElementChild.style.display="none")),n.includes("hint")&&(t.hint.element.style.display="none"),t.wysiwyg.popover&&n.includes("popover")&&(t.wysiwyg.popover.style.display="none")},M=function(t,n,i,a){i.addEventListener((0,f.y3)(),function(o){o.preventDefault(),o.stopPropagation(),!i.classList.contains(u.Y.CLASS_MENU_DISABLED)&&(t.toolbar.element.querySelectorAll(".vditor-hint--current").forEach(function(c){c.classList.remove("vditor-hint--current")}),n.style.display==="block"?n.style.display="none":(T(t,["subToolbar","hint","popover"],i.parentElement.parentElement),i.classList.contains("vditor-tooltipped")||i.classList.add("vditor-hint--current"),n.style.display="block",t.toolbar.element.getBoundingClientRect().right-i.getBoundingClientRect().right<250?n.classList.add("vditor-panel--left"):n.classList.remove("vditor-panel--left")))})},y=l(598),O=l(164),B=function(t,n,i,a){a&&console.log("".concat(t," - ").concat(i,": ").concat(n))},V=l(288),I=l(784),j=l(51),z=l(500),F=l(339),le=l(108),de=l(960),Re=l(975),Be=l(597),Ce=l(162),De=l(591),Ie=l(931),Je=function(t,n,i){i===void 0&&(i="sv");var a=document.createElement("div");a.innerHTML=t;var o=!1;a.childElementCount===1&&a.lastElementChild.style.fontFamily.indexOf("monospace")>-1&&(o=!0);var c=a.querySelectorAll("pre");if(a.childElementCount===1&&c.length===1&&c[0].className!=="vditor-wysiwyg"&&c[0].className!=="vditor-sv"&&(o=!0),t.indexOf(`
<p class="p1">`)===0&&(o=!0),a.childElementCount===1&&a.firstElementChild.tagName==="TABLE"&&a.querySelector(".line-number")&&a.querySelector(".line-content")&&(o=!0),o){var x=n||t;return/\n/.test(x)||c.length===1?i==="wysiwyg"?'<div class="vditor-wysiwyg__block" data-block="0" data-type="code-block"><pre><code>'.concat(x.replace(/&/g,"&amp;").replace(/</g,"&lt;"),"<wbr></code></pre></div>"):"\n```\n"+x.replace(/&/g,"&amp;").replace(/</g,"&lt;")+"\n```":i==="wysiwyg"?"<code>".concat(x.replace(/&/g,"&amp;").replace(/</g,"&lt;"),"</code><wbr>"):"`".concat(x,"`")}return!1},tt=function(t,n){if(t){if(t.parentElement.getAttribute("data-type")==="html-block"){t.setAttribute("data-render","1");return}var i=t.firstElementChild.className.replace("language-","");if(i==="abc")(0,V.$)(t,n.options.cdn);else if(i==="mermaid")(0,Re.e)(t,n.options.cdn,n.options.theme);else if(i==="smiles")(0,Ie.Y)(t,n.options.cdn,n.options.theme);else if(i==="markmap")(0,Be.K)(t,n.options.cdn);else if(i==="flowchart")(0,z.D)(t,n.options.cdn);else if(i==="echarts")(0,I.v)(t,n.options.cdn,n.options.theme);else if(i==="mindmap")(0,Ce.l)(t,n.options.cdn,n.options.theme);else if(i==="plantuml")(0,De.M)(t,n.options.cdn);else if(i==="graphviz")(0,F.m)(t,n.options.cdn);else if(i==="math")(0,de.T)(t,{cdn:n.options.cdn,math:n.options.preview.math});else{var a=n.options.customRenders.find(function(o){if(o.language===i)return o.render(t,n),!0});a||((0,le.$)(Object.assign({},n.options.preview.hljs),t,n.options.cdn),(0,j.o)(t,n.options.preview.hljs))}t.setAttribute("data-render","1")}},U=l(827),oe=function(t){if(t.currentMode!=="sv"){var n=t[t.currentMode].element,i=t.outline.render(t);i===""&&(i="[ToC]"),n.querySelectorAll('[data-type="toc-block"]').forEach(function(a){a.innerHTML=i,(0,de.T)(a,{cdn:t.options.cdn,math:t.options.preview.math})})}},re=function(t,n){var i=(0,y._Y)(t.target,"SPAN");if(i&&(0,y.KJ)(i,"vditor-toc")){var a=n[n.currentMode].element.querySelector("#"+i.getAttribute("data-target-id"));if(a)if(n.options.height==="auto"){var o=a.offsetTop+n.element.offsetTop;n.options.toolbarConfig.pin||(o+=n.toolbar.element.offsetHeight),window.scrollTo(window.scrollX,o)}else n.element.offsetTop<window.scrollY&&window.scrollTo(window.scrollX,n.element.offsetTop),n[n.currentMode].element.scrollTop=a.offsetTop;return}},Ae=function(t,n,i,a){if(t.previousElementSibling&&t.previousElementSibling.classList.contains("vditor-toc")){if(i.key==="Backspace"&&(0,U.ED)(t,n[n.currentMode].element,a).start===0)return t.previousElementSibling.remove(),ct(n),!0;if(ni(n,i,a,t,t.previousElementSibling))return!0}if(t.nextElementSibling&&t.nextElementSibling.classList.contains("vditor-toc")){if(i.key==="Delete"&&(0,U.ED)(t,n[n.currentMode].element,a).start>=t.textContent.trimRight().length)return t.nextElementSibling.remove(),ct(n),!0;if(xi(n,i,a,t,t.nextElementSibling))return!0}if(i.key==="Backspace"||i.key==="Delete"){var o=(0,y.KJ)(a.startContainer,"vditor-toc");if(o)return o.remove(),ct(n),!0}},Ke=function(t,n,i,a){i===void 0&&(i=!1);var o=(0,y.pt)(n.startContainer);if(o&&!i&&o.getAttribute("data-type")!=="code-block"){if(pi(o.innerHTML)&&o.previousElementSibling||hr(o.innerHTML))return;for(var c=(0,U.ED)(o,t.ir.element,n).start,x=!0,A=c-1;A>o.textContent.substr(0,c).lastIndexOf(`
`);A--)if(o.textContent.charAt(A)!==" "&&o.textContent.charAt(A)!=="	"){x=!1;break}c===0&&(x=!1);for(var D=!0,A=c-1;A<o.textContent.length;A++)if(o.textContent.charAt(A)!==" "&&o.textContent.charAt(A)!==`
`){D=!1;break}if(x){typeof t.options.input=="function"&&t.options.input(S(t));return}if(D&&/^#{1,6} $/.test(o.textContent)&&(D=!1),D){var L=(0,y.KJ)(n.startContainer,"vditor-ir__marker");if(!L){var $=n.startContainer.previousSibling;$&&$.nodeType!==3&&$.classList.contains("vditor-ir__node--expand")&&$.classList.remove("vditor-ir__node--expand"),typeof t.options.input=="function"&&t.options.input(S(t));return}}}if(t.ir.element.querySelectorAll(".vditor-ir__node--expand").forEach(function(ot){ot.classList.remove("vditor-ir__node--expand")}),o||(o=t.ir.element),!o.querySelector("wbr")){var K=(0,y.KJ)(n.startContainer,"vditor-ir__preview");K?K.previousElementSibling.insertAdjacentHTML("beforeend","<wbr>"):n.insertNode(document.createElement("wbr"))}o.querySelectorAll("[style]").forEach(function(ot){ot.removeAttribute("style")}),o.getAttribute("data-type")==="link-ref-defs-block"&&(o=t.ir.element);var me=o.isEqualNode(t.ir.element),pe=(0,y.Th)(o,"data-type","footnotes-block"),fe="";if(me)fe=o.innerHTML;else{var $e=(0,O.f)(n.startContainer,"BLOCKQUOTE"),ke=(0,y.KR)(n.startContainer);if(ke&&(o=ke),$e&&(!ke||ke&&!$e.contains(ke))&&(o=$e),pe&&(o=pe),fe=o.outerHTML,o.tagName==="UL"||o.tagName==="OL"){var ue=o.previousElementSibling,Ye=o.nextElementSibling;ue&&(ue.tagName==="UL"||ue.tagName==="OL")&&(fe=ue.outerHTML+fe,ue.remove()),Ye&&(Ye.tagName==="UL"||Ye.tagName==="OL")&&(fe=fe+Ye.outerHTML,Ye.remove()),fe=fe.replace("<div><wbr><br></div>","<li><p><wbr><br></p></li>")}else o.previousElementSibling&&o.previousElementSibling.textContent.replace(u.Y.ZWSP,"")!==""&&a&&a.inputType==="insertParagraph"&&(fe=o.previousElementSibling.outerHTML+fe,o.previousElementSibling.remove());o.innerText.startsWith("```")||(t.ir.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(ot){ot&&!o.isEqualNode(ot)&&(fe+=ot.outerHTML,ot.remove())}),t.ir.element.querySelectorAll("[data-type='footnotes-block']").forEach(function(ot){ot&&!o.isEqualNode(ot)&&(fe+=ot.outerHTML,ot.remove())}))}if(B("SpinVditorIRDOM",fe,"argument",t.options.debugger),fe=t.lute.SpinVditorIRDOM(fe),B("SpinVditorIRDOM",fe,"result",t.options.debugger),me)o.innerHTML=fe;else if(o.outerHTML=fe,pe){var Ne=(0,y.Th)(t.ir.element.querySelector("wbr"),"data-type","footnotes-def");if(Ne){var Xe=Ne.textContent,xt=Xe.substring(1,Xe.indexOf("]:")),St=t.ir.element.querySelector('sup[data-type="footnotes-ref"][data-footnotes-label="'.concat(xt,'"]'));St&&St.setAttribute("aria-label",Xe.substr(xt.length+3).trim().substr(0,24))}}var Tt,pn=t.ir.element.querySelectorAll("[data-type='link-ref-defs-block']");pn.forEach(function(ot,Vt){Vt===0?Tt=ot:(Tt.insertAdjacentHTML("beforeend",ot.innerHTML),ot.remove())}),pn.length>0&&t.ir.element.insertAdjacentElement("beforeend",pn[0]);var tn,mn=t.ir.element.querySelectorAll("[data-type='footnotes-block']");mn.forEach(function(ot,Vt){Vt===0?tn=ot:(tn.insertAdjacentHTML("beforeend",ot.innerHTML),ot.remove())}),mn.length>0&&t.ir.element.insertAdjacentElement("beforeend",mn[0]),(0,U.ir)(t.ir.element,n),t.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach(function(ot){tt(ot,t)}),oe(t),Wn(t,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},X=function(t,n){if(t==="")return!1;if(t.indexOf("⇧")===-1&&t.indexOf("⌘")===-1&&t.indexOf("⌥")===-1)return!(0,f._0)(n)&&!n.altKey&&!n.shiftKey&&n.code===t;if(t==="⇧Tab")return!!(!(0,f._0)(n)&&!n.altKey&&n.shiftKey&&n.code==="Tab");var i=t.split("");if(t.startsWith("⌥")){var a=i.length===3?i[2]:i[1];return!!((i.length===3?(0,f._0)(n):!(0,f._0)(n))&&n.altKey&&!n.shiftKey&&n.code===(/^[0-9]$/.test(a)?"Digit":"Key")+a)}t==="⌘Enter"&&(i=["⌘","Enter"]);var o=i.length>2&&i[0]==="⇧",c=o?i[2]:i[1];return o&&((0,f.gm)()||!/Mac/.test(navigator.platform))&&(c==="-"?c="_":c==="="&&(c="+")),!!((0,f._0)(n)&&n.key.toLowerCase()===c.toLowerCase()&&!n.altKey&&(!o&&!n.shiftKey||o&&n.shiftKey))},we=function(t){var n=t.startContainer;if(n.nodeType===3&&n.nodeValue.length!==t.startOffset)return!1;for(var i=n.nextSibling;i&&i.textContent==="";)i=i.nextSibling;if(i){if(i&&i.nodeType!==3&&i.classList.contains("vditor-ir__node")&&!i.getAttribute("data-block"))return i}else{var a=(0,y.KJ)(n,"vditor-ir__marker");if(a&&!a.nextSibling){var o=n.parentElement.parentElement.nextSibling;if(o&&o.nodeType!==3&&o.classList.contains("vditor-ir__node"))return o}return!1}return!1},se=function(t){var n=t.startContainer,i=n.previousSibling;return n.nodeType===3&&t.startOffset===0&&i&&i.nodeType!==3&&i.classList.contains("vditor-ir__node")&&!i.getAttribute("data-block")?i:!1},ee=function(t,n){n.ir.element.querySelectorAll(".vditor-ir__node--expand").forEach(function(x){x.classList.remove("vditor-ir__node--expand")});var i=(0,y.XW)(t.startContainer,"vditor-ir__node"),a=!t.collapsed&&(0,y.XW)(t.endContainer,"vditor-ir__node");if(!(!t.collapsed&&(!i||i!==a))){i&&(i.classList.add("vditor-ir__node--expand"),i.classList.remove("vditor-ir__node--hidden"),(0,U.jl)(t));var o=we(t);if(o){o.classList.add("vditor-ir__node--expand"),o.classList.remove("vditor-ir__node--hidden");return}var c=se(t);if(c){c.classList.add("vditor-ir__node--expand"),c.classList.remove("vditor-ir__node--hidden");return}}},He=function(t,n){if(t.ir.composingLock=n.isComposing,n.isComposing)return!1;n.key.indexOf("Arrow")===-1&&n.key!=="Meta"&&n.key!=="Control"&&n.key!=="Alt"&&n.key!=="Shift"&&n.key!=="CapsLock"&&n.key!=="Escape"&&!/^F\d{1,2}$/.test(n.key)&&t.undo.recordFirstPosition(t,n);var i=(0,U.RN)(t),a=i.startContainer;if(!Or(n,t,a)||(cr(i,t,n),Ft(i),n.key!=="Enter"&&n.key!=="Tab"&&n.key!=="Backspace"&&n.key.indexOf("Arrow")===-1&&!(0,f._0)(n)&&n.key!=="Escape"&&n.key!=="Delete"))return!1;var o=(0,y.Th)(a,"data-newline","1");if(!(0,f._0)(n)&&!n.altKey&&!n.shiftKey&&n.key==="Enter"&&o&&i.startOffset<o.textContent.length){var c=o.previousElementSibling;c&&(i.insertNode(document.createTextNode(c.textContent)),i.collapse(!1));var x=o.nextSibling;x&&(i.insertNode(document.createTextNode(x.textContent)),i.collapse(!0))}var A=(0,y._Y)(a,"P");if(Y(n,t,A,i)||H(i,t,A,n)||mi(t,i,n,A))return!0;var D=(0,y.KJ)(a,"vditor-ir__marker--pre");if(D&&D.tagName==="PRE"){var L=D.firstChild;if(En(t,n,D,i)||(L.getAttribute("data-type")==="math-block"||L.getAttribute("data-type")==="html-block")&&ni(t,n,i,L,D.parentElement)||xi(t,n,i,L,D.parentElement))return!0}var $=(0,y.Th)(a,"data-type","code-block-info");if($){if(n.key==="Enter"||n.key==="Tab")return i.selectNodeContents($.nextElementSibling.firstChild),i.collapse(!0),n.preventDefault(),T(t,["hint"]),!0;if(n.key==="Backspace"){var K=(0,U.ED)($,t.ir.element).start;K===1&&i.setStart(a,0),K===2&&(t.hint.recentLanguage="")}if(ni(t,n,i,$,$.parentElement))return T(t,["hint"]),!0}var me=(0,y._Y)(a,"TD")||(0,y._Y)(a,"TH");if(n.key.indexOf("Arrow")>-1&&me){var pe=Pr(me);if(pe&&ni(t,n,i,me,pe))return!0;var fe=Rr(me);if(fe&&xi(t,n,i,me,fe))return!0}if(At(t,n,i)||qn(t,i,n)||R(t,i,n))return!0;var $e=(0,O.c)(a);if($e){if(X("⌘=",n)){var ke=$e.querySelector(".vditor-ir__marker--heading");return ke&&ke.textContent.trim().length>1&&jn(t,ke.textContent.substr(1)),n.preventDefault(),!0}if(X("⌘-",n)){var ke=$e.querySelector(".vditor-ir__marker--heading");return ke&&ke.textContent.trim().length<6&&jn(t,ke.textContent.trim()+"# "),n.preventDefault(),!0}}var ue=(0,y.pt)(a);if(n.key==="Backspace"&&!(0,f._0)(n)&&!n.shiftKey&&!n.altKey&&i.toString()===""){if(ce(t,i,n,A))return!0;if(ue&&ue.previousElementSibling&&ue.tagName!=="UL"&&ue.tagName!=="OL"&&(ue.previousElementSibling.getAttribute("data-type")==="code-block"||ue.previousElementSibling.getAttribute("data-type")==="math-block")){var Ye=(0,U.ED)(ue,t.ir.element,i).start;if(Ye===0||Ye===1&&ue.innerText.startsWith(u.Y.ZWSP))return i.selectNodeContents(ue.previousElementSibling.querySelector(".vditor-ir__marker--pre code")),i.collapse(!1),ee(i,t),ue.textContent.trim().replace(u.Y.ZWSP,"")===""&&(ue.remove(),Wn(t)),n.preventDefault(),!0}if($e){var Ne=$e.firstElementChild.textContent.length;(0,U.ED)($e,t.ir.element).start===Ne&&Ne!==0&&(i.setStart($e.firstElementChild.firstChild,Ne-1),i.collapse(!0),(0,U.jl)(i))}}return(n.key==="ArrowUp"||n.key==="ArrowDown")&&ue&&(ue.querySelectorAll(".vditor-ir__node").forEach(function(Xe){Xe.contains(a)||Xe.classList.add("vditor-ir__node--hidden")}),kn(n,ue,i))?!0:(ur(i,n.key),ue&&Ae(ue,t,n,i)?(n.preventDefault(),!0):!1)},ve=l(726),st=function(t,n){t.querySelectorAll("[data-type=footnotes-link]").forEach(function(i){for(var a=i.parentElement,o=a.nextSibling;o&&o.textContent.startsWith("    ");){var c=o;c.childNodes.forEach(function(x){a.append(x.cloneNode(!0))}),o=o.nextSibling,c.remove()}n&&n(a)})},Ve=function(t,n){var i,a=getSelection().getRangeAt(0).cloneRange(),o=a.startContainer;a.startContainer.nodeType!==3&&a.startContainer.tagName==="DIV"&&(o=a.startContainer.childNodes[a.startOffset-1]);var c=(0,y.Th)(o,"data-block","0");if(c&&n&&(n.inputType==="deleteContentBackward"||n.data===" ")){for(var x=(0,U.ED)(c,t.sv.element,a).start,A=!0,D=x-1;D>c.textContent.substr(0,x).lastIndexOf(`
`);D--)if(c.textContent.charAt(D)!==" "&&c.textContent.charAt(D)!=="	"){A=!1;break}if(x===0&&(A=!1),A){Ue(t);return}if(n.inputType==="deleteContentBackward"){var L=(0,y.Th)(o,"data-type","code-block-open-marker")||(0,y.Th)(o,"data-type","code-block-close-marker");if(L){if(L.getAttribute("data-type")==="code-block-close-marker"){var $=Z(o,"code-block-open-marker");if($){$.textContent=L.textContent,Ue(t);return}}if(L.getAttribute("data-type")==="code-block-open-marker"){var $=Z(o,"code-block-close-marker",!1);if($){$.textContent=L.textContent,Ue(t);return}}}var K=(0,y.Th)(o,"data-type","math-block-open-marker");if(K){var me=K.nextElementSibling.nextElementSibling;me&&me.getAttribute("data-type")==="math-block-close-marker"&&(me.remove(),Ue(t));return}c.querySelectorAll('[data-type="code-block-open-marker"]').forEach(function(ue){ue.textContent.length===1&&ue.remove()}),c.querySelectorAll('[data-type="code-block-close-marker"]').forEach(function(ue){ue.textContent.length===1&&ue.remove()});var pe=(0,y.Th)(o,"data-type","heading-marker");if(pe&&pe.textContent.indexOf("#")===-1){Ue(t);return}}if((n.data===" "||n.inputType==="deleteContentBackward")&&((0,y.Th)(o,"data-type","padding")||(0,y.Th)(o,"data-type","li-marker")||(0,y.Th)(o,"data-type","task-marker")||(0,y.Th)(o,"data-type","blockquote-marker"))){Ue(t);return}}if(c&&c.textContent.trimRight()==="$$"){Ue(t);return}c||(c=t.sv.element),((i=c.firstElementChild)===null||i===void 0?void 0:i.getAttribute("data-type"))==="link-ref-defs-block"&&(c=t.sv.element),(0,y.Th)(o,"data-type","footnotes-link")&&(c=t.sv.element),c.textContent.indexOf(Lute.Caret)===-1&&a.insertNode(document.createTextNode(Lute.Caret)),c.querySelectorAll("[style]").forEach(function(ue){ue.removeAttribute("style")}),c.querySelectorAll("font").forEach(function(ue){ue.outerHTML=ue.innerHTML});var fe=c.textContent,$e=c.isEqualNode(t.sv.element);if($e)fe=c.textContent;else{c.previousElementSibling&&(fe=c.previousElementSibling.textContent+fe,c.previousElementSibling.remove()),c.previousElementSibling&&fe.indexOf(`---
`)===0&&(fe=c.previousElementSibling.textContent+fe,c.previousElementSibling.remove());var ke="";t.sv.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(ue,Ye){ue&&!c.isEqualNode(ue.parentElement)&&(ke+=ue.parentElement.textContent+`
`,ue.parentElement.remove())}),t.sv.element.querySelectorAll("[data-type='footnotes-link']").forEach(function(ue,Ye){ue&&!c.isEqualNode(ue.parentElement)&&(ke+=ue.parentElement.textContent+`
`,ue.parentElement.remove())}),fe=ke+fe}fe=xe(fe,t),$e?c.innerHTML=fe:c.outerHTML=fe,t.sv.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(ue){t.sv.element.insertAdjacentElement("beforeend",ue.parentElement)}),st(t.sv.element,function(ue){t.sv.element.insertAdjacentElement("beforeend",ue)}),(0,U.ir)(t.sv.element,a),Ge(t),Ue(t,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},Qe=function(t,n){var i,a,o,c,x;if(t.sv.composingLock=n.isComposing,n.isComposing||(n.key.indexOf("Arrow")===-1&&n.key!=="Meta"&&n.key!=="Control"&&n.key!=="Alt"&&n.key!=="Shift"&&n.key!=="CapsLock"&&n.key!=="Escape"&&!/^F\d{1,2}$/.test(n.key)&&t.undo.recordFirstPosition(t,n),n.key!=="Enter"&&n.key!=="Tab"&&n.key!=="Backspace"&&n.key.indexOf("Arrow")===-1&&!(0,f._0)(n)&&n.key!=="Escape"))return!1;var A=(0,U.RN)(t),D=A.startContainer;A.startContainer.nodeType!==3&&A.startContainer.tagName==="DIV"&&(D=A.startContainer.childNodes[A.startOffset-1]);var L=(0,y.Th)(D,"data-type","text"),$=(0,y.Th)(D,"data-type","blockquote-marker");if(!$&&A.startOffset===0&&L&&L.previousElementSibling&&L.previousElementSibling.getAttribute("data-type")==="blockquote-marker"&&($=L.previousElementSibling),$&&n.key==="Enter"&&!(0,f._0)(n)&&!n.altKey&&$.nextElementSibling.textContent.trim()===""&&(0,U.ED)($,t.sv.element,A).start===$.textContent.length)return((i=$.previousElementSibling)===null||i===void 0?void 0:i.getAttribute("data-type"))==="padding"&&$.previousElementSibling.setAttribute("data-action","enter-remove"),$.remove(),Ue(t),n.preventDefault(),!0;var K=(0,y.Th)(D,"data-type","li-marker"),me=(0,y.Th)(D,"data-type","task-marker"),pe=K;if(pe||me&&me.nextElementSibling.getAttribute("data-type")!=="task-marker"&&(pe=me),!pe&&A.startOffset===0&&L&&L.previousElementSibling&&(L.previousElementSibling.getAttribute("data-type")==="li-marker"||L.previousElementSibling.getAttribute("data-type")==="task-marker")&&(pe=L.previousElementSibling),pe){var fe=(0,U.ED)(pe,t.sv.element,A).start,$e=pe.getAttribute("data-type")==="task-marker",ke=pe;if($e&&(ke=pe.previousElementSibling.previousElementSibling.previousElementSibling),fe===pe.textContent.length){if(n.key==="Enter"&&!(0,f._0)(n)&&!n.altKey&&!n.shiftKey&&pe.nextElementSibling.textContent.trim()==="")return((a=ke.previousElementSibling)===null||a===void 0?void 0:a.getAttribute("data-type"))==="padding"?(ke.previousElementSibling.remove(),Ve(t)):($e&&(ke.remove(),pe.previousElementSibling.previousElementSibling.remove(),pe.previousElementSibling.remove()),pe.nextElementSibling.remove(),pe.remove(),Ue(t)),n.preventDefault(),!0;if(n.key==="Tab")return n.shiftKey?ke.previousElementSibling.getAttribute("data-type")==="padding"&&ke.previousElementSibling.remove():ke.insertAdjacentHTML("beforebegin",'<span data-type="padding">'.concat(ke.textContent.replace(/\S/g," "),"</span>")),/^\d/.test(ke.textContent)&&(ke.textContent=ke.textContent.replace(/^\d{1,}/,"1"),A.selectNodeContents(pe.firstChild),A.collapse(!1)),Ve(t),n.preventDefault(),!0}}if(R(t,A,n))return!0;var ue=(0,y.Th)(D,"data-block","0"),Ye=(0,O.f)(D,"SPAN");if(n.key==="Enter"&&!(0,f._0)(n)&&!n.altKey&&!n.shiftKey&&ue){var Ne=!1,Xe=ue.textContent.match(/^\n+/);(0,U.ED)(ue,t.sv.element).start<=(Xe?Xe[0].length:0)&&(Ne=!0);var xt=`
`;if(Ye){if(((o=Ye.previousElementSibling)===null||o===void 0?void 0:o.getAttribute("data-action"))==="enter-remove")return Ye.previousElementSibling.remove(),Ue(t),n.preventDefault(),!0;xt+=ze(Ye)}return A.insertNode(document.createTextNode(xt)),A.collapse(!1),ue&&ue.textContent.trim()!==""&&!Ne?Ve(t):Ue(t),n.preventDefault(),!0}if(n.key==="Backspace"&&!(0,f._0)(n)&&!n.altKey&&!n.shiftKey){if(Ye&&((c=Ye.previousElementSibling)===null||c===void 0?void 0:c.getAttribute("data-type"))==="newline"&&(0,U.ED)(Ye,t.sv.element,A).start===1&&Ye.getAttribute("data-type").indexOf("code-block-")===-1)return A.setStart(Ye,0),A.extractContents(),Ye.textContent.trim()!==""?Ve(t):Ue(t),n.preventDefault(),!0;if(ue&&(0,U.ED)(ue,t.sv.element,A).start===0&&ue.previousElementSibling){A.extractContents();var St=ue.previousElementSibling.lastElementChild;return St.getAttribute("data-type")==="newline"&&(St.remove(),St=ue.previousElementSibling.lastElementChild),St.getAttribute("data-type")!=="newline"&&(St.insertAdjacentHTML("afterend",ue.innerHTML),ue.remove()),ue.textContent.trim()!==""&&!(!((x=ue.previousElementSibling)===null||x===void 0)&&x.querySelector('[data-type="code-block-open-marker"]'))?Ve(t):(St.getAttribute("data-type")!=="newline"&&(A.selectNodeContents(St.lastChild),A.collapse(!1)),Ue(t)),n.preventDefault(),!0}}return!1},Oe=l(873),it=function(t){t.options.theme==="dark"?t.element.classList.add("vditor--dark"):t.element.classList.remove("vditor--dark")},lt=function(t){t.element.innerHTML="",t.element.classList.add("vditor"),t.options.rtl&&t.element.setAttribute("dir","rtl"),it(t),(0,Oe.H)(t.options.preview.theme.current,t.options.preview.theme.path),typeof t.options.height=="number"?t.element.style.height=t.options.height+"px":t.element.style.height=t.options.height,typeof t.options.minHeight=="number"&&(t.element.style.minHeight=t.options.minHeight+"px"),typeof t.options.width=="number"?t.element.style.width=t.options.width+"px":t.element.style.width=t.options.width,t.element.appendChild(t.toolbar.element);var n=document.createElement("div");if(n.className="vditor-content",t.options.outline.position==="left"&&n.appendChild(t.outline.element),n.appendChild(t.wysiwyg.element.parentElement),n.appendChild(t.sv.element),n.appendChild(t.ir.element.parentElement),n.appendChild(t.preview.element),t.toolbar.elements.devtools&&n.appendChild(t.devtools.element),t.options.outline.position==="right"&&(t.outline.element.classList.add("vditor-outline--right"),n.appendChild(t.outline.element)),t.upload&&n.appendChild(t.upload.element),t.options.resize.enable&&n.appendChild(t.resize.element),n.appendChild(t.hint.element),n.appendChild(t.tip.element),t.element.appendChild(n),n.addEventListener("click",function(){T(t,["subToolbar"])}),t.toolbar.elements.export&&t.element.insertAdjacentHTML("beforeend",'<iframe id="vditorExportIframe" style="width: 100%;height: 0;border: 0"></iframe>'),Ut(t,t.options.mode,rn(t)),document.execCommand("DefaultParagraphSeparator",!1,"p"),navigator.userAgent.indexOf("iPhone")>-1&&typeof window.visualViewport<"u"){var i=!1,a=function(o){i||(i=!0,requestAnimationFrame(function(){i=!1;var c=t.toolbar.element;c.style.transform="none",c.getBoundingClientRect().top<0&&(c.style.transform="translate(0, ".concat(-c.getBoundingClientRect().top,"px)"))}))};window.visualViewport.addEventListener("scroll",a),window.visualViewport.addEventListener("resize",a)}},ft=function(t){var n=window.innerWidth<=u.Y.MOBILE_WIDTH?10:35;if(t.wysiwyg.element.parentElement.style.display!=="none"){var i=(t.wysiwyg.element.parentElement.clientWidth-t.options.preview.maxWidth)/2;t.wysiwyg.element.style.padding="10px ".concat(Math.max(n,i),"px")}if(t.ir.element.parentElement.style.display!=="none"){var i=(t.ir.element.parentElement.clientWidth-t.options.preview.maxWidth)/2;t.ir.element.style.padding="10px ".concat(Math.max(n,i),"px")}t.preview.element.style.display!=="block"?t.toolbar.element.style.paddingLeft=Math.max(5,parseInt(t[t.currentMode].element.style.paddingLeft||"0",10)+(t.options.outline.position==="left"?t.outline.element.offsetWidth:0))+"px":t.toolbar.element.style.paddingLeft=5+(t.options.outline.position==="left"?t.outline.element.offsetWidth:0)+"px"},ht=function(t){if(t.options.typewriterMode){var n=window.innerHeight;typeof t.options.height=="number"?(n=t.options.height,typeof t.options.minHeight=="number"&&(n=Math.max(n,t.options.minHeight)),n=Math.min(window.innerHeight,n)):n=t.element.clientHeight,t.element.classList.contains("vditor--fullscreen")&&(n=window.innerHeight),t[t.currentMode].element.style.setProperty("--editor-bottom",(n-t.toolbar.element.offsetHeight)/2+"px")}},Dt;function Mn(){window.removeEventListener("resize",Dt)}var rn=function(t){ht(t),Mn(),window.addEventListener("resize",Dt=function(){ft(t),ht(t)});var n=(0,f.D)()&&localStorage.getItem(t.options.cache.id);return(!t.options.cache.enable||!n)&&(t.options.value?n=t.options.value:t.originalInnerHTML?n=t.lute.HTML2Md(t.originalInnerHTML):t.options.cache.enable||(n="")),n||""},an=function(t){clearTimeout(t[t.currentMode].hlToolbarTimeoutId),t[t.currentMode].hlToolbarTimeoutId=window.setTimeout(function(){if(t[t.currentMode].element.getAttribute("contenteditable")!=="false"&&(0,U.Co)(t[t.currentMode].element)){g(t.toolbar.elements,u.Y.EDIT_TOOLBARS),k(t.toolbar.elements,u.Y.EDIT_TOOLBARS);var n=(0,U.RN)(t),i=n.startContainer;n.startContainer.nodeType===3&&(i=n.startContainer.parentElement),i.classList.contains("vditor-reset")&&(i=i.childNodes[n.startOffset]);var a=t.currentMode==="sv"?(0,y.Th)(i,"data-type","heading"):(0,O.c)(i);a&&b(t.toolbar.elements,["headings"]);var o=t.currentMode==="sv"?(0,y.Th)(i,"data-type","blockquote"):(0,y._Y)(i,"BLOCKQUOTE");o&&b(t.toolbar.elements,["quote"]);var c=(0,y.Th)(i,"data-type","strong");c&&b(t.toolbar.elements,["bold"]);var x=(0,y.Th)(i,"data-type","em");x&&b(t.toolbar.elements,["italic"]);var A=(0,y.Th)(i,"data-type","s");A&&b(t.toolbar.elements,["strike"]);var D=(0,y.Th)(i,"data-type","a");D&&b(t.toolbar.elements,["link"]);var L=(0,y._Y)(i,"LI");L?(L.classList.contains("vditor-task")?b(t.toolbar.elements,["check"]):L.parentElement.tagName==="OL"?b(t.toolbar.elements,["ordered-list"]):L.parentElement.tagName==="UL"&&b(t.toolbar.elements,["list"]),k(t.toolbar.elements,["outdent","indent"])):w(t.toolbar.elements,["outdent","indent"]);var $=(0,y.Th)(i,"data-type","code-block");$&&(w(t.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","inline-code","upload","link","table","record"]),b(t.toolbar.elements,["code"]));var K=(0,y.Th)(i,"data-type","code");K&&(w(t.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","upload","link","table","record"]),b(t.toolbar.elements,["inline-code"]));var me=(0,y.Th)(i,"data-type","table");me&&w(t.toolbar.elements,["headings","list","ordered-list","check","line","quote","code","table"])}},200)},rt=function(t,n){n===void 0&&(n={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),n.enableHint&&t.hint.render(t),clearTimeout(t.wysiwyg.afterRenderTimeoutId),t.wysiwyg.afterRenderTimeoutId=window.setTimeout(function(){if(!t.wysiwyg.composingLock){var i=S(t);typeof t.options.input=="function"&&n.enableInput&&t.options.input(i),t.options.counter.enable&&t.counter.render(t,i),t.options.cache.enable&&(0,f.D)()&&(localStorage.setItem(t.options.cache.id,i),t.options.cache.after&&t.options.cache.after(i)),t.devtools&&t.devtools.renderEchart(t),n.enableAddUndoStack&&t.undo.addToUndoStack(t)}},t.options.undoDelay)},Kt=function(t){for(var n=t.previousSibling;n;){if(n.nodeType!==3&&n.tagName==="A"&&!n.previousSibling&&n.innerHTML.replace(u.Y.ZWSP,"")===""&&n.nextSibling)return n;n=n.previousSibling}return!1},dn=function(t){for(var n=t.startContainer.nextSibling;n&&n.textContent==="";)n=n.nextSibling;return!!(n&&n.nodeType!==3&&(n.tagName==="CODE"||n.getAttribute("data-type")==="math-inline"||n.getAttribute("data-type")==="html-entity"||n.getAttribute("data-type")==="html-inline"))},on=function(t){for(var n="",i=t.nextSibling;i;)i.nodeType===3?n+=i.textContent:n+=i.outerHTML,i=i.nextSibling;return n},fn=function(t){for(var n="",i=t.previousSibling;i;)i.nodeType===3?n=i.textContent+n:n=i.outerHTML+n,i=i.previousSibling;return n},yn=function(t){for(var n=t;n&&!n.nextSibling;)n=n.parentElement;return n.nextSibling},un=function(t){var n=fn(t.startContainer),i=on(t.startContainer),a=t.startContainer.textContent,o=t.startOffset,c="",x="";return(a.substr(0,o)!==""&&a.substr(0,o)!==u.Y.ZWSP||n)&&(c="".concat(n).concat(a.substr(0,o))),(a.substr(o)!==""&&a.substr(o)!==u.Y.ZWSP||i)&&(x="".concat(a.substr(o)).concat(i)),{afterHTML:x,beforeHTML:c}},Nt=function(t,n){Array.from(t.wysiwyg.element.childNodes).find(function(i){if(i.nodeType===3){var a=document.createElement("p");a.setAttribute("data-block","0"),a.textContent=i.textContent;var o=n.startContainer.nodeType===3?n.startOffset:i.textContent.length;return i.parentNode.insertBefore(a,i),i.remove(),n.setStart(a.firstChild,Math.min(a.firstChild.textContent.length,o)),n.collapse(!0),(0,U.jl)(n),!0}else if(!i.getAttribute("data-block"))return i.tagName==="P"?i.remove():(i.tagName==="DIV"?(n.insertNode(document.createElement("wbr")),i.outerHTML='<p data-block="0">'.concat(i.innerHTML,"</p>")):i.tagName==="BR"?i.outerHTML='<p data-block="0">'.concat(i.outerHTML,"<wbr></p>"):(n.insertNode(document.createElement("wbr")),i.outerHTML='<p data-block="0">'.concat(i.outerHTML,"</p>")),(0,U.ir)(t.wysiwyg.element,n),n=getSelection().getRangeAt(0)),!0})},Mt=function(t,n){var i=(0,U.RN)(t),a=(0,y.pt)(i.startContainer);a||(a=i.startContainer.childNodes[i.startOffset]),!a&&t.wysiwyg.element.children.length===0&&(a=t.wysiwyg.element),a&&!a.classList.contains("vditor-wysiwyg__block")&&(i.insertNode(document.createElement("wbr")),a.innerHTML.trim()==="<wbr>"&&(a.innerHTML="<wbr><br>"),a.tagName==="BLOCKQUOTE"||a.classList.contains("vditor-reset")?a.innerHTML="<".concat(n,' data-block="0">').concat(a.innerHTML.trim(),"</").concat(n,">"):a.outerHTML="<".concat(n,' data-block="0">').concat(a.innerHTML.trim(),"</").concat(n,">"),(0,U.ir)(t.wysiwyg.element,i),oe(t))},ei=function(t){var n=getSelection().getRangeAt(0),i=(0,y.pt)(n.startContainer);i||(i=n.startContainer.childNodes[n.startOffset]),i&&(n.insertNode(document.createElement("wbr")),i.outerHTML='<p data-block="0">'.concat(i.innerHTML,"</p>"),(0,U.ir)(t.wysiwyg.element,n)),t.wysiwyg.popover.style.display="none"},$t=function(t,n,i){i===void 0&&(i=!0);var a=t.previousElementSibling,o=a.ownerDocument.createRange();a.tagName==="CODE"?(a.style.display="inline-block",i?o.setStart(a.firstChild,1):o.selectNodeContents(a)):(a.style.display="block",a.firstChild.firstChild||a.firstChild.appendChild(document.createTextNode("")),o.selectNodeContents(a.firstChild)),i?o.collapse(!0):o.collapse(!1),(0,U.jl)(o),!t.firstElementChild.classList.contains("language-mindmap")&&Ge(n)},Ot=function(t,n){if(t.wysiwyg.composingLock=n.isComposing,n.isComposing)return!1;n.key.indexOf("Arrow")===-1&&n.key!=="Meta"&&n.key!=="Control"&&n.key!=="Alt"&&n.key!=="Shift"&&n.key!=="CapsLock"&&n.key!=="Escape"&&!/^F\d{1,2}$/.test(n.key)&&t.undo.recordFirstPosition(t,n);var i=(0,U.RN)(t),a=i.startContainer;if(!Or(n,t,a)||(cr(i,t,n),Ft(i),n.key!=="Enter"&&n.key!=="Tab"&&n.key!=="Backspace"&&n.key.indexOf("Arrow")===-1&&!(0,f._0)(n)&&n.key!=="Escape"&&n.key!=="Delete"))return!1;var o=(0,y.pt)(a),c=(0,y._Y)(a,"P");if(Y(n,t,c,i)||H(i,t,c,n)||At(t,n,i))return!0;var x=(0,y.KJ)(a,"vditor-wysiwyg__block");if(x){if(n.key==="Escape"&&x.children.length===2)return t.wysiwyg.popover.style.display="none",x.firstElementChild.style.display="none",t.wysiwyg.element.blur(),n.preventDefault(),!0;if(!(0,f._0)(n)&&!n.shiftKey&&n.altKey&&n.key==="Enter"&&x.getAttribute("data-type")==="code-block"){var A=t.wysiwyg.popover.querySelector(".vditor-input");return A.focus(),A.select(),n.preventDefault(),!0}if(x.getAttribute("data-block")==="0"&&(En(t,n,x.firstElementChild,i)||xi(t,n,i,x.firstElementChild,x)||x.getAttribute("data-type")!=="yaml-front-matter"&&ni(t,n,i,x.firstElementChild,x)))return!0}if(mi(t,i,n,c))return!0;var D=(0,y.Ab)(a,"BLOCKQUOTE");if(D&&!n.shiftKey&&n.altKey&&n.key==="Enter"){(0,f._0)(n)?i.setStartBefore(D):i.setStartAfter(D),(0,U.jl)(i);var L=document.createElement("p");return L.setAttribute("data-block","0"),L.innerHTML=`
`,i.insertNode(L),i.collapse(!0),(0,U.jl)(i),rt(t),Ge(t),n.preventDefault(),!0}var $=(0,O.c)(a);if($){if($.tagName==="H6"&&a.textContent.length===i.startOffset&&!(0,f._0)(n)&&!n.shiftKey&&!n.altKey&&n.key==="Enter"){var K=document.createElement("p");return K.textContent=`
`,K.setAttribute("data-block","0"),a.parentElement.insertAdjacentElement("afterend",K),i.setStart(K,0),(0,U.jl)(i),rt(t),Ge(t),n.preventDefault(),!0}if(X("⌘=",n)){var me=parseInt($.tagName.substr(1),10)-1;return me>0&&(Mt(t,"h".concat(me)),rt(t)),n.preventDefault(),!0}if(X("⌘-",n)){var me=parseInt($.tagName.substr(1),10)+1;return me<7&&(Mt(t,"h".concat(me)),rt(t)),n.preventDefault(),!0}n.key==="Backspace"&&!(0,f._0)(n)&&!n.shiftKey&&!n.altKey&&$.textContent.length===1&&ei(t)}if(qn(t,i,n))return!0;if(n.altKey&&n.key==="Enter"&&!(0,f._0)(n)&&!n.shiftKey){var pe=(0,y._Y)(a,"A"),fe=(0,y.Th)(a,"data-type","link-ref"),$e=(0,y.Th)(a,"data-type","footnotes-ref");if(pe||fe||$e||$&&$.tagName.length===2){var ke=t.wysiwyg.popover.querySelector("input");ke.focus(),ke.select()}}if(jt(t,n))return!0;if(X("⇧⌘U",n)){var ue=t.wysiwyg.popover.querySelector('[data-type="up"]');if(ue)return ue.click(),n.preventDefault(),!0}if(X("⇧⌘D",n)){var ue=t.wysiwyg.popover.querySelector('[data-type="down"]');if(ue)return ue.click(),n.preventDefault(),!0}if(R(t,i,n))return!0;if(!(0,f._0)(n)&&n.shiftKey&&!n.altKey&&n.key==="Enter"&&a.parentElement.tagName!=="LI"&&a.parentElement.tagName!=="P")return["STRONG","STRIKE","S","I","EM","B"].includes(a.parentElement.tagName)?i.insertNode(document.createTextNode(`
`+u.Y.ZWSP)):i.insertNode(document.createTextNode(`
`)),i.collapse(!1),(0,U.jl)(i),rt(t),Ge(t),n.preventDefault(),!0;if(n.key==="Backspace"&&!(0,f._0)(n)&&!n.shiftKey&&!n.altKey&&i.toString()===""){if(ce(t,i,n,c))return!0;if(o){if(o.previousElementSibling&&o.previousElementSibling.classList.contains("vditor-wysiwyg__block")&&o.previousElementSibling.getAttribute("data-block")==="0"&&o.tagName!=="UL"&&o.tagName!=="OL"){var Ye=(0,U.ED)(o,t.wysiwyg.element,i).start;if(Ye===0&&i.startOffset===0||Ye===1&&o.innerText.startsWith(u.Y.ZWSP))return $t(o.previousElementSibling.lastElementChild,t,!1),o.innerHTML.trim().replace(u.Y.ZWSP,"")===""&&(o.remove(),rt(t)),n.preventDefault(),!0}var Ne=i.startOffset;if(i.toString()===""&&a.nodeType===3&&a.textContent.charAt(Ne-2)===`
`&&a.textContent.charAt(Ne-1)!==u.Y.ZWSP&&["STRONG","STRIKE","S","I","EM","B"].includes(a.parentElement.tagName))return a.textContent=a.textContent.substring(0,Ne-1)+u.Y.ZWSP,i.setStart(a,Ne),i.collapse(!0),rt(t),n.preventDefault(),!0;a.textContent===u.Y.ZWSP&&i.startOffset===1&&!a.previousSibling&&dn(i)&&(a.textContent=""),o.querySelectorAll("span.vditor-wysiwyg__block[data-type='math-inline']").forEach(function(xt){xt.firstElementChild.style.display="inline",xt.lastElementChild.style.display="none"}),o.querySelectorAll("span.vditor-wysiwyg__block[data-type='html-entity']").forEach(function(xt){xt.firstElementChild.style.display="inline",xt.lastElementChild.style.display="none"})}}if((0,f.gm)()&&i.startOffset===1&&a.textContent.indexOf(u.Y.ZWSP)>-1&&a.previousSibling&&a.previousSibling.nodeType!==3&&a.previousSibling.tagName==="CODE"&&(n.key==="Backspace"||n.key==="ArrowLeft"))return i.selectNodeContents(a.previousSibling),i.collapse(!1),n.preventDefault(),!0;if(kn(n,o,i))return n.preventDefault(),!0;if(ur(i,n.key),n.key==="ArrowDown"){var Xe=a.nextSibling;Xe&&Xe.nodeType!==3&&Xe.getAttribute("data-type")==="math-inline"&&i.setStartAfter(Xe)}return o&&Ae(o,t,n,i)?(n.preventDefault(),!0):!1},jt=function(t,n){if(X("⇧⌘X",n)){var i=t.wysiwyg.popover.querySelector('[data-type="remove"]');return i&&i.click(),n.preventDefault(),!0}},q=function(t){clearTimeout(t.wysiwyg.hlToolbarTimeoutId),t.wysiwyg.hlToolbarTimeoutId=window.setTimeout(function(){if(t.wysiwyg.element.getAttribute("contenteditable")!=="false"&&(0,U.Co)(t.wysiwyg.element)){g(t.toolbar.elements,u.Y.EDIT_TOOLBARS),k(t.toolbar.elements,u.Y.EDIT_TOOLBARS);var n=getSelection().getRangeAt(0),i=n.startContainer;n.startContainer.nodeType===3?i=n.startContainer.parentElement:i=i.childNodes[n.startOffset>=i.childNodes.length?i.childNodes.length-1:n.startOffset];var a=(0,y.Th)(i,"data-type","footnotes-block");if(a){t.wysiwyg.popover.innerHTML="",Fe(a,t),P(t,a);return}var o=(0,y._Y)(i,"LI");o?(o.classList.contains("vditor-task")?b(t.toolbar.elements,["check"]):o.parentElement.tagName==="OL"?b(t.toolbar.elements,["ordered-list"]):o.parentElement.tagName==="UL"&&b(t.toolbar.elements,["list"]),k(t.toolbar.elements,["outdent","indent"])):w(t.toolbar.elements,["outdent","indent"]),(0,y._Y)(i,"BLOCKQUOTE")&&b(t.toolbar.elements,["quote"]),((0,y._Y)(i,"B")||(0,y._Y)(i,"STRONG"))&&b(t.toolbar.elements,["bold"]),((0,y._Y)(i,"I")||(0,y._Y)(i,"EM"))&&b(t.toolbar.elements,["italic"]),((0,y._Y)(i,"STRIKE")||(0,y._Y)(i,"S"))&&b(t.toolbar.elements,["strike"]),t.wysiwyg.element.querySelectorAll(".vditor-comment--focus").forEach(function(je){je.classList.remove("vditor-comment--focus")});var c=(0,y.KJ)(i,"vditor-comment");if(c){var x=c.getAttribute("data-cmtids").split(" ");if(x.length>1&&c.nextSibling.isSameNode(c.nextElementSibling)){var A=c.nextElementSibling.getAttribute("data-cmtids").split(" ");x.find(function(je){if(A.includes(je))return x=[je],!0})}t.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(je){je.getAttribute("data-cmtids").indexOf(x[0])>-1&&je.classList.add("vditor-comment--focus")})}var D=(0,y._Y)(i,"A");D&&b(t.toolbar.elements,["link"]);var L=(0,y._Y)(i,"TABLE"),$=(0,O.c)(i);(0,y._Y)(i,"CODE")?(0,y._Y)(i,"PRE")?(w(t.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","inline-code","upload","link","table","record"]),b(t.toolbar.elements,["code"])):(w(t.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","upload","link","table","record"]),b(t.toolbar.elements,["inline-code"])):$?(w(t.toolbar.elements,["bold"]),b(t.toolbar.elements,["headings"])):L&&w(t.toolbar.elements,["table"]);var K=(0,y.KJ)(i,"vditor-toc");if(K){t.wysiwyg.popover.innerHTML="",Fe(K,t),P(t,K);return}var me=(0,O.f)(i,"BLOCKQUOTE");if(me&&(t.wysiwyg.popover.innerHTML="",ie(n,me,t),Pe(n,me,t),Fe(me,t),P(t,me)),o&&(t.wysiwyg.popover.innerHTML="",ie(n,o,t),Pe(n,o,t),Fe(o,t),P(t,o)),L){t.options.lang,t.options,t.wysiwyg.popover.innerHTML="";var pe=function(){var je=L.rows.length,pt=L.rows[0].cells.length,vi=parseInt(Vt.value,10)||je,bi=parseInt(Sn.value,10)||pt;if(!(vi===je&&pt===bi)){if(pt!==bi)for(var gr=bi-pt,Yn=0;Yn<L.rows.length;Yn++)if(gr>0)for(var fo=0;fo<gr;fo++)Yn===0?L.rows[Yn].lastElementChild.insertAdjacentHTML("afterend","<th> </th>"):L.rows[Yn].lastElementChild.insertAdjacentHTML("afterend","<td> </td>");else for(var ga=pt-1;ga>=bi;ga--)L.rows[Yn].cells[ga].remove();if(je!==vi){var ho=vi-je;if(ho>0){for(var va="<tr>",Yi=0;Yi<bi;Yi++)va+="<td> </td>";for(var po=0;po<ho;po++)L.querySelector("tbody")?L.querySelector("tbody").insertAdjacentHTML("beforeend",va):L.querySelector("thead").insertAdjacentHTML("afterend",va+"</tr>")}else for(var Yi=je-1;Yi>=vi;Yi--)L.rows[Yi].remove(),L.rows.length===1&&L.querySelector("tbody").remove()}typeof t.options.input=="function"&&t.options.input(S(t))}},fe=function(je){hi(L,je),je==="right"?(Ye.classList.remove("vditor-icon--current"),Ne.classList.remove("vditor-icon--current"),Xe.classList.add("vditor-icon--current")):je==="center"?(Ye.classList.remove("vditor-icon--current"),Xe.classList.remove("vditor-icon--current"),Ne.classList.add("vditor-icon--current")):(Ne.classList.remove("vditor-icon--current"),Xe.classList.remove("vditor-icon--current"),Ye.classList.add("vditor-icon--current")),(0,U.jl)(n),rt(t)},$e=(0,y._Y)(i,"TD"),ke=(0,y._Y)(i,"TH"),ue="left";$e?ue=$e.getAttribute("align")||"left":ke&&(ue=ke.getAttribute("align")||"center");var Ye=document.createElement("button");Ye.setAttribute("type","button"),Ye.setAttribute("aria-label",window.VditorI18n.alignLeft+"<"+(0,f.fG)("⇧⌘L")+">"),Ye.setAttribute("data-type","left"),Ye.innerHTML='<svg><use xlink:href="#vditor-icon-align-left"></use></svg>',Ye.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+(ue==="left"?" vditor-icon--current":""),Ye.onclick=function(){fe("left")};var Ne=document.createElement("button");Ne.setAttribute("type","button"),Ne.setAttribute("aria-label",window.VditorI18n.alignCenter+"<"+(0,f.fG)("⇧⌘C")+">"),Ne.setAttribute("data-type","center"),Ne.innerHTML='<svg><use xlink:href="#vditor-icon-align-center"></use></svg>',Ne.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+(ue==="center"?" vditor-icon--current":""),Ne.onclick=function(){fe("center")};var Xe=document.createElement("button");Xe.setAttribute("type","button"),Xe.setAttribute("aria-label",window.VditorI18n.alignRight+"<"+(0,f.fG)("⇧⌘R")+">"),Xe.setAttribute("data-type","right"),Xe.innerHTML='<svg><use xlink:href="#vditor-icon-align-right"></use></svg>',Xe.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+(ue==="right"?" vditor-icon--current":""),Xe.onclick=function(){fe("right")};var xt=document.createElement("button");xt.setAttribute("type","button"),xt.setAttribute("aria-label",window.VditorI18n.insertRowBelow+"<"+(0,f.fG)("⌘=")+">"),xt.setAttribute("data-type","insertRow"),xt.innerHTML='<svg><use xlink:href="#vditor-icon-insert-row"></use></svg>',xt.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",xt.onclick=function(){var je=getSelection().getRangeAt(0).startContainer,pt=(0,y._Y)(je,"TD")||(0,y._Y)(je,"TH");pt&&Q(t,n,pt)};var St=document.createElement("button");St.setAttribute("type","button"),St.setAttribute("aria-label",window.VditorI18n.insertRowAbove+"<"+(0,f.fG)("⇧⌘F")+">"),St.setAttribute("data-type","insertRow"),St.innerHTML='<svg><use xlink:href="#vditor-icon-insert-rowb"></use></svg>',St.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",St.onclick=function(){var je=getSelection().getRangeAt(0).startContainer,pt=(0,y._Y)(je,"TD")||(0,y._Y)(je,"TH");pt&&ye(t,n,pt)};var Tt=document.createElement("button");Tt.setAttribute("type","button"),Tt.setAttribute("aria-label",window.VditorI18n.insertColumnRight+"<"+(0,f.fG)("⇧⌘=")+">"),Tt.setAttribute("data-type","insertColumn"),Tt.innerHTML='<svg><use xlink:href="#vditor-icon-insert-column"></use></svg>',Tt.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",Tt.onclick=function(){var je=getSelection().getRangeAt(0).startContainer,pt=(0,y._Y)(je,"TD")||(0,y._Y)(je,"TH");pt&&Ee(t,L,pt)};var pn=document.createElement("button");pn.setAttribute("type","button"),pn.setAttribute("aria-label",window.VditorI18n.insertColumnLeft+"<"+(0,f.fG)("⇧⌘G")+">"),pn.setAttribute("data-type","insertColumn"),pn.innerHTML='<svg><use xlink:href="#vditor-icon-insert-columnb"></use></svg>',pn.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",pn.onclick=function(){var je=getSelection().getRangeAt(0).startContainer,pt=(0,y._Y)(je,"TD")||(0,y._Y)(je,"TH");pt&&Ee(t,L,pt,"beforebegin")};var tn=document.createElement("button");tn.setAttribute("type","button"),tn.setAttribute("aria-label",window.VditorI18n["delete-row"]+"<"+(0,f.fG)("⌘-")+">"),tn.setAttribute("data-type","deleteRow"),tn.innerHTML='<svg><use xlink:href="#vditor-icon-delete-row"></use></svg>',tn.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",tn.onclick=function(){var je=getSelection().getRangeAt(0).startContainer,pt=(0,y._Y)(je,"TD")||(0,y._Y)(je,"TH");pt&&at(t,n,pt)};var mn=document.createElement("button");mn.setAttribute("type","button"),mn.setAttribute("aria-label",window.VditorI18n["delete-column"]+"<"+(0,f.fG)("⇧⌘-")+">"),mn.setAttribute("data-type","deleteColumn"),mn.innerHTML='<svg><use xlink:href="#vditor-icon-delete-column"></use></svg>',mn.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",mn.onclick=function(){var je=getSelection().getRangeAt(0).startContainer,pt=(0,y._Y)(je,"TD")||(0,y._Y)(je,"TH");pt&&Yt(t,n,L,pt)};var ot=document.createElement("span");ot.setAttribute("aria-label",window.VditorI18n.row),ot.className="vditor-tooltipped vditor-tooltipped__n";var Vt=document.createElement("input");ot.appendChild(Vt),Vt.type="number",Vt.min="1",Vt.className="vditor-input",Vt.style.width="42px",Vt.style.textAlign="center",Vt.setAttribute("placeholder",window.VditorI18n.row),Vt.value=L.rows.length.toString(),Vt.oninput=function(){pe()},Vt.onkeydown=function(je){if(!je.isComposing){if(je.key==="Tab"){Sn.focus(),Sn.select(),je.preventDefault();return}jt(t,je)||mt(je,n)}};var Hr=document.createElement("span");Hr.setAttribute("aria-label",window.VditorI18n.column),Hr.className="vditor-tooltipped vditor-tooltipped__n";var Sn=document.createElement("input");Hr.appendChild(Sn),Sn.type="number",Sn.min="1",Sn.className="vditor-input",Sn.style.width="42px",Sn.style.textAlign="center",Sn.setAttribute("placeholder",window.VditorI18n.column),Sn.value=L.rows[0].cells.length.toString(),Sn.oninput=function(){pe()},Sn.onkeydown=function(je){if(!je.isComposing){if(je.key==="Tab"){Vt.focus(),Vt.select(),je.preventDefault();return}jt(t,je)||mt(je,n)}},ie(n,L,t),Pe(n,L,t),Fe(L,t),t.wysiwyg.popover.insertAdjacentElement("beforeend",Ye),t.wysiwyg.popover.insertAdjacentElement("beforeend",Ne),t.wysiwyg.popover.insertAdjacentElement("beforeend",Xe),t.wysiwyg.popover.insertAdjacentElement("beforeend",St),t.wysiwyg.popover.insertAdjacentElement("beforeend",xt),t.wysiwyg.popover.insertAdjacentElement("beforeend",pn),t.wysiwyg.popover.insertAdjacentElement("beforeend",Tt),t.wysiwyg.popover.insertAdjacentElement("beforeend",tn),t.wysiwyg.popover.insertAdjacentElement("beforeend",mn),t.wysiwyg.popover.insertAdjacentElement("beforeend",ot),t.wysiwyg.popover.insertAdjacentHTML("beforeend"," x "),t.wysiwyg.popover.insertAdjacentElement("beforeend",Hr),P(t,L)}var ma=(0,y.Th)(i,"data-type","link-ref");ma&&ne(t,ma,n);var qi=(0,y.Th)(i,"data-type","footnotes-ref");if(qi){t.options.lang,t.options,t.wysiwyg.popover.innerHTML="";var ot=document.createElement("span");ot.setAttribute("aria-label",window.VditorI18n.footnoteRef+"<"+(0,f.fG)("⌥Enter")+">"),ot.className="vditor-tooltipped vditor-tooltipped__n";var ii=document.createElement("input");ot.appendChild(ii),ii.className="vditor-input",ii.setAttribute("placeholder",window.VditorI18n.footnoteRef+"<"+(0,f.fG)("⌥Enter")+">"),ii.style.width="120px",ii.value=qi.getAttribute("data-footnotes-label"),ii.oninput=function(){ii.value.trim()!==""&&qi.setAttribute("data-footnotes-label",ii.value),typeof t.options.input=="function"&&t.options.input(S(t))},ii.onkeydown=function(pt){pt.isComposing||jt(t,pt)||mt(pt,n)},Fe(qi,t),t.wysiwyg.popover.insertAdjacentElement("beforeend",ot),P(t,qi)}var Zt=(0,y.KJ)(i,"vditor-wysiwyg__block"),co=Zt?Zt.getAttribute("data-type").indexOf("block")>-1:!1;if(t.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview").forEach(function(je){if(!Zt||Zt&&co&&!Zt.contains(je)){var pt=je.previousElementSibling;pt.style.display="none"}}),Zt&&co){if(t.wysiwyg.popover.innerHTML="",ie(n,Zt,t),Pe(n,Zt,t),Fe(Zt,t),Zt.getAttribute("data-type")==="code-block"){var Nr=document.createElement("span");Nr.setAttribute("aria-label",window.VditorI18n.language+"<"+(0,f.fG)("⌥Enter")+">"),Nr.className="vditor-tooltipped vditor-tooltipped__n";var $n=document.createElement("input");Nr.appendChild($n);var mr=Zt.firstElementChild.firstElementChild;$n.className="vditor-input",$n.setAttribute("placeholder",window.VditorI18n.language+"<"+(0,f.fG)("⌥Enter")+">"),$n.value=mr.className.indexOf("language-")>-1?mr.className.split("-")[1].split(" ")[0]:"",$n.oninput=function(je){$n.value.trim()!==""?mr.className="language-".concat($n.value):(mr.className="",t.hint.recentLanguage=""),Zt.lastElementChild.classList.contains("vditor-wysiwyg__preview")&&(Zt.lastElementChild.innerHTML=Zt.firstElementChild.innerHTML,tt(Zt.lastElementChild,t)),rt(t),je.detail===1&&(n.setStart(mr.firstChild,0),n.collapse(!0),(0,U.jl)(n))},$n.onkeydown=function(je){if(!je.isComposing&&!jt(t,je)){if(je.key==="Escape"&&t.hint.element.style.display==="block"){t.hint.element.style.display="none",je.preventDefault();return}t.hint.select(je,t),mt(je,n)}},$n.onkeyup=function(je){var pt,vi;if(!(je.isComposing||je.key==="Enter"||je.key==="ArrowUp"||je.key==="Escape"||je.key==="ArrowDown")){var bi=[],gr=$n.value.substring(0,$n.selectionStart);(t.options.preview.hljs.langs||u.Y.ALIAS_CODE_LANGUAGES.concat(((vi=(pt=window.hljs)===null||pt===void 0?void 0:pt.listLanguages())!==null&&vi!==void 0?vi:[]).sort())).forEach(function(Yn){Yn.indexOf(gr.toLowerCase())>-1&&bi.push({html:Yn,value:Yn})}),t.hint.genHTML(bi,gr,t),je.preventDefault()}},t.wysiwyg.popover.insertAdjacentElement("beforeend",Nr)}P(t,Zt)}else Zt=void 0;if($){t.wysiwyg.popover.innerHTML="";var ot=document.createElement("span");ot.setAttribute("aria-label","ID<"+(0,f.fG)("⌥Enter")+">"),ot.className="vditor-tooltipped vditor-tooltipped__n";var gi=document.createElement("input");ot.appendChild(gi),gi.className="vditor-input",gi.setAttribute("placeholder","ID<"+(0,f.fG)("⌥Enter")+">"),gi.style.width="120px",gi.value=$.getAttribute("data-id")||"",gi.oninput=function(){$.setAttribute("data-id",gi.value),typeof t.options.input=="function"&&t.options.input(S(t))},gi.onkeydown=function(pt){pt.isComposing||jt(t,pt)||mt(pt,n)},ie(n,$,t),Pe(n,$,t),Fe($,t),t.wysiwyg.popover.insertAdjacentElement("beforeend",ot),P(t,$)}if(D&&Pt(t,D,n),!me&&!o&&!L&&!Zt&&!D&&!ma&&!qi&&!$&&!K){var Wi=(0,y.Th)(i,"data-block","0");Wi&&Wi.parentElement.isEqualNode(t.wysiwyg.element)?(t.wysiwyg.popover.innerHTML="",ie(n,Wi,t),Pe(n,Wi,t),Fe(Wi,t),P(t,Wi)):t.wysiwyg.popover.style.display="none"}t.wysiwyg.element.querySelectorAll('span[data-type="backslash"] > span').forEach(function(je){je.style.display="none"});var uo=(0,y.Th)(n.startContainer,"data-type","backslash");uo&&(uo.querySelector("span").style.display="inline")}},200)},P=function(t,n){var i=n,a=(0,y._Y)(n,"TABLE");a&&(i=a),t.wysiwyg.popover.style.left="0",t.wysiwyg.popover.style.display="block",t.wysiwyg.popover.style.top=Math.max(-8,i.offsetTop-21-t.wysiwyg.element.scrollTop)+"px",t.wysiwyg.popover.style.left=Math.min(i.offsetLeft,t.wysiwyg.element.clientWidth-t.wysiwyg.popover.clientWidth)+"px",t.wysiwyg.popover.setAttribute("data-top",(i.offsetTop-21).toString())},ne=function(t,n,i){i===void 0&&(i=getSelection().getRangeAt(0)),t.wysiwyg.popover.innerHTML="";var a=function(){c.value.trim()!==""&&(n.tagName==="IMG"?n.setAttribute("alt",c.value):n.textContent=c.value),A.value.trim()!==""&&n.setAttribute("data-link-label",A.value),typeof t.options.input=="function"&&t.options.input(S(t))},o=document.createElement("span");o.setAttribute("aria-label",window.VditorI18n.textIsNotEmpty),o.className="vditor-tooltipped vditor-tooltipped__n";var c=document.createElement("input");o.appendChild(c),c.className="vditor-input",c.setAttribute("placeholder",window.VditorI18n.textIsNotEmpty),c.style.width="120px",c.value=n.getAttribute("alt")||n.textContent,c.oninput=function(){a()},c.onkeydown=function(D){jt(t,D)||mt(D,i)||et(t,n,D,A)};var x=document.createElement("span");x.setAttribute("aria-label",window.VditorI18n.linkRef),x.className="vditor-tooltipped vditor-tooltipped__n";var A=document.createElement("input");x.appendChild(A),A.className="vditor-input",A.setAttribute("placeholder",window.VditorI18n.linkRef),A.value=n.getAttribute("data-link-label"),A.oninput=function(){a()},A.onkeydown=function(D){jt(t,D)||mt(D,i)||et(t,n,D,c)},Fe(n,t),t.wysiwyg.popover.insertAdjacentElement("beforeend",o),t.wysiwyg.popover.insertAdjacentElement("beforeend",x),P(t,n)},ie=function(t,n,i){var a=n.previousElementSibling;if(!(!a||!n.parentElement.isEqualNode(i.wysiwyg.element)&&n.tagName!=="LI")){var o=document.createElement("button");o.setAttribute("type","button"),o.setAttribute("data-type","up"),o.setAttribute("aria-label",window.VditorI18n.up+"<"+(0,f.fG)("⇧⌘U")+">"),o.innerHTML='<svg><use xlink:href="#vditor-icon-up"></use></svg>',o.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",o.onclick=function(){t.insertNode(document.createElement("wbr")),a.insertAdjacentElement("beforebegin",n),(0,U.ir)(i.wysiwyg.element,t),rt(i),q(i),Ge(i)},i.wysiwyg.popover.insertAdjacentElement("beforeend",o)}},Pe=function(t,n,i){var a=n.nextElementSibling;if(!(!a||!n.parentElement.isEqualNode(i.wysiwyg.element)&&n.tagName!=="LI")){var o=document.createElement("button");o.setAttribute("type","button"),o.setAttribute("data-type","down"),o.setAttribute("aria-label",window.VditorI18n.down+"<"+(0,f.fG)("⇧⌘D")+">"),o.innerHTML='<svg><use xlink:href="#vditor-icon-down"></use></svg>',o.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",o.onclick=function(){t.insertNode(document.createElement("wbr")),a.insertAdjacentElement("afterend",n),(0,U.ir)(i.wysiwyg.element,t),rt(i),q(i),Ge(i)},i.wysiwyg.popover.insertAdjacentElement("beforeend",o)}},Fe=function(t,n){var i=document.createElement("button");i.setAttribute("type","button"),i.setAttribute("data-type","remove"),i.setAttribute("aria-label",window.VditorI18n.remove+"<"+(0,f.fG)("⇧⌘X")+">"),i.innerHTML='<svg><use xlink:href="#vditor-icon-trashcan"></use></svg>',i.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",i.onclick=function(){var a=(0,U.RN)(n);a.setStartAfter(t),(0,U.jl)(a),t.remove(),rt(n),q(n),["H1","H2","H3","H4","H5","H6"].includes(t.tagName)&&oe(n)},n.wysiwyg.popover.insertAdjacentElement("beforeend",i)},et=function(t,n,i,a){if(!i.isComposing){if(i.key==="Tab"){a.focus(),a.select(),i.preventDefault();return}if(!(0,f._0)(i)&&!i.shiftKey&&i.altKey&&i.key==="Enter"){var o=(0,U.RN)(t);n.insertAdjacentHTML("afterend",u.Y.ZWSP),o.setStartAfter(n.nextSibling),o.collapse(!0),(0,U.jl)(o),i.preventDefault()}}},Pt=function(t,n,i){t.wysiwyg.popover.innerHTML="";var a=function(){c.value.trim()!==""&&(n.innerHTML=c.value),n.setAttribute("href",A.value),n.setAttribute("title",L.value),rt(t)};n.querySelectorAll("[data-marker]").forEach(function($){$.removeAttribute("data-marker")});var o=document.createElement("span");o.setAttribute("aria-label",window.VditorI18n.textIsNotEmpty),o.className="vditor-tooltipped vditor-tooltipped__n";var c=document.createElement("input");o.appendChild(c),c.className="vditor-input",c.setAttribute("placeholder",window.VditorI18n.textIsNotEmpty),c.style.width="120px",c.value=n.innerHTML||"",c.oninput=function(){a()},c.onkeydown=function($){jt(t,$)||mt($,i)||et(t,n,$,A)};var x=document.createElement("span");x.setAttribute("aria-label",window.VditorI18n.link),x.className="vditor-tooltipped vditor-tooltipped__n";var A=document.createElement("input");x.appendChild(A),A.className="vditor-input",A.setAttribute("placeholder",window.VditorI18n.link),A.value=n.getAttribute("href")||"",A.oninput=function(){a()},A.onkeydown=function($){jt(t,$)||mt($,i)||et(t,n,$,L)};var D=document.createElement("span");D.setAttribute("aria-label",window.VditorI18n.tooltipText),D.className="vditor-tooltipped vditor-tooltipped__n";var L=document.createElement("input");D.appendChild(L),L.className="vditor-input",L.setAttribute("placeholder",window.VditorI18n.tooltipText),L.style.width="60px",L.value=n.getAttribute("title")||"",L.oninput=function(){a()},L.onkeydown=function($){jt(t,$)||mt($,i)||et(t,n,$,c)},Fe(n,t),t.wysiwyg.popover.insertAdjacentElement("beforeend",o),t.wysiwyg.popover.insertAdjacentElement("beforeend",x),t.wysiwyg.popover.insertAdjacentElement("beforeend",D),P(t,n)},ge=function(t,n){var i=t.target;n.wysiwyg.popover.innerHTML="";var a=function(){i.setAttribute("src",c.value),i.setAttribute("alt",A.value),i.setAttribute("title",L.value),typeof n.options.input=="function"&&n.options.input(S(n))},o=document.createElement("span");o.setAttribute("aria-label",window.VditorI18n.imageURL),o.className="vditor-tooltipped vditor-tooltipped__n";var c=document.createElement("input");o.appendChild(c),c.className="vditor-input",c.setAttribute("placeholder",window.VditorI18n.imageURL),c.value=i.getAttribute("src")||"",c.oninput=function(){a()},c.onkeydown=function($){jt(n,$)};var x=document.createElement("span");x.setAttribute("aria-label",window.VditorI18n.alternateText),x.className="vditor-tooltipped vditor-tooltipped__n";var A=document.createElement("input");x.appendChild(A),A.className="vditor-input",A.setAttribute("placeholder",window.VditorI18n.alternateText),A.style.width="52px",A.value=i.getAttribute("alt")||"",A.oninput=function(){a()},A.onkeydown=function($){jt(n,$)};var D=document.createElement("span");D.setAttribute("aria-label",window.VditorI18n.title),D.className="vditor-tooltipped vditor-tooltipped__n";var L=document.createElement("input");D.appendChild(L),L.className="vditor-input",L.setAttribute("placeholder",window.VditorI18n.title),L.value=i.getAttribute("title")||"",L.oninput=function(){a()},L.onkeydown=function($){jt(n,$)},Fe(i,n),n.wysiwyg.popover.insertAdjacentElement("beforeend",o),n.wysiwyg.popover.insertAdjacentElement("beforeend",x),n.wysiwyg.popover.insertAdjacentElement("beforeend",D),P(n,i)},mt=function(t,n){if(!(0,f._0)(t)&&!t.shiftKey&&t.key==="Enter"||t.key==="Escape")return n&&(0,U.jl)(n),t.preventDefault(),t.stopPropagation(),!0},gt=function(t){t.currentMode==="wysiwyg"?q(t):t.currentMode==="ir"&&an(t)},_t=function(t,n,i){i===void 0&&(i={enableAddUndoStack:!0,enableHint:!1,enableInput:!0});var a=t.wysiwyg.element;a.innerHTML=t.lute.Md2VditorDOM(n),a.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach(function(o){tt(o,t),o.previousElementSibling.setAttribute("style","display:none")}),rt(t,i)},wn=function(t,n,i){for(var a=t.startContainer.parentElement,o=!1,c="",x="",A=un(t),D=A.beforeHTML,L=A.afterHTML;a&&!o;){var $=a.tagName;if($==="STRIKE"&&($="S"),$==="I"&&($="EM"),$==="B"&&($="STRONG"),$==="S"||$==="STRONG"||$==="EM"){var K="",me="",pe="";a.parentElement.getAttribute("data-block")!=="0"&&(me=fn(a),pe=on(a)),(D||me)&&(K="".concat(me,"<").concat($,">").concat(D,"</").concat($,">"),D=K),(i==="bold"&&$==="STRONG"||i==="italic"&&$==="EM"||i==="strikeThrough"&&$==="S")&&(K+="".concat(c).concat(u.Y.ZWSP,"<wbr>").concat(x),o=!0),(L||pe)&&(L="<".concat($,">").concat(L,"</").concat($,">").concat(pe),K+=L),a.parentElement.getAttribute("data-block")!=="0"?(a=a.parentElement,a.innerHTML=K):(a.outerHTML=K,a=a.parentElement),c="<".concat($,">")+c,x="</".concat($,">")+x}else o=!0}(0,U.ir)(n.wysiwyg.element,t)},An=function(t,n,i){if(!(t.wysiwyg.composingLock&&i instanceof CustomEvent)){var a=!0,o=!0;t.wysiwyg.element.querySelector("wbr")&&t.wysiwyg.element.querySelector("wbr").remove();var c=(0,U.RN)(t),x=n.getAttribute("data-type");if(n.classList.contains("vditor-menu--current"))if(x==="strike"&&(x="strikeThrough"),x==="quote"){var A=(0,y._Y)(c.startContainer,"BLOCKQUOTE");A||(A=c.startContainer.childNodes[c.startOffset]),A&&(a=!1,n.classList.remove("vditor-menu--current"),c.insertNode(document.createElement("wbr")),A.outerHTML=A.innerHTML.trim()===""?'<p data-block="0">'.concat(A.innerHTML,"</p>"):A.innerHTML,(0,U.ir)(t.wysiwyg.element,c))}else if(x==="inline-code"){var D=(0,y._Y)(c.startContainer,"CODE");D||(D=c.startContainer.childNodes[c.startOffset]),D&&(D.outerHTML=D.innerHTML.replace(u.Y.ZWSP,"")+"<wbr>",(0,U.ir)(t.wysiwyg.element,c))}else x==="link"?(c.collapsed&&c.selectNode(c.startContainer.parentElement),document.execCommand("unlink",!1,"")):x==="check"||x==="list"||x==="ordered-list"?(_i(t,c,x),(0,U.ir)(t.wysiwyg.element,c),a=!1,n.classList.remove("vditor-menu--current")):(a=!1,n.classList.remove("vditor-menu--current"),c.toString()===""?wn(c,t,x):document.execCommand(x,!1,""));else{t.wysiwyg.element.childNodes.length===0&&(t.wysiwyg.element.innerHTML='<p data-block="0"><wbr></p>',(0,U.ir)(t.wysiwyg.element,c));var L=(0,y.pt)(c.startContainer);if(x==="quote"){if(L||(L=c.startContainer.childNodes[c.startOffset]),L){a=!1,n.classList.add("vditor-menu--current"),c.insertNode(document.createElement("wbr"));var $=(0,y._Y)(c.startContainer,"LI");$&&L.contains($)?$.innerHTML='<blockquote data-block="0">'.concat($.innerHTML,"</blockquote>"):L.outerHTML='<blockquote data-block="0">'.concat(L.outerHTML,"</blockquote>"),(0,U.ir)(t.wysiwyg.element,c)}}else if(x==="check"||x==="list"||x==="ordered-list")_i(t,c,x,!1),(0,U.ir)(t.wysiwyg.element,c),a=!1,g(t.toolbar.elements,["check","list","ordered-list"]),n.classList.add("vditor-menu--current");else if(x==="inline-code"){if(c.toString()===""){var K=document.createElement("code");K.textContent=u.Y.ZWSP,c.insertNode(K),c.setStart(K.firstChild,1),c.collapse(!0),(0,U.jl)(c)}else if(c.startContainer.nodeType===3){var K=document.createElement("code");c.surroundContents(K),c.insertNode(K),(0,U.jl)(c)}n.classList.add("vditor-menu--current")}else if(x==="code"){var K=document.createElement("div");K.className="vditor-wysiwyg__block",K.setAttribute("data-type","code-block"),K.setAttribute("data-block","0"),K.setAttribute("data-marker","```"),c.toString()===""?K.innerHTML=`<pre><code><wbr>
</code></pre>`:(K.innerHTML="<pre><code>".concat(c.toString(),"<wbr></code></pre>"),c.deleteContents()),c.insertNode(K),L&&(L.outerHTML=t.lute.SpinVditorDOM(L.outerHTML)),(0,U.ir)(t.wysiwyg.element,c),t.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach(function(xt){tt(xt,t)}),n.classList.add("vditor-menu--disabled")}else if(x==="link"){if(c.toString()===""){var me=document.createElement("a");me.innerText=u.Y.ZWSP,c.insertNode(me),c.setStart(me.firstChild,1),c.collapse(!0),Pt(t,me,c);var pe=t.wysiwyg.popover.querySelector("input");pe.value="",pe.focus(),o=!1}else{var K=document.createElement("a");K.setAttribute("href",""),K.innerHTML=c.toString(),c.surroundContents(K),c.insertNode(K),(0,U.jl)(c),Pt(t,K,c);var fe=t.wysiwyg.popover.querySelectorAll("input");fe[0].value=K.innerText,fe[1].focus()}a=!1,n.classList.add("vditor-menu--current")}else if(x==="table"){var $e='<table data-block="0"><thead><tr><th>col1<wbr></th><th>col2</th><th>col3</th></tr></thead><tbody><tr><td> </td><td> </td><td> </td></tr><tr><td> </td><td> </td><td> </td></tr></tbody></table>';if(c.toString().trim()==="")L&&L.innerHTML.trim().replace(u.Y.ZWSP,"")===""?L.outerHTML=$e:document.execCommand("insertHTML",!1,$e),c.selectNode(t.wysiwyg.element.querySelector("wbr").previousSibling),t.wysiwyg.element.querySelector("wbr").remove(),(0,U.jl)(c);else{$e='<table data-block="0"><thead><tr>';var ke=c.toString().split(`
`),ue=ke[0].split(",").length>ke[0].split("	").length?",":"	";ke.forEach(function(Xe,xt){xt===0?(Xe.split(ue).forEach(function(St,Tt){Tt===0?$e+="<th>".concat(St,"<wbr></th>"):$e+="<th>".concat(St,"</th>")}),$e+="</tr></thead>"):(xt===1?$e+="<tbody><tr>":$e+="<tr>",Xe.split(ue).forEach(function(St){$e+="<td>".concat(St,"</td>")}),$e+="</tr>")}),$e+="</tbody></table>",document.execCommand("insertHTML",!1,$e),(0,U.ir)(t.wysiwyg.element,c)}a=!1,n.classList.add("vditor-menu--disabled")}else if(x==="line"){if(L){var Ye=`<hr data-block="0"><p data-block="0"><wbr>
</p>`;L.innerHTML.trim()===""?L.outerHTML=Ye:L.insertAdjacentHTML("afterend",Ye),(0,U.ir)(t.wysiwyg.element,c)}}else if(a=!1,n.classList.add("vditor-menu--current"),x==="strike"&&(x="strikeThrough"),c.toString()===""&&(x==="bold"||x==="italic"||x==="strikeThrough")){var Ne="strong";x==="italic"?Ne="em":x==="strikeThrough"&&(Ne="s");var K=document.createElement(Ne);K.textContent=u.Y.ZWSP,c.insertNode(K),K.previousSibling&&K.previousSibling.textContent===u.Y.ZWSP&&(K.previousSibling.textContent=""),c.setStart(K.firstChild,1),c.collapse(!0),(0,U.jl)(c)}else document.execCommand(x,!1,"")}a&&q(t),o&&rt(t)}},vt=function(){function t(n,i){var a,o=this;this.element=document.createElement("div"),i.className&&(a=this.element.classList).add.apply(a,i.className.split(" "));var c=i.hotkey?" <".concat((0,f.fG)(i.hotkey),">"):"";i.level===2&&(c=i.hotkey?" &lt;".concat((0,f.fG)(i.hotkey),"&gt;"):"");var x=i.tip?i.tip+c:"".concat(window.VditorI18n[i.name]).concat(c),A=i.name==="upload"?"div":"button";if(i.level===2)this.element.innerHTML="<".concat(A,' data-type="').concat(i.name,'">').concat(x,"</").concat(A,">");else{this.element.classList.add("vditor-toolbar__item");var D=document.createElement(A);D.setAttribute("data-type",i.name),D.className="vditor-tooltipped vditor-tooltipped__".concat(i.tipPosition),D.setAttribute("aria-label",x),D.innerHTML=i.icon,this.element.appendChild(D)}i.prefix&&this.element.children[0].addEventListener((0,f.y3)(),function(L){L.preventDefault(),!o.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)&&(n.currentMode==="wysiwyg"?An(n,o.element.children[0],L):n.currentMode==="ir"?Ws(n,o.element.children[0],i.prefix||"",i.suffix||""):Me(n,o.element.children[0],i.prefix||"",i.suffix||""))})}return t}(),Bt=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Ut=function(t,n,i){var a;if(typeof i!="string"?(T(t,["subToolbar","hint"]),i.preventDefault(),a=S(t)):a=i,!(t.currentMode===n&&typeof i!="string")){if(t.devtools&&t.devtools.renderEchart(t),t.options.preview.mode==="both"&&n==="sv"?t.preview.element.style.display="block":t.preview.element.style.display="none",k(t.toolbar.elements,u.Y.EDIT_TOOLBARS),g(t.toolbar.elements,u.Y.EDIT_TOOLBARS),w(t.toolbar.elements,["outdent","indent"]),n==="ir")_(t.toolbar.elements,["both"]),C(t.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),t.sv.element.style.display="none",t.wysiwyg.element.parentElement.style.display="none",t.ir.element.parentElement.style.display="block",t.lute.SetVditorIR(!0),t.lute.SetVditorWYSIWYG(!1),t.lute.SetVditorSV(!1),t.currentMode="ir",t.ir.element.innerHTML=t.lute.Md2VditorIRDOM(a),Wn(t,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),ft(t),t.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach(function(c){tt(c,t)}),t.ir.element.querySelectorAll(".vditor-toc").forEach(function(c){(0,de.T)(c,{cdn:t.options.cdn,math:t.options.preview.math})});else if(n==="wysiwyg")_(t.toolbar.elements,["both"]),C(t.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),t.sv.element.style.display="none",t.wysiwyg.element.parentElement.style.display="block",t.ir.element.parentElement.style.display="none",t.lute.SetVditorIR(!1),t.lute.SetVditorWYSIWYG(!0),t.lute.SetVditorSV(!1),t.currentMode="wysiwyg",ft(t),_t(t,a,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),t.wysiwyg.element.querySelectorAll(".vditor-toc").forEach(function(c){(0,de.T)(c,{cdn:t.options.cdn,math:t.options.preview.math})}),t.wysiwyg.popover.style.display="none";else if(n==="sv"){C(t.toolbar.elements,["both"]),_(t.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),t.wysiwyg.element.parentElement.style.display="none",t.ir.element.parentElement.style.display="none",(t.options.preview.mode==="both"||t.options.preview.mode==="editor")&&(t.sv.element.style.display="block"),t.lute.SetVditorIR(!1),t.lute.SetVditorWYSIWYG(!1),t.lute.SetVditorSV(!0),t.currentMode="sv";var o=xe(a,t);o==="<div data-block='0'></div>"&&(o=""),t.sv.element.innerHTML=o,st(t.sv.element),Ue(t,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),ft(t)}t.undo.resetIcon(t),typeof i!="string"&&(t[t.currentMode].element.focus(),gt(t)),oe(t),ht(t),t.toolbar.elements["edit-mode"]&&(t.toolbar.elements["edit-mode"].querySelectorAll("button").forEach(function(c){c.classList.remove("vditor-menu--current")}),t.toolbar.elements["edit-mode"].querySelector('button[data-mode="'.concat(t.currentMode,'"]')).classList.add("vditor-menu--current")),t.outline.toggle(t,t.currentMode!=="sv"&&t.options.outline.enable,typeof i!="string")}},en=function(t){Bt(n,t);function n(i,a){var o=t.call(this,i,a)||this,c=document.createElement("div");return c.className="vditor-hint".concat(a.level===2?"":" vditor-panel--arrow"),c.innerHTML='<button data-mode="wysiwyg">'.concat(window.VditorI18n.wysiwyg," &lt;").concat((0,f.fG)("⌥⌘7"),`></button>
<button data-mode="ir">`).concat(window.VditorI18n.instantRendering," &lt;").concat((0,f.fG)("⌥⌘8"),`></button>
<button data-mode="sv">`).concat(window.VditorI18n.splitView," &lt;").concat((0,f.fG)("⌥⌘9"),"></button>"),o.element.appendChild(c),o._bindEvent(i,c,a),o}return n.prototype._bindEvent=function(i,a,o){var c=this.element.children[0];M(i,a,c,o.level),a.children.item(0).addEventListener((0,f.y3)(),function(x){Ut(i,"wysiwyg",x),x.preventDefault(),x.stopPropagation()}),a.children.item(1).addEventListener((0,f.y3)(),function(x){Ut(i,"ir",x),x.preventDefault(),x.stopPropagation()}),a.children.item(2).addEventListener((0,f.y3)(),function(x){Ut(i,"sv",x),x.preventDefault(),x.stopPropagation()})},n}(vt),sn=function(t,n){return(0,U.Co)(t,n)?getSelection().toString():""},ln=function(t,n){n.addEventListener("focus",function(){t.options.focus&&t.options.focus(S(t)),T(t,["subToolbar","hint"])})},ti=function(t,n){n.addEventListener("dblclick",function(i){i.target.tagName==="IMG"&&(t.options.image.preview?t.options.image.preview(i.target):t.options.image.isPreview&&(0,ve.o)(i.target,t.options.lang,t.options.theme))})},ui=function(t,n){n.addEventListener("blur",function(i){if(t.currentMode==="ir"){var a=t.ir.element.querySelector(".vditor-ir__node--expand");a&&a.classList.remove("vditor-ir__node--expand")}else t.currentMode==="wysiwyg"&&!t.wysiwyg.selectPopover.contains(i.relatedTarget)&&t.wysiwyg.hideComment();t[t.currentMode].range=(0,U.RN)(t),t.options.blur&&t.options.blur(S(t))})},Hn=function(t,n){n.addEventListener("dragstart",function(i){i.dataTransfer.setData(u.Y.DROP_EDITOR,u.Y.DROP_EDITOR)}),n.addEventListener("drop",function(i){i.dataTransfer.getData(u.Y.DROP_EDITOR)?ct(t):(i.dataTransfer.types.includes("Files")||i.dataTransfer.types.includes("text/html"))&&hn(t,i,{pasteCode:function(a){document.execCommand("insertHTML",!1,a)}})})},zt=function(t,n,i){n.addEventListener("copy",function(a){return i(a,t)})},Wt=function(t,n,i){n.addEventListener("cut",function(a){i(a,t),t.options.comment.enable&&t.currentMode==="wysiwyg"&&t.wysiwyg.getComments(t),document.execCommand("delete")})},Ge=function(t){if(t.currentMode==="wysiwyg"&&t.options.comment.enable&&t.options.comment.adjustTop(t.wysiwyg.getComments(t,!0)),!!t.options.typewriterMode){var n=t[t.currentMode].element,i=(0,U.Ey)(n).top;t.options.height==="auto"&&!t.element.classList.contains("vditor--fullscreen")&&window.scrollTo(window.scrollX,i+t.element.offsetTop+t.toolbar.element.offsetHeight-window.innerHeight/2+10),(t.options.height!=="auto"||t.element.classList.contains("vditor--fullscreen"))&&(n.scrollTop=i+n.scrollTop-n.clientHeight/2+10)}},ut=function(t,n){n.addEventListener("keydown",function(i){if(!i.isComposing&&t.options.keydown&&t.options.keydown(i),!((t.options.hint.extend.length>1||t.toolbar.elements.emoji)&&t.hint.select(i,t))){if(t.options.comment.enable&&t.currentMode==="wysiwyg"&&(i.key==="Backspace"||X("⌘X",i))&&t.wysiwyg.getComments(t),t.currentMode==="sv"){if(Qe(t,i))return}else if(t.currentMode==="wysiwyg"){if(Ot(t,i))return}else if(t.currentMode==="ir"&&He(t,i))return;if(t.options.ctrlEnter&&X("⌘Enter",i)){t.options.ctrlEnter(S(t)),i.preventDefault();return}if(X("⌘Z",i)&&!t.toolbar.elements.undo){t.undo.undo(t),i.preventDefault();return}if(X("⌘Y",i)&&!t.toolbar.elements.redo){t.undo.redo(t),i.preventDefault();return}if(i.key==="Escape"){t.hint.element.style.display==="block"?t.hint.element.style.display="none":t.options.esc&&!i.isComposing&&t.options.esc(S(t)),i.preventDefault();return}if((0,f._0)(i)&&i.altKey&&!i.shiftKey&&/^Digit[1-6]$/.test(i.code)){if(t.currentMode==="wysiwyg"){var a=i.code.replace("Digit","H");(0,y._Y)(getSelection().getRangeAt(0).startContainer,a)?ei(t):Mt(t,a),rt(t)}else t.currentMode==="sv"?nt(t,"#".repeat(parseInt(i.code.replace("Digit",""),10))+" "):t.currentMode==="ir"&&jn(t,"#".repeat(parseInt(i.code.replace("Digit",""),10))+" ");return i.preventDefault(),!0}if((0,f._0)(i)&&i.altKey&&!i.shiftKey&&/^Digit[7-9]$/.test(i.code))return i.code==="Digit7"?Ut(t,"wysiwyg",i):i.code==="Digit8"?Ut(t,"ir",i):i.code==="Digit9"&&Ut(t,"sv",i),!0;t.options.toolbar.find(function(o){if(!o.hotkey||o.toolbar){if(o.toolbar){var c=o.toolbar.find(function(x){if(!x.hotkey)return!1;if(X(x.hotkey,i))return t.toolbar.elements[x.name].children[0].dispatchEvent(new CustomEvent((0,f.y3)())),i.preventDefault(),!0});return!!c}return!1}if(X(o.hotkey,i))return t.toolbar.elements[o.name].children[0].dispatchEvent(new CustomEvent((0,f.y3)())),i.preventDefault(),!0})}})},Gt=function(t,n){n.addEventListener("selectstart",function(i){n.onmouseup=function(){setTimeout(function(){var a=sn(t[t.currentMode].element);a.trim()?(t.currentMode==="wysiwyg"&&t.options.comment.enable&&(!(0,y.Th)(i.target,"data-type","footnotes-block")&&!(0,y.Th)(i.target,"data-type","link-ref-defs-block")?t.wysiwyg.showComment():t.wysiwyg.hideComment()),t.options.select&&t.options.select(a)):t.currentMode==="wysiwyg"&&t.options.comment.enable&&t.wysiwyg.hideComment()})}})},W=function(t,n){var i=(0,U.RN)(t);i.extractContents(),i.insertNode(document.createTextNode(Lute.Caret)),i.insertNode(document.createTextNode(n));var a=(0,y.Th)(i.startContainer,"data-block","0");a||(a=t.sv.element);var o=t.lute.SpinVditorSVDOM(a.textContent);o="<div data-block='0'>"+o.replace(/<span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span><span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span></g,`<span data-type="newline"><br /><span style="display: none">
</span></span><span data-type="newline"><br /><span style="display: none">
</span></span></div><div data-block="0"><`)+"</div>",a.isEqualNode(t.sv.element)?a.innerHTML=o:a.outerHTML=o,st(t.sv.element),(0,U.ir)(t.sv.element,i),Ge(t)},Z=function(t,n,i){i===void 0&&(i=!0);var a=t;for(a.nodeType===3&&(a=a.parentElement);a;){if(a.getAttribute("data-type")===n)return a;i?a=a.previousElementSibling:a=a.nextElementSibling}return!1},xe=function(t,n){B("SpinVditorSVDOM",t,"argument",n.options.debugger);var i=n.lute.SpinVditorSVDOM(t);return t="<div data-block='0'>"+i.replace(/<span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span><span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span></g,`<span data-type="newline"><br /><span style="display: none">
</span></span><span data-type="newline"><br /><span style="display: none">
</span></span></div><div data-block="0"><`)+"</div>",B("SpinVditorSVDOM",t,"result",n.options.debugger),t},ze=function(t){var n=t.getAttribute("data-type"),i=t.previousElementSibling,a=n&&n!=="text"&&n!=="table"&&n!=="heading-marker"&&n!=="newline"&&n!=="yaml-front-matter-open-marker"&&n!=="yaml-front-matter-close-marker"&&n!=="code-block-info"&&n!=="code-block-close-marker"&&n!=="code-block-open-marker"?t.textContent:"",o=!1;for(n==="newline"&&(o=!0);i&&!o;){var c=i.getAttribute("data-type");if(c==="li-marker"||c==="blockquote-marker"||c==="task-marker"||c==="padding"){var x=i.textContent;if(c==="li-marker"&&(n==="code-block-open-marker"||n==="code-block-info"))a=x.replace(/\S/g," ")+a;else if(n==="code-block-close-marker"&&i.nextElementSibling.isSameNode(t)){var A=Z(t,"code-block-open-marker");A&&A.previousElementSibling&&(i=A.previousElementSibling,a=x+a)}else a=x+a}else c==="newline"&&(o=!0);i=i.previousElementSibling}return a},Ue=function(t,n){n===void 0&&(n={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),n.enableHint&&t.hint.render(t),t.preview.render(t);var i=S(t);typeof t.options.input=="function"&&n.enableInput&&t.options.input(i),t.options.counter.enable&&t.counter.render(t,i),t.options.cache.enable&&(0,f.D)()&&(localStorage.setItem(t.options.cache.id,i),t.options.cache.after&&t.options.cache.after(i)),t.devtools&&t.devtools.renderEchart(t),clearTimeout(t.sv.processTimeoutId),t.sv.processTimeoutId=window.setTimeout(function(){n.enableAddUndoStack&&!t.sv.composingLock&&t.undo.addToUndoStack(t)},t.options.undoDelay)},nt=function(t,n){var i=(0,U.RN)(t),a=(0,O.f)(i.startContainer,"SPAN");a&&a.textContent.trim()!==""&&(n=`
`+n),i.collapse(!0),document.execCommand("insertHTML",!1,n)},Me=function(t,n,i,a){var o=(0,U.RN)(t),c=n.getAttribute("data-type");t.sv.element.childNodes.length===0&&(t.sv.element.innerHTML=`<span data-type="p" data-block="0"><span data-type="text"><wbr></span></span><span data-type="newline"><br><span style="display: none">
</span></span>`,(0,U.ir)(t.sv.element,o));var x=(0,y.pt)(o.startContainer),A=(0,O.f)(o.startContainer,"SPAN");if(x){if(c==="link"){var D=void 0;o.toString()===""?D="".concat(i).concat(Lute.Caret).concat(a):D="".concat(i).concat(o.toString()).concat(a.replace(")",Lute.Caret+")")),document.execCommand("insertHTML",!1,D);return}else if(c==="italic"||c==="bold"||c==="strike"||c==="inline-code"||c==="code"||c==="table"||c==="line"){var D=void 0;o.toString()===""?D="".concat(i).concat(Lute.Caret).concat(c==="code"?"":a):D="".concat(i).concat(o.toString()).concat(Lute.Caret).concat(c==="code"?"":a),c==="table"||c==="code"&&A&&A.textContent!==""?D=`

`+D:c==="line"&&(D=`

`.concat(i,`
`).concat(Lute.Caret)),document.execCommand("insertHTML",!1,D);return}else if((c==="check"||c==="list"||c==="ordered-list"||c==="quote")&&A){var L="* ";c==="check"?L="* [ ] ":c==="ordered-list"?L="1. ":c==="quote"&&(L="> ");var $=Z(A,"newline");$?$.insertAdjacentText("afterend",L):x.insertAdjacentText("afterbegin",L),Ve(t);return}(0,U.ir)(t.sv.element,o),Ue(t)}},Rt=function(t){switch(t.currentMode){case"ir":return t.ir.element;case"wysiwyg":return t.wysiwyg.element;case"sv":return t.sv.element}},Xt=function(t,n){t.options.upload.setHeaders&&(t.options.upload.headers=t.options.upload.setHeaders()),t.options.upload.headers&&Object.keys(t.options.upload.headers).forEach(function(i){n.setRequestHeader(i,t.options.upload.headers[i])})},Ct=function(t,n,i,a){function o(c){return c instanceof i?c:new i(function(x){x(c)})}return new(i||(i=Promise))(function(c,x){function A($){try{L(a.next($))}catch(K){x(K)}}function D($){try{L(a.throw($))}catch(K){x(K)}}function L($){$.done?c($.value):o($.value).then(A,D)}L((a=a.apply(t,n||[])).next())})},Ln=function(t,n){var i={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},a,o,c,x;return x={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function A(L){return function($){return D([L,$])}}function D(L){if(a)throw new TypeError("Generator is already executing.");for(;x&&(x=0,L[0]&&(i=0)),i;)try{if(a=1,o&&(c=L[0]&2?o.return:L[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,L[1])).done)return c;switch(o=0,c&&(L=[L[0]&2,c.value]),L[0]){case 0:case 1:c=L;break;case 4:return i.label++,{value:L[1],done:!1};case 5:i.label++,o=L[1],L=[0];continue;case 7:L=i.ops.pop(),i.trys.pop();continue;default:if(c=i.trys,!(c=c.length>0&&c[c.length-1])&&(L[0]===6||L[0]===2)){i=0;continue}if(L[0]===3&&(!c||L[1]>c[0]&&L[1]<c[3])){i.label=L[1];break}if(L[0]===6&&i.label<c[1]){i.label=c[1],c=L;break}if(c&&i.label<c[2]){i.label=c[2],i.ops.push(L);break}c[2]&&i.ops.pop(),i.trys.pop();continue}L=n.call(t,i)}catch($){L=[6,$],o=0}finally{a=c=0}if(L[0]&5)throw L[1];return{value:L[0]?L[1]:void 0,done:!0}}},Vn=function(){function t(){this.isUploading=!1,this.element=document.createElement("div"),this.element.className="vditor-upload"}return t}(),di=function(t,n){t.tip.hide();var i=[],a="",o="";t.options.lang,t.options;for(var c=function(D,L){var $=n[L],K=!0;$.name||(a+="<li>".concat(window.VditorI18n.nameEmpty,"</li>"),K=!1),$.size>t.options.upload.max&&(a+="<li>".concat($.name," ").concat(window.VditorI18n.over," ").concat(t.options.upload.max/1024/1024,"M</li>"),K=!1);var me=$.name.lastIndexOf("."),pe=$.name.substr(me),fe=t.options.upload.filename($.name.substr(0,me))+pe;if(t.options.upload.accept){var $e=t.options.upload.accept.split(",").some(function(ke){var ue=ke.trim();if(ue.indexOf(".")===0){if(pe.toLowerCase()===ue.toLowerCase())return!0}else if($.type.split("/")[0]===ue.split("/")[0])return!0;return!1});$e||(a+="<li>".concat($.name," ").concat(window.VditorI18n.fileTypeError,"</li>"),K=!1)}K&&(i.push($),o+="<li>".concat(fe," ").concat(window.VditorI18n.uploading,"</li>"))},x=n.length,A=0;A<x;A++)c(x,A);return t.tip.show("<ul>".concat(a).concat(o,"</ul>")),i},ki=function(t,n){var i=Rt(n);i.focus();var a=JSON.parse(t),o="";a.code===1&&(o="".concat(a.msg)),a.data.errFiles&&a.data.errFiles.length>0&&(o="<ul><li>".concat(o,"</li>"),a.data.errFiles.forEach(function(x){var A=x.lastIndexOf("."),D=n.options.upload.filename(x.substr(0,A))+x.substr(A);o+="<li>".concat(D," ").concat(window.VditorI18n.uploadError,"</li>")}),o+="</ul>"),o?n.tip.show(o):n.tip.hide();var c="";Object.keys(a.data.succMap).forEach(function(x){var A=a.data.succMap[x],D=x.lastIndexOf("."),L=x.substr(D),$=n.options.upload.filename(x.substr(0,D))+L;L=L.toLowerCase(),L.indexOf(".wav")===0||L.indexOf(".mp3")===0||L.indexOf(".ogg")===0?n.currentMode==="wysiwyg"?c+=`<div class="vditor-wysiwyg__block" data-type="html-block"
 data-block="0"><pre><code>&lt;audio controls="controls" src="`.concat(A,'"&gt;&lt;/audio&gt;</code></pre><pre class="vditor-wysiwyg__preview" data-render="1"><audio controls="controls" src="').concat(A,`"></audio></pre></div>
`):n.currentMode==="ir"?c+='<audio controls="controls" src="'.concat(A,`"></audio>
`):c+="[".concat($,"](").concat(A,`)
`):L.indexOf(".apng")===0||L.indexOf(".bmp")===0||L.indexOf(".gif")===0||L.indexOf(".ico")===0||L.indexOf(".cur")===0||L.indexOf(".jpg")===0||L.indexOf(".jpeg")===0||L.indexOf(".jfif")===0||L.indexOf(".pjp")===0||L.indexOf(".pjpeg")===0||L.indexOf(".png")===0||L.indexOf(".svg")===0||L.indexOf(".webp")===0?n.currentMode==="wysiwyg"?c+='<img alt="'.concat($,'" src="').concat(A,`">
`):c+="![".concat($,"](").concat(A,`)
`):n.currentMode==="wysiwyg"?c+='<a href="'.concat(A,'">').concat($,`</a>
`):c+="[".concat($,"](").concat(A,`)
`)}),(0,U.jl)(n.upload.range),document.execCommand("insertHTML",!1,c),n.upload.range=getSelection().getRangeAt(0).cloneRange()},Nn=function(t,n,i){return Ct(void 0,void 0,void 0,function(){var a,o,fe,c,x,x,A,D,L,$,K,me,pe,fe,$e,ke;return Ln(this,function(ue){switch(ue.label){case 0:for(a=[],o=t.options.upload.multiple===!0?n.length:1,fe=0;fe<o;fe++)c=n[fe],c instanceof DataTransferItem&&(c=c.getAsFile()),a.push(c);return t.options.upload.handler?[4,t.options.upload.handler(a)]:[3,2];case 1:return x=ue.sent(),i&&(i.value=""),typeof x=="string"?(t.tip.show(x),[2]):[2];case 2:return!t.options.upload.url||!t.upload?(i&&(i.value=""),t.tip.show("please config: options.upload.url"),[2]):t.options.upload.file?[4,t.options.upload.file(a)]:[3,4];case 3:a=ue.sent(),ue.label=4;case 4:if(t.options.upload.validate&&(x=t.options.upload.validate(a),typeof x=="string"))return t.tip.show(x),[2];if(A=Rt(t),t.upload.range=(0,U.RN)(t),D=di(t,a),D.length===0)return i&&(i.value=""),[2];for(L=new FormData,$=t.options.upload.extraData,K=0,me=Object.keys($);K<me.length;K++)pe=me[K],L.append(pe,$[pe]);for(fe=0,$e=D.length;fe<$e;fe++)L.append(t.options.upload.fieldName,D[fe]);return ke=new XMLHttpRequest,ke.open("POST",t.options.upload.url),t.options.upload.token&&ke.setRequestHeader("X-Upload-Token",t.options.upload.token),t.options.upload.withCredentials&&(ke.withCredentials=!0),Xt(t,ke),t.upload.isUploading=!0,A.setAttribute("contenteditable","false"),ke.onreadystatechange=function(){if(ke.readyState===XMLHttpRequest.DONE){if(t.upload.isUploading=!1,A.setAttribute("contenteditable","true"),ke.status>=200&&ke.status<300)if(t.options.upload.success)t.options.upload.success(A,ke.responseText);else{var Ye=ke.responseText;t.options.upload.format&&(Ye=t.options.upload.format(n,ke.responseText)),ki(Ye,t)}else t.options.upload.error?t.options.upload.error(ke.responseText):t.tip.show(ke.responseText);i&&(i.value=""),t.upload.element.style.display="none"}},ke.upload.onprogress=function(Ye){if(Ye.lengthComputable){var Ne=Ye.loaded/Ye.total*100;t.upload.element.style.display="block";var Xe=t.upload.element;Xe.style.width=Ne+"%"}},ke.send(L),[2]}})})},Si=function(t,n,i){var a,o=(0,y.pt)(n.startContainer);if(o||(o=t.wysiwyg.element),i&&i.inputType!=="formatItalic"&&i.inputType!=="deleteByDrag"&&i.inputType!=="insertFromDrop"&&i.inputType!=="formatBold"&&i.inputType!=="formatRemove"&&i.inputType!=="formatStrikeThrough"&&i.inputType!=="insertUnorderedList"&&i.inputType!=="insertOrderedList"&&i.inputType!=="formatOutdent"&&i.inputType!=="formatIndent"&&i.inputType!==""||!i){var c=Kt(n.startContainer);c&&c.remove(),t.wysiwyg.element.querySelectorAll("wbr").forEach(function(Ne){Ne.remove()}),n.insertNode(document.createElement("wbr")),o.querySelectorAll("[style]").forEach(function(Ne){Ne.removeAttribute("style")}),o.querySelectorAll(".vditor-comment").forEach(function(Ne){Ne.textContent.trim()===""&&(Ne.classList.remove("vditor-comment","vditor-comment--focus"),Ne.removeAttribute("data-cmtids"))}),(a=o.previousElementSibling)===null||a===void 0||a.querySelectorAll(".vditor-comment").forEach(function(Ne){Ne.textContent.trim()===""&&(Ne.classList.remove("vditor-comment","vditor-comment--focus"),Ne.removeAttribute("data-cmtids"))});var x="";o.getAttribute("data-type")==="link-ref-defs-block"&&(o=t.wysiwyg.element);var A=o.isEqualNode(t.wysiwyg.element),D=(0,y.Th)(o,"data-type","footnotes-block");if(A)x=o.innerHTML;else{var L=(0,y.KR)(n.startContainer);if(L&&!D){var $=(0,O.f)(n.startContainer,"BLOCKQUOTE");$?o=(0,y.pt)(n.startContainer)||o:o=L}if(D&&(o=D),x=o.outerHTML,o.tagName==="UL"||o.tagName==="OL"){var K=o.previousElementSibling,me=o.nextElementSibling;K&&(K.tagName==="UL"||K.tagName==="OL")&&(x=K.outerHTML+x,K.remove()),me&&(me.tagName==="UL"||me.tagName==="OL")&&(x=x+me.outerHTML,me.remove()),x=x.replace("<div><wbr><br></div>","<li><p><wbr><br></p></li>")}o.innerText.startsWith("```")||(t.wysiwyg.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(Ne){Ne&&!o.isEqualNode(Ne)&&(x+=Ne.outerHTML,Ne.remove())}),t.wysiwyg.element.querySelectorAll("[data-type='footnotes-block']").forEach(function(Ne){Ne&&!o.isEqualNode(Ne)&&(x+=Ne.outerHTML,Ne.remove())}))}if(x=x.replace(/<\/(strong|b)><strong data-marker="\W{2}">/g,"").replace(/<\/(em|i)><em data-marker="\W{1}">/g,"").replace(/<\/(s|strike)><s data-marker="~{1,2}">/g,""),x==='<p data-block="0">```<wbr></p>'&&t.hint.recentLanguage&&(x='<p data-block="0">```<wbr></p>'.replace("```","```"+t.hint.recentLanguage)),B("SpinVditorDOM",x,"argument",t.options.debugger),x=t.lute.SpinVditorDOM(x),B("SpinVditorDOM",x,"result",t.options.debugger),A)o.innerHTML=x;else if(o.outerHTML=x,D){var pe=(0,y.Ab)(t.wysiwyg.element.querySelector("wbr"),"LI");if(pe){var fe=t.wysiwyg.element.querySelector('sup[data-type="footnotes-ref"][data-footnotes-label="'.concat(pe.getAttribute("data-marker"),'"]'));fe&&fe.setAttribute("aria-label",pe.textContent.trim().substr(0,24))}}var $e,ke=t.wysiwyg.element.querySelectorAll("[data-type='link-ref-defs-block']");ke.forEach(function(Ne,Xe){Xe===0?$e=Ne:($e.insertAdjacentHTML("beforeend",Ne.innerHTML),Ne.remove())}),ke.length>0&&t.wysiwyg.element.insertAdjacentElement("beforeend",ke[0]);var ue,Ye=t.wysiwyg.element.querySelectorAll("[data-type='footnotes-block']");Ye.forEach(function(Ne,Xe){Xe===0?ue=Ne:(ue.insertAdjacentHTML("beforeend",Ne.innerHTML),Ne.remove())}),Ye.length>0&&t.wysiwyg.element.insertAdjacentElement("beforeend",Ye[0]),(0,U.ir)(t.wysiwyg.element,n),t.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach(function(Ne){tt(Ne,t)}),i&&(i.inputType==="deleteContentBackward"||i.inputType==="deleteContentForward")&&t.options.comment.enable&&(t.wysiwyg.triggerRemoveComment(t),t.options.comment.adjustTop(t.wysiwyg.getComments(t,!0)))}oe(t),rt(t,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},Dr=function(t,n){return Object.defineProperty?Object.defineProperty(t,"raw",{value:n}):t.raw=n,t},lr=function(t,n,i,a){function o(c){return c instanceof i?c:new i(function(x){x(c)})}return new(i||(i=Promise))(function(c,x){function A($){try{L(a.next($))}catch(K){x(K)}}function D($){try{L(a.throw($))}catch(K){x(K)}}function L($){$.done?c($.value):o($.value).then(A,D)}L((a=a.apply(t,n||[])).next())})},ha=function(t,n){var i={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},a,o,c,x;return x={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function A(L){return function($){return D([L,$])}}function D(L){if(a)throw new TypeError("Generator is already executing.");for(;x&&(x=0,L[0]&&(i=0)),i;)try{if(a=1,o&&(c=L[0]&2?o.return:L[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,L[1])).done)return c;switch(o=0,c&&(L=[L[0]&2,c.value]),L[0]){case 0:case 1:c=L;break;case 4:return i.label++,{value:L[1],done:!1};case 5:i.label++,o=L[1],L=[0];continue;case 7:L=i.ops.pop(),i.trys.pop();continue;default:if(c=i.trys,!(c=c.length>0&&c[c.length-1])&&(L[0]===6||L[0]===2)){i=0;continue}if(L[0]===3&&(!c||L[1]>c[0]&&L[1]<c[3])){i.label=L[1];break}if(L[0]===6&&i.label<c[1]){i.label=c[1],c=L;break}if(c&&i.label<c[2]){i.label=c[2],i.ops.push(L);break}c[2]&&i.ops.pop(),i.trys.pop();continue}L=n.call(t,i)}catch($){L=[6,$],o=0}finally{a=c=0}if(L[0]&5)throw L[1];return{value:L[0]?L[1]:void 0,done:!0}}},Or=function(t,n,i){if(t.keyCode===229&&t.code===""&&t.key==="Unidentified"&&n.currentMode!=="sv"){var a=(0,y.pt)(i);if(a&&a.textContent.trim()==="")return n[n.currentMode].composingLock=!0,!1}return!0},cr=function(t,n,i){if(!(i.key==="Enter"||i.key==="Tab"||i.key==="Backspace"||i.key.indexOf("Arrow")>-1||(0,f._0)(i)||i.key==="Escape"||i.shiftKey||i.altKey)){var a=(0,y._Y)(t.startContainer,"P")||(0,y._Y)(t.startContainer,"LI");if(a&&(0,U.ED)(a,n[n.currentMode].element,t).start===0){a.nodeValue&&(a.nodeValue=a.nodeValue.replace(/\u2006/g,""));var o=document.createTextNode(u.Y.ZWSP);t.insertNode(o),t.setStartAfter(o)}}},ur=function(t,n){if(n==="ArrowDown"||n==="ArrowUp"){var i=(0,y.Th)(t.startContainer,"data-type","math-inline")||(0,y.Th)(t.startContainer,"data-type","html-entity")||(0,y.Th)(t.startContainer,"data-type","html-inline");i&&(n==="ArrowDown"&&t.setStartAfter(i.parentElement),n==="ArrowUp"&&t.setStartBefore(i.parentElement))}},fi=function(t,n){var i=(0,U.RN)(t),a=(0,y.pt)(i.startContainer);a&&(a.insertAdjacentHTML(n,'<p data-block="0">'.concat(u.Y.ZWSP,`<wbr>
</p>`)),(0,U.ir)(t[t.currentMode].element,i),gt(t),ct(t))},Pr=function(t){var n=(0,y._Y)(t,"TABLE");return n&&n.rows[0].cells[0].isSameNode(t)?n:!1},Rr=function(t){var n=(0,y._Y)(t,"TABLE");return n&&n.lastElementChild.lastElementChild.lastElementChild.isSameNode(t)?n:!1},dr=function(t,n,i){i===void 0&&(i=!0);var a=t.previousElementSibling;return a||(t.parentElement.previousElementSibling?a=t.parentElement.previousElementSibling.lastElementChild:t.parentElement.parentElement.tagName==="TBODY"&&t.parentElement.parentElement.previousElementSibling?a=t.parentElement.parentElement.previousElementSibling.lastElementChild.lastElementChild:a=null),a&&(n.selectNodeContents(a),i||n.collapse(!1),(0,U.jl)(n)),a},xi=function(t,n,i,a,o){var c=(0,U.ED)(a,t[t.currentMode].element,i);if(n.key==="ArrowDown"&&a.textContent.trimRight().substr(c.start).indexOf(`
`)===-1||n.key==="ArrowRight"&&c.start>=a.textContent.trimRight().length){var x=o.nextElementSibling;return!x||x&&(x.tagName==="TABLE"||x.getAttribute("data-type"))?(o.insertAdjacentHTML("afterend",'<p data-block="0">'.concat(u.Y.ZWSP,"<wbr></p>")),(0,U.ir)(t[t.currentMode].element,i)):(i.selectNodeContents(x),i.collapse(!0),(0,U.jl)(i)),n.preventDefault(),!0}return!1},ni=function(t,n,i,a,o){var c=(0,U.ED)(a,t[t.currentMode].element,i);if(n.key==="ArrowUp"&&a.textContent.substr(0,c.start).indexOf(`
`)===-1||(n.key==="ArrowLeft"||n.key==="Backspace"&&i.toString()==="")&&c.start===0){var x=o.previousElementSibling;return!x||x&&(x.tagName==="TABLE"||x.getAttribute("data-type"))?(o.insertAdjacentHTML("beforebegin",'<p data-block="0">'.concat(u.Y.ZWSP,"<wbr></p>")),(0,U.ir)(t[t.currentMode].element,i)):(i.selectNodeContents(x),i.collapse(!1),(0,U.jl)(i)),n.preventDefault(),!0}return!1},_i=function(t,n,i,a){a===void 0&&(a=!0);var o=(0,y._Y)(n.startContainer,"LI");if(t[t.currentMode].element.querySelectorAll("wbr").forEach(function($){$.remove()}),n.insertNode(document.createElement("wbr")),a&&o){for(var c="",x=0;x<o.parentElement.childElementCount;x++){var A=o.parentElement.children[x].querySelector("input");A&&A.remove(),c+='<p data-block="0">'.concat(o.parentElement.children[x].innerHTML.trimLeft(),"</p>")}o.parentElement.insertAdjacentHTML("beforebegin",c),o.parentElement.remove()}else if(o)if(i==="check")o.parentElement.querySelectorAll("li").forEach(function($){$.insertAdjacentHTML("afterbegin",'<input type="checkbox" />'.concat($.textContent.indexOf(" ")===0?"":" ")),$.classList.add("vditor-task")});else{o.querySelector("input")&&o.parentElement.querySelectorAll("li").forEach(function($){$.querySelector("input").remove(),$.classList.remove("vditor-task")});var L=void 0;i==="list"?(L=document.createElement("ul"),L.setAttribute("data-marker","*")):(L=document.createElement("ol"),L.setAttribute("data-marker","1.")),L.setAttribute("data-block","0"),L.setAttribute("data-tight",o.parentElement.getAttribute("data-tight")),L.innerHTML=o.parentElement.innerHTML,o.parentElement.parentNode.replaceChild(L,o.parentElement)}else{var D=(0,y.Th)(n.startContainer,"data-block","0");D||(t[t.currentMode].element.querySelector("wbr").remove(),D=t[t.currentMode].element.querySelector("p"),D.innerHTML="<wbr>"),i==="check"?(D.insertAdjacentHTML("beforebegin",'<ul data-block="0"><li class="vditor-task"><input type="checkbox" /> '.concat(D.innerHTML,"</li></ul>")),D.remove()):i==="list"?(D.insertAdjacentHTML("beforebegin",'<ul data-block="0"><li>'.concat(D.innerHTML,"</li></ul>")),D.remove()):i==="ordered-list"&&(D.insertAdjacentHTML("beforebegin",'<ol data-block="0"><li>'.concat(D.innerHTML,"</li></ol>")),D.remove())}},Vi=function(t,n,i){var a=n.previousElementSibling;if(n&&a){var o=[n];Array.from(i.cloneContents().children).forEach(function(D,L){D.nodeType!==3&&n&&D.textContent.trim()!==""&&n.getAttribute("data-node-id")===D.getAttribute("data-node-id")&&(L!==0&&o.push(n),n=n.nextElementSibling)}),t[t.currentMode].element.querySelectorAll("wbr").forEach(function(D){D.remove()}),i.insertNode(document.createElement("wbr"));var c=a.parentElement,x="";o.forEach(function(D){var L=D.getAttribute("data-marker");L.length!==1&&(L="1".concat(L.slice(-1))),x+='<li data-node-id="'.concat(D.getAttribute("data-node-id"),'" data-marker="').concat(L,'">').concat(D.innerHTML,"</li>"),D.remove()}),a.insertAdjacentHTML("beforeend","<".concat(c.tagName,' data-block="0">').concat(x,"</").concat(c.tagName,">")),t.currentMode==="wysiwyg"?c.outerHTML=t.lute.SpinVditorDOM(c.outerHTML):c.outerHTML=t.lute.SpinVditorIRDOM(c.outerHTML),(0,U.ir)(t[t.currentMode].element,i);var A=(0,y.KR)(i.startContainer);A&&A.querySelectorAll(".vditor-".concat(t.currentMode,"__preview[data-render='2']")).forEach(function(D){tt(D,t),t.currentMode==="wysiwyg"&&D.previousElementSibling.setAttribute("style","display:none")}),ct(t),gt(t)}else t[t.currentMode].element.focus()},fr=function(t,n,i,a){var o=(0,y._Y)(n.parentElement,"LI");if(o){t[t.currentMode].element.querySelectorAll("wbr").forEach(function(K){K.remove()}),i.insertNode(document.createElement("wbr"));var c=n.parentElement,x=c.cloneNode(),A=[n];Array.from(i.cloneContents().children).forEach(function(K,me){K.nodeType!==3&&n&&K.textContent.trim()!==""&&n.getAttribute("data-node-id")===K.getAttribute("data-node-id")&&(me!==0&&A.push(n),n=n.nextElementSibling)});var D=!1,L="";c.querySelectorAll("li").forEach(function(K){D&&(L+=K.outerHTML,!K.nextElementSibling&&!K.previousElementSibling?K.parentElement.remove():K.remove()),K.isSameNode(A[A.length-1])&&(D=!0)}),A.reverse().forEach(function(K){o.insertAdjacentElement("afterend",K)}),L&&(x.innerHTML=L,A[0].insertAdjacentElement("beforeend",x)),t.currentMode==="wysiwyg"?a.outerHTML=t.lute.SpinVditorDOM(a.outerHTML):a.outerHTML=t.lute.SpinVditorIRDOM(a.outerHTML),(0,U.ir)(t[t.currentMode].element,i);var $=(0,y.KR)(i.startContainer);$&&$.querySelectorAll(".vditor-".concat(t.currentMode,"__preview[data-render='2']")).forEach(function(K){tt(K,t),t.currentMode==="wysiwyg"&&K.previousElementSibling.setAttribute("style","display:none")}),ct(t),gt(t)}else t[t.currentMode].element.focus()},hi=function(t,n){for(var i=getSelection().getRangeAt(0).startContainer.parentElement,a=t.rows[0].cells.length,o=t.rows.length,c=0,x=0;x<o;x++)for(var A=0;A<a;A++)if(t.rows[x].cells[A].isSameNode(i)){c=A;break}for(var D=0;D<o;D++)t.rows[D].cells[c].setAttribute("align",n)},pi=function(t){var n=t.trimRight().split(`
`).pop();return n===""?!1:(n.replace(/ |-/g,"")===""||n.replace(/ |_/g,"")===""||n.replace(/ |\*/g,"")==="")&&n.replace(/ /g,"").length>2?!(n.indexOf("-")>-1&&n.trimLeft().indexOf(" ")===-1&&t.trimRight().split(`
`).length>1||n.indexOf("    ")===0||n.indexOf("	")===0):!1},hr=function(t){var n=t.trimRight().split(`
`);return t=n.pop(),t.indexOf("    ")===0||t.indexOf("	")===0||(t=t.trimLeft(),t===""||n.length===0)?!1:t.replace(/-/g,"")===""||t.replace(/=/g,"")===""},ct=function(t,n){n===void 0&&(n={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),t.currentMode==="wysiwyg"?rt(t,n):t.currentMode==="ir"?Wn(t,n):t.currentMode==="sv"&&Ue(t,n)},H=function(t,n,i,a){var o,c=t.startContainer,x=(0,y._Y)(c,"LI");if(x){if(!(0,f._0)(a)&&!a.altKey&&a.key==="Enter"&&!a.shiftKey&&i&&x.contains(i)&&i.nextElementSibling)return x&&!x.textContent.endsWith(`
`)&&x.insertAdjacentText("beforeend",`
`),t.insertNode(document.createTextNode(`

`)),t.collapse(!1),ct(n),a.preventDefault(),!0;if(!(0,f._0)(a)&&!a.shiftKey&&!a.altKey&&a.key==="Backspace"&&!x.previousElementSibling&&t.toString()===""&&(0,U.ED)(x,n[n.currentMode].element,t).start===0)return x.nextElementSibling?(x.parentElement.insertAdjacentHTML("beforebegin",'<p data-block="0"><wbr>'.concat(x.innerHTML,"</p>")),x.remove()):x.parentElement.outerHTML='<p data-block="0"><wbr>'.concat(x.innerHTML,"</p>"),(0,U.ir)(n[n.currentMode].element,t),ct(n),a.preventDefault(),!0;if(!(0,f._0)(a)&&!a.shiftKey&&!a.altKey&&a.key==="Backspace"&&x.textContent.trim().replace(u.Y.ZWSP,"")===""&&t.toString()===""&&((o=x.previousElementSibling)===null||o===void 0?void 0:o.tagName)==="LI")return x.previousElementSibling.insertAdjacentText("beforeend",`

`),t.selectNodeContents(x.previousElementSibling),t.collapse(!1),x.remove(),(0,U.ir)(n[n.currentMode].element,t),ct(n),a.preventDefault(),!0;if(!(0,f._0)(a)&&!a.altKey&&a.key==="Tab"){var A=!1;if((t.startOffset===0&&(c.nodeType===3&&!c.previousSibling||c.nodeType!==3&&c.nodeName==="LI")||x.classList.contains("vditor-task")&&t.startOffset===1&&c.previousSibling.nodeType!==3&&c.previousSibling.tagName==="INPUT")&&(A=!0),A||t.toString()!=="")return a.shiftKey?fr(n,x,t,x.parentElement):Vi(n,x,t),a.preventDefault(),!0}}return!1},R=function(t,n,i){if(t.options.tab&&i.key==="Tab")return i.shiftKey||(n.toString()===""?(n.insertNode(document.createTextNode(t.options.tab)),n.collapse(!1)):(n.extractContents(),n.insertNode(document.createTextNode(t.options.tab)),n.collapse(!1))),(0,U.jl)(n),ct(t),i.preventDefault(),!0},Y=function(t,n,i,a){if(i){if(!(0,f._0)(t)&&!t.altKey&&t.key==="Enter"){var o=String.raw(pr||(pr=Dr(["",""],["",""])),i.textContent).replace(/\\\|/g,"").trim(),c=o.split("|");if(o.startsWith("|")&&o.endsWith("|")&&c.length>3){var x=c.map(function(){return"---"}).join("|");return x=i.textContent+`
`+x.substring(3,x.length-3)+`
|<wbr>`,i.outerHTML=n.lute.SpinVditorDOM(x),(0,U.ir)(n[n.currentMode].element,a),ct(n),Ge(n),t.preventDefault(),!0}if(pi(i.innerHTML)&&i.previousElementSibling){var A="",D=i.innerHTML.trimRight().split(`
`);return D.length>1&&(D.pop(),A='<p data-block="0">'.concat(D.join(`
`),"</p>")),i.insertAdjacentHTML("afterend","".concat(A,`<hr data-block="0"><p data-block="0"><wbr>
</p>`)),i.remove(),(0,U.ir)(n[n.currentMode].element,a),ct(n),Ge(n),t.preventDefault(),!0}if(hr(i.innerHTML))return n.currentMode==="wysiwyg"?i.outerHTML=n.lute.SpinVditorDOM(i.innerHTML+`<p data-block="0"><wbr>
</p>`):i.outerHTML=n.lute.SpinVditorIRDOM(i.innerHTML+`<p data-block="0"><wbr>
</p>`),(0,U.ir)(n[n.currentMode].element,a),ct(n),Ge(n),t.preventDefault(),!0}if(a.collapsed&&i.previousElementSibling&&t.key==="Backspace"&&!(0,f._0)(t)&&!t.altKey&&!t.shiftKey&&i.textContent.trimRight().split(`
`).length>1&&(0,U.ED)(i,n[n.currentMode].element,a).start===0){var L=(0,y.Rp)(i.previousElementSibling);return L.textContent.endsWith(`
`)||(L.textContent=L.textContent+`
`),L.parentElement.insertAdjacentHTML("beforeend","<wbr>".concat(i.innerHTML)),i.remove(),(0,U.ir)(n[n.currentMode].element,a),!1}return!1}},Q=function(t,n,i){for(var a="",o=0;o<i.parentElement.childElementCount;o++)a+='<td align="'.concat(i.parentElement.children[o].getAttribute("align"),'"> </td>');i.tagName==="TH"?i.parentElement.parentElement.insertAdjacentHTML("afterend","<tbody><tr>".concat(a,"</tr></tbody>")):i.parentElement.insertAdjacentHTML("afterend","<tr>".concat(a,"</tr>")),ct(t)},ye=function(t,n,i){for(var a="",o=0;o<i.parentElement.childElementCount;o++)i.tagName==="TH"?a+='<th align="'.concat(i.parentElement.children[o].getAttribute("align"),'"> </th>'):a+='<td align="'.concat(i.parentElement.children[o].getAttribute("align"),'"> </td>');if(i.tagName==="TH"){i.parentElement.parentElement.insertAdjacentHTML("beforebegin","<thead><tr>".concat(a,"</tr></thead>")),n.insertNode(document.createElement("wbr"));var c=i.parentElement.innerHTML.replace(/<th>/g,"<td>").replace(/<\/th>/g,"</td>");i.parentElement.parentElement.nextElementSibling.insertAdjacentHTML("afterbegin",c),i.parentElement.parentElement.remove(),(0,U.ir)(t.ir.element,n)}else i.parentElement.insertAdjacentHTML("beforebegin","<tr>".concat(a,"</tr>"));ct(t)},Ee=function(t,n,i,a){a===void 0&&(a="afterend");for(var o=0,c=i.previousElementSibling;c;)o++,c=c.previousElementSibling;for(var x=0;x<n.rows.length;x++)x===0?n.rows[x].cells[o].insertAdjacentHTML(a,"<th> </th>"):n.rows[x].cells[o].insertAdjacentHTML(a,"<td> </td>");ct(t)},at=function(t,n,i){if(i.tagName==="TD"){var a=i.parentElement.parentElement;i.parentElement.previousElementSibling?n.selectNodeContents(i.parentElement.previousElementSibling.lastElementChild):n.selectNodeContents(a.previousElementSibling.lastElementChild.lastElementChild),a.childElementCount===1?a.remove():i.parentElement.remove(),n.collapse(!1),(0,U.jl)(n),ct(t)}},Yt=function(t,n,i,a){for(var o=0,c=a.previousElementSibling;c;)o++,c=c.previousElementSibling;(a.previousElementSibling||a.nextElementSibling)&&(n.selectNodeContents(a.previousElementSibling||a.nextElementSibling),n.collapse(!0));for(var x=0;x<i.rows.length;x++){var A=i.rows[x].cells;if(A.length===1){i.remove(),gt(t);break}A[o].remove()}(0,U.jl)(n),ct(t)},At=function(t,n,i){var a=i.startContainer,o=(0,y._Y)(a,"TD")||(0,y._Y)(a,"TH");if(o){if(!(0,f._0)(n)&&!n.altKey&&n.key==="Enter"){(!o.lastElementChild||o.lastElementChild&&(!o.lastElementChild.isSameNode(o.lastChild)||o.lastElementChild.tagName!=="BR"))&&o.insertAdjacentHTML("beforeend","<br>");var c=document.createElement("br");return i.insertNode(c),i.setStartAfter(c),ct(t),Ge(t),n.preventDefault(),!0}if(n.key==="Tab"){if(n.shiftKey)return dr(o,i),n.preventDefault(),!0;var x=o.nextElementSibling;return x||(o.parentElement.nextElementSibling?x=o.parentElement.nextElementSibling.firstElementChild:o.parentElement.parentElement.tagName==="THEAD"&&o.parentElement.parentElement.nextElementSibling?x=o.parentElement.parentElement.nextElementSibling.firstElementChild.firstElementChild:x=null),x&&(i.selectNodeContents(x),(0,U.jl)(i)),n.preventDefault(),!0}var A=o.parentElement.parentElement.parentElement;if(n.key==="ArrowUp"){if(n.preventDefault(),o.tagName==="TH")return A.previousElementSibling?(i.selectNodeContents(A.previousElementSibling),i.collapse(!1),(0,U.jl)(i)):fi(t,"beforebegin"),!0;for(var D=0,L=o.parentElement;D<L.cells.length&&!L.cells[D].isSameNode(o);D++);var $=L.previousElementSibling;return $||($=L.parentElement.previousElementSibling.firstChild),i.selectNodeContents($.cells[D]),i.collapse(!1),(0,U.jl)(i),!0}if(n.key==="ArrowDown"){n.preventDefault();var L=o.parentElement;if(!L.nextElementSibling&&o.tagName==="TD")return A.nextElementSibling?(i.selectNodeContents(A.nextElementSibling),i.collapse(!0),(0,U.jl)(i)):fi(t,"afterend"),!0;for(var D=0;D<L.cells.length&&!L.cells[D].isSameNode(o);D++);var x=L.nextElementSibling;return x||(x=L.parentElement.nextElementSibling.firstChild),i.selectNodeContents(x.cells[D]),i.collapse(!0),(0,U.jl)(i),!0}if(t.currentMode==="wysiwyg"&&!(0,f._0)(n)&&n.key==="Enter"&&!n.shiftKey&&n.altKey){var K=t.wysiwyg.popover.querySelector(".vditor-input");return K.focus(),K.select(),n.preventDefault(),!0}if(!(0,f._0)(n)&&!n.shiftKey&&!n.altKey&&n.key==="Backspace"&&i.startOffset===0&&i.toString()===""){var me=dr(o,i,!1);return!me&&A&&(A.textContent.trim()===""?(A.outerHTML=`<p data-block="0"><wbr>
</p>`,(0,U.ir)(t[t.currentMode].element,i)):(i.setStartBefore(A),i.collapse(!0)),ct(t)),n.preventDefault(),!0}if(X("⇧⌘F",n))return ye(t,i,o),n.preventDefault(),!0;if(X("⌘=",n))return Q(t,i,o),n.preventDefault(),!0;if(X("⇧⌘G",n))return Ee(t,A,o,"beforebegin"),n.preventDefault(),!0;if(X("⇧⌘=",n))return Ee(t,A,o),n.preventDefault(),!0;if(X("⌘-",n))return at(t,i,o),n.preventDefault(),!0;if(X("⇧⌘-",n))return Yt(t,i,A,o),n.preventDefault(),!0;if(X("⇧⌘L",n)){if(t.currentMode==="ir")return hi(A,"left"),ct(t),n.preventDefault(),!0;var pe=t.wysiwyg.popover.querySelector('[data-type="left"]');if(pe)return pe.click(),n.preventDefault(),!0}if(X("⇧⌘C",n)){if(t.currentMode==="ir")return hi(A,"center"),ct(t),n.preventDefault(),!0;var pe=t.wysiwyg.popover.querySelector('[data-type="center"]');if(pe)return pe.click(),n.preventDefault(),!0}if(X("⇧⌘R",n)){if(t.currentMode==="ir")return hi(A,"right"),ct(t),n.preventDefault(),!0;var pe=t.wysiwyg.popover.querySelector('[data-type="right"]');if(pe)return pe.click(),n.preventDefault(),!0}}return!1},En=function(t,n,i,a){if(i.tagName==="PRE"&&X("⌘A",n))return a.selectNodeContents(i.firstElementChild),n.preventDefault(),!0;if(t.options.tab&&n.key==="Tab"&&!n.shiftKey&&a.toString()==="")return a.insertNode(document.createTextNode(t.options.tab)),a.collapse(!1),ct(t),n.preventDefault(),!0;if(n.key==="Backspace"&&!(0,f._0)(n)&&!n.shiftKey&&!n.altKey){var o=(0,U.ED)(i,t[t.currentMode].element,a);if((o.start===0||o.start===1&&i.innerText===`
`)&&a.toString()==="")return i.parentElement.outerHTML='<p data-block="0"><wbr>'.concat(i.firstElementChild.innerHTML,"</p>"),(0,U.ir)(t[t.currentMode].element,a),ct(t),n.preventDefault(),!0}return!(0,f._0)(n)&&!n.altKey&&n.key==="Enter"?(i.firstElementChild.textContent.endsWith(`
`)||i.firstElementChild.insertAdjacentText("beforeend",`
`),a.extractContents(),a.insertNode(document.createTextNode(`
`)),a.collapse(!1),(0,U.jl)(a),(0,f.gm)()||(t.currentMode==="wysiwyg"?Si(t,a):Ke(t,a)),Ge(t),n.preventDefault(),!0):!1},mi=function(t,n,i,a){var o=n.startContainer,c=(0,y._Y)(o,"BLOCKQUOTE");if(c&&n.toString()===""){if(i.key==="Backspace"&&!(0,f._0)(i)&&!i.shiftKey&&!i.altKey&&(0,U.ED)(c,t[t.currentMode].element,n).start===0)return n.insertNode(document.createElement("wbr")),c.outerHTML=c.innerHTML,(0,U.ir)(t[t.currentMode].element,n),ct(t),i.preventDefault(),!0;if(a&&i.key==="Enter"&&!(0,f._0)(i)&&!i.shiftKey&&!i.altKey&&a.parentElement.tagName==="BLOCKQUOTE"){var x=!1;if(a.innerHTML.replace(u.Y.ZWSP,"")===`
`||a.innerHTML.replace(u.Y.ZWSP,"")===""?(x=!0,a.remove()):a.innerHTML.endsWith(`

`)&&(0,U.ED)(a,t[t.currentMode].element,n).start===a.textContent.length-1&&(a.innerHTML=a.innerHTML.substr(0,a.innerHTML.length-2),x=!0),x)return c.insertAdjacentHTML("afterend",'<p data-block="0">'.concat(u.Y.ZWSP,`<wbr>
</p>`)),(0,U.ir)(t[t.currentMode].element,n),ct(t),i.preventDefault(),!0}var A=(0,y.pt)(o);if(t.currentMode==="wysiwyg"&&A&&X("⇧⌘;",i))return n.insertNode(document.createElement("wbr")),A.outerHTML='<blockquote data-block="0">'.concat(A.outerHTML,"</blockquote>"),(0,U.ir)(t.wysiwyg.element,n),rt(t),i.preventDefault(),!0;if(xi(t,i,n,c,c)||ni(t,i,n,c,c))return!0}return!1},qn=function(t,n,i){var a=n.startContainer,o=(0,y._Y)(a,"li");if(o&&o.classList.contains("vditor-task")){if(X("⇧⌘J",i)){var c=o.firstElementChild;return c.checked?c.removeAttribute("checked"):c.setAttribute("checked","checked"),ct(t),i.preventDefault(),!0}if(i.key==="Backspace"&&!(0,f._0)(i)&&!i.shiftKey&&!i.altKey&&n.toString()===""&&n.startOffset===1&&(a.nodeType===3&&a.previousSibling&&a.previousSibling.tagName==="INPUT"||a.nodeType!==3)){var x=o.previousElementSibling;if(o.querySelector("input").remove(),x){var A=(0,y.Rp)(x);A.parentElement.insertAdjacentHTML("beforeend","<wbr>"+o.innerHTML.trim()),o.remove()}else o.parentElement.insertAdjacentHTML("beforebegin",'<p data-block="0"><wbr>'.concat(o.innerHTML.trim()||`
`,"</p>")),o.nextElementSibling?o.remove():o.parentElement.remove();return(0,U.ir)(t[t.currentMode].element,n),ct(t),i.preventDefault(),!0}if(i.key==="Enter"&&!(0,f._0)(i)&&!i.shiftKey&&!i.altKey){if(o.textContent.trim()==="")if((0,y.KJ)(o.parentElement,"vditor-task")){var D=(0,y.KR)(a);D&&fr(t,o,n,D)}else if(o.nextElementSibling){var L="",$="",K=!1;Array.from(o.parentElement.children).forEach(function($e){o.isSameNode($e)?K=!0:K?L+=$e.outerHTML:$+=$e.outerHTML});var me=o.parentElement.tagName,pe=o.parentElement.tagName==="OL"?"":' data-marker="'.concat(o.parentElement.getAttribute("data-marker"),'"'),fe="";$&&(fe=o.parentElement.tagName==="UL"?"":' start="1"',$="<".concat(me,' data-tight="true"').concat(pe,' data-block="0">').concat($,"</").concat(me,">")),o.parentElement.outerHTML="".concat($,`<p data-block="0"><wbr>
</p><`).concat(me,`
 data-tight="true"`).concat(pe,' data-block="0"').concat(fe,">").concat(L,"</").concat(me,">")}else o.parentElement.insertAdjacentHTML("afterend",`<p data-block="0"><wbr>
</p>`),o.parentElement.querySelectorAll("li").length===1?o.parentElement.remove():o.remove();else a.nodeType!==3&&n.startOffset===0&&a.firstChild.tagName==="INPUT"?n.setStart(a.childNodes[1],1):(n.setEndAfter(o.lastChild),o.insertAdjacentHTML("afterend",'<li class="vditor-task" data-marker="'.concat(o.getAttribute("data-marker"),'"><input type="checkbox"> <wbr></li>')),document.querySelector("wbr").after(n.extractContents()));return(0,U.ir)(t[t.currentMode].element,n),ct(t),Ge(t),i.preventDefault(),!0}}return!1},ce=function(t,n,i,a){if(n.startContainer.nodeType!==3){var o=n.startContainer.children[n.startOffset];if(o&&o.tagName==="HR")return n.selectNodeContents(o.previousElementSibling),n.collapse(!1),i.preventDefault(),!0}if(a){var c=a.previousElementSibling;if(c&&(0,U.ED)(a,t[t.currentMode].element,n).start===0&&((0,f.gm)()&&c.tagName==="HR"||c.tagName==="TABLE")){if(c.tagName==="TABLE"){var x=c.lastElementChild.lastElementChild.lastElementChild;x.innerHTML=x.innerHTML.trimLeft()+"<wbr>"+a.textContent.trim(),a.remove()}else c.remove();return(0,U.ir)(t[t.currentMode].element,n),ct(t),i.preventDefault(),!0}}return!1},Ft=function(t){(0,f.gm)()&&t.startContainer.nodeType!==3&&t.startContainer.tagName==="HR"&&t.setStartBefore(t.startContainer)},kn=function(t,n,i){var a,o;if(!(0,f.gm)())return!1;if(t.key==="ArrowUp"&&n&&((a=n.previousElementSibling)===null||a===void 0?void 0:a.tagName)==="TABLE"){var c=n.previousElementSibling;return i.selectNodeContents(c.rows[c.rows.length-1].lastElementChild),i.collapse(!1),t.preventDefault(),!0}return t.key==="ArrowDown"&&n&&((o=n.nextElementSibling)===null||o===void 0?void 0:o.tagName)==="TABLE"?(i.selectNodeContents(n.nextElementSibling.rows[0].cells[0]),i.collapse(!0),t.preventDefault(),!0):!1},hn=function(t,n,i){return lr(void 0,void 0,void 0,function(){var a,o,c,x,A,D,L,$,K,me,pe,fe,$e,ue,ke,ue,Ye;return ha(this,function(Ne){switch(Ne.label){case 0:return t[t.currentMode].element.getAttribute("contenteditable")!=="true"?[2]:(n.stopPropagation(),n.preventDefault(),"clipboardData"in n?(a=n.clipboardData.getData("text/html"),o=n.clipboardData.getData("text/plain"),c=n.clipboardData.files):(a=n.dataTransfer.getData("text/html"),o=n.dataTransfer.getData("text/plain"),n.dataTransfer.types.includes("Files")&&(c=n.dataTransfer.items)),x={},A=function(Xe,xt){if(!xt)return["",Lute.WalkContinue];if(t.options.upload.renderLinkDest)return t.options.upload.renderLinkDest(t,Xe,xt);var St=Xe.TokensStr();if(Xe.__internal_object__.Parent.Type===34&&St&&St.indexOf("file://")===-1&&t.options.upload.linkToImgUrl){var Tt=new XMLHttpRequest;Tt.open("POST",t.options.upload.linkToImgUrl),t.options.upload.token&&Tt.setRequestHeader("X-Upload-Token",t.options.upload.token),t.options.upload.withCredentials&&(Tt.withCredentials=!0),Xt(t,Tt),Tt.setRequestHeader("Content-Type","application/json; charset=utf-8"),Tt.onreadystatechange=function(){if(Tt.readyState===XMLHttpRequest.DONE){if(Tt.status===200){var pn=Tt.responseText;t.options.upload.linkToImgFormat&&(pn=t.options.upload.linkToImgFormat(Tt.responseText));var tn=JSON.parse(pn);if(tn.code!==0){t.tip.show(tn.msg);return}var mn=tn.data.originalURL;if(t.currentMode==="sv")t.sv.element.querySelectorAll(".vditor-sv__marker--link").forEach(function(Vt){Vt.textContent===mn&&(Vt.textContent=tn.data.url)});else{var ot=t[t.currentMode].element.querySelector('img[src="'.concat(mn,'"]'));ot.src=tn.data.url,t.currentMode==="ir"&&(ot.previousElementSibling.previousElementSibling.innerHTML=tn.data.url)}ct(t)}else t.tip.show(Tt.responseText);t.options.upload.linkToImgCallback&&t.options.upload.linkToImgCallback(Tt.responseText)}},Tt.send(JSON.stringify({url:St}))}return t.currentMode==="ir"?['<span class="vditor-ir__marker vditor-ir__marker--link">'.concat(Lute.EscapeHTMLStr(St),"</span>"),Lute.WalkContinue]:t.currentMode==="wysiwyg"?["",Lute.WalkContinue]:['<span class="vditor-sv__marker--link">'.concat(Lute.EscapeHTMLStr(St),"</span>"),Lute.WalkContinue]},(a.replace(/&amp;/g,"&").replace(/<(|\/)(html|body|meta)[^>]*?>/ig,"").trim()==='<a href="'.concat(o,'">').concat(o,"</a>")||a.replace(/&amp;/g,"&").replace(/<(|\/)(html|body|meta)[^>]*?>/ig,"").trim()==='<!--StartFragment--><a href="'.concat(o,'">').concat(o,"</a><!--EndFragment-->"))&&(a=""),D=new DOMParser().parseFromString(a,"text/html"),D.body&&(a=D.body.innerHTML),a=Lute.Sanitize(a),t.wysiwyg.getComments(t),L=t[t.currentMode].element.scrollHeight,$=Je(a,o,t.currentMode),K=t.currentMode==="sv"?(0,y.Th)(n.target,"data-type","code-block"):(0,y._Y)(n.target,"CODE"),K?(t.currentMode==="sv"?document.execCommand("insertHTML",!1,o.replace(/&/g,"&amp;").replace(/</g,"&lt;")):(me=(0,U.ED)(n.target,t[t.currentMode].element),K.parentElement.tagName!=="PRE"&&(o+=u.Y.ZWSP),K.textContent=K.textContent.substring(0,me.start)+o+K.textContent.substring(me.end),(0,U.Fm)(me.start+o.length,me.start+o.length,K.parentElement),!((Ye=K.parentElement)===null||Ye===void 0)&&Ye.nextElementSibling.classList.contains("vditor-".concat(t.currentMode,"__preview"))&&(K.parentElement.nextElementSibling.innerHTML=K.outerHTML,tt(K.parentElement.nextElementSibling,t))),[3,8]):[3,1]);case 1:return $?(i.pasteCode($),[3,8]):[3,2];case 2:return a.trim()===""?[3,3]:(pe=document.createElement("div"),pe.innerHTML=a,pe.querySelectorAll("[style]").forEach(function(Xe){Xe.removeAttribute("style")}),pe.querySelectorAll(".vditor-copy").forEach(function(Xe){Xe.remove()}),t.currentMode==="ir"?(x.HTML2VditorIRDOM={renderLinkDest:A},t.lute.SetJSRenderers({renderers:x}),(0,U.Z2)(t.lute.HTML2VditorIRDOM(pe.innerHTML),t)):t.currentMode==="wysiwyg"?(x.HTML2VditorDOM={renderLinkDest:A},t.lute.SetJSRenderers({renderers:x}),(0,U.Z2)(t.lute.HTML2VditorDOM(pe.innerHTML),t)):(x.Md2VditorSVDOM={renderLinkDest:A},t.lute.SetJSRenderers({renderers:x}),W(t,t.lute.HTML2Md(pe.innerHTML).trimRight())),t.outline.render(t),[3,8]);case 3:return c.length>0?t.options.upload.url||t.options.upload.handler?[4,Nn(t,c)]:[3,5]:[3,7];case 4:return Ne.sent(),[3,6];case 5:fe=new FileReader,"clipboardData"in n?(c=n.clipboardData.files,$e=c[0]):n.dataTransfer.types.includes("Files")&&(c=n.dataTransfer.items,$e=c[0].getAsFile()),$e&&$e.type.startsWith("image")&&(fe.readAsDataURL($e),fe.onload=function(){var Xe="";t.currentMode==="wysiwyg"?Xe+='<img alt="'.concat($e.name,'" src="').concat(fe.result.toString(),`">
`):Xe+="![".concat($e.name,"](").concat(fe.result.toString(),`)
`),document.execCommand("insertHTML",!1,Xe)}),Ne.label=6;case 6:return[3,8];case 7:o.trim()!==""&&c.length===0&&(ue=(0,U.RN)(t),ue.toString()!==""&&t.lute.IsValidLinkDest(o)&&(o="[".concat(ue.toString(),"](").concat(o,")")),t.currentMode==="ir"?(x.Md2VditorIRDOM={renderLinkDest:A},t.lute.SetJSRenderers({renderers:x}),(0,U.Z2)(t.lute.Md2VditorIRDOM(o),t)):t.currentMode==="wysiwyg"?(x.Md2VditorDOM={renderLinkDest:A},t.lute.SetJSRenderers({renderers:x}),(0,U.Z2)(t.lute.Md2VditorDOM(o),t)):(x.Md2VditorSVDOM={renderLinkDest:A},t.lute.SetJSRenderers({renderers:x}),W(t,o)),t.outline.render(t)),Ne.label=8;case 8:return t.currentMode!=="sv"&&(ke=(0,y.pt)((0,U.RN)(t).startContainer),ke&&(ue=(0,U.RN)(t),t[t.currentMode].element.querySelectorAll("wbr").forEach(function(Xe){Xe.remove()}),ue.insertNode(document.createElement("wbr")),t.currentMode==="wysiwyg"?ke.outerHTML=t.lute.SpinVditorDOM(ke.outerHTML):ke.outerHTML=t.lute.SpinVditorIRDOM(ke.outerHTML),(0,U.ir)(t[t.currentMode].element,ue)),t[t.currentMode].element.querySelectorAll(".vditor-".concat(t.currentMode,"__preview[data-render='2']")).forEach(function(Xe){tt(Xe,t)})),t.wysiwyg.triggerRemoveComment(t),ct(t),t[t.currentMode].element.scrollHeight-L>Math.min(t[t.currentMode].element.clientHeight,window.innerHeight)/2&&Ge(t),[2]}})})},pr,Ci=function(t){var n,i;t.hint.render(t);var a=(0,U.RN)(t).startContainer,o=(0,y.Th)(a,"data-type","code-block-info");if(o)if(o.textContent.replace(u.Y.ZWSP,"")===""&&t.hint.recentLanguage){o.textContent=u.Y.ZWSP+t.hint.recentLanguage;var c=(0,U.RN)(t);c.selectNodeContents(o)}else{var x=[],A=o.textContent.substring(0,(0,U.ED)(o,t.ir.element).start).replace(u.Y.ZWSP,"");(t.options.preview.hljs.langs||u.Y.ALIAS_CODE_LANGUAGES.concat(((i=(n=window.hljs)===null||n===void 0?void 0:n.listLanguages())!==null&&i!==void 0?i:[]).sort())).forEach(function(D){D.indexOf(A.toLowerCase())>-1&&x.push({html:D,value:D})}),t.hint.genHTML(x,A,t)}},Wn=function(t,n){n===void 0&&(n={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),n.enableHint&&Ci(t),clearTimeout(t.ir.processTimeoutId),t.ir.processTimeoutId=window.setTimeout(function(){if(!t.ir.composingLock){var i=S(t);typeof t.options.input=="function"&&n.enableInput&&t.options.input(i),t.options.counter.enable&&t.counter.render(t,i),t.options.cache.enable&&(0,f.D)()&&(localStorage.setItem(t.options.cache.id,i),t.options.cache.after&&t.options.cache.after(i)),t.devtools&&t.devtools.renderEchart(t),n.enableAddUndoStack&&t.undo.addToUndoStack(t)}},t.options.undoDelay)},jn=function(t,n){var i=(0,U.RN)(t),a=(0,y.pt)(i.startContainer)||i.startContainer;if(a){var o=a.querySelector(".vditor-ir__marker--heading");o?o.innerHTML=n:(a.insertAdjacentText("afterbegin",n),i.selectNodeContents(a),i.collapse(!1)),Ke(t,i.cloneRange()),an(t)}},Ir=function(t,n,i){var a=(0,y.Th)(t.startContainer,"data-type",i);if(a){a.firstElementChild.remove(),a.lastElementChild.remove(),t.insertNode(document.createElement("wbr"));var o=document.createElement("div");o.innerHTML=n.lute.SpinVditorIRDOM(a.outerHTML),a.outerHTML=o.firstElementChild.innerHTML.trim()}},Ws=function(t,n,i,a){var o=(0,U.RN)(t),c=n.getAttribute("data-type"),x=o.startContainer;x.nodeType===3&&(x=x.parentElement);var A=!0;if(n.classList.contains("vditor-menu--current"))if(c==="quote"){var D=(0,y._Y)(x,"BLOCKQUOTE");D&&(o.insertNode(document.createElement("wbr")),D.outerHTML=D.innerHTML.trim()===""?'<p data-block="0">'.concat(D.innerHTML,"</p>"):D.innerHTML)}else if(c==="link"){var L=(0,y.Th)(o.startContainer,"data-type","a");if(L){var $=(0,y.KJ)(o.startContainer,"vditor-ir__link");$?(o.insertNode(document.createElement("wbr")),L.outerHTML=$.innerHTML):L.outerHTML=L.querySelector(".vditor-ir__link").innerHTML+"<wbr>"}}else c==="italic"?Ir(o,t,"em"):c==="bold"?Ir(o,t,"strong"):c==="strike"?Ir(o,t,"s"):c==="inline-code"?Ir(o,t,"code"):(c==="check"||c==="list"||c==="ordered-list")&&(_i(t,o,c),A=!1,n.classList.remove("vditor-menu--current"));else{t.ir.element.childNodes.length===0&&(t.ir.element.innerHTML='<p data-block="0"><wbr></p>',(0,U.ir)(t.ir.element,o));var K=(0,y.pt)(o.startContainer);if(c==="line"){if(K){var me=`<hr data-block="0"><p data-block="0"><wbr>
</p>`;K.innerHTML.trim()===""?K.outerHTML=me:K.insertAdjacentHTML("afterend",me)}}else if(c==="quote")K&&(o.insertNode(document.createElement("wbr")),K.outerHTML='<blockquote data-block="0">'.concat(K.outerHTML,"</blockquote>"),A=!1,n.classList.add("vditor-menu--current"));else if(c==="link"){var pe=void 0;o.toString()===""?pe="".concat(i,"<wbr>").concat(a):pe="".concat(i).concat(o.toString()).concat(a.replace(")","<wbr>)")),document.execCommand("insertHTML",!1,pe),A=!1,n.classList.add("vditor-menu--current")}else if(c==="italic"||c==="bold"||c==="strike"||c==="inline-code"||c==="code"||c==="table"){var pe=void 0;o.toString()===""?pe="".concat(i,"<wbr>").concat(a):(c==="code"?pe="".concat(i,`
`).concat(o.toString(),"<wbr>").concat(a):c==="table"?pe="".concat(i).concat(o.toString(),"<wbr>").concat(a):pe="".concat(i).concat(o.toString()).concat(a,"<wbr>"),o.deleteContents()),(c==="table"||c==="code")&&(pe=`
`+pe+`

`);var fe=document.createElement("span");fe.innerHTML=pe,o.insertNode(fe),Ke(t,o),c==="table"&&(o.selectNodeContents(getSelection().getRangeAt(0).startContainer.parentElement),(0,U.jl)(o))}else(c==="check"||c==="list"||c==="ordered-list")&&(_i(t,o,c,!1),A=!1,g(t.toolbar.elements,["check","list","ordered-list"]),n.classList.add("vditor-menu--current"))}(0,U.ir)(t.ir.element,o),Wn(t),A&&an(t)},Ys=function(t,n,i,a){function o(c){return c instanceof i?c:new i(function(x){x(c)})}return new(i||(i=Promise))(function(c,x){function A($){try{L(a.next($))}catch(K){x(K)}}function D($){try{L(a.throw($))}catch(K){x(K)}}function L($){$.done?c($.value):o($.value).then(A,D)}L((a=a.apply(t,n||[])).next())})},Ks=function(t,n){var i={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},a,o,c,x;return x={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function A(L){return function($){return D([L,$])}}function D(L){if(a)throw new TypeError("Generator is already executing.");for(;x&&(x=0,L[0]&&(i=0)),i;)try{if(a=1,o&&(c=L[0]&2?o.return:L[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,L[1])).done)return c;switch(o=0,c&&(L=[L[0]&2,c.value]),L[0]){case 0:case 1:c=L;break;case 4:return i.label++,{value:L[1],done:!1};case 5:i.label++,o=L[1],L=[0];continue;case 7:L=i.ops.pop(),i.trys.pop();continue;default:if(c=i.trys,!(c=c.length>0&&c[c.length-1])&&(L[0]===6||L[0]===2)){i=0;continue}if(L[0]===3&&(!c||L[1]>c[0]&&L[1]<c[3])){i.label=L[1];break}if(L[0]===6&&i.label<c[1]){i.label=c[1],c=L;break}if(c&&i.label<c[2]){i.label=c[2],i.ops.push(L);break}c[2]&&i.ops.pop(),i.trys.pop();continue}L=n.call(t,i)}catch($){L=[6,$],o=0}finally{a=c=0}if(L[0]&5)throw L[1];return{value:L[0]?L[1]:void 0,done:!0}}},Gs=function(){function t(n){var i=this;this.splitChar="",this.lastIndex=-1,this.fillEmoji=function(a,o){i.element.style.display="none";var c=decodeURIComponent(a.getAttribute("data-value")),x=window.getSelection().getRangeAt(0);if(o.currentMode==="ir"){var A=(0,y.Th)(x.startContainer,"data-type","code-block-info");if(A){A.textContent=u.Y.ZWSP+c.trimRight(),x.selectNodeContents(A),x.collapse(!1),Wn(o),A.parentElement.querySelectorAll("code").forEach(function(K){K.className="language-"+c.trimRight()}),tt(A.parentElement.querySelector(".vditor-ir__preview"),o),i.recentLanguage=c.trimRight();return}}if(o.currentMode==="wysiwyg"&&x.startContainer.nodeType!==3){var D=x.startContainer,L=void 0;if(D.classList.contains("vditor-input")?L=D:L=D.firstElementChild,L&&L.classList.contains("vditor-input")){L.value=c.trimRight(),x.selectNodeContents(L),x.collapse(!1),L.dispatchEvent(new CustomEvent("input",{detail:1})),i.recentLanguage=c.trimRight();return}}if(x.setStart(x.startContainer,i.lastIndex),x.deleteContents(),o.options.hint.parse?o.currentMode==="sv"?(0,U.Z2)(o.lute.SpinVditorSVDOM(c),o):o.currentMode==="wysiwyg"?(0,U.Z2)(o.lute.SpinVditorDOM(c),o):(0,U.Z2)(o.lute.SpinVditorIRDOM(c),o):(0,U.Z2)(c,o),i.splitChar===":"&&c.indexOf(":")>-1&&o.currentMode!=="sv"&&x.insertNode(document.createTextNode(" ")),x.collapse(!1),(0,U.jl)(x),o.currentMode==="wysiwyg"){var $=(0,y.KJ)(x.startContainer,"vditor-wysiwyg__block");$&&$.lastElementChild.classList.contains("vditor-wysiwyg__preview")&&($.lastElementChild.innerHTML=$.firstElementChild.innerHTML,tt($.lastElementChild,o))}else if(o.currentMode==="ir"){var $=(0,y.KJ)(x.startContainer,"vditor-ir__marker--pre");$&&$.nextElementSibling.classList.contains("vditor-ir__preview")&&($.nextElementSibling.innerHTML=$.innerHTML,tt($.nextElementSibling,o))}ct(o)},this.timeId=-1,this.element=document.createElement("div"),this.element.className="vditor-hint",this.recentLanguage="",n.push({key:":"})}return t.prototype.render=function(n){var i=this;if(window.getSelection().focusNode){var a,o=getSelection().getRangeAt(0);a=o.startContainer.textContent.substring(0,o.startOffset)||"";var c=this.getKey(a,n.options.hint.extend);if(typeof c>"u")this.element.style.display="none",clearTimeout(this.timeId);else if(this.splitChar===":"){var x=c===""?n.options.hint.emoji:n.lute.GetEmojis(),A=[];Object.keys(x).forEach(function(D){D.indexOf(c.toLowerCase())===0&&(x[D].indexOf(".")>-1?A.push({html:'<img src="'.concat(x[D],'" title=":').concat(D,':"/> :').concat(D,":"),value:":".concat(D,":")}):A.push({html:'<span class="vditor-hint__emoji">'.concat(x[D],"</span>").concat(D),value:x[D]}))}),this.genHTML(A,c,n)}else n.options.hint.extend.forEach(function(D){D.key===i.splitChar&&(clearTimeout(i.timeId),i.timeId=window.setTimeout(function(){return Ys(i,void 0,void 0,function(){var L;return Ks(this,function($){switch($.label){case 0:return L=this.genHTML,[4,D.hint(c)];case 1:return L.apply(this,[$.sent(),c,n]),[2]}})})},n.options.hint.delay))})}},t.prototype.genHTML=function(n,i,a){var o=this;if(n.length===0){this.element.style.display="none";return}var c=a[a.currentMode].element,x=(0,U.Ey)(c),A=x.left+(a.options.outline.position==="left"?a.outline.element.offsetWidth:0),D=x.top,L="";n.forEach(function(K,me){if(!(me>7)){var pe=K.html;if(i!==""){var fe=pe.lastIndexOf(">")+1,$e=pe.substr(fe),ke=$e.toLowerCase().indexOf(i.toLowerCase());ke>-1&&($e=$e.substring(0,ke)+"<b>"+$e.substring(ke,ke+i.length)+"</b>"+$e.substring(ke+i.length),pe=pe.substr(0,fe)+$e)}L+='<button type="button" data-value="'.concat(encodeURIComponent(K.value),` "
`).concat(me===0?"class='vditor-hint--current'":"","> ").concat(pe,"</button>")}}),this.element.innerHTML=L;var $=parseInt(document.defaultView.getComputedStyle(c,null).getPropertyValue("line-height"),10);this.element.style.top="".concat(D+($||22),"px"),this.element.style.left="".concat(A,"px"),this.element.style.display="block",this.element.style.right="auto",this.element.querySelectorAll("button").forEach(function(K){K.addEventListener("click",function(me){o.fillEmoji(K,a),me.preventDefault()})}),this.element.getBoundingClientRect().bottom>window.innerHeight&&(this.element.style.top="".concat(D-this.element.offsetHeight,"px")),this.element.getBoundingClientRect().right>window.innerWidth&&(this.element.style.left="auto",this.element.style.right="0")},t.prototype.select=function(n,i){if(this.element.querySelectorAll("button").length===0||this.element.style.display==="none")return!1;var a=this.element.querySelector(".vditor-hint--current");if(n.key==="ArrowDown")return n.preventDefault(),n.stopPropagation(),a.removeAttribute("class"),a.nextElementSibling?a.nextElementSibling.className="vditor-hint--current":this.element.children[0].className="vditor-hint--current",!0;if(n.key==="ArrowUp"){if(n.preventDefault(),n.stopPropagation(),a.removeAttribute("class"),a.previousElementSibling)a.previousElementSibling.className="vditor-hint--current";else{var o=this.element.children.length;this.element.children[o-1].className="vditor-hint--current"}return!0}else if(!(0,f._0)(n)&&!n.shiftKey&&!n.altKey&&n.key==="Enter"&&!n.isComposing)return n.preventDefault(),n.stopPropagation(),this.fillEmoji(a,i),!0;return!1},t.prototype.getKey=function(n,i){var a=this;this.lastIndex=-1,this.splitChar="",i.forEach(function(L){var $=n.lastIndexOf(L.key);a.lastIndex<$&&(a.splitChar=L.key,a.lastIndex=$)});var o;if(this.lastIndex===-1)return o;var c=n.split(this.splitChar),x=c[c.length-1],A=32;if(c.length>1&&x.trim()===x)if(c.length===2&&c[0]===""&&c[1].length<A)o=c[1];else{var D=c[c.length-2].slice(-1);(0,v.p)(D)===" "&&x.length<A&&(o=x)}return o},t}(),Xs=function(){function t(n){this.composingLock=!1;var i=document.createElement("div");i.className="vditor-ir",i.innerHTML='<pre class="vditor-reset" placeholder="'.concat(n.options.placeholder,`"
 contenteditable="true" spellcheck="false"></pre>`),this.element=i.firstElementChild,this.bindEvent(n),ln(n,this.element),ti(n,this.element),ui(n,this.element),ut(n,this.element),Gt(n,this.element),Hn(n,this.element),zt(n,this.element,this.copy),Wt(n,this.element,this.copy)}return t.prototype.copy=function(n,i){var a=getSelection().getRangeAt(0);if(a.toString()!==""){n.stopPropagation(),n.preventDefault();var o=document.createElement("div");o.appendChild(a.cloneContents()),n.clipboardData.setData("text/plain",i.lute.VditorIRDOM2Md(o.innerHTML).trim()),n.clipboardData.setData("text/html","")}},t.prototype.bindEvent=function(n){var i=this;this.element.addEventListener("paste",function(a){hn(n,a,{pasteCode:function(o){document.execCommand("insertHTML",!1,o)}})}),this.element.addEventListener("scroll",function(){T(n,["hint"])}),this.element.addEventListener("compositionstart",function(a){i.composingLock=!0}),this.element.addEventListener("compositionend",function(a){(0,f.gm)()||Ke(n,getSelection().getRangeAt(0).cloneRange()),i.composingLock=!1}),this.element.addEventListener("input",function(a){if(!(a.inputType==="deleteByDrag"||a.inputType==="insertFromDrop")){if(i.preventInput){i.preventInput=!1,Wn(n,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0});return}i.composingLock||a.data==="‘"||a.data==="“"||a.data==="《"||Ke(n,getSelection().getRangeAt(0).cloneRange(),!1,a)}}),this.element.addEventListener("click",function(a){if(a.target.tagName==="INPUT"){a.target.checked?a.target.setAttribute("checked","checked"):a.target.removeAttribute("checked"),i.preventInput=!0,Wn(n);return}var o=(0,U.RN)(n),c=(0,y.KJ)(a.target,"vditor-ir__preview");if(c||(c=(0,y.KJ)(o.startContainer,"vditor-ir__preview")),c&&(c.previousElementSibling.firstElementChild?o.selectNodeContents(c.previousElementSibling.firstElementChild):o.selectNodeContents(c.previousElementSibling),o.collapse(!0),(0,U.jl)(o),Ge(n)),a.target.tagName==="IMG"){var x=a.target.parentElement.querySelector(".vditor-ir__marker--link");x&&(o.selectNode(x),(0,U.jl)(o))}var A=(0,y.Th)(a.target,"data-type","a");if(A&&!A.classList.contains("vditor-ir__node--expand")){n.options.link.click?n.options.link.click(A.querySelector(":scope > .vditor-ir__marker--link")):n.options.link.isOpen&&window.open(A.querySelector(":scope > .vditor-ir__marker--link").textContent);return}if(a.target.isEqualNode(i.element)&&i.element.lastElementChild&&o.collapsed){var D=i.element.lastElementChild.getBoundingClientRect();a.y>D.top+D.height&&(i.element.lastElementChild.tagName==="P"&&i.element.lastElementChild.textContent.trim().replace(u.Y.ZWSP,"")===""?(o.selectNodeContents(i.element.lastElementChild),o.collapse(!1)):(i.element.insertAdjacentHTML("beforeend",'<p data-block="0">'.concat(u.Y.ZWSP,"<wbr></p>")),(0,U.ir)(i.element,o)))}o.toString()===""?ee(o,n):setTimeout(function(){ee((0,U.RN)(n),n)}),re(a,n),an(n)}),this.element.addEventListener("keyup",function(a){if(!(a.isComposing||(0,f._0)(a))){if(a.key==="Enter"&&Ge(n),an(n),(a.key==="Backspace"||a.key==="Delete")&&n.ir.element.innerHTML!==""&&n.ir.element.childNodes.length===1&&n.ir.element.firstElementChild&&n.ir.element.firstElementChild.tagName==="P"&&n.ir.element.firstElementChild.childElementCount===0&&(n.ir.element.textContent===""||n.ir.element.textContent===`
`)){n.ir.element.innerHTML="";return}var o=(0,U.RN)(n);a.key==="Backspace"?((0,f.gm)()&&o.startContainer.textContent===`
`&&o.startOffset===1&&(o.startContainer.textContent="",ee(o,n)),i.element.querySelectorAll(".language-math").forEach(function(x){var A=x.querySelector("br");A&&A.remove()})):a.key.indexOf("Arrow")>-1?((a.key==="ArrowLeft"||a.key==="ArrowRight")&&Ci(n),ee(o,n)):a.keyCode===229&&a.code===""&&a.key==="Unidentified"&&ee(o,n);var c=(0,y.KJ)(o.startContainer,"vditor-ir__preview");if(c){if(a.key==="ArrowUp"||a.key==="ArrowLeft")return c.previousElementSibling.firstElementChild?o.selectNodeContents(c.previousElementSibling.firstElementChild):o.selectNodeContents(c.previousElementSibling),o.collapse(!1),a.preventDefault(),!0;if(c.tagName==="SPAN"&&(a.key==="ArrowDown"||a.key==="ArrowRight"))return c.parentElement.getAttribute("data-type")==="html-entity"?(c.parentElement.insertAdjacentText("afterend",u.Y.ZWSP),o.setStart(c.parentElement.nextSibling,1)):o.selectNodeContents(c.parentElement.lastElementChild),o.collapse(!1),a.preventDefault(),!0}}})},t}(),ro=function(t){if(t.currentMode==="sv")return t.lute.Md2HTML(S(t));if(t.currentMode==="wysiwyg")return t.lute.VditorDOM2HTML(t.wysiwyg.element.innerHTML);if(t.currentMode==="ir")return t.lute.VditorIRDOM2HTML(t.ir.element.innerHTML)},Zs=l(796),ao=l(70),Js=function(){function t(n){this.element=document.createElement("div"),this.element.className="vditor-outline",this.element.innerHTML='<div class="vditor-outline__title">'.concat(n,`</div>
<div class="vditor-outline__content"></div>`)}return t.prototype.render=function(n){var i="";return n.preview.element.style.display==="block"?i=(0,ao.N)(n.preview.previewElement,this.element.lastElementChild,n):i=(0,ao.N)(n[n.currentMode].element,this.element.lastElementChild,n),i},t.prototype.toggle=function(n,i,a){var o;i===void 0&&(i=!0),a===void 0&&(a=!0);var c=(o=n.toolbar.elements.outline)===null||o===void 0?void 0:o.firstElementChild;if(i&&window.innerWidth>=u.Y.MOBILE_WIDTH?(this.element.style.display="block",this.render(n),c==null||c.classList.add("vditor-menu--current")):(this.element.style.display="none",c==null||c.classList.remove("vditor-menu--current")),a&&getSelection().rangeCount>0){var x=getSelection().getRangeAt(0);n[n.currentMode].element.contains(x.startContainer)&&(0,U.jl)(x)}ft(n)},t}(),Qs=l(0),el=function(){function t(n){var i=this;this.element=document.createElement("div"),this.element.className="vditor-preview",this.previewElement=document.createElement("div"),this.previewElement.className="vditor-reset",n.options.classes.preview&&this.previewElement.classList.add(n.options.classes.preview),this.previewElement.style.maxWidth=n.options.preview.maxWidth+"px",this.previewElement.addEventListener("copy",function(D){if(D.target.tagName!=="TEXTAREA"){var L=document.createElement("div");L.className="vditor-reset",L.appendChild(getSelection().getRangeAt(0).cloneContents()),i.copyToX(n,L,"default"),D.preventDefault()}}),this.previewElement.addEventListener("click",function(D){var L=(0,y._Y)(D.target,"SPAN");if(L&&(0,y.KJ)(L,"vditor-toc")){var $=i.previewElement.querySelector("#"+L.getAttribute("data-target-id"));$&&(i.element.scrollTop=$.offsetTop);return}if(D.target.tagName==="A"){n.options.link.click?n.options.link.click(D.target):n.options.link.isOpen&&window.open(D.target.getAttribute("href")),D.preventDefault();return}D.target.tagName==="IMG"&&(n.options.image.preview?n.options.image.preview(D.target):n.options.image.isPreview&&(0,ve.o)(D.target,n.options.lang,n.options.theme))}),this.element.appendChild(this.previewElement);var a=n.options.preview.actions;if(a.length!==0){var o=document.createElement("div");o.className="vditor-preview__action";for(var c=[],x=0;x<a.length;x++){var A=a[x];if(typeof A=="object"){c.push('<button type="button" data-type="'.concat(A.key,'" class="').concat(A.className,'"').concat(A.tooltip?' aria-label="'.concat(A.tooltip,'"'):"",'">').concat(A.text,"</button>"));continue}switch(A){case"desktop":c.push('<button type="button" class="vditor-preview__action--current" data-type="desktop">Desktop</button>');break;case"tablet":c.push('<button type="button" data-type="tablet">Tablet</button>');break;case"mobile":c.push('<button type="button" data-type="mobile">Mobile/Wechat</button>');break;case"mp-wechat":c.push('<button type="button" data-type="mp-wechat" class="vditor-tooltipped vditor-tooltipped__w" aria-label="复制到公众号"><svg><use xlink:href="#vditor-icon-mp-wechat"></use></svg></button>');break;case"zhihu":c.push('<button type="button" data-type="zhihu" class="vditor-tooltipped vditor-tooltipped__w" aria-label="复制到知乎"><svg><use xlink:href="#vditor-icon-zhihu"></use></svg></button>');break}}o.innerHTML=c.join(""),o.addEventListener((0,f.y3)(),function(D){var L=(0,O.f)(D.target,"BUTTON");if(L){var $=L.getAttribute("data-type"),K=a.find(function(me){return(me==null?void 0:me.key)===$});if(K){K.click($);return}if($==="mp-wechat"||$==="zhihu"){i.copyToX(n,i.previewElement.cloneNode(!0),$);return}$==="desktop"?i.previewElement.style.width="auto":$==="tablet"?i.previewElement.style.width="780px":i.previewElement.style.width="360px",i.previewElement.scrollWidth>i.previewElement.parentElement.clientWidth&&(i.previewElement.style.width="auto"),i.render(n),o.querySelectorAll("button").forEach(function(me){me.classList.remove("vditor-preview__action--current")}),L.classList.add("vditor-preview__action--current")}}),this.element.insertBefore(o,this.previewElement)}}return t.prototype.render=function(n,i){var a=this;if(clearTimeout(this.mdTimeoutId),this.element.style.display==="none"){this.element.getAttribute("data-type")==="renderPerformance"&&n.tip.hide();return}if(i){this.previewElement.innerHTML=i;return}if(S(n).replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")===""){this.previewElement.innerHTML="";return}var o=new Date().getTime(),c=S(n);this.mdTimeoutId=window.setTimeout(function(){if(n.options.preview.url){var x=new XMLHttpRequest;x.open("POST",n.options.preview.url),x.setRequestHeader("Content-Type","application/json;charset=UTF-8"),x.onreadystatechange=function(){if(x.readyState===XMLHttpRequest.DONE)if(x.status===200){var D=JSON.parse(x.responseText);if(D.code!==0){n.tip.show(D.msg);return}n.options.preview.transform&&(D.data=n.options.preview.transform(D.data)),a.previewElement.innerHTML=D.data,a.afterRender(n,o)}else{var L=n.lute.Md2HTML(c);n.options.preview.transform&&(L=n.options.preview.transform(L)),a.previewElement.innerHTML=L,a.afterRender(n,o)}},x.send(JSON.stringify({markdownText:c}))}else{var A=n.lute.Md2HTML(c);n.options.preview.transform&&(A=n.options.preview.transform(A)),a.previewElement.innerHTML=A,a.afterRender(n,o)}},n.options.preview.delay)},t.prototype.afterRender=function(n,i){n.options.preview.parse&&n.options.preview.parse(this.element);var a=new Date().getTime()-i;new Date().getTime()-i>2600?(n.tip.show(window.VditorI18n.performanceTip.replace("${x}",a.toString())),n.preview.element.setAttribute("data-type","renderPerformance")):n.preview.element.getAttribute("data-type")==="renderPerformance"&&(n.tip.hide(),n.preview.element.removeAttribute("data-type"));var o=n.preview.element.querySelector(".vditor-comment--focus");o&&o.classList.remove("vditor-comment--focus"),(0,j.o)(n.preview.previewElement,n.options.preview.hljs),(0,le.$)(n.options.preview.hljs,n.preview.previewElement,n.options.cdn),(0,Re.e)(n.preview.previewElement,n.options.cdn,n.options.theme),(0,Be.K)(n.preview.previewElement,n.options.cdn),(0,Ie.Y)(n.preview.previewElement,n.options.cdn,n.options.theme),(0,z.D)(n.preview.previewElement,n.options.cdn),(0,F.m)(n.preview.previewElement,n.options.cdn),(0,I.v)(n.preview.previewElement,n.options.cdn,n.options.theme),(0,Ce.l)(n.preview.previewElement,n.options.cdn,n.options.theme),(0,De.M)(n.preview.previewElement,n.options.cdn),(0,V.$)(n.preview.previewElement,n.options.cdn),n.options.preview.render.media.enable&&(0,Qs.l)(n.preview.previewElement),n.options.customRenders.forEach(function(A){A.render(n.preview.previewElement,n)});var c=n.preview.element,x=n.outline.render(n);x===""&&(x="[ToC]"),c.querySelectorAll('[data-type="toc-block"]').forEach(function(A){A.innerHTML=x,(0,de.T)(A,{cdn:n.options.cdn,math:n.options.preview.math})}),(0,de.T)(n.preview.previewElement,{cdn:n.options.cdn,math:n.options.preview.math})},t.prototype.copyToX=function(n,i,a){a===void 0&&(a="mp-wechat"),a!=="zhihu"?i.querySelectorAll(".katex-html .base").forEach(function(c){c.style.display="initial"}):i.querySelectorAll(".language-math").forEach(function(c){c.outerHTML='<img class="Formula-image" data-eeimg="true" src="//www.zhihu.com/equation?tex=" alt="'.concat(c.getAttribute("data-math"),'\\" style="display: block; margin: 0 auto; max-width: 100%;">')}),i.style.backgroundColor="#fff",i.querySelectorAll("code").forEach(function(c){c.style.backgroundImage="none"}),this.element.append(i);var o=i.ownerDocument.createRange();o.selectNode(i),(0,U.jl)(o),document.execCommand("copy"),i.remove(),n.tip.show(["zhihu","mp-wechat"].includes(a)?"已复制，可到".concat(a==="zhihu"?"知乎":"微信公众号平台","进行粘贴"):"已复制到剪切板")},t}(),tl=function(){function t(n){this.element=document.createElement("div"),this.element.className="vditor-resize vditor-resize--".concat(n.options.resize.position),this.element.innerHTML='<div><svg><use xlink:href="#vditor-icon-resize"></use></svg></div>',this.bindEvent(n)}return t.prototype.bindEvent=function(n){var i=this;this.element.addEventListener("mousedown",function(a){var o=document,c=a.clientY,x=n.element.offsetHeight,A=63+n.element.querySelector(".vditor-toolbar").clientHeight;o.ondragstart=function(){return!1},window.captureEvents&&window.captureEvents(),i.element.classList.add("vditor-resize--selected"),o.onmousemove=function(D){n.options.resize.position==="top"?n.element.style.height=Math.max(A,x+(c-D.clientY))+"px":n.element.style.height=Math.max(A,x+(D.clientY-c))+"px",n.options.typewriterMode&&(n.sv.element.style.paddingBottom=n.sv.element.parentElement.offsetHeight/2+"px")},o.onmouseup=function(){n.options.resize.after&&n.options.resize.after(n.element.offsetHeight-x),window.captureEvents&&window.captureEvents(),o.onmousemove=null,o.onmouseup=null,o.ondragstart=null,o.onselectstart=null,o.onselect=null,i.element.classList.remove("vditor-resize--selected")}})},t}(),nl=function(){function t(n){this.composingLock=!1,this.element=document.createElement("pre"),this.element.className="vditor-sv vditor-reset",this.element.setAttribute("placeholder",n.options.placeholder),this.element.setAttribute("contenteditable","true"),this.element.setAttribute("spellcheck","false"),this.bindEvent(n),ln(n,this.element),ui(n,this.element),ut(n,this.element),Gt(n,this.element),Hn(n,this.element),zt(n,this.element,this.copy),Wt(n,this.element,this.copy)}return t.prototype.copy=function(n,i){n.stopPropagation(),n.preventDefault(),n.clipboardData.setData("text/plain",sn(i[i.currentMode].element))},t.prototype.bindEvent=function(n){var i=this;this.element.addEventListener("paste",function(a){hn(n,a,{pasteCode:function(o){document.execCommand("insertHTML",!1,o)}})}),this.element.addEventListener("scroll",function(){if(n.preview.element.style.display==="block"){var a=i.element.scrollTop,o=i.element.clientHeight,c=i.element.scrollHeight-parseFloat(i.element.style.paddingBottom||"0"),x=n.preview.element;a/o>.5?x.scrollTop=(a+o)*x.scrollHeight/c-o:x.scrollTop=a*x.scrollHeight/c}}),this.element.addEventListener("compositionstart",function(a){i.composingLock=!0}),this.element.addEventListener("compositionend",function(a){(0,f.gm)()||Ve(n,a),i.composingLock=!1}),this.element.addEventListener("input",function(a){if(!(a.inputType==="deleteByDrag"||a.inputType==="insertFromDrop")&&!(i.composingLock||a.data==="‘"||a.data==="“"||a.data==="《")){if(i.preventInput){i.preventInput=!1,Ue(n,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0});return}Ve(n,a)}}),this.element.addEventListener("keyup",function(a){if(!(a.isComposing||(0,f._0)(a))){if((a.key==="Backspace"||a.key==="Delete")&&n.sv.element.innerHTML!==""&&n.sv.element.childNodes.length===1&&n.sv.element.firstElementChild&&n.sv.element.firstElementChild.tagName==="DIV"&&n.sv.element.firstElementChild.childElementCount===2&&(n.sv.element.firstElementChild.textContent===""||n.sv.element.textContent===`
`)){n.sv.element.innerHTML="";return}a.key==="Enter"&&Ge(n)}})},t}(),oo=function(){function t(){this.element=document.createElement("div"),this.element.className="vditor-tip"}return t.prototype.show=function(n,i){var a=this;i===void 0&&(i=6e3),this.element.className="vditor-tip vditor-tip--show",i===0?(this.element.innerHTML='<div class="vditor-tip__content">'.concat(n,`
<div class="vditor-tip__close">X</div></div>`),this.element.querySelector(".vditor-tip__close").addEventListener("click",function(){a.hide()})):(this.element.innerHTML='<div class="vditor-tip__content">'.concat(n,"</div>"),setTimeout(function(){a.hide()},i)),this.element.removeAttribute("style"),setTimeout(function(){var o=a.element.getBoundingClientRect();o.top<46&&(a.element.style.position="fixed",a.element.style.top="46px")},150)},t.prototype.hide=function(){this.element.className="vditor-messageElementtip",this.element.innerHTML=""},t}(),pa=function(t,n){if(n.options.preview.mode!==t){switch(n.options.preview.mode=t,t){case"both":n.sv.element.style.display="block",n.preview.element.style.display="block",n.preview.render(n),b(n.toolbar.elements,["both"]);break;case"editor":n.sv.element.style.display="block",n.preview.element.style.display="none",g(n.toolbar.elements,["both"]);break}n.devtools&&n.devtools.renderEchart(n)}},il=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),rl=function(t){il(n,t);function n(i,a){var o=t.call(this,i,a)||this;return i.options.preview.mode==="both"&&o.element.children[0].classList.add("vditor-menu--current"),o.element.children[0].addEventListener((0,f.y3)(),function(c){var x=o.element.firstElementChild;x.classList.contains(u.Y.CLASS_MENU_DISABLED)||(c.preventDefault(),i.currentMode==="sv"&&(i.options.preview.mode==="both"?pa("editor",i):pa("both",i)))}),o}return n}(vt),al=function(){function t(){this.element=document.createElement("div"),this.element.className="vditor-toolbar__br"}return t}(),so=l(13),ol=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),sl=function(t){ol(n,t);function n(i,a){var o=t.call(this,i,a)||this,c=o.element.children[0],x=document.createElement("div");x.className="vditor-hint".concat(a.level===2?"":" vditor-panel--arrow");var A="";return u.Y.CODE_THEME.forEach(function(D){A+="<button>".concat(D,"</button>")}),x.innerHTML='<div style="overflow: auto;max-height:'.concat(window.innerHeight/2,'px">').concat(A,"</div>"),x.addEventListener((0,f.y3)(),function(D){D.target.tagName==="BUTTON"&&(T(i,["subToolbar"]),i.options.preview.hljs.style=D.target.textContent,(0,so.h)(D.target.textContent,i.options.cdn),D.preventDefault(),D.stopPropagation())}),o.element.appendChild(x),M(i,x,c,a.level),o}return n}(vt),ll=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),cl=function(t){ll(n,t);function n(i,a){var o=t.call(this,i,a)||this,c=o.element.children[0],x=document.createElement("div");x.className="vditor-hint".concat(a.level===2?"":" vditor-panel--arrow");var A="";return Object.keys(i.options.preview.theme.list).forEach(function(D){A+='<button data-type="'.concat(D,'">').concat(i.options.preview.theme.list[D],"</button>")}),x.innerHTML='<div style="overflow: auto;max-height:'.concat(window.innerHeight/2,'px">').concat(A,"</div>"),x.addEventListener((0,f.y3)(),function(D){D.target.tagName==="BUTTON"&&(T(i,["subToolbar"]),i.options.preview.theme.current=D.target.getAttribute("data-type"),(0,Oe.H)(i.options.preview.theme.current,i.options.preview.theme.path),D.preventDefault(),D.stopPropagation())}),o.element.appendChild(x),M(i,x,c,a.level),o}return n}(vt),ul=function(){function t(n){this.element=document.createElement("span"),this.element.className="vditor-counter vditor-tooltipped vditor-tooltipped__nw",this.render(n,"")}return t.prototype.render=function(n,i){var a=i.endsWith(`
`)?i.length-1:i.length;if(n.options.counter.type==="text"&&n[n.currentMode]){var o=n[n.currentMode].element.cloneNode(!0);o.querySelectorAll(".vditor-wysiwyg__preview").forEach(function(c){c.remove()}),a=o.textContent.length}typeof n.options.counter.max=="number"?(a>n.options.counter.max?this.element.className="vditor-counter vditor-counter--error":this.element.className="vditor-counter",this.element.innerHTML="".concat(a,"/").concat(n.options.counter.max)):this.element.innerHTML="".concat(a),this.element.setAttribute("aria-label",n.options.counter.type),n.options.counter.after&&n.options.counter.after(a,{enable:n.options.counter.enable,max:n.options.counter.max,type:n.options.counter.type})},t}(),dl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),fl=function(t){dl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o.element.children[0].innerHTML=a.icon,o.element.children[0].addEventListener((0,f.y3)(),function(c){c.preventDefault(),!c.currentTarget.classList.contains(u.Y.CLASS_MENU_DISABLED)&&a.click(c,i)}),o}return n}(vt),hl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),pl=function(t){hl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o.element.firstElementChild.addEventListener((0,f.y3)(),function(c){var x=o.element.firstElementChild;x.classList.contains(u.Y.CLASS_MENU_DISABLED)||(c.preventDefault(),x.classList.contains("vditor-menu--current")?(x.classList.remove("vditor-menu--current"),i.devtools.element.style.display="none",ft(i)):(x.classList.add("vditor-menu--current"),i.devtools.element.style.display="block",ft(i),i.devtools.renderEchart(i)))}),o}return n}(vt),ml=function(){function t(){this.element=document.createElement("div"),this.element.className="vditor-toolbar__divider"}return t}(),gl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),vl=function(t){gl(n,t);function n(i,a){var o=t.call(this,i,a)||this,c=document.createElement("div");c.className="vditor-panel vditor-panel--arrow";var x="";return Object.keys(i.options.hint.emoji).forEach(function(A){var D=i.options.hint.emoji[A];D.indexOf(".")>-1?x+='<button data-value=":'.concat(A,': " data-key=":').concat(A,`:"><img
data-value=":`).concat(A,': " data-key=":').concat(A,':" class="vditor-emojis__icon" src="').concat(D,'"/></button>'):x+='<button data-value="'.concat(D,` "
 data-key="`).concat(A,'"><span class="vditor-emojis__icon">').concat(D,"</span></button>")}),c.innerHTML='<div class="vditor-emojis" style="max-height: '.concat(i.options.height==="auto"?"auto":i.options.height-80,'px">').concat(x,`</div><div class="vditor-emojis__tail">
    <span class="vditor-emojis__tip"></span><span>`).concat(i.options.hint.emojiTail||"",`</span>
</div>`),o.element.appendChild(c),M(i,c,o.element.firstElementChild,a.level),o.bindEvent(i),o}return n.prototype.bindEvent=function(i){var a=this;this.element.lastElementChild.addEventListener((0,f.y3)(),function(o){var c=(0,O.f)(o.target,"BUTTON");if(c){o.preventDefault();var x=c.getAttribute("data-value"),A=(0,U.RN)(i),D=x;if(i.currentMode==="wysiwyg"?D=i.lute.SpinVditorDOM(x):i.currentMode==="ir"&&(D=i.lute.SpinVditorIRDOM(x)),x.indexOf(":")>-1&&i.currentMode!=="sv"){var L=document.createElement("div");L.innerHTML=D,D=L.firstElementChild.firstElementChild.outerHTML+" ",(0,U.Z2)(D,i)}else A.extractContents(),A.insertNode(document.createTextNode(x)),(0,y.pt)(A.startContainer)||Nt(i,A);A.collapse(!1),(0,U.jl)(A),a.element.lastElementChild.style.display="none",ct(i)}}),this.element.lastElementChild.addEventListener("mouseover",function(o){var c=(0,O.f)(o.target,"BUTTON");c&&(a.element.querySelector(".vditor-emojis__tip").innerHTML=c.getAttribute("data-key"))})},n}(vt),lo=function(t,n,i){var a=document.createElement("a");"download"in a?(a.download=i,a.style.display="none",a.href=URL.createObjectURL(new Blob([n])),document.body.appendChild(a),a.click(),a.remove()):t.tip.show(window.VditorI18n.downloadTip,0)},bl=function(t){var n=S(t);lo(t,n,n.substr(0,10)+".md")},yl=function(t){t.tip.show(window.VditorI18n.generate,3800);var n=document.querySelector("#vditorExportIframe");n.contentDocument.open(),n.contentDocument.write('<link rel="stylesheet" href="'.concat(t.options.cdn,`/dist/index.css"/>
<script src="`).concat(t.options.cdn,`/dist/method.min.js"><\/script>
<div id="preview" style="width: 800px"></div>
<script>
window.addEventListener("message", (e) => {
  if(!e.data) {
    return;
  }
  Vditor.preview(document.getElementById('preview'), e.data, {
    cdn: "`).concat(t.options.cdn,`",
    markdown: {
      theme: `).concat(JSON.stringify(t.options.preview.theme),`
    },
    hljs: {
      style: "`).concat(t.options.preview.hljs.style,`"
    }
  });
  setTimeout(() => {
        window.print();
    }, 3600);
}, false);
<\/script>`)),n.contentDocument.close(),setTimeout(function(){n.contentWindow.postMessage(S(t),"*")},200)},wl=function(t){var n=ro(t),i='<html><head><link rel="stylesheet" type="text/css" href="'.concat(t.options.cdn,`/dist/index.css"/>
<script src="`).concat(t.options.cdn,"/dist/js/i18n/").concat(t.options.lang,`.js"><\/script>
<script src="`).concat(t.options.cdn,`/dist/method.min.js"><\/script></head>
<body><div class="vditor-reset" id="preview">`).concat(n,`</div>
<script>
    const previewElement = document.getElementById('preview')
    Vditor.setContentTheme('`).concat(t.options.preview.theme.current,"', '").concat(t.options.preview.theme.path,`');
    Vditor.codeRender(previewElement);
    Vditor.highlightRender(`).concat(JSON.stringify(t.options.preview.hljs),", previewElement, '").concat(t.options.cdn,`');
    Vditor.mathRender(previewElement, {
        cdn: '`).concat(t.options.cdn,`',
        math: `).concat(JSON.stringify(t.options.preview.math),`,
    });
    Vditor.mermaidRender(previewElement, '`).concat(t.options.cdn,"', '").concat(t.options.theme,`');
    Vditor.SMILESRender(previewElement, '`).concat(t.options.cdn,"', '").concat(t.options.theme,`');
    Vditor.markmapRender(previewElement, '`).concat(t.options.cdn,`');
    Vditor.flowchartRender(previewElement, '`).concat(t.options.cdn,`');
    Vditor.graphvizRender(previewElement, '`).concat(t.options.cdn,`');
    Vditor.chartRender(previewElement, '`).concat(t.options.cdn,"', '").concat(t.options.theme,`');
    Vditor.mindmapRender(previewElement, '`).concat(t.options.cdn,"', '").concat(t.options.theme,`');
    Vditor.abcRender(previewElement, '`).concat(t.options.cdn,`');
    `).concat(t.options.preview.render.media.enable?"Vditor.mediaRender(previewElement);":"",`
    Vditor.speechRender(previewElement);
<\/script>
<script src="`).concat(t.options.cdn,"/dist/js/icons/").concat(t.options.icon,'.js"><\/script></body></html>');lo(t,i,n.substr(0,10)+".html")},El=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),kl=function(t){El(n,t);function n(i,a){var o=t.call(this,i,a)||this,c=o.element.children[0],x=document.createElement("div");return x.className="vditor-hint".concat(a.level===2?"":" vditor-panel--arrow"),x.innerHTML=`<button data-type="markdown">Markdown</button>
<button data-type="pdf">PDF</button>
<button data-type="html">HTML</button>`,x.addEventListener((0,f.y3)(),function(A){var D=A.target;if(D.tagName==="BUTTON"){switch(D.getAttribute("data-type")){case"markdown":bl(i);break;case"pdf":yl(i);break;case"html":wl(i);break}T(i,["subToolbar"]),A.preventDefault(),A.stopPropagation()}}),o.element.appendChild(x),M(i,x,c,a.level),o}return n}(vt),Sl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),xl=function(t){Sl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o._bindEvent(i,a),o}return n.prototype._bindEvent=function(i,a){this.element.children[0].addEventListener((0,f.y3)(),function(o){o.preventDefault(),i.element.className.includes("vditor--fullscreen")?(a.level||(this.innerHTML=a.icon),i.element.style.zIndex="",document.body.style.overflow="",i.element.classList.remove("vditor--fullscreen"),Object.keys(i.toolbar.elements).forEach(function(c){var x=i.toolbar.elements[c].firstChild;x&&(x.className=x.className.replace("__s","__n"),i.options.toolbar.forEach(function(A){typeof A!="string"&&A.tipPosition&&A.name===x.dataset.type&&(x.className="vditor-tooltipped vditor-tooltipped__".concat(A.tipPosition))}))}),i.counter&&(i.counter.element.className=i.counter.element.className.replace("__s","__n"))):(a.level||(this.innerHTML='<svg><use xlink:href="#vditor-icon-contract"></use></svg>'),i.element.style.zIndex=i.options.fullscreen.index.toString(),document.body.style.overflow="hidden",i.element.classList.add("vditor--fullscreen"),Object.keys(i.toolbar.elements).forEach(function(c){var x=i.toolbar.elements[c].firstChild;x&&(x.className=x.className.replace("__n","__s"))}),i.counter&&(i.counter.element.className=i.counter.element.className.replace("__n","__s"))),i.devtools&&i.devtools.renderEchart(i),a.click&&a.click(o,i),ft(i),ht(i)})},n}(vt),_l=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Cl=function(t){_l(n,t);function n(i,a){var o=t.call(this,i,a)||this,c=document.createElement("div");return c.className="vditor-hint vditor-panel--arrow",c.innerHTML='<button data-tag="h1" data-value="# ">'.concat(window.VditorI18n.heading1," ").concat((0,f.fG)("&lt;⌥⌘1>"),`</button>
<button data-tag="h2" data-value="## ">`).concat(window.VditorI18n.heading2," &lt;").concat((0,f.fG)("⌥⌘2"),`></button>
<button data-tag="h3" data-value="### ">`).concat(window.VditorI18n.heading3," &lt;").concat((0,f.fG)("⌥⌘3"),`></button>
<button data-tag="h4" data-value="#### ">`).concat(window.VditorI18n.heading4," &lt;").concat((0,f.fG)("⌥⌘4"),`></button>
<button data-tag="h5" data-value="##### ">`).concat(window.VditorI18n.heading5," &lt;").concat((0,f.fG)("⌥⌘5"),`></button>
<button data-tag="h6" data-value="###### ">`).concat(window.VditorI18n.heading6," &lt;").concat((0,f.fG)("⌥⌘6"),"></button>"),o.element.appendChild(c),o._bindEvent(i,c),o}return n.prototype._bindEvent=function(i,a){var o=this.element.children[0];o.addEventListener((0,f.y3)(),function(x){x.preventDefault(),clearTimeout(i.wysiwyg.afterRenderTimeoutId),clearTimeout(i.ir.processTimeoutId),clearTimeout(i.sv.processTimeoutId),!o.classList.contains(u.Y.CLASS_MENU_DISABLED)&&(o.blur(),o.classList.contains("vditor-menu--current")?(i.currentMode==="wysiwyg"?(ei(i),rt(i)):i.currentMode==="ir"&&jn(i,""),o.classList.remove("vditor-menu--current")):(T(i,["subToolbar"]),a.style.display="block"))});for(var c=0;c<6;c++)a.children.item(c).addEventListener((0,f.y3)(),function(x){x.preventDefault(),i.currentMode==="wysiwyg"?(Mt(i,x.target.getAttribute("data-tag")),rt(i),o.classList.add("vditor-menu--current")):i.currentMode==="ir"?(jn(i,x.target.getAttribute("data-value")),o.classList.add("vditor-menu--current")):nt(i,x.target.getAttribute("data-value")),a.style.display="none"})},n}(vt),Tl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Ml=function(t){Tl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o.element.children[0].addEventListener((0,f.y3)(),function(c){c.preventDefault(),i.tip.show(`<div style="margin-bottom:14px;font-size: 14px;line-height: 22px;min-width:300px;max-width: 360px;display: flex;">
<div style="margin-top: 14px;flex: 1">
    <div>Markdown 使用指南</div>
    <ul style="list-style: none">
        <li><a href="https://ld246.com/article/1583308420519" target="_blank">语法速查手册</a></li>
        <li><a href="https://ld246.com/article/1583129520165" target="_blank">基础语法</a></li>
        <li><a href="https://ld246.com/article/1583305480675" target="_blank">扩展语法</a></li>
        <li><a href="https://ld246.com/article/1582778815353" target="_blank">键盘快捷键</a></li>
    </ul>
</div>
<div style="margin-top: 14px;flex: 1">
    <div>Vditor 支持</div>
    <ul style="list-style: none">
        <li><a href="https://github.com/Vanessa219/vditor/issues" target="_blank">Issues</a></li>
        <li><a href="https://ld246.com/tag/vditor" target="_blank">官方讨论区</a></li>
        <li><a href="https://ld246.com/article/1549638745630" target="_blank">开发手册</a></li>
        <li><a href="https://ld246.com/guide/markdown" target="_blank">演示地址</a></li>
    </ul>
</div></div>`,0)}),o}return n}(vt),Al=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Ll=function(t){Al(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o.element.children[0].addEventListener((0,f.y3)(),function(c){if(c.preventDefault(),!(o.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")){var x=(0,U.RN)(i),A=(0,y._Y)(x.startContainer,"LI");A&&Vi(i,A,x)}}),o}return n}(vt),Dl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Ol=function(t){Dl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o.element.children[0].addEventListener((0,f.y3)(),function(c){c.preventDefault(),i.tip.show(`<div style="max-width: 520px; font-size: 14px;line-height: 22px;margin-bottom: 14px;">
<p style="text-align: center;margin: 14px 0">
    <em>下一代的 Markdown 编辑器，为未来而构建</em>
</p>
<div style="display: flex;margin-bottom: 14px;flex-wrap: wrap;align-items: center">
    <img src="https://unpkg.com/vditor/dist/images/logo.png" style="margin: 0 auto;height: 68px"/>
    <div>&nbsp;&nbsp;</div>
    <div style="flex: 1;min-width: 250px">
        Vditor 是一款浏览器端的 Markdown 编辑器，支持所见即所得、即时渲染（类似 Typora）和分屏预览模式。
        它使用 TypeScript 实现，支持原生 JavaScript 以及 Vue、React、Angular 和 Svelte 等框架。
    </div>
</div>
<div style="display: flex;flex-wrap: wrap;">
    <ul style="list-style: none;flex: 1;min-width:148px">
        <li>
        项目地址：<a href="https://b3log.org/vditor" target="_blank">b3log.org/vditor</a>
        </li>
        <li>
        开源协议：MIT
        </li>
    </ul>
    <ul style="list-style: none;margin-right: 18px">
        <li>
        组件版本：Vditor v`.concat(u.g," / Lute v").concat(Lute.Version,`
        </li>
        <li>
        赞助捐赠：<a href="https://ld246.com/sponsor" target="_blank">https://ld246.com/sponsor</a>
        </li>
    </ul>
</div>
</div>`),0)}),o}return n}(vt),Pl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Rl=function(t){Pl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o.element.children[0].addEventListener((0,f.y3)(),function(c){c.preventDefault(),!(o.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")&&fi(i,"afterend")}),o}return n}(vt),Il=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Hl=function(t){Il(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o.element.children[0].addEventListener((0,f.y3)(),function(c){c.preventDefault(),!(o.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")&&fi(i,"beforebegin")}),o}return n}(vt),Nl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),jl=function(t){Nl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o.element.children[0].addEventListener((0,f.y3)(),function(c){if(c.preventDefault(),!(o.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")){var x=(0,U.RN)(i),A=(0,y._Y)(x.startContainer,"LI");A&&fr(i,A,x,A.parentElement)}}),o}return n}(vt),$l=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Bl=function(t){$l(n,t);function n(i,a){var o=t.call(this,i,a)||this;return i.options.outline&&o.element.firstElementChild.classList.add("vditor-menu--current"),o.element.children[0].addEventListener((0,f.y3)(),function(c){c.preventDefault();var x=i.toolbar.elements.outline.firstElementChild;x.classList.contains(u.Y.CLASS_MENU_DISABLED)||(i.options.outline.enable=!o.element.firstElementChild.classList.contains("vditor-menu--current"),i.outline.toggle(i,i.options.outline.enable))}),o}return n}(vt),Ul=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),zl=function(t){Ul(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o._bindEvent(i),o}return n.prototype._bindEvent=function(i){var a=this;this.element.children[0].addEventListener((0,f.y3)(),function(o){o.preventDefault();var c=a.element.firstElementChild;if(!c.classList.contains(u.Y.CLASS_MENU_DISABLED)){var x=u.Y.EDIT_TOOLBARS.concat(["both","edit-mode","devtools"]);c.classList.contains("vditor-menu--current")?(c.classList.remove("vditor-menu--current"),i.currentMode==="sv"?(i.sv.element.style.display="block",i.options.preview.mode==="both"?i.preview.element.style.display="block":i.preview.element.style.display="none"):(i[i.currentMode].element.parentElement.style.display="block",i.preview.element.style.display="none"),k(i.toolbar.elements,x),i.outline.render(i)):(w(i.toolbar.elements,x),i.preview.element.style.display="block",i.currentMode==="sv"?i.sv.element.style.display="none":i[i.currentMode].element.parentElement.style.display="none",i.preview.render(i),c.classList.add("vditor-menu--current"),T(i,["subToolbar","hint","popover"]),setTimeout(function(){i.outline.render(i)},i.options.preview.delay+10)),ft(i)}})},n}(vt),Fl=function(){function t(n){this.SAMPLE_RATE=5e3,this.isRecording=!1,this.readyFlag=!1,this.leftChannel=[],this.rightChannel=[],this.recordingLength=0;var i;if(typeof AudioContext<"u")i=new AudioContext;else if(webkitAudioContext)i=new webkitAudioContext;else return;this.DEFAULT_SAMPLE_RATE=i.sampleRate;var a=i.createGain(),o=i.createMediaStreamSource(n);o.connect(a),this.recorder=i.createScriptProcessor(2048,2,1),this.recorder.onaudioprocess=null,a.connect(this.recorder),this.recorder.connect(i.destination),this.readyFlag=!0}return t.prototype.cloneChannelData=function(n,i){this.leftChannel.push(new Float32Array(n)),this.rightChannel.push(new Float32Array(i)),this.recordingLength+=2048},t.prototype.startRecordingNewWavFile=function(){this.readyFlag&&(this.isRecording=!0,this.leftChannel.length=this.rightChannel.length=0,this.recordingLength=0)},t.prototype.stopRecording=function(){this.isRecording=!1},t.prototype.buildWavFileBlob=function(){for(var n=this.mergeBuffers(this.leftChannel),i=this.mergeBuffers(this.rightChannel),a=new Float32Array(n.length),o=0;o<n.length;++o)a[o]=.5*(n[o]+i[o]);this.DEFAULT_SAMPLE_RATE>this.SAMPLE_RATE&&(a=this.downSampleBuffer(a,this.SAMPLE_RATE));var c=44+a.length*2,x=new ArrayBuffer(c),A=new DataView(x);this.writeUTFBytes(A,0,"RIFF"),A.setUint32(4,c,!0),this.writeUTFBytes(A,8,"WAVE"),this.writeUTFBytes(A,12,"fmt "),A.setUint32(16,16,!0),A.setUint16(20,1,!0),A.setUint16(22,1,!0),A.setUint32(24,this.SAMPLE_RATE,!0),A.setUint32(28,this.SAMPLE_RATE*2,!0),A.setUint16(32,2,!0),A.setUint16(34,16,!0);var D=a.length*2;this.writeUTFBytes(A,36,"data"),A.setUint32(40,D,!0);for(var L=a.length,$=44,K=1,me=0;me<L;me++)A.setInt16($,a[me]*(32767*K),!0),$+=2;return new Blob([A],{type:"audio/wav"})},t.prototype.downSampleBuffer=function(n,i){if(i===this.DEFAULT_SAMPLE_RATE||i>this.DEFAULT_SAMPLE_RATE)return n;for(var a=this.DEFAULT_SAMPLE_RATE/i,o=Math.round(n.length/a),c=new Float32Array(o),x=0,A=0;x<c.length;){for(var D=Math.round((x+1)*a),L=0,$=0,K=A;K<D&&K<n.length;K++)L+=n[K],$++;c[x]=L/$,x++,A=D}return c},t.prototype.mergeBuffers=function(n){for(var i=new Float32Array(this.recordingLength),a=0,o=n.length,c=0;c<o;++c){var x=n[c];i.set(x,a),a+=x.length}return i},t.prototype.writeUTFBytes=function(n,i,a){for(var o=a.length,c=0;c<o;c++)n.setUint8(i+c,a.charCodeAt(c))},t}(),Vl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),ql=function(t){Vl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o._bindEvent(i),o}return n.prototype._bindEvent=function(i){var a=this,o;this.element.children[0].addEventListener((0,f.y3)(),function(c){if(c.preventDefault(),!a.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)){var x=i[i.currentMode].element;if(!o){navigator.mediaDevices.getUserMedia({audio:!0}).then(function(D){o=new Fl(D),o.recorder.onaudioprocess=function(L){if(o.isRecording){var $=L.inputBuffer.getChannelData(0),K=L.inputBuffer.getChannelData(1);o.cloneChannelData($,K)}},o.startRecordingNewWavFile(),i.tip.show(window.VditorI18n.recording),x.setAttribute("contenteditable","false"),a.element.children[0].classList.add("vditor-menu--current")}).catch(function(){i.tip.show(window.VditorI18n["record-tip"])});return}if(o.isRecording){o.stopRecording(),i.tip.hide();var A=new File([o.buildWavFileBlob()],"record".concat(new Date().getTime(),".wav"),{type:"video/webm"});Nn(i,[A]),a.element.children[0].classList.remove("vditor-menu--current")}else i.tip.show(window.VditorI18n.recording),x.setAttribute("contenteditable","false"),o.startRecordingNewWavFile(),a.element.children[0].classList.add("vditor-menu--current")}})},n}(vt),Wl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Yl=function(t){Wl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return w({redo:o.element},["redo"]),o.element.children[0].addEventListener((0,f.y3)(),function(c){c.preventDefault(),!o.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)&&i.undo.redo(i)}),o}return n}(vt),Kl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Gl=function(t){Kl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return w({undo:o.element},["undo"]),o.element.children[0].addEventListener((0,f.y3)(),function(c){c.preventDefault(),!o.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)&&i.undo.undo(i)}),o}return n}(vt),Xl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Zl=function(t){Xl(n,t);function n(i,a){var o=t.call(this,i,a)||this,c='<input type="file"';return i.options.upload.multiple&&(c+=' multiple="multiple"'),i.options.upload.accept&&(c+=' accept="'.concat(i.options.upload.accept,'"')),o.element.children[0].innerHTML="".concat(a.icon||'<svg><use xlink:href="#vditor-icon-upload"></use></svg>').concat(c,">"),o._bindEvent(i),o}return n.prototype._bindEvent=function(i){var a=this;this.element.children[0].addEventListener((0,f.y3)(),function(o){if(a.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)){o.stopPropagation(),o.preventDefault();return}}),this.element.querySelector("input").addEventListener("change",function(o){if(a.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)){o.stopPropagation(),o.preventDefault();return}o.target.files.length!==0&&Nn(i,o.target.files,o.target)})},n}(vt),Jl=function(){function t(n){var i=this,a=n.options;this.elements={},this.element=document.createElement("div"),this.element.className="vditor-toolbar",a.toolbar.forEach(function(o,c){var x=i.genItem(n,o,c);if(i.element.appendChild(x),o.toolbar){var A=document.createElement("div");A.className="vditor-hint vditor-panel--arrow",A.addEventListener((0,f.y3)(),function(D){A.style.display="none"}),o.toolbar.forEach(function(D,L){D.level=2,A.appendChild(i.genItem(n,D,c+L))}),x.appendChild(A),M(n,A,x.children[0])}}),n.options.toolbarConfig.hide&&this.element.classList.add("vditor-toolbar--hide"),n.options.toolbarConfig.pin&&this.element.classList.add("vditor-toolbar--pin"),n.options.counter.enable&&(n.counter=new ul(n),this.element.appendChild(n.counter.element))}return t.prototype.updateConfig=function(n,i){n.options.toolbarConfig=Object.assign({hide:!1,pin:!1},i),n.options.toolbarConfig.hide?this.element.classList.add("vditor-toolbar--hide"):this.element.classList.remove("vditor-toolbar--hide"),n.options.toolbarConfig.pin?this.element.classList.add("vditor-toolbar--pin"):this.element.classList.remove("vditor-toolbar--pin")},t.prototype.genItem=function(n,i,a){var o;switch(i.name){case"bold":case"italic":case"more":case"strike":case"line":case"quote":case"list":case"ordered-list":case"check":case"code":case"inline-code":case"link":case"table":o=new vt(n,i);break;case"emoji":o=new vl(n,i);break;case"headings":o=new Cl(n,i);break;case"|":o=new ml;break;case"br":o=new al;break;case"undo":o=new Gl(n,i);break;case"redo":o=new Yl(n,i);break;case"help":o=new Ml(n,i);break;case"both":o=new rl(n,i);break;case"preview":o=new zl(n,i);break;case"fullscreen":o=new xl(n,i);break;case"upload":o=new Zl(n,i);break;case"record":o=new ql(n,i);break;case"info":o=new Ol(n,i);break;case"edit-mode":o=new en(n,i);break;case"devtools":o=new pl(n,i);break;case"outdent":o=new jl(n,i);break;case"indent":o=new Ll(n,i);break;case"outline":o=new Bl(n,i);break;case"insert-after":o=new Rl(n,i);break;case"insert-before":o=new Hl(n,i);break;case"code-theme":o=new sl(n,i);break;case"content-theme":o=new cl(n,i);break;case"export":o=new kl(n,i);break;default:o=new fl(n,i);break}if(o){var c=i.name;return(c==="br"||c==="|")&&(c=c+a),this.elements[c]=o.element,o.element}},t}(),Ql=l(192),ec=function(){function t(){this.stackSize=50,this.resetStack(),this.dmp=new Ql}return t.prototype.clearStack=function(n){this.resetStack(),this.resetIcon(n)},t.prototype.resetIcon=function(n){n.toolbar&&(this[n.currentMode].undoStack.length>1?k(n.toolbar.elements,["undo"]):w(n.toolbar.elements,["undo"]),this[n.currentMode].redoStack.length!==0?k(n.toolbar.elements,["redo"]):w(n.toolbar.elements,["redo"]))},t.prototype.undo=function(n){if(n[n.currentMode].element.getAttribute("contenteditable")!=="false"&&!(this[n.currentMode].undoStack.length<2)){var i=this[n.currentMode].undoStack.pop();i&&(this[n.currentMode].redoStack.push(i),this.renderDiff(i,n),this[n.currentMode].hasUndo=!0,T(n,["hint"]))}},t.prototype.redo=function(n){if(n[n.currentMode].element.getAttribute("contenteditable")!=="false"){var i=this[n.currentMode].redoStack.pop();i&&(this[n.currentMode].undoStack.push(i),this.renderDiff(i,n,!0))}},t.prototype.recordFirstPosition=function(n,i){if(getSelection().rangeCount!==0&&!(this[n.currentMode].undoStack.length!==1||this[n.currentMode].undoStack[0].length===0||this[n.currentMode].redoStack.length>0)&&!((0,f.gm)()&&i.key==="Backspace")&&!(0,f.nr)()){var a=this.addCaret(n);a.replace("<wbr>","").replace(" vditor-ir__node--expand","")===this[n.currentMode].undoStack[0][0].diffs[0][1].replace("<wbr>","")&&(this[n.currentMode].undoStack[0][0].diffs[0][1]=a,this[n.currentMode].lastText=a)}},t.prototype.addToUndoStack=function(n){var i=this.addCaret(n,!0),a=this.dmp.diff_main(i,this[n.currentMode].lastText,!0),o=this.dmp.patch_make(i,this[n.currentMode].lastText,a);o.length===0&&this[n.currentMode].undoStack.length>0||(this[n.currentMode].lastText=i,this[n.currentMode].undoStack.push(o),this[n.currentMode].undoStack.length>this.stackSize&&this[n.currentMode].undoStack.shift(),this[n.currentMode].hasUndo&&(this[n.currentMode].redoStack=[],this[n.currentMode].hasUndo=!1,w(n.toolbar.elements,["redo"])),this[n.currentMode].undoStack.length>1&&k(n.toolbar.elements,["undo"]))},t.prototype.renderDiff=function(n,i,a){a===void 0&&(a=!1);var o;if(a){var c=this.dmp.patch_deepCopy(n).reverse();c.forEach(function(A){A.diffs.forEach(function(D){D[0]=-D[0]})}),o=this.dmp.patch_apply(c,this[i.currentMode].lastText)[0]}else o=this.dmp.patch_apply(n,this[i.currentMode].lastText)[0];if(this[i.currentMode].lastText=o,i[i.currentMode].element.innerHTML=o,i.currentMode!=="sv"&&(i[i.currentMode].element.querySelectorAll(".vditor-".concat(i.currentMode,"__preview")).forEach(function(A){A.parentElement.querySelector(".language-echarts")&&(i.currentMode==="ir"?A.parentElement.outerHTML=i.lute.SpinVditorIRDOM(A.parentElement.outerHTML):A.parentElement.outerHTML=i.lute.SpinVditorDOM(A.parentElement.outerHTML))}),i[i.currentMode].element.querySelectorAll(".vditor-".concat(i.currentMode,"__preview[data-render='2']")).forEach(function(A){tt(A,i)})),i[i.currentMode].element.querySelector("wbr"))(0,U.ir)(i[i.currentMode].element,i[i.currentMode].element.ownerDocument.createRange()),Ge(i);else{var x=getSelection().getRangeAt(0);x.setEndBefore(i[i.currentMode].element),x.collapse(!1)}oe(i),ct(i,{enableAddUndoStack:!1,enableHint:!1,enableInput:!0}),gt(i),i[i.currentMode].element.querySelectorAll(".vditor-".concat(i.currentMode,"__preview[data-render='2']")).forEach(function(A){tt(A,i)}),this[i.currentMode].undoStack.length>1?k(i.toolbar.elements,["undo"]):w(i.toolbar.elements,["undo"]),this[i.currentMode].redoStack.length!==0?k(i.toolbar.elements,["redo"]):w(i.toolbar.elements,["redo"])},t.prototype.resetStack=function(){this.ir={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]},this.sv={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]},this.wysiwyg={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]}},t.prototype.addCaret=function(n,i){i===void 0&&(i=!1);var a;if(getSelection().rangeCount!==0&&!n[n.currentMode].element.querySelector("wbr")){var o=getSelection().getRangeAt(0);if(n[n.currentMode].element.contains(o.startContainer)){a=o.cloneRange();var c=document.createElement("span");c.className="vditor-wbr",o.insertNode(c)}}var x=n[n.currentMode].element.cloneNode(!0);x.querySelectorAll(".vditor-".concat(n.currentMode,"__preview[data-render='1']")).forEach(function(D){D.firstElementChild&&(D.firstElementChild.classList.contains("language-echarts")||D.firstElementChild.classList.contains("language-plantuml")||D.firstElementChild.classList.contains("language-mindmap")?(D.firstElementChild.removeAttribute("_echarts_instance_"),D.firstElementChild.removeAttribute("data-processed"),D.firstElementChild.innerHTML=D.previousElementSibling.firstElementChild.innerHTML,D.setAttribute("data-render","2")):D.firstElementChild.classList.contains("language-math")&&(D.setAttribute("data-render","2"),D.firstElementChild.textContent=D.firstElementChild.getAttribute("data-math"),D.firstElementChild.removeAttribute("data-math")))});var A=x.innerHTML;return n[n.currentMode].element.querySelectorAll(".vditor-wbr").forEach(function(D){D.remove()}),i&&a&&(0,U.jl)(a),A.replace('<span class="vditor-wbr"></span>',"<wbr>")},t}(),tc=l(905),nc=function(){function t(n){this.defaultOptions={rtl:!1,after:void 0,cache:{enable:!0},cdn:u.Y.CDN,classes:{preview:""},comment:{enable:!1},counter:{enable:!1,type:"markdown"},customRenders:[],debugger:!1,fullscreen:{index:90},height:"auto",hint:{delay:200,emoji:{"+1":"👍","-1":"👎",confused:"😕",eyes:"👀️",heart:"❤️",rocket:"🚀️",smile:"😄",tada:"🎉️"},emojiPath:"".concat(u.Y.CDN,"/dist/images/emoji"),extend:[],parse:!0},icon:"ant",lang:"zh_CN",mode:"ir",outline:{enable:!1,position:"left"},placeholder:"",preview:{actions:["desktop","tablet","mobile","mp-wechat","zhihu"],delay:1e3,hljs:u.Y.HLJS_OPTIONS,markdown:u.Y.MARKDOWN_OPTIONS,math:u.Y.MATH_OPTIONS,maxWidth:800,mode:"both",theme:u.Y.THEME_OPTIONS,render:{media:{enable:!0}}},link:{isOpen:!0},image:{isPreview:!0},resize:{enable:!1,position:"bottom"},theme:"classic",toolbar:["emoji","headings","bold","italic","strike","link","|","list","ordered-list","check","outdent","indent","|","quote","line","code","inline-code","insert-before","insert-after","|","upload","record","table","|","undo","redo","|","fullscreen","edit-mode",{name:"more",toolbar:["both","code-theme","content-theme","export","outline","preview","devtools","info","help"]}],toolbarConfig:{hide:!1,pin:!1},typewriterMode:!1,undoDelay:800,upload:{extraData:{},fieldName:"file[]",filename:function(i){return i.replace(/\W/g,"")},linkToImgUrl:"",max:10*1024*1024,multiple:!0,url:"",withCredentials:!1},value:"",width:"auto"},this.options=n}return t.prototype.merge=function(){var n,i,a,o,c,x,A,D,L;this.options&&(this.options.toolbar?this.options.toolbar=this.mergeToolbar(this.options.toolbar):this.options.toolbar=this.mergeToolbar(this.defaultOptions.toolbar),!((i=(n=this.options.preview)===null||n===void 0?void 0:n.theme)===null||i===void 0)&&i.list&&(this.defaultOptions.preview.theme.list=this.options.preview.theme.list),!((c=(o=(a=this.options.preview)===null||a===void 0?void 0:a.render)===null||o===void 0?void 0:o.media)===null||c===void 0)&&c.enable&&(this.defaultOptions.preview.render.media.enable=this.options.preview.render.media.enable),!((x=this.options.hint)===null||x===void 0)&&x.emoji&&(this.defaultOptions.hint.emoji=this.options.hint.emoji),this.options.comment&&(this.defaultOptions.comment=this.options.comment),this.options.cdn&&(!((D=(A=this.options.preview)===null||A===void 0?void 0:A.theme)===null||D===void 0)&&D.path||(this.defaultOptions.preview.theme.path="".concat(this.options.cdn,"/dist/css/content-theme")),!((L=this.options.hint)===null||L===void 0)&&L.emojiPath||(this.defaultOptions.hint.emojiPath="".concat(this.options.cdn,"/dist/images/emoji"))));var $=(0,tc.h)(this.defaultOptions,this.options);if($.cache.enable&&!$.cache.id)throw new Error("need options.cache.id, see https://ld246.com/article/1549638745630#options");return $},t.prototype.mergeToolbar=function(n){var i=this,a=[{icon:'<svg><use xlink:href="#vditor-icon-export"></use></svg>',name:"export",tipPosition:"ne"},{hotkey:"⌘E",icon:'<svg><use xlink:href="#vditor-icon-emoji"></use></svg>',name:"emoji",tipPosition:"ne"},{hotkey:"⌘H",icon:'<svg><use xlink:href="#vditor-icon-headings"></use></svg>',name:"headings",tipPosition:"ne"},{hotkey:"⌘B",icon:'<svg><use xlink:href="#vditor-icon-bold"></use></svg>',name:"bold",prefix:"**",suffix:"**",tipPosition:"ne"},{hotkey:"⌘I",icon:'<svg><use xlink:href="#vditor-icon-italic"></use></svg>',name:"italic",prefix:"*",suffix:"*",tipPosition:"ne"},{hotkey:"⌘D",icon:'<svg><use xlink:href="#vditor-icon-strike"></use></svg>',name:"strike",prefix:"~~",suffix:"~~",tipPosition:"ne"},{hotkey:"⌘K",icon:'<svg><use xlink:href="#vditor-icon-link"></use></svg>',name:"link",prefix:"[",suffix:"](https://)",tipPosition:"n"},{name:"|"},{hotkey:"⌘L",icon:'<svg><use xlink:href="#vditor-icon-list"></use></svg>',name:"list",prefix:"* ",tipPosition:"n"},{hotkey:"⌘O",icon:'<svg><use xlink:href="#vditor-icon-ordered-list"></use></svg>',name:"ordered-list",prefix:"1. ",tipPosition:"n"},{hotkey:"⌘J",icon:'<svg><use xlink:href="#vditor-icon-check"></use></svg>',name:"check",prefix:"* [ ] ",tipPosition:"n"},{hotkey:"⇧⌘I",icon:'<svg><use xlink:href="#vditor-icon-outdent"></use></svg>',name:"outdent",tipPosition:"n"},{hotkey:"⇧⌘O",icon:'<svg><use xlink:href="#vditor-icon-indent"></use></svg>',name:"indent",tipPosition:"n"},{name:"|"},{hotkey:"⌘;",icon:'<svg><use xlink:href="#vditor-icon-quote"></use></svg>',name:"quote",prefix:"> ",tipPosition:"n"},{hotkey:"⇧⌘H",icon:'<svg><use xlink:href="#vditor-icon-line"></use></svg>',name:"line",prefix:"---",tipPosition:"n"},{hotkey:"⌘U",icon:'<svg><use xlink:href="#vditor-icon-code"></use></svg>',name:"code",prefix:"```",suffix:"\n```",tipPosition:"n"},{hotkey:"⌘G",icon:'<svg><use xlink:href="#vditor-icon-inline-code"></use></svg>',name:"inline-code",prefix:"`",suffix:"`",tipPosition:"n"},{hotkey:"⇧⌘B",icon:'<svg><use xlink:href="#vditor-icon-before"></use></svg>',name:"insert-before",tipPosition:"n"},{hotkey:"⇧⌘E",icon:'<svg><use xlink:href="#vditor-icon-after"></use></svg>',name:"insert-after",tipPosition:"n"},{name:"|"},{icon:'<svg><use xlink:href="#vditor-icon-upload"></use></svg>',name:"upload",tipPosition:"n"},{icon:'<svg><use xlink:href="#vditor-icon-record"></use></svg>',name:"record",tipPosition:"n"},{hotkey:"⌘M",icon:'<svg><use xlink:href="#vditor-icon-table"></use></svg>',name:"table",prefix:"| col1",suffix:` | col2 | col3 |
| --- | --- | --- |
|  |  |  |
|  |  |  |`,tipPosition:"n"},{name:"|"},{hotkey:"⌘Z",icon:'<svg><use xlink:href="#vditor-icon-undo"></use></svg>',name:"undo",tipPosition:"nw"},{hotkey:"⌘Y",icon:'<svg><use xlink:href="#vditor-icon-redo"></use></svg>',name:"redo",tipPosition:"nw"},{name:"|"},{icon:'<svg><use xlink:href="#vditor-icon-more"></use></svg>',name:"more",tipPosition:"e"},{hotkey:"⌘'",icon:'<svg><use xlink:href="#vditor-icon-fullscreen"></use></svg>',name:"fullscreen",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-edit"></use></svg>',name:"edit-mode",tipPosition:"nw"},{hotkey:"⌘P",icon:'<svg><use xlink:href="#vditor-icon-both"></use></svg>',name:"both",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-preview"></use></svg>',name:"preview",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-align-center"></use></svg>',name:"outline",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-theme"></use></svg>',name:"content-theme",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-code-theme"></use></svg>',name:"code-theme",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-bug"></use></svg>',name:"devtools",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-info"></use></svg>',name:"info",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-help"></use></svg>',name:"help",tipPosition:"nw"},{name:"br"}],o=[];return n.forEach(function(c){var x=c;a.forEach(function(A){typeof c=="string"&&A.name===c&&(x=A),typeof c=="object"&&A.name===c.name&&(x=Object.assign({},A,c))}),c.toolbar&&(x.toolbar=i.mergeToolbar(c.toolbar)),o.push(x)}),o},t}(),ic=function(){function t(n){var i=this;this.composingLock=!1,this.commentIds=[];var a=document.createElement("div");a.className="vditor-wysiwyg",a.innerHTML='<pre class="vditor-reset" placeholder="'.concat(n.options.placeholder,`"
 contenteditable="true" spellcheck="false"></pre>
<div class="vditor-panel vditor-panel--none"></div>
<div class="vditor-panel vditor-panel--none">
    <button type="button" aria-label="`).concat(window.VditorI18n.comment,`" class="vditor-icon vditor-tooltipped vditor-tooltipped__n">
        <svg><use xlink:href="#vditor-icon-comment"></use></svg>
    </button>
</div>`),this.element=a.firstElementChild,this.popover=a.firstElementChild.nextElementSibling,this.selectPopover=a.lastElementChild,this.bindEvent(n),ln(n,this.element),ti(n,this.element),ui(n,this.element),ut(n,this.element),Gt(n,this.element),Hn(n,this.element),zt(n,this.element,this.copy),Wt(n,this.element,this.copy),n.options.comment.enable&&(this.selectPopover.querySelector("button").onclick=function(){var o=Lute.NewNodeID(),c=getSelection().getRangeAt(0),x=c.cloneRange(),A=c.extractContents(),D,L,$=!1,K=!1;A.childNodes.forEach(function(fe,$e){var ke=!1;if(fe.nodeType===3?ke=!0:fe.classList.contains("vditor-comment")?fe.classList.contains("vditor-comment")&&fe.setAttribute("data-cmtids",fe.getAttribute("data-cmtids")+" "+o):ke=!0,ke)if(fe.nodeType!==3&&fe.getAttribute("data-block")==="0"&&$e===0&&x.startOffset>0)fe.innerHTML='<span class="vditor-comment" data-cmtids="'.concat(o,'">').concat(fe.innerHTML,"</span>"),D=fe;else if(fe.nodeType!==3&&fe.getAttribute("data-block")==="0"&&$e===A.childNodes.length-1&&x.endOffset<x.endContainer.textContent.length)fe.innerHTML='<span class="vditor-comment" data-cmtids="'.concat(o,'">').concat(fe.innerHTML,"</span>"),L=fe;else if(fe.nodeType!==3&&fe.getAttribute("data-block")==="0")$e===0?$=!0:$e===A.childNodes.length-1&&(K=!0),fe.innerHTML='<span class="vditor-comment" data-cmtids="'.concat(o,'">').concat(fe.innerHTML,"</span>");else{var ue=document.createElement("span");ue.classList.add("vditor-comment"),ue.setAttribute("data-cmtids",o),fe.parentNode.insertBefore(ue,fe),ue.appendChild(fe)}});var me=(0,y.pt)(x.startContainer);me&&(D?(me.insertAdjacentHTML("beforeend",D.innerHTML),D.remove()):me.textContent.trim().replace(u.Y.ZWSP,"")===""&&$&&me.remove());var pe=(0,y.pt)(x.endContainer);pe&&(L?(pe.insertAdjacentHTML("afterbegin",L.innerHTML),L.remove()):pe.textContent.trim().replace(u.Y.ZWSP,"")===""&&K&&pe.remove()),c.insertNode(A),n.options.comment.add(o,c.toString(),i.getComments(n,!0)),rt(n,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),i.hideComment()})}return t.prototype.getComments=function(n,i){var a=this;if(i===void 0&&(i=!1),n.currentMode==="wysiwyg"&&n.options.comment.enable){this.commentIds=[],this.element.querySelectorAll(".vditor-comment").forEach(function(c){a.commentIds=a.commentIds.concat(c.getAttribute("data-cmtids").split(" "))}),this.commentIds=Array.from(new Set(this.commentIds));var o=[];if(i)return this.commentIds.forEach(function(c){o.push({id:c,top:a.element.querySelector('.vditor-comment[data-cmtids="'.concat(c,'"]')).offsetTop})}),o}else return[]},t.prototype.triggerRemoveComment=function(n){var i=function(c,x){var A=new Set(x);return c.filter(function(D){return!A.has(D)})};if(n.currentMode==="wysiwyg"&&n.options.comment.enable&&n.wysiwyg.commentIds.length>0){var a=JSON.parse(JSON.stringify(this.commentIds));this.getComments(n);var o=i(a,this.commentIds);o.length>0&&n.options.comment.remove(o)}},t.prototype.showComment=function(){var n=(0,U.Ey)(this.element);this.selectPopover.setAttribute("style","left:".concat(n.left,"px;display:block;top:").concat(Math.max(-8,n.top-21),"px"))},t.prototype.hideComment=function(){this.selectPopover.setAttribute("style","display:none")},t.prototype.unbindListener=function(){window.removeEventListener("scroll",this.scrollListener)},t.prototype.copy=function(n,i){var a=getSelection().getRangeAt(0);if(a.toString()!==""){n.stopPropagation(),n.preventDefault();var o=(0,y._Y)(a.startContainer,"CODE"),c=(0,y._Y)(a.endContainer,"CODE");if(o&&c&&c.isSameNode(o)){var x="";o.parentElement.tagName==="PRE"?x=a.toString():x="`"+a.toString()+"`",n.clipboardData.setData("text/plain",x),n.clipboardData.setData("text/html","");return}var A=(0,y._Y)(a.startContainer,"A"),D=(0,y._Y)(a.endContainer,"A");if(A&&D&&D.isSameNode(A)){var L=A.getAttribute("title")||"";L&&(L=' "'.concat(L,'"')),n.clipboardData.setData("text/plain","[".concat(a.toString(),"](").concat(A.getAttribute("href")).concat(L,")")),n.clipboardData.setData("text/html","");return}var $=document.createElement("div");$.appendChild(a.cloneContents()),n.clipboardData.setData("text/plain",i.lute.VditorDOM2Md($.innerHTML).trim()),n.clipboardData.setData("text/html","")}},t.prototype.bindEvent=function(n){var i=this;this.unbindListener(),window.addEventListener("scroll",this.scrollListener=function(){if(T(n,["hint"]),!(i.popover.style.display!=="block"||i.selectPopover.style.display!=="block")){var a=parseInt(i.popover.getAttribute("data-top"),10);if(n.options.height!=="auto"){if(n.options.toolbarConfig.pin&&n.toolbar.element.getBoundingClientRect().top===0){var o=Math.max(window.scrollY-n.element.offsetTop-8,Math.min(a-n.wysiwyg.element.scrollTop,i.element.clientHeight-21))+"px";i.popover.style.display==="block"&&(i.popover.style.top=o),i.selectPopover.style.display==="block"&&(i.selectPopover.style.top=o)}return}else if(!n.options.toolbarConfig.pin)return;var c=Math.max(a,window.scrollY-n.element.offsetTop-8)+"px";i.popover.style.display==="block"&&(i.popover.style.top=c),i.selectPopover.style.display==="block"&&(i.selectPopover.style.top=c)}}),this.element.addEventListener("scroll",function(){if(T(n,["hint"]),n.options.comment&&n.options.comment.enable&&n.options.comment.scroll&&n.options.comment.scroll(n.wysiwyg.element.scrollTop),i.popover.style.display==="block"){var a=parseInt(i.popover.getAttribute("data-top"),10)-n.wysiwyg.element.scrollTop,o=-8;n.options.toolbarConfig.pin&&n.toolbar.element.getBoundingClientRect().top===0&&(o=window.scrollY-n.element.offsetTop+o);var c=Math.max(o,Math.min(a,i.element.clientHeight-21))+"px";i.popover.style.top=c,i.selectPopover.style.top=c}}),this.element.addEventListener("paste",function(a){hn(n,a,{pasteCode:function(o){var c=(0,U.RN)(n),x=document.createElement("template");x.innerHTML=o,c.insertNode(x.content.cloneNode(!0));var A=(0,y.Th)(c.startContainer,"data-block","0");A?A.outerHTML=n.lute.SpinVditorDOM(A.outerHTML):n.wysiwyg.element.innerHTML=n.lute.SpinVditorDOM(n.wysiwyg.element.innerHTML),(0,U.ir)(n.wysiwyg.element,c)}})}),this.element.addEventListener("compositionstart",function(){i.composingLock=!0}),this.element.addEventListener("compositionend",function(a){var o=(0,O.c)(getSelection().getRangeAt(0).startContainer);if(o&&o.textContent===""){oe(n);return}(0,f.gm)()||Si(n,getSelection().getRangeAt(0).cloneRange(),a),i.composingLock=!1}),this.element.addEventListener("input",function(a){if(!(a.inputType==="deleteByDrag"||a.inputType==="insertFromDrop")){if(i.preventInput){i.preventInput=!1,rt(n);return}if(i.composingLock||a.data==="‘"||a.data==="“"||a.data==="《"){rt(n);return}var o=getSelection().getRangeAt(0),c=(0,y.pt)(o.startContainer);if(c||(Nt(n,o),c=(0,y.pt)(o.startContainer)),!!c){for(var x=(0,U.ED)(c,n.wysiwyg.element,o).start,A=!0,D=x-1;D>c.textContent.substr(0,x).lastIndexOf(`
`);D--)if(c.textContent.charAt(D)!==" "&&c.textContent.charAt(D)!=="	"){A=!1;break}x===0&&(A=!1);for(var L=!0,D=x-1;D<c.textContent.length;D++)if(c.textContent.charAt(D)!==" "&&c.textContent.charAt(D)!==`
`){L=!1;break}L&&/^#{1,6} $/.test(c.textContent)&&(L=!1);var $=(0,O.c)(getSelection().getRangeAt(0).startContainer);if($&&$.textContent===""&&(oe(n),$.remove()),A&&c.getAttribute("data-type")!=="code-block"||L||hr(c.innerHTML)||pi(c.innerHTML)&&c.previousElementSibling){typeof n.options.input=="function"&&n.options.input(S(n));return}a.inputType==="insertParagraph"&&i.element.innerHTML==="<p><br></p><p><br></p>"&&c.previousElementSibling.remove(),Si(n,o,a)}}}),this.element.addEventListener("click",function(a){if(a.target.tagName==="INPUT"){var o=a.target;o.checked?o.setAttribute("checked","checked"):o.removeAttribute("checked"),i.preventInput=!0,getSelection().rangeCount>0&&(0,U.jl)(getSelection().getRangeAt(0)),rt(n);return}if(a.target.tagName==="IMG"&&!a.target.parentElement.classList.contains("vditor-wysiwyg__preview")){a.target.getAttribute("data-type")==="link-ref"?ne(n,a.target):ge(a,n);return}var c=(0,y._Y)(a.target,"A");if(c){n.options.link.click?n.options.link.click(c):n.options.link.isOpen&&window.open(c.getAttribute("href")),a.preventDefault();return}var x=(0,U.RN)(n);if(a.target.isEqualNode(i.element)&&i.element.lastElementChild&&x.collapsed){var A=i.element.lastElementChild.getBoundingClientRect();a.y>A.top+A.height&&(i.element.lastElementChild.tagName==="P"&&i.element.lastElementChild.textContent.trim().replace(u.Y.ZWSP,"")===""?(x.selectNodeContents(i.element.lastElementChild),x.collapse(!1)):(i.element.insertAdjacentHTML("beforeend",'<p data-block="0">'.concat(u.Y.ZWSP,"<wbr></p>")),(0,U.ir)(i.element,x)))}q(n);var D=(0,y.KJ)(a.target,"vditor-wysiwyg__preview");D||(D=(0,y.KJ)((0,U.RN)(n).startContainer,"vditor-wysiwyg__preview")),D&&$t(D,n),re(a,n)}),this.element.addEventListener("keyup",function(a){if(!(a.isComposing||(0,f._0)(a))){a.key==="Enter"&&Ge(n),(a.key==="Backspace"||a.key==="Delete")&&n.wysiwyg.element.innerHTML!==""&&n.wysiwyg.element.childNodes.length===1&&n.wysiwyg.element.firstElementChild&&n.wysiwyg.element.firstElementChild.tagName==="P"&&n.wysiwyg.element.firstElementChild.childElementCount===0&&(n.wysiwyg.element.textContent===""||n.wysiwyg.element.textContent===`
`)&&(n.wysiwyg.element.innerHTML="");var o=(0,U.RN)(n);if(a.key==="Backspace"&&(0,f.gm)()&&o.startContainer.textContent===`
`&&o.startOffset===1&&(o.startContainer.textContent=""),Nt(n,o),q(n),!(a.key!=="ArrowDown"&&a.key!=="ArrowRight"&&a.key!=="Backspace"&&a.key!=="ArrowLeft"&&a.key!=="ArrowUp")){(a.key==="ArrowLeft"||a.key==="ArrowRight")&&n.hint.render(n);var c=(0,y.KJ)(o.startContainer,"vditor-wysiwyg__preview");if(!c&&o.startContainer.nodeType!==3&&o.startOffset>0){var x=o.startContainer;x.classList.contains("vditor-wysiwyg__block")&&(c=x.lastElementChild)}if(c){var A=c.previousElementSibling;if(A.style.display==="none"){a.key==="ArrowDown"||a.key==="ArrowRight"?$t(c,n):$t(c,n,!1);return}var D=c.previousElementSibling;if(D.tagName==="PRE"&&(D=D.firstElementChild),a.key==="ArrowDown"||a.key==="ArrowRight"){var x=c.parentElement,L=yn(x);if(L&&L.nodeType!==3){var $=L.querySelector(".vditor-wysiwyg__preview");if($){$t($,n);return}}if(L.nodeType===3){for(;L.textContent.length===0&&L.nextSibling;)L=L.nextSibling;o.setStart(L,1)}else o.setStart(L.firstChild,0)}else o.selectNodeContents(D),o.collapse(!1)}}}})},t}(),rc=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),ac=function(t){rc(n,t);function n(i,a){var o=t.call(this)||this;if(o.version=u.g,typeof i=="string"){if(a?a.cache?a.cache.id||(a.cache.id="vditor".concat(i)):a.cache={id:"vditor".concat(i)}:a={cache:{id:"vditor".concat(i)}},!document.getElementById(i))return o.showErrorTip("Failed to get element by id: ".concat(i)),o;i=document.getElementById(i)}var c=new nc(a),x=c.merge();if(x.i18n)window.VditorI18n=x.i18n,o.init(i,x);else if(["en_US","fr_FR","pt_BR","ja_JP","ko_KR","ru_RU","sv_SE","zh_CN","zh_TW"].includes(x.lang)){var A="vditorI18nScript",D=A+x.lang;document.querySelectorAll('head script[id^="'.concat(A,'"]')).forEach(function(L){L.id!==D&&document.head.removeChild(L)}),(0,E.Z)("".concat(x.cdn,"/dist/js/i18n/").concat(x.lang,".js"),D).then(function(){o.init(i,x)}).catch(function(L){o.showErrorTip("GET ".concat(x.cdn,"/dist/js/i18n/").concat(x.lang,".js net::ERR_ABORTED 404 (Not Found)"))})}else throw new Error("options.lang error, see https://ld246.com/article/1549638745630#options");return o}return n.prototype.showErrorTip=function(i){var a=new oo;document.body.appendChild(a.element),a.show(i,0)},n.prototype.updateToolbarConfig=function(i){this.vditor.toolbar.updateConfig(this.vditor,i)},n.prototype.setTheme=function(i,a,o,c){this.vditor.options.theme=i,it(this.vditor),a&&(this.vditor.options.preview.theme.current=a,(0,Oe.H)(a,c||this.vditor.options.preview.theme.path)),o&&(this.vditor.options.preview.hljs.style=o,(0,so.h)(o,this.vditor.options.cdn))},n.prototype.getValue=function(){return S(this.vditor)},n.prototype.getCurrentMode=function(){return this.vditor.currentMode},n.prototype.focus=function(){this.vditor.currentMode==="sv"?this.vditor.sv.element.focus():this.vditor.currentMode==="wysiwyg"?this.vditor.wysiwyg.element.focus():this.vditor.currentMode==="ir"&&this.vditor.ir.element.focus()},n.prototype.blur=function(){this.vditor.currentMode==="sv"?this.vditor.sv.element.blur():this.vditor.currentMode==="wysiwyg"?this.vditor.wysiwyg.element.blur():this.vditor.currentMode==="ir"&&this.vditor.ir.element.blur()},n.prototype.disabled=function(){T(this.vditor,["subToolbar","hint","popover"]),w(this.vditor.toolbar.elements,u.Y.EDIT_TOOLBARS.concat(["undo","redo","fullscreen","edit-mode"])),this.vditor[this.vditor.currentMode].element.setAttribute("contenteditable","false")},n.prototype.enable=function(){k(this.vditor.toolbar.elements,u.Y.EDIT_TOOLBARS.concat(["undo","redo","fullscreen","edit-mode"])),this.vditor.undo.resetIcon(this.vditor),this.vditor[this.vditor.currentMode].element.setAttribute("contenteditable","true")},n.prototype.getSelection=function(){if(this.vditor.currentMode==="wysiwyg")return sn(this.vditor.wysiwyg.element);if(this.vditor.currentMode==="sv")return sn(this.vditor.sv.element);if(this.vditor.currentMode==="ir")return sn(this.vditor.ir.element)},n.prototype.renderPreview=function(i){this.vditor.preview.render(this.vditor,i)},n.prototype.getCursorPosition=function(){return(0,U.Ey)(this.vditor[this.vditor.currentMode].element)},n.prototype.isUploading=function(){return this.vditor.upload.isUploading},n.prototype.clearCache=function(){this.vditor.options.cache.enable&&(0,f.D)()&&localStorage.removeItem(this.vditor.options.cache.id)},n.prototype.disabledCache=function(){this.vditor.options.cache.enable=!1},n.prototype.enableCache=function(){if(!this.vditor.options.cache.id)throw new Error("need options.cache.id, see https://ld246.com/article/1549638745630#options");this.vditor.options.cache.enable=!0},n.prototype.html2md=function(i){return this.vditor.lute.HTML2Md(i)},n.prototype.exportJSON=function(i){return this.vditor.lute.RenderJSON(i)},n.prototype.getHTML=function(){return ro(this.vditor)},n.prototype.tip=function(i,a){this.vditor.tip.show(i,a)},n.prototype.setPreviewMode=function(i){pa(i,this.vditor)},n.prototype.deleteValue=function(){window.getSelection().isCollapsed||document.execCommand("delete",!1)},n.prototype.updateValue=function(i){document.execCommand("insertHTML",!1,i)},n.prototype.insertValue=function(i,a){a===void 0&&(a=!0);var o=(0,U.RN)(this.vditor);o.collapse(!0);var c=document.createElement("template");c.innerHTML=i,o.insertNode(c.content.cloneNode(!0)),o.collapse(!1),this.vditor.currentMode==="sv"?(this.vditor.sv.preventInput=!0,a&&Ve(this.vditor)):this.vditor.currentMode==="wysiwyg"?a&&Si(this.vditor,getSelection().getRangeAt(0)):this.vditor.currentMode==="ir"&&(this.vditor.ir.preventInput=!0,a&&Ke(this.vditor,getSelection().getRangeAt(0),!0))},n.prototype.insertMD=function(i){this.vditor.currentMode==="ir"?(0,U.Z2)(this.vditor.lute.Md2VditorIRDOM(i),this.vditor):this.vditor.currentMode==="wysiwyg"?(0,U.Z2)(this.vditor.lute.Md2VditorDOM(i),this.vditor):W(this.vditor,i),this.vditor.outline.render(this.vditor),ct(this.vditor)},n.prototype.setValue=function(i,a){var o=this;a===void 0&&(a=!1),this.vditor.currentMode==="sv"?(this.vditor.sv.element.innerHTML="<div data-block='0'>".concat(this.vditor.lute.SpinVditorSVDOM(i),"</div>"),Ue(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})):this.vditor.currentMode==="wysiwyg"?_t(this.vditor,i,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}):(this.vditor.ir.element.innerHTML=this.vditor.lute.Md2VditorIRDOM(i),this.vditor.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach(function(c){tt(c,o.vditor)}),Wn(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})),this.vditor.outline.render(this.vditor),i||(T(this.vditor,["emoji","headings","submenu","hint"]),this.vditor.wysiwyg.popover&&(this.vditor.wysiwyg.popover.style.display="none"),this.clearCache()),a&&this.clearStack()},n.prototype.insertEmptyBlock=function(i){fi(this.vditor,i)},n.prototype.clearStack=function(){this.vditor.undo.clearStack(this.vditor),this.vditor.undo.addToUndoStack(this.vditor)},n.prototype.destroy=function(){this.vditor.element.innerHTML=this.vditor.originalInnerHTML,this.vditor.element.classList.remove("vditor"),this.vditor.element.removeAttribute("style");var i=document.getElementById("vditorIconScript");i&&i.remove(),this.clearCache(),Mn(),this.vditor.wysiwyg.unbindListener()},n.prototype.getCommentIds=function(){return this.vditor.currentMode!=="wysiwyg"?[]:this.vditor.wysiwyg.getComments(this.vditor,!0)},n.prototype.hlCommentIds=function(i){if(this.vditor.currentMode==="wysiwyg"){var a=function(o){o.classList.remove("vditor-comment--hover"),i.forEach(function(c){o.getAttribute("data-cmtids").indexOf(c)>-1&&o.classList.add("vditor-comment--hover")})};this.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(o){a(o)}),this.vditor.preview.element.style.display!=="none"&&this.vditor.preview.element.querySelectorAll(".vditor-comment").forEach(function(o){a(o)})}},n.prototype.unHlCommentIds=function(i){if(this.vditor.currentMode==="wysiwyg"){var a=function(o){i.forEach(function(c){o.getAttribute("data-cmtids").indexOf(c)>-1&&o.classList.remove("vditor-comment--hover")})};this.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(o){a(o)}),this.vditor.preview.element.style.display!=="none"&&this.vditor.preview.element.querySelectorAll(".vditor-comment").forEach(function(o){a(o)})}},n.prototype.removeCommentIds=function(i){var a=this;if(this.vditor.currentMode==="wysiwyg"){var o=function(c,x){var A=c.getAttribute("data-cmtids").split(" ");A.find(function(D,L){if(D===x)return A.splice(L,1),!0}),A.length===0?(c.outerHTML=c.innerHTML,(0,U.RN)(a.vditor).collapse(!0)):c.setAttribute("data-cmtids",A.join(" "))};i.forEach(function(c){a.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(x){o(x,c)}),a.vditor.preview.element.style.display!=="none"&&a.vditor.preview.element.querySelectorAll(".vditor-comment").forEach(function(x){o(x,c)})}),rt(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})}},n.prototype.init=function(i,a){var o=this;this.vditor={currentMode:a.mode,element:i,hint:new Gs(a.hint.extend),lute:void 0,options:a,originalInnerHTML:i.innerHTML,outline:new Js(window.VditorI18n.outline),tip:new oo},this.vditor.sv=new nl(this.vditor),this.vditor.undo=new ec,this.vditor.wysiwyg=new ic(this.vditor),this.vditor.ir=new Xs(this.vditor),this.vditor.toolbar=new Jl(this.vditor),a.resize.enable&&(this.vditor.resize=new tl(this.vditor)),this.vditor.toolbar.elements.devtools&&(this.vditor.devtools=new h),(a.upload.url||a.upload.handler)&&(this.vditor.upload=new Vn),(0,E.Z)(a._lutePath||"".concat(a.cdn,"/dist/js/lute/lute.min.js"),"vditorLuteScript").then(function(){o.vditor.lute=(0,Zs.X)({autoSpace:o.vditor.options.preview.markdown.autoSpace,gfmAutoLink:o.vditor.options.preview.markdown.gfmAutoLink,codeBlockPreview:o.vditor.options.preview.markdown.codeBlockPreview,emojiSite:o.vditor.options.hint.emojiPath,emojis:o.vditor.options.hint.emoji,fixTermTypo:o.vditor.options.preview.markdown.fixTermTypo,footnotes:o.vditor.options.preview.markdown.footnotes,headingAnchor:!1,inlineMathDigit:o.vditor.options.preview.math.inlineDigit,linkBase:o.vditor.options.preview.markdown.linkBase,linkPrefix:o.vditor.options.preview.markdown.linkPrefix,listStyle:o.vditor.options.preview.markdown.listStyle,mark:o.vditor.options.preview.markdown.mark,mathBlockPreview:o.vditor.options.preview.markdown.mathBlockPreview,paragraphBeginningSpace:o.vditor.options.preview.markdown.paragraphBeginningSpace,sanitize:o.vditor.options.preview.markdown.sanitize,toc:o.vditor.options.preview.markdown.toc}),o.vditor.preview=new el(o.vditor),lt(o.vditor),a.after&&a.after(),a.icon&&(0,E.U)("".concat(a.cdn,"/dist/js/icons/").concat(a.icon,".js"),"vditorIconScript")})},n}(m.default);const oc=ac})(),d=d.default,d})())}(na)),na.exports}var Sd=kd();const _r=wd(Sd),xd=nn({__name:"VditorEditor",props:{modelValue:{type:String,default:""},theme:{type:String,default:"classic"}},emits:["update:modelValue"],setup(p,{expose:e,emit:r}){const s=p,l=r,d=G();let m=null;const u={mode:"ir",height:"auto",minHeight:150,resize:{enable:!0,position:"bottom"},icon:"ant",lang:"zh_CN",theme:"classic",toolbar:["emoji","headings","bold","italic","strike","link","|","list","ordered-list","check","|","quote","line","code","inline-code","table","upload","undo","redo","|","preview","fullscreen"],toolbarConfig:{pin:!0,hideTooltip:!0},counter:{enable:!1},cache:{enable:!0,id:"vue-vditor"},input:v=>{l("update:modelValue",v)},preview:{hljs:{style:"native"},markdown:{listStyle:!0,mark:!0},actions:[]},placeholder:"灵感记录~"};return Ht(async()=>{if(!d.value)return;const v={...u,theme:s.theme==="dark"?"dark":"classic",preview:{...u.preview,hljs:{style:s.theme==="dark"?"native":"github"}},after:()=>{m==null||m.setValue(s.modelValue),m==null||m.setTheme(s.theme==="dark"?"dark":"classic")}};m=new _r(d.value,v)}),Ni(()=>{try{m&&(m.destroy(),m=null)}catch(v){console.warn("Vditor destroy error",v)}}),e({clear:()=>{m&&(m.setValue(""),l("update:modelValue",""))},insertValue:v=>{m&&(m.insertValue(v),l("update:modelValue",m.getValue()))}}),Et(()=>s.theme,v=>{m&&m.setTheme(v==="dark"?"dark":"classic")}),(v,S)=>(J(),ae("div",{ref_key:"editorContainer",ref:d,class:"vditor-container"},null,512))}}),_d={class:"flex items-center gap-2"},Cd={class:"space-y-4"},Td={class:"relative"},Md={class:"flex justify-between items-center"},Ad={class:"flex justify-end gap-2"},Ld=nn({__name:"Searchmode",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","search-result"],setup(p,{expose:e,emit:r}){const s=Ze(),d=gn().public.baseApi||"/api",m=p,u=r,v=he({get:()=>m.modelValue,set:f=>u("update:modelValue",f)}),S=()=>{u("update:modelValue",!1)},E=G(""),h=async()=>{var f,g;if(!E.value.trim()){s.add({title:"提示",description:"请输入搜索关键词",color:"yellow"});return}try{const{data:b,error:k}=await Bc("/messages/search",{method:"GET",baseURL:d,params:{keyword:E.value,page:1,pageSize:10}},"$4cD5OWGgav");if(k.value)throw new Error(((f=k.value)==null?void 0:f.message)||"网络请求失败");if(!b.value)throw new Error("未收到服务器响应");if(b.value.code===1)u("search-result",b.value),u("update:modelValue",!1),E.value="",s.add({title:"成功",description:"搜索完成",color:"green"});else throw new Error(((g=b.value)==null?void 0:g.msg)||"搜索失败")}catch(b){console.error("Search error:",b),s.add({title:"错误",description:b instanceof Error?b.message:"搜索失败，请稍后重试",color:"red"})}};return e({handleSearch:h}),(f,g)=>{const b=ci,k=ua,w=Mr,_=ca,C=da;return J(),Lt(C,{modelValue:v.value,"onUpdate:modelValue":g[1]||(g[1]=T=>v.value=T),ui:{container:"items-center",base:"backdrop-blur-sm"}},{default:Te(()=>[te(_,{class:"search-card"},{header:Te(()=>[N("div",_d,[te(b,{name:"i-heroicons-magnifying-glass",class:"w-5 h-5"}),g[2]||(g[2]=N("h3",{class:"text-base font-semibold"},"站内搜索",-1))])]),default:Te(()=>[N("div",Cd,[N("div",Td,[te(b,{name:"i-heroicons-magnifying-glass",class:"w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 opacity-70"}),te(k,{modelValue:E.value,"onUpdate:modelValue":g[0]||(g[0]=T=>E.value=T),placeholder:"请输入关键词",class:"w-full pl-10",ui:{base:"rounded-xl"},onKeyup:ls(h,["enter"]),autofocus:""},null,8,["modelValue"])]),N("div",Md,[g[5]||(g[5]=N("div",{class:"text-xs opacity-70"},"按 Enter 搜索，Esc 关闭",-1)),N("div",Ad,[te(w,{variant:"ghost",color:"gray",onClick:S},{default:Te(()=>g[3]||(g[3]=[dt("取消")])),_:1}),te(w,{color:"orange",onClick:h},{default:Te(()=>g[4]||(g[4]=[dt("搜索")])),_:1})])])])]),_:1})]),_:1},8,["modelValue"])}}}),Vs=Tn(Ld,[["__scopeId","data-v-16a007f5"]]),Dd=os("notify",{state:()=>({config:{webhookEnabled:!1,webhookURL:"",telegramEnabled:!1,telegramToken:"",telegramChatID:"",weworkEnabled:!1,weworkKey:"",feishuEnabled:!1,feishuWebhook:"",feishuSecret:"",twitterEnabled:!1,twitterApiKey:"",twitterApiSecret:"",twitterAccessToken:"",twitterAccessTokenSecret:"",customHttpEnabled:!1,customHttpUrl:"",customHttpMethod:"POST",customHttpHeaders:"",customHttpBody:'{"content":"{{content}}"}'}}),actions:{async fetchConfig(){try{const e=await(await fetch("/api/notify/config",{credentials:"include"})).json();e.code===1&&(this.config=e.data)}catch(p){console.error("获取推送配置失败:",p)}},async saveConfig(p){try{const r=await(await fetch("/api/notify/config",{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)})).json();if(r.code===1){const s=r.data||p;return Object.keys(this.config).forEach(l=>{l.endsWith("Enabled")?this.config[l]=!!s[l]&&s[l]!=="false":s[l]!==void 0&&(this.config[l]=s[l])}),!0}return!1}catch(e){return console.error("保存推送配置失败:",e),!1}},async testNotify(p){try{return(await(await fetch("/api/notify/test",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:p})})).json()).code===1}catch(e){return console.error("测试推送失败:",e),!1}},async sendNotify(p){try{let e=p.content;return p.images&&p.images.length>0&&(e+=`

`,p.images.forEach(l=>{e+=`![](${l})
`})),(await(await fetch("/api/notify/send",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:e,format:p.format||"markdown",config:this.config})})).json()).code===1}catch(e){return console.error("发送推送失败:",e),!1}}}}),Od=nn({__name:"VideoUpload",emits:["video-uploaded","upload-progress"],setup(p,{emit:e}){const r=e,s=G(null),l=Ze(),d=gn().public.baseApi||"/api",m=()=>{var v;(v=s.value)==null||v.click()},u=async v=>{const S=v.target,E=S.files?S.files[0]:null;if(!E){l.add({title:"错误",description:"未选择视频",color:"red"});return}const h=200*1024*1024;if(E.size>h){l.add({title:"错误",description:"视频不能超过200MB",color:"red"});return}const f=new FormData;f.append("video",E);const g=new XMLHttpRequest;g.open("POST",`${d}/video/upload`,!0),g.withCredentials=!0,g.upload.onprogress=b=>{if(b.lengthComputable){const k=Math.round(b.loaded/b.total*100);r("upload-progress",k)}},g.onload=()=>{if(g.status===200)try{const b=JSON.parse(g.responseText);if(b.code===1&&b.data)r("video-uploaded",b.data),l.add({title:"成功",description:"视频上传成功",color:"green"});else throw new Error(b.msg||"视频上传失败")}catch(b){l.add({title:"错误",description:b.message||"视频上传失败",color:"red"})}else l.add({title:"错误",description:"视频上传失败",color:"red"});r("upload-progress",0),s.value&&(s.value.value="")},g.onerror=()=>{l.add({title:"错误",description:"视频上传失败",color:"red"}),r("upload-progress",0),s.value&&(s.value.value="")},g.send(f)};return(v,S)=>{const E=ci;return J(),ae("div",null,[N("input",{ref_key:"videoInput",ref:s,type:"file",accept:"video/*",class:"hidden",onChange:u},null,544),N("button",{class:"tb-btn",onClick:m,title:"上传视频"},[te(E,{name:"i-mdi-video",class:"w-5 h-5"})])])}}}),Pd=Tn(Od,[["__scopeId","data-v-8ae38874"]]),Rd={class:"flex justify-between items-center mb-3"},Id={class:"mb-4"},Hd={class:"flex gap-2 mb-3"},Nd={key:0,class:"space-y-2 mb-3"},jd={class:"flex items-center gap-2"},$d={class:"flex justify-end mt-2 mb-3"},Bd=["src"],Ud={key:3,class:"text-sm text-gray-300"},zd={key:4,class:"text-sm text-gray-300"},Fd={key:1,class:"flex justify-end mt-2"},Vd={key:2,class:"mt-2 text-red-400 text-sm"},qd={key:3,class:"mt-2"},Wd={class:"flex items-center gap-2 bg-gray-800 p-2 rounded"},Yd=["value"],Kd={class:"flex justify-end mt-2"},Gd=nn({__name:"ImageHostingUploader",props:{position:{type:Object,required:!0,default:()=>({x:0,y:0})},editorRef:{type:Object,required:!1,default:null}},emits:["close","upload-success"],setup(p,{emit:e}){const r=p,s=he(()=>{if(typeof window>"u")return{};const oe=window.innerWidth,re=window.innerHeight,Ae=400,Ke=500;let X=r.position.x,we=r.position.y;return X+Ae>oe&&(X=oe-Ae-20),X<0&&(X=20),we+Ke>re&&(we=re-Ke-20),we<0&&(we=20),oe<1024&&(X=(oe-Ae)/2,we=60),{position:"fixed",top:`${we}px`,left:`${X}px`,maxWidth:`${Math.min(Ae,oe-40)}px`,width:"100%",cursor:"move",userSelect:"none",touchAction:"none"}}),l=G(!1),d=G({x:0,y:0}),m=oe=>{l.value=!0;const re="touches"in oe?oe.touches[0].clientX:oe.clientX,Ae="touches"in oe?oe.touches[0].clientY:oe.clientY;d.value={x:re-r.position.x,y:Ae-r.position.y},document.addEventListener("mousemove",u),document.addEventListener("touchmove",u),document.addEventListener("mouseup",v),document.addEventListener("touchend",v)},u=oe=>{if(!l.value)return;const re="touches"in oe?oe.touches[0].clientX:oe.clientX,Ae="touches"in oe?oe.touches[0].clientY:oe.clientY;S("update:position",{x:re-d.value.x,y:Ae-d.value.y})},v=()=>{l.value=!1,document.removeEventListener("mousemove",u),document.removeEventListener("touchmove",u),document.removeEventListener("mouseup",v),document.removeEventListener("touchend",v)},S=e,E=Ze(),h=G("smms"),f=G(null),g=G(!1),b=G(!1),k=G(0),w=G(""),_=G(""),C=G(""),T=G(""),M=G(""),y=G("main"),O=G("images/"),B=G(!1),V=G(""),I=G(""),j=G(""),z=()=>{var oe;(oe=f.value)==null||oe.click()},F=oe=>{var Ae;g.value=!1;const re=(Ae=oe.dataTransfer)==null?void 0:Ae.files;re&&re.length>0&&Re(re[0])},le=oe=>{const Ae=oe.target.files;Ae&&Ae.length>0&&Re(Ae[0])},de=G(null),Re=async oe=>{if(!oe.type.startsWith("image/")){C.value="请选择图片文件";return}const re=5*1024*1024;if(oe.size>re){C.value="图片大小不能超过 5MB";return}C.value="",de.value=oe;const Ae=new FileReader;Ae.onload=Ke=>{var X;w.value=(X=Ke.target)==null?void 0:X.result},Ae.readAsDataURL(oe)},Be=()=>{if(!_.value){C.value="请先上传图片";return}const oe=`![](${_.value})`;S("upload-success",oe),S("close"),de.value=null,w.value="",_.value="",k.value=0,b.value=!1,C.value=""},Ce=async oe=>{try{await navigator.clipboard.writeText(oe),E.add({title:"成功",description:"已复制到剪贴板",color:"green",timeout:2e3})}catch{E.add({title:"错误",description:"复制失败",color:"red",timeout:2e3})}},De=async()=>{if(!de.value){C.value="请先选择图片";return}b.value=!0,k.value=0,C.value="";try{switch(h.value){case"github":await Ie(de.value);break;default:throw new Error("未知的图床类型")}}catch(oe){console.error("上传错误:",oe),C.value=oe.message||"上传失败",b.value=!1,oe.name==="AbortError"?C.value="请求超时，请检查网络连接":oe.message.includes("Failed to fetch")&&(C.value="网络请求失败，可能是跨域问题或API不可用")}},Ie=async oe=>{if(!T.value||!M.value){C.value="请先配置 GitHub Token 和仓库名";return}try{k.value=30;const re=Date.now(),Ae=oe.name.split(".").pop(),Ke=`${re}.${Ae}`,X=`${O.value}${Ke}`.replace(/\/\//g,"/"),we=await Je(oe),se={message:`Upload image ${Ke}`,content:we,branch:y.value||"main"};k.value=50;const ee=await fetch(`https://api.github.com/repos/${M.value}/contents/${X}`,{method:"PUT",headers:{Authorization:`token ${T.value}`,"Content-Type":"application/json"},body:JSON.stringify(se)});if(k.value=80,!ee.ok)throw new Error(`GitHub 上传失败: ${ee.status}`);const He=await ee.json();_.value=B.value&&V.value?`https://${V.value}/gh/${M.value}@${y.value||"main"}/${X}`:He.content.download_url,k.value=100,b.value=!1,E.add({title:"成功",description:`图片已上传到 GitHub${B.value&&V.value?" (CDN加速)":""}`,color:"green",timeout:2e3})}catch(re){console.error("GitHub 上传错误:",re),C.value=re.message||"GitHub 上传失败",b.value=!1}},Je=oe=>new Promise((re,Ae)=>{const Ke=new FileReader;Ke.onload=()=>re(Ke.result.split(",")[1]),Ke.onerror=Ae,Ke.readAsDataURL(oe)}),tt=()=>{try{const oe={selectedHost:h.value,github:{token:T.value,repo:M.value,branch:y.value,path:O.value,enableCDN:B.value,cdnDomain:V.value},smms:{token:I.value},freeimage:{token:j.value}};localStorage.setItem("imageHostingConfig",JSON.stringify(oe)),E.add({title:"成功",description:"配置已保存",color:"green",timeout:2e3})}catch(oe){console.error("保存配置失败:",oe),E.add({title:"错误",description:"保存配置失败",color:"red",timeout:2e3})}},U=()=>{const oe=localStorage.getItem("imageHostingConfig");if(oe)try{const re=JSON.parse(oe);h.value=re.selectedHost||"smms",re.github&&(T.value=re.github.token||"",M.value=re.github.repo||"",y.value=re.github.branch||"main",O.value=re.github.path||"images/",B.value=re.github.enableCDN||!1,V.value=re.github.cdnDomain||""),re.smms&&(I.value=re.smms.token||""),re.imgtp&&(imgtpToken.value=re.imgtp.token||""),re.freeimage&&(j.value=re.freeimage.token||"")}catch(re){console.error("加载配置失败:",re)}};return Et([h,T,M,y,O,I],()=>{tt()},{deep:!0}),Ht(()=>{U()}),(oe,re)=>{const Ae=Mr,Ke=ua,X=Cc,we=ci,se=Tc;return J(),ae("div",{class:"fixed z-[5000] bg-black/80 backdrop-blur-sm rounded-lg shadow-lg p-4 text-white",style:ji(s.value),onMousedown:m,onTouchstart:m},[N("div",Rd,[re[11]||(re[11]=N("h3",{class:"text-lg font-medium"},"图床上传",-1)),te(Ae,{icon:"i-heroicons-x-mark",color:"gray",variant:"ghost",size:"xs",onClick:re[0]||(re[0]=ee=>oe.$emit("close"))})]),N("div",Id,[N("div",Hd,[te(Ae,{color:h.value==="github"?"blue":"gray",variant:"solid",size:"sm",onClick:re[1]||(re[1]=ee=>h.value="github")},{default:Te(()=>re[12]||(re[12]=[dt(" GitHub ")])),_:1},8,["color"])]),h.value==="github"?(J(),ae("div",Nd,[te(Ke,{modelValue:T.value,"onUpdate:modelValue":re[2]||(re[2]=ee=>T.value=ee),placeholder:"GitHub Token",size:"sm",type:"password"},null,8,["modelValue"]),te(Ke,{modelValue:M.value,"onUpdate:modelValue":re[3]||(re[3]=ee=>M.value=ee),placeholder:"仓库名 (用户名/仓库)",size:"sm"},null,8,["modelValue"]),te(Ke,{modelValue:y.value,"onUpdate:modelValue":re[4]||(re[4]=ee=>y.value=ee),placeholder:"分支名 (默认: main)",size:"sm"},null,8,["modelValue"]),te(Ke,{modelValue:O.value,"onUpdate:modelValue":re[5]||(re[5]=ee=>O.value=ee),placeholder:"存储路径 (默认: images/)",size:"sm"},null,8,["modelValue"]),N("div",jd,[te(X,{modelValue:B.value,"onUpdate:modelValue":re[6]||(re[6]=ee=>B.value=ee)},null,8,["modelValue"]),re[13]||(re[13]=N("span",{class:"text-sm"},"启用CDN加速",-1))]),B.value?(J(),Lt(Ke,{key:0,modelValue:V.value,"onUpdate:modelValue":re[7]||(re[7]=ee=>V.value=ee),placeholder:"输入CDN域名 (如: jsd.cdn.noisework.cn)",size:"sm"},null,8,["modelValue"])):Le("",!0)])):Le("",!0),N("div",$d,[te(Ae,{color:"green",variant:"solid",size:"sm",icon:"i-heroicons-check",onClick:tt},{default:Te(()=>re[14]||(re[14]=[dt(" 保存配置 ")])),_:1})]),N("div",{class:be(["flex flex-col items-center justify-center border-2 border-dashed border-gray-500 rounded-lg p-4 cursor-pointer hover:border-blue-400 transition-colors",{"border-blue-400":g.value}]),onClick:z,onDragover:re[8]||(re[8]=nr(ee=>g.value=!0,["prevent"])),onDragleave:re[9]||(re[9]=nr(ee=>g.value=!1,["prevent"])),onDrop:nr(F,["prevent"])},[N("input",{ref_key:"fileInput",ref:f,type:"file",accept:"image/*",onChange:le,class:"hidden"},null,544),!b.value&&!w.value?(J(),Lt(we,{key:0,name:"i-heroicons-cloud-arrow-up",class:"w-10 h-10 text-gray-400 mb-2"})):Le("",!0),w.value&&!b.value?(J(),ae("img",{key:1,src:w.value,class:"max-h-32 max-w-full mb-2 rounded"},null,8,Bd)):Le("",!0),b.value?(J(),Lt(se,{key:2,value:k.value,color:"blue",class:"w-full mb-2"},null,8,["value"])):Le("",!0),!b.value&&!w.value?(J(),ae("p",Ud," 点击或拖拽图片到此处上传 ")):Le("",!0),b.value?(J(),ae("p",zd," 上传中... "+We(k.value)+"% ",1)):Le("",!0)],34),w.value&&!b.value&&!_.value?(J(),ae("div",Fd,[te(Ae,{color:"blue",variant:"solid",size:"sm",icon:"i-heroicons-cloud-arrow-up",onClick:De},{default:Te(()=>re[15]||(re[15]=[dt(" 开始上传 ")])),_:1})])):Le("",!0),C.value?(J(),ae("div",Vd,We(C.value),1)):Le("",!0),_.value?(J(),ae("div",qd,[N("div",Wd,[N("input",{type:"text",value:_.value,readonly:"",class:"bg-transparent flex-1 text-sm outline-none"},null,8,Yd),te(Ae,{icon:"i-heroicons-clipboard",color:"gray",variant:"ghost",size:"xs",onClick:re[10]||(re[10]=ee=>Ce(_.value))})]),N("div",Kd,[te(Ae,{color:"blue",variant:"solid",size:"sm",onClick:Be},{default:Te(()=>re[16]||(re[16]=[dt(" 插入图片 ")])),_:1})])])):Le("",!0)])],36)}}}),Xd=Tn(Gd,[["__scopeId","data-v-9124ba85"]]),Zd={class:"editor-box"},Jd={class:"editor-toolbar"},Qd={class:"toolbar-left"},ef={key:0,class:"w-full mt-2"},tf={class:"bg-gray-700 rounded h-2"},nf={class:"text-xs text-gray-300 mt-1 text-right"},rf=["title"],af=["title"],of={class:"toolbar-right"},sf={key:0,class:"mx-auto sm:max-w-2xl mt-4 preview-card"},lf=["innerHTML"],cf=nn({__name:"AddForm",emits:["search-result","video-uploaded","before-upload","upload-progress"],setup(p,{emit:e}){const r=G(!1),s=G({x:400,y:320}),l=U=>{var oe;(oe=y.value)!=null&&oe.insertValue&&y.value.insertValue(U),r.value=!1},d=U=>{s.value=U},m=G(0),u=U=>{m.value=U},v=G(!1),S=e,E=U=>{S("search-result",U)},h=Ze(),f=gn().public.baseApi||"/api",{save:g}=_s(),b=$i("showHeatmap");Er("showHeatmap",b);const k=G(""),w=G(""),_=G(""),C=G(typeof window<"u"&&localStorage.getItem("postPrivate")==="true"),T=$i("contentTheme");$i("toggleContentTheme");const M=G(null),y=G(null),O=he(()=>C.value?"i-mdi-eye-off-outline":"i-mdi-eye-outline"),B=he(()=>T.value==="dark"?"prose prose-invert":"prose");Dd();const V=G(localStorage.getItem("enableNotify")==="true"),I=()=>{k.value="",w.value="",_.value="",y.value&&y.value.clear()},j=Gn(),z=()=>j.isLogin?!0:(h.add({title:"提示",description:"请先登录",color:"orange",timeout:2e3}),!1),F=()=>{const U=document.getElementById("file-input");U&&U.click()},le=async U=>{var se;if(!z())return;const oe=U.target,re=oe.files?oe.files[0]:null;if(!re){h.add({title:"错误",description:"没有选择文件",color:"red",timeout:2e3});return}const Ae=["image/jpeg","image/png","image/gif","image/webp"],Ke=[".jpg",".jpeg",".png",".gif",".webp"],X=re.name.toLowerCase().substring(re.name.lastIndexOf("."));if(!Ae.includes(re.type)||!Ke.includes(X)){h.add({title:"错误",description:"仅支持 JPG、PNG、GIF、WEBP 格式的图片",color:"red",timeout:2e3});return}const we=5*1024*1024;if(re.size>we){h.add({title:"错误",description:"图片大小不能超过 5MB",color:"red",timeout:2e3});return}try{const ee=new FormData;ee.append("image",re);const He=await fetch(`${f}/images/upload`,{method:"POST",body:ee,credentials:"include"});if(!He.ok){const st=await He.json();throw new Error(st.msg||"图片上传失败")}const ve=await He.json();if(ve.code===1&&ve.data){if((se=y.value)!=null&&se.insertValue){const st=typeof window<"u"?window.location.origin:"",Ve=String(f||"/api"),Qe=String(ve.data||"");let Oe="";if(Qe.startsWith("http"))Oe=Qe;else{const lt=Qe.startsWith("/")?Qe:`/${Qe}`;/^https?:\/\//.test(Ve)?Oe=`${Ve}${lt}`:Oe=`${st}${Ve}${lt}`}const it=`
![](${Oe})
`;y.value.insertValue(it)}h.add({title:"成功",description:"图片上传成功",color:"green",timeout:2e3})}else throw new Error(ve.msg||"图片上传失败")}catch(ee){console.error("上传错误:",ee),h.add({title:"错误",description:ee.message||"图片上传失败",color:"red",timeout:2e3})}finally{M.value&&(M.value.value="")}},de=U=>{var X;const oe=String(U||""),re=gn().public.baseApi||"/api";let Ae=oe;if(!/^https?:\/\//.test(oe)){const we=oe.startsWith("/")?oe:`/${oe}`;/^https?:\/\//.test(String(re))?Ae=`${String(re).replace(/\/api$/,"")}${we}`:Ae=`${typeof window<"u"?window.location.origin:""}${we}`}const Ke=`<video width="100%" height="100%" src="${Ae}" controls loop></video>
`;(X=y.value)!=null&&X.insertValue&&y.value.insertValue(Ke)},Re=/!\s*(https?:\/\/[^\s!]+\.(?:png|jpe?g|gif|webp))(?:\?[^\s!]*)?/gi,Be=U=>U.replace(Re,(oe,re)=>`![](${re})`),Ce=U=>{const re=new DOMParser().parseFromString(U,"text/html"),Ae=se=>{let ee=!0;const He=Array.from(se.childNodes);if(He.length===0)return!1;for(const ve of He)if(ve.nodeType===Node.ELEMENT_NODE){const st=ve,Ve=st.tagName.toLowerCase();if(Ve==="img"||Ve==="a"&&st.childElementCount===1&&st.querySelector("img"))continue;if(Ve==="br"){ee=!1;break}ee=!1;break}else if(ve.nodeType===Node.TEXT_NODE&&(ve.textContent||"").trim()!==""){ee=!1;break}return ee},Ke=Array.from(re.body.querySelectorAll("p")),X=[];let we=[];for(const se of Ke)if(Ae(se)){const ee=we[we.length-1];!ee||ee.nextElementSibling===se?we.push(se):(we.length>=2&&X.push(we),we=[se])}else we.length>=2&&X.push(we),we=[];we.length>=2&&X.push(we);for(const se of X){const ee=re.createElement("div"),He=se.length,ve=He===2||He===4?2:Math.min(3,He);ee.className=`image-grid cols-${ve}`;const st=`grid-${Math.random().toString(36).slice(2)}`;for(const Qe of se){const Oe=Qe.querySelector("img"),it=Qe.querySelector("a");if(!Oe&&!it)continue;const lt=re.createElement("div");lt.className="image-grid-item";let ft;if(it&&it.querySelector("img")){if(ft=it,ft.setAttribute("data-fancybox",st),!ft.getAttribute("href")){const ht=it.querySelector("img");ft.setAttribute("href",ht.src)}}else if(Oe)ft=re.createElement("a"),ft.setAttribute("href",Oe.src),ft.setAttribute("data-fancybox",st),ft.appendChild(Oe);else continue;lt.appendChild(ft),ee.appendChild(lt)}se[0].replaceWith(ee);for(let Qe=1;Qe<se.length;Qe++)se[Qe].remove()}return re.body.innerHTML};Et(w,U=>{const oe=_r.md2html(Be(U||""));_.value=Ce(oe),yt(()=>{document.querySelectorAll(".editor-preview").forEach(Ae=>{Ae.querySelectorAll(".image-grid-item img").forEach(Ke=>{const X=Ke,we=X.parentElement,se=()=>{const ee=X.naturalWidth,He=X.naturalHeight;we.classList.remove("ar-169","ar-34","ar-11"),ee>He?we.classList.add("ar-169"):He>ee?we.classList.add("ar-34"):we.classList.add("ar-11")};X.complete&&X.naturalWidth&&X.naturalHeight?se():X.addEventListener("load",se,{once:!0})})})})}),Et(()=>j.isLogin,U=>{U&&(V.value=localStorage.getItem("enableNotify")==="true")},{immediate:!0}),Ht(async()=>{bt.bind("[data-fancybox]",{}),j.isLogin||localStorage.getItem("token")&&j.fetchUserInfo&&await j.fetchUserInfo(),C.value=localStorage.getItem("postPrivate")==="true",T.value=localStorage.getItem("contentTheme")||T.value}),Ni(()=>{bt.destroy()});const De=()=>{V.value=!V.value,localStorage.setItem("enableNotify",V.value.toString())},Ie=()=>{C.value=!C.value,localStorage.setItem("postPrivate",C.value?"true":"false")},Je=U=>j.isLogin?!0:(h.add({title:"提示",description:"请登录后操作",color:"orange",timeout:2e3}),U.preventDefault&&U.preventDefault(),!1),tt=async()=>{if(!z())return;if(!w.value.trim()){h.add({title:"错误",description:"请输入内容或上传图片/视频",color:"red",timeout:2e3});return}const U={username:k.value,content:w.value,private:C.value,notify:V.value};try{await g(U)&&I()}catch(oe){console.error("发布错误:",oe),h.add({title:"错误",description:oe.message||"发布失败",color:"red",timeout:2e3})}};return(U,oe)=>{const re=ci;return J(),ae(It,null,[N("div",{class:be(U.containerClass)},[N("div",Zd,[te(xd,{ref_key:"vditorEditor",ref:y,modelValue:w.value,"onUpdate:modelValue":oe[0]||(oe[0]=Ae=>w.value=Ae),theme:Se(T)},null,8,["modelValue","theme"]),N("div",Jd,[N("div",Qd,[N("input",{id:"file-input",ref_key:"fileInput",ref:M,type:"file",accept:"image/*",onChange:le,class:"hidden",placeholder:"选择图片"},null,544),te(Pd,{onVideoUploaded:de,onBeforeUpload:Je,onUploadProgress:u}),m.value>0&&m.value<100?(J(),ae("div",ef,[N("div",tf,[N("div",{class:"bg-blue-500 h-2 rounded",style:ji({width:m.value+"%"})},null,4)]),N("div",nf,We(m.value)+"%",1)])):Le("",!0),N("button",{class:"tb-btn",onClick:F,title:"插入图片"},[te(re,{name:"i-fluent-image-20-regular",class:"w-5 h-5"})]),N("button",{class:"tb-btn",onClick:oe[1]||(oe[1]=Ae=>r.value=!0),title:"图床上传"},[te(re,{name:"i-mdi-cloud-upload-outline",class:"w-5 h-5"})]),N("button",{class:"tb-btn",onClick:Ie,title:C.value?"设为公开":"设为私密"},[te(re,{name:O.value,class:"w-5 h-5"},null,8,["name"])],8,rf),N("button",{class:"tb-btn",onClick:De,title:V.value?"关闭推送":"开启推送"},[te(re,{name:V.value?"i-mdi-bell":"i-mdi-bell-off",class:"w-5 h-5"},null,8,["name"])],8,af)]),N("div",of,[N("button",{class:"tb-btn",onClick:I,title:"清空"},[te(re,{name:"i-fluent-broom-16-regular",class:"w-5 h-5"})]),N("button",{class:"tb-btn primary",onClick:tt,title:"发布"},[te(re,{name:"i-fluent-add-12-filled",class:"w-5 h-5"})])])])])],2),_.value?(J(),ae("div",sf,[N("div",{class:be([B.value,"max-w-none editor-preview"])},[N("div",{innerHTML:_.value},null,8,lf)],2)])):Le("",!0),te(Vs,{modelValue:v.value,"onUpdate:modelValue":oe[2]||(oe[2]=Ae=>v.value=Ae),onSearchResult:E},null,8,["modelValue"]),r.value?(J(),Lt(Xd,{key:1,position:s.value,onClose:oe[3]||(oe[3]=Ae=>r.value=!1),onUploadSuccess:l,"onUpdate:position":d},null,8,["position"])):Le("",!0)],64)}}}),uf=Tn(cf,[["__scopeId","data-v-e8e01b9d"]]),wi=nn({__name:"MarkdownRenderer",props:{content:{type:String,required:!0},enableGithubCard:{type:Boolean,default:!0}},emits:["tagClick","rendered"],setup(p,{emit:e}){const r=/https:\/\/www\.bilibili\.com\/video\/(BV[\w]+)\/?$/,s=/https:\/\/(?:www\.)?youtube\.com\/watch\?v=([\w-]+)|https:\/\/youtu\.be\/([\w-]+)/,l=/https:\/\/music\.163\.com(?:\/#)?\/song\?id=(\d+)/,d=/https:\/\/y\.qq\.com\/n\/yqq\/song(\w+)\.html/,m=/https:\/\/v\.qq\.com\/x\/cover\/\w+\/(\w+)\.html/,u=/https:\/\/open\.spotify\.com\/(track|album|playlist)\/([a-zA-Z0-9]+)/,v=/https:\/\/v\.youku\.com\/v_show\/id_([a-zA-Z0-9]+)\.html/,S=e,E=G(null);let h=null;const f=p,g=$i("contentTheme"),b=()=>{if(!E.value)return;const O=g&&g.value==="dark";E.value.classList.toggle("theme-dark",!!O),E.value.classList.toggle("theme-light",!O)},k=()=>{var O;if(window.mediumZoom){h&&h.detach();const B=(O=E.value)==null?void 0:O.getElementsByTagName("img");B&&B.length>0&&(h=window.mediumZoom(B,{background:"rgba(0, 0, 0, 0.9)",margin:24,scrollOffset:0}))}},w=()=>{if(!E.value)return;const O=j=>{let z=!0;const F=Array.from(j.childNodes);if(F.length===0)return!1;for(const le of F)if(le.nodeType===Node.ELEMENT_NODE){const de=le,Re=de.tagName.toLowerCase();if(Re==="img"||Re==="a"&&de.childElementCount===1&&de.querySelector("img"))continue;if(Re==="br"){z=!1;break}z=!1;break}else if(le.nodeType===Node.TEXT_NODE&&(le.textContent||"").trim()!==""){z=!1;break}return z},B=Array.from(E.value.querySelectorAll("p")),V=[];let I=[];for(const j of B)if(O(j)){const z=I[I.length-1];!z||z.nextElementSibling===j?I.push(j):(I.length>=2&&V.push(I),I=[j])}else I.length>=2&&V.push(I),I=[];I.length>=2&&V.push(I);for(const j of V){const z=document.createElement("div"),F=j.length,le=F===2||F===4?2:Math.min(3,F);z.className=`image-grid cols-${le}`;const de=`grid-${Math.random().toString(36).slice(2)}`;for(const Be of j){const Ce=Be.querySelector("img"),De=Be.querySelector("a");if(!Ce&&!De)continue;const Ie=document.createElement("div");Ie.className="image-grid-item";let Je;if(De&&De.querySelector("img")){if(Je=De,Je.setAttribute("data-fancybox",de),!Je.getAttribute("href")&&De.querySelector("img")){const tt=De.querySelector("img");Je.setAttribute("href",tt.src)}}else if(Ce)Je=document.createElement("a"),Je.setAttribute("href",Ce.src),Je.setAttribute("data-fancybox",de),Je.appendChild(Ce);else continue;Ie.appendChild(Je),z.appendChild(Ie)}z.querySelectorAll("img").forEach(Be=>{const Ce=Be,De=Ce.closest(".image-grid-item"),Ie=()=>{const Je=Ce.naturalWidth,tt=Ce.naturalHeight;De&&(De.classList.remove("ar-169","ar-34","ar-11"),Je>tt?De.classList.add("ar-169"):tt>Je?De.classList.add("ar-34"):De.classList.add("ar-11"))};Ce.complete&&Ce.naturalWidth&&Ce.naturalHeight?Ie():Ce.addEventListener("load",Ie,{once:!0})}),j[0].replaceWith(z);for(let Be=1;Be<j.length;Be++)j[Be].remove()}},_=new RegExp("(?<!!)\\[([^\\]]+)\\]\\((https:\\/\\/github\\.com\\/([\\w-]+)\\/([\\w.-]+)(?:\\/[^\\s)]*)?)\\)","g"),C=new RegExp(`(?<!["'\\(])\\bhttps:\\/\\/github\\.com\\/([\\w-]+)\\/([\\w.-]+)(?:\\/[^\\s<\\)]*)?\\b`,"g"),T=O=>{f.enableGithubCard&&(O=O.replace(_,(V,I,j,z,F)=>`<div class="github-card" id="${`github-card-${z}-${F}`}" data-owner="${z}" data-repo="${F}">
        <div class="github-card-loading">Loading GitHub Repo...</div>
      </div>`),O=O.replace(C,(V,I,j)=>`<div class="github-card" id="${`github-card-${I}-${j}`}" data-owner="${I}" data-repo="${j}">
        <div class="github-card-loading">Loading GitHub Repo...</div>
      </div>`));const B=new RegExp(`(?<!["'\\(])\\bhttps?:\\/\\/[^\\s<]+\\.(mp4|webm|mov|avi)(\\?[^\\s<\\)]*)?\\b`,"g");return O=O.replace(B,V=>`<video src="${V}" controls preload="metadata" style="width:100%;height:auto"></video>`),O.replace(r,"<div class='video-wrapper'><iframe src='https://www.bilibili.com/blackboard/html5mobileplayer.html?bvid=$1&as_wide=1&high_quality=1&danmaku=0' scrolling='no' border='0' frameborder='no' framespacing='0' allowfullscreen='true' style='position:absolute;height:100%;width:100%'></iframe></div>").replace(s,"<div class='video-wrapper'><iframe src='https://www.youtube.com/embed/$1$2' title='YouTube video player' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen></iframe></div>").replace(l,"<div class='music-wrapper'><meting-js auto='https://music.163.com/#/song?id=$1'></meting-js></div>").replace(d,"<meting-js auto='https://y.qq.com/n/yqq/song$1.html'></meting-js>").replace(m,"<div class='video-wrapper'><iframe src='//v.qq.com/iframe/player.html?vid=$1' allowFullScreen='true' frameborder='no'></iframe></div>").replace(u,"<div class='spotify-wrapper'><iframe style='border-radius:12px' src='https://open.spotify.com/embed/$1/$2?utm_source=generator&theme=0' width='100%' frameBorder='0' allowfullscreen='' allow='autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture' loading='lazy'></iframe></div>").replace(v,"<div class='video-wrapper'><iframe src='https://player.youku.com/embed/$1' frameborder=0 'allowfullscreen'></iframe></div>")},M=async(O,B,V)=>{try{const I=await fetch(`https://api.github.com/repos/${O}/${B}`);if(!I.ok)return;const j=await I.json(),z=document.getElementById(V);z&&(z.innerHTML=`
        <div class="github-card-header">
          <img src="${j.owner.avatar_url}" class="github-card-avatar" />
          <div>
            <a href="${j.html_url}" target="_blank" class="github-card-title">${j.full_name}</a>
            <div class="github-card-desc">${j.description||""}</div>
          </div>
        </div>
        <div class="github-card-footer">
          <span>⭐ ${j.stargazers_count}</span>
          <span>🍴 ${j.forks_count}</span>
          <span>🛠️ ${j.language||""}</span>
        </div>
      `)}catch{}},y=async O=>{if(E.value)try{if(typeof _r>"u"){console.error("Vditor is not loaded.");return}let B="";try{B=normalizeInlineImageLinks(O??"")}catch{B=O??""}const V=T(B),j=(de=>de.replace(/(^|\s)(https?:\/\/[^\s<]+)/g,(Re,Be,Ce)=>`${Be}<a href="${Ce}" target="_blank" rel="noopener noreferrer">${Ce}</a>`))(V);let z="";try{z=j.replace(/<a /g,'<a target="_blank" ').replace(new RegExp("(?<!<[^>]*)#([^\\s#<>]+)(?![^<]*>)","g"),`<span class="clickable-tag" onclick="window.handleTagClick('$1')" style="cursor: pointer;">#$1</span>`)}catch{z=j.replace(/<a /g,'<a target="_blank" ')}const F=g&&g.value==="dark"?"dark":"light",le=F==="dark"?"github-dark":"github";try{_r.preview(E.value,z,{mode:"light",lang:"zh_CN",theme:{current:F},hljs:{style:le,lineNumber:!0,enable:!0},markdown:{sanitize:!1},after:()=>{var De,Ie,Je,tt;const de=(De=E.value)==null?void 0:De.querySelectorAll("a");de==null||de.forEach(U=>{U.hasAttribute("target")||(U.setAttribute("target","_blank"),U.setAttribute("rel","noopener noreferrer"))}),b(),w(),k(),(((Ie=E.value)==null?void 0:Ie.querySelectorAll("a[href]"))||[]).forEach(U=>{const oe=U.getAttribute("href")||"";if(/\.(mp4|webm|mov|avi)(\?.*)?$/i.test(oe)){const re=document.createElement("video");re.setAttribute("src",oe),re.setAttribute("controls","true"),re.setAttribute("preload","metadata"),re.style.width="100%",re.style.height="auto",U.replaceWith(re)}}),console.log("Rendering complete."),S("rendered");const Be=window.processNMPv2Shortcodes;Be&&E.value&&Be(E.value);const Ce=(Je=E.value)==null?void 0:Je.querySelectorAll(".clickable-tag");if(Ce==null||Ce.forEach(U=>{U.addEventListener("click",oe=>{var Ae;oe.preventDefault();const re=(Ae=U.textContent)==null?void 0:Ae.substring(1);re&&S("tagClick",re)})}),f.enableGithubCard){const U=(tt=E.value)==null?void 0:tt.querySelectorAll(".github-card");U==null||U.forEach(oe=>{const re=oe.getAttribute("data-owner"),Ae=oe.getAttribute("data-repo"),Ke=oe.id;re&&Ae&&Ke&&M(re,Ae,Ke)})}}})}catch{try{E.value.innerHTML=_r.md2html(z),b()}catch{E.value.innerHTML=z}}}catch(B){console.error("Error rendering markdown:",B),E.value.innerHTML=""}};return Et(()=>f.content,async O=>{await y(O)},{immediate:!0}),Ht(()=>{y(f.content),window.APlayer&&window.MetingJSElement?console.log("MetingJS is ready"):console.error("MetingJS or APlayer is not loaded properly"),b()}),Ni(()=>{h&&(h.detach(),h=null)}),Et(()=>g&&g.value,()=>{b(),y(f.content)}),(O,B)=>(J(),ae("div",{ref_key:"previewElement",ref:E,class:"markdown-preview"},null,512))}}),df={class:"builtin-comments"},ff={key:0,class:"comments-list"},hf=["src","data-mail","onError"],pf={class:"comment-body"},mf={class:"comment-nick"},gf=["href"],vf={class:"comment-footer"},bf={class:"comment-time"},yf={class:"comment-replies"},wf={class:"comment-actions"},Ef=["onClick"],kf=["onClick"],Sf={key:0,class:"mt-2 replies-list"},xf=["src","data-mail","onError"],_f={class:"comment-body"},Cf={class:"comment-nick"},Tf=["href"],Mf={class:"comment-footer"},Af={class:"comment-time"},Lf={class:"comment-actions"},Df=["onClick"],Of=["onClick"],Pf={key:1,class:"flex justify-end w-full"},Rf=["onClick"],If={key:1,class:"flex justify-center"},Hf={key:4,class:"space-y-3 mt-3 md:mt-4"},Nf={class:"grid grid-cols-1 md:grid-cols-3 gap-3"},jf={class:"flex flex-wrap items-center gap-2 mb-2"},$f={class:"relative"},Bf={class:"flex flex-wrap gap-1 w-56"},Uf=["onClick"],zf={class:"comment-input-card"},Ff=["src","data-mail"],Vf={class:"input-main"},qf={class:"input-actions"},Wf=["disabled"],Yf={class:"flex justify-between items-center"},Kf={class:"space-y-3"},Gf={class:"text-sm"},Xf={class:"text-sm"},Zf={class:"text-sm break-words"},Jf={class:"flex items-center gap-2 text-sm"},Qf={class:"flex justify-end gap-2"},Na="w-full px-2 py-1 border rounded ring-0 focus:ring-0 outline-none",ja="w-full px-2 py-1 bg-[rgba(24,28,32,0.85)] text-white border rounded focus:ring-0 outline-none placeholder:text-gray-400",eh=nn({__name:"BuiltinComments",props:{messageId:{},siteConfig:{},showInput:{type:Boolean}},setup(p){const e=p,r=G([]),s=G(""),l=G(""),d=G(!1),m=G(""),u=G(""),v=G(""),S=G(null),E=G(!1),h=G(null),f=G(!1),g=G(!1),b=G(null),k=Gn(),w=he(()=>{var W;return!!((W=k.user)!=null&&W.is_admin)}),_=he(()=>{const W=e.siteConfig||{};return!!(W&&(W.commentEnabled===!0||W.commentEnabled==="true"))}),C=he(()=>{const W=e.siteConfig||{};return!!(W&&(W.commentLoginRequired===!0||W.commentLoginRequired==="true"))}),T=he(()=>(!C.value||k.isLogin)&&_.value),M=$i("contentTheme",G("light")),y=he(()=>{const W=M&&typeof M.value<"u"?M.value:M;return String(W||"light")==="dark"}),O=he(()=>"bg-transparent"),B=he(()=>y.value?"border-white/20":"border-black"),V=he(()=>y.value?"text-gray-200":"text-black"),I=he(()=>y.value?"text-gray-400":"text-gray-500");he(()=>y.value?"bg-[rgba(24,28,32,0.7)]":"bg-white"),he(()=>y.value?"border-white/20":"border-black");const j=he(()=>y.value?"rounded-md p-3 bg-transparent border border-white/20 shadow-[0_6px_16px_rgba(0,0,0,0.35)]":"rounded-md p-3 bg-transparent border border-black/10 shadow-[0_4px_12px_rgba(0,0,0,0.12)]"),z=he(()=>y.value?"rounded-md p-2 bg-transparent border border-white/20":"rounded-md p-2 bg-transparent border border-black/10"),F=he(()=>f.value?"ring-1 ring-red-500":y.value?`${ja} border-white/20`:`bg-gray-50 ${Na} border-black`),le=he(()=>g.value?"ring-1 ring-red-500":y.value?`${ja} border-white/20`:`bg-gray-50 ${Na} border-black`),de=he(()=>y.value?`${ja} border-white/20`:`bg-white ${Na} border-black`),Re=he(()=>y.value?"w-full px-3 py-2 bg-[rgba(24,28,32,0.95)] text-white border border-blue-500 focus:border-blue-400 rounded-md ring-0 outline-none":"w-full px-3 py-2 bg-white text-black border border-blue-500 focus:border-blue-600 rounded-md ring-0 outline-none"),Be=he(()=>{const W=e.siteConfig||{},Z=String(W.avatarURL||"").trim();return Z?/^https?:\/\//i.test(Z)?Z:`${se}${Z}`:String(W.rssFaviconURL||"/favicon.svg").trim()}),Ce=(W,Z=60)=>{const xe=encodeURIComponent(String(W||"").trim());return xe?`https://api.dicebear.com/7.x/initials/svg?seed=${xe}&backgroundType=gradient&radius=50&scale=100&size=${Z}`:""},De=W=>{const Z=String(W||"").trim().match(/^([0-9]{5,12})@qq\.com$/i);return Z?Z[1]:""},Ie=(W,Z=100)=>W?`https://q1.qlogo.cn/g?b=qq&nk=${W}&s=${Z}`:"",Je=W=>{var Ln,Vn,di,ki;const Z=String((W==null?void 0:W.nick)||"").trim(),xe=String((W==null?void 0:W.mail)||"").trim(),ze=De(xe),Ue=Ie(ze),nt=Gn(),Me=String(((Ln=nt.user)==null?void 0:Ln.username)||((Vn=nt.user)==null?void 0:Vn.Username)||"").trim(),Rt=String(((di=nt.user)==null?void 0:di.avatar_url)||((ki=nt.user)==null?void 0:ki.AvatarURL)||"").trim(),Xt=Nn=>Nn?/^https?:\/\//i.test(Nn)?Nn:`${se}${Nn}`:"";return Me&&Z&&Me===Z&&Rt?Xt(Rt):Ue||tt(Z||xe||"anonymous")||Be.value},tt=(W,Z=60)=>{const xe=encodeURIComponent(String(W||"").trim());return xe?`https://i.pravatar.cc/${Z}?u=${xe}`:""},U=(W=60)=>{const Z=`<svg xmlns="http://www.w3.org/2000/svg" width="${W}" height="${W}" viewBox="0 0 64 64"><rect width="64" height="64" rx="32" fill="#9ca3af"/><circle cx="32" cy="24" r="12" fill="#e5e7eb"/><path d="M16 52c0-10 8-18 16-18s16 8 16 18" fill="#e5e7eb"/></svg>`;return"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(Z)},oe=(W,Z)=>{var Rt;const xe=W.target,ze=((Rt=xe==null?void 0:xe.dataset)==null?void 0:Rt.mail)||"",Ue=De(ze),Me=Ie(Ue)||tt(Z||ze||"anonymous")||U(60);xe&&Me&&(xe.src=Me)},re=he(()=>{const W=!!De(String(m.value||"")),Z=!!String(s.value||"").trim()&&d.value;return W||Z}),Ae=he(()=>{const W=String(m.value||"").trim(),Z=De(W);if(Z)return Ie(Z,100);const xe=String(s.value||"").trim();return xe?Ce(xe):""}),Ke=G(!1),X=()=>{Ke.value=!0};Et([s,m],()=>{Ke.value=!1});const we=()=>{d.value=!0};Ht(()=>{l.value=s.value});const se=gn().public.baseApi||"/api",ee=G(!1),He=G(!1),ve=he(()=>{const W=b.value;return W&&(r.value||[]).find(Z=>Number(Z.id)===Number(W))||null}),st=he(()=>{const W=ve.value,Z=String(W&&W.content||"").trim();return Z.length>120?Z.slice(0,120)+"...":Z}),Ve=()=>{He.value=!1,ee.value=!1},Qe=async()=>{try{const W=async Ue=>{const nt=await fetch(Ue,{credentials:"include",headers:{Accept:"application/json"}});if(!nt||!nt.ok)return null;const Me=await nt.json();return!Me||Me.code!==1||!Array.isArray(Me.data)?[]:Me.data},Z=typeof window<"u"?window.location.origin:"",xe=[`${se}/messages/${e.messageId}/comments`,`${Z}/api/messages/${e.messageId}/comments`,`http://localhost:1315/api/messages/${e.messageId}/comments`,`http://127.0.0.1:1315/api/messages/${e.messageId}/comments`];let ze=[];for(const Ue of xe){const nt=await W(Ue);if(nt&&nt.length>=0&&(ze=nt,ze.length>0))break}r.value=(ze||[]).sort((Ue,nt)=>new Date(nt.created_at).getTime()-new Date(Ue.created_at).getTime());try{window.dispatchEvent(new CustomEvent("comment-count-updated",{detail:{messageId:e.messageId,count:r.value.length}}))}catch{}}catch{r.value=[]}},Oe=async()=>{try{if(E.value)return;if(E.value=!0,f.value=!s.value.trim(),g.value=!m.value.trim(),f.value||g.value){Ze().add({title:"缺少必填字段",description:(s.value?"":"昵称 ")+(m.value?"":"邮箱"),color:"red"}),E.value=!1;return}const W=v.value.trim(),Z={nick:s.value.trim(),mail:m.value.trim(),link:u.value.trim(),content:W};if(!Z.content){Ze().add({title:"内容不能为空",color:"red"}),E.value=!1;return}if(Z.mail&&!/^\S+@\S+\.\S+$/.test(Z.mail)){Ze().add({title:"邮箱格式不正确",color:"red"}),E.value=!1;return}h.value&&(Z.parent_id=h.value);const xe=await Ii(`messages/${e.messageId}/comments`,Z,{credentials:"include"});if(xe&&xe.code===1){v.value="",h.value=null,r.value=[...r.value,xe.data],await Qe(),await yt();const ze=document.querySelector(`.content-container[data-msg-id="${e.messageId}"] .builtin-comments`),Ue=ze==null?void 0:ze.querySelectorAll(".rounded-md"),nt=Ue&&Ue.length?Ue[Ue.length-1]:null;nt==null||nt.scrollIntoView({behavior:"smooth",block:"center"}),Ze().add({title:"已发布",color:"green"});try{window.dispatchEvent(new CustomEvent("comment-count-updated",{detail:{messageId:e.messageId,count:r.value.length}}))}catch{}}else Ze().add({title:"发布失败",description:xe==null?void 0:xe.msg,color:"red"})}catch{Ze().add({title:"发布失败",color:"red"})}finally{E.value=!1}},it=W=>{const Z=new Date(W),xe=Z.getMonth()+1,ze=Z.getDate();return`${xe}月${ze}日`},lt=W=>{const Z=String(W||"").trim();return Z&&/^https?:\/\//i.test(Z)?Z:""},ft=(W,Z)=>{for(const xe of Z){const ze=String((W||{})[xe]||"").trim();if(ze)return ze}return""},ht=()=>{const W=k.user||{},Z=ft(W,["nick","nickname","Nick","Nickname","username","Username","name","Name"]),xe=ft(W,["email","Email","mail","Mail"]),ze=ft(W,["link","Link","website","Website","homepage","HomePage","url","Url"]);!s.value&&Z&&(s.value=Z),!m.value&&xe&&(m.value=xe),!u.value&&ze&&(u.value=ze)},Dt=G(!1),Mn=he(()=>(e.showInput&&!Dt.value||!!h.value)&&T.value);Et(()=>e.showInput,W=>{W&&(Dt.value=!1)}),Et([Mn,()=>k.isLogin],()=>{Mn.value&&k.isLogin&&ht()},{immediate:!0}),Ht(Qe);const rn=()=>Qe();Ht(()=>{window.addEventListener(`refresh-comments-${e.messageId}`,rn)}),Ni(()=>{window.removeEventListener(`refresh-comments-${e.messageId}`,rn)}),Et(()=>e.messageId,Qe);const an=(W,Z)=>{h.value=W,v.value.startsWith(`@${Z} `)||(v.value=`@${Z} `+v.value),ht()},rt=W=>{b.value=W,confirm("确认删除该评论吗？此操作不可恢复。")?(He.value=!1,ee.value=!0):b.value=null},Kt=async()=>{if(b.value)try{if(!He.value){Ze().add({title:"请先勾选确认",color:"orange"});return}const W=await ss(`messages/${e.messageId}/comments/${b.value}`,void 0,{credentials:"include"});W&&W.code===1?(r.value=r.value.filter(Z=>Z.id!==b.value),Ze().add({title:"已删除",color:"green"}),dn()):Ze().add({title:"删除失败",description:W==null?void 0:W.msg,color:"red"})}catch{Ze().add({title:"删除失败",color:"red"})}finally{b.value=null,Ve()}},dn=()=>{const W=document.querySelector(`.content-container[data-msg-id="${e.messageId}"]`);W==null||W.scrollIntoView({behavior:"smooth",block:"start"})},on=he(()=>{const W=Array.isArray(r.value)?r.value:[],Z=new Set;return W.forEach(xe=>{const ze=String((xe==null?void 0:xe.nick)||"").trim();ze&&Z.add(ze)}),Array.from(Z)}),fn=G(!1),yn=G(""),un=G(0),Nt=he(()=>{const W=yn.value.toLowerCase();return on.value.filter(xe=>xe.toLowerCase().startsWith(W)).slice(0,20)}),Mt=()=>{fn.value=!1,un.value=0,yn.value=""},ei=()=>{fn.value=!0,un.value=0},$t=()=>{const W=S.value;return W?{start:W.selectionStart||0,end:W.selectionEnd||0}:{start:0,end:0}},Ot=(W,Z,xe,ze)=>{const Ue=W.slice(0,Z),nt=W.slice(xe);return Ue+ze+nt},jt=()=>{const W=S.value;if(!W)return;const Z=W.selectionStart||0,xe=v.value;let ze=Z-1;for(;ze>=0&&xe[ze]!==`
`&&xe[ze]!==" ";)ze--;const Ue=ze+1;if(xe[Ue]!=="@"){Mt();return}const nt=Z,Me=xe.slice(Ue+1,nt);yn.value=Me,ei()},q=()=>{const W=S.value;W&&(W.style.height="auto",W.style.height=Math.max(80,W.scrollHeight)+"px")},P=()=>{jt(),q()},ne=W=>{if(W.key==="Enter"&&(W.ctrlKey||W.metaKey)){W.preventDefault(),v.value.trim()&&Oe();return}if(W.key==="@"){yt(jt);return}if(fn.value)if(W.key==="ArrowDown")W.preventDefault(),un.value=Math.min(un.value+1,Nt.value.length-1);else if(W.key==="ArrowUp")W.preventDefault(),un.value=Math.max(un.value-1,0);else if(W.key==="Enter"){W.preventDefault();const Z=Nt.value[un.value];Z&&Pt(Z)}else W.key==="Escape"&&Mt()};Ht(()=>{yt(q)});const ie=he(()=>(y.value,"bg-blue-500 text-white hover:bg-blue-600 disabled:opacity-60")),Pe=he(()=>y.value?"bg-gray-600 text-white hover:bg-gray-500":"bg-gray-200 text-black hover:bg-gray-300"),Fe=()=>{v.value="",Mt(),yt(q)},et=()=>{var Z;v.value="",h.value=null,Dt.value=!0,Mt();const W=S.value;(Z=W==null?void 0:W.blur)==null||Z.call(W),yt(q),emit("cancel",{empty:(r.value||[]).length===0})},Pt=W=>{const Z=S.value;if(!Z)return;const xe=Z.selectionStart||0,ze=v.value;let Ue=xe-1;for(;Ue>=0&&ze[Ue]!==`
`&&ze[Ue]!==" ";)Ue--;const nt=Ue+1,Me=xe;v.value=Ot(ze,nt,Me,`@${W} `),Mt(),yt(()=>{const Rt=nt+W.length+2;Z.setSelectionRange(Rt,Rt),Z.focus()})},ge=G(!1),mt=["😀","😄","😁","😆","😊","😍","🤔","👍","🔥","🎉","❤️","🥳","✨","🌟","🍀"],gt=()=>{ge.value=!ge.value},_t=W=>{const Z=S.value;if(!Z){v.value+=W;return}const{start:xe,end:ze}=$t();v.value=Ot(v.value,xe,ze,W);const Ue=xe+W.length;yt(()=>{Z.setSelectionRange(Ue,Ue),Z.focus()})},wn=W=>{_t(W),ge.value=!1},An=W=>{S.value;const{start:Z,end:xe}=$t(),ze=v.value.slice(Z,xe);if(W==="bold")_t(ze?`**${ze}**`:"**加粗**");else if(W==="italic")_t(ze?`*${ze}*`:"*斜体*");else if(W==="link"){const Ue=window.prompt("请输入链接地址","https://")||"";/^https?:\/\//i.test(Ue)&&_t(ze?`[${ze}](${Ue})`:`[链接文本](${Ue})`)}else if(W==="image"){const Ue=window.prompt("请输入图片地址","https://")||"";/^https?:\/\//i.test(Ue)&&_t(`![图片](${Ue})`)}},vt=he(()=>(Array.isArray(r.value)?r.value:[]).filter(xe=>xe&&(xe.parent_id===null||Number(xe.parent_id||0)===0))),Bt=he(()=>{const W={};return(Array.isArray(r.value)?r.value:[]).forEach(xe=>{W[Number(xe.id)]=xe}),W}),Ut=he(()=>{const W={},Z={};return(Array.isArray(r.value)?r.value:[]).forEach(ze=>{const Ue=Number((ze==null?void 0:ze.parent_id)||0);if(Ue>0){const nt=Bt.value[Ue];if(!nt)return;Z[Number(ze.id)]=String(nt.nick||"");let Me=nt;for(;Number((Me==null?void 0:Me.parent_id)||0)>0;){const Xt=Bt.value[Number(Me.parent_id)];if(!Xt)break;Me=Xt}const Rt=Number(Me.id);W[Rt]||(W[Rt]=[]),W[Rt].push(ze)}}),Object.keys(W).forEach(ze=>{W[Number(ze)]=(W[Number(ze)]||[]).sort((Ue,nt)=>new Date(nt.created_at).getTime()-new Date(Ue.created_at).getTime())}),{map:W,targetMap:Z}}),en=he(()=>Ut.value.map);he(()=>Ut.value.targetMap);const sn=he(()=>(Array.isArray(vt.value)?vt.value:[]).slice().sort((Z,xe)=>new Date(xe.created_at).getTime()-new Date(Z.created_at).getTime())),ln=G(3),ti=he(()=>sn.value.slice(0,ln.value)),ui=he(()=>sn.value.length>ln.value),Hn=()=>{ln.value+=3};Et(()=>e.messageId,()=>{ln.value=3});const zt=G({}),Wt=W=>{const Z=zt.value[W]??3;return(en.value[W]||[]).slice(0,Z)},Ge=W=>{const Z=(en.value[W]||[]).length,xe=zt.value[W]??3;return Z>xe},ut=W=>{const Z=zt.value[W]??3;zt.value[W]=Z+3};Et(en,W=>{const Z={...zt.value};Object.keys(W||{}).forEach(xe=>{const ze=Number(xe);Z[ze]||(Z[ze]=3)}),zt.value=Z}),Et(()=>e.messageId,()=>{zt.value={}});const Gt=W=>(en.value[W]||[]).length;return(W,Z)=>{var nt;const xe=Mr,ze=ca,Ue=da;return J(),ae("div",df,[N("div",{class:be(["waline-wrapper px-2 py-2 rounded-lg",[O.value]])},[N("div",{class:be(["text-sm mb-2",V.value])},"评论 ("+We(r.value.length)+")",3),sn.value.length?(J(),ae("div",ff,[(J(!0),ae(It,null,Qt(ti.value,(Me,Rt)=>{var Xt;return J(),ae("div",{key:Me.id,class:be(["comment-item",j.value])},[N("img",{class:"comment-avatar avatar-img",src:Je(Me),alt:"avatar","data-mail":Me.mail||"",onError:Ct=>oe(Ct,Me.nick||"")},null,40,hf),N("div",pf,[N("div",{class:be(["comment-header",V.value])},[N("span",mf,[lt(Me.link)?(J(),ae("a",{key:0,href:lt(Me.link),target:"_blank",rel:"noopener noreferrer"},We(Me.nick||"匿名"),9,gf)):(J(),ae(It,{key:1},[dt(We(Me.nick||"匿名"),1)],64))])],2),N("div",{class:be(["comment-content",V.value])},[te(wi,{content:Me.content},null,8,["content"])],2),N("div",vf,[N("span",bf,We(it(Me.created_at)),1),N("span",yf,"回复 "+We(Gt(Me.id)),1)]),N("div",wf,[N("button",{class:"action-btn",onClick:Ct=>an(Me.id,Me.nick||"匿名")},"回复",8,Ef),w.value?(J(),ae("button",{key:0,class:"action-btn text-red-500",onClick:Ct=>rt(Me.id)},"删除",8,kf)):Le("",!0)]),(Xt=en.value[Me.id])!=null&&Xt.length?(J(),ae("div",Sf,[(J(!0),ae(It,null,Qt(Wt(Me.id),Ct=>(J(),ae("div",{key:Ct.id,class:be(["comment-item child",z.value])},[N("img",{class:"comment-avatar avatar-img",src:Je(Ct),alt:"avatar","data-mail":Ct.mail||"",onError:Ln=>oe(Ln,Ct.nick||"")},null,40,xf),N("div",_f,[N("div",{class:be(["comment-header",V.value])},[N("span",Cf,[lt(Ct.link)?(J(),ae("a",{key:0,href:lt(Ct.link),target:"_blank",rel:"noopener noreferrer"},We(Ct.nick||"匿名"),9,Tf)):(J(),ae(It,{key:1},[dt(We(Ct.nick||"匿名"),1)],64))])],2),N("div",{class:be(["comment-content",V.value])},[te(wi,{content:Ct.content},null,8,["content"])],2),N("div",Mf,[N("span",Af,We(it(Ct.created_at)),1)]),N("div",Lf,[N("button",{class:"action-btn",onClick:Ln=>an(Ct.id,Ct.nick||"匿名")},"回复",8,Df),w.value?(J(),ae("button",{key:0,class:"action-btn text-red-500",onClick:Ln=>rt(Ct.id)},"删除",8,Of)):Le("",!0)])])],2))),128))])):Le("",!0),Ge(Me.id)?(J(),ae("div",Pf,[N("button",{class:be(["text-xs px-2 py-1 rounded border",B.value]),onClick:Ct=>ut(Me.id)},"加载更多回复",10,Rf)])):Le("",!0)])],2)}),128))])):Le("",!0),ui.value?(J(),ae("div",If,[N("button",{class:be(["text-xs px-3 py-1 rounded border",B.value]),onClick:Hn},"加载更多评论",2)])):Le("",!0),sn.value.length?Le("",!0):(J(),ae("div",{key:2,class:be(["text-xs mb-4",I.value])},"暂无评论",2)),(e.showInput||h.value)&&_.value&&((nt=W.siteConfig)!=null&&nt.commentEmailEnabled)&&T.value?(J(),ae("div",{key:3,class:be(["text-xs mb-2",I.value])},"新评论或回复会发送通知邮件",2)):Le("",!0),(e.showInput||h.value)&&_.value&&T.value?(J(),ae("div",Hf,[N("div",Nf,[Pi(N("input",{"onUpdate:modelValue":Z[0]||(Z[0]=Me=>s.value=Me),placeholder:"昵称",class:be(F.value),onInput:we},null,34),[[$r,s.value]]),Pi(N("input",{"onUpdate:modelValue":Z[1]||(Z[1]=Me=>m.value=Me),placeholder:"邮箱",class:be(le.value)},null,2),[[$r,m.value]]),Pi(N("input",{"onUpdate:modelValue":Z[2]||(Z[2]=Me=>u.value=Me),placeholder:"网址（可选）",class:be(de.value)},null,2),[[$r,u.value]])]),N("div",jf,[N("button",{class:be(["text-xs px-2 py-1 rounded border",B.value]),onClick:Z[3]||(Z[3]=Me=>An("bold"))},"加粗",2),N("button",{class:be(["text-xs px-2 py-1 rounded border",B.value]),onClick:Z[4]||(Z[4]=Me=>An("italic"))},"斜体",2),N("button",{class:be(["text-xs px-2 py-1 rounded border",B.value]),onClick:Z[5]||(Z[5]=Me=>An("link"))},"链接",2),N("button",{class:be(["text-xs px-2 py-1 rounded border",B.value]),onClick:Z[6]||(Z[6]=Me=>An("image"))},"图片",2),N("div",$f,[N("button",{class:be(["text-xs px-2 py-1 rounded border",B.value]),onClick:gt},"表情",2),ge.value?(J(),ae("div",{key:0,class:be(["absolute z-10 mt-1 p-2 rounded border bg-white shadow",B.value])},[N("div",Bf,[(J(),ae(It,null,Qt(mt,Me=>N("button",{key:Me,class:"px-2 py-1 text-sm",onClick:Rt=>wn(Me)},We(Me),9,Uf)),64))])],2)):Le("",!0)])]),N("div",zf,[re.value&&!Ke.value?(J(),ae("img",{key:0,class:"input-avatar avatar-img",src:Ae.value,"data-mail":m.value,alt:"avatar",onError:X},null,40,Ff)):Le("",!0),N("div",Vf,[Pi(N("textarea",{ref_key:"taRef",ref:S,"onUpdate:modelValue":Z[7]||(Z[7]=Me=>v.value=Me),class:be(Re.value),rows:"4",placeholder:"说说你的想法",onInput:P,onKeydown:ne,onBlur:Mt},null,34),[[$r,v.value]]),N("div",qf,[v.value.trim()?(J(),ae("button",{key:0,class:be(["cancel-btn",Pe.value]),onClick:Fe},"清除",2)):Le("",!0),N("button",{class:be(["cancel-btn",Pe.value]),onClick:et},"取消",2),N("button",{class:be(["submit-btn",ie.value]),disabled:E.value||!v.value.trim(),onClick:Oe},"提交",10,Wf)])])])])):e.showInput&&!_.value?(J(),ae("div",{key:5,class:be(["text-xs text-center mt-4 mb-2",I.value])},"评论功能未开启",2)):e.showInput&&_.value&&!T.value?(J(),ae("div",{key:6,class:be(["text-xs text-center mt-4 mb-2",I.value])},"请登录后评论",2)):Le("",!0)],2),te(Ue,{modelValue:ee.value,"onUpdate:modelValue":Z[9]||(Z[9]=Me=>ee.value=Me),ui:{width:"sm:max-w-md"}},{default:Te(()=>[te(ze,null,{header:Te(()=>[N("div",Yf,[Z[10]||(Z[10]=N("h3",{class:"text-lg font-medium"},"再次确认删除",-1)),te(xe,{color:"gray",variant:"ghost",icon:"i-mdi-close",class:"-my-1",onClick:Ve})])]),footer:Te(()=>[N("div",Qf,[te(xe,{color:"gray",variant:"outline",onClick:Ve},{default:Te(()=>Z[13]||(Z[13]=[dt("取消")])),_:1}),te(xe,{color:"red",disabled:!He.value,onClick:Kt},{default:Te(()=>Z[14]||(Z[14]=[dt("确认删除")])),_:1},8,["disabled"])])]),default:Te(()=>{var Me,Rt;return[N("div",Kf,[Z[12]||(Z[12]=N("div",{class:"text-sm"},"此操作不可恢复，确认删除该评论？",-1)),N("div",Gf,"评论ID："+We(((Me=ve.value)==null?void 0:Me.id)||b.value),1),N("div",Xf,"昵称："+We(((Rt=ve.value)==null?void 0:Rt.nick)||"匿名"),1),N("div",Zf,"内容片段："+We(st.value),1),N("label",Jf,[Pi(N("input",{type:"checkbox","onUpdate:modelValue":Z[8]||(Z[8]=Xt=>He.value=Xt)},null,512),[[kc,He.value]]),Z[11]||(Z[11]=dt(" 我已知晓此操作不可恢复 "))])])]}),_:1})]),_:1},8,["modelValue"])])}}}),qs=Tn(eh,[["__scopeId","data-v-2e994d72"]]),th={class:"min-h-screen flex flex-col"},nh={key:0,class:"text-center text-gray-500 py-8"},ih={key:0,class:"flex justify-between items-center mb-4 p-4 rounded-lg"},rh={class:"text-gray-400"},ah={class:"my-4"},oh={key:0,class:"text-center text-gray-500 py-8"},sh={class:"p-0"},lh=["data-msg-id"],ch={class:"flex items-center gap-2 mb-2 author-row"},uh=["src","onError"],dh={class:"min-w-0"},fh={class:"text-sm font-semibold leading-tight"},hh={class:"text-xs opacity-70"},ph={key:0,class:"ml-auto text-xs opacity-80"},mh=["href","data-fancybox"],gh=["src","fetchpriority"],vh={key:1,class:"border-t border-gray-600 my-4"},bh=["onClick"],yh={class:"message-socialbar"},wh=["onClick"],Eh={class:"ml-1 text-xs opacity-80"},kh=["onClick"],Sh={class:"ml-1 text-xs opacity-80"},xh={class:"toolbox-anchor"},_h={class:"tool-icons"},Ch={key:0,class:"tool-icon"},Th=["onClick","title"],Mh=["onClick"],Ah=["onClick"],Lh=["onClick"],Dh=["onClick"],Oh=["id"],Ph=["id"],Rh={key:1,class:"flex justify-center items-center space-x-4 w-full my-4 flex-wrap md:flex-nowrap"},Ih={class:"flex justify-center items-center space-x-4 w-full md:w-auto"},Hh={key:2,class:"ml-2 text-orange-400"},Nh={class:"flex items-center justify-center space-x-2 w-full md:w-auto mt-3 md:mt-0"},jh={class:"text-gray-500 text-shadow-sm text-sm"},$h={key:2,class:"text-center text-gray-500 mt-4"},Bh={key:1,class:"text-center text-xs text-gray-400 py-4"},Uh=["innerHTML"],zh={class:"flex justify-between items-center"},Fh={class:"flex flex-col space-y-4"},Vh={class:"border-t border-gray-200 my-2 pt-2"},qh={class:"p-4 rounded-lg overflow-auto max-h-[300px] bg-[rgba(36,43,50,0.95)]"},Wh={class:"text-white"},Yh={class:"flex justify-end space-x-2"},Kh=nn({__name:"MessageList",props:{siteConfig:{type:Object,required:!0},targetMessageId:{type:String,default:null},wide:{type:Boolean,default:!1}},setup(p,{expose:e}){const r=$i("contentTheme",G(typeof window<"u"&&localStorage.getItem("contentTheme")||"dark")),s=he(()=>r.value==="dark"?"bg-[rgba(36,43,50,0.95)] text-white":"bg-white text-black"),l=he(()=>r.value==="dark"?"text-white":"text-black"),d=he(()=>r.value==="dark"?"from-[rgba(36,43,50,1)] via-[rgba(36,43,50,0.8)] to-transparent":"from-[rgba(255,255,255,1)] via-[rgba(255,255,255,0.8)] to-transparent"),m=q=>{var Fe,et,Pt,ge;const P=String(((Fe=Gn().user)==null?void 0:Fe.username)||"").trim(),ne=String(((et=Gn().user)==null?void 0:et.avatar_url)||((Pt=Gn().user)==null?void 0:Pt.AvatarURL)||"").trim(),ie=String(((ge=y.siteConfig)==null?void 0:ge.avatarURL)||"").trim(),Pe=mt=>mt?/^https?:\/\//i.test(mt)?mt:`${I}${mt}`:"";return P&&String((q==null?void 0:q.username)||"").trim()===P&&ne?Pe(ne):Pe(ie)||`https://api.dicebear.com/7.x/initials/svg?seed=${encodeURIComponent(String((q==null?void 0:q.username)||"匿名"))}&backgroundType=gradient&radius=50&scale=100&size=64`},u=(q,P)=>{const ne=q.target,ie=`https://i.pravatar.cc/64?u=${encodeURIComponent(P)}`;ne&&(ne.src=ie)},v=he(()=>r.value==="dark"?"bg-[rgba(36,43,50,0.95)] text-white hover:text-white border-none shadow-sm rounded-full":"bg-white text-black hover:text-black border border-gray-300 shadow-sm rounded-full"),S=he(()=>r.value==="dark"?"bg-[rgba(36,43,50,0.75)] text-white hover:text-white hover:bg-[rgba(36,43,50,0.85)] active:bg-[rgba(36,43,50,0.9)] focus:bg-[rgba(36,43,50,0.85)] border border-white/70":"bg-[rgba(24,28,32,0.6)] text-white hover:text-white hover:bg-[rgba(24,28,32,0.7)] active:bg-[rgba(24,28,32,0.75)] focus:bg-[rgba(24,28,32,0.7)] border border-white/70"),E=G(null),h=q=>{E.value=E.value===q?null:q},f=q=>{const P=q.target;if(!P){E.value=null;return}const ne=!!P.closest(".message-toolbox"),ie=!!P.closest(".tool-open-btn");!ne&&!ie&&(E.value=null)};Ht(()=>{window.addEventListener("scroll",()=>{E.value=null}),document.addEventListener("click",f,!0)}),Ni(()=>{document.removeEventListener("click",f,!0)});const g=he(()=>r.value==="dark"?"toolbox-dark":"toolbox-light"),b=G({}),k=G({}),w=G({}),_=async q=>{var P,ne;try{const ie=await fetch(`${I}/messages/${q}/like/toggle`,{method:"POST",credentials:"include",headers:{Accept:"application/json"}});if(!ie.ok)throw new Error("点赞失败");const Pe=await ie.json(),Fe=((P=Pe==null?void 0:Pe.data)==null?void 0:P.like_count)??(b.value[q]||0),et=!!((ne=Pe==null?void 0:Pe.data)!=null&&ne.liked);b.value[q]=Fe,k.value[q]=et}catch{Ze().add({title:"点赞失败",color:"red",timeout:2e3})}},C=G(""),T=he(()=>Math.ceil(F.total/15)),M=async()=>{const q=parseInt(C.value);if(!q||q<1||q>T.value||F.loading){Ze().add({title:"页码无效",description:`请输入 1-${T.value} 之间的数字`,color:"orange",timeout:2e3});return}try{const P=document.querySelector(".content-wrapper"),ne=P?P.scrollTop:window.scrollY,ie=await F.getMessages({page:q,pageSize:15});if(!ie)throw new Error("跳转页面失败");const Pe=ie.items.filter(Fe=>!Fe.pinned);F.messages=[...He.value,...Pe],F.page=ie.page||q,C.value="",await yt(),P?P.scrollTo({top:ne,behavior:"instant"}):window.scrollTo({top:ne,behavior:"instant"})}catch(P){console.error("跳转页面失败:",P),Ze().add({title:"跳转失败",color:"red",timeout:2e3})}},y=p,O=he(()=>y.wide?"flex-grow w-full px-1 sm:px-2":"flex-grow mx-auto w-full sm:max-w-4xl px-1 sm:px-2"),B=he(()=>y.wide?"":"mx-auto sm:max-w-4xl"),V=he(()=>!1);Et(()=>y.targetMessageId,async q=>{if(!q)return;await yt();const P=document.querySelector(`.content-container[data-msg-id="${q}"]`);P&&(P.scrollIntoView({behavior:"smooth",block:"center"}),P.classList.add("highlight-message"),setTimeout(()=>{P.classList.remove("highlight-message")},2e3))},{immediate:!0});const I=gn().public.baseApi||"/api",j=G(!0),z=async()=>{try{const q=await fetch(`${I}/status`,{credentials:"include"});j.value=!!q&&q.ok}catch{j.value=!1}};_s();const F=xs(),le=G(null),de=G({}),Re=G({}),Be=he(()=>{var P;const q=(P=y.siteConfig)==null?void 0:P.commentEnabled;return q===!0||q==="true"}),Ce=he(()=>!0),De=G(null),Ie=q=>{if(!q)return!1;if(De.value&&q.id===De.value)return!0;const P=String(q.content||"").toLowerCase();return/#guestbook|#留言|留言板/.test(P)},Je=async()=>{var q;try{const P=await fetch(`${I}/guestbook/message`,{credentials:"include",headers:{Accept:"application/json"}});if(P.ok){const ne=await P.json(),ie=(q=ne==null?void 0:ne.data)==null?void 0:q.id;ie&&(De.value=Number(ie))}}catch{}},tt=q=>(F.messages||[]).find(P=>P.id===q),U=Gn(),oe=he(()=>U.isLogin),re=async q=>{try{const P=encodeURIComponent(q.trim()),ne=await fetch(`${I}/messages/tags/${P}`,{credentials:"include",headers:{Accept:"application/json"}});if(!ne.ok)throw new Error(`HTTP error! status: ${ne.status}`);const ie=await ne.json();if(ie.code===1&&Array.isArray(ie.data))Nt.value=!0,Mt.value=ie.data,await yt(),lt(),X();else throw new Error(ie.msg||"获取标签内容失败")}catch(P){console.error("获取标签消息失败:",P),Ze().add({title:"获取标签消息失败",description:P.message||"服务器错误，请稍后重试",color:"red",timeout:3e3})}},Ae=async()=>{Mt.value=[],Nt.value=!1,await F.getMessages({page:1,pageSize:15}),await yt(),lt(),X()},Ke=async q=>{if(confirm("确定要删除这条消息吗？"))try{await F.deleteMessage(q),F.messages=F.messages.filter(ne=>ne.id!==q),Ze().add({title:"删除成功",color:"green",timeout:2e3})}catch(ne){console.error("删除失败:",ne),Ze().add({title:"删除失败",color:"red",timeout:2e3})}},X=()=>{if(window.Fancybox){window.Fancybox.destroy();const q={Carousel:{infinite:!1},Toolbar:{display:[{id:"prev",position:"center"},{id:"counter",position:"center"},{id:"next",position:"center"},"zoom","slideshow","fullscreen","close"]},Image:{zoom:!0,click:!0,wheel:"slide"}};document.querySelectorAll(".markdown-preview img").forEach(ne=>{const ie=ne.getAttribute("src")||"",Pe=/^https?:\/\//i.test(ie),Fe=ne.parentElement;if(Fe&&Fe.tagName==="A"&&Fe.hasAttribute("data-fancybox")){Pe||Fe.replaceWith(ne);return}if(Pe){const et=document.createElement("a");et.href=ie,et.setAttribute("data-fancybox","uploaded-image"),et.style.display="block",ne.parentNode.insertBefore(et,ne),et.appendChild(ne)}else Fe&&Fe.tagName==="A"&&Fe.hasAttribute("data-fancybox")&&Fe.replaceWith(ne)}),window.Fancybox.bind("[data-fancybox]",q)}},we=async q=>{var ie,Pe;const P=tt(q);if(Ie(P))return;if(!!(Re.value[q]||le.value===q)){Re.value[q]=!1,le.value===q&&(le.value=null);return}if(le.value=q,await yt(),de.value[q]=(de.value[q]||0)+1,Re.value[q]=!0,(((ie=y.siteConfig)==null?void 0:ie.commentSystem)||"waline")==="builtin"){window.dispatchEvent(new Event(`refresh-comments-${q}`));const Fe=document.querySelector(`.content-container[data-msg-id="${q}"] .builtin-comments`);if(Fe){Fe.scrollIntoView({behavior:"smooth",block:"center"});const et=Fe.querySelector("textarea");(Pe=et==null?void 0:et.focus)==null||Pe.call(et)}return}if(V.value){if(await ht(),!window.Waline)return;document.querySelector(`#waline-${q}`)?window.Waline.init({el:`#waline-${q}`,serverURL:y.siteConfig.walineServerURL,path:`messages/${q}`,reaction:!1,meta:["nick","mail","link"],requiredMeta:["mail","nick"],pageview:!0,search:!1,wordLimit:200,pageSize:5,avatar:"monsterid",emoji:["https://unpkg.com/@waline/emojis@1.2.0/tieba"],imageUploader:!1,copyright:!1,dark:'html[class="dark"]'}):console.error(`评论容器 #waline-${q} 未找到`)}},se=(q,P)=>{if(P&&P.empty===!0){we(q);return}le.value===q&&(le.value=null),de.value[q]=(de.value[q]||0)+1},ee=q=>{if(!oe.value)return!1;const P=U.user;if(!P)return!1;const ne=!!(P.IsAdmin||P.is_admin),ie=(P.ID||P.userid)===q.user_id;return ne||ie},He=G([]),ve=async q=>{try{const P=!q.pinned;await F.setPinned(q.id,P)&&(P?He.value.some(ie=>ie.id===q.id)||(He.value=[q,...He.value]):He.value=He.value.filter(ie=>ie.id!==q.id),Ze().add({title:P?"已置顶":"已取消置顶",color:"green",timeout:1500}))}catch{Ze().add({title:"操作失败",color:"red",timeout:2e3})}},st=q=>{const P=new Date(q),ie=new Date().getTime()-P.getTime(),Pe=Math.floor(ie/(1e3*60*60*24)),Fe=Math.floor(ie/(1e3*60*60)),et=Math.floor(ie/(1e3*60));return Math.floor(ie/1e3)<60?"刚刚":et<60?`${et}分钟前`:Fe<24?`${Fe}小时前`:Pe<3?`${Pe}天前`:P.toLocaleString()},Ve=G({}),Qe=G({}),Oe=G({}),it=q=>{Ve.value[q]=!Ve.value[q]},lt=()=>{yt(()=>{(Nt.value?Mt.value:F.messages).forEach(P=>{const ne=document.querySelector(`.content-container[data-msg-id="${P.id}"] .overflow-y-hidden`);if(!ne)return;const ie=!!document.querySelector(`.content-container[data-msg-id="${P.id}"] .image-grid`);if(Oe.value[P.id]=ie,ie){Qe.value[P.id]=!1,Ve.value[P.id]=!0;return}ne.scrollHeight>700?(Qe.value[P.id]=!0,Ve.value[P.id]===void 0&&(Ve.value[P.id]=!1)):Qe.value[P.id]=!1})})};Et(()=>F.messages,()=>{ft.hash.includes("/messages/")||yt(()=>{requestAnimationFrame(()=>{lt(),X()})})},{deep:!0});const ft=cs(),ht=async()=>{if(V.value&&!window.Waline){const q=document.createElement("link");q.rel="stylesheet",q.href="https://unpkg.com/@waline/client@v2/dist/waline.css",document.head.appendChild(q),await new Promise((P,ne)=>{const ie=document.createElement("script");ie.src="https://unpkg.com/@waline/client@v2/dist/waline.js",ie.crossOrigin="anonymous",ie.onload=P,ie.onerror=ne,document.head.appendChild(ie)})}};Ht(async()=>{try{await z(),await Je();const q=ft.hash.split("/messages/").pop();if(await ht(),q){const P=await fetch(`${I}/messages/${q}`,{credentials:"include",headers:{Accept:"application/json"}});if(!P.ok)throw new Error("消息加载失败");const ne=await P.json();if(ne.code===1&&ne.data){const ie=ne.data;Ie(ie)?F.messages=[]:F.messages=[ie],F.hasMore=!1,F.page=1,await yt();const Pe=document.querySelector(`.content-container[data-msg-id="${q}"]`);Pe&&Pe.scrollIntoView({behavior:"instant",block:"start"})}else throw new Error("消息不存在")}else if(!ft.hash.includes("/messages/")){const P=await fetch(`${I}/messages/page`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({page:1,pageSize:15})});if(P.ok){const ne=await P.json();if(ne.code===1&&ne.data){const ie=(ne.data.items||[]).filter(Pt=>!Ie(Pt));F.messages=ie;const Fe=(ne.data.total||0)-(De.value?1:0);F.total=Math.max(0,Fe);const et=Math.max(1,Math.ceil((F.total||0)/15));F.page=1,F.hasMore=F.page<et}}}await yt(),lt(),X();try{const P=(F.messages||[]).filter(ne=>!Ie(ne)).map(async ne=>{try{let ie=null;const Pe=await fetch(`${I}/messages/${ne.id}/comments`,{credentials:"include",headers:{Accept:"application/json"}});if(Pe&&Pe.ok)ie=await Pe.json();else{const et=await fetch(`http://localhost:1315/api/messages/${ne.id}/comments`,{credentials:"include",headers:{Accept:"application/json"}});et&&et.ok&&(ie=await et.json())}const Fe=ie&&Array.isArray(ie.data)?ie.data.length:0;w.value[ne.id]=Fe,Ce.value&&Fe>0&&(Re.value[ne.id]=!0)}catch{}});await Promise.allSettled(P),await yt()}catch{}}catch(q){console.error("初始化失败:",q),q instanceof Error&&Ze().add({title:"加载失败",description:q.message||"请刷新重试",color:"red",timeout:2e3})}}),Et(()=>ft.hash,async q=>{const P=q.split("/messages/").pop();if(!P){if(!ft.hash.includes("/messages/")){const ne=await fetch(`${I}/messages/page`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({page:1,pageSize:15})});if(ne.ok){const ie=await ne.json();if(ie.code===1&&ie.data){const Pe=(ie.data.items||[]).filter(ge=>!Ie(ge));F.messages=Pe;const et=(ie.data.total||0)-(De.value?1:0);F.total=Math.max(0,et);const Pt=Math.max(1,Math.ceil((F.total||0)/15));F.page=1,F.hasMore=F.page<Pt,Re.value={};try{const ge=(F.messages||[]).filter(mt=>!Ie(mt)).map(async mt=>{try{const gt=await fetch(`${I}/messages/${mt.id}/comments`,{credentials:"include",headers:{Accept:"application/json"}});if(gt.ok){const _t=await gt.json(),wn=Array.isArray(_t.data)?_t.data.length:0;w.value[mt.id]=wn,Ce.value&&wn>0&&(Re.value[mt.id]=!0)}}catch{}});await Promise.allSettled(ge)}catch{}}}}return}try{const ne=await fetch(`${I}/messages/${P}`,{credentials:"include",headers:{Accept:"application/json"}});if(!ne.ok)throw new Error("消息加载失败");const ie=await ne.json();if(ie.code===1&&ie.data){F.messages=Ie(ie.data)?[]:[ie.data],F.hasMore=!1,F.page=1,await yt();const Pe=document.querySelector(`.content-container[data-msg-id="${P}"]`);Pe&&Pe.scrollIntoView({behavior:"instant",block:"start"})}}catch(ne){console.error("加载消息失败:",ne),Ze().add({title:"加载失败",color:"red",timeout:2e3})}},{immediate:!0});const Dt=G(!1),Mn=async()=>{if(!(Dt.value||F.page<=1)){Dt.value=!0;try{const q=document.querySelector(".content-wrapper"),P=q?q.scrollTop:window.scrollY,ne=F.page-1,ie=await F.getMessages({page:ne,pageSize:15});if(ie&&Array.isArray(ie.items)){const Pe=ie.items.filter(ge=>!ge.pinned&&!Ie(ge));F.messages=[...He.value,...Pe];const et=(ie.total||F.total||0)-(De.value?1:0);F.total=Math.max(0,et),F.page=ie.page||ne;const Pt=Math.max(1,Math.ceil((F.total||0)/15));F.hasMore=F.page<Pt}else F.page=ne;await yt(),q?q.scrollTo({top:P,behavior:"instant"}):window.scrollTo({top:P,behavior:"instant"})}catch{Ze().add({title:"加载失败",color:"red",timeout:2e3})}finally{Dt.value=!1}}},rn=async()=>{if(!(Dt.value||!F.hasMore)){Dt.value=!0;try{const q=document.querySelector(".content-wrapper"),P=q?q.scrollTop:window.scrollY,ne=F.page+1,ie=await F.getMessages({page:ne,pageSize:15});if(ie&&Array.isArray(ie.items)){const Pe=ie.items.filter(ge=>!ge.pinned&&!Ie(ge));F.messages=[...He.value,...Pe];const et=(ie.total||F.total||0)-(De.value?1:0);F.total=Math.max(0,et),F.page=ie.page||ne;const Pt=Math.max(1,Math.ceil((F.total||0)/15));F.hasMore=F.page<Pt}else F.page=ne;await yt(),q?q.scrollTo({top:P,behavior:"instant"}):window.scrollTo({top:P,behavior:"instant"})}catch{Ze().add({title:"加载失败",color:"red",timeout:2e3})}finally{Dt.value=!1}}};Et(()=>U.isLogin,q=>{q&&F.getMessages({page:1,pageSize:15})}),Et(()=>F.messages,async()=>{try{if(F.page===1){const P=(F.messages||[]).filter(ne=>ne.pinned&&!Ie(ne)).filter((ne,ie,Pe)=>Pe.findIndex(Fe=>Fe.id===ne.id)===ie);He.value=P}try{const P=(F.messages||[]).filter(ne=>!Ie(ne)).map(async ne=>{try{const ie=await fetch(`${I}/messages/${ne.id}/comments`,{credentials:"include",headers:{Accept:"application/json"}});if(ie.ok){const Pe=await ie.json(),Fe=Array.isArray(Pe.data)?Pe.data.length:0;w.value[ne.id]=Fe}}catch{}});await Promise.allSettled(P)}catch{}await yt(),lt(),X()}catch(q){console.error("更新视图失败:",q)}},{deep:!0}),Ni(()=>{window.Fancybox&&window.Fancybox.destroy()});const an=async q=>{try{await navigator.clipboard.writeText(q),Ze().add({title:"复制成功",color:"green",timeout:2e3})}catch(P){console.error("复制失败:",P),Ze().add({title:"复制失败",color:"red",timeout:2e3})}},rt=G(!1),Kt=G(""),dn=G(null),on=G(!1),fn=q=>{if(dn.value=q.id,Kt.value=q.content,q.image_url){const P=`

<!-- 附件图片(编辑时可删除) -->
![附件图片](${I}${q.image_url})
<!-- 附件图片结束 -->`;Kt.value+=P}rt.value=!0},yn=async()=>{if(dn.value){on.value=!0;try{const q=F.messages.find(Pe=>Pe.id===dn.value);if(!q)return;let P=Kt.value;if(P=P.replace(/\n*<!-- 附件图片\(编辑时可删除\) -->\n!\[附件图片\]\(.*?\)\n<!-- 附件图片结束 -->\n*/g,""),P===q.content){Ze().add({title:"内容未修改",description:"请修改内容后再保存",color:"orange",timeout:2e3}),on.value=!1;return}const ne=await fetch(`${I}/messages/${dn.value}`,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({content:P,image_url:q.image_url})});if(!ne.ok)throw new Error(`HTTP error! status: ${ne.status}`);const ie=await ne.json();if(ie.code===1){const Pe=F.messages.findIndex(Fe=>Fe.id===dn.value);Pe!==-1&&(F.messages[Pe]={...F.messages[Pe],content:Kt.value,image_url:q.image_url}),rt.value=!1,Ze().add({title:"更新成功",color:"green",timeout:2e3})}else throw new Error(ie.msg||"保存失败")}catch(q){console.error("更新消息失败:",q),Ze().add({title:"更新失败",color:"red",timeout:2e3})}finally{on.value=!1}}},un=async q=>{var P,ne;try{const ie=document.querySelector(`.content-container[data-msg-id="${q}"]`);if(!ie)return;const Pe=(ne=(P=ie.querySelector(".markdown-preview"))==null?void 0:P.textContent)==null?void 0:ne.trim(),Fe=ie.querySelector("img"),et=ie.querySelector("video"),Pt=ie.querySelector("audio");if(!Pe&&!Fe&&et||!Pe&&!Fe&&Pt){Ze().add({title:"此内容不可生成卡片",color:"orange",timeout:2e3});return}const ge=setTimeout(()=>{Ze().add({title:"生成超时",description:"卡片生成时间过长，请稍后重试",color:"red",timeout:3e3})},1e4),mt=Ve.value[q];Ve.value[q]=!0,await yt();const gt=document.createElement("div");gt.style.cssText=`
  padding: 16px;
  background: transparent;
  border-radius: 12px;
  width: ${Fe?"640px":"480px"};
  position: absolute;
  left: -9999px;
  top: 0;
  z-index: -1;
  overflow: visible;
  min-height: fit-content;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
  border: none;
`,document.body.appendChild(gt);const _t=ie.cloneNode(!0),wn=window.getComputedStyle(ie),An=wn.backgroundColor&&wn.backgroundColor!=="rgba(0, 0, 0, 0)"?wn.backgroundColor:"#ffffff",vt=wn.color||"#333";_t.querySelectorAll('.text-center.mt-2, .bg-gradient-to-t, .expand-toggle-btn, .message-socialbar, .message-toolbox, .toolbox-anchor, .tool-open-btn, .builtin-comments, [id^="comment-container-"], [id^="waline-"]').forEach(Ge=>Ge.remove()),_t.querySelectorAll(".i-mdi-pin, .i-mdi-pin-outline").forEach(Ge=>{const ut=Ge.parentElement;ut&&ut.classList.contains("opacity-80")?ut.remove():Ge.remove()}),_t.querySelectorAll(".author-row .ml-auto").forEach(Ge=>Ge.remove()),_t.style.cssText=`
      max-height: none;
      overflow: visible;
      padding: 0;
      margin: 0;
      background: ${An};
      border-radius: 12px;
    `;const Bt=_t.querySelector(".overflow-y-hidden");Bt&&(Bt.className="",Bt.style.cssText=`
        overflow: visible;
        max-height: none !important;
        height: auto !important;
        padding: 4px 12px;
        line-height: 1.6;
        margin-top: 0;
        margin-bottom: 0;
        white-space: pre-wrap;
        background: ${An};
        border-radius: 12px;
        font-size: 14px;
        color: ${vt};
      `);const en=Array.from(_t.children).find(Ge=>Ge.tagName==="IMG");en&&(en.style.margin="1px 0",en.style.display="block"),_t.querySelectorAll("img").forEach(Ge=>{Ge.style.margin="1px 0",Ge.style.display="block"});const sn=_t.querySelector(".border-t");sn&&(sn.style.margin="1px 0");const ln=_t.querySelector(".markdown-preview");if(ln){ln.style.marginTop="1px";const Ge=ln.firstElementChild;Ge&&(Ge.style.marginTop="1px"),ln.querySelectorAll("p, h1, h2, h3, h4, h5, h6").forEach(ut=>{ut.style.marginTop=ut.style.marginTop||"2px"})}_t.querySelectorAll("video, audio, iframe").forEach(Ge=>{var Gt;const ut=document.createElement("div");ut.style.cssText=`
        padding: 15px;
        background: rgba(251, 146, 60, 0.1);
        border: 1px solid rgba(251, 146, 60, 0.3);
        border-radius: 8px;
        color: #fb923c;
        margin: 15px 0;
        word-break: break-all;
      `,Ge instanceof HTMLVideoElement?ut.innerHTML=`🎬 视频链接：${Ge.src||"未知链接"}`:Ge instanceof HTMLAudioElement?ut.innerHTML=`🎵 音频链接：${Ge.src||"未知链接"}`:Ge instanceof HTMLIFrameElement&&(ut.innerHTML=`🔗 嵌入内容链接：${Ge.src||"未知链接"}`),(Gt=Ge.parentNode)==null||Gt.replaceChild(ut,Ge)}),await(async()=>{const Ge=_t.querySelectorAll("img");await Promise.all(Array.from(Ge).map(async ut=>new Promise(Gt=>{const W=ut.src;ut.crossOrigin="anonymous",W.startsWith("/")?(ut.src=`${I}${W}`,fetch(ut.src,{credentials:"include"}).then(Z=>Z.blob()).then(Z=>{ut.src=URL.createObjectURL(Z),Gt()}).catch(()=>{var Z;console.error("图片加载失败:",W),(Z=ut.parentElement)==null||Z.removeChild(ut),Gt()})):ut.complete?Gt():(ut.onload=()=>Gt(),ut.onerror=()=>{var Z;console.error("图片加载失败:",W),(Z=ut.parentElement)==null||Z.removeChild(ut),Gt()})})))})(),gt.appendChild(_t);const Hn=document.createElement("div");Hn.style.cssText=`
    margin-top: 12px;
    padding-top: 12px;
    text-align: center;
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    background: transparent;
  `,Hn.innerHTML=`
    <div style="color: #fb923c; font-size: 13px; margin-bottom: 4px; font-weight: 500;">
      ${y.siteConfig.cardFooterTitle}
    </div>
    <a href="https://note.noisework.cn" 
       target="_blank" 
       rel="noopener noreferrer" 
       style="color: rgba(255,255,255,0.5); text-decoration: none;">
      ${y.siteConfig.cardFooterSubtitle}
    </a>
  `,gt.appendChild(Hn),await yt();const zt=await html2canvas(gt,{backgroundColor:An,scale:2,useCORS:!0,allowTaint:!0,logging:!1,width:gt.offsetWidth,height:gt.scrollHeight,borderRadius:"16px",onclone:Ge=>{const ut=Ge.querySelector(".content-container");ut&&(ut.style.cssText=`
            overflow: visible !important;
            max-height: none !important;
            height: auto !important;
            padding: 0;
            min-height: ${(Bt==null?void 0:Bt.scrollHeight)||0}px;
            background: ${An};
            border-radius: 12px;
          `)}});clearTimeout(ge);const Wt=document.createElement("a");Wt.download=`message-${q}.png`,Wt.href=zt.toDataURL("image/png"),Wt.click(),document.body.removeChild(gt),Ve.value[q]=mt,Ze().add({title:"下载成功",color:"green",timeout:2e3})}catch(ie){console.error("下载失败:",ie),Ze().add({title:"下载失败",color:"red",timeout:2e3})}},Nt=G(!1),Mt=G([]),ei=async q=>{var P;try{const ne=Nt.value?null:window.scrollY;if(console.debug("API返回的原始数据:",q),!q)throw new Error("API返回数据为空");let ie=[],Pe=0;if(q.code===1?Array.isArray(q.data)?ie=q.data:(P=q.data)!=null&&P.items&&(ie=q.data.items):Array.isArray(q)&&(ie=q),!Array.isArray(ie))throw new Error("无效的数据格式");ie=ie.filter(Fe=>!Ie(Fe)),Pe=ie.length,Nt.value=!0,Mt.value=ie,Pe===0?Ze().add({title:"未找到相关内容",color:"orange",timeout:2e3}):Ze().add({title:`找到 ${Pe} 条结果`,color:"green",timeout:2e3}),ne!==null&&window.scrollTo({top:0,behavior:"smooth"}),await yt(),lt(),X()}catch(ne){console.error("处理搜索结果时出错:",ne),Ze().add({title:"搜索失败",description:ne.message||"处理搜索结果时发生错误",color:"red",timeout:2e3}),$t()}},$t=()=>{Mt.value=[],Nt.value=!1,console.log("重置搜索 - searchResults:",Mt.value),console.log("重置搜索 - isSearchMode:",Nt.value),yt(()=>{lt(),X()})},Ot=he(()=>{if(Nt.value&&Array.isArray(Mt.value))return(Mt.value||[]).filter(ne=>!Ie(ne));const q=(F.messages||[]).filter(ne=>!Ie(ne));if(!He.value.length)return q;const P=q.filter(ne=>!He.value.some(ie=>ie.id===ne.id));return[...He.value,...P]});e({handleSearchResult:ei}),Et(Mt,q=>{console.log("searchResults变化:",q),yt(()=>{lt(),X()})},{deep:!0,immediate:!0}),Et(Nt,q=>{console.log("isSearchMode变化:",q),yt(()=>{lt(),X()})});const jt=q=>{try{const P=(q==null?void 0:q.detail)||{},ne=Number((P==null?void 0:P.messageId)||0),ie=Number((P==null?void 0:P.count)||0);ne&&(w.value[ne]=ie)}catch{}};return Ht(()=>{try{window.addEventListener("comment-count-updated",jt)}catch{}}),Ni(()=>{try{window.removeEventListener("comment-count-updated",jt)}catch{}}),he(()=>({cardFooterTitle:y.siteConfig.cardFooterTitle,cardFooterSubtitle:y.siteConfig.cardFooterSubtitle,pageFooterHTML:y.siteConfig.pageFooterHTML,walineServerURL:y.siteConfig.walineServerURL})),(q,P)=>{const ne=ci,ie=Mr,Pe=ua,Fe=Mc,et=ca,Pt=da;return J(),ae(It,null,[N("div",th,[Se(Ot).length?Le("",!0):(J(),ae("div",nh,[te(ne,{name:"i-heroicons-inbox",class:"w-12 h-12 mx-auto mb-4"}),P[5]||(P[5]=N("p",null,"暂无消息内容",-1))])),N("div",{class:be(Se(O))},[Se(Nt)?(J(),ae("div",ih,[N("p",rh,"搜索结果 ("+We(Se(Mt).length)+" 条)",1),te(ie,{size:"sm",variant:"ghost",class:"text-gray-400 hover:text-orange-500",icon:"i-heroicons-arrow-left",onClick:Ae},{default:Te(()=>P[6]||(P[6]=[dt(" 返回完整列表 ")])),_:1})])):Le("",!0),N("div",ah,[Se(Nt)&&Se(Mt).length===0?(J(),ae("div",oh,[te(ne,{name:"i-heroicons-magnifying-glass",class:"w-12 h-12 mx-auto mb-4"}),P[7]||(P[7]=N("p",null,"未找到相关内容",-1))])):Le("",!0),(J(!0),ae(It,null,Qt(Se(Ot),ge=>{var mt;return J(),ae("div",{key:ge.id,class:"w-full h-auto overflow-hidden flex flex-col justify-between"},[N("div",sh,[ge.image_url||ge.content?(J(),ae("div",{key:0,class:be(["content-container",Se(B),Se(s)]),"data-msg-id":ge.id},[N("div",ch,[N("img",{src:m(ge),alt:"avatar",class:"avatar-img w-8 h-8 rounded-full object-cover",onError:gt=>u(gt,ge.username||"匿名")},null,40,uh),N("div",dh,[N("div",fh,We(ge.username||p.siteConfig.username||"匿名"),1),N("div",hh,We(st(ge.created_at)),1)]),ge.pinned?(J(),ae("div",ph,[te(ne,{name:"i-mdi-pin",class:"w-4 h-4"})])):Le("",!0)]),ge.image_url?(J(),ae("a",{key:0,href:`${Se(I)}${ge.image_url}`,"data-fancybox":`message-image-${ge.id}`,class:"block"},[N("img",{src:`${Se(I)}${ge.image_url}`,alt:"Image",class:"message-image-box",loading:"lazy",fetchpriority:q.index<3?"high":"low"},null,8,gh)],8,mh)):Le("",!0),ge.image_url&&ge.content?(J(),ae("div",vh)):Le("",!0),N("div",{class:be(["overflow-y-hidden relative",[{"max-h-[700px]":!Se(Ve)[ge.id]&&!Se(Oe)[ge.id]},Se(l)]])},[te(wi,{content:ge.content,enableGithubCard:((mt=p.siteConfig)==null?void 0:mt.enableGithubCard)===!0,onTagClick:re,onRendered:lt,"link-target":"_blank"},null,8,["content","enableGithubCard"]),Se(Qe)[ge.id]&&!Se(Ve)[ge.id]?(J(),ae("div",{key:0,class:be(["absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t",Se(d)]),style:{"z-index":"1"}},null,2)):Le("",!0)],2),Se(Qe)[ge.id]?(J(),ae("button",{key:2,class:be(["expand-toggle-btn absolute bottom-0 left-1/2 -translate-x-1/2 px-4 py-1.5 text-sm inline-flex items-center gap-1",Se(v)]),onClick:gt=>it(ge.id),"aria-label":"toggle-expand"},[dt(We(Se(Ve)[ge.id]?"收起全文":"展开全文")+" ",1),te(ne,{name:Se(Ve)[ge.id]?"i-heroicons-chevron-up":"i-heroicons-chevron-down",class:"w-4 h-4"},null,8,["name"])],10,bh)):Le("",!0),P[9]||(P[9]=N("div",{class:"border-t border-gray-300 dark:border-gray-700 my-3"},null,-1)),N("div",yh,[N("button",{class:"social-item",onClick:gt=>_(ge.id),title:"点赞"},[te(ne,{name:Se(k)[ge.id]?"i-mdi-heart":"i-mdi-heart-outline",class:be(["w-5 h-5",Se(k)[ge.id]?"text-red-500":""])},null,8,["name","class"]),N("span",Eh,We(Se(b)[ge.id]??(ge.like_count||0)),1)],8,wh),Ie(ge)?Le("",!0):(J(),ae("button",{key:0,class:"social-item",onClick:gt=>we(ge.id),title:"评论"},[te(ne,{name:"i-mdi-comment-outline",class:"w-5 h-5"}),N("span",Sh,We(Se(w)[ge.id]||0),1)],8,kh)),P[8]||(P[8]=N("div",{class:"flex-1"},null,-1)),N("div",xh,[te(ie,{size:"xs",color:"gray",variant:"ghost",ui:{base:"rounded-full"},class:"tool-open-btn",onClick:gt=>h(ge.id),title:"展开工具"},{default:Te(()=>[te(ne,{name:"i-heroicons-ellipsis-horizontal",class:"w-5 h-5"})]),_:2},1032,["onClick"]),Pi(N("div",{class:be(["message-toolbox overlay",Se(g)])},[N("div",_h,[ge.private?(J(),ae("div",Ch,[te(ne,{name:"i-mdi-lock-outline"})])):Le("",!0),ee(ge)?(J(),ae("div",{key:1,class:"tool-icon",onClick:gt=>ve(ge),title:ge.pinned?"取消置顶":"置顶内容"},[te(ne,{name:ge.pinned?"i-mdi-pin":"i-mdi-pin-outline"},null,8,["name"])],8,Th)):Le("",!0),Se(oe)?(J(),ae("div",{key:2,class:"tool-icon",onClick:gt=>fn(ge),title:"编辑"},[te(ne,{name:"i-mdi-pencil-outline"})],8,Mh)):Le("",!0),N("div",{class:"tool-icon",onClick:gt=>an(ge.content),title:"复制"},[te(ne,{name:"i-mdi-content-copy"})],8,Ah),N("div",{class:"tool-icon",onClick:gt=>un(ge.id),title:"下载卡片"},[te(ne,{name:"i-mdi-image-outline"})],8,Lh),Se(oe)?(J(),ae("div",{key:3,class:"tool-icon",onClick:gt=>Ke(ge.id),title:"删除"},[te(ne,{name:"i-mdi-trash-can-outline"})],8,Dh)):Le("",!0)])],2),[[us,Se(E)===ge.id]])])]),(Se(Re)[ge.id]||Se(le)===ge.id)&&Se(Be)&&!Ie(ge)?(J(),ae("div",{key:3,id:`comment-container-${ge.id}`,class:"mt-2",style:{position:"relative"}},[Se(Ce)&&Se(j)?(J(),Lt(qs,{key:Se(de)[ge.id]||0,"message-id":ge.id,"site-config":p.siteConfig,"show-input":Se(le)===ge.id,onCancel:gt=>se(ge.id,gt)},null,8,["message-id","site-config","show-input","onCancel"])):Se(V)&&Se(j)?(J(),ae("div",{key:1,id:`waline-${ge.id}`},null,8,Ph)):Le("",!0)],8,Oh)):Le("",!0)],10,lh)):Le("",!0)])])}),128))]),Se(Nt)?Le("",!0):(J(),ae("div",Rh,[N("div",Ih,[Se(F).page>1?(J(),Lt(ie,{key:0,color:"gray",variant:"ghost",size:"xs",class:be(["rounded-full px-4 py-1.5 shadow-lg hover:shadow-xl transition-all duration-300 backdrop-blur-sm",Se(S)]),onClick:Mn,disabled:Se(Dt)},{default:Te(()=>[te(ne,{name:"i-heroicons-arrow-left",class:"mr-1 w-4 h-4"}),P[10]||(P[10]=dt(" 上一页 "))]),_:1},8,["class","disabled"])):Le("",!0),Se(F).hasMore?(J(),Lt(ie,{key:1,color:"gray",variant:"ghost",size:"xs",class:be(["rounded-full px-4 py-1.5 shadow-lg hover:shadow-xl transition-all duration-300 backdrop-blur-sm",Se(S)]),onClick:rn,disabled:Se(Dt)},{default:Te(()=>[P[11]||(P[11]=dt(" 下一页 ")),te(ne,{name:"i-heroicons-arrow-right",class:"ml-1 w-4 h-4"})]),_:1},8,["class","disabled"])):Le("",!0),Se(Dt)?(J(),ae("span",Hh,"加载中...")):Le("",!0)]),N("div",Nh,[N("span",jh,"第 "+We(Se(F).page)+" 页",1),te(Pe,{modelValue:Se(C),"onUpdate:modelValue":P[0]||(P[0]=ge=>ba(C)?C.value=ge:null),type:"number",min:"1",max:Se(T),class:"w-12 text-center text-sm",placeholder:"#",onKeyup:ls(M,["enter"])},null,8,["modelValue","max"]),te(ie,{size:"xs",color:"gray",variant:"ghost",class:"text-gray-400 hover:text-orange-500 text-sm",onClick:M},{default:Te(()=>P[12]||(P[12]=[dt(" 跳转 ")])),_:1})])])),!Se(Nt)&&Se(F).messages.length>0&&!Se(F).hasMore?(J(),ae("div",$h,[te(ne,{name:"i-fluent-emoji-flat-confetti-ball",size:"lg"}),P[13]||(P[13]=dt(" 加载完毕~ "))])):Le("",!0)],2),p.siteConfig.pageFooterHTML?(J(),ae("div",{key:2,innerHTML:p.siteConfig.pageFooterHTML},null,8,Uh)):(J(),ae("div",Bh,P[14]||(P[14]=[dt(" 来自"),N("a",{href:"https://www.noisework.cn",target:"_blank",rel:"noopener noreferrer",class:"text-orange-400 hover:text-orange-500"},"Noise",-1),dt(" 使用"),N("a",{href:"https://github.com/rcy1314/echo-noise",target:"_blank",rel:"noopener noreferrer",class:"text-orange-400 hover:text-orange-500"},"Ech0-Noise",-1),dt("发布 ")])))]),te(Pt,{modelValue:Se(rt),"onUpdate:modelValue":P[4]||(P[4]=ge=>ba(rt)?rt.value=ge:null),ui:{width:"sm:max-w-2xl"}},{default:Te(()=>[te(et,null,{header:Te(()=>[N("div",zh,[P[15]||(P[15]=N("h3",{class:"text-lg font-medium"},"编辑内容",-1)),te(ie,{color:"gray",variant:"ghost",icon:"i-mdi-close",class:"-my-1",onClick:P[1]||(P[1]=ge=>rt.value=!1)})])]),footer:Te(()=>[N("div",Yh,[te(ie,{color:"gray",variant:"outline",onClick:P[3]||(P[3]=ge=>rt.value=!1),class:"text-white"},{default:Te(()=>P[17]||(P[17]=[dt(" 取消 ")])),_:1}),te(ie,{color:"orange",onClick:yn,loading:Se(on),class:"text-white"},{default:Te(()=>P[18]||(P[18]=[dt(" 保存 ")])),_:1},8,["loading"])])]),default:Te(()=>{var ge;return[N("div",Fh,[te(Fe,{modelValue:Se(Kt),"onUpdate:modelValue":P[2]||(P[2]=mt=>ba(Kt)?Kt.value=mt:null),placeholder:"编辑内容...",rows:"10",class:"font-mono text-sm"},null,8,["modelValue"]),N("div",Vh,[P[16]||(P[16]=N("div",{class:"text-sm text-gray-500 mb-2"},"预览：",-1)),N("div",qh,[N("div",Wh,[te(wi,{content:Se(Kt),enableGithubCard:((ge=p.siteConfig)==null?void 0:ge.enableGithubCard)===!0},null,8,["content","enableGithubCard"])])])])])]}),_:1})]),_:1},8,["modelValue"])],64)}}}),Gh=Tn(Kh,[["__scopeId","data-v-f4461fa3"]]),Xh={class:"calendar-wrapper"},Zh={class:"heatmap-grid"},Jh=["title"],Qh=nn({__name:"heatmap",setup(p){const e=G([]),r=G([]),s=G(null),l=$i("contentTheme",G("light")),d=he(()=>String(l&&l.value!==void 0?l.value:l)==="dark");he(()=>d.value?"text-white/70":"text-black/60"),he(()=>{if(!e.value.length)return Array(12).fill("").map((C,T)=>`${T+1}月`);const g=e.value.map(C=>new Date(C.date)),b=new Date(Math.min(...g)),k=[];let w=new Date(b);w.setDate(1);let _=w.getFullYear();for(let C=0;C<12;C++){const T=w.getMonth(),M=w.getFullYear();M!==_||C===0?(k.push(`${M}年${T+1}月`),_=M):k.push(`${T+1}月`),w.setMonth(T+1)}return k});const m=g=>{const b=["#9be9a8","#40c463","#30a14e","#216e39","#0e4429"],k=["rgba(16, 185, 129, 0.28)","rgba(16, 185, 129, 0.45)","rgba(16, 185, 129, 0.62)","rgba(16, 185, 129, 0.80)","rgba(16, 185, 129, 0.98)"];return(d.value?k:b)[Math.min(Math.max(g-1,0),4)]||(d.value?"rgba(255,255,255,0.06)":"rgba(0,0,0,0.06)")},u=g=>g.count?m(g.level):d.value?"rgba(255, 255, 255, 0.10)":"#e5e7eb",v=async()=>{try{const b=await(await fetch("/api/messages/calendar")).json();b&&b.code===1&&b.data&&b.data.length>0?(e.value=b.data,h()):S()}catch(g){console.error("获取热力图数据失败:",g),S()}},S=()=>{const g=new Date,b=new Date(g);b.setMonth(g.getMonth()-11),b.setDate(1);const k=[];let w=new Date(b);for(;w<=g;){const _=Math.random()>.7?Math.floor(Math.random()*10)+1:0;k.push({date:E(w),count:_}),w.setDate(w.getDate()+1)}e.value=k,h()},E=g=>{const b=g.getFullYear(),k=String(g.getMonth()+1).padStart(2,"0"),w=String(g.getDate()).padStart(2,"0");return`${b}-${k}-${w}`},h=()=>{if(!e.value.length)return;const g=e.value.map(M=>new Date(M.date)),b=new Date(Math.min(...g));new Date(Math.max(...g));const k=new Date(b);k.setDate(1);const w=new Date(k);w.setMonth(k.getMonth()+11),w.setDate(w.getDate()+(6-w.getDay()));const _=new Map;e.value.forEach(M=>{M&&M.date&&M.count!==void 0&&_.set(M.date,M.count)});const C=[];let T=new Date(k);for(T.setDate(T.getDate()-T.getDay());T<=w;){const M=[];for(let y=0;y<7;y++){const O=E(T),B=_.get(O)||0;M.push({date:O,count:B,level:B?Math.min(Math.ceil(B/2),5):0}),T.setDate(T.getDate()+1)}C.push(M)}r.value=C},f=()=>{const g=new Date,b=new Date(g);b.setMonth(g.getMonth()-11),b.setDate(1);const k=new Date(b);k.setMonth(b.getMonth()+11),k.setDate(k.getDate()+(6-k.getDay()));const w=[];let _=new Date(b);for(_.setDate(_.getDate()-_.getDay());_<=k;){const C=[];for(let T=0;T<7;T++)C.push({date:E(_),count:0,level:0}),_.setDate(_.getDate()+1);w.push(C)}r.value=w};return Ht(()=>{f(),v()}),(g,b)=>(J(),ae("div",Xh,[N("div",{class:be(["calendar-container",d.value?"heatmap-dark":"heatmap-light"]),ref_key:"calendarContainer",ref:s},[N("div",Zh,[(J(!0),ae(It,null,Qt(r.value,(k,w)=>(J(),ae("div",{key:w,class:"heatmap-week"},[(J(!0),ae(It,null,Qt(k,(_,C)=>(J(),ae("div",{key:C,class:"heatmap-day",style:ji({backgroundColor:u(_)}),title:`${_.date} · ${_.count||0} 条`},null,12,Jh))),128))]))),128))])],2)]))}}),ns=Tn(Qh,[["__scopeId","data-v-4d7f2245"]]),ep={class:"tags-container w-full"},tp={class:"relative"},np={class:"tags-wrapper"},ip={class:"tags-scroll"},rp=["onClick"],ap={class:"tag-count"},op=nn({__name:"TagList",props:{tags:{type:Array,default:()=>[]}},emits:["tagClick","updateTags"],setup(p,{emit:e}){const r=e,s=G(!1),l=G(Date.now()),d=p,m=he(()=>{const S=/[/?=&]/,E=/^(song|video|playlist)\?id=\d+$/,h=new Map;return d.tags.reduce((f,g)=>(h.has(g.name)||!S.test(g.name)&&!E.test(g.name)&&(h.set(g.name,!0),f.push(g)),f),[])},{}),u=S=>{r("tagClick",S)},v=async()=>{s.value||(s.value=!0,l.value=Date.now(),r("updateTags"),setTimeout(()=>{s.value=!1},1e3))};return(S,E)=>{const h=ci;return J(),ae("div",ep,[N("div",tp,[N("div",np,[N("div",ip,[(J(!0),ae(It,null,Qt(m.value,f=>(J(),ae("span",{key:f.name+l.value,class:"tag-item",onClick:g=>u(f.name)},[dt(" #"+We(f.name)+" ",1),N("span",ap,"("+We(f.count)+")",1)],8,rp))),128))])]),N("div",{class:"absolute -right-1 top-1/2 -translate-y-1/2 p-2 cursor-pointer transition-all duration-200 hover:scale-110 z-10 refresh-toggle",onClick:v,title:"刷新标签"},[te(h,{name:"i-mdi-refresh",class:be(["w-5 h-5 refresh-icon",{"animate-spin":s.value}])},null,8,["class"])]),E[0]||(E[0]=N("div",{class:"scroll-fade"},null,-1))])])}}}),sp=Tn(op,[["__scopeId","data-v-0448707a"]]),lp={class:"announcement-container mx-auto w-full sm:max-w-2xl px-2"},cp={class:"announcement-wrapper"},up=["title"],dp={class:"marquee-item"},fp=60,hp=nn({__name:"AnnouncementBar",props:{text:{}},setup(p){const e=p,r=G(null),s=G(null),l=G(null),d=G(0),m=G(18),u=()=>{const v=l.value;if(!v)return;const S=v.scrollWidth,E=40;d.value=S+E,m.value=Math.max(Math.round(d.value/fp),12)};return Ht(()=>{yt(()=>{u(),window.addEventListener("resize",u)})}),oi(()=>{window.removeEventListener("resize",u)}),Et(()=>e.text,()=>yt(u)),(v,S)=>{const E=ci;return J(),ae("div",lp,[N("div",cp,[te(E,{name:"i-mdi-bell-outline",class:"w-4 h-4 mr-2 flex-shrink-0 text-orange-500"}),N("div",{class:"announcement-text",ref_key:"textContainer",ref:r,title:v.text},[N("div",{class:"marquee animate",ref_key:"marquee",ref:s,style:ji({"--distance":d.value+"px",animationDuration:m.value+"s"})},[N("div",{class:"marquee-item",ref_key:"firstItem",ref:l},[te(wi,{content:v.text,enableGithubCard:!1},null,8,["content"])],512),N("div",dp,[te(wi,{content:v.text,enableGithubCard:!1},null,8,["content"])])],4)],8,up)])])}}}),is=Tn(hp,[["__scopeId","data-v-571a4c47"]]),pp=nn({__name:"FloatingToolSidebar",props:{contentTheme:{},layoutIcon:{}},setup(p){const e=p,r=he(()=>e.contentTheme==="dark"),s=he(()=>e.contentTheme==="dark"?"i-mdi-weather-night":"i-mdi-white-balance-sunny"),l=he(()=>e.layoutIcon||"i-mdi-view-grid");return(d,m)=>{const u=ci;return J(),ae("div",{class:be(["floating-sidebar",Se(r)?"fs-dark":"fs-light"])},[N("button",{class:be(["tool-btn btn-layout",Se(r)?"btn-dark":"btn-light"]),onClick:m[0]||(m[0]=v=>d.$emit("toggle-layout")),title:"布局"},[te(u,{name:Se(l),class:"w-5 h-5"},null,8,["name"])],2),N("button",{class:be(["tool-btn",Se(r)?"btn-dark":"btn-light"]),onClick:m[1]||(m[1]=v=>d.$emit("search")),title:"搜索"},[te(u,{name:"i-heroicons-magnifying-glass",class:"w-5 h-5"})],2),N("button",{class:be(["tool-btn",Se(r)?"btn-dark":"btn-light"]),onClick:m[2]||(m[2]=v=>d.$emit("switch-background")),title:"背景"},[te(u,{name:"i-mdi-image-outline",class:"w-5 h-5"})],2),N("button",{class:be(["tool-btn",Se(r)?"btn-dark":"btn-light"]),onClick:m[3]||(m[3]=v=>d.$emit("toggle-theme")),title:"切换亮暗"},[te(u,{name:Se(s),class:"w-5 h-5"},null,8,["name"])],2),N("a",{href:"/rss",target:"_blank",rel:"noopener noreferrer",class:be(["tool-btn",Se(r)?"btn-dark":"btn-light"]),title:"RSS"},[te(u,{name:"i-mdi-rss",class:"w-5 h-5"})],2),N("button",{class:be(["tool-btn",Se(r)?"btn-dark":"btn-light"]),title:"后台",onClick:m[4]||(m[4]=v=>d.$emit("open-admin"))},[te(u,{name:"i-mdi-server-outline",class:"w-5 h-5"})],2)],2)}}}),mp=Tn(pp,[["__scopeId","data-v-070128c4"]]),gp={key:0,class:"loading"},vp={key:0,class:"left-col"},bp={class:"profile-card"},yp={class:"avatar-wrap relative"},wp=["src","alt"],Ep={class:"profile-name text-center"},kp={key:0,class:"mt-1"},Sp={class:"profile-desc"},xp={key:1,class:"auth-actions"},_p={class:"p-0 grid grid-cols-3 gap-2 text-center text-sm"},Cp={class:"font-semibold"},Tp={class:"font-semibold"},Mp={class:"font-semibold"},Ap={class:"social-list"},Lp=["href","data-label"],Dp=["src"],Op={class:"p-0 text-center clock-card"},Pp={class:"clock-display"},Rp={class:"clock-date"},Ip={key:0,class:"relative"},Hp=["href"],Np=["src"],jp={class:"ad-overlay"},$p={key:0,class:"absolute bottom-2 left-0 right-0 flex justify-center gap-2"},Bp=["onClick"],Up={class:"hitokoto-container mx-auto w-full sm:max-w-2xl px-2"},zp=["title"],Fp={key:3,class:"mt-2 space-y-3"},Vp={class:"scroll-tags mb-2"},qp={class:"tag-grid"},Wp=["onClick"],Yp={class:"ml-1 opacity-60"},Kp={class:"scroll-images"},Gp={class:"recommend-grid"},Xp=["href"],Zp=["src"],Jp={class:"scroll-list p-0"},Qp={class:"flex flex-wrap gap-2"},em=["src","data-mail","data-qq","onError"],tm={class:"center-col"},nm={class:"moments-header"},im={class:"header-title"},rm={class:"hero-tabs"},am=["onClick"],om={key:0,class:"links-page"},sm={key:0,class:"section-subtitle"},lm={class:"mx-auto w-full max-w-3xl px-4 sm:px-6"},cm={class:"link-grid"},um=["href"],dm={class:"link-content"},fm={class:"link-title"},hm={key:0,class:"text-xs opacity-75"},pm={key:1,class:"comment-page"},mm={key:0,class:"section-subtitle"},gm={class:"max-w-3xl mx-auto"},vm={key:1,class:"text-sm opacity-70"},bm={key:2,class:"about-page"},ym={key:0,class:"section-subtitle"},wm={class:"mx-auto w-full max-w-3xl px-4 sm:px-6"},Em={class:"mx-auto w-full sm:max-w-4xl mt-3"},km={key:0,class:"right-col space-y-3"},Sm={class:"scroll-tags mb-2"},xm={class:"tag-grid"},_m=["onClick"],Cm={class:"ml-1 opacity-60"},Tm={class:"scroll-images"},Mm={class:"recommend-grid"},Am=["href"],Lm=["src"],Dm={class:"scroll-list p-0"},Om={class:"flex flex-wrap gap-2"},Pm=["src","data-mail","data-qq","onError"];const Rm=["data-playlist-id","data-song-id","data-position","data-theme","data-lyric","data-default-minimized","data-embed","data-autoplay"],Im={class:"flex justify-between items-center"},Hm={class:"text-xl font-semibold"},Nm={class:"flex items-center gap-2"},jm={class:"space-y-3"},$m={key:0},Bm={class:"space-y-3"},Um={class:"flex items-center justify-between text-sm mt-2"},zm={key:0,class:"text-center text-sm opacity-80 mt-3"},Fm={key:1,class:"mt-2"},Vm={key:1},qm={class:"space-y-3"},Wm={class:"flex items-center gap-2"},Ym=["src"],Km={class:"space-y-3"},Gm={class:"flex justify-end gap-2"},$a="https://s2.loli.net/2025/03/24/HnSXKvibAQlosIW.png",rg=nn({__name:"index",setup(p){const e=Sc(),r=cs(),s=gn().public.baseApi||"/api",l=(()=>{if(typeof window>"u")return"three";const H=window.matchMedia("(max-width: 1024px)").matches,R=localStorage.getItem(H?"homeLayoutMobile":"homeLayoutDesktop");return R||(H?"single":"three")})(),d=G(l),m=typeof window<"u"?window.matchMedia("(max-width: 1024px)"):null,u=G(!!(m!=null&&m.matches)),v=()=>{u.value||(d.value=d.value==="three"?"two":d.value==="two"?"single":"three",typeof window<"u"&&localStorage.setItem("homeLayoutDesktop",d.value))},S=he(()=>d.value==="three"?"grid-3":d.value==="two"?"grid-2":"grid-1"),E=he(()=>d.value==="three"?"i-mdi-view-grid":d.value==="two"?"i-mdi-view-column":"i-mdi-view-stream"),h=he(()=>d.value==="two"?"w-full max-w-none":d.value==="single"?"mx-auto w-full max-w-[640px] sm:max-w-3xl":"mx-auto w-full sm:max-w-4xl"),f=[{key:"latest",name:"最新"},{key:"links",name:"友链"},{key:"comment",name:"留言"},{key:"about",name:"关于"}],g=G("latest"),b=G(null),k=G(!1),w=G(!1),_=G("login"),C=ea({username:"",password:""}),T=ea({username:"",password:"",captcha:""}),M=G(!1),y=G(!1),O=G(!1),B=G(!1),V=G(""),I=G(0);let j=null,z=null;const F=G(!1),le=ea({account:""}),de=G(0);let Re=null;const Be=G(!0),Ce=G(!1),De=async()=>{try{V.value=`${s}/captcha?ts=${Date.now()}`,j=Date.now()+12e4,I.value=120,z&&clearInterval(z),z=Ki(()=>{const H=Math.max(0,Math.ceil(((j||Date.now())-Date.now())/1e3));I.value=H,H<=0&&clearInterval(z)},1e3)}catch{I.value=0}},Ie=async()=>{var H;try{const Y=await(await fetch(`${s}/frontend/config`,{credentials:"include"})).json();if(!!!((H=Y==null?void 0:Y.data)!=null&&H.allowRegistration)){Ze().add({title:"提示",description:"站点已关闭用户注册",color:"orange"});return}}catch{}_.value="register",De()},Je=()=>{_.value="login"},tt=()=>{w.value=!1;const{login:H,...R}=r.query;e.replace({path:r.path,query:R})},U=async()=>{O.value=!0;try{if(await Gn().login({username:C.username,password:C.password})){Ze().add({title:"登录成功",color:"green"}),w.value=!1;const R=r.query.redirect||"/status";e.push(R)}}catch{Ze().add({title:"登录失败",color:"red"})}finally{O.value=!1}},oe=async()=>{B.value=!0;try{if(!T.username||!T.password||!T.captcha)throw new Error("请完整填写用户名、密码与验证码");if((j||0)<Date.now())throw new Error("验证码已过期，请刷新后再提交");const H=await fetch(`${s}/register`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(T)}),R=await H.json().catch(()=>({}));if(!H.ok||R.code!==1)throw new Error((R==null?void 0:R.msg)||"注册失败");Ze().add({title:"注册成功",color:"green"}),_.value="login"}catch(H){Ze().add({title:"注册失败",description:H.message||"请稍后重试",color:"red"}),De()}finally{B.value=!1}},re=async()=>{var R,Y,Q;if(await Gn().checkLoginStatus())e.push("/status");else{_.value="login",w.value=!0;try{const Ee=await(await fetch(`${s}/frontend/config`,{credentials:"include"})).json();Ce.value=!!((Y=(R=Ee==null?void 0:Ee.data)==null?void 0:R.frontendSettings)!=null&&Y.githubOAuthEnabled),Be.value=!!((Q=Ee==null?void 0:Ee.data)!=null&&Q.smtpEnabled)}catch{}}};oi(()=>{z&&clearInterval(z)}),Et(()=>r.query.login,H=>{H&&(_.value="login",w.value=!0)},{immediate:!0}),Et(w,H=>{if(!H&&r.query.login){const{login:R,...Y}=r.query;e.replace({path:r.path,query:Y})}});const Ae=()=>{window.location.href=`${s}/oauth/github/login`},Ke=async()=>{try{const H=await fetch(`${s}/password/forgot`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({account:le.account})}),R=await H.json().catch(()=>({}));if(!H.ok||R.code!==1)throw new Error((R==null?void 0:R.msg)||"发送失败");Ze().add({title:(R==null?void 0:R.msg)||"已发送",description:"请查收重置邮件",color:"green"}),de.value=60,Re&&clearInterval(Re),Re=Ki(()=>{de.value>0?de.value--:clearInterval(Re)},1e3)}catch(H){Ze().add({title:"失败",description:H.message||"发送失败",color:"red"})}},X=G(null),we=H=>{console.log("接收到搜索结果:",H),b.value&&b.value.handleSearchResult(H)},se=G(null),ee=async()=>{var H;try{const Y=await(await fetch((gn().public.baseApi||"/api")+"/guestbook/message",{method:"GET",headers:{Accept:"application/json"},credentials:"include"})).json().catch(()=>null),Q=(H=Y==null?void 0:Y.data)==null?void 0:H.id;se.value=typeof Q=="number"?Q:null}catch{se.value=null}};Et(()=>g.value,H=>{H==="comment"&&!se.value&&ee()}),Ht(()=>{ee()});const He=Gn(),ve=he(()=>!!He.isLogin),st=he(()=>{var Y,Q;const H=((Y=W.value)==null?void 0:Y.users)||((Q=W.value)==null?void 0:Q.Users)||[];return(Array.isArray(H)?H.find(ye=>!!((ye==null?void 0:ye.is_admin)??(ye==null?void 0:ye.IsAdmin))):null)||(Array.isArray(H)?H[0]:null)||null}),Ve=he(()=>{const H=He.user;if(H)return!!(H!=null&&H.is_admin||H!=null&&H.IsAdmin);const R=st.value;return!!(R&&(R!=null&&R.is_admin||R!=null&&R.IsAdmin))}),Qe=he(()=>{var Q;const H=He.user,R=String((H==null?void 0:H.username)||(H==null?void 0:H.Username)||"").trim();return R||String(((Q=P.value)==null?void 0:Q.welcomeName)||"").trim()||"匿名"}),Oe=he(()=>{var ye;const H=He.user,R=String((H==null?void 0:H.avatar_url)||(H==null?void 0:H.AvatarURL)||"").trim(),Y=gn().public.baseApi||"/api";if(R)return R.startsWith("http")?R:`${Y}${R}`;const Q=String(((ye=P.value)==null?void 0:ye.welcomeAvatarURL)||"").trim();return Q?Q.startsWith("http")?Q:`${Y}${Q}`:$a}),it=H=>{const R=H.target;R&&R.src!==$a&&(R.src=$a)},lt=he(()=>{var Q;const H=He.user,R=String((H==null?void 0:H.description)||"").trim();return R||String(((Q=P.value)==null?void 0:Q.welcomeDescription)||"").trim()||"执迷不悟"}),ft=G(!0),ht=G(typeof window<"u"&&localStorage.getItem("contentTheme")||"light");he(()=>ht.value==="dark"?"i-mdi-weather-night":"i-mdi-white-balance-sunny");const Dt=G(!1);Er("showHeatmap",ft),Er("contentTheme",ht),Er("toggleContentTheme",()=>{ht.value=ht.value==="dark"?"light":"dark",typeof window<"u"&&(localStorage.setItem("contentTheme",ht.value),document.documentElement.classList.toggle("dark",ht.value==="dark"))}),Et(()=>ht.value,H=>{typeof window<"u"&&document.documentElement.classList.toggle("dark",H==="dark")},{immediate:!0});const Mn=()=>{ht.value=ht.value==="dark"?"light":"dark",typeof window<"u"&&(localStorage.setItem("contentTheme",ht.value),document.documentElement.classList.toggle("dark",ht.value==="dark"))},rn=G(null),an=()=>{const H=rn.value;H?H.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"})},rt=()=>{const H=rn.value;if(H)H.scrollTo({top:H.scrollHeight,behavior:"smooth"});else{const R=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight);window.scrollTo({top:R,behavior:"smooth"})}},Kt=[],dn=()=>{Array.from(document.querySelectorAll(".scroll-list, .scroll-images")).forEach(R=>{let Y=0,Q=performance.now(),ye=0;const Ee=R.classList.contains("scroll-list")?.25:.35,at=1200,Yt=At=>{Y=requestAnimationFrame(Yt);const En=At-Q;Q=At,!(ye&&At<ye)&&(R.scrollTop+=Ee*En/16,R.scrollTop>=R.scrollHeight-R.clientHeight-1&&(R.scrollTop=0,ye=At+at))};Y=requestAnimationFrame(Yt),Kt.push(()=>cancelAnimationFrame(Y))})},on=G(!1),fn=G(!0),yn=G(!1),un=()=>{const H=rn.value;if(!H){const Q=window.scrollY||document.documentElement.scrollTop||0,ye=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight);fn.value=Q<=2,yn.value=window.innerHeight+Q>=ye-2;return}const R=H.scrollTop,Y=H.scrollHeight;fn.value=R<=2,yn.value=H.clientHeight+R>=Y-2};Ht(()=>{var H;un(),(H=rn.value)==null||H.addEventListener("scroll",un,{passive:!0}),Dt.value&&yt(()=>dn())}),oi(()=>{var H;(H=rn.value)==null||H.removeEventListener("scroll",un),Kt.forEach(R=>R())});const Nt=he(()=>fn.value||yn.value||on.value),Mt=he(()=>yn.value&&!fn.value?"i-heroicons-arrow-up":"i-heroicons-arrow-down"),ei=()=>{yn.value&&!fn.value?an():rt()},$t=he(()=>ht.value==="dark"),Ot=he(()=>$t.value?"bg-[rgba(36,43,50,0.95)] text-white border border-white/20":"bg-white text-black border border-black/10"),jt=he(()=>$t.value?"scroll-button bg-[rgba(36,43,50,0.85)] hover:bg-[rgba(36,43,50,0.95)] text-white shadow-[0_6px_16px_rgba(0,0,0,0.35)]":"scroll-button bg-white/95 hover:bg-white text-gray-700 ring-1 ring-gray-200 shadow-[0_4px_12px_rgba(0,0,0,0.12)]"),q=he(()=>$t.value?"text-white w-6 h-6":"text-gray-600 w-6 h-6");Et(ft,H=>{console.log("index.vue 中热力图状态变化:",H)}),go({meta:[{name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"}]}),Et(()=>r.hash,H=>{const R=(H||"").split("/messages/").pop();X.value=R||null},{immediate:!0});const P=G({siteTitle:"",subtitleText:"",avatarURL:"",username:"",description:"",backgrounds:[],cardFooterTitle:"",cardFooterSubtitle:"",pageFooterHTML:"",rssTitle:"",rssDescription:"",rssAuthorName:"",rssFaviconURL:"",linksTitle:"",linksDescription:"",commentPageTitle:"",commentPageDescription:"",aboutPageTitle:"",aboutPageDescription:"",aboutMarkdown:"",friendLinks:[],enableGithubCard:!1,pwaEnabled:!0,pwaTitle:"",pwaDescription:"",pwaIconURL:"",announcementText:"",announcementEnabled:!0,hitokotoEnabled:!0,commentEnabled:!0,commentSystem:"builtin",commentEmailEnabled:!1,commentLoginRequired:!1,musicEnabled:!1,musicPlaylistId:"2141128031",musicSongId:"",musicPosition:"bottom-left",musicTheme:"auto",musicLyric:!0,musicAutoplay:!1,musicDefaultMinimized:!0,musicEmbed:!1,musicCssCdnURL:"",musicJsCdnURL:"",calendarEnabled:!0,timeEnabled:!0,leftAdEnabled:!0,leftAdImageURL:`https://picsum.photos/seed/${Math.random().toString(36).slice(2)}/640/640`,leftAdLinkURL:"https://note.noisework.cn",leftAdDescription:"示例广告（单条配置）",leftAds:[{imageURL:`https://picsum.photos/seed/${Math.random().toString(36).slice(2)}/640/640`,linkURL:"https://note.noisework.cn",description:"写作与记录，开启灵感之旅"},{imageURL:`https://picsum.photos/seed/${Math.random().toString(36).slice(2)}/640/640`,linkURL:"https://noisework.cn",description:"探索新主题与小工具"},{imageURL:`https://picsum.photos/seed/${Math.random().toString(36).slice(2)}/640/640`,linkURL:"https://github.com",description:"开源项目，欢迎 Star"}],leftAdsIntervalMs:4e3}),ne=async()=>{await yt();const H=window.NeteaseMiniPlayer;H&&typeof H.init=="function"&&H.init()},ie=async()=>{if(typeof window>"u")return!1;if(window.NeteaseMiniPlayer)return!0;const H=document.head,R=document.body,Y="nmp-css";if(!document.getElementById(Y)){const ye=document.createElement("link");ye.id=Y,ye.rel="stylesheet";const Ee=P.value.musicCssCdnURL||"",at="/NeteaseMiniPlayer/netease-mini-player-v2.css";ye.href=Ee&&Ee.trim()!==""?Ee.trim():at,ye.onerror=()=>{ye.href=at},H.appendChild(ye)}const Q="nmp-js";return document.getElementById(Q)?!!window.NeteaseMiniPlayer:await new Promise(ye=>{const Ee=document.createElement("script");Ee.id=Q;const at=P.value.musicJsCdnURL||"",Yt="/NeteaseMiniPlayer/netease-mini-player-v2.js";Ee.src=at&&at.trim()!==""?at.trim():Yt,Ee.defer=!0,Ee.onload=()=>ye(!!window.NeteaseMiniPlayer),Ee.onerror=()=>{if(Ee.src!==Yt){Ee.src=Yt,Ee.onload=()=>ye(!!window.NeteaseMiniPlayer),Ee.onerror=()=>ye(!1);return}ye(!1)},R.appendChild(Ee)})},Pe=async(H,R=2500)=>{const Y=new AbortController,Q=setTimeout(()=>Y.abort(),R);try{const ye=await fetch(H,{cache:"no-cache",signal:Y.signal});return clearTimeout(Q),ye}catch(ye){throw clearTimeout(Q),ye}},Fe=async()=>{if(typeof window>"u")return;await yt();try{const R=await Pe("https://v1.hitokoto.cn/?encode=json",2500);if(R.ok){const Y=await R.json(),Q=String((Y==null?void 0:Y.hitokoto)||"").trim();if(Q){vt.value=Q;return}}}catch{}try{const R=await Pe("https://v1.hitokoto.cn/?encode=text",2500);if(R.ok){const Y=String(await R.text()).trim();if(Y){vt.value=Y;return}}}catch{}try{if(!document.getElementById("hitokoto-script-left")){const R=document.createElement("script");R.id="hitokoto-script-left",R.src="https://v1.hitokoto.cn/?encode=js&select=%23hitokoto",R.defer=!0,R.onload=()=>{try{const Y=document.getElementById("hitokoto"),Q=((Y==null?void 0:Y.textContent)||(Y==null?void 0:Y.innerText)||"").trim();Q&&(vt.value=Q)}catch{}},document.body.appendChild(R)}}catch{}String(vt.value||"").trim()||(vt.value="身为冒险者，如果安静的老死在床上，那简直就是耻辱！")};Et(()=>P.value.musicEnabled,async H=>{H&&await ie()&&await ne()}),Et(()=>P.value.hitokotoEnabled,async H=>{H&&await Fe()},{immediate:!0});const et=he(()=>({"--bg-image":`url(${Bt.value||P.value.backgrounds[0]})`})),Pt=he(()=>({"background-image":`url(${Bt.value||P.value.backgrounds[0]})`,"background-size":"cover","background-position":"center"})),ge={siteTitle:"说说笔记",subtitleText:"欢迎访问，点击头像可更换封面背景！",avatarURL:"https://s2.loli.net/2025/03/24/HnSXKvibAQlosIW.png",username:"Noise",description:"执迷不悟",welcomeAvatarURL:"https://s2.loli.net/2025/03/24/HnSXKvibAQlosIW.png",welcomeName:"Noise",welcomeDescription:"执迷不悟",welcomeUseAdmin:!0,backgrounds:["https://s2.loli.net/2025/03/27/KJ1trnU2ksbFEYM.jpg","https://s2.loli.net/2025/03/27/MZqaLczCvwjSmW7.jpg","https://s2.loli.net/2025/03/27/UMijKXwJ9yTqSeE.jpg","https://s2.loli.net/2025/03/27/WJQIlkXvBg2afcR.jpg","https://s2.loli.net/2025/03/27/oHNQtf4spkq2iln.jpg","https://s2.loli.net/2025/03/27/PMRuX5loc6Uaimw.jpg","https://s2.loli.net/2025/03/27/U2WIslbNyTLt4rD.jpg","https://s2.loli.net/2025/03/27/xu1jZL5Og4pqT9d.jpg","https://s2.loli.net/2025/03/27/OXqwzZ6v3PVIns9.jpg","https://s2.loli.net/2025/03/27/HGuqlE6apgNywbh.jpg","https://s2.loli.net/2025/03/26/d7iyuPYA8cRqD1K.jpg","https://s2.loli.net/2025/03/27/wYy12qDMH6bGJOI.jpg","https://s2.loli.net/2025/03/27/y67m2k5xcSdTsHN.jpg"],cardFooterTitle:"Noise·说说·笔记~",cardFooterSubtitle:"note.noisework.cn",pageFooterHTML:'<div class="text-center text-xs text-gray-400 py-4">来自<a href="https://www.noisework.cn" target="_blank" rel="noopener noreferrer" class="text-orange-400 hover:text-orange-500">Noise</a> 使用<a href="https://github.com/rcy1314/echo-noise" target="_blank" rel="noopener noreferrer" class="text-orange-400 hover:text-orange-500">Ech0-Noise</a>发布</div>',rssTitle:"Noise的说说笔记",rssDescription:"一个说说笔记~",rssAuthorName:"Noise",rssFaviconURL:"/favicon.ico",aboutMarkdown:`# 关于我

这里是一个默认的个人简介示例：

- 喜欢记录与分享
- 热爱开源与学习
- 持续打磨产品体验

欢迎通过友链或留言与我交流！`,linksTitle:"友情链接",linksDescription:"推荐站点和朋友们的主页",commentPageTitle:"留言",commentPageDescription:"欢迎留下你的看法",aboutPageTitle:"关于本站",aboutPageDescription:"这里是站点的介绍与说明",enableGithubCard:!1,pwaEnabled:!0,pwaTitle:"",pwaDescription:"",pwaIconURL:"",announcementText:"欢迎访问我的说说笔记！",announcementEnabled:!0,hitokotoEnabled:!0,commentEnabled:!0,commentSystem:"builtin",commentEmailEnabled:!1,commentLoginRequired:!1,musicEnabled:!1,musicPlaylistId:"2141128031",musicSongId:"",musicPosition:"bottom-left",musicTheme:"auto",musicLyric:!0,musicAutoplay:!1,musicDefaultMinimized:!0,musicEmbed:!1,musicCssCdnURL:"",musicJsCdnURL:"",socialLinks:[{name:"GitHub",url:"https://github.com/rcy1314",icon:"i-mdi-github"},{name:"X",url:"https://x.com/liangwenhao3",icon:"i-mdi-twitter"},{name:"主页",url:"https://www.noisework.cn/",icon:"i-mdi-home"},{name:"博客",url:"https://www.noiseblogs.top/",icon:"i-mdi-notebook"}],friendLinks:[{title:"NoiseWork",link:"https://www.noisework.cn/",icon:"i-mdi-home",description:"个人主页与作品集合"},{title:"NoiseBlogs",link:"https://www.noiseblogs.top/",icon:"i-mdi-notebook",description:"技术随笔与学习记录"}],calendarEnabled:!0,timeEnabled:!0,leftAdEnabled:!0,leftAds:[],leftAdsIntervalMs:4e3},mt=async()=>{var H;try{P.value={...ge};const R=await Bn("frontend/config",void 0,{credentials:"include"});if(R&&R.code===1&&R.data&&R.data.frontendSettings){const Y=R.data.frontendSettings,Q=["enableGithubCard","pwaEnabled","announcementEnabled","hitokotoEnabled","commentEnabled","commentEmailEnabled","commentLoginRequired","musicEnabled","musicLyric","musicAutoplay","musicDefaultMinimized","musicEmbed","calendarEnabled","timeEnabled","leftAdEnabled","welcomeUseAdmin"];Object.keys(P.value).forEach(Ee=>{if(Y[Ee]!==null&&Y[Ee]!==void 0)if(Ee==="backgrounds"&&Array.isArray(Y[Ee]))P.value.backgrounds=[...Y[Ee]];else if(Ee==="socialLinks"&&Array.isArray(Y[Ee]))P.value.socialLinks=[...Y[Ee]];else if(Ee==="leftAds"&&Array.isArray(Y[Ee]))P.value.leftAds=[...Y[Ee]];else if(Ee==="friendLinks"&&Array.isArray(Y[Ee]))P.value.friendLinks=[...Y[Ee]];else if(Q.includes(Ee)){const at=Y[Ee];P.value[Ee]=at===!0||at==="true"}else{const at=Y[Ee];P.value[Ee]=typeof at=="string"?at.trim():at}});const ye=(Y.defaultContentTheme||"light").trim();typeof window<"u"&&!localStorage.getItem("contentTheme")?(ht.value=ye==="light"?"light":"dark",document.documentElement.className=ht.value==="dark"?"dark":""):typeof window<"u"&&(document.documentElement.className=ht.value==="dark"?"dark":"")}if((H=P.value.backgrounds)!=null&&H.length||(P.value.backgrounds=[...ge.backgrounds]),P.value.backgrounds.length>0){const Y=Math.floor(Math.random()*P.value.backgrounds.length);Bt.value=P.value.backgrounds[Y]}Ut.value=!0}catch(R){console.error("获取配置失败:",R),P.value={...ge},Ut.value=!0}},gt=H=>{const R=H&&typeof H.icon=="string"?H.icon.trim():"";if(R)return R;const Y=String((H==null?void 0:H.url)||"").trim();if(!Y)return"i-mdi-link-variant";const Q=Y.toLowerCase();if(Q.startsWith("mailto:"))return"i-mdi-email";let ye="";try{ye=new URL(Q).hostname.toLowerCase()}catch{}return ye?ye.includes("github.com")?"i-mdi-github":ye.includes("twitter.com")||ye.includes("x.com")?"i-mdi-twitter":ye.includes("t.me")||ye.includes("telegram.me")||ye.includes("telegram.org")?"i-mdi-telegram":ye.includes("discord.com")||ye.includes("discord.gg")?"i-mdi-discord":ye.includes("youtube.com")||ye.includes("youtu.be")?"i-mdi-youtube":ye.includes("linkedin.com")?"i-mdi-linkedin":ye.includes("facebook.com")?"i-mdi-facebook":ye.includes("instagram.com")?"i-mdi-instagram":ye.includes("bilibili.com")?"i-mdi-bilibili":ye.includes("zhihu.com")?"i-mdi-zhihu":ye.includes("medium.com")?"i-mdi-medium":ye.includes("tiktok.com")||ye.includes("douyin.com")?"i-mdi-tiktok":ye.includes("weibo.com")?"i-mdi-sina-weibo":ye.includes("wechat")||ye.includes("weixin")?"i-mdi-wechat":ye.includes("rss")||ye.endsWith("/rss")?"i-mdi-rss":"i-mdi-link-variant":"i-mdi-link-variant"},_t=he(()=>{var Y;const H=((Y=P.value)==null?void 0:Y.socialLinks)??P.socialLinks;return(Array.isArray(H)?H:[]).filter(Q=>String((Q==null?void 0:Q.url)||"").trim()!=="").map(Q=>({...Q,name:(Q==null?void 0:Q.name)||(Q==null?void 0:Q.url)}))});he(()=>_t.value);const wn=he(()=>{var Y;const H=((Y=P.value)==null?void 0:Y.friendLinks)??P.friendLinks;return(Array.isArray(H)?H:[]).filter(Q=>String((Q==null?void 0:Q.link)||"").trim()!=="").map(Q=>({title:String((Q==null?void 0:Q.title)||(Q==null?void 0:Q.link)||"").trim(),link:String((Q==null?void 0:Q.link)||"").trim(),icon:String((Q==null?void 0:Q.icon)||"").trim(),description:String((Q==null?void 0:Q.description)||"").trim()}))}),vt=G(["身为冒险者，如果安静的老死在床上，那简直就是耻辱！","愿你出走半生，归来仍是少年。","愿你眼里有光，心里有海。"][0]),Bt=G(""),Ut=G(!1),en=G(!1),sn=async H=>{const R=Y=>new Promise(Q=>{const ye=new Image;ye.src=Y,ye.onload=()=>Q(Y),ye.onerror=()=>Q(null)});await Promise.all(H.map(Y=>R(Y)))};oi(()=>{window.removeEventListener("frontend-config-updated",mt)});const ln=async()=>{if(en.value)return;en.value=!0;const H=Math.floor(Math.random()*P.value.backgrounds.length),R=P.value.backgrounds[H];if(R===Bt.value){en.value=!1;return}const Y=`${R}?imageView2/2/w/10/blur/1/q/10`;Bt.value=Y,requestAnimationFrame(()=>{const Q=new Image;Q.src=R,Q.onload=()=>{requestAnimationFrame(()=>{Bt.value=R,en.value=!1})},Q.onerror=()=>{en.value=!1}})};let ti=null;const ui=()=>{ti&&clearTimeout(ti),ti=setTimeout(()=>Hn(),100)},Hn=()=>{const H=(P.value.pwaTitle||P.value.siteTitle||"说说笔记").trim(),R=(P.value.rssFaviconURL||"/favicon.ico").trim(),Y=P.value.pwaIconURL&&P.value.pwaIconURL.trim()!==""?P.value.pwaIconURL.trim():R.toLowerCase().endsWith(".png")?R:"/android-chrome-192x192.png",Q=(P.value.pwaDescription||P.value.description||"").trim();go({title:H,meta:[{key:"description",name:"description",content:Q},{key:"theme-color",name:"theme-color",content:"#000000"}],link:[{key:"icon-32",rel:"icon",type:"image/png",href:"/favicon-32x32.png",sizes:"32x32"},{key:"shortcut-icon-32",rel:"shortcut icon",type:"image/png",href:"/favicon-32x32.png",sizes:"32x32"},{key:"icon-fallback",rel:"icon",href:R},...P.value.pwaEnabled?[{key:"manifest",rel:"manifest",href:"/manifest.webmanifest"},{key:"apple-touch",rel:"apple-touch-icon",href:Y,sizes:"180x180"},{key:"pwa-192",rel:"icon",href:Y,sizes:"192x192"},{key:"pwa-512",rel:"icon",href:Y.toLowerCase().endsWith(".png")?Y:"/android-chrome-512x512.png",sizes:"512x512"}]:[]]})};Et(()=>[P.value.pwaEnabled,P.value.pwaTitle,P.value.pwaIconURL,P.value.pwaDescription,P.value.siteTitle,P.value.rssFaviconURL,P.value.description],()=>{ui()},{immediate:!0});const zt=G(null),Wt=G([]),Ge=async()=>{await ut()},ut=async()=>{try{const H=await Bn("messages/tags");H&&H.code===1?Wt.value=H.data||[]:Wt.value=[]}catch(H){console.error("获取标签失败:",H),Wt.value=[]}},Gt=G([]),W=G(null),Z=async()=>{try{const H=await Bn("messages/images");H&&H.code===1&&Array.isArray(H.data)&&(Gt.value=H.data)}catch{}},xe=async()=>{try{const H=await Bn("status");H&&H.code===1&&(W.value=H.data)}catch{}},ze=he(()=>(Array.isArray(Wt.value)?[...Wt.value]:[]).sort((R,Y)=>(Y.count||0)-(R.count||0)).slice(0,8)),Ue=he(()=>Gt.value.slice(0,60)),nt=H=>{const R=typeof H=="string"?H:(H==null?void 0:H.image_url)||(H==null?void 0:H.url),Y=gn().public.baseApi||"/api";return R!=null&&R.startsWith("http")?R:`${Y}${R}`},Me=he(()=>Array.isArray(P.value.leftAds)?P.value.leftAds.filter(H=>String((H==null?void 0:H.imageURL)||"").trim()!==""):[]),Rt=H=>{const R=gn().public.baseApi||"/api",Y=String(H||"").trim();return Y.startsWith("http")?Y:Y?`${R}${Y}`:""},Xt=G(0),Ct=he(()=>Me.value[Math.max(0,Math.min(Xt.value,Me.value.length-1))]||{imageURL:"",linkURL:"",description:""});let Ln;Ht(()=>{const H=Number(P.leftAdsIntervalMs||5e3);Me.value.length>1&&(Ln=Ki(()=>{Xt.value=(Xt.value+1)%Me.value.length},Math.max(2e3,H)))}),oi(()=>{Ln&&clearInterval(Ln)});const Vn=G([]),di=G(0),ki=H=>/!\[[^\]]*\]\([^)]*\)/.test(String(H||""))||/<img[^>]*>/i.test(String(H||"")),Nn=he(()=>{const H=Vn.value.filter(Q=>!ki((Q==null?void 0:Q.content)||""));if(H.length<=8)return H;const R=di.value%H.length,Y=(R+8)%H.length;return R<Y?H.slice(R,Y):[...H.slice(R),...H.slice(0,Y)]}),Si=H=>{const Q=String(H||"").replace(/!\[[^\]]*\]\([^)]*\)/g,"").replace(/<img[^>]*>/gi,"").replace(/<[^>]+>/g,"").replace(/\s+/g," ").trim();return Q.length>20?Q.slice(0,20):Q||"评论"},Dr=H=>`https://i.pravatar.cc/64?u=${encodeURIComponent(H||Math.random().toString(36).slice(2))}`,lr=H=>{const Y=String(H||"").trim().match(/^(\d+)@qq\.com$/i);return Y?Y[1]:""},ha=H=>{let R=0;const Y=String(H||"");for(let Q=0;Q<Y.length;Q++)R=(R<<5)-R+Y.charCodeAt(Q),R|=0;return Math.abs(R)},Or=H=>{const R=String(H||"").trim();if(!R)return"U";if(/^[\u4e00-\u9fa5]/.test(R))return R.slice(0,1);const Y=R.split(/\s+|[_.-]+/).filter(Boolean),Q=(Y[0]||R)[0]||"U",ye=(Y[1]||"")[0]||"";return(Q+ye).toUpperCase()},cr=(H,R=40)=>{const Y=Or(H),ye=`hsl(${ha(H)%360},70%,50%)`,Ee=`<svg xmlns="http://www.w3.org/2000/svg" width="${R}" height="${R}"><rect width="${R}" height="${R}" rx="${R/2}" fill="${ye}"/><text x="50%" y="55%" font-size="${Math.floor(R*.5)}" text-anchor="middle" fill="#fff" font-family="-apple-system,Segoe UI,Roboto,Helvetica,Arial">${Y}</text></svg>`;return"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(Ee)},ur=he(()=>{const H=String(P.value.avatarURL||"").trim(),R=gn().public.baseApi||"/api";return H?H.startsWith("http")?H:`${R}${H}`:String(P.value.rssFaviconURL||"/favicon.svg").trim()}),fi=(H,R=100)=>[H?`https://q1.qlogo.cn/g?b=qq&nk=${H}&s=${R}`:"",H?`https://q2.qlogo.cn/g?b=qq&nk=${H}&s=${R}`:"",H?`https://q.qlogo.cn/g?b=qq&nk=${H}&s=${R}`:""].filter(Boolean),Pr=H=>{const R=lr((H==null?void 0:H.mail)||""),Y=String((H==null?void 0:H.nick)||"").trim();return fi(R)[0]||""||cr(Y||(H==null?void 0:H.mail)||"anonymous")||ur.value||Dr(Y||(H==null?void 0:H.mail)||"")},Rr=(H,R)=>{var At,En,mi;const Y=H.target,Q=((At=Y==null?void 0:Y.dataset)==null?void 0:At.mail)||"",ye=String(((En=Y==null?void 0:Y.dataset)==null?void 0:En.qq)||""),Ee=Number(((mi=Y==null?void 0:Y.dataset)==null?void 0:mi.try)||0),at=fi(ye);if(ye&&Ee<at.length){const qn=Math.min(Ee+1,at.length-1),ce=at[qn];Y.dataset.try=String(qn),Y.src=ce;return}const Yt=cr(R||Q||"anonymous")||ur.value||Dr(R||Q||"anonymous");Y&&Yt&&(Y.src=Yt)},dr=gn().public.baseApi||"/api",xi=async()=>{var H,R;try{let Y=1,Q=50,ye=0;const Ee=[];for(let at=0;at<3;at++){const Yt=await fetch(`${dr}/messages/page`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({page:Y,pageSize:Q})});if(!Yt.ok)break;const At=await Yt.json().catch(()=>null),En=((H=At==null?void 0:At.data)==null?void 0:H.items)||[];ye=Number(((R=At==null?void 0:At.data)==null?void 0:R.total)||0);const qn=En.map(hn=>hn.id).filter(hn=>hn!==se.value).map(async hn=>{try{const pr=await fetch(`${dr}/messages/${hn}/comments`,{credentials:"include",headers:{Accept:"application/json"}});if(!pr.ok)return[];const Ci=await pr.json();return(Array.isArray(Ci==null?void 0:Ci.data)?Ci.data:[]).map(jn=>({id:jn.id,nick:jn.nick,mail:jn.mail,content:jn.content,created_at:jn.created_at,message_id:hn}))}catch{return[]}}),ce=await Promise.all(qn),Ft=[].concat(...ce);Ee.push(...Ft);const kn=Math.max(1,Math.ceil(ye/Q));if(Ee.length>=24||Y>=kn)break;Y+=1}if(Ee.sort((at,Yt)=>new Date(Yt.created_at||0).getTime()-new Date(at.created_at||0).getTime()),Vn.value=Ee.filter(at=>at.message_id!==se.value).filter(at=>!ki((at==null?void 0:at.content)||"")).map(at=>({id:at.id,nick:at.nick,mail:at.mail,content:at.content})).slice(0,24),Vn.value.length>0)return}catch{}Vn.value=["期待","对方的","发个","困难","路口提示","测试","你好","加油","真不错","赞同","有趣","哈哈","有用","收藏","不错","灵感","记录"].map((Y,Q)=>({id:Q+1,nick:"匿名",mail:"",content:Y}))};Ht(async()=>{await xi(),Ki(()=>{di.value=(di.value+1)%Math.max(1,Vn.value.length)},3e3)}),Ht(()=>{var H,R;try{(R=(H=window.Fancybox)==null?void 0:H.bind)==null||R.call(H,"[data-fancybox]",{})}catch{}});const ni=he(()=>$t.value?"bg-[rgba(36,43,50,0.75)] text-white":"bg-slate-100 text-slate-800"),_i=he(()=>$t.value?"text-white":"text-slate-800");Ht(()=>{const H=()=>mt();window.addEventListener("frontend-config-updated",H),mt(),ut(),Z(),xe(),oi(()=>window.removeEventListener("frontend-config-updated",H))});const Vi=async H=>{try{const R=encodeURIComponent(H.trim()),Y=await Bn(`messages/tags/${R}`,void 0,{credentials:"include"});if(Y&&Y.code===1&&Array.isArray(Y.data))b.value&&b.value.handleSearchResult(Y.data);else throw new Error((Y==null?void 0:Y.msg)||"获取标签内容失败")}catch(R){console.error("获取标签消息失败:",R),Ze().add({title:"获取标签消息失败",description:R.message||"服务器错误，请稍后重试",color:"red",timeout:3e3})}},fr=()=>{if(!zt.value)return;let H=0,R=!1,Y=!1;const Q=Ki(()=>{if(!zt.value){clearInterval(Q);return}Y||(R?(H--,zt.value.textContent=P.value.subtitleText.slice(0,H),H<=0&&(Y=!0,zt.value.textContent="",setTimeout(()=>{R=!1,Y=!1,H=0},1e3))):(zt.value.textContent=P.value.subtitleText.slice(0,H+1),H++,H>=P.value.subtitleText.length&&(Y=!0,setTimeout(()=>{R=!0,Y=!1},2e3))))},100);return Q};Ht(async()=>{try{if(Ut.value=!1,window.requestIdleCallback=window.requestIdleCallback||(R=>setTimeout(R,1)),await mt(),P.value.musicEnabled&&await ne(),vo(async()=>{await ut(),await sn(P.value.backgrounds)}),P.value.backgrounds.length>0){const R=P.value.backgrounds[Math.floor(Math.random()*P.value.backgrounds.length)],Y=`${R}?imageView2/2/w/100/q/30`;Bt.value=Y,vo(async()=>{await sn(P.value.backgrounds)});const Q=new Image;Q.src=R,Q.onload=()=>{requestAnimationFrame(()=>{Bt.value=R,Ut.value=!0})},Q.onerror=()=>{Ut.value=!0},setTimeout(()=>{Ut.value||(Ut.value=!0)},2e3)}const H=fr();oi(()=>{H&&clearInterval(H)}),window.addEventListener("frontend-config-updated",async R=>{var Y;if(await mt(),((Y=P.value.backgrounds)==null?void 0:Y.length)>0){const Q=Math.floor(Math.random()*P.value.backgrounds.length),ye=P.value.backgrounds[Q];Bt.value=ye}})}catch(H){console.error("初始化失败:",H),Ut.value=!0}}),G(new Date);const hi=G(new Date);let pi=null;Ht(()=>{pi=Ki(()=>{hi.value=new Date},1e3)}),oi(()=>{pi&&(clearInterval(pi),pi=null)});const hr=H=>{const R=String(H.getHours()).padStart(2,"0"),Y=String(H.getMinutes()).padStart(2,"0"),Q=String(H.getSeconds()).padStart(2,"0");return`${R}:${Y}:${Q}`},ct=H=>{const R=H.getFullYear(),Y=String(H.getMonth()+1).padStart(2,"0"),Q=String(H.getDate()).padStart(2,"0"),ye=["周日","周一","周二","周三","周四","周五","周六"][H.getDay()];return`${R}-${Y}-${Q} ${ye}`};return(H,R)=>{const Y=ci,Q=Mr,ye=Qu,Ee=ca,at=td,Yt=ad,At=ua,En=xc,mi=_c,qn=da;return J(),ae("div",{class:"background-container",style:ji(et.value)},[Ut.value?Le("",!0):(J(),ae("div",gp,R[20]||(R[20]=[N("div",{class:"rainbow-spinner"},null,-1),N("div",{class:"loading-text"},"加载中...",-1)]))),N("div",{ref_key:"contentWrapper",ref:rn,class:be(["content-wrapper",{"gpu-accelerated":!0}])},[te(Yt,{class:"container-fixed py-2 pb-4 my-4"},{default:Te(()=>[N("div",{class:be(["layout-container",S.value])},[te(at,null,{default:Te(()=>[!u.value&&d.value!=="single"?(J(),ae("div",vp,[te(Ee,{class:be(["sidebar-card",Ot.value])},{default:Te(()=>[N("div",bp,[N("div",yp,[N("img",{class:"avatar-lg",src:Oe.value,alt:Qe.value,onClick:ln,onError:it},null,40,wp),N("span",{class:be(["avatar-status",ve.value?"bg-green-500":"bg-gray-400"])},null,2)]),N("div",Ep,We(Qe.value),1),Ve.value?(J(),ae("div",kp,R[21]||(R[21]=[N("span",{class:"px-1.5 py-0.5 rounded bg-orange-500 text-white text-[10px]"},"管理员",-1)]))):Le("",!0),N("div",Sp,We(lt.value),1),ve.value?Le("",!0):(J(),ae("div",xp,[te(ye,{text:"登录"},{default:Te(()=>[te(Q,{variant:"ghost",color:"indigo",class:"auth-btn",onClick:R[0]||(R[0]=ce=>{_.value="login",w.value=!0})},{default:Te(()=>[te(Y,{name:"i-heroicons-arrow-right-end-on-rectangle",class:"w-5 h-5"})]),_:1})]),_:1}),te(ye,{text:"注册"},{default:Te(()=>[te(Q,{variant:"ghost",color:"orange",class:"auth-btn",onClick:R[1]||(R[1]=ce=>{Ie(),w.value=!0})},{default:Te(()=>[te(Y,{name:"i-heroicons-user-plus",class:"w-5 h-5"})]),_:1})]),_:1})]))])]),_:1},8,["class"]),te(Ee,{class:be(["sidebar-card no-padding-card mt-2",Ot.value])},{default:Te(()=>{var ce,Ft,kn,hn;return[N("div",_p,[N("div",null,[N("div",Cp,We(((ce=W.value)==null?void 0:ce.total_messages)??((Ft=W.value)==null?void 0:Ft.TotalMessages)??0),1),R[22]||(R[22]=N("div",{class:"opacity-70"},"笔记数",-1))]),N("div",null,[N("div",Tp,We(((kn=Wt.value)==null?void 0:kn.length)||0),1),R[23]||(R[23]=N("div",{class:"opacity-70"},"标签",-1))]),N("div",null,[N("div",Mp,We(((hn=Gt.value)==null?void 0:hn.length)||0),1),R[24]||(R[24]=N("div",{class:"opacity-70"},"图片",-1))])])]}),_:1},8,["class"]),te(Ee,{class:be(["sidebar-card no-padding-card mt-2",Ot.value])},{default:Te(()=>[N("div",Ap,[(J(!0),ae(It,null,Qt(P.value.socialLinks||[],ce=>(J(),ae("a",{key:ce.url||ce.name,class:"social-item",href:ce.url,target:"_blank",rel:"noopener noreferrer","data-label":ce.name||ce.url},[ce.imageURL?(J(),ae("img",{key:0,src:ce.imageURL,alt:"icon",class:"social-icon-img"},null,8,Dp)):(J(),Lt(Y,{key:1,name:gt(ce),class:"w-7 h-7"},null,8,["name"]))],8,Lp))),128))])]),_:1},8,["class"]),P.value.timeEnabled?(J(),Lt(Ee,{key:0,class:be(["sidebar-card no-padding-card mt-2",Ot.value])},{default:Te(()=>[N("div",Op,[N("div",Pp,We(hr(hi.value)),1),N("div",Rp,We(ct(hi.value)),1)])]),_:1},8,["class"])):Le("",!0),P.value.leftAdEnabled&&Me.value.length>0?(J(),Lt(Ee,{key:1,class:be(["sidebar-card mt-2",Ot.value])},{default:Te(()=>[N("div",null,[Me.value.length>0?(J(),ae("div",Ip,[N("a",{href:Ct.value.linkURL||"#",target:"_blank",rel:"noopener noreferrer",class:"block ad-wrap group rounded-lg overflow-hidden",style:ji({"--ad-bg":`url(${Rt(Ct.value.imageURL)})`})},[N("img",{src:Rt(Ct.value.imageURL),alt:"ad",class:"ad-image w-full object-cover transition duration-200 rounded-lg"},null,8,Np),N("div",jp,[N("div",{class:be(["ad-overlay-box transition-colors duration-200",[$t.value?"":"group-hover:text-orange-500"]])},We((Ct.value.description||"").trim()||"广告"),3)])],12,Hp),Me.value.length>1?(J(),ae("div",$p,[(J(!0),ae(It,null,Qt(Me.value,(ce,Ft)=>(J(),ae("button",{key:Ft,onClick:kn=>Xt.value=Ft,class:be(["w-2 h-2 rounded-full",Ft===Xt.value?"bg-white":"bg-white/40"]),"aria-label":"switch-ad"},null,10,Bp))),128))])):Le("",!0)])):Le("",!0)])]),_:1},8,["class"])):Le("",!0),P.value.hitokotoEnabled?(J(),Lt(Ee,{key:2,class:be(["sidebar-card mt-2",Ot.value])},{default:Te(()=>[R[25]||(R[25]=N("div",{class:"hidden"},[N("span",{id:"hitokoto"},"正在获取中...")],-1)),N("div",Up,[N("div",{class:"hitokoto-text",title:vt.value||"正在获取中..."},[te(wi,{content:vt.value||"正在获取中...",enableGithubCard:!1},null,8,["content"])],8,zp)])]),_:1},8,["class"])):Le("",!0),d.value==="two"?(J(),ae("div",Fp,[P.value.announcementEnabled&&(P.value.announcementText||"").trim()!==""?(J(),Lt(Ee,{key:0,class:be(["sidebar-card",Ot.value])},{default:Te(()=>[te(is,{text:P.value.announcementText||"欢迎访问我的说说笔记！"},null,8,["text"])]),_:1},8,["class"])):Le("",!0),te(Ee,{class:be(["sidebar-card no-padding-card",Ot.value])},{default:Te(()=>[N("div",null,[R[26]||(R[26]=N("div",{class:"text-xs opacity-70 mb-2"},"热门标签",-1)),N("div",Vp,[N("div",qp,[(J(!0),ae(It,null,Qt(ze.value,ce=>(J(),ae("button",{key:ce.name,class:"px-2 py-1 rounded text-xs border opacity-80 hover:opacity-100",onClick:Ft=>Vi(ce.name)},[dt("#"+We(ce.name),1),N("span",Yp,We(ce.count),1)],8,Wp))),128))])])])]),_:1},8,["class"]),te(Ee,{class:be(["sidebar-card no-padding-card",Ot.value])},{default:Te(()=>[N("div",null,[R[27]||(R[27]=N("div",{class:"text-xs opacity-70 mb-2"},"图集",-1)),N("div",Kp,[N("div",Gp,[(J(!0),ae(It,null,Qt(Ue.value,ce=>(J(),ae("a",{key:ce.id||ce,href:nt(ce),"data-fancybox":"recommend-gallery",class:"block"},[N("img",{src:nt(ce),class:"recommend-image-box",loading:"lazy",alt:"recommend"},null,8,Zp)],8,Xp))),128))])])])]),_:1},8,["class"]),te(Ee,{class:be(["sidebar-card no-padding-card",Ot.value])},{default:Te(()=>[te(ns)]),_:1},8,["class"]),te(Ee,{class:"sidebar-card no-padding-card"},{default:Te(()=>[R[28]||(R[28]=N("div",{class:"text-xs opacity-70 mb-1"},"最新评论",-1)),N("div",Jp,[N("div",Qp,[(J(!0),ae(It,null,Qt(Nn.value,(ce,Ft)=>(J(),ae("div",{key:ce.id||Ft,class:be(["inline-flex items-center gap-2 px-2 py-1 rounded-full",ni.value])},[N("img",{src:Pr(ce),"data-mail":ce.mail||"","data-qq":lr((ce==null?void 0:ce.mail)||""),"data-try":"0",class:"w-5 h-5 rounded-full object-cover",alt:"avatar",onError:kn=>Rr(kn,ce.nick||"")},null,40,em),N("span",{class:be(["text-xs",_i.value])},We(Si(ce.content)),3)],2))),128))])])]),_:1})])):Le("",!0)])):Le("",!0)]),_:1}),N("div",tm,[N("div",{class:be(h.value)},[N("div",nm,[N("div",{class:"header-image",style:ji(Pt.value)},[N("h1",im,We(P.value.siteTitle||"说说笔记"),1),N("div",{class:"header-subtitle",ref_key:"subtitleEl",ref:zt},null,512),N("div",rm,[(J(),ae(It,null,Qt(f,ce=>N("button",{key:ce.key,class:be(["hero-tab",g.value===ce.key?"active":""]),onClick:Ft=>g.value=ce.key},We(ce.name),11,am)),64))])],4)]),g.value==="links"?(J(),ae("div",om,[te(Ee,{class:"search-card mb-3",ui:{body:"p-3 md:p-4"}},{default:Te(()=>[N("div",{class:be(["card-title text-center",$t.value?"text-white":"text-black"])},We(P.value.linksTitle||"友情链接"),3),(P.value.linksDescription||"").trim()!==""?(J(),ae("div",sm,We(P.value.linksDescription),1)):Le("",!0),N("div",lm,[N("div",cm,[(J(!0),ae(It,null,Qt(wn.value,ce=>(J(),ae("a",{key:ce.link||ce.title,href:ce.link,target:"_blank",rel:"noopener noreferrer",class:be(["link-card",$t.value?"link-card-dark":"link-card-light"])},[te(Y,{name:gt({url:ce.link,icon:ce.icon}),class:"w-7 h-7"},null,8,["name"]),N("div",dm,[N("div",fm,We(ce.title),1),ce.description?(J(),ae("div",hm,We(ce.description),1)):Le("",!0)])],10,um))),128))])])]),_:1})])):g.value==="comment"?(J(),ae("div",pm,[te(Ee,{class:"search-card mb-3",ui:{body:"p-5"}},{default:Te(()=>[N("div",{class:be(["card-title text-center mb-3",$t.value?"text-white":"text-black"])},We(P.value.commentPageTitle||"留言"),3),(P.value.commentPageDescription||"").trim()!==""?(J(),ae("div",mm,We(P.value.commentPageDescription),1)):Le("",!0),N("div",gm,[se.value?(J(),Lt(qs,{key:0,"message-id":se.value,"site-config":P.value,"show-input":!0},null,8,["message-id","site-config"])):(J(),ae("div",vm,"正在准备留言板..."))])]),_:1})])):g.value==="about"?(J(),ae("div",bm,[te(Ee,{class:"search-card mb-3",ui:{body:"p-6"}},{default:Te(()=>[N("div",{class:be(["card-title text-center",$t.value?"text-white":"text-black"])},We(P.value.aboutPageTitle||"关于本站"),3),(P.value.aboutPageDescription||"").trim()!==""?(J(),ae("div",ym,We(P.value.aboutPageDescription),1)):Le("",!0),N("div",wm,[te(wi,{content:(P.value.aboutMarkdown||"").trim()||ge.aboutMarkdown},null,8,["content"])])]),_:1})])):(J(),ae(It,{key:3},[te(uf,{onSearchResult:we,"hide-header-tools":d.value==="three",wide:d.value==="two"},null,8,["hide-header-tools","wide"]),N("div",Em,[Wt.value&&Wt.value.length>0?(J(),Lt(sp,{key:0,tags:Wt.value,onTagClick:Vi,onUpdateTags:Ge},null,8,["tags"])):Le("",!0)]),te(Gh,{ref_key:"messageList",ref:b,class:"message-list-container","site-config":P.value,"target-message-id":X.value,wide:d.value==="two"},null,8,["site-config","target-message-id","wide"])],64))],2)]),te(at,null,{default:Te(()=>[!u.value&&d.value==="three"?(J(),ae("div",km,[P.value.announcementEnabled&&(P.value.announcementText||"").trim()!==""?(J(),Lt(Ee,{key:0,class:be(["sidebar-card",Ot.value])},{default:Te(()=>[te(is,{text:P.value.announcementText||"欢迎访问我的说说笔记！"},null,8,["text"])]),_:1},8,["class"])):Le("",!0),te(Ee,{class:be(["sidebar-card no-padding-card",Ot.value])},{default:Te(()=>[N("div",null,[R[29]||(R[29]=N("div",{class:"text-xs opacity-70 mb-2"},"热门标签",-1)),N("div",Sm,[N("div",xm,[(J(!0),ae(It,null,Qt(ze.value,ce=>(J(),ae("button",{key:ce.name,class:"px-2 py-1 rounded text-xs border opacity-80 hover:opacity-100",onClick:Ft=>Vi(ce.name)},[dt("#"+We(ce.name),1),N("span",Cm,We(ce.count),1)],8,_m))),128))])])])]),_:1},8,["class"]),te(Ee,{class:be(["sidebar-card no-padding-card",Ot.value])},{default:Te(()=>[N("div",null,[R[30]||(R[30]=N("div",{class:"text-xs opacity-70 mb-2"},"图集",-1)),N("div",Tm,[N("div",Mm,[(J(!0),ae(It,null,Qt(Ue.value,ce=>(J(),ae("a",{key:ce.id||ce,href:nt(ce),"data-fancybox":"recommend-gallery",class:"block"},[N("img",{src:nt(ce),class:"recommend-image-box",loading:"lazy",alt:"recommend"},null,8,Lm)],8,Am))),128))])])])]),_:1},8,["class"]),te(Ee,{class:be(["sidebar-card no-padding-card",Ot.value])},{default:Te(()=>[te(ns)]),_:1},8,["class"]),te(Ee,{class:be(["sidebar-card mt-2 no-padding-card",Ot.value])},{default:Te(()=>[R[31]||(R[31]=N("div",{class:"text-xs opacity-70 mb-1"},"最新评论",-1)),N("div",Dm,[N("div",Om,[(J(!0),ae(It,null,Qt(Nn.value,(ce,Ft)=>(J(),ae("div",{key:ce.id||Ft,class:be(["inline-flex items-center gap-2 px-2 py-1 rounded-full",ni.value])},[N("img",{src:Pr(ce),"data-mail":ce.mail||"","data-qq":lr((ce==null?void 0:ce.mail)||""),"data-try":"0",class:"w-5 h-5 rounded-full object-cover",alt:"avatar",onError:kn=>Rr(kn,ce.nick||"")},null,40,Pm),N("span",{class:be(["text-xs",_i.value])},We(Si(ce.content)),3)],2))),128))])])]),_:1},8,["class"])])):Le("",!0)]),_:1})],2),Le("",!0),P.value.musicEnabled?(J(),ae("div",{key:1,class:"netease-mini-player","data-playlist-id":P.value.musicPlaylistId||"","data-song-id":P.value.musicSongId||"","data-position":P.value.musicPosition||"bottom-left","data-theme":P.value.musicTheme||"auto","data-lyric":P.value.musicLyric?"true":"false","data-default-minimized":P.value.musicDefaultMinimized?"true":"false","data-embed":P.value.musicEmbed?"true":"false","data-autoplay":P.value.musicAutoplay?"true":"false"},null,8,Rm)):Le("",!0)]),_:1}),te(Ac),te(Vs,{modelValue:k.value,"onUpdate:modelValue":R[2]||(R[2]=ce=>k.value=ce),onSearchResult:we},null,8,["modelValue"]),te(mp,{"content-theme":ht.value,"layout-icon":E.value,onSearch:R[3]||(R[3]=ce=>k.value=!0),onSwitchBackground:ln,onToggleTheme:Mn,onToggleLayout:v,onOpenAdmin:re},null,8,["content-theme","layout-icon"]),te(qn,{modelValue:w.value,"onUpdate:modelValue":R[14]||(R[14]=ce=>w.value=ce),ui:{width:"sm:max-w-md",container:"items-center",base:"backdrop-blur-sm"}},{default:Te(()=>[te(Ee,{class:"search-card"},{header:Te(()=>[N("div",Im,[N("h3",Hm,We(_.value==="login"?"欢迎回来":"创建账户"),1),N("div",Nm,[_.value==="login"?(J(),Lt(Q,{key:0,variant:"link",color:"orange",onClick:Ie},{default:Te(()=>R[35]||(R[35]=[dt("去注册")])),_:1})):(J(),Lt(Q,{key:1,variant:"link",color:"orange",onClick:Je},{default:Te(()=>R[36]||(R[36]=[dt("去登录")])),_:1})),te(Q,{icon:"i-mdi-close",variant:"ghost",color:"gray",onClick:tt})])])]),default:Te(()=>[N("div",jm,[_.value==="login"?(J(),ae("div",$m,[te(En,{onSubmit:nr(U,["prevent"])},{default:Te(()=>[N("div",Bm,[te(At,{modelValue:Se(C).username,"onUpdate:modelValue":R[4]||(R[4]=ce=>Se(C).username=ce),placeholder:"用户名或邮箱"},null,8,["modelValue"]),te(At,{modelValue:Se(C).password,"onUpdate:modelValue":R[7]||(R[7]=ce=>Se(C).password=ce),type:M.value?"text":"password",placeholder:"密码",autocomplete:"current-password",autocorrect:"off",autocapitalize:"off",spellcheck:"false"},{trailing:Te(()=>[M.value?(J(),Lt(Q,{key:1,icon:"i-heroicons-eye-slash",variant:"ghost",color:"gray",onClick:R[6]||(R[6]=ce=>M.value=!1),ui:{rounded:"rounded-full"}})):(J(),Lt(Q,{key:0,icon:"i-heroicons-eye",variant:"ghost",color:"gray",onClick:R[5]||(R[5]=ce=>M.value=!0),ui:{rounded:"rounded-full"}}))]),_:1},8,["modelValue","type"]),te(Q,{class:"w-full",loading:O.value,disabled:O.value,type:"submit",color:"primary"},{default:Te(()=>R[37]||(R[37]=[dt("登录")])),_:1},8,["loading","disabled"])])]),_:1}),N("div",Um,[te(Q,{variant:"link",onClick:Ie},{default:Te(()=>R[38]||(R[38]=[dt("账号注册")])),_:1}),te(Q,{variant:"link",onClick:R[8]||(R[8]=ce=>F.value=!0)},{default:Te(()=>R[39]||(R[39]=[dt("忘记密码？")])),_:1})]),Ce.value?(J(),ae("div",zm,"其他登录方式")):Le("",!0),Ce.value?(J(),ae("div",Fm,[te(Q,{class:"w-full h-10 px-3 gap-2 justify-center font-medium bg-[#24292f] hover:bg-[#1f2328] text-white ring-1 ring-black/20",onClick:Ae},{default:Te(()=>[te(Y,{name:"i-mdi-github",class:"w-5 h-5"}),R[40]||(R[40]=N("span",null,"GitHub 一键登录",-1))]),_:1})])):Le("",!0)])):(J(),ae("div",Vm,[te(En,{onSubmit:nr(oe,["prevent"])},{default:Te(()=>[N("div",qm,[te(At,{modelValue:Se(T).username,"onUpdate:modelValue":R[9]||(R[9]=ce=>Se(T).username=ce),placeholder:"用户名"},null,8,["modelValue"]),te(At,{modelValue:Se(T).password,"onUpdate:modelValue":R[12]||(R[12]=ce=>Se(T).password=ce),type:y.value?"text":"password",placeholder:"密码",autocomplete:"new-password",autocorrect:"off",autocapitalize:"off",spellcheck:"false"},{trailing:Te(()=>[y.value?(J(),Lt(Q,{key:1,icon:"i-heroicons-eye-slash",variant:"ghost",color:"gray",onClick:R[11]||(R[11]=ce=>y.value=!1),ui:{rounded:"rounded-full"}})):(J(),Lt(Q,{key:0,icon:"i-heroicons-eye",variant:"ghost",color:"gray",onClick:R[10]||(R[10]=ce=>y.value=!0),ui:{rounded:"rounded-full"}}))]),_:1},8,["modelValue","type"]),N("div",Wm,[te(At,{modelValue:Se(T).captcha,"onUpdate:modelValue":R[13]||(R[13]=ce=>Se(T).captcha=ce),placeholder:"验证码"},null,8,["modelValue"]),N("img",{src:V.value,onClick:De,class:"h-10 w-24 rounded border cursor-pointer",alt:"captcha"},null,8,Ym),te(mi,{color:I.value>0?"primary":"red",variant:"soft"},{default:Te(()=>[dt(We(I.value>0?`有效 ${I.value}s`:"已过期"),1)]),_:1},8,["color"])]),te(Q,{class:"w-full",loading:B.value,disabled:I.value<=0||B.value,type:"submit",color:"primary"},{default:Te(()=>[dt(We(I.value>0?"注册":"验证码已过期"),1)]),_:1},8,["loading","disabled"])])]),_:1})]))])]),_:1})]),_:1},8,["modelValue"]),te(qn,{modelValue:F.value,"onUpdate:modelValue":R[17]||(R[17]=ce=>F.value=ce),ui:{container:"items-center",base:"backdrop-blur-sm"}},{default:Te(()=>[te(Ee,{class:"search-card"},{default:Te(()=>[R[42]||(R[42]=N("div",{class:"font-semibold mb-2"},"找回密码",-1)),te(En,{onSubmit:nr(Ke,["prevent"])},{default:Te(()=>[N("div",Km,[te(At,{modelValue:Se(le).account,"onUpdate:modelValue":R[15]||(R[15]=ce=>Se(le).account=ce),placeholder:"用户名或邮箱"},null,8,["modelValue"]),N("div",Gm,[te(Q,{variant:"ghost",onClick:R[16]||(R[16]=ce=>F.value=!1)},{default:Te(()=>R[41]||(R[41]=[dt("取消")])),_:1}),te(Q,{disabled:de.value>0||!Be.value,type:"submit",color:"primary"},{default:Te(()=>[dt(We(Be.value?de.value>0?`请稍候(${de.value}s)`:"发送重置邮件":"邮件未开启"),1)]),_:1},8,["disabled"])])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),N("div",{class:"scroll-buttons",onMouseenter:R[18]||(R[18]=ce=>on.value=!0),onMouseleave:R[19]||(R[19]=ce=>on.value=!1)},[Pi(te(Q,{class:be(jt.value),variant:"ghost",size:"sm",onClick:ei},{default:Te(()=>[te(Y,{class:be(q.value),name:Mt.value},null,8,["class","name"])]),_:1},8,["class"]),[[us,Nt.value]])],32)],512)],4)}}});export{rg as default};
